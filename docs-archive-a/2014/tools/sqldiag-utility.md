---
title: Utilitário SQLdiag | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: tools-other
ms.topic: conceptual
helpviewer_keywords:
- command prompt utilities [SQL Server], SQLdiag
- stopping diagnostic collection
- storing diagnostic information
- performance [SQL Server], diagnostic collection
- diagnostic records [SQL Server]
- scripts [SQL Server], diagnostic collection
- logs [SQL Server], diagnostic collection
- starting diagnostic collection
- clustered instance of SQL Server
- monitoring performance [SQL Server], diagnostic collection
- security [SQL Server], diagnostic collection
- SQLDIAG service
- space [SQL Server], diagnostic collection
- SQLdiag utility
- disk space [SQL Server], diagnostic collection
- configuration files [SQL Server]
- automatic diagnostic collection
- clusters [SQL Server], diagnostic collection
ms.assetid: 45ba1307-33d1-431e-872c-a6e4556f5ff2
author: stevestein
ms.author: sstein
ms.openlocfilehash: 0559e0b2261ed5ba1c9c384608d04194d685f695
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87678396"
---
# <a name="sqldiag-utility"></a><span data-ttu-id="22136-102">SQLdiag Utility</span><span class="sxs-lookup"><span data-stu-id="22136-102">SQLdiag Utility</span></span>
  <span data-ttu-id="22136-103">O utilitário **SQLdiag** é um utilitário de coleta de diagnósticos para fins gerais que pode ser executado como um aplicativo do console ou um serviço.</span><span class="sxs-lookup"><span data-stu-id="22136-103">The **SQLdiag** utility is a general purpose diagnostics collection utility that can be run as a console application or as a service.</span></span> <span data-ttu-id="22136-104">É possível usar o **SQLdiag** para coletar logs e arquivos de dados do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] e de outros tipos de servidores, e usá-lo para monitorar os servidores ao longo do tempo ou para solucionar problemas específicos com seus servidores.</span><span class="sxs-lookup"><span data-stu-id="22136-104">You can use **SQLdiag** to collect logs and data files from [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] and other types of servers, and use it to monitor your servers over time or troubleshoot specific problems with your servers.</span></span> <span data-ttu-id="22136-105">O**SQLdiag** foi criado para agilizar e simplificar a coleta de informações de diagnóstico para os Serviços de Atendimento ao Cliente da [!INCLUDE[msCoName](../includes/msconame-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="22136-105">**SQLdiag** is intended to expedite and simplify diagnostic information gathering for [!INCLUDE[msCoName](../includes/msconame-md.md)] Customer Support Services.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="22136-106">Esse utilitário pode ser alterado e os aplicativos ou scripts que dependem dos seus argumentos de linha de comando ou comportamento podem não funcionar corretamente em versões futuras.</span><span class="sxs-lookup"><span data-stu-id="22136-106">This utility may be changed, and applications or scripts that rely on its command line arguments or behavior may not work correctly in future releases.</span></span>  
  
 <span data-ttu-id="22136-107">O**SQLdiag** pode coletar os seguintes tipos de informações de diagnóstico:</span><span class="sxs-lookup"><span data-stu-id="22136-107">**SQLdiag** can collect the following types of diagnostic information:</span></span>  
  
-   <span data-ttu-id="22136-108">Logs de desempenho do Windows</span><span class="sxs-lookup"><span data-stu-id="22136-108">Windows performance logs</span></span>  
  
-   <span data-ttu-id="22136-109">Logs de eventos do Windows</span><span class="sxs-lookup"><span data-stu-id="22136-109">Windows event logs</span></span>  
  
-   [!INCLUDE[ssSqlProfiler](../includes/sssqlprofiler-md.md)] <span data-ttu-id="22136-110">rastreamentos</span><span class="sxs-lookup"><span data-stu-id="22136-110">traces</span></span>  
  
-   [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="22136-111">bloqueio de informações</span><span class="sxs-lookup"><span data-stu-id="22136-111">blocking information</span></span>  
  
-   [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="22136-112">informações de configuração</span><span class="sxs-lookup"><span data-stu-id="22136-112">configuration information</span></span>  
  
 <span data-ttu-id="22136-113">É possível especificar quais tipos de informações você deseja que o **SQLdiag** colete editando o arquivo de configuração SQLDiag.xml, descrito em uma seção a seguir.</span><span class="sxs-lookup"><span data-stu-id="22136-113">You can specify what types of information you want **SQLdiag** to collect by editing the configuration file SQLDiag.xml, which is described in a following section.</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="22136-114">Sintaxe</span><span class="sxs-lookup"><span data-stu-id="22136-114">Syntax</span></span>  
  
```  
  
      sqldiag   
     { [/?] }  
     |  
     { [/I configuration_file]  
       [/O output_folder_path]  
       [/Psupport_folder_path]  
       [/Noutput_folder_management_option]  
       [/Mmachine1 [ machine2machineN]| @machinelistfile]  
       [/Cfile_compression_type]  
       [/B [+]start_time]  
       [/E [+]stop_time]  
       [/ASQLdiag_application_name]  
       [/T { tcp [ ,port ] | np | lpc } ]  
       [/Q] [/G] [/R] [/U] [/L] [/X] }  
     |  
     { [START | STOP | STOP_ABORT] }  
     |  
     { [START | STOP | STOP_ABORT] /ASQLdiag_application_name }  
```  
  
## <a name="arguments"></a><span data-ttu-id="22136-115">Argumentos</span><span class="sxs-lookup"><span data-stu-id="22136-115">Arguments</span></span>  
 <span data-ttu-id="22136-116">**/?**</span><span class="sxs-lookup"><span data-stu-id="22136-116">**/?**</span></span>  
 <span data-ttu-id="22136-117">Exibe informações de uso.</span><span class="sxs-lookup"><span data-stu-id="22136-117">Displays usage information.</span></span>  
  
 <span data-ttu-id="22136-118">**/I** _configuration_file_</span><span class="sxs-lookup"><span data-stu-id="22136-118">**/I** _configuration_file_</span></span>  
 <span data-ttu-id="22136-119">Define o arquivo de configuração para o **SQLdiag** usar.</span><span class="sxs-lookup"><span data-stu-id="22136-119">Sets the configuration file for **SQLdiag** to use.</span></span> <span data-ttu-id="22136-120">Por padrão, **/I** é definido como SQLDiag.Xml.</span><span class="sxs-lookup"><span data-stu-id="22136-120">By default, **/I** is set to SQLDiag.Xml.</span></span>  
  
 <span data-ttu-id="22136-121">**/O** _output_folder_path_</span><span class="sxs-lookup"><span data-stu-id="22136-121">**/O** _output_folder_path_</span></span>  
 <span data-ttu-id="22136-122">Redireciona a saída do **SQLdiag** para a pasta especificada.</span><span class="sxs-lookup"><span data-stu-id="22136-122">Redirects **SQLdiag** output to the specified folder.</span></span> <span data-ttu-id="22136-123">Se a opção **/O** não for especificada, a saída do **SQLdiag** será gravada em uma subpasta chamada SQLDIAG na pasta de inicialização do **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="22136-123">If the **/O** option is not specified, **SQLdiag** output is written to a subfolder named SQLDIAG under the **SQLdiag** startup folder.</span></span> <span data-ttu-id="22136-124">Se a pasta SQLDIAG não existir, o **SQLdiag** tentará criá-la.</span><span class="sxs-lookup"><span data-stu-id="22136-124">If the SQLDIAG folder does not exist, **SQLdiag** attempts to create it.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="22136-125">O local da pasta de saída é relativo ao local da pasta de suporte que pode ser especificado com **/P**.</span><span class="sxs-lookup"><span data-stu-id="22136-125">The output folder location is relative to the support folder location that can be specified with **/P**.</span></span> <span data-ttu-id="22136-126">Para definir um local completamente diferente para a pasta de saída, especifique o caminho completo do diretório para **/O**.</span><span class="sxs-lookup"><span data-stu-id="22136-126">To set an entirely different location for the output folder, specify the full directory path for **/O**.</span></span>  
  
 <span data-ttu-id="22136-127">**/P** _support_folder_path_</span><span class="sxs-lookup"><span data-stu-id="22136-127">**/P** _support_folder_path_</span></span>  
 <span data-ttu-id="22136-128">Define o caminho da pasta de suporte.</span><span class="sxs-lookup"><span data-stu-id="22136-128">Sets the support folder path.</span></span> <span data-ttu-id="22136-129">Por padrão, **/P** é definido como a pasta na qual o executável **SQLdiag** reside.</span><span class="sxs-lookup"><span data-stu-id="22136-129">By default, **/P** is set to the folder where the **SQLdiag** executable resides.</span></span> <span data-ttu-id="22136-130">A pasta de suporte contém os arquivos de suporte do **SQLdiag** , como o arquivo de configuração XML, scripts Transact-SQL e outros arquivos que o utilitário usa durante a coleta de diagnósticos.</span><span class="sxs-lookup"><span data-stu-id="22136-130">The support folder contains **SQLdiag** support files, such as the XML configuration file, Transact-SQL scripts, and other files that the utility uses during diagnostics collection.</span></span> <span data-ttu-id="22136-131">Se você usar essa opção para especificar um caminho alternativo dos arquivos de suporte, o **SQLdiag** copiará automaticamente os arquivos de suporte necessários na pasta especificada, se ainda não existirem.</span><span class="sxs-lookup"><span data-stu-id="22136-131">If you use this option to specify an alternate support files path, **SQLdiag** will automatically copy the support files it requires to the specified folder if they do not already exist.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="22136-132">Para definir sua pasta atual como o caminho de suporte, especifique o **%cd%** na linha de comando como segue:</span><span class="sxs-lookup"><span data-stu-id="22136-132">To set your current folder as the support path, specify **%cd%** on the command line as follows:</span></span>  
>   
>  <span data-ttu-id="22136-133">**SQLDIAG /P %cd%**</span><span class="sxs-lookup"><span data-stu-id="22136-133">**SQLDIAG /P %cd%**</span></span>  
  
 <span data-ttu-id="22136-134">**/N** _output_folder_management_option_</span><span class="sxs-lookup"><span data-stu-id="22136-134">**/N** _output_folder_management_option_</span></span>  
 <span data-ttu-id="22136-135">Define se o **SQLdiag** substitui ou renomeia a pasta de saída na inicialização.</span><span class="sxs-lookup"><span data-stu-id="22136-135">Sets whether **SQLdiag** overwrites or renames the output folder when it starts up.</span></span> <span data-ttu-id="22136-136">Opções disponíveis:</span><span class="sxs-lookup"><span data-stu-id="22136-136">Available options:</span></span>  
  
 <span data-ttu-id="22136-137">1 = Substitui a pasta de saída (padrão)</span><span class="sxs-lookup"><span data-stu-id="22136-137">1 = Overwrites the output folder (default)</span></span>  
  
 <span data-ttu-id="22136-138">2 = Quando o **SQLdiag** é iniciado, ele renomeia a pasta de saída a como SQLDIAG_00001, SQLDIAG_00002 e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="22136-138">2 = When **SQLdiag** starts up, it renames the output folder to SQLDIAG_00001, SQLDIAG_00002, and so on.</span></span> <span data-ttu-id="22136-139">Depois de renomear a pasta de saída atual, o **SQLdiag** grava a saída na pasta de saída padrão SQLDIAG.</span><span class="sxs-lookup"><span data-stu-id="22136-139">After renaming the current output folder, **SQLdiag** writes output to the default output folder SQLDIAG.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="22136-140">O**SQLdiag** não anexa a saída à pasta de saída atual quando é iniciado.</span><span class="sxs-lookup"><span data-stu-id="22136-140">**SQLdiag** does not append output to the current output folder when it starts up.</span></span> <span data-ttu-id="22136-141">Ele pode apenas substituir a pasta de saída padrão (opção 1) ou renomear a pasta (opção 2) e, em seguida, gravar a saída na nova pasta de saída padrão SQLDIAG.</span><span class="sxs-lookup"><span data-stu-id="22136-141">It can only overwrite the default output folder (option 1) or rename the folder (option 2), and then it writes output to the new default output folder named SQLDIAG.</span></span>  
  
 <span data-ttu-id="22136-142">**/M** _machine1_ [ *machine2 \* \* máquinan*] |*@machinelistfile*</span><span class="sxs-lookup"><span data-stu-id="22136-142">**/M** _machine1_ [ *machine2\*\*machineN*] | *@machinelistfile*</span></span>  
 <span data-ttu-id="22136-143">Substitui as máquinas especificadas no arquivo de configuração.</span><span class="sxs-lookup"><span data-stu-id="22136-143">Overrides the machines specified in the configuration file.</span></span> <span data-ttu-id="22136-144">Por padrão, o arquivo de configuração é SQLDiag.Xml ou é definido com o parâmetro **/I** .</span><span class="sxs-lookup"><span data-stu-id="22136-144">By default the configuration file is SQLDiag.Xml, or is set with the **/I** parameter.</span></span> <span data-ttu-id="22136-145">Ao especificar mais de uma máquina, separe cada nome de máquina com um espaço.</span><span class="sxs-lookup"><span data-stu-id="22136-145">When specifying more than one machine, separate each machine name with a space.</span></span>  
  
 <span data-ttu-id="22136-146">Usando *@machinelistfile* especifica um nome de arquivo de lista de máquinas a ser armazenado no arquivo de configuração.</span><span class="sxs-lookup"><span data-stu-id="22136-146">Using *@machinelistfile* specifies a machine list filename to be stored in the configuration file.</span></span>  
  
 <span data-ttu-id="22136-147">**/C** _file_compression_type_</span><span class="sxs-lookup"><span data-stu-id="22136-147">**/C** _file_compression_type_</span></span>  
 <span data-ttu-id="22136-148">Define o tipo de compactação de arquivo usado nos arquivos da pasta de saída do **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="22136-148">Sets the type of file compression used on the **SQLdiag** output folder files.</span></span> <span data-ttu-id="22136-149">Opções disponíveis:</span><span class="sxs-lookup"><span data-stu-id="22136-149">Available options:</span></span>  
  
 <span data-ttu-id="22136-150">0 = nenhum (padrão)</span><span class="sxs-lookup"><span data-stu-id="22136-150">0 = none (default)</span></span>  
  
 <span data-ttu-id="22136-151">1 = usa compactação NTFS</span><span class="sxs-lookup"><span data-stu-id="22136-151">1 = uses NTFS compression</span></span>  
  
 <span data-ttu-id="22136-152">**/B** [ **+** ]*start_time*</span><span class="sxs-lookup"><span data-stu-id="22136-152">**/B** [**+**]*start_time*</span></span>  
 <span data-ttu-id="22136-153">Especifica a data e a hora para começar a coletar dados de diagnóstico no seguinte formato:</span><span class="sxs-lookup"><span data-stu-id="22136-153">Specifies the date and time to start collecting diagnostic data in the following format:</span></span>  
  
 <span data-ttu-id="22136-154">AAAAMMDD_HH:MM:SS</span><span class="sxs-lookup"><span data-stu-id="22136-154">YYYYMMDD_HH:MM:SS</span></span>  
  
 <span data-ttu-id="22136-155">A hora é especificada usando a notação de 24 horas.</span><span class="sxs-lookup"><span data-stu-id="22136-155">The time is specified using 24-hour notation.</span></span> <span data-ttu-id="22136-156">Por exemplo, 2:00 P.M.</span><span class="sxs-lookup"><span data-stu-id="22136-156">For example, 2:00 P.M.</span></span> <span data-ttu-id="22136-157">deveria ser especificado como **14:00:00**.</span><span class="sxs-lookup"><span data-stu-id="22136-157">should be specified as **14:00:00**.</span></span>  
  
 <span data-ttu-id="22136-158">Use **+** sem a data (apenas HH:MM:SS) para especificar uma hora relativa à data e à hora atuais.</span><span class="sxs-lookup"><span data-stu-id="22136-158">Use **+** without the date (HH:MM:SS only) to specify a time that is relative to the current date and time.</span></span> <span data-ttu-id="22136-159">Por exemplo, se você especificar **/B +02:00:00: 00:00**, o **SQLdiag** aguardará duas horas antes de começar a coletar informações.</span><span class="sxs-lookup"><span data-stu-id="22136-159">For example, if you specify **/B +02:00:00**, **SQLdiag** will wait 2 hours before it starts collecting information.</span></span>  
  
 <span data-ttu-id="22136-160">Não insira espaço entre **+** e o *start_time*especificado.</span><span class="sxs-lookup"><span data-stu-id="22136-160">Do not insert a space between **+** and the specified *start_time*.</span></span>  
  
 <span data-ttu-id="22136-161">Se você especificar uma hora de início no passado, o **SQLdiag** forçará a alteração da data de modo que a data e a hora de início estejam no futuro.</span><span class="sxs-lookup"><span data-stu-id="22136-161">If you specify a start time that is in the past, **SQLdiag** forcibly changes the start date so the start date and time are in the future.</span></span> <span data-ttu-id="22136-162">Por exemplo, se você especificar **/B 01:00:00** e a hora atual for 08:00:00, o **SQLdiag** forçará a alteração da data de início de modo que a data de início seja no dia seguinte.</span><span class="sxs-lookup"><span data-stu-id="22136-162">For example, if you specify **/B 01:00:00** and the current time is 08:00:00, **SQLdiag** forcibly changes the start date so that the start date is the next day.</span></span>  
  
 <span data-ttu-id="22136-163">Observe que o **SQLdiag** usa a hora local no computador no qual o utilitário está sendo executado.</span><span class="sxs-lookup"><span data-stu-id="22136-163">Note that **SQLdiag** uses the local time on the computer where the utility is running.</span></span>  
  
 <span data-ttu-id="22136-164">**/E** [ **+** ]*stop_time*</span><span class="sxs-lookup"><span data-stu-id="22136-164">**/E** [**+**]*stop_time*</span></span>  
 <span data-ttu-id="22136-165">Especifica a data e a hora para interromper a coleta de dados de diagnóstico no seguinte formato:</span><span class="sxs-lookup"><span data-stu-id="22136-165">Specifies the date and time to stop collecting diagnostic data in the following format:</span></span>  
  
 <span data-ttu-id="22136-166">AAAAMMDD_HH:MM:SS</span><span class="sxs-lookup"><span data-stu-id="22136-166">YYYYMMDD_HH:MM:SS</span></span>  
  
 <span data-ttu-id="22136-167">A hora é especificada usando a notação de 24 horas.</span><span class="sxs-lookup"><span data-stu-id="22136-167">The time is specified using 24-hour notation.</span></span> <span data-ttu-id="22136-168">Por exemplo, 2:00 P.M.</span><span class="sxs-lookup"><span data-stu-id="22136-168">For example, 2:00 P.M.</span></span> <span data-ttu-id="22136-169">deveria ser especificado como **14:00:00**.</span><span class="sxs-lookup"><span data-stu-id="22136-169">should be specified as **14:00:00**.</span></span>  
  
 <span data-ttu-id="22136-170">Use **+** sem a data (apenas HH:MM:SS) para especificar uma hora relativa à data e à hora atuais.</span><span class="sxs-lookup"><span data-stu-id="22136-170">Use **+** without the date (HH:MM:SS only) to specify a time that is relative to the current date and time.</span></span> <span data-ttu-id="22136-171">Por exemplo, se você especificar uma hora de início e uma hora de término usando **/B +02:00:00 /E +03:00:00**, o **SQLdiag** aguardará duas horas antes de começar a coletar informações, e coletará informações durante três horas antes de parar e fechar.</span><span class="sxs-lookup"><span data-stu-id="22136-171">For example, if you specify a start time and end time by using **/B +02:00:00 /E +03:00:00**, **SQLdiag** waits 2 hours before it starts collecting information, then collects information for 3 hours before it stops and exits.</span></span> <span data-ttu-id="22136-172">Se **/B** não for especificado, o **SQLdiag** começará a coletar o diagnóstico imediatamente e terminará na data e hora especificadas por **/E**.</span><span class="sxs-lookup"><span data-stu-id="22136-172">If **/B** is not specified, **SQLdiag** starts collecting diagnostics immediately and ends at the date and time specified by **/E**.</span></span>  
  
 <span data-ttu-id="22136-173">Não insira espaço entre **+** e o *start_time* ou *end_time*especificado.</span><span class="sxs-lookup"><span data-stu-id="22136-173">Do not insert a space between **+** and the specified *start_time* or *end_time*.</span></span>  
  
 <span data-ttu-id="22136-174">Observe que o **SQLdiag** usa a hora local no computador no qual o utilitário está sendo executado.</span><span class="sxs-lookup"><span data-stu-id="22136-174">Note that **SQLdiag** uses the local time on the computer where the utility is running.</span></span>  
  
 <span data-ttu-id="22136-175">**/A** _SQLdiag_application_name_</span><span class="sxs-lookup"><span data-stu-id="22136-175">**/A** _SQLdiag_application_name_</span></span>  
 <span data-ttu-id="22136-176">Habilita a execução de várias instâncias do utilitário **SQLdiag** na mesma instância do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="22136-176">Enables running multiple instances of the **SQLdiag** utility against the same [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] instance.</span></span>  
  
 <span data-ttu-id="22136-177">Cada *SQLdiag_application_name* identifica uma instância diferente do **SQLdiag**.</span><span class="sxs-lookup"><span data-stu-id="22136-177">Each *SQLdiag_application_name* identifies a different instance of **SQLdiag**.</span></span> <span data-ttu-id="22136-178">Não existe relação entre uma instância do *SQLdiag_application_name* e um nome de instância do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="22136-178">No relationship exists between a *SQLdiag_application_name* instance and a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] instance name.</span></span>  
  
 <span data-ttu-id="22136-179">*SQLdiag_application_name* pode ser usado para iniciar ou interromper uma instância específica de serviço do **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="22136-179">*SQLdiag_application_name* can be used to start or stop a specific instance of the **SQLdiag** service.</span></span>  
  
 <span data-ttu-id="22136-180">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="22136-180">For example:</span></span>  
  
 <span data-ttu-id="22136-181">**SQLDIAG START /A** _SQLdiag_application_name_</span><span class="sxs-lookup"><span data-stu-id="22136-181">**SQLDIAG START /A** _SQLdiag_application_name_</span></span>  
  
 <span data-ttu-id="22136-182">Também pode ser usado com a opção **/R** para registrar uma instância específica do **SQLdiag** como um serviço.</span><span class="sxs-lookup"><span data-stu-id="22136-182">It can also be used with the **/R** option to register a specific instance of **SQLdiag** as a service.</span></span> <span data-ttu-id="22136-183">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="22136-183">For example:</span></span>  
  
 <span data-ttu-id="22136-184">**SQLDIAG /R /A** _SQLdiag_application_name_</span><span class="sxs-lookup"><span data-stu-id="22136-184">**SQLDIAG /R /A** _SQLdiag_application_name_</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="22136-185">O**SQLdiag** adiciona automaticamente o prefixo DIAG$ ao nome de instância especificado para *SQLdiag_application_name*.</span><span class="sxs-lookup"><span data-stu-id="22136-185">**SQLdiag** automatically prefixes DIAG$ to the instance name specified for *SQLdiag_application_name*.</span></span> <span data-ttu-id="22136-186">Isso fornecerá um nome de serviço sensato se você registrar o **SQLdiag** como um serviço.</span><span class="sxs-lookup"><span data-stu-id="22136-186">This provides a sensible service name if you register **SQLdiag** as a service.</span></span>  
  
 <span data-ttu-id="22136-187">/T { tcp [ ,*porta* ] | np | lpc }</span><span class="sxs-lookup"><span data-stu-id="22136-187">/T { tcp [ ,*port* ] | np | lpc }</span></span>  
 <span data-ttu-id="22136-188">Conecta a uma instância do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] usando o protocolo especificado.</span><span class="sxs-lookup"><span data-stu-id="22136-188">Connects to an instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] using the specified protocol.</span></span>  
  
 <span data-ttu-id="22136-189">tcp [,*porta*]</span><span class="sxs-lookup"><span data-stu-id="22136-189">tcp [,*port*]</span></span>  
 <span data-ttu-id="22136-190">Protocolo TCP/IP.</span><span class="sxs-lookup"><span data-stu-id="22136-190">Transmission Control Protocol/Internet Protocol (TCP/IP).</span></span> <span data-ttu-id="22136-191">Opcionalmente, é possível especificar um número de porta para a conexão.</span><span class="sxs-lookup"><span data-stu-id="22136-191">You can optionally specify a port number for the connection.</span></span>  
  
 <span data-ttu-id="22136-192">np</span><span class="sxs-lookup"><span data-stu-id="22136-192">np</span></span>  
 <span data-ttu-id="22136-193">Pipes nomeados.</span><span class="sxs-lookup"><span data-stu-id="22136-193">Named pipes.</span></span> <span data-ttu-id="22136-194">Por padrão, a instância padrão do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] escuta nos pipes nomeados `\\.\pipe\sql\query` e `\\.\pipe\MSSQL$<instancename>\sql\query` em busca de uma instância nomeada.</span><span class="sxs-lookup"><span data-stu-id="22136-194">By default, the default instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] listens on named pipe `\\.\pipe\sql\query` and `\\.\pipe\MSSQL$<instancename>\sql\query` for a named instance.</span></span> <span data-ttu-id="22136-195">Não é possível conectar a uma instância do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] usando um nome de pipe alternado.</span><span class="sxs-lookup"><span data-stu-id="22136-195">You cannot connect to an instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] by using an alternate pipe name.</span></span>  
  
 <span data-ttu-id="22136-196">lpc</span><span class="sxs-lookup"><span data-stu-id="22136-196">lpc</span></span>  
 <span data-ttu-id="22136-197">Chamada de procedimento local.</span><span class="sxs-lookup"><span data-stu-id="22136-197">Local procedure call.</span></span> <span data-ttu-id="22136-198">Esse protocolo de memória compartilhada também estará disponível se o cliente estiver se conectando a uma instância do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] no mesmo computador.</span><span class="sxs-lookup"><span data-stu-id="22136-198">This shared memory protocol is available if the client is connecting to an instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] on the same computer.</span></span>  
  
 <span data-ttu-id="22136-199">**/Q**</span><span class="sxs-lookup"><span data-stu-id="22136-199">**/Q**</span></span>  
 <span data-ttu-id="22136-200">Executa o **SQLdiag** no modo silencioso.</span><span class="sxs-lookup"><span data-stu-id="22136-200">Runs **SQLdiag** in quiet mode.</span></span> <span data-ttu-id="22136-201">**/Q** suprime todos os prompts, como prompts de senha.</span><span class="sxs-lookup"><span data-stu-id="22136-201">**/Q** suppresses all prompts, such as password prompts.</span></span>  
  
 <span data-ttu-id="22136-202">**/G**</span><span class="sxs-lookup"><span data-stu-id="22136-202">**/G**</span></span>  
 <span data-ttu-id="22136-203">Executa o **SQLdiag** no modo genérico.</span><span class="sxs-lookup"><span data-stu-id="22136-203">Runs **SQLdiag** in generic mode.</span></span> <span data-ttu-id="22136-204">Quando **/G** é especificado, ao ser inicializado, o **SQLdiag** não impõe a verificação de conectividade do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] ou verifica se o usuário é membro da função de servidor fixa **sysadmin** .</span><span class="sxs-lookup"><span data-stu-id="22136-204">When **/G** is specified, on startup **SQLdiag** does not enforce [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] connectivity checks or verify that the user is a member of the **sysadmin** fixed server role.</span></span> <span data-ttu-id="22136-205">Em vez disso, o **SQLdiag** transfere ao Windows a responsabilidade por determinar se um usuário tem os direitos apropriados para coletar cada diagnóstico solicitado.</span><span class="sxs-lookup"><span data-stu-id="22136-205">Instead, **SQLdiag** defers to Windows to determine whether a user has the appropriate rights to gather each requested diagnostic.</span></span>  
  
 <span data-ttu-id="22136-206">Se **/G** não for especificado, o **SQLdiag** verificará se o usuário é membro do grupo **Administradores** do Windows e não coletará diagnósticos do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] se o usuário não for membro do grupo **Administradores** .</span><span class="sxs-lookup"><span data-stu-id="22136-206">If **/G** is not specified, **SQLdiag** checks to determine whether the user is a member of the Windows **Administrators** group, and will not collect [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] diagnostics if the user is not an **Administrators** group member.</span></span>  
  
 <span data-ttu-id="22136-207">**/R**</span><span class="sxs-lookup"><span data-stu-id="22136-207">**/R**</span></span>  
 <span data-ttu-id="22136-208">Registra o **SQLdiag** como um serviço.</span><span class="sxs-lookup"><span data-stu-id="22136-208">Registers **SQLdiag** as a service.</span></span> <span data-ttu-id="22136-209">Quaisquer argumentos de linha de comando especificados ao registrar o **SQLdiag** como um serviço são preservados para execuções futuras do serviço.</span><span class="sxs-lookup"><span data-stu-id="22136-209">Any command line arguments that are specified when you register **SQLdiag** as a service are preserved for future runs of the service.</span></span>  
  
 <span data-ttu-id="22136-210">Quando o **SQLdiag** é registrado como um serviço, o nome de serviço padrão fica SQLDIAG.</span><span class="sxs-lookup"><span data-stu-id="22136-210">When **SQLdiag** is registered as a service, the default service name is SQLDIAG.</span></span> <span data-ttu-id="22136-211">Você pode alterar o nome de serviço usando o argumento **/A** .</span><span class="sxs-lookup"><span data-stu-id="22136-211">You can change the service name by using the **/A** argument.</span></span>  
  
 <span data-ttu-id="22136-212">Use o argumento de linha de comando **START** para iniciar o serviço:</span><span class="sxs-lookup"><span data-stu-id="22136-212">Use the **START** command line argument to start the service:</span></span>  
  
 <span data-ttu-id="22136-213">**SQLDIAG START**</span><span class="sxs-lookup"><span data-stu-id="22136-213">**SQLDIAG START**</span></span>  
  
 <span data-ttu-id="22136-214">Você também pode usar o comando **net start** para iniciar o serviço:</span><span class="sxs-lookup"><span data-stu-id="22136-214">You can also use the **net start** command to start the service:</span></span>  
  
 <span data-ttu-id="22136-215">**net start SQLDIAG**</span><span class="sxs-lookup"><span data-stu-id="22136-215">**net start SQLDIAG**</span></span>  
  
 <span data-ttu-id="22136-216">**/U**</span><span class="sxs-lookup"><span data-stu-id="22136-216">**/U**</span></span>  
 <span data-ttu-id="22136-217">Cancela o registro do **SQLdiag** como um serviço.</span><span class="sxs-lookup"><span data-stu-id="22136-217">Unregisters **SQLdiag** as a service.</span></span>  
  
 <span data-ttu-id="22136-218">Use o argumento **/A** se também for cancelar o registro de uma instância nomeada do **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="22136-218">Use the **/A** argument also if unregistering a named **SQLdiag** instance.</span></span>  
  
 <span data-ttu-id="22136-219">**/L**</span><span class="sxs-lookup"><span data-stu-id="22136-219">**/L**</span></span>  
 <span data-ttu-id="22136-220">Executa o **SQLdiag** no modo contínuo quando uma hora de início ou de término também é especificada com os argumentos **/B** ou **/E** , respectivamente.</span><span class="sxs-lookup"><span data-stu-id="22136-220">Runs **SQLdiag** in continuous mode when a start time or end time is also specified with the **/B** or **/E** arguments, respectively.</span></span> <span data-ttu-id="22136-221">O**SQLdiag** reinicia automaticamente depois que a coleta de diagnósticos é interrompida devido a um desligamento agendado.</span><span class="sxs-lookup"><span data-stu-id="22136-221">**SQLdiag** automatically restarts after diagnostics collection stops due to a scheduled shutdown.</span></span> <span data-ttu-id="22136-222">Por exemplo, usando o argumento **/E** ou **/X** .</span><span class="sxs-lookup"><span data-stu-id="22136-222">For example, by using the **/E** or the **/X** arguments.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="22136-223">O**SQLdiag** ignorar o argumento **/L** se uma hora de início ou de término não for especificada useo os argumentos de linha de comeo **/B** e **/E** comme line arguments.</span><span class="sxs-lookup"><span data-stu-id="22136-223">**SQLdiag** ignores the **/L** argument if a start time or end time is not specified by using the **/B** and **/E** command line arguments.</span></span>  
  
 <span data-ttu-id="22136-224">Usar **/L** não implica o modo de serviço.</span><span class="sxs-lookup"><span data-stu-id="22136-224">Using **/L** does not imply the service mode.</span></span> <span data-ttu-id="22136-225">Para usar **/L** ao executar o **SQLdiag** como um serviço, especifique-o na linha de comando quando você registrar o serviço.</span><span class="sxs-lookup"><span data-stu-id="22136-225">To use **/L** when running **SQLdiag** as a service, specify it on the command line when you register the service.</span></span>  
  
 <span data-ttu-id="22136-226">**/X**</span><span class="sxs-lookup"><span data-stu-id="22136-226">**/X**</span></span>  
 <span data-ttu-id="22136-227">Executa o **SQLdiag** no modo de instantâneo.</span><span class="sxs-lookup"><span data-stu-id="22136-227">Runs **SQLdiag** in snapshot mode.</span></span> <span data-ttu-id="22136-228">O**SQLdiag** tira um instantâneo de todo o diagnóstico configurado e desliga automaticamente.</span><span class="sxs-lookup"><span data-stu-id="22136-228">**SQLdiag** takes a snapshot of all configured diagnostics and then shuts down automatically.</span></span>  
  
 <span data-ttu-id="22136-229">**START** | **STOP** | **STOP_ABORT**</span><span class="sxs-lookup"><span data-stu-id="22136-229">**START** | **STOP** | **STOP_ABORT**</span></span>  
 <span data-ttu-id="22136-230">Inicia ou interrompe o serviço do **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="22136-230">Starts or stops the **SQLdiag** service.</span></span> <span data-ttu-id="22136-231">**STOP_ABORT** força o serviço a desligar o mais rápido possível sem terminar a coleção de diagnóstico atual.</span><span class="sxs-lookup"><span data-stu-id="22136-231">**STOP_ABORT** forces the service to shut down as quickly as possible without finishing collection of diagnostics it is currently collecting.</span></span>  
  
 <span data-ttu-id="22136-232">Quando esses argumentos de controle de serviço forem usados, eles deverão ser o primeiro argumento usado na linha de comando.</span><span class="sxs-lookup"><span data-stu-id="22136-232">When these service control arguments are used, they must be the first argument used on the command line.</span></span> <span data-ttu-id="22136-233">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="22136-233">For example:</span></span>  
  
 <span data-ttu-id="22136-234">**SQLDIAG START**</span><span class="sxs-lookup"><span data-stu-id="22136-234">**SQLDIAG START**</span></span>  
  
 <span data-ttu-id="22136-235">Somente o argumento **/A** , que especifica uma instância nomeada do **SQLdiag**, pode ser usado com **START**, **STOP**ou **STOP_ABORT** para controlar uma instância específica do serviço **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="22136-235">Only the **/A** argument, which specifies a named instance of **SQLdiag**, can be used with **START**, **STOP**, or **STOP_ABORT** to control a specific instance of the **SQLdiag** service.</span></span> <span data-ttu-id="22136-236">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="22136-236">For example:</span></span>  
  
 <span data-ttu-id="22136-237">**SQLDIAG START /A** _SQLdiag_application_name_</span><span class="sxs-lookup"><span data-stu-id="22136-237">**SQLDIAG START /A** _SQLdiag_application_name_</span></span>  
  
## <a name="security-requirements"></a><span data-ttu-id="22136-238">Requisitos de segurança</span><span class="sxs-lookup"><span data-stu-id="22136-238">Security Requirements</span></span>  
 <span data-ttu-id="22136-239">A não ser que o **SQLdiag** seja executado no modo genérico (especificando o argumento de linha de comando **/G** ), o usuário que está executando o **SQLdiag** deverá ser membro do grupo **Administradores** do Windows e membro da função de servidor fixa [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] **sysadmin**.</span><span class="sxs-lookup"><span data-stu-id="22136-239">Unless **SQLdiag** is run in generic mode (by specifying the **/G** command line argument), the user who runs **SQLdiag** must be a member of the Windows **Administrators** group and a member of the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] **sysadmin** fixed server role.</span></span> <span data-ttu-id="22136-240">Por padrão, o **SQLdiag** conecta-se ao [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] usando a Autenticação do Windows, mas também tem suporte para a Autenticação do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="22136-240">By default, **SQLdiag** connects to [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] by using Windows Authentication, but it also supports [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Authentication.</span></span>  
  
## <a name="performance-considerations"></a><span data-ttu-id="22136-241">Considerações sobre desempenho</span><span class="sxs-lookup"><span data-stu-id="22136-241">Performance Considerations</span></span>  
 <span data-ttu-id="22136-242">Os efeitos no desempenho da execução do **SQLdiag** dependem do tipo de dados de diagnóstico que você configurou para coletar.</span><span class="sxs-lookup"><span data-stu-id="22136-242">The performance effects of running **SQLdiag** depend on the type of diagnostic data you have configured it to collect.</span></span> <span data-ttu-id="22136-243">Por exemplo, se você configurou o **SQLdiag** para coletar informações de rastreamento do [!INCLUDE[ssSqlProfiler](../includes/sssqlprofiler-md.md)] , quanto maior o número de classes de evento que você escolher para rastreamento, mais o desempenho do servidor será afetado.</span><span class="sxs-lookup"><span data-stu-id="22136-243">For example, if you have configured **SQLdiag** to collect [!INCLUDE[ssSqlProfiler](../includes/sssqlprofiler-md.md)] tracing information, the more event classes you choose to trace, the more your server performance is affected.</span></span>  
  
 <span data-ttu-id="22136-244">O impacto no desempenho ao executar o **SQLdiag** é aproximadamente equivalente à soma dos custos de coleta do diagnóstico configurado separadamente.</span><span class="sxs-lookup"><span data-stu-id="22136-244">The performance impact of running **SQLdiag** is approximately equivalent to the sum of the costs of collecting the configured diagnostics separately.</span></span> <span data-ttu-id="22136-245">Por exemplo, coletar um rastreamento com o **SQLdiag** gera o mesmo custo de desempenho que coletá-lo com o [!INCLUDE[ssSqlProfiler](../includes/sssqlprofiler-md.md)].</span><span class="sxs-lookup"><span data-stu-id="22136-245">For example, collecting a trace with **SQLdiag** incurs the same performance cost as collecting it with [!INCLUDE[ssSqlProfiler](../includes/sssqlprofiler-md.md)].</span></span> <span data-ttu-id="22136-246">O impacto no desempenho ao usar o **SQLdiag** é desprezível.</span><span class="sxs-lookup"><span data-stu-id="22136-246">The performance impact of using **SQLdiag** is negligible.</span></span>  
  
## <a name="required-disk-space"></a><span data-ttu-id="22136-247">Espaço em disco exigido</span><span class="sxs-lookup"><span data-stu-id="22136-247">Required Disk Space</span></span>  
 <span data-ttu-id="22136-248">Como o **SQLdiag** pode coletar diferentes tipos de informações de diagnóstico, o espaço em disco livre exigido para executar o **SQLdiag** varia.</span><span class="sxs-lookup"><span data-stu-id="22136-248">Because **SQLdiag** can collect different types of diagnostic information, the free disk space that is required to run **SQLdiag** varies.</span></span> <span data-ttu-id="22136-249">A quantidade de informações de diagnóstico coletada depende da natureza e do volume da carga de trabalho que o servidor está processando e pode variar de alguns megabytes a vários gigabytes.</span><span class="sxs-lookup"><span data-stu-id="22136-249">The amount of diagnostic information collected depends on the nature and volume of the workload that the server is processing and may range from a few megabytes to several gigabytes.</span></span>  
  
## <a name="configuration-files"></a><span data-ttu-id="22136-250">Arquivos de configuração</span><span class="sxs-lookup"><span data-stu-id="22136-250">Configuration Files</span></span>  
 <span data-ttu-id="22136-251">Ao inicializar, o **SQLdiag** lê o arquivo de configuração e os argumentos de linha de comando que foram especificados.</span><span class="sxs-lookup"><span data-stu-id="22136-251">On startup, **SQLdiag** reads the configuration file and the command line arguments that have been specified.</span></span> <span data-ttu-id="22136-252">Você especifica os tipos de informações de diagnóstico que o **SQLdiag** coleta no arquivo de configuração.</span><span class="sxs-lookup"><span data-stu-id="22136-252">You specify the types of diagnostic information that **SQLdiag** collects in the configuration file.</span></span> <span data-ttu-id="22136-253">Por padrão, o **SQLdiag** utiliza o arquivo de configuração SQLDiag.Xml, extraído sempre que a ferramenta é executada e localizado na pasta de inicialização do utilitário **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="22136-253">By default, **SQLdiag** uses the SQLDiag.Xml configuration file, which is extracted each time the tool runs and is located in the **SQLdiag** utility startup folder.</span></span> <span data-ttu-id="22136-254">O arquivo de configuração utiliza o esquema XML, SQLDiag_schema.xsd, que também é extraído no diretório de inicialização do utilitário por meio do arquivo executável sempre que o **SQLdiag** é executado.</span><span class="sxs-lookup"><span data-stu-id="22136-254">The configuration file uses the XML schema, SQLDiag_schema.xsd, which is also extracted into the utility startup directory from the executable file each time **SQLdiag** runs.</span></span>  
  
### <a name="editing-the-configuration-files"></a><span data-ttu-id="22136-255">Editando os arquivos de configuração</span><span class="sxs-lookup"><span data-stu-id="22136-255">Editing the Configuration Files</span></span>  
 <span data-ttu-id="22136-256">Você pode copiar e editar o SQLDiag.Xml para alterar os tipos de dados de diagnóstico que o **SQLdiag** coleta.</span><span class="sxs-lookup"><span data-stu-id="22136-256">You can copy and edit SQLDiag.Xml to change the types of diagnostic data that **SQLdiag** collects.</span></span> <span data-ttu-id="22136-257">Ao editar o arquivo de configuração, sempre use um editor de XML que pode validar o arquivo de configuração em seu esquema XML como o [!INCLUDE[ssManStudio](../includes/ssmanstudio-md.md)].</span><span class="sxs-lookup"><span data-stu-id="22136-257">When editing the configuration file always use an XML editor that can validate the configuration file against its XML schema, such as [!INCLUDE[ssManStudio](../includes/ssmanstudio-md.md)].</span></span> <span data-ttu-id="22136-258">Você não deve editar SQLDiag.Xml diretamente.</span><span class="sxs-lookup"><span data-stu-id="22136-258">You should not edit SQLDiag.Xml directly.</span></span> <span data-ttu-id="22136-259">Em vez disso, faça uma cópia do SQLDiag.Xml e renomeie-a com um novo nome de arquivo na mesma pasta.</span><span class="sxs-lookup"><span data-stu-id="22136-259">Instead, make a copy of SQLDiag.Xml and rename it to a new file name in the same folder.</span></span> <span data-ttu-id="22136-260">Em seguida, edite o novo arquivo e use o argumento **/I** para passá-lo para o **SQLdiag**.</span><span class="sxs-lookup"><span data-stu-id="22136-260">Then edit the new file, and use the **/I** argument to pass it to **SQLdiag**.</span></span>  
  
#### <a name="editing-the-configuration-file-when-sqldiag-runs-as-a-service"></a><span data-ttu-id="22136-261">Editando o arquivo de configuração quando o SQLdiag é executado como um serviço</span><span class="sxs-lookup"><span data-stu-id="22136-261">Editing the Configuration File When SQLdiag Runs as a Service</span></span>  
 <span data-ttu-id="22136-262">Se você já executou o **SQLdiag** como um serviço e precisa editar o arquivo de configuração, cancele o registro do serviço SQLDIAG especificando o argumento de linha de comando **/U** e registre o serviço novamente usando o argumento de linha de comando **/R** .</span><span class="sxs-lookup"><span data-stu-id="22136-262">If you have already run **SQLdiag** as a service and need to edit the configuration file, unregister the SQLDIAG service by specifying the **/U** command line argument and then re-register the service by using the **/R** command line argument.</span></span> <span data-ttu-id="22136-263">Cancelar o registro e registrar novamente o serviço remove informações de configuração antigas que foram armazenadas no registro do Windows.</span><span class="sxs-lookup"><span data-stu-id="22136-263">Unregistering and re-registering the service removes old configuration information that was cached in the Windows registry.</span></span>  
  
## <a name="output-folder"></a><span data-ttu-id="22136-264">Pasta de saída</span><span class="sxs-lookup"><span data-stu-id="22136-264">Output Folder</span></span>  
 <span data-ttu-id="22136-265">Se você não especificar uma pasta de saída com o argumento **/O** , o **SQLdiag** criará uma subpasta chamada SQLDIAG na pasta de inicialização do **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="22136-265">If you do not specify an output folder with the **/O** argument, **SQLdiag** creates a subfolder named SQLDIAG under the **SQLdiag** startup folder.</span></span> <span data-ttu-id="22136-266">Para coleção de informações de diagnóstico que envolva rastreamentos de grande volume, como o [!INCLUDE[ssSqlProfiler](../includes/sssqlprofiler-md.md)] , verifique se a pasta de saída está em uma unidade local com espaço suficiente para armazenar a saída de diagnóstico solicitada.</span><span class="sxs-lookup"><span data-stu-id="22136-266">For diagnostic information collection that involves high volume tracing, such as [!INCLUDE[ssSqlProfiler](../includes/sssqlprofiler-md.md)] , make sure that the output folder is on a local drive with enough space to store the requested diagnostic output.</span></span>  
  
 <span data-ttu-id="22136-267">Quando o **SQLdiag** é reiniciado, ele substitui o conteúdo da pasta de saída.</span><span class="sxs-lookup"><span data-stu-id="22136-267">When **SQLdiag** is restarted, it overwrites the contents of the output folder.</span></span> <span data-ttu-id="22136-268">Para evitar isso, especifique a linha de comando **/N 2** .</span><span class="sxs-lookup"><span data-stu-id="22136-268">To avoid this, specify **/N 2** on the command line.</span></span>  
  
## <a name="data-collection-process"></a><span data-ttu-id="22136-269">Processo de coleção de dados</span><span class="sxs-lookup"><span data-stu-id="22136-269">Data Collection Process</span></span>  
 <span data-ttu-id="22136-270">Quando o **SQLdiag** é inicializado, ele desempenha as verificações de inicialização necessárias para coletar os dados de diagnóstico que foram especificados no SQLDiag.Xml.</span><span class="sxs-lookup"><span data-stu-id="22136-270">When **SQLdiag** starts, it performs the initialization checks necessary to collect the diagnostic data that have been specified in SQLDiag.Xml.</span></span> <span data-ttu-id="22136-271">Esse processo pode demorar vários segundos.</span><span class="sxs-lookup"><span data-stu-id="22136-271">This process may take several seconds.</span></span> <span data-ttu-id="22136-272">Depois que o **SQLdiag** começar a coletar os dados de diagnóstico ao ser executado como um aplicativo do console, uma mensagem é exibida informando que a coleta do **SQLdiag** começou e que você pode pressionar CTRL+C para interrompê-la.</span><span class="sxs-lookup"><span data-stu-id="22136-272">After **SQLdiag** has started collecting diagnostic data when it is run as a console application, a message displays informing you that **SQLdiag** collection has started and that you can press CTRL+C to stop it.</span></span> <span data-ttu-id="22136-273">Quando o **SQLdiag** é executado como um serviço, uma mensagem semelhante é gravada no log de eventos do Windows.</span><span class="sxs-lookup"><span data-stu-id="22136-273">When **SQLdiag** is run as a service, a similar message is written to the Windows event log.</span></span>  
  
 <span data-ttu-id="22136-274">Se você estiver usando o **SQLdiag** para diagnosticar um problema que você pode reproduzir, espere até receber essa mensagem antes de reproduzir o problema em seu servidor.</span><span class="sxs-lookup"><span data-stu-id="22136-274">If you are using **SQLdiag** to diagnose a problem that you can reproduce, wait until you receive this message before you reproduce the problem on your server.</span></span>  
  
 <span data-ttu-id="22136-275">O**SQLdiag** coleta a maioria dos dados de diagnóstico em paralelo.</span><span class="sxs-lookup"><span data-stu-id="22136-275">**SQLdiag** collects most diagnostic data in parallel.</span></span> <span data-ttu-id="22136-276">Todas as informações de diagnóstico são coletadas por meio da conexão com as ferramentas, como o utilitário [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] **sqlcmd** ou o processador de comandos do Windows, exceto quando as informações são coletadas dos logs de desempenho e logs de evento do Windows.</span><span class="sxs-lookup"><span data-stu-id="22136-276">All diagnostic information is collected by connecting to tools, such as the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] **sqlcmd** utility or the Windows command processor, except when information is collected from Windows performance logs and event logs.</span></span> <span data-ttu-id="22136-277">O**SQLdiag** utiliza um thread de trabalho por computador para monitorar a coleção de dados de diagnóstico dessas outras ferramentas, frequentemente aguardando a conclusão de várias ferramentas simultaneamente.</span><span class="sxs-lookup"><span data-stu-id="22136-277">**SQLdiag** uses one worker thread per computer to monitor the diagnostic data collection of these other tools, often simultaneously waiting for several tools to complete.</span></span> <span data-ttu-id="22136-278">Durante o processo de coleta, o **SQLdiag** roteia a saída de cada diagnóstico para a pasta de saída.</span><span class="sxs-lookup"><span data-stu-id="22136-278">During the collection process, **SQLdiag** routes the output from each diagnostic to the output folder.</span></span>  
  
## <a name="stopping-data-collection"></a><span data-ttu-id="22136-279">Interrompendo a coleção de dados</span><span class="sxs-lookup"><span data-stu-id="22136-279">Stopping Data Collection</span></span>  
 <span data-ttu-id="22136-280">Depois que o **SQLdiag** começar a coletar dados de diagnóstico, ele continuará a fazê-lo, a não ser que você o interrompa ou ele esteja configurado para ser interrompido em um determinado horário.</span><span class="sxs-lookup"><span data-stu-id="22136-280">After **SQLdiag** starts collecting diagnostic data, it continues to do so unless you stop it or it is configured to stop at a specified time.</span></span> <span data-ttu-id="22136-281">Você pode configurar o **SQLdiag** para ser interrompido em uma hora especificada usando o argumento **/E** , que permite que você especifique uma hora de parada ou usando o argumento **/X** , que executa o **SQLdiag** no modo de instantâneo.</span><span class="sxs-lookup"><span data-stu-id="22136-281">You can configure **SQLdiag** to stop at a specified time by using the **/E** argument, which allows you to specify a stop time, or by using the **/X** argument, which causes **SQLdiag** to run in snapshot mode.</span></span>  
  
 <span data-ttu-id="22136-282">Quando o **SQLdiag** é interrompido, ele interrompe todos os diagnósticos iniciados.</span><span class="sxs-lookup"><span data-stu-id="22136-282">When **SQLdiag** stops, it stops all diagnostics it has started.</span></span> <span data-ttu-id="22136-283">Por exemplo, ele interrompe os rastreamentos que o [!INCLUDE[ssSqlProfiler](../includes/sssqlprofiler-md.md)] estava coletando, a execução de scripts [!INCLUDE[tsql](../includes/tsql-md.md)] e qualquer subprocesso gerado durante a coleção de dados.</span><span class="sxs-lookup"><span data-stu-id="22136-283">For example, it stops [!INCLUDE[ssSqlProfiler](../includes/sssqlprofiler-md.md)] traces it was collecting, it stops executing [!INCLUDE[tsql](../includes/tsql-md.md)] scripts it was running, and it stops any sub processes it has spawned during data collection.</span></span> <span data-ttu-id="22136-284">Após a conclusão da coleção de dados de diagnóstico, o **SQLdiag** é encerrado.</span><span class="sxs-lookup"><span data-stu-id="22136-284">After diagnostic data collection has completed, **SQLdiag** exits.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="22136-285">Não há suporte para pausar o serviço **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="22136-285">Pausing the **SQLdiag** service is not supported.</span></span> <span data-ttu-id="22136-286">Se você tentar pausar o serviço **SQLdiag** , ele será interrompido depois de concluir a coleta de diagnósticos que estava executando quando você o pausou.</span><span class="sxs-lookup"><span data-stu-id="22136-286">If you attempt to pause the **SQLdiag** service, it stops after it finishes collecting the diagnostics that it was collecting when you paused it.</span></span> <span data-ttu-id="22136-287">Se você reiniciar o **SQLdiag** depois de interrompê-lo, o aplicativo reiniciará e substituirá a pasta de saída.</span><span class="sxs-lookup"><span data-stu-id="22136-287">If you restart **SQLdiag** after stopping it, the application restarts and overwrites the output folder.</span></span> <span data-ttu-id="22136-288">Para evitar a substituição da pasta de saída, especifique **/N 2** na linha de comando.</span><span class="sxs-lookup"><span data-stu-id="22136-288">To avoid overwriting the output folder, specify **/N 2** on the command line.</span></span>  
  
 <span data-ttu-id="22136-289">**Para interromper o SQLdiag quando estiver sendo executado como um aplicativo do console**</span><span class="sxs-lookup"><span data-stu-id="22136-289">**To stop SQLdiag when running as a console application**</span></span>  
  
 <span data-ttu-id="22136-290">Se você estiver executando o **SQLdiag** como um aplicativo do console, pressione CTRL+C na janela do console em que o **SQLdiag** está sendo executado para interrompê-lo.</span><span class="sxs-lookup"><span data-stu-id="22136-290">If you are running **SQLdiag** as a console application, press CTRL+C in the console window where **SQLdiag** is running to stop it.</span></span> <span data-ttu-id="22136-291">Depois de pressionar CTRL+C, uma mensagem é exibida na janela do console informando que a coleção de dados do **SQLdiag** está terminando e que você deve esperar a conclusão do processo, o que pode demorar vários minutos.</span><span class="sxs-lookup"><span data-stu-id="22136-291">After you press CTRL+C, a message displays in the console window informing you that **SQLDiag** data collection is ending, and that you should wait until the process shuts down, which may take several minutes.</span></span>  
  
 <span data-ttu-id="22136-292">Pressione Ctrl+C duas vezes para finalizar todos os processos de diagnóstico filho e encerrar imediatamente o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="22136-292">Press Ctrl+C twice to terminate all child diagnostic processes and immediately terminate the application.</span></span>  
  
 <span data-ttu-id="22136-293">**Para interromper o SQLdiag quando estiver sendo executado como um serviço**</span><span class="sxs-lookup"><span data-stu-id="22136-293">**To stop SQLdiag when running as a service**</span></span>  
  
 <span data-ttu-id="22136-294">Se você estiver executando o **SQLdiag** como um serviço, execute **SQLDiag STOP** na pasta de inicialização do **SQLdiag** para interrompê-lo.</span><span class="sxs-lookup"><span data-stu-id="22136-294">If you are running **SQLdiag** as a service, run **SQLDiag STOP** in the **SQLdiag** startup folder to stop it.</span></span>  
  
 <span data-ttu-id="22136-295">Se você estiver executando várias instâncias do **SQLdiag** no mesmo computador, será possível transferir o nome de instância do **SQLdiag** para a linha de comando quando você interromper o serviço.</span><span class="sxs-lookup"><span data-stu-id="22136-295">If you are running multiple instances of **SQLdiag** on the same computer, you can also pass the **SQLdiag** instance name to on the command line when you stop the service.</span></span> <span data-ttu-id="22136-296">Por exemplo, para interromper uma instância do **SQLdiag** chamada Instância 1, use a seguinte sintaxe:</span><span class="sxs-lookup"><span data-stu-id="22136-296">For example, to stop a **SQLdiag** instance named Instance1, use the following syntax:</span></span>  
  
```  
SQLDIAG STOP /A Instance1  
```  
  
> [!NOTE]  
>  <span data-ttu-id="22136-297">**/A** é o único argumento de linha de comando que pode ser usado **START**, **STOP**ou **STOP_ABORT**.</span><span class="sxs-lookup"><span data-stu-id="22136-297">**/A** is the only command-line argument that can be used with **START**, **STOP**, or **STOP_ABORT**.</span></span> <span data-ttu-id="22136-298">Se você precisar especificar uma instância nomeada do **SQLdiag** com um dos verbos de controle de serviço, especifique **/A** após o verbo de controle na linha de comando como mostrado no exemplo de sintaxe anterior.</span><span class="sxs-lookup"><span data-stu-id="22136-298">If you need to specify a named instance of **SQLdiag** with one of the service control verbs, specify **/A** after the control verb on the command line as shown in the previous syntax example.</span></span> <span data-ttu-id="22136-299">Quando verbos de controle são usados, eles devem ser o primeiro argumento na linha de comando.</span><span class="sxs-lookup"><span data-stu-id="22136-299">When control verbs are used, they must be the first argument on the command line.</span></span>  
  
 <span data-ttu-id="22136-300">Para interromper o serviço o mais rapidamente possível, execute **SQLDIAG STOP_ABORT** na pasta de inicialização do utilitário.</span><span class="sxs-lookup"><span data-stu-id="22136-300">To stop the service as quickly as possible, run **SQLDIAG STOP_ABORT** in the utility startup folder.</span></span> <span data-ttu-id="22136-301">Esse comando aborta qualquer coleta de diagnóstico que está sendo executada atualmente sem esperar a sua conclusão.</span><span class="sxs-lookup"><span data-stu-id="22136-301">This command aborts any diagnostics collecting currently being performed without waiting for them to finish.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="22136-302">Use **SQLDiag STOP** ou **SQLDIAG STOP_ABORT** para interromper o serviço **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="22136-302">Use **SQLDiag STOP** or **SQLDIAG STOP_ABORT** to stop the **SQLdiag** service.</span></span> <span data-ttu-id="22136-303">Não use o Console de Serviços do Windows para interromper o **SQLdiag** ou outros serviços do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="22136-303">Do not use the Windows Services Console to stop **SQLdiag** or other [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] services.</span></span>  
  
## <a name="automatically-starting-and-stopping-sqldiag"></a><span data-ttu-id="22136-304">Iniciando e interrompendo automaticamente o SQLdiag</span><span class="sxs-lookup"><span data-stu-id="22136-304">Automatically Starting and Stopping SQLdiag</span></span>  
 <span data-ttu-id="22136-305">Para iniciar e parar automaticamente a coleta de dados de diagnóstico em um horário especificado, use os argumentos **/b**_start_time_ e **/e**_stop_time_ , usando a notação de 24 horas.</span><span class="sxs-lookup"><span data-stu-id="22136-305">To automatically start and stop diagnostic data collection at a specified time, use the **/B**_start_time_ and **/E**_stop_time_ arguments, using 24-hour notation.</span></span> <span data-ttu-id="22136-306">Por exemplo, se você estiver solucionando um problema que aparece consistentemente em aproximadamente 02:00:00, poderá configurar o **SQLdiag** para iniciar automaticamente a coleta de dados de diagnóstico à 01:00 e interrompê-la automaticamente às 03:00:00.</span><span class="sxs-lookup"><span data-stu-id="22136-306">For example, if you are troubleshooting a problem that consistently appears at approximately 02:00:00, you can configure **SQLdiag** to automatically start collecting diagnostic data at 01:00 and automatically stop at 03:00:00.</span></span> <span data-ttu-id="22136-307">Use os argumentos **/B** e **/E** para especificar o horário de início e de parada.</span><span class="sxs-lookup"><span data-stu-id="22136-307">Use the **/B** and **/E** arguments to specify the start and stop time.</span></span> <span data-ttu-id="22136-308">Use a notação de 24 horas para especificar as data de início e de parada exatas com o formato AAAAMMDD_HH:MM:SS.</span><span class="sxs-lookup"><span data-stu-id="22136-308">Use 24-hour notation to specify an exact start and stop date and time with the format YYYYMMDD_HH:MM:SS.</span></span> <span data-ttu-id="22136-309">Para especificar uma hora de início ou de parada relativa, anteponha às horas de início e de parada o **+** e omita a parte da data (AAAAMMDD_) conforme é mostrado no exemplo a seguir, que faz o **SQLdiag** esperar 1 hora antes de começar a coletar informações e, em seguida, coleta informações por 3 horas antes de ser interrompido e fechar:</span><span class="sxs-lookup"><span data-stu-id="22136-309">To specify a relative start or stop time, prefix the start and stop time with **+** and omit the date portion (YYYYMMDD_) as shown in the following example, which causes **SQLdiag** to wait 1 hour before it starts collecting information, then it collects information for 3 hours before it stops and exits:</span></span>  
  
```  
sqldiag /B +01:00:00 /E +03:00:00  
```  
  
 <span data-ttu-id="22136-310">Quando uma *start_time* relativa é especificada, o **SQLdiag** inicia em uma hora relativa à data e à hora atuais.</span><span class="sxs-lookup"><span data-stu-id="22136-310">When a relative *start_time* is specified, **SQLdiag** starts at a time that is relative to the current date and time.</span></span> <span data-ttu-id="22136-311">Quando uma *end_time* relativa é especificada, o **SQLdiag** encerra em uma hora relativa à *start_time*especificada.</span><span class="sxs-lookup"><span data-stu-id="22136-311">When a relative *end_time* is specified, **SQLdiag** ends at a time that is relative to the specified *start_time*.</span></span> <span data-ttu-id="22136-312">Se a data e a hora de início e de parada especificadas estiverem no passado, o **SQLdiag** forçará a alteração da data de início de modo que a data e a hora de início estejam no futuro.</span><span class="sxs-lookup"><span data-stu-id="22136-312">If the start or end date and time that you have specified is in the past, **SQLdiag** forcibly changes the start date so that the start date and time are in the future.</span></span>  
  
 <span data-ttu-id="22136-313">Isto tem implicações importantes nas datas de início e de término que você escolhe.</span><span class="sxs-lookup"><span data-stu-id="22136-313">This has important implications on the start and end dates you choose.</span></span> <span data-ttu-id="22136-314">Considere o exemplo a seguir:</span><span class="sxs-lookup"><span data-stu-id="22136-314">Consider the following example:</span></span>  
  
```  
sqldiag /B +01:00:00 /E 08:30:00  
```  
  
 <span data-ttu-id="22136-315">Se a hora atual for 08:00, a hora de término passará antes da coleta de diagnóstico começar de fato.</span><span class="sxs-lookup"><span data-stu-id="22136-315">If the current time is 08:00, the end time passes before diagnostic collection actually begins.</span></span> <span data-ttu-id="22136-316">Como o **SQLdiag** ajusta automaticamente as datas de início e de término para o próximo dia quando ocorrem no passado, nesse exemplo, a coleta de diagnóstico começará às 09:00 de hoje (uma hora de início relativa foi especificada com **+** ) e continuará até às 08:30 da manhã seguinte.</span><span class="sxs-lookup"><span data-stu-id="22136-316">Because **SQLDiag** automatically adjusts start and end dates to the next day when they occur in the past, in this example diagnostic collection starts at 09:00 today (a relative start time has been specified with **+**) and continues collecting until 08:30 the following morning.</span></span>  
  
### <a name="stopping-and-restarting-sqldiag-to-collect-daily-diagnostics"></a><span data-ttu-id="22136-317">Interrompendo e reiniciando o SQLdiag para coletar diagnósticos diários</span><span class="sxs-lookup"><span data-stu-id="22136-317">Stopping and Restarting SQLdiag to Collect Daily Diagnostics</span></span>  
 <span data-ttu-id="22136-318">Para coletar um conjunto de diagnósticos especificado diariamente sem ter que iniciar e interromper manualmente o **SQLdiag**, use o argumento **/L** .</span><span class="sxs-lookup"><span data-stu-id="22136-318">To collect a specified set of diagnostics on a daily basis without having to manually start and stop **SQLdiag**, use the **/L** argument.</span></span> <span data-ttu-id="22136-319">O argumento **/L** faz com que o **SQLdiag** seja executado continuamente reiniciando-se automaticamente após um desligamento agendado.</span><span class="sxs-lookup"><span data-stu-id="22136-319">The **/L** argument causes **SQLdiag** to run continuously by automatically restarting itself after a scheduled shutdown.</span></span> <span data-ttu-id="22136-320">Quando **/L** é especificado e o **SQLdiag** é interrompido porque atingiu a hora de término com o argumento **/E** ou porque está sendo executado no modo de instantâneo usando o argumento **/X** , o **SQLdiag** reiniciará em vez de fechar.</span><span class="sxs-lookup"><span data-stu-id="22136-320">When **/L** is specified, and **SQLdiag** stops because it has reached the end time specified with the **/E** argument, or it stops because it is being run in snapshot mode by using the **/X** argument, **SQLdiag** restarts instead of exiting.</span></span>  
  
 <span data-ttu-id="22136-321">O exemplo a seguir especifica que o **SQLdiag** seja executado no modo contínuo para reiniciar automaticamente depois que a coleta de dados de diagnóstico ocorrer entre 03:00:00 e 05:00:00.</span><span class="sxs-lookup"><span data-stu-id="22136-321">The following example specifies that **SQLdiag** run in continuous mode to automatically restart after diagnostic data collecting occurs between 03:00:00 and 05:00:00.</span></span>  
  
```  
sqldiag /B 03:00:00 /E 05:00:00 /L  
```  
  
 <span data-ttu-id="22136-322">O exemplo a seguir especifica que o **SQLdiag** seja executado no modo contínuo para reiniciar automaticamente depois de tirar um instantâneo dos dados de diagnóstico às 03:00:00.</span><span class="sxs-lookup"><span data-stu-id="22136-322">The following example specifies that **SQLdiag** run in continuous mode to automatically restart after taking a diagnostic data snapshot at 03:00:00.</span></span>  
  
```  
sqldiag /B 03:00:00 /X /L  
```  
  
## <a name="running-sqldiag-as-a-service"></a><span data-ttu-id="22136-323">Executando o SQLdiag como um serviço</span><span class="sxs-lookup"><span data-stu-id="22136-323">Running SQLdiag as a Service</span></span>  
 <span data-ttu-id="22136-324">Quando você quiser usar o **SQLdiag** para coletar dados de diagnóstico por longos períodos de tempo durante os quais você precisará fazer logoff do computador no qual o **SQLdiag** está sendo executado, será possível executá-lo como um serviço.</span><span class="sxs-lookup"><span data-stu-id="22136-324">When you want to use **SQLdiag** to collect diagnostic data for long periods of time during which you might need to log out of the computer on which **SQLdiag** is running, you can run it as a service.</span></span>  
  
 <span data-ttu-id="22136-325">**Para registrar o SQLdiag para ser executado como um serviço**</span><span class="sxs-lookup"><span data-stu-id="22136-325">**To register SQLDiag to run as a service**</span></span>  
  
 <span data-ttu-id="22136-326">Você pode registrar o **SQLdiag** para ser executado como um serviço especificando o argumento **/R** na linha de comando.</span><span class="sxs-lookup"><span data-stu-id="22136-326">You can register **SQLdiag** to run as a service by specifying the **/R** argument at the command line.</span></span> <span data-ttu-id="22136-327">Isso registra o **SQLdiag** para ser executado como um serviço</span><span class="sxs-lookup"><span data-stu-id="22136-327">This registers **SQLdiag** to run as a service.</span></span> <span data-ttu-id="22136-328">O nome do serviço **SQLdiag** é SQLDIAG.</span><span class="sxs-lookup"><span data-stu-id="22136-328">The **SQLdiag** service name is SQLDIAG.</span></span> <span data-ttu-id="22136-329">Quaisquer outros argumentos especificados na linha de comando ao registrar o **SQLdiag** como um serviço são preservados e reutilizados quando o serviço é iniciado.</span><span class="sxs-lookup"><span data-stu-id="22136-329">Any other arguments you specify on the command line when you register **SQLDiag** as a service are preserved and reused when the service is started.</span></span>  
  
 <span data-ttu-id="22136-330">Para alterar o nome de serviço padrão SQLDIAG, use o argumento de linha de comando **/A** para especificar outro nome.</span><span class="sxs-lookup"><span data-stu-id="22136-330">To change the default SQLDIAG service name, use the **/A** command-line argument to specify another name.</span></span> <span data-ttu-id="22136-331">O**SQLdiag** automaticamente adiciona o prefixo DIAG$ a qualquer nome de instância do **SQLdiag** especificada com **/A** para criar nomes de serviço sensatos.</span><span class="sxs-lookup"><span data-stu-id="22136-331">**SQLdiag** automatically prefixes DIAG$ to any **SQLdiag** instance name specified with **/A** to create sensible service names.</span></span>  
  
 <span data-ttu-id="22136-332">**Para cancelar o registro do serviço SQLDIAG**</span><span class="sxs-lookup"><span data-stu-id="22136-332">**To unregister the SQLDIAG service**</span></span>  
  
 <span data-ttu-id="22136-333">Para cancelar o registro do serviço, especifique o argumento **/U** .</span><span class="sxs-lookup"><span data-stu-id="22136-333">To unregister the service, specify the **/U** argument.</span></span> <span data-ttu-id="22136-334">Cancelar o registro do **SQLdiag** como um serviço também exclui as chaves do Registro do Windows do serviço.</span><span class="sxs-lookup"><span data-stu-id="22136-334">Unregistering **SQLdiag** as a service also deletes the Windows registry keys of the service.</span></span>  
  
 <span data-ttu-id="22136-335">**Para iniciar ou reiniciar o serviço SQLDIAG**</span><span class="sxs-lookup"><span data-stu-id="22136-335">**To start or restart the SQLDIAG service**</span></span>  
  
 <span data-ttu-id="22136-336">Para iniciar ou reiniciar o serviço SQLDIAG, execute **SQLDiag START** da linha de comando.</span><span class="sxs-lookup"><span data-stu-id="22136-336">To start or restart the SQLDIAG service, run **SQLDiag START** from the command line.</span></span>  
  
 <span data-ttu-id="22136-337">Se você estiver executando várias instâncias do **SQLdiag** usando o argumento **/A** , será possível passar o nome de instância do **SQLdiag** na linha de comando quando você iniciar o serviço.</span><span class="sxs-lookup"><span data-stu-id="22136-337">If you are running multiple instances of **SQLdiag** by using the **/A** argument, you can also pass the **SQLdiag** instance name on the command line when you start the service.</span></span> <span data-ttu-id="22136-338">Por exemplo, para iniciar uma instância do **SQLdiag** chamada Instância 1, use a seguinte sintaxe:</span><span class="sxs-lookup"><span data-stu-id="22136-338">For example, to start a **SQLdiag** instance named Instance1, use the following syntax:</span></span>  
  
```  
SQLDIAG START /A Instance1  
```  
  
 <span data-ttu-id="22136-339">Você também pode usar o comando **net start** para iniciar o serviço SQLDIAG.</span><span class="sxs-lookup"><span data-stu-id="22136-339">You can also use the **net start** command to start the SQLDIAG service.</span></span>  
  
 <span data-ttu-id="22136-340">Ao reiniciar o **SQLdiag**, ele substitui o conteúdo na pasta de saída atual.</span><span class="sxs-lookup"><span data-stu-id="22136-340">When you restart **SQLdiag**, it overwrites the contents in the current output folder.</span></span> <span data-ttu-id="22136-341">Para evitar isso, especifique **/N 2** na linha de comando para renomear a pasta de saída quando o utilitário iniciar.</span><span class="sxs-lookup"><span data-stu-id="22136-341">To avoid this, specify **/N 2** on the command line to rename the output folder when the utility starts.</span></span>  
  
 <span data-ttu-id="22136-342">Não há suporte para pausar o serviço **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="22136-342">Pausing the **SQLdiag** service is not supported.</span></span>  
  
## <a name="running-multiple-instances-of-sqldiag"></a><span data-ttu-id="22136-343">Executando várias instâncias do SQLdiag</span><span class="sxs-lookup"><span data-stu-id="22136-343">Running Multiple Instances of SQLdiag</span></span>  
 <span data-ttu-id="22136-344">Execute várias instâncias do **SQLdiag** no mesmo computador especificando **/a**_SQLdiag_application_name_ na linha de comando.</span><span class="sxs-lookup"><span data-stu-id="22136-344">Run multiple instances of **SQLdiag** on the same computer by specifying **/A**_SQLdiag_application_name_ on the command line.</span></span> <span data-ttu-id="22136-345">Isso é útil para coletar conjuntos diferentes de diagnósticos simultaneamente da mesma instância do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="22136-345">This is useful for collecting different sets of diagnostics simultaneously from the same [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] instance.</span></span> <span data-ttu-id="22136-346">Por exemplo, você pode configurar uma instância nomeada do **SQLdiag** para executar continuamente coletas de dados leves.</span><span class="sxs-lookup"><span data-stu-id="22136-346">For example, you can configure a named instance of **SQLdiag** to continuously perform lightweight data collection.</span></span> <span data-ttu-id="22136-347">Então, se algum problema ocorrer no [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], você poderá executar a instância padrão do **SQLdiag** para coletar o diagnóstico desse problema ou para reunir um conjunto de diagnósticos que os Serviços de Atendimento ao Cliente da [!INCLUDE[msCoName](../includes/msconame-md.md)] solicitaram a você a fim de diagnosticar um problema.</span><span class="sxs-lookup"><span data-stu-id="22136-347">Then, if a specific problem occurs on [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], you can run the default **SQLdiag** instance to collect diagnostics for that problem, or to gather a set of diagnostics that [!INCLUDE[msCoName](../includes/msconame-md.md)] Customer Support Services has asked you to gather to diagnose a problem.</span></span>  
  
## <a name="collecting-diagnostic-data-from-clustered-sql-server-instances"></a><span data-ttu-id="22136-348">Coletando dados de diagnóstico de instâncias do SQL Server clusterizado</span><span class="sxs-lookup"><span data-stu-id="22136-348">Collecting Diagnostic Data from Clustered SQL Server Instances</span></span>  
 <span data-ttu-id="22136-349">O**SQLdiag** oferece suporte à coleta de dados de diagnóstico de instâncias do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] clusterizadas.</span><span class="sxs-lookup"><span data-stu-id="22136-349">**SQLdiag** supports collecting diagnostic data from clustered [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] instances.</span></span> <span data-ttu-id="22136-350">Para reunir diagnósticos de instâncias clusterizadas do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], verifique se **"."** está especificado no atributo **name** do elemento **\<Machine>** no arquivo de configuração SQLDiag.Xml e não especifique o argumento **/G** na linha de comando.</span><span class="sxs-lookup"><span data-stu-id="22136-350">To gather diagnostics from clustered [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] instances, make sure that **"."** is specified for the **name** attribute of the **\<Machine>** element in the configuration file SQLDiag.Xml and do not specify the **/G** argument on the command line.</span></span> <span data-ttu-id="22136-351">Por padrão, **"."** é especificado para o atributo **name** no arquivo de configuração e o argumento **/G** é desativado.</span><span class="sxs-lookup"><span data-stu-id="22136-351">By default, **"."** is specified for the **name** attribute in the configuration file and the **/G** argument is turned off.</span></span> <span data-ttu-id="22136-352">Normalmente, você não precisa editar o arquivo de configuração ou alterar a linha de comando ao coletar a partir de uma instância do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] clusterizada.</span><span class="sxs-lookup"><span data-stu-id="22136-352">Typically, you do not need to edit the configuration file or change the command line arguments when collecting from a clustered [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] instance.</span></span>  
  
 <span data-ttu-id="22136-353">Quando **"."** está especificado como o nome da máquina, o **SQLdiag** detecta que está sendo executado em um cluster e recupera simultaneamente informações de diagnóstico de todas as instâncias virtuais do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] instaladas no cluster.</span><span class="sxs-lookup"><span data-stu-id="22136-353">When **"."** is specified as the machine name, **SQLdiag** detects that it is running on a cluster, and simultaneously retrieves diagnostic information from all virtual instances of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] that are installed on the cluster.</span></span> <span data-ttu-id="22136-354">Se você quiser coletar informações de diagnóstico de apenas uma instância virtual do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] que está sendo executada em um computador, especifique esse [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] virtual para o atributo **name** do elemento **\<Machine>** no SQLDiag.Xml.</span><span class="sxs-lookup"><span data-stu-id="22136-354">If you want to collect diagnostic information from only one virtual instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] that is running on a computer, specify that virtual [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] for the **name** attribute of the **\<Machine>** element in SQLDiag.Xml.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="22136-355">Para coletar informações de rastreamento do [!INCLUDE[ssSqlProfiler](../includes/sssqlprofiler-md.md)] de instâncias do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] clusterizadas, os compartilhamentos administrativos (ADMIN$) devem estar habilitados no cluster.</span><span class="sxs-lookup"><span data-stu-id="22136-355">To collect [!INCLUDE[ssSqlProfiler](../includes/sssqlprofiler-md.md)] trace information from clustered [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] instances, administrative shares (ADMIN$) must be enabled on the cluster.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="22136-356">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="22136-356">See Also</span></span>  
 [<span data-ttu-id="22136-357">Referência de utilitários de prompt de comando &#40;Mecanismo de Banco de Dados&#41;</span><span class="sxs-lookup"><span data-stu-id="22136-357">Command Prompt Utility Reference &#40;Database Engine&#41;</span></span>](command-prompt-utility-reference-database-engine.md)  
  
  
