---
title: Backups diferenciais (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: backup-restore
ms.topic: conceptual
helpviewer_keywords:
- differential backups
- differential backups, about
ms.assetid: 123bb7af-1367-4bde-bfcb-76d36799b905
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 5c057e0d41cb46adef0ec1e01c3406190db900e4
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87582470"
---
# <a name="differential-backups-sql-server"></a><span data-ttu-id="1df07-102">Backups diferenciais (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="1df07-102">Differential Backups (SQL Server)</span></span>
  <span data-ttu-id="1df07-103">Este tópico de backup e restauração é relevante para todos os bancos de dados do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="1df07-103">This backup and restore topic is relevant for all [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] databases.</span></span>  
  
 <span data-ttu-id="1df07-104">Um backup diferencial é baseado no backup de dados completo anterior mais recente.</span><span class="sxs-lookup"><span data-stu-id="1df07-104">A differential backup is based on the most recent, previous full data backup.</span></span> <span data-ttu-id="1df07-105">Um backup diferencial captura apenas os dados que foram alterados desde o backup completo.</span><span class="sxs-lookup"><span data-stu-id="1df07-105">A differential backup captures only the data that has changed since that full backup.</span></span> <span data-ttu-id="1df07-106">O backup completo no qual um backup diferencial se baseia é conhecido como a *base* do diferencial.</span><span class="sxs-lookup"><span data-stu-id="1df07-106">The full backup upon which a differential backup is based is known as the *base* of the differential.</span></span> <span data-ttu-id="1df07-107">Os backups completos, com exceção dos backups somente cópia, podem servir como base para uma série de backups diferenciais, inclusive backups de banco de dados, backups parciais e backups de arquivo.</span><span class="sxs-lookup"><span data-stu-id="1df07-107">Full backups, except for copy-only backups, can serve as the base for a series of differential backups, including database backups, partial backups, and file backups.</span></span> <span data-ttu-id="1df07-108">O backup de base para um backup diferencial de arquivo pode ser contido dentro de um backup completo, um backup de arquivo ou um backup parcial.</span><span class="sxs-lookup"><span data-stu-id="1df07-108">The base backup for a file differential backup can be contained within a full backup, a file backup, or a partial backup.</span></span>  
  
  
##  <a name="benefits"></a><a name="Benefits"></a> <span data-ttu-id="1df07-109">Benefícios</span><span class="sxs-lookup"><span data-stu-id="1df07-109">Benefits</span></span>  
  
-   <span data-ttu-id="1df07-110">A criação de um backup diferencial pode ser muito rápida se comparada à criação de um backup completo.</span><span class="sxs-lookup"><span data-stu-id="1df07-110">Creating a differential backups can be very fast compared to creating a full backup.</span></span> <span data-ttu-id="1df07-111">Um backup diferencial registra apenas os dados que mudaram desde o backup completo no qual se baseia o backup diferencial.</span><span class="sxs-lookup"><span data-stu-id="1df07-111">A differential backup records only the data that has changed since the full backup upon the differential backup is based.</span></span> <span data-ttu-id="1df07-112">Isso facilita os backups de dados frequentes, o que diminui o risco de perda de dados.</span><span class="sxs-lookup"><span data-stu-id="1df07-112">This facilitates taking frequent data backups, which decrease the risk of data loss.</span></span> <span data-ttu-id="1df07-113">No entanto, antes de restaurar um backup diferencial, é necessário restaurar sua base.</span><span class="sxs-lookup"><span data-stu-id="1df07-113">However, before you restore a differential backup, you must restore its base.</span></span> <span data-ttu-id="1df07-114">Portanto, a restauração de um backup diferencial precisará, necessariamente, de mais etapas e mais tempo do que a restauração de um backup completo, pois serão necessários dois arquivos de backup.</span><span class="sxs-lookup"><span data-stu-id="1df07-114">Therefore restoring from a differential backup will necessarily take more steps and time than restoring from a full backup because two backup files are required.</span></span>  
  
-   <span data-ttu-id="1df07-115">Backups de banco de dados de diferencial são especialmente úteis se um subconjunto de um banco de dados é modificado mais frequentemente do que o restante do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="1df07-115">Differential database backups are especially useful if a subset of a database is modified more frequently than the rest of the database.</span></span> <span data-ttu-id="1df07-116">Nesses casos, backups de banco de dados de diferencial lhe permitem fazer backup frequentemente sem a sobrecarga de backups de banco de dados completos.</span><span class="sxs-lookup"><span data-stu-id="1df07-116">In these cases, differential database backups enable you back up frequently without the overhead of full database backups.</span></span>  
  
-   <span data-ttu-id="1df07-117">No modelo de recuperação completa, o uso de backups diferenciais pode reduzir o número de backups de log que você precisa restaurar.</span><span class="sxs-lookup"><span data-stu-id="1df07-117">Under the full recovery model, using differential backups can reduce the number of log backups that you have to restore.</span></span>  
  
##  <a name="overview-of-differential-backups"></a><a name="Overview"></a> <span data-ttu-id="1df07-118">Visão geral dos backups diferenciais</span><span class="sxs-lookup"><span data-stu-id="1df07-118">Overview of Differential Backups</span></span>  
 <span data-ttu-id="1df07-119">Um backup diferencial captura o estado de qualquer *extensão* (coleções de oito páginas fisicamente contíguas) que foi alterada entre quando a base diferencial foi criada e quando o backup diferencial é criado.</span><span class="sxs-lookup"><span data-stu-id="1df07-119">A differential backup captures the state of any *extents* (collections of eight physically contiguous pages) that have changed between when the differential base was created and the when differential backup is created.</span></span> <span data-ttu-id="1df07-120">Isso significa que o tamanho de um backup diferencial depende da quantidade de dados alterada desde a base.</span><span class="sxs-lookup"><span data-stu-id="1df07-120">This means that the size of a given differential backup depends on the amount of data that has changed since the base.</span></span> <span data-ttu-id="1df07-121">Em geral, quanto mais antiga a base, maior será o novo backup diferencial.</span><span class="sxs-lookup"><span data-stu-id="1df07-121">Generally, the older a base is, the larger a new differential backup will be.</span></span> <span data-ttu-id="1df07-122">Em uma série de backups diferenciais, é provável que uma extensão atualizada com frequência contenha dados diferentes em cada backup diferencial.</span><span class="sxs-lookup"><span data-stu-id="1df07-122">In a series of differential backups, a frequently updated extent is likely to contain different data in each differential backup.</span></span>  
  
 <span data-ttu-id="1df07-123">A ilustração a seguir mostra como funciona um backup diferencial.</span><span class="sxs-lookup"><span data-stu-id="1df07-123">The following illustration shows how a differential backup works.</span></span> <span data-ttu-id="1df07-124">A figura exibe 24 extensões de dados, dentre as quais 6 que foram alteradas.</span><span class="sxs-lookup"><span data-stu-id="1df07-124">The figure shows 24 data extents, 6 of which have changed.</span></span> <span data-ttu-id="1df07-125">O backup diferencial contém somente estas 6 extensões de dados.</span><span class="sxs-lookup"><span data-stu-id="1df07-125">The differential backup contains only these 6 data extents.</span></span> <span data-ttu-id="1df07-126">A operação de backup diferencial baseia-se em uma página de bitmap que contém um bit para cada extensão.</span><span class="sxs-lookup"><span data-stu-id="1df07-126">The differential backup operation relies on a bitmap page that contains a bit for every extent.</span></span> <span data-ttu-id="1df07-127">Para cada extensão atualizada desde a base, o bit é definido para 1 no bitmap.</span><span class="sxs-lookup"><span data-stu-id="1df07-127">For each extent updated since the base, the bit is set to 1 in the bitmap.</span></span>  
  
 <span data-ttu-id="1df07-128">![O bitmap diferencial identifica as extensões alteradas](../../database-engine/media/bnr-how-diff-backups-work.gif "O bitmap diferencial identifica as extensões alteradas")</span><span class="sxs-lookup"><span data-stu-id="1df07-128">![Differential bitmap identifies changed extents](../../database-engine/media/bnr-how-diff-backups-work.gif "Differential bitmap identifies changed extents")</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="1df07-129">O bitmap diferencial não é atualizado por um backup do tipo somente cópia.</span><span class="sxs-lookup"><span data-stu-id="1df07-129">The differential bitmap is not updated by a copy-only backup.</span></span> <span data-ttu-id="1df07-130">Assim, um backup do tipo somente cópia não afeta os backups diferenciais subsequentes.</span><span class="sxs-lookup"><span data-stu-id="1df07-130">Therefore, a copy-only backup does not affect subsequent differential backups.</span></span>  
  
 <span data-ttu-id="1df07-131">Um backup diferencial executado logo depois de sua base é, em geral, significativamente menor do que a base diferencial.</span><span class="sxs-lookup"><span data-stu-id="1df07-131">A differential backup that is taken fairly soon after its base is usually significantly smaller than the differential base.</span></span> <span data-ttu-id="1df07-132">Isto economiza espaço de armazenamento e tempo de backup.</span><span class="sxs-lookup"><span data-stu-id="1df07-132">This saves storage space and backup time.</span></span> <span data-ttu-id="1df07-133">Porém, como o banco de dados é alterado com o passar do tempo, a diferença entre o banco de dados e uma base diferencial específica aumenta.</span><span class="sxs-lookup"><span data-stu-id="1df07-133">However, as a database changes over time, the difference between the database and a specific differential base increases.</span></span> <span data-ttu-id="1df07-134">Quanto maior o tempo entre um backup diferencial e sua base, maior será o tamanho do backup diferencial.</span><span class="sxs-lookup"><span data-stu-id="1df07-134">The longer the time between a differential backup and its base, the larger the differential backup is likely to be.</span></span> <span data-ttu-id="1df07-135">Isto significa que os backups diferenciais podem por fim se aproximar do tamanho da base diferencial.</span><span class="sxs-lookup"><span data-stu-id="1df07-135">This means that the differential backups can eventually approach the differential base in size.</span></span> <span data-ttu-id="1df07-136">Um backup diferencial grande perde as vantagens de um backup mais rápido e menor.</span><span class="sxs-lookup"><span data-stu-id="1df07-136">A large differential backup loses the advantages of a faster and smaller backup.</span></span>  
  
 <span data-ttu-id="1df07-137">Como os backups diferenciais aumentam em tamanho, a restauração de um backup diferencial pode aumentar de forma significativa o tempo necessário para restaurar um banco de dados.</span><span class="sxs-lookup"><span data-stu-id="1df07-137">As the differential backups increase in size, restoring a differential backup can significantly increase the time that is required to restore a database.</span></span> <span data-ttu-id="1df07-138">Por isso, recomendamos que você use um backup completo novo em intervalos definidos para estabelecer uma nova base diferencial para os dados.</span><span class="sxs-lookup"><span data-stu-id="1df07-138">Therefore, we recommend that you take a new full backup at set intervals to establish a new differential base for the data.</span></span> <span data-ttu-id="1df07-139">Por exemplo, você poderia usar um backup completo semanal de todo o banco de dados (isto é, um backup completo do banco de dados) seguido de uma série regular de backups diferenciais do banco de dados durante a semana.</span><span class="sxs-lookup"><span data-stu-id="1df07-139">For example, you might take a weekly full backup of the whole database (that is, a full database backup) followed by a regular series of differential database backups during the week.</span></span>  
  
 <span data-ttu-id="1df07-140">No momento da restauração, antes de você restaurar um backup diferencial, você deve restaurar sua base.</span><span class="sxs-lookup"><span data-stu-id="1df07-140">At restore time, before you restore a differential backup, you must restore its base.</span></span> <span data-ttu-id="1df07-141">Em seguida, restaure somente o backup diferencial mais recente para avançar o banco de dados até o momento em que foi criado esse backup diferencial.</span><span class="sxs-lookup"><span data-stu-id="1df07-141">Then, restore only the most recent differential backup to bring the database forward to the time when that differential backup was created.</span></span> <span data-ttu-id="1df07-142">Normalmente, você restauraria o backup completo mais recente seguido pelo backup diferencial mais recente que é baseado nesse backup completo.</span><span class="sxs-lookup"><span data-stu-id="1df07-142">Typically, you would restore the most recent full backup followed by the most recent differential backup that is based on that full backup.</span></span>  
  
## <a name="differential-backups-of-databases-with-memory-optimized-tables"></a><span data-ttu-id="1df07-143">Backups diferenciais de bancos de dados com tabelas com otimização de memória</span><span class="sxs-lookup"><span data-stu-id="1df07-143">Differential Backups of Databases with Memory-Optimized Tables</span></span>  
 <span data-ttu-id="1df07-144">Para obter informações sobre backups diferenciais e bancos de dados com tabelas com otimização de memória, consulte [Fazendo backup de um banco de dados com tabelas com otimização de memória](../in-memory-oltp/memory-optimized-tables.md).</span><span class="sxs-lookup"><span data-stu-id="1df07-144">For information about differential backups and databases with memory-optimized tables, see [Backing Up a Database with Memory-Optimized Tables](../in-memory-oltp/memory-optimized-tables.md).</span></span>  
  
##  <a name="differential-backups-of-read-only-databases"></a><a name="ReadOnlyDbs"></a> <span data-ttu-id="1df07-145">Backups diferenciais de bancos de dados somente leitura</span><span class="sxs-lookup"><span data-stu-id="1df07-145">Differential Backups of Read-Only Databases</span></span>  
 <span data-ttu-id="1df07-146">Para bancos de dados somente leitura, os backups completos usados isoladamente são mais fáceis de serem gerenciados do que os usados com backups diferenciais.</span><span class="sxs-lookup"><span data-stu-id="1df07-146">For read-only databases, full backups used alone are easier to manage than when they are used with differential backups.</span></span> <span data-ttu-id="1df07-147">Quando um banco de dados for somente de leitura, o backup e outras operações não podem alterar os metadados que estão contidos no arquivo.</span><span class="sxs-lookup"><span data-stu-id="1df07-147">When a database is read-only, backup and other operations cannot change the metadata that is contained in the file.</span></span> <span data-ttu-id="1df07-148">Portanto, os metadados exigidos por um backup diferencial, como o número de sequência de log no qual o backup diferencial começa (o LSN base diferencial), é armazenado no banco de dados **mestre** .</span><span class="sxs-lookup"><span data-stu-id="1df07-148">Therefore, metadata that is required by a differential backup, such as the log sequence number at which the differential backup begins (the differential base LSN) is stored in the **master** database.</span></span> <span data-ttu-id="1df07-149">Se a base diferencial for tomada quando o banco de dados for somente de leitura, o bitmap diferencial indicará mais alterações do que as ocorridas, de fato, desde o backup de base.</span><span class="sxs-lookup"><span data-stu-id="1df07-149">If the differential base is taken when the database is read-only, the differential bitmap indicates more changes than have actually occurred since the base backup.</span></span> <span data-ttu-id="1df07-150">Os dados extras são lidos pelo backup, mas não são gravados no backup, porque o **differential_base_lsn** armazenado na tabela do sistema [conjunto de backup](/sql/relational-databases/system-tables/backupset-transact-sql) é usado para determinar se os dados realmente foram alterados desde a base.</span><span class="sxs-lookup"><span data-stu-id="1df07-150">The extra data is read by backup, but is not written to the backup, because the **differential_base_lsn** stored in the [backupset](/sql/relational-databases/system-tables/backupset-transact-sql) system table is used to determine whether the data has actually changed since the base.</span></span>  
  
 <span data-ttu-id="1df07-151">Quando um banco de dados somente leitura é recriado, restaurado ou desanexado e anexado, as informações básicas diferenciais são perdidas.</span><span class="sxs-lookup"><span data-stu-id="1df07-151">When a read-only database is rebuilt, restored, or detached and attached, the differential-base information is lost.</span></span> <span data-ttu-id="1df07-152">Isso ocorre porque o banco de dados **mestre** não é sincronizado com o banco de dados de usuário.</span><span class="sxs-lookup"><span data-stu-id="1df07-152">This occurs because the **master** database is not synchronized with the user database.</span></span> <span data-ttu-id="1df07-153">O [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] não pode detectar nem prevenir esse problema.</span><span class="sxs-lookup"><span data-stu-id="1df07-153">The [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] cannot detect or prevent this problem.</span></span> <span data-ttu-id="1df07-154">Nenhum backup diferencial posterior tem base no backup completo mais recente e pode fornecer resultados inesperados.</span><span class="sxs-lookup"><span data-stu-id="1df07-154">Any later differential backups are not based on the most recent full backup and could provide unexpected results.</span></span> <span data-ttu-id="1df07-155">Para estabelecer uma nova base diferencial, recomendamos que você crie um backup de banco de dados completo.</span><span class="sxs-lookup"><span data-stu-id="1df07-155">To establish a new differential base, we recommend that you create a full database backup.</span></span>  
  
### <a name="best-practices-for-using-differential-backups-with-a-read-only-database"></a><span data-ttu-id="1df07-156">Práticas recomendadas para usar backups diferenciais com um banco de dados somente leitura.</span><span class="sxs-lookup"><span data-stu-id="1df07-156">Best Practices for Using Differential Backups with a Read-Only Database</span></span>  
 <span data-ttu-id="1df07-157">Após criar o backup completo de um banco de dados somente leitura, se você pretende criar um backup diferencial subsequente, faça backup do banco de dados **mestre** .</span><span class="sxs-lookup"><span data-stu-id="1df07-157">After you create a full database backup of a read-only database, if you intend to create a subsequent differential backup, back up the **master** database.</span></span>  
  
 <span data-ttu-id="1df07-158">Se o banco de dados **mestre** foi perdido, restaure-o antes de restaurar o backup diferencial de um banco de dados de usuário.</span><span class="sxs-lookup"><span data-stu-id="1df07-158">If the **master** database is lost, restore it before you restore any differential backup of a user database.</span></span>  
  
 <span data-ttu-id="1df07-159">Se você desanexar e anexar um banco de dados somente leitura para o qual planeja fazer backups diferenciais para uso posterior, assim que for possível, faça um backup completo do banco de dados somente leitura e do banco de dados **mestre** .</span><span class="sxs-lookup"><span data-stu-id="1df07-159">If you detach and attach a read-only database for which you plan to later use differential backups, as soon as it is practical, take a full database backup of both the read-only database and of the **master** database.</span></span>  
  
##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="1df07-160">Tarefas relacionadas</span><span class="sxs-lookup"><span data-stu-id="1df07-160">Related Tasks</span></span>  
  
-   [<span data-ttu-id="1df07-161">Criar um backup diferencial de banco de dados &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="1df07-161">Create a Differential Database Backup &#40;SQL Server&#41;</span></span>](create-a-differential-database-backup-sql-server.md)  
  
-   [<span data-ttu-id="1df07-162">Restaurar um backup de banco de dados diferencial &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="1df07-162">Restore a Differential Database Backup &#40;SQL Server&#41;</span></span>](restore-a-differential-database-backup-sql-server.md)  
  
  
## <a name="see-also"></a><span data-ttu-id="1df07-163">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="1df07-163">See Also</span></span>  
 <span data-ttu-id="1df07-164">[Visão geral do backup &#40;SQL Server&#41;](backup-overview-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="1df07-164">[Backup Overview &#40;SQL Server&#41;](backup-overview-sql-server.md) </span></span>  
 <span data-ttu-id="1df07-165">[Backups de bancos de dados completos &#40;SQL Server&#41;](full-database-backups-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="1df07-165">[Full Database Backups &#40;SQL Server&#41;](full-database-backups-sql-server.md) </span></span>  
 <span data-ttu-id="1df07-166">[Restaurações completas de banco de dados &#40;Modelo de recuperação completa&#41;](complete-database-restores-full-recovery-model.md) </span><span class="sxs-lookup"><span data-stu-id="1df07-166">[Complete Database Restores &#40;Full Recovery Model&#41;](complete-database-restores-full-recovery-model.md) </span></span>  
 <span data-ttu-id="1df07-167">[Restaurações completas de banco de dados &#40;Modelo de recuperação simples#41;](complete-database-restores-simple-recovery-model.md) </span><span class="sxs-lookup"><span data-stu-id="1df07-167">[Complete Database Restores &#40;Simple Recovery Model&#41;](complete-database-restores-simple-recovery-model.md) </span></span>  
 [<span data-ttu-id="1df07-168">Backups de log de transações &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="1df07-168">Transaction Log Backups &#40;SQL Server&#41;</span></span>](transaction-log-backups-sql-server.md)  
  
  
