---
title: Recompilar bancos de dados do sistema | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
helpviewer_keywords:
- master database [SQL Server], rebuilding
- REBUILDDATABASE parameter
- rebuilding databases, master
- system databases [SQL Server], rebuilding
ms.assetid: af457ecd-523e-4809-9652-bdf2e81bd876
author: stevestein
ms.author: sstein
ms.openlocfilehash: 5f695589fa0fc1b86d4433d36afa1bc6357aabd6
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87573100"
---
# <a name="rebuild-system-databases"></a><span data-ttu-id="7f08c-102">Recriar bancos de dados do sistema</span><span class="sxs-lookup"><span data-stu-id="7f08c-102">Rebuild System Databases</span></span>
  <span data-ttu-id="7f08c-103">Os bancos de dados do sistema devem ser recriados para corrigir problemas de corrupção nos bancos de dados do sistema [master](master-database.md), [model](model-database.md), [msdb](msdb-database.md) ou [resource](resource-database.md), ou para modificar a ordenação em nível de servidor padrão.</span><span class="sxs-lookup"><span data-stu-id="7f08c-103">System databases must be rebuilt to fix corruption problems in the [master](master-database.md), [model](model-database.md), [msdb](msdb-database.md), or [resource](resource-database.md) system databases or to modify the default server-level collation.</span></span> <span data-ttu-id="7f08c-104">Este tópico fornece instruções passo a passo para recriar bancos de dados do sistema no [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7f08c-104">This topic provides step-by-step instructions to rebuild system databases in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)].</span></span>  
  
 <span data-ttu-id="7f08c-105">**Neste tópico**</span><span class="sxs-lookup"><span data-stu-id="7f08c-105">**In This Topic**</span></span>  
  
-   <span data-ttu-id="7f08c-106">**Antes de começar:**</span><span class="sxs-lookup"><span data-stu-id="7f08c-106">**Before you begin:**</span></span>  
  
     [<span data-ttu-id="7f08c-107">Limitações e restrições</span><span class="sxs-lookup"><span data-stu-id="7f08c-107">Limitations and Restrictions</span></span>](#Restrictions)  
  
     [<span data-ttu-id="7f08c-108">Pré-requisitos</span><span class="sxs-lookup"><span data-stu-id="7f08c-108">Prerequisites</span></span>](#Prerequisites)  
  
-   <span data-ttu-id="7f08c-109">**Procedimentos:**</span><span class="sxs-lookup"><span data-stu-id="7f08c-109">**Procedures:**</span></span>  
  
     [<span data-ttu-id="7f08c-110">Recompilar bancos de dados do sistema</span><span class="sxs-lookup"><span data-stu-id="7f08c-110">Rebuild System Databases</span></span>](#RebuildProcedure)  
  
     [<span data-ttu-id="7f08c-111">Recriar o banco de dados de recursos</span><span class="sxs-lookup"><span data-stu-id="7f08c-111">Rebuild the resource Database</span></span>](#Resource)  
  
     [<span data-ttu-id="7f08c-112">Criar um novo banco de dados msdb</span><span class="sxs-lookup"><span data-stu-id="7f08c-112">Create a New msdb Database</span></span>](#CreateMSDB)  
  
-   <span data-ttu-id="7f08c-113">**Acompanhamento:**</span><span class="sxs-lookup"><span data-stu-id="7f08c-113">**Follow Up:**</span></span>  
  
     [<span data-ttu-id="7f08c-114">Solução de problemas de erros de recriação</span><span class="sxs-lookup"><span data-stu-id="7f08c-114">Troubleshoot Rebuild Errors</span></span>](#Troubleshoot)  
  
##  <a name="before-you-begin"></a><a name="BeforeYouBegin"></a> <span data-ttu-id="7f08c-115">Antes de começar</span><span class="sxs-lookup"><span data-stu-id="7f08c-115">Before You Begin</span></span>  
  
###  <a name="limitations-and-restrictions"></a><a name="Restrictions"></a> <span data-ttu-id="7f08c-116">Limitações e restrições</span><span class="sxs-lookup"><span data-stu-id="7f08c-116">Limitations and Restrictions</span></span>  
 <span data-ttu-id="7f08c-117">Quando os bancos de dados do sistema mestre, modelo, msdb e tempdb são recriados, os bancos de dados são descartados e recriados em seu local original.</span><span class="sxs-lookup"><span data-stu-id="7f08c-117">When the master, model, msdb, and tempdb system databases are rebuilt, the databases are dropped and re-created in their original location.</span></span> <span data-ttu-id="7f08c-118">Se uma ordenação nova for especificada na instrução REBUILD, os bancos de dados do sistema serão criados usando essa configuração de ordenação.</span><span class="sxs-lookup"><span data-stu-id="7f08c-118">If a new collation is specified in the rebuild statement, the system databases are created using that collation setting.</span></span> <span data-ttu-id="7f08c-119">Todas as modificações do usuário nesses bancos de dados são perdidas.</span><span class="sxs-lookup"><span data-stu-id="7f08c-119">Any user modifications to these databases are lost.</span></span> <span data-ttu-id="7f08c-120">Por exemplo, você pode ter objetos definidos pelo usuário no banco de dados mestre, trabalhos agendados no msdb ou alterações nas configurações padrão do banco de dados modelo.</span><span class="sxs-lookup"><span data-stu-id="7f08c-120">For example, you may have user-defined objects in the master database, scheduled jobs in msdb, or changes to the default database settings in the model database.</span></span>  
  
###  <a name="prerequisites"></a><a name="Prerequisites"></a> <span data-ttu-id="7f08c-121">Pré-requisitos</span><span class="sxs-lookup"><span data-stu-id="7f08c-121">Prerequisites</span></span>  
 <span data-ttu-id="7f08c-122">Execute as tarefas a seguir antes de recriar os bancos de dados do sistema para garantir que os bancos de dados possam ser restaurados para suas configurações atuais.</span><span class="sxs-lookup"><span data-stu-id="7f08c-122">Perform the following tasks before you rebuild the system databases to ensure that you can restore the system databases to their current settings.</span></span>  
  
1.  <span data-ttu-id="7f08c-123">Registre todos os valores de configuração em todo o servidor.</span><span class="sxs-lookup"><span data-stu-id="7f08c-123">Record all server-wide configuration values.</span></span>  
  
    ```  
    SELECT * FROM sys.configurations;  
    ```  
  
2.  <span data-ttu-id="7f08c-124">Registre todos os pacotes de serviço e os hotfixes aplicados à instância do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] e à ordenação atual.</span><span class="sxs-lookup"><span data-stu-id="7f08c-124">Record all service packs and hotfixes applied to the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and the current collation.</span></span> <span data-ttu-id="7f08c-125">Você deve reaplicar essas atualizações depois de recriar os bancos de dados do sistema.</span><span class="sxs-lookup"><span data-stu-id="7f08c-125">You must reapply these updates after rebuilding the system databases.</span></span>  
  
    ```  
    SELECT  
    SERVERPROPERTY('ProductVersion ') AS ProductVersion,  
    SERVERPROPERTY('ProductLevel') AS ProductLevel,  
    SERVERPROPERTY('ResourceVersion') AS ResourceVersion,  
    SERVERPROPERTY('ResourceLastUpdateDateTime') AS ResourceLastUpdateDateTime,  
    SERVERPROPERTY('Collation') AS Collation;  
    ```  
  
3.  <span data-ttu-id="7f08c-126">Registre o local atual de todos os arquivos de log e de dados nos bancos de dados do sistema.</span><span class="sxs-lookup"><span data-stu-id="7f08c-126">Record the current location of all data and log files for the system databases.</span></span> <span data-ttu-id="7f08c-127">A recriação do bancos de dados do sistema instala todos os bancos de dados do sistema em seu local original.</span><span class="sxs-lookup"><span data-stu-id="7f08c-127">Rebuilding the system databases installs all system databases to their original location.</span></span> <span data-ttu-id="7f08c-128">Se você tiver movido os arquivos de log ou de dados do banco de dados do sistema para um local diferente, mova os arquivos novamente.</span><span class="sxs-lookup"><span data-stu-id="7f08c-128">If you have moved system database data or log files to a different location, you must move the files again.</span></span>  
  
    ```  
    SELECT name, physical_name AS current_file_location  
    FROM sys.master_files  
    WHERE database_id IN (DB_ID('master'), DB_ID('model'), DB_ID('msdb'), DB_ID('tempdb'));  
    ```  
  
4.  <span data-ttu-id="7f08c-129">Localize o backup atual dos bancos de dados mestre, modelo e msdb.</span><span class="sxs-lookup"><span data-stu-id="7f08c-129">Locate the current backup of the master, model, and msdb databases.</span></span>  
  
5.  <span data-ttu-id="7f08c-130">Se a instância do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] estiver configurada como um Distribuidor de replicação, localize o backup atual do banco de dados de distribuição.</span><span class="sxs-lookup"><span data-stu-id="7f08c-130">If the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is configured as a replication Distributor, locate the current backup of the distribution database.</span></span>  
  
6.  <span data-ttu-id="7f08c-131">Verifique se você possui as permissões adequadas para recriar os bancos de dados do sistema.</span><span class="sxs-lookup"><span data-stu-id="7f08c-131">Ensure you have appropriate permissions to rebuild the system databases.</span></span> <span data-ttu-id="7f08c-132">Para executar essa operação, você deve ser membro da função de servidor fixa `sysadmin`.</span><span class="sxs-lookup"><span data-stu-id="7f08c-132">To perform this operation, you must be a member of the `sysadmin` fixed server role.</span></span> <span data-ttu-id="7f08c-133">Para obter mais informações, veja [Funções de nível de servidor](../security/authentication-access/server-level-roles.md).</span><span class="sxs-lookup"><span data-stu-id="7f08c-133">For more information, see [Server-Level Roles](../security/authentication-access/server-level-roles.md).</span></span>  
  
7.  <span data-ttu-id="7f08c-134">Verifique se as cópias dos arquivos de log modelo do mestre, do modelo e do msdb existem no servidor local.</span><span class="sxs-lookup"><span data-stu-id="7f08c-134">Verify that copies of the master, model, msdb data and log template files exist on the local server.</span></span> <span data-ttu-id="7f08c-135">O local padrão dos arquivos de modelo é C:\Arquivos de Programas\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\Binn\Templates.</span><span class="sxs-lookup"><span data-stu-id="7f08c-135">The default location for the template files is C:\Program Files\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\Binn\Templates.</span></span> <span data-ttu-id="7f08c-136">Esses arquivos são usados durante o processo de recriação e devem estar presentes para que a Instalação tenha êxito.</span><span class="sxs-lookup"><span data-stu-id="7f08c-136">These files are used during the rebuild process and must be present for Setup to succeed.</span></span> <span data-ttu-id="7f08c-137">Se eles estiverem ausentes, execute o recurso de Instalação Reparar ou copie os arquivos manualmente da mídia de instalação.</span><span class="sxs-lookup"><span data-stu-id="7f08c-137">If they are missing, run the Repair feature of Setup, or manually copy the files from your installation media.</span></span> <span data-ttu-id="7f08c-138">Para localizar os arquivos na mídia de instalação, navegue até o diretório da plataforma adequada (x86 ou x64) e, em seguida, navegue até setup\sql_engine_core_inst_msi\Pfiles\SqlServr\MSSQL.X\MSSQL\Binn\Templates.</span><span class="sxs-lookup"><span data-stu-id="7f08c-138">To locate the files on the installation media, navigate to the appropriate platform directory (x86 or x64) and then navigate to setup\sql_engine_core_inst_msi\Pfiles\SqlServr\MSSQL.X\MSSQL\Binn\Templates.</span></span>  
  
##  <a name="rebuild-system-databases"></a><a name="RebuildProcedure"></a> <span data-ttu-id="7f08c-139">Recriar bancos de dados do sistema</span><span class="sxs-lookup"><span data-stu-id="7f08c-139">Rebuild System Databases</span></span>  
 <span data-ttu-id="7f08c-140">O procedimento a seguir recria os bancos de dados do sistema mestre, modelo, msdb e tempdb.</span><span class="sxs-lookup"><span data-stu-id="7f08c-140">The following procedure rebuilds the master, model, msdb, and tempdb system databases.</span></span> <span data-ttu-id="7f08c-141">Você não pode especificar os bancos de dados do sistema que devem ser recriados.</span><span class="sxs-lookup"><span data-stu-id="7f08c-141">You cannot specify the system databases to be rebuilt.</span></span> <span data-ttu-id="7f08c-142">Para instâncias clusterizadas, esse procedimento deve ser executado no nó ativo, e o recurso do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] no grupo de aplicativos de cluster correspondente deve estar offline antes da execução do procedimento.</span><span class="sxs-lookup"><span data-stu-id="7f08c-142">For clustered instances, this procedure must be performed on the active node and the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] resource in the corresponding cluster application group must be taken offline before performing the procedure.</span></span>  
  
 <span data-ttu-id="7f08c-143">Esse procedimento não recria o banco de dados de recursos.</span><span class="sxs-lookup"><span data-stu-id="7f08c-143">This procedure does not rebuild the resource database.</span></span> <span data-ttu-id="7f08c-144">Consulte a seção, "Procedimento de recriação do banco de dados de recursos" mais adiante neste tópico.</span><span class="sxs-lookup"><span data-stu-id="7f08c-144">See the section, "Rebuild the resource Database Procedure" later in this topic.</span></span>  
  
#### <a name="to-rebuild-system-databases-for-an-instance-of-sql-server"></a><span data-ttu-id="7f08c-145">Para recriar os bancos de dados do sistema para uma instância do SQL Server:</span><span class="sxs-lookup"><span data-stu-id="7f08c-145">To rebuild system databases for an instance of SQL Server:</span></span>  
  
1.  <span data-ttu-id="7f08c-146">Insira a mídia de instalação do [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] na unidade de disco ou, em um prompt de comando, altere o diretório para o local do arquivo setup.exe no servidor local.</span><span class="sxs-lookup"><span data-stu-id="7f08c-146">Insert the [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] installation media into the disk drive, or, from a command prompt, change directories to the location of the setup.exe file on the local server.</span></span> <span data-ttu-id="7f08c-147">O local padrão no servidor é C:\Arquivos de Programas\Microsoft SQL Server\120\Setup Bootstrap\Release.</span><span class="sxs-lookup"><span data-stu-id="7f08c-147">The default location on the server is C:\Program Files\Microsoft SQL Server\120\Setup Bootstrap\Release.</span></span>  
  
2.  <span data-ttu-id="7f08c-148">Em uma janela de prompt de comando, digite o comando a seguir.</span><span class="sxs-lookup"><span data-stu-id="7f08c-148">From a command prompt window, enter the following command.</span></span> <span data-ttu-id="7f08c-149">São usados colchetes para indicar parâmetros opcionais.</span><span class="sxs-lookup"><span data-stu-id="7f08c-149">Square brackets are used to indicate optional parameters.</span></span> <span data-ttu-id="7f08c-150">Não digite os colchetes.</span><span class="sxs-lookup"><span data-stu-id="7f08c-150">Do not enter the brackets.</span></span> <span data-ttu-id="7f08c-151">Ao usar um sistema operacional Windows com UAC (Controle de Conta de Usuário) habilitado, a execução da Instalação exige privilégios elevados.</span><span class="sxs-lookup"><span data-stu-id="7f08c-151">When using a Windows operating system that has User Account Control (UAC) enabled, running Setup requires elevated privileges.</span></span> <span data-ttu-id="7f08c-152">O prompt de comando deve ser executado como Administrador.</span><span class="sxs-lookup"><span data-stu-id="7f08c-152">The command prompt must be run as Administrator.</span></span>  
  
     `Setup /QUIET /ACTION=REBUILDDATABASE /INSTANCENAME=InstanceName /SQLSYSADMINACCOUNTS=accounts [ /SAPWD= StrongPassword ] [ /SQLCOLLATION=CollationName]`  
  
    |<span data-ttu-id="7f08c-153">Nome do parâmetro</span><span class="sxs-lookup"><span data-stu-id="7f08c-153">Parameter name</span></span>|<span data-ttu-id="7f08c-154">Descrição</span><span class="sxs-lookup"><span data-stu-id="7f08c-154">Description</span></span>|  
    |--------------------|-----------------|  
    |<span data-ttu-id="7f08c-155">/QUIET ou /Q</span><span class="sxs-lookup"><span data-stu-id="7f08c-155">/QUIET or /Q</span></span>|<span data-ttu-id="7f08c-156">Especifica que a Instalação é executada sem nenhuma interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="7f08c-156">Specifies that Setup run without any user interface.</span></span>|  
    |<span data-ttu-id="7f08c-157">/ACTION=REBUILDDATABASE</span><span class="sxs-lookup"><span data-stu-id="7f08c-157">/ACTION=REBUILDDATABASE</span></span>|<span data-ttu-id="7f08c-158">Especifica que Instalação recria os bancos de dados do sistema.</span><span class="sxs-lookup"><span data-stu-id="7f08c-158">Specifies that Setup re-create the system databases.</span></span>|  
    |<span data-ttu-id="7f08c-159">/INSTANCENAME=*InstanceName*</span><span class="sxs-lookup"><span data-stu-id="7f08c-159">/INSTANCENAME=*InstanceName*</span></span>|<span data-ttu-id="7f08c-160">É o nome da instância do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7f08c-160">Is the name of the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="7f08c-161">Para a instância padrão, digite MSSQLSERVER.</span><span class="sxs-lookup"><span data-stu-id="7f08c-161">For the default instance, enter MSSQLSERVER.</span></span>|  
    |<span data-ttu-id="7f08c-162">/SQLSYSADMINACCOUNTS =*contas*</span><span class="sxs-lookup"><span data-stu-id="7f08c-162">/SQLSYSADMINACCOUNTS=*accounts*</span></span>|<span data-ttu-id="7f08c-163">Especifica os grupos ou contas individuais do Windows a serem adicionados à função de servidor fixa `sysadmin`.</span><span class="sxs-lookup"><span data-stu-id="7f08c-163">Specifies the Windows groups or individual accounts to add to the `sysadmin` fixed server role.</span></span> <span data-ttu-id="7f08c-164">Ao especificar mais de uma conta, separe as contas com um espaço em branco.</span><span class="sxs-lookup"><span data-stu-id="7f08c-164">When specifying more than one account, separate the accounts with a blank space.</span></span> <span data-ttu-id="7f08c-165">Por exemplo, digite **BUILTIN\Administrators MyDomain\MyUser**.</span><span class="sxs-lookup"><span data-stu-id="7f08c-165">For example, enter **BUILTIN\Administrators MyDomain\MyUser**.</span></span> <span data-ttu-id="7f08c-166">Quando você estiver especificando uma conta que contém um espaço em branco dentro do nome de conta, coloque a conta entre aspas duplas.</span><span class="sxs-lookup"><span data-stu-id="7f08c-166">When you are specifying an account that contains a blank space within the account name, enclose the account in double quotation marks.</span></span> <span data-ttu-id="7f08c-167">Por exemplo, insira `NT AUTHORITY\SYSTEM`.</span><span class="sxs-lookup"><span data-stu-id="7f08c-167">For example, enter `NT AUTHORITY\SYSTEM`.</span></span>|  
    |<span data-ttu-id="7f08c-168">[ /SAPWD=*StrongPassword* ]</span><span class="sxs-lookup"><span data-stu-id="7f08c-168">[ /SAPWD=*StrongPassword* ]</span></span>|<span data-ttu-id="7f08c-169">Especifica a senha da [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] `sa` conta.</span><span class="sxs-lookup"><span data-stu-id="7f08c-169">Specifies the password for the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] `sa` account.</span></span> <span data-ttu-id="7f08c-170">Esse parâmetro será exigido se a instância usar o modo de Autenticação Mista (Autenticação do[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] e do Windows).</span><span class="sxs-lookup"><span data-stu-id="7f08c-170">This parameter is required if the instance uses Mixed Authentication ([!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and Windows Authentication) mode.</span></span><br /><br /> <span data-ttu-id="7f08c-171">Observação de segurança a conta é \*\* \* uma conta bem conhecida \* e geralmente é direcionada por usuários mal-intencionados. \* \* \*\* `sa` [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]</span><span class="sxs-lookup"><span data-stu-id="7f08c-171">**\*\* Security Note \*\*** The `sa` account is a well-known [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] account and it is often targeted by malicious users.</span></span> <span data-ttu-id="7f08c-172">É muito importante que você use uma senha forte para o logon `sa`.</span><span class="sxs-lookup"><span data-stu-id="7f08c-172">It is very important that you use a strong password for the `sa` login.</span></span><br /><br /> <span data-ttu-id="7f08c-173">Não especifique esse parâmetro para o modo de Autenticação do Windows.</span><span class="sxs-lookup"><span data-stu-id="7f08c-173">Do not specify this parameter for Windows Authentication mode.</span></span>|  
    |<span data-ttu-id="7f08c-174">[ /SQLCOLLATION=*CollationName* ]</span><span class="sxs-lookup"><span data-stu-id="7f08c-174">[ /SQLCOLLATION=*CollationName* ]</span></span>|<span data-ttu-id="7f08c-175">Especifica uma nova ordenação no nível do servidor.</span><span class="sxs-lookup"><span data-stu-id="7f08c-175">Specifies a new server-level collation.</span></span> <span data-ttu-id="7f08c-176">Esse parâmetro é opcional.</span><span class="sxs-lookup"><span data-stu-id="7f08c-176">This parameter is optional.</span></span> <span data-ttu-id="7f08c-177">Quando não está especificado, a ordenação atual do servidor é usada.</span><span class="sxs-lookup"><span data-stu-id="7f08c-177">When not specified, the current collation of the server is used.</span></span><br /><br /> <span data-ttu-id="7f08c-178">**\*\* Importante \*\*** A alteração da ordenação no nível do servidor não altera a ordenação de bancos de dados de usuário existentes.</span><span class="sxs-lookup"><span data-stu-id="7f08c-178">**\*\* Important \*\*** Changing the server-level collation does not change the collation of existing user databases.</span></span> <span data-ttu-id="7f08c-179">Por padrão, todos os bancos de dados do usuário criados recentemente usarão a nova ordenação.</span><span class="sxs-lookup"><span data-stu-id="7f08c-179">All newly created user databases will use the new collation by default.</span></span><br /><br /> <span data-ttu-id="7f08c-180">Para obter mais informações, veja [Definir ou alterar a ordenação do servidor](../collations/set-or-change-the-server-collation.md).</span><span class="sxs-lookup"><span data-stu-id="7f08c-180">For more information, see [Set or Change the Server Collation](../collations/set-or-change-the-server-collation.md).</span></span>|  
  
3.  <span data-ttu-id="7f08c-181">Quando a Instalação tiver concluído a recriação dos bancos de dados do sistema, ela retornará ao prompt de comando sem mensagens.</span><span class="sxs-lookup"><span data-stu-id="7f08c-181">When Setup has completed rebuilding the system databases, it returns to the command prompt with no messages.</span></span> <span data-ttu-id="7f08c-182">Examine o arquivo de log Summary.txt para verificar se o processo foi concluído com êxito.</span><span class="sxs-lookup"><span data-stu-id="7f08c-182">Examine the Summary.txt log file to verify that the process completed successfully.</span></span> <span data-ttu-id="7f08c-183">Esse arquivo está localizado em C:\Arquivos de Programas\Microsoft SQL Server\120\Setup Bootstrap\Logs.</span><span class="sxs-lookup"><span data-stu-id="7f08c-183">This file is located at C:\Program Files\Microsoft SQL Server\120\Setup Bootstrap\Logs.</span></span>  
  
## <a name="post-rebuild-tasks"></a><span data-ttu-id="7f08c-184">Tarefas pós-recriação</span><span class="sxs-lookup"><span data-stu-id="7f08c-184">Post-Rebuild Tasks</span></span>  
 <span data-ttu-id="7f08c-185">Depois de recriar o banco de dados, talvez seja necessário executar as tarefas adicionais a seguir:</span><span class="sxs-lookup"><span data-stu-id="7f08c-185">After rebuilding the database you may need to perform the following additional tasks:</span></span>  
  
-   <span data-ttu-id="7f08c-186">Restaure os backups completos mais recentes dos bancos de dados mestre, modelo e msdb.</span><span class="sxs-lookup"><span data-stu-id="7f08c-186">Restore your most recent full backups of the master, model, and msdb databases.</span></span> <span data-ttu-id="7f08c-187">Para obter mais informações, consulte [Fazer backup e restaurar bancos de dados do sistema &#40;SQL Server&#41;](../backup-restore/back-up-and-restore-of-system-databases-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="7f08c-187">For more information, see [Back Up and Restore of System Databases &#40;SQL Server&#41;](../backup-restore/back-up-and-restore-of-system-databases-sql-server.md).</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="7f08c-188">Se você alterou a ordenação do servidor, não restaure os bancos de dados do sistema.</span><span class="sxs-lookup"><span data-stu-id="7f08c-188">If you have changed the server collation, do not restore the system databases.</span></span> <span data-ttu-id="7f08c-189">Fazer isso substituirá a nova ordenação pela configuração da ordenação anterior.</span><span class="sxs-lookup"><span data-stu-id="7f08c-189">Doing so will replace the new collation with the previous collation setting.</span></span>  
  
     <span data-ttu-id="7f08c-190">Se um backup não estiver disponível ou se o backup restaurado não for atual, recrie todas as entradas ausentes.</span><span class="sxs-lookup"><span data-stu-id="7f08c-190">If a backup is not available or if the restored backup is not current, re-create any missing entries.</span></span> <span data-ttu-id="7f08c-191">Por exemplo, recrie todas as entradas ausentes de seus bancos de dados de usuários, dispositivos de backup, logons, pontos de extremidade, etc. do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="7f08c-191">For example, re-create all missing entries for your user databases, backup devices, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] logins, end points, and so on.</span></span> <span data-ttu-id="7f08c-192">A melhor maneira de recriar entradas é executar os scripts originais que as criaram.</span><span class="sxs-lookup"><span data-stu-id="7f08c-192">The best way to re-create entries is to run the original scripts that created them.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="7f08c-193">É recomendável proteger os scripts para evitar que eles sejam alterados por indivíduos não autorizados.</span><span class="sxs-lookup"><span data-stu-id="7f08c-193">We recommend that you secure your scripts to prevent their being altered by unauthorized by individuals.</span></span>  
  
-   <span data-ttu-id="7f08c-194">Se a instância do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] estiver configurada como um Distribuidor de replicação, você deverá restaurar o banco de dados de distribuição.</span><span class="sxs-lookup"><span data-stu-id="7f08c-194">If the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is configured as a replication Distributor, you must restore the distribution database.</span></span> <span data-ttu-id="7f08c-195">Para obter mais informações, veja [Fazer backup e restaurar bancos de dados replicados](../replication/administration/back-up-and-restore-replicated-databases.md).</span><span class="sxs-lookup"><span data-stu-id="7f08c-195">For more information, see [Back Up and Restore Replicated Databases](../replication/administration/back-up-and-restore-replicated-databases.md).</span></span>  
  
-   <span data-ttu-id="7f08c-196">Mova os bancos de dados do sistema para os locais que você registrou anteriormente.</span><span class="sxs-lookup"><span data-stu-id="7f08c-196">Move the system databases to the locations you recorded previously.</span></span> <span data-ttu-id="7f08c-197">Para obter mais informações, veja [Mover bancos de dados do sistema](system-databases.md).</span><span class="sxs-lookup"><span data-stu-id="7f08c-197">For more information, see [Move System Databases](system-databases.md).</span></span>  
  
-   <span data-ttu-id="7f08c-198">Verifique se os valores da configuração de todo o servidor correspondem aos valores registrados anteriormente.</span><span class="sxs-lookup"><span data-stu-id="7f08c-198">Verify the server-wide configuration values match the values you recorded previously.</span></span>  
  
##  <a name="rebuild-the-resource-database"></a><a name="Resource"></a> <span data-ttu-id="7f08c-199">Recriar o banco de dados de recursos</span><span class="sxs-lookup"><span data-stu-id="7f08c-199">Rebuild the resource Database</span></span>  
 <span data-ttu-id="7f08c-200">O procedimento a seguir recria o banco de dados de recursos do sistema.</span><span class="sxs-lookup"><span data-stu-id="7f08c-200">The following procedure rebuilds the resource system database.</span></span> <span data-ttu-id="7f08c-201">Quando você recria o banco de dados de recursos, todos os service packs e hot fixes são perdidos, e portanto, devem ser reaplicados.</span><span class="sxs-lookup"><span data-stu-id="7f08c-201">When you rebuild the resource database, all service packs and hot fixes are lost, and therefore must be reapplied.</span></span>  
  
#### <a name="to-rebuild-the-resource-system-database"></a><span data-ttu-id="7f08c-202">Para recriar o banco de dados do sistema de recursos:</span><span class="sxs-lookup"><span data-stu-id="7f08c-202">To rebuild the resource system database:</span></span>  
  
1.  <span data-ttu-id="7f08c-203">Inicie o programa de Instalação do [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] (setup.exe) da mídia de distribuição.</span><span class="sxs-lookup"><span data-stu-id="7f08c-203">Launch the [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Setup program (setup.exe) from the distribution media.</span></span>  
  
2.  <span data-ttu-id="7f08c-204">Na área de navegação à esquerda, clique em **Manutenção**e em **Reparar**.</span><span class="sxs-lookup"><span data-stu-id="7f08c-204">In the left navigation area, click **Maintenance**, and then click **Repair**.</span></span>  
  
3.  <span data-ttu-id="7f08c-205">A regra de suporte à Instalação e as rotinas de arquivos são executadas para garantir que o sistema tenha os pré-requisitos instalados e que o computador aprove as regras de validação da Instalação.</span><span class="sxs-lookup"><span data-stu-id="7f08c-205">Setup support rule and file routines run to ensure that your system has prerequisites installed and that the computer passes Setup validation rules.</span></span> <span data-ttu-id="7f08c-206">Clique em **OK** ou em **Instalar** para continuar.</span><span class="sxs-lookup"><span data-stu-id="7f08c-206">Click **OK** or **Install** to continue.</span></span>  
  
4.  <span data-ttu-id="7f08c-207">Na página Selecionar Instância, selecione a instância a ser reparada e, em seguida, clique em **Avançar**.</span><span class="sxs-lookup"><span data-stu-id="7f08c-207">On the Select Instance page, select the instance to repair, and then click **Next**.</span></span>  
  
5.  <span data-ttu-id="7f08c-208">As regras de reparo são executadas para validar a operação.</span><span class="sxs-lookup"><span data-stu-id="7f08c-208">The repair rules will run to validate the operation.</span></span> <span data-ttu-id="7f08c-209">Para continuar, clique em **Avançar**.</span><span class="sxs-lookup"><span data-stu-id="7f08c-209">To continue, click **Next**.</span></span>  
  
6.  <span data-ttu-id="7f08c-210">Na página **Pronto para Reparar** , clique em **Reparar**.</span><span class="sxs-lookup"><span data-stu-id="7f08c-210">From the **Ready to Repair** page, click **Repair**.</span></span> <span data-ttu-id="7f08c-211">A página Concluído indica que a operação foi concluída.</span><span class="sxs-lookup"><span data-stu-id="7f08c-211">The Complete page indicates that the operation is finished.</span></span>  
  
##  <a name="create-a-new-msdb-database"></a><a name="CreateMSDB"></a> <span data-ttu-id="7f08c-212">Criar um novo banco de dados msdb</span><span class="sxs-lookup"><span data-stu-id="7f08c-212">Create a New msdb Database</span></span>  
 <span data-ttu-id="7f08c-213">Se o `msdb` banco de dados estiver danificado e você não tiver um backup do `msdb` banco de dados, você poderá criar um novo `msdb` usando o script **instmsdb** .</span><span class="sxs-lookup"><span data-stu-id="7f08c-213">If the `msdb` database is damaged and you do not have a backup of the `msdb` database, you can create a new `msdb` by using the **instmsdb** script.</span></span>  
  
> [!WARNING]  
>  <span data-ttu-id="7f08c-214">A recriação do `msdb` banco de dados usando o script **instmsdb** eliminará todas as informações armazenadas em como `msdb` trabalhos, alertas, operadores, planos de manutenção, histórico de backup, configurações de gerenciamento baseado em políticas, Database Mail, data warehouse de desempenho, etc.</span><span class="sxs-lookup"><span data-stu-id="7f08c-214">Rebuilding the `msdb` database using the **instmsdb** script will eliminate all the information stored in `msdb` such as jobs, alert, operators, maintenance plans, backup history, Policy-Based Management settings, Database Mail, Performance Data Warehouse, etc.</span></span>  
  
1.  <span data-ttu-id="7f08c-215">Pare todos os serviços que estejam se conectando ao [!INCLUDE[ssDE](../../includes/ssde-md.md)], inclusive o [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent, [!INCLUDE[ssRS](../../includes/ssrs.md)], [!INCLUDE[ssIS](../../includes/ssis-md.md)], e todos os aplicativos que estejam usando o [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] como um repositório de dados.</span><span class="sxs-lookup"><span data-stu-id="7f08c-215">Stop all services connecting to the [!INCLUDE[ssDE](../../includes/ssde-md.md)], including [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent, [!INCLUDE[ssRS](../../includes/ssrs.md)], [!INCLUDE[ssIS](../../includes/ssis-md.md)], and all applications using [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] as data store.</span></span>  
  
2.  <span data-ttu-id="7f08c-216">Inicie o [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] a partir da linha de comando usando o comando: `NET START MSSQLSERVER /T3608`</span><span class="sxs-lookup"><span data-stu-id="7f08c-216">Start [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] from the command line using the command: `NET START MSSQLSERVER /T3608`</span></span>  
  
     <span data-ttu-id="7f08c-217">Para obter mais informações, consulte [Iniciar, parar, pausar, retomar e reiniciar os serviços SQL Server](../../database-engine/configure-windows/start-stop-pause-resume-restart-sql-server-services.md).</span><span class="sxs-lookup"><span data-stu-id="7f08c-217">For more information, see [Start, Stop, Pause, Resume, Restart the Database Engine, SQL Server Agent, or SQL Server Browser Service](../../database-engine/configure-windows/start-stop-pause-resume-restart-sql-server-services.md).</span></span>  
  
3.  <span data-ttu-id="7f08c-218">Em outra janela de linha de comando, desanexe o `msdb` banco de dados executando o seguinte comando, substituindo *\<servername>* pela instância do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] :`SQLCMD -E -S<servername> -dmaster -Q"EXEC sp_detach_db msdb"`</span><span class="sxs-lookup"><span data-stu-id="7f08c-218">In another command line window, detach the `msdb` database by executing the following command, replacing *\<servername>* with the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]: `SQLCMD -E -S<servername> -dmaster -Q"EXEC sp_detach_db msdb"`</span></span>  
  
4.  <span data-ttu-id="7f08c-219">Usando o Windows Explorer, renomeie os `msdb` arquivos de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="7f08c-219">Using the Windows Explorer, rename the `msdb` database files.</span></span> <span data-ttu-id="7f08c-220">Por padrão, eles estão na subpasta DATA da instância do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="7f08c-220">By default these are in the DATA sub-folder for the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance.</span></span>  
  
5.  <span data-ttu-id="7f08c-221">Usando o [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Configuration Manager, pare e reinicie o serviço [!INCLUDE[ssDE](../../includes/ssde-md.md)] normalmente.</span><span class="sxs-lookup"><span data-stu-id="7f08c-221">Using [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Configuration Manager, stop and restart the [!INCLUDE[ssDE](../../includes/ssde-md.md)] service normally.</span></span>  
  
6.  <span data-ttu-id="7f08c-222">Em uma janela de linha de comando, conecte-se a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] e execute o comando: `SQLCMD -E -S<servername> -i"C:\Program Files\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\Install\instmsdb.sql" -o" C:\Program Files\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\Install\instmsdb.out"`</span><span class="sxs-lookup"><span data-stu-id="7f08c-222">In a command line window, connect to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and execute the command: `SQLCMD -E -S<servername> -i"C:\Program Files\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\Install\instmsdb.sql" -o" C:\Program Files\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\Install\instmsdb.out"`</span></span>  
  
     <span data-ttu-id="7f08c-223">Substitua *\<servername>* pela instância do [!INCLUDE[ssDE](../../includes/ssde-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7f08c-223">Replace *\<servername>* with the instance of the [!INCLUDE[ssDE](../../includes/ssde-md.md)].</span></span> <span data-ttu-id="7f08c-224">Use o caminho do sistema de arquivo da instância do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7f08c-224">Use the file system path of the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
7.  <span data-ttu-id="7f08c-225">Usando o Bloco de Notas do Windows, abra o arquivo **instmsdb.out** e verifique se há erros na saída.</span><span class="sxs-lookup"><span data-stu-id="7f08c-225">Using the Windows Notepad, open the **instmsdb.out** file and check the output for any errors.</span></span>  
  
8.  <span data-ttu-id="7f08c-226">Aplique novamente pacotes de serviços ou o hotfix instalado na instância.</span><span class="sxs-lookup"><span data-stu-id="7f08c-226">Re-apply any service packs or hotfix installed on the instance.</span></span>  
  
9. <span data-ttu-id="7f08c-227">Recrie o conteúdo do usuário armazenado no `msdb` banco de dados, como trabalhos, alerta, etc.</span><span class="sxs-lookup"><span data-stu-id="7f08c-227">Recreate the user content stored in the `msdb` database, such as jobs, alert, etc.</span></span>  
  
10. <span data-ttu-id="7f08c-228">Faça backup do banco de dados do `msdb` .</span><span class="sxs-lookup"><span data-stu-id="7f08c-228">Backup the `msdb` database.</span></span>  
  
##  <a name="troubleshoot-rebuild-errors"></a><a name="Troubleshoot"></a> <span data-ttu-id="7f08c-229">Solução de problemas de erros de recriação</span><span class="sxs-lookup"><span data-stu-id="7f08c-229">Troubleshoot Rebuild Errors</span></span>  
 <span data-ttu-id="7f08c-230">Erros de sintaxe e outros erros em tempo de execução são exibidos na janela do prompt de comando.</span><span class="sxs-lookup"><span data-stu-id="7f08c-230">Syntax and other run-time errors are displayed in the command prompt window.</span></span> <span data-ttu-id="7f08c-231">Examine os erros de sintaxe a seguir na instrução da Instalação:</span><span class="sxs-lookup"><span data-stu-id="7f08c-231">Examine the Setup statement for the following syntax errors:</span></span>  
  
-   <span data-ttu-id="7f08c-232">Marca de barra (/) ausente na frente de cada nome de parâmetro.</span><span class="sxs-lookup"><span data-stu-id="7f08c-232">Missing slash mark (/) in front of each parameter name.</span></span>  
  
-   <span data-ttu-id="7f08c-233">Sinal de igualdade (=) ausente entre o nome do parâmetro e o valor do parâmetro.</span><span class="sxs-lookup"><span data-stu-id="7f08c-233">Missing equal sign (=) between the parameter name and the parameter value.</span></span>  
  
-   <span data-ttu-id="7f08c-234">Presença de espaços em branco entre o nome do parâmetro e o sinal de igual.</span><span class="sxs-lookup"><span data-stu-id="7f08c-234">Presence of blank spaces between the parameter name and the equal sign.</span></span>  
  
-   <span data-ttu-id="7f08c-235">Presença de vírgulas (,) ou outros caracteres que não são especificados na sintaxe.</span><span class="sxs-lookup"><span data-stu-id="7f08c-235">Presence of commas (,) or other characters that are not specified in the syntax.</span></span>  
  
 <span data-ttu-id="7f08c-236">Depois que a operação de recriação é concluída, examine se há erros nos logs do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="7f08c-236">After the rebuild operation is complete, examine the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] logs for any errors.</span></span> <span data-ttu-id="7f08c-237">O local do log padrão é C:\Arquivos de Programas\Microsoft SQL Server\120\Setup Bootstrap\Logs.</span><span class="sxs-lookup"><span data-stu-id="7f08c-237">The default log location is C:\Program Files\Microsoft SQL Server\120\Setup Bootstrap\Logs.</span></span> <span data-ttu-id="7f08c-238">Para localizar o arquivo de log que contém os resultados do processo de recriação, altere os diretórios para a pasta Logs em um prompt de comando e execute `findstr /s RebuildDatabase summary*.*`.</span><span class="sxs-lookup"><span data-stu-id="7f08c-238">To locate the log file that contains the results of the rebuild process, change directories to the Logs folder from a command prompt, and then run `findstr /s RebuildDatabase summary*.*`.</span></span> <span data-ttu-id="7f08c-239">Essa pesquisa apontará para qualquer arquivo de log que contenha os resultados da recriação dos bancos de dados do sistema.</span><span class="sxs-lookup"><span data-stu-id="7f08c-239">This search will point you to any log files that contain the results of rebuilding system databases.</span></span> <span data-ttu-id="7f08c-240">Abra os arquivos de log e examine-os para verificar se há mensagens de erro relevantes.</span><span class="sxs-lookup"><span data-stu-id="7f08c-240">Open the log files and examine them for relevant error messages.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="7f08c-241">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="7f08c-241">See Also</span></span>  
 [<span data-ttu-id="7f08c-242">Bancos de dados do sistema</span><span class="sxs-lookup"><span data-stu-id="7f08c-242">System Databases</span></span>](system-databases.md)  
  
  
