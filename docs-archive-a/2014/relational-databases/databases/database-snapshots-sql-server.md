---
title: Instantâneos do banco de dados (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: configuration
ms.topic: conceptual
helpviewer_keywords:
- static database views
- snapshots [SQL Server database snapshots]
- source databases [SQL Server]
- snapshots [SQL Server database snapshots], about database snapshots
- database snapshots [SQL Server]
- read-only database views
- database snapshots [SQL Server], about database snapshots
ms.assetid: 00179314-f23e-47cb-a35c-da6f180f86d3
author: stevestein
ms.author: sstein
ms.openlocfilehash: 8a0fa9b6cee2287d4e6060d4cb39f34d909e7db9
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87685753"
---
# <a name="database-snapshots-sql-server"></a><span data-ttu-id="b3458-102">Instantâneos de banco de dados (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="b3458-102">Database Snapshots (SQL Server)</span></span>
  <span data-ttu-id="b3458-103">Um instantâneo de banco de dados é uma exibição estática somente leitura de um banco de dados do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] (o *banco de dados de origem*).</span><span class="sxs-lookup"><span data-stu-id="b3458-103">A database snapshot is a read-only, static view of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database (the *source database*).</span></span> <span data-ttu-id="b3458-104">O instantâneo de banco de dados é transacionalmente consistente com o banco de dados de origem a partir do momento da criação do instantâneo.</span><span class="sxs-lookup"><span data-stu-id="b3458-104">The database snapshot is transactionally consistent with the source database as of the moment of the snapshot's creation.</span></span> <span data-ttu-id="b3458-105">Um instantâneo de um banco de dados sempre reside na mesma instância de servidor que o banco de dados de origem.</span><span class="sxs-lookup"><span data-stu-id="b3458-105">A database snapshot always resides on the same server instance as its source database.</span></span> <span data-ttu-id="b3458-106">Quando o banco de dados de origem é atualizado, o instantâneo do banco de dados é atualizado.</span><span class="sxs-lookup"><span data-stu-id="b3458-106">As the source database is updated, the database snapshot is updated.</span></span> <span data-ttu-id="b3458-107">Portanto, quanto mais tempo o instantâneo de banco de dados existir, maior será a probabilidade de ele usar todo o espaço em disco disponível.</span><span class="sxs-lookup"><span data-stu-id="b3458-107">Therefore, the longer a database snapshot exists, the more likely it is to use up its available disk space.</span></span>  
  
 <span data-ttu-id="b3458-108">Vários instantâneos podem existir em um banco de dados de origem.</span><span class="sxs-lookup"><span data-stu-id="b3458-108">Multiple snapshots can exist on a given source database.</span></span> <span data-ttu-id="b3458-109">Cada instantâneo de banco de dados persiste até que seja explicitamente removido pelo proprietário do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="b3458-109">Each database snapshot persists until it is explicitly dropped by the database owner.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="b3458-110">Os instantâneos de banco de dados não estão relacionados a backups de instantâneos, isolamento de instantâneo de transações ou replicação de instantâneo.</span><span class="sxs-lookup"><span data-stu-id="b3458-110">Database snapshots are unrelated to snapshot backups, snapshot isolation of transactions, or snapshot replication.</span></span>  
  
 <span data-ttu-id="b3458-111">**Neste tópico:**</span><span class="sxs-lookup"><span data-stu-id="b3458-111">**In this Topic:**</span></span>  
  
-   [<span data-ttu-id="b3458-112">Visão geral do recurso</span><span class="sxs-lookup"><span data-stu-id="b3458-112">Feature Overview</span></span>](#FeatureOverview)  
  
-   [<span data-ttu-id="b3458-113">Benefícios dos instantâneos de banco de dados</span><span class="sxs-lookup"><span data-stu-id="b3458-113">Benefits of Database Snapshots</span></span>](#Benefits)  
  
-   [<span data-ttu-id="b3458-114">Termos e definições</span><span class="sxs-lookup"><span data-stu-id="b3458-114">Terms and Definitions</span></span>](#TermsAndDefinitions)  
  
-   [<span data-ttu-id="b3458-115">Pré-requisitos e limitações dos instantâneos de banco de dados</span><span class="sxs-lookup"><span data-stu-id="b3458-115">Prerequisites for and Limitations on Database Snapshots</span></span>](#LimitationsRequirements)  
  
-   [<span data-ttu-id="b3458-116">Tarefas relacionadas</span><span class="sxs-lookup"><span data-stu-id="b3458-116">Related Tasks</span></span>](#RelatedTasks)  
  
##  <a name="feature-overview"></a><a name="FeatureOverview"></a> <span data-ttu-id="b3458-117">Visão geral do recurso</span><span class="sxs-lookup"><span data-stu-id="b3458-117">Feature Overview</span></span>  
 <span data-ttu-id="b3458-118">Os instantâneos do banco de dados funcionam no nível da página de dados.</span><span class="sxs-lookup"><span data-stu-id="b3458-118">Database snapshots operate at the data-page level.</span></span> <span data-ttu-id="b3458-119">Antes que uma página do banco de dados de origem seja modificada pela primeira vez, a página original é copiada do banco de dados de origem ao instantâneo.</span><span class="sxs-lookup"><span data-stu-id="b3458-119">Before a page of the source database is modified for the first time, the original page is copied from the source database to the snapshot.</span></span> <span data-ttu-id="b3458-120">O instantâneo armazena a página original, preservando os registros de dados da forma como existiam quando o instantâneo foi criado.</span><span class="sxs-lookup"><span data-stu-id="b3458-120">The snapshot stores the original page, preserving the data records as they existed when the snapshot was created.</span></span> <span data-ttu-id="b3458-121">O mesmo processo é repetido para todas as páginas modificadas pela primeira vez.</span><span class="sxs-lookup"><span data-stu-id="b3458-121">The same process is repeated for every page that is being modified for the first time.</span></span> <span data-ttu-id="b3458-122">Para o usuário, um instantâneo do banco de dados parece nunca ser alterado, porque as operações de leitura em um instantâneo do banco de dados sempre acessam as páginas de dados originais, independentemente de onde elas residam.</span><span class="sxs-lookup"><span data-stu-id="b3458-122">To the user, a database snapshot appears never to change, because read operations on a database snapshot always access the original data pages, regardless of where they reside.</span></span>  
  
 <span data-ttu-id="b3458-123">Para armazenar as páginas originais copiadas, o instantâneo usa um ou mais *arquivos esparsos*.</span><span class="sxs-lookup"><span data-stu-id="b3458-123">To store the copied original pages, the snapshot uses one or more *sparse files*.</span></span> <span data-ttu-id="b3458-124">Inicialmente, um arquivo esparso é, essencialmente, um arquivo vazio que não contém dados de usuário e no qual ainda não foi alocado espaço em disco para os dados do usuário.</span><span class="sxs-lookup"><span data-stu-id="b3458-124">Initially, a sparse file is an essentially empty file that contains no user data and has not yet been allocated disk space for user data.</span></span> <span data-ttu-id="b3458-125">À medida que mais páginas são atualizadas no banco de dados de origem, o tamanho do arquivo aumenta.</span><span class="sxs-lookup"><span data-stu-id="b3458-125">As more and more pages are updated in the source database, the size of the file grows.</span></span> <span data-ttu-id="b3458-126">A figura a seguir mostra os efeitos de dois padrões de atualização contrastantes no tamanho de um instantâneo.</span><span class="sxs-lookup"><span data-stu-id="b3458-126">The following figure illustrates the effects of two contrasting update patterns on the size of a snapshot.</span></span> <span data-ttu-id="b3458-127">O padrão de atualização A reflete um ambiente em que apenas 30% das páginas originais são atualizadas durante a vida do instantâneo.</span><span class="sxs-lookup"><span data-stu-id="b3458-127">Update pattern A reflects an environment in which only 30 percent of the original pages are updated during the life of the snapshot.</span></span> <span data-ttu-id="b3458-128">O padrão de atualização B reflete um ambiente em que 80% das páginas originais são atualizadas durante a vida do instantâneo.</span><span class="sxs-lookup"><span data-stu-id="b3458-128">Update pattern B reflects an environment in which 80 percent of the original pages are updated during the life of the snapshot.</span></span>  
  
 <span data-ttu-id="b3458-129">![Padrões alternativos de atualização e tamanho do instantâneo](../../database-engine/media/dbview-04.gif "Padrões alternativos de atualização e tamanho do instantâneo")</span><span class="sxs-lookup"><span data-stu-id="b3458-129">![Alternative update patterns and snapshot size](../../database-engine/media/dbview-04.gif "Alternative update patterns and snapshot size")</span></span>  
  
##  <a name="benefits-of-database-snapshots"></a><a name="Benefits"></a> <span data-ttu-id="b3458-130">Benefícios dos instantâneos de banco de dados</span><span class="sxs-lookup"><span data-stu-id="b3458-130">Benefits of Database Snapshots</span></span>  
  
-   <span data-ttu-id="b3458-131">Os instantâneos podem ser utilizados para fins de geração de relatórios.</span><span class="sxs-lookup"><span data-stu-id="b3458-131">Snapshots can be used for reporting purposes.</span></span>  
  
     <span data-ttu-id="b3458-132">Os clientes podem consultar um instantâneo do banco de dados, o que é útil para gravar relatórios com base nos dados no momento da criação do instantâneo.</span><span class="sxs-lookup"><span data-stu-id="b3458-132">Clients can query a database snapshot, which makes it useful for writing reports based on the data at the time of snapshot creation.</span></span>  
  
-   <span data-ttu-id="b3458-133">Manutenção de dados históricos para geração de relatórios.</span><span class="sxs-lookup"><span data-stu-id="b3458-133">Maintaining historical data for report generation.</span></span>  
  
     <span data-ttu-id="b3458-134">Um instantâneo pode estender o acesso a dados do usuário em um momento determinado.</span><span class="sxs-lookup"><span data-stu-id="b3458-134">A snapshot can extend user access to data from a particular point in time.</span></span> <span data-ttu-id="b3458-135">Por exemplo, você pode criar um instantâneo do banco de dados ao término de um determinado período (como um trimestre financeiro) para geração posterior de relatório.</span><span class="sxs-lookup"><span data-stu-id="b3458-135">For example, you can create a database snapshot at the end of a given time period (such as a financial quarter) for later reporting.</span></span> <span data-ttu-id="b3458-136">Você pode executar relatórios de fim de período no instantâneo.</span><span class="sxs-lookup"><span data-stu-id="b3458-136">You can then run end-of-period reports on the snapshot.</span></span> <span data-ttu-id="b3458-137">Se o espaço em disco permitir, você também poderá manter os instantâneos de fim de período indefinidamente, permitindo consultas aos resultados desses períodos; por exemplo, para investigar o desempenho organizacional.</span><span class="sxs-lookup"><span data-stu-id="b3458-137">If disk space permits, you can also maintain end-of-period snapshots indefinitely, allowing queries against the results from these periods; for example, to investigate organizational performance.</span></span>  
  
-   <span data-ttu-id="b3458-138">Usando um banco de dados espelho mantido para fins de disponibilidade para descarregar relatórios.</span><span class="sxs-lookup"><span data-stu-id="b3458-138">Using a mirror database that you are maintaining for availability purposes to offload reporting.</span></span>  
  
     <span data-ttu-id="b3458-139">O uso de instantâneos com espelhamento de banco de dados permite tornar os dados no servidor espelho acessíveis para geração de relatórios.</span><span class="sxs-lookup"><span data-stu-id="b3458-139">Using database snapshots with database mirroring permits you to make the data on the mirror server accessible for reporting.</span></span> <span data-ttu-id="b3458-140">Além disso, a execução de consultas no banco de dados espelho pode liberar recursos no banco de dados principal.</span><span class="sxs-lookup"><span data-stu-id="b3458-140">Additionally, running queries on the mirror database can free up resources on the principal.</span></span> <span data-ttu-id="b3458-141">Para obter mais informações, consulte [Espelhamento de banco de dados e instantâneos de banco de dados &#40;SQL Server&#41;](database-snapshots-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="b3458-141">For more information, see [Database Mirroring and Database Snapshots &#40;SQL Server&#41;](database-snapshots-sql-server.md).</span></span>  
  
-   <span data-ttu-id="b3458-142">Protegendo dados de erros administrativos.</span><span class="sxs-lookup"><span data-stu-id="b3458-142">Safeguarding data against administrative error.</span></span>  
  
-   <span data-ttu-id="b3458-143">No caso de um erro do usuário em um banco de dados de origem, você poderá reverter o banco de dados de origem ao estado em que estava quando um instantâneo de banco de dados foi criado.</span><span class="sxs-lookup"><span data-stu-id="b3458-143">In the event of a user error on a source database, you can revert the source database to the state it was in when a given database snapshot was created.</span></span> <span data-ttu-id="b3458-144">A perda de dados é limitada às atualizações no banco de dados desde a criação do instantâneo.</span><span class="sxs-lookup"><span data-stu-id="b3458-144">Data loss is confined to updates to the database since the snapshot's creation.</span></span>  
  
     <span data-ttu-id="b3458-145">Por exemplo, antes de fazer atualizações maiores, como uma atualização em massa ou uma alteração de esquema, a criação de um instantâneo do banco de dados protegerá os dados.</span><span class="sxs-lookup"><span data-stu-id="b3458-145">For example, before doing major updates, such as a bulk update or a schema change, create a database snapshot on the database protects data.</span></span> <span data-ttu-id="b3458-146">Se cometer um erro, você poderá usar o instantâneo para recuperar o banco de dados ao revertê-lo para o instantâneo.</span><span class="sxs-lookup"><span data-stu-id="b3458-146">If you make a mistake, you can use the snapshot to recover by reverting the database to the snapshot.</span></span> <span data-ttu-id="b3458-147">A reversão é potencialmente muito mais rápida para essa finalidade do que a restauração a partir de um backup; porém, você não poderá efetuar roll forward posteriormente.</span><span class="sxs-lookup"><span data-stu-id="b3458-147">Reverting is potentially much faster for this purpose than restoring from a backup; however, you cannot roll forward afterward.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="b3458-148">A reversão não funciona em um banco de dados offline ou corrompido.</span><span class="sxs-lookup"><span data-stu-id="b3458-148">Reverting does not work in an offline or corrupted database.</span></span> <span data-ttu-id="b3458-149">Portanto, é necessário fazer backups e testar regularmente seu plano de restauração para proteger um banco de dados.</span><span class="sxs-lookup"><span data-stu-id="b3458-149">Therefore, taking regular backups and testing your restore plan are necessary to protect a database.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="b3458-150">Os instantâneos do banco de dados são dependentes do banco de dados de origem.</span><span class="sxs-lookup"><span data-stu-id="b3458-150">Database snapshots are dependent on the source database.</span></span> <span data-ttu-id="b3458-151">Portanto, o uso de instantâneos do banco de dados para reverter um banco de dados não é um substituto da estratégia de backup e restauração.</span><span class="sxs-lookup"><span data-stu-id="b3458-151">Therefore, using database snapshots for reverting a database is not a substitute for your backup and restore strategy.</span></span> <span data-ttu-id="b3458-152">A execução de todos os backups agendados continua essencial.</span><span class="sxs-lookup"><span data-stu-id="b3458-152">Performing all your scheduled backups remains essential.</span></span> <span data-ttu-id="b3458-153">Se for necessário restaurar o banco de dados de origem para o momento determinado em que o instantâneo foi criado, implemente uma política de backup que permita fazer isso.</span><span class="sxs-lookup"><span data-stu-id="b3458-153">If you must restore the source database to the point in time at which you created a database snapshot, implement a backup policy that enables you to do that.</span></span>  
  
-   <span data-ttu-id="b3458-154">Protegendo dados de erros do usuário.</span><span class="sxs-lookup"><span data-stu-id="b3458-154">Safeguarding data against user error.</span></span>  
  
     <span data-ttu-id="b3458-155">Com a criação regular de instantâneos do banco de dados, você pode reduzir o impacto de um erro maior do usuário, como uma tabela descartada.</span><span class="sxs-lookup"><span data-stu-id="b3458-155">By creating database snapshots on a regular basis, you can mitigate the impact of a major user error, such as a dropped table.</span></span> <span data-ttu-id="b3458-156">Para um alto nível de proteção, você pode criar uma série de instantâneos do banco de dados que abrangem tempo suficiente para reconhecer e responder à maioria dos erros de usuário.</span><span class="sxs-lookup"><span data-stu-id="b3458-156">For a high level of protection, you can create a series of database snapshots spanning enough time to recognize and respond to most user errors.</span></span> <span data-ttu-id="b3458-157">Por exemplo, de acordo com os recursos de seu disco, você pode manter de 6 a 12 instantâneos móveis abrangendo um intervalo de 24 horas.</span><span class="sxs-lookup"><span data-stu-id="b3458-157">For instance, you might maintain 6 to 12 rolling snapshots spanning a 24-hour interval, depending on your disk resources.</span></span> <span data-ttu-id="b3458-158">Portanto, sempre que um novo instantâneo é criado, o mais antigo pode ser excluído.</span><span class="sxs-lookup"><span data-stu-id="b3458-158">Then, each time a new snapshot is created, the earliest snapshot can be deleted.</span></span>  
  
    -   <span data-ttu-id="b3458-159">Para se recuperar de um erro de usuário, você pode reverter imediatamente o banco de dados ao instantâneo antes do erro.</span><span class="sxs-lookup"><span data-stu-id="b3458-159">To recover from a user error, you can revert the database to the snapshot immediately before the error.</span></span> <span data-ttu-id="b3458-160">A reversão é potencialmente muito mais rápida para essa finalidade do que a restauração a partir de um backup; porém, você não poderá efetuar roll forward posteriormente.</span><span class="sxs-lookup"><span data-stu-id="b3458-160">Reverting is potentially much faster for this purpose than restoring from a backup; however, you cannot roll forward afterward.</span></span>  
  
    -   <span data-ttu-id="b3458-161">Alternativamente, você pode reconstruir manualmente uma tabela descartada ou outros dados perdidos a partir das informações em um instantâneo.</span><span class="sxs-lookup"><span data-stu-id="b3458-161">Alternatively, you may be able to manually reconstruct a dropped table or other lost data from the information in a snapshot.</span></span> <span data-ttu-id="b3458-162">Por exemplo, você pode copiar os dados em massa fora do instantâneo no banco de dados e mesclar manualmente os dados de volta ao banco de dados.</span><span class="sxs-lookup"><span data-stu-id="b3458-162">For instance, you could bulk copy the data out of the snapshot into the database and manually merge the data back into the database.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="b3458-163">Seus motivos para usar instantâneos do banco de dados determinam quantos instantâneos simultâneos são necessários em um banco de dados, com que frequência um instantâneo deve ser criado e por quanto tempo deve ser mantido.</span><span class="sxs-lookup"><span data-stu-id="b3458-163">Your reasons for using database snapshots determine how many concurrent snapshots you need on a database, how frequently to create a new snapshot, and how long to keep it.</span></span>  
  
-   <span data-ttu-id="b3458-164">Gerenciando um banco de dados de teste</span><span class="sxs-lookup"><span data-stu-id="b3458-164">Managing a test database</span></span>  
  
     <span data-ttu-id="b3458-165">Em um ambiente de teste, pode ser útil manter dados idênticos no início de cada sessão de testes ao executar um protocolo de teste repetidamente para o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="b3458-165">In a testing environment, it can be useful when repeatedly running a test protocol for the database to contain identical data at the start of each round of testing.</span></span> <span data-ttu-id="b3458-166">Antes de executar a primeira sessão, um testador ou desenvolvedor de aplicativos pode criar um instantâneo do banco de dados no banco de dados de teste.</span><span class="sxs-lookup"><span data-stu-id="b3458-166">Before running the first round, an application developer or tester can create a database snapshot on the test database.</span></span> <span data-ttu-id="b3458-167">Depois de cada execução do teste, o banco de dados poderá retornar rapidamente ao seu estado anterior por meio da reversão do instantâneo do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="b3458-167">After each test run, the database can be quickly returned to its prior state by reverting the database snapshot.</span></span>  
  
##  <a name="terms-and-definitions"></a><a name="TermsAndDefinitions"></a> <span data-ttu-id="b3458-168">Termos e definições</span><span class="sxs-lookup"><span data-stu-id="b3458-168">Terms and Definitions</span></span>  
 <span data-ttu-id="b3458-169">instantâneo do banco de dados</span><span class="sxs-lookup"><span data-stu-id="b3458-169">database snapshot</span></span>  
 <span data-ttu-id="b3458-170">Uma exibição estática somente leitura transacionalmente consistente de um banco de dados (o banco de dados de origem).</span><span class="sxs-lookup"><span data-stu-id="b3458-170">A transactionally consistent, read-only, static view of a database (the source database).</span></span>  
  
 <span data-ttu-id="b3458-171">banco de dados de origem</span><span class="sxs-lookup"><span data-stu-id="b3458-171">source database</span></span>  
 <span data-ttu-id="b3458-172">No caso de um instantâneo de banco de dados, é o banco de dados no qual o instantâneo foi criado.</span><span class="sxs-lookup"><span data-stu-id="b3458-172">For a database snapshot, the database on which the snapshot was created.</span></span> <span data-ttu-id="b3458-173">Os instantâneos do banco de dados são dependentes do banco de dados de origem.</span><span class="sxs-lookup"><span data-stu-id="b3458-173">Database snapshots are dependent on the source database.</span></span> <span data-ttu-id="b3458-174">Os instantâneos de um banco de dados devem estar na mesma instância de servidor que o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="b3458-174">The snapshots of a database must be on the same server instance as the database.</span></span> <span data-ttu-id="b3458-175">Além disso, se o banco de dados ficar indisponível por qualquer razão, todos os seus instantâneos do banco de dados também ficarão indisponíveis.</span><span class="sxs-lookup"><span data-stu-id="b3458-175">Furthermore, if that database becomes unavailable for any reason, all of its database snapshots also become unavailable.</span></span>  
  
 <span data-ttu-id="b3458-176">arquivo esparso</span><span class="sxs-lookup"><span data-stu-id="b3458-176">sparse file</span></span>  
 <span data-ttu-id="b3458-177">Um arquivo fornecido pelo sistema de arquivos NTFS que requer muito menos espaço em disco do que seria necessário de outra forma.</span><span class="sxs-lookup"><span data-stu-id="b3458-177">A file provided by the NTFS file system that requires much less disk space than would otherwise be needed.</span></span> <span data-ttu-id="b3458-178">Um arquivo esparso é usado para armazenar páginas copiadas para um instantâneo de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="b3458-178">A sparse file is used to store pages copied to a database snapshot.</span></span> <span data-ttu-id="b3458-179">Quando criado, um arquivo esparso ocupa pouco espaço em disco.</span><span class="sxs-lookup"><span data-stu-id="b3458-179">When first created, a sparse file takes up little disk space.</span></span> <span data-ttu-id="b3458-180">Conforme os dados são gravados em um instantâneo de banco de dados, o NTFS aloca gradualmente espaço em disco no arquivo esparso correspondente.</span><span class="sxs-lookup"><span data-stu-id="b3458-180">As data is written to a database snapshot, NTFS allocates disk space gradually to the corresponding sparse file.</span></span>  
  
##  <a name="prerequisites-for-and-limitations-on-database-snapshots"></a><a name="LimitationsRequirements"></a> <span data-ttu-id="b3458-181">Pré-requisitos e limitações dos instantâneos de banco de dados</span><span class="sxs-lookup"><span data-stu-id="b3458-181">Prerequisites for and Limitations on Database Snapshots</span></span>  
 <span data-ttu-id="b3458-182">**Nesta seção:**</span><span class="sxs-lookup"><span data-stu-id="b3458-182">**In This Section:**</span></span>  
  
-   [<span data-ttu-id="b3458-183">Pré-requisitos</span><span class="sxs-lookup"><span data-stu-id="b3458-183">Prerequisites</span></span>](#Prerequisites)  
  
-   [<span data-ttu-id="b3458-184">Limitações do banco de dados de origem</span><span class="sxs-lookup"><span data-stu-id="b3458-184">Limitations on the Source Database</span></span>](#LimitsOnSourceDb)  
  
-   [<span data-ttu-id="b3458-185">Limitações em instantâneos do banco de dados</span><span class="sxs-lookup"><span data-stu-id="b3458-185">Limitations on Database Snapshots</span></span>](#LimitsOnDbSS)  
  
-   [<span data-ttu-id="b3458-186">Requisitos de espaço em disco</span><span class="sxs-lookup"><span data-stu-id="b3458-186">Disk Space Requirements</span></span>](#DiskSpace)  
  
-   [<span data-ttu-id="b3458-187">Instantâneos do banco de dados com grupos de arquivos offline</span><span class="sxs-lookup"><span data-stu-id="b3458-187">Database Snapshots with Offline Filegroups</span></span>](#OfflineFGs)  
  
###  <a name="prerequisites"></a><a name="Prerequisites"></a> <span data-ttu-id="b3458-188">Pré-requisitos</span><span class="sxs-lookup"><span data-stu-id="b3458-188">Prerequisites</span></span>  
 <span data-ttu-id="b3458-189">O banco de dados de origem, que pode usar qualquer modelo de recuperação, deve atender aos seguintes pré-requisitos:</span><span class="sxs-lookup"><span data-stu-id="b3458-189">The source database, which can use any recovery model, must meet the following prerequisites:</span></span>  
  
-   <span data-ttu-id="b3458-190">A instância de servidor deve estar sendo executada em uma edição do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] que oferece suporte a instantâneos de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="b3458-190">The server instance must be running on an edition of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] that supports database snapshots.</span></span> <span data-ttu-id="b3458-191">Para obter mais informações, consulte [recursos com suporte nas edições do SQL Server 2014](../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md).</span><span class="sxs-lookup"><span data-stu-id="b3458-191">For more information, see [Features Supported by the Editions of SQL Server 2014](../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md).</span></span>  
  
-   <span data-ttu-id="b3458-192">O banco de dados de origem precisa estar online, a menos que se trate de um banco de dados espelho dentro de uma sessão de espelhamento de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="b3458-192">The source database must be online, unless the database is a mirror database within a database mirroring session.</span></span>  
  
-   <span data-ttu-id="b3458-193">Você pode criar um instantâneo de banco de dados em qualquer banco de dados primário ou secundário em um grupo de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="b3458-193">You can create a database snapshot on any primary or secondary database in an availability group.</span></span> <span data-ttu-id="b3458-194">A função de réplica deve ser PRIMARY ou SECONDARY, em vez de estar no estado RESOLVING.</span><span class="sxs-lookup"><span data-stu-id="b3458-194">The replica role must be either PRIMARY or SECONDARY, not in the RESOLVING state.</span></span>  
  
     <span data-ttu-id="b3458-195">É recomendável que o estado de sincronização de banco de dados seja SYNCHRONIZING ou SYNCHRONIZED quando você criar um instantâneo de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="b3458-195">We recommend that the database synchronization state be SYNCHRONIZING or SYNCHRONIZED when you create a database snapshot.</span></span> <span data-ttu-id="b3458-196">No entanto, os instantâneos de banco de dados poderão ser criados quando o estado de sincronização de banco de dados for NOT SYNCHRONIZING.</span><span class="sxs-lookup"><span data-stu-id="b3458-196">However, database snapshots can be created when the database synchronization state is NOT SYNCHRONIZING.</span></span>  
  
     <span data-ttu-id="b3458-197">Para obter mais informações, confira [Instantâneos do banco de dados com grupos de disponibilidade AlwaysOn &#40;SQL Server&#41;](../../database-engine/availability-groups/windows/database-snapshots-with-always-on-availability-groups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="b3458-197">For more information, see [Database Snapshots with AlwaysOn Availability Groups &#40;SQL Server&#41;](../../database-engine/availability-groups/windows/database-snapshots-with-always-on-availability-groups-sql-server.md).</span></span>  
  
-   <span data-ttu-id="b3458-198">Para criar um instantâneo do banco de dados em um banco de dados espelho, o banco de dados precisa estar no estado de espelhamento SYNCHRONIZED.</span><span class="sxs-lookup"><span data-stu-id="b3458-198">To create a database snapshot on a mirror database, the database must be in the SYNCHRONIZED mirroring state.</span></span>  
  
-   <span data-ttu-id="b3458-199">O banco de dados de origem não pode ser configurado como banco de dados compartilhado escalonável.</span><span class="sxs-lookup"><span data-stu-id="b3458-199">The source database cannot be configured as a scalable shared database.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="b3458-200">Todo modelo de recuperação oferece suporte a instantâneos do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="b3458-200">All recovery models support database snapshots.</span></span>  
  
###  <a name="limitations-on-the-source-database"></a><a name="LimitsOnSourceDb"></a> <span data-ttu-id="b3458-201">Limitações do banco de dados de origem</span><span class="sxs-lookup"><span data-stu-id="b3458-201">Limitations on the Source Database</span></span>  
 <span data-ttu-id="b3458-202">Se houver um instantâneo do banco de dados, as seguintes limitações existirão no banco de dados de origem do instantâneo:</span><span class="sxs-lookup"><span data-stu-id="b3458-202">As long as a database snapshot exists, the following limitations exist on the snapshot's source database:</span></span>  
  
-   <span data-ttu-id="b3458-203">O banco de dados não pode ser eliminado, desanexado nem restaurado.</span><span class="sxs-lookup"><span data-stu-id="b3458-203">The database cannot be dropped, detached, or restored.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="b3458-204">O backup do banco de dados de origem funciona normalmente e não é afetado pelos instantâneos do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="b3458-204">Backing up the source database works normally; it is unaffected by database snapshots.</span></span>  
  
-   <span data-ttu-id="b3458-205">O desempenho é reduzido, em razão do aumento de E/S no banco de dados de origem, resultante de uma operação COW (copy-on-write), para o instantâneo, toda vez que uma página é atualizada.</span><span class="sxs-lookup"><span data-stu-id="b3458-205">Performance is reduced, due to increased I/O on the source database resulting from a copy-on-write operation to the snapshot every time a page is updated.</span></span>  
  
-   <span data-ttu-id="b3458-206">Os arquivos não podem ser eliminados do banco de dados de origem nem de nenhum instantâneo.</span><span class="sxs-lookup"><span data-stu-id="b3458-206">Files cannot be dropped from the source database or from any snapshots.</span></span>  
  
###  <a name="limitations-on-database-snapshots"></a><a name="LimitsOnDbSS"></a> <span data-ttu-id="b3458-207">Limitações em instantâneos do banco de dados</span><span class="sxs-lookup"><span data-stu-id="b3458-207">Limitations on Database Snapshots</span></span>  
 <span data-ttu-id="b3458-208">As limitações a seguir aplicam-se a instantâneos do banco de dados:</span><span class="sxs-lookup"><span data-stu-id="b3458-208">The following limitations apply to database snapshots:</span></span>  
  
-   <span data-ttu-id="b3458-209">É preciso criar um instantâneo do banco de dados, a ser mantido na mesma instância de servidor, como banco de dados de origem.</span><span class="sxs-lookup"><span data-stu-id="b3458-209">A database snapshot must be created and remain on the same server instance as the source database.</span></span>  
  
-   <span data-ttu-id="b3458-210">Instantâneos do banco de dados sempre funcionam em todo o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="b3458-210">Database snapshots always work on an entire database.</span></span>  
  
-   <span data-ttu-id="b3458-211">Os instantâneos de banco de dados são dependentes do banco de dados de origem e não são um armazenamento redundante.</span><span class="sxs-lookup"><span data-stu-id="b3458-211">Database snapshots are dependent on the source database and are not redundant storage.</span></span> <span data-ttu-id="b3458-212">Eles não oferecem proteção contra erros de disco ou outros tipos de danos.</span><span class="sxs-lookup"><span data-stu-id="b3458-212">They do not protect against disk errors or other types of corruption.</span></span> <span data-ttu-id="b3458-213">Portanto, o uso de instantâneos do banco de dados para reverter um banco de dados não é um substituto da estratégia de backup e restauração.</span><span class="sxs-lookup"><span data-stu-id="b3458-213">Therefore, using database snapshots for reverting a database is not a substitute for your backup and restore strategy.</span></span> <span data-ttu-id="b3458-214">A execução de todos os backups agendados continua essencial.</span><span class="sxs-lookup"><span data-stu-id="b3458-214">Performing all your scheduled backups remains essential.</span></span> <span data-ttu-id="b3458-215">Se for necessário restaurar o banco de dados de origem para o momento determinado em que o instantâneo foi criado, implemente uma política de backup que permita fazer isso.</span><span class="sxs-lookup"><span data-stu-id="b3458-215">If you must restore the source database to the point in time at which you created a database snapshot, implement a backup policy that enables you to do that.</span></span>  
  
-   <span data-ttu-id="b3458-216">Quando uma página que está sendo atualizada no banco de dados de origem é impulsionada para um instantâneo, caso o instantâneo fique sem espaço em disco suficiente ou encontre outro erro, ele se tornará suspeito e deverá ser excluído.</span><span class="sxs-lookup"><span data-stu-id="b3458-216">When a page getting updated on the source database is pushed to a snapshot, if the snapshot runs out of disk space or encounters some other error, the snapshot becomes suspect and must be deleted.</span></span>  
  
-   <span data-ttu-id="b3458-217">Os instantâneos são somente leitura.</span><span class="sxs-lookup"><span data-stu-id="b3458-217">Snapshots are read-only.</span></span> <span data-ttu-id="b3458-218">Como elas são somente de leitura, não podem ser atualizados.</span><span class="sxs-lookup"><span data-stu-id="b3458-218">Since they are read only, they cannot be upgraded.</span></span> <span data-ttu-id="b3458-219">Portanto, não se espera que os instantâneos de banco de dados sejam viáveis após uma atualização.</span><span class="sxs-lookup"><span data-stu-id="b3458-219">Therefore, database snapshots are not expected to be viable after an upgrade.</span></span>  
  
-   <span data-ttu-id="b3458-220">Instantâneos dos bancos de dados **modelo**, **mestre**e **tempdb** são proibidos.</span><span class="sxs-lookup"><span data-stu-id="b3458-220">Snapshots of the **model**, **master**, and **tempdb** databases are prohibited.</span></span>  
  
-   <span data-ttu-id="b3458-221">Você não pode alterar nenhuma das especificações dos arquivos de instantâneos do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="b3458-221">You cannot change any of the specifications of the database snapshot files.</span></span>  
  
-   <span data-ttu-id="b3458-222">Você não pode cancelar arquivos de um instantâneo do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="b3458-222">You cannot drop files from a database snapshot.</span></span>  
  
-   <span data-ttu-id="b3458-223">Você não pode fazer backup nem restaurar instantâneos do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="b3458-223">You cannot back up or restore database snapshots.</span></span>  
  
-   <span data-ttu-id="b3458-224">Você não pode anexar nem desanexar instantâneos do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="b3458-224">You cannot attach or detach database snapshots.</span></span>  
  
-   <span data-ttu-id="b3458-225">Você não pode criar instantâneos do banco de dados em sistema de arquivos FAT32 nem em partições RAW.</span><span class="sxs-lookup"><span data-stu-id="b3458-225">You cannot create database snapshots on FAT32 file system or RAW partitions.</span></span> <span data-ttu-id="b3458-226">Os arquivos esparsos usados por instantâneos do banco de dados são fornecidos pelo sistema de arquivos NTFS.</span><span class="sxs-lookup"><span data-stu-id="b3458-226">The sparse files used by database snapshots are provided by the NTFS file system.</span></span>  
  
-   <span data-ttu-id="b3458-227">A indexação de texto completo não tem suporte em instantâneos do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="b3458-227">Full-text indexing is not supported on database snapshots.</span></span> <span data-ttu-id="b3458-228">Os catálogos de texto completo não são propagados do banco de dados de origem.</span><span class="sxs-lookup"><span data-stu-id="b3458-228">Full-text catalogs are not propagated from the source database.</span></span>  
  
-   <span data-ttu-id="b3458-229">Um instantâneo do banco de dados herda as restrições de segurança de seu banco de dados de origem no momento da criação do instantâneo.</span><span class="sxs-lookup"><span data-stu-id="b3458-229">A database snapshot inherits the security constraints of its source database at the time of snapshot creation.</span></span> <span data-ttu-id="b3458-230">Como os instantâneos são somente leitura, as permissões herdadas não podem ser alteradas e as alterações feitas à origem não serão refletidas nos instantâneos existentes.</span><span class="sxs-lookup"><span data-stu-id="b3458-230">Because snapshots are read-only, inherited permissions cannot be changed and permission changes made to the source will not be reflected in existing snapshots.</span></span>  
  
-   <span data-ttu-id="b3458-231">Um instantâneo sempre reflete o estado dos grupos de arquivos no momento de sua criação: grupos de arquivos online permanecem online e grupos de arquivos offline permanecem offline.</span><span class="sxs-lookup"><span data-stu-id="b3458-231">A snapshot always reflects the state of filegroups at the time of snapshot creation: online filegroups remain online, and offline filegroups remain offline.</span></span> <span data-ttu-id="b3458-232">Para obter mais informações, consulte "Instantâneos do banco de dados com grupos de arquivos offline", posteriormente neste tópico.</span><span class="sxs-lookup"><span data-stu-id="b3458-232">For more information, see "Database Snapshots with Offline Filegroups" later in this topic.</span></span>  
  
-   <span data-ttu-id="b3458-233">Se um banco de dados de origem se tornar RECOVERY_PENDING, seus instantâneos do banco de dados podem se tornar inacessíveis.</span><span class="sxs-lookup"><span data-stu-id="b3458-233">If a source database becomes RECOVERY_PENDING, its database snapshots may become inaccessible.</span></span> <span data-ttu-id="b3458-234">Depois que o problema do banco de dados de origem for resolvido, porém, seus instantâneos deverão se tornar novamente disponíveis.</span><span class="sxs-lookup"><span data-stu-id="b3458-234">After the issue on the source database is resolved, however, its snapshots should become available again.</span></span>  
  
-   <span data-ttu-id="b3458-235">A reversão não tem suporte para grupos de arquivos somente leitura e para grupos de arquivos compactados.</span><span class="sxs-lookup"><span data-stu-id="b3458-235">Reverting is unsupported for read-only filegroups and for compressed filegroups.</span></span> <span data-ttu-id="b3458-236">As tentativas de reverter um banco de dados que contenha qualquer um desses tipos de grupos de arquivos falharão.</span><span class="sxs-lookup"><span data-stu-id="b3458-236">Attempts to revert a database containing either of these types of filegroups fail.</span></span>  
  
-   <span data-ttu-id="b3458-237">Em uma configuração de envio de logs, poderão ser criados instantâneos do banco de dados apenas no banco de dados primário, não em um banco de dados secundário.</span><span class="sxs-lookup"><span data-stu-id="b3458-237">In a log shipping configuration, database snapshots can be created only on the primary database, not on a secondary database.</span></span> <span data-ttu-id="b3458-238">Se as funções entre a instância do servidor primário e a instância do servidor secundário forem alternadas, será necessário cancelar todos os instantâneos antes de definir o banco de dados primário como o banco de dados secundário.</span><span class="sxs-lookup"><span data-stu-id="b3458-238">If you switch roles between the primary server instance and a secondary server instance, you must drop all the database snapshots before you can set the primary database up as a secondary database.</span></span>  
  
-   <span data-ttu-id="b3458-239">Um instantâneo do banco de dados não pode ser configurado como um banco de dados compartilhado escalonável.</span><span class="sxs-lookup"><span data-stu-id="b3458-239">A database snapshot cannot be configured as a scalable shared database.</span></span>  
  
-   <span data-ttu-id="b3458-240">Os grupos de arquivos FILESTREAM não são suportados pelos instantâneos do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="b3458-240">FILESTREAM filegroups are not supported by database snapshots.</span></span> <span data-ttu-id="b3458-241">Se houver grupos de arquivos FILESTREAM em um banco de dados de origem, eles serão marcados como offline nos instantâneos do banco de dados, e os instantâneos não poderão ser usados para reverter o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="b3458-241">If FILESTREAM filegroups exist in a source database, they are marked as offline in its database snapshots, and the database snapshots cannot be used for reverting the database.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="b3458-242">Uma instrução SELECT executada em um instantâneo de banco de dados não deve especificar uma coluna FILESTREAM. Caso contrário, a mensagem de erro a seguir será retornada: `Could not continue scan with NOLOCK due to data movement.`</span><span class="sxs-lookup"><span data-stu-id="b3458-242">A SELECT statement that is executed on a database snapshot must not specify a FILESTREAM column; otherwise, the following error message will be returned: `Could not continue scan with NOLOCK due to data movement.`</span></span>  
  
-   <span data-ttu-id="b3458-243">Quando estatísticas em um instantâneo somente leitura estão ausentes ou ficam obsoletas, o [!INCLUDE[ssDE](../../includes/ssde-md.md)] cria e mantém estatísticas temporárias em tempdb.</span><span class="sxs-lookup"><span data-stu-id="b3458-243">When statistics on a read-only snapshot are missing or stale, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] creates and maintains temporary statistics in tempdb.</span></span> <span data-ttu-id="b3458-244">Para obter mais informações, consulte [Estatísticas](../statistics/statistics.md).</span><span class="sxs-lookup"><span data-stu-id="b3458-244">For more information, see [Statistics](../statistics/statistics.md).</span></span>  
  
###  <a name="disk-space-requirements"></a><a name="DiskSpace"></a> <span data-ttu-id="b3458-245">Requisitos de espaço em disco</span><span class="sxs-lookup"><span data-stu-id="b3458-245">Disk Space Requirements</span></span>  
 <span data-ttu-id="b3458-246">Os instantâneos do banco de dados consomem espaço em disco.</span><span class="sxs-lookup"><span data-stu-id="b3458-246">Database snapshots consume disk space.</span></span> <span data-ttu-id="b3458-247">Se um instantâneo do banco de dados for executado sem espaço em disco suficiente, ficará marcado como suspeito e precisará ser cancelado.</span><span class="sxs-lookup"><span data-stu-id="b3458-247">If a database snapshot runs out of disk space, it is marked as suspect and must be dropped.</span></span> <span data-ttu-id="b3458-248">(O banco de dados de origem, porém, não é afetado; as suas ações prosseguem normalmente.) Em comparação com uma cópia completa de banco de dados, no entanto, os instantâneos são altamente eficazes em termos de espaço.</span><span class="sxs-lookup"><span data-stu-id="b3458-248">(The source database, however, is not affected; actions on it continue normally.) Compared to a full copy of a database, however, snapshots are highly space efficient.</span></span> <span data-ttu-id="b3458-249">Um instantâneo requer apenas armazenamento suficiente para as páginas alteradas no decorrer de seu tempo de vida.</span><span class="sxs-lookup"><span data-stu-id="b3458-249">A snapshot requires only enough storage for the pages that change during its lifetime.</span></span> <span data-ttu-id="b3458-250">Em geral, os instantâneos são mantidos por certo período, de modo que o tamanho deles não é a principal preocupação.</span><span class="sxs-lookup"><span data-stu-id="b3458-250">Generally, snapshots are kept for a limited time, so their size is not a major concern.</span></span>  
  
 <span data-ttu-id="b3458-251">Quanto mais tempo o instantâneo for mantido, mais provável se torna que ele venha a gastar espaço disponível.</span><span class="sxs-lookup"><span data-stu-id="b3458-251">The longer you keep a snapshot, however, the more likely it is to use up available space.</span></span> <span data-ttu-id="b3458-252">O tamanho máximo de crescimento de um arquivo esparso é o tamanho do arquivo de banco de dados de origem correspondente, no momento da criação do instantâneo.</span><span class="sxs-lookup"><span data-stu-id="b3458-252">The maximum size to which a sparse file can grow is the size of the corresponding source database file at the time of the snapshot creation.</span></span>  
  
 <span data-ttu-id="b3458-253">Se um instantâneo do banco de dados for executado sem espaço em disco suficiente, precisará ser excluído (cancelado).</span><span class="sxs-lookup"><span data-stu-id="b3458-253">If a database snapshot runs out of disk space, it must be deleted (dropped).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="b3458-254">Com exceção do espaço em arquivo, o instantâneo do banco de dados consome basicamente tanto recurso quanto o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="b3458-254">Except for file space, a database snapshot consumes roughly as many resources as a database.</span></span>  
  
###  <a name="database-snapshots-with-offline-filegroups"></a><a name="OfflineFGs"></a> <span data-ttu-id="b3458-255">Instantâneos do banco de dados com grupos de arquivos offline</span><span class="sxs-lookup"><span data-stu-id="b3458-255">Database Snapshots with Offline Filegroups</span></span>  
 <span data-ttu-id="b3458-256">Os grupos de arquivos offline no banco de dados de origem afetam os instantâneos do banco de dados quando se tenta realizar o seguinte:</span><span class="sxs-lookup"><span data-stu-id="b3458-256">Offline filegroups in the source database affect database snapshots when you try to do any of the following:</span></span>  
  
-   <span data-ttu-id="b3458-257">Criar um instantâneo</span><span class="sxs-lookup"><span data-stu-id="b3458-257">Create a snapshot</span></span>  
  
     <span data-ttu-id="b3458-258">Quando um banco de dados de origem possui um ou mais grupos de arquivos offline, a criação do instantâneo terá êxito nos grupos de arquivos offline.</span><span class="sxs-lookup"><span data-stu-id="b3458-258">When a source database has one or more offline filegroups, snapshot creation succeeds with the filegroups offline.</span></span> <span data-ttu-id="b3458-259">Os arquivos esparsos não são criados para grupos de arquivos offline.</span><span class="sxs-lookup"><span data-stu-id="b3458-259">Sparse files are not created for the offline filegroups.</span></span>  
  
-   <span data-ttu-id="b3458-260">Pegar um grupo de arquivos offline</span><span class="sxs-lookup"><span data-stu-id="b3458-260">Take a filegroup offline</span></span>  
  
     <span data-ttu-id="b3458-261">Você pode pegar um arquivo offline no banco de dados de origem.</span><span class="sxs-lookup"><span data-stu-id="b3458-261">You can take a file offline in the source database.</span></span> <span data-ttu-id="b3458-262">No entanto, o grupo de arquivos permanece online nos instantâneos do banco de dados se estava online no momento da criação do instantâneo.</span><span class="sxs-lookup"><span data-stu-id="b3458-262">However, the filegroup remains online in database snapshots if it was online when the snapshot was created.</span></span> <span data-ttu-id="b3458-263">Se os dados consultados tiverem sido alterados desde a criação do instantâneo, a página de dados original ficará acessível no instantâneo.</span><span class="sxs-lookup"><span data-stu-id="b3458-263">If the queried data has changed since snapshot creation, the original data page will be accessible in the snapshot.</span></span> <span data-ttu-id="b3458-264">Porém, as consultas que usam o instantâneo para acessar os dados não modificados no grupo de arquivos talvez falhem e apresentem erros de E/S (entrada/saída).</span><span class="sxs-lookup"><span data-stu-id="b3458-264">However, queries that use the snapshot to access unmodified data in the filegroup are likely to fail with input/output (I/O) errors.</span></span>  
  
-   <span data-ttu-id="b3458-265">Colocar um grupo de arquivos online</span><span class="sxs-lookup"><span data-stu-id="b3458-265">Bring a filegroup online</span></span>  
  
     <span data-ttu-id="b3458-266">Você não pode colocar um grupo de arquivos online em um banco de dados que tenha instantâneos do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="b3458-266">You cannot bring a filegroup online in a database that has any database snapshots.</span></span> <span data-ttu-id="b3458-267">Se um grupo de arquivos estiver offline no momento da criação do instantâneo, ou se for colocado offline quando existir um instantâneo do banco de dados, o grupo de arquivos permanecerá offline.</span><span class="sxs-lookup"><span data-stu-id="b3458-267">If a filegroup is offline at the time of snapshot creation or is taken offline while a database snapshot exists, the filegroup remains offline.</span></span> <span data-ttu-id="b3458-268">Isto ocorre porque colocar um arquivo de novo online envolve sua restauração, o que não é possível se houver um instantâneo do banco de dados no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="b3458-268">This is because bringing a file back online involves restoring it, which is not possible if a database snapshot exists on the database.</span></span>  
  
-   <span data-ttu-id="b3458-269">Reverter o banco de dados de origem a um instantâneo</span><span class="sxs-lookup"><span data-stu-id="b3458-269">Revert the source database to the snapshot</span></span>  
  
     <span data-ttu-id="b3458-270">Reverter um banco de dados de origem em um instantâneo do banco de dados requer que todos os grupos de arquivos fiquem online, com exceção de grupos de arquivos que estavam offline quando o instantâneo foi criado.</span><span class="sxs-lookup"><span data-stu-id="b3458-270">Reverting a source database to a database snapshot requires that all of the filegroups are online except for filegroups that were offline when the snapshot was created.</span></span>  
  
##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="b3458-271">Tarefas relacionadas</span><span class="sxs-lookup"><span data-stu-id="b3458-271">Related Tasks</span></span>  
  
-   [<span data-ttu-id="b3458-272">Criar um instantâneo de banco de dados &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="b3458-272">Create a Database Snapshot &#40;Transact-SQL&#41;</span></span>](create-a-database-snapshot-transact-sql.md)  
  
-   [<span data-ttu-id="b3458-273">Exibir um instantâneo de banco de dados &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="b3458-273">View a Database Snapshot &#40;SQL Server&#41;</span></span>](view-a-database-snapshot-sql-server.md)  
  
-   [<span data-ttu-id="b3458-274">Exibir o tamanho do arquivo esparso de um instantâneo de banco de dados &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="b3458-274">View the Size of the Sparse File of a Database Snapshot &#40;Transact-SQL&#41;</span></span>](view-the-size-of-the-sparse-file-of-a-database-snapshot-transact-sql.md)  
  
-   [<span data-ttu-id="b3458-275">Reverter um banco de dados para um instantâneo do banco de dados</span><span class="sxs-lookup"><span data-stu-id="b3458-275">Revert a Database to a Database Snapshot</span></span>](revert-a-database-to-a-database-snapshot.md)  
  
-   [<span data-ttu-id="b3458-276">Remover um instantâneo do banco de dados &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="b3458-276">Drop a Database Snapshot &#40;Transact-SQL&#41;</span></span>](drop-a-database-snapshot-transact-sql.md)  
  
## <a name="see-also"></a><span data-ttu-id="b3458-277">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="b3458-277">See Also</span></span>  
 [<span data-ttu-id="b3458-278">Espelhamento de banco de dados e instantâneos de banco de dados &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="b3458-278">Database Mirroring and Database Snapshots &#40;SQL Server&#41;</span></span>](database-snapshots-sql-server.md)  
  
  
