---
title: Anexar e desanexar bancos de dados (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: backup-restore
ms.topic: conceptual
helpviewer_keywords:
- upgrading databases
- databases [SQL Server], detaching
- detach database [SQL Server]
- databases [SQL Server], attaching
- removing databases
- transaction logs [SQL Server], detaching
- databases [SQL Server], removing
- restoring [SQL Server], attached databases
- transaction logs [SQL Server], attaching
- differential backups, after detaching
- moving databases
- attach database [SQL Server]
- detaching databases [SQL Server]
- differential base [SQL Server]
- attaching databases [SQL Server]
- databases [SQL Server], moving
ms.assetid: d0de0639-bc54-464e-98b1-6af22a27eb86
author: stevestein
ms.author: sstein
ms.openlocfilehash: 54eeeec995e390b71ce8871b680c26138fc88783
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87573120"
---
# <a name="database-detach-and-attach-sql-server"></a><span data-ttu-id="e9b32-102">Anexar e desanexar bancos de dados (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="e9b32-102">Database Detach and Attach (SQL Server)</span></span>
  <span data-ttu-id="e9b32-103">Os dados e os arquivos de log de transações de um banco de dados podem ser desanexados e, em seguida, reanexados à mesma ou a outra instância do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e9b32-103">The data and transaction log files of a database can be detached and then reattached to the same or another instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="e9b32-104">Desanexar e anexar um banco de dados é útil se você deseja alterar o banco de dados a uma instância diferente do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] no mesmo computador ou mover o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e9b32-104">Detaching and attaching a database is useful if you want to change the database to a different instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] on the same computer or to move the database.</span></span>  
  
 <span data-ttu-id="e9b32-105">O formato de armazenamento do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] em disco é o mesmo nos ambientes de 64 bits e 32 bits.</span><span class="sxs-lookup"><span data-stu-id="e9b32-105">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] on-disk storage format is the same in the 64-bit and 32-bit environments.</span></span> <span data-ttu-id="e9b32-106">Portanto, você pode anexar trabalhos em ambientes de 32 bits e de 64 bits.</span><span class="sxs-lookup"><span data-stu-id="e9b32-106">Therefore, attach works across 32-bit and 64-bit environments.</span></span>  <span data-ttu-id="e9b32-107">Um banco de dados desanexado de uma instância de servidor que é executada em um único ambiente pode ser anexado em uma instância de servidor que é executada em outro ambiente.</span><span class="sxs-lookup"><span data-stu-id="e9b32-107">A database detached from a server instance running in one environment can be attached on a server instance that runs in another environment.</span></span>  
  
  
  
##  <a name="security"></a><a name="Security"></a> <span data-ttu-id="e9b32-108">Segurança</span><span class="sxs-lookup"><span data-stu-id="e9b32-108">Security</span></span>  
 <span data-ttu-id="e9b32-109">As permissões de acesso ao arquivo são definidas durante algumas operações de banco de dados, inclusive desanexar ou anexar um banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e9b32-109">File access permissions are set during a number of database operations, including detaching or attaching a database.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="e9b32-110">Não é recomendável anexar ou restaurar bancos de dados de origem desconhecida ou não confiável.</span><span class="sxs-lookup"><span data-stu-id="e9b32-110">We recommend that you do not attach or restore databases from unknown or untrusted sources.</span></span> <span data-ttu-id="e9b32-111">Esses bancos de dados podem conter um código mal-intencionado que pode executar um código [!INCLUDE[tsql](../../includes/tsql-md.md)] inesperado ou provocar erros modificando o esquema ou a estrutura física do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e9b32-111">Such databases could contain malicious code that might execute unintended [!INCLUDE[tsql](../../includes/tsql-md.md)] code or cause errors by modifying the schema or the physical database structure.</span></span> <span data-ttu-id="e9b32-112">Antes de usar um banco de dados de origem desconhecida ou não confiável, execute [DBCC CHECKDB](/sql/t-sql/database-console-commands/dbcc-checkdb-transact-sql) no banco de dados, em um servidor que não seja de produção. Além disso, examine o código, como procedimentos armazenados ou outro código definido pelo usuário, no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e9b32-112">Before you use a database from an unknown or untrusted source, run [DBCC CHECKDB](/sql/t-sql/database-console-commands/dbcc-checkdb-transact-sql) on the database on a nonproduction server and also examine the code, such as stored procedures or other user-defined code, in the database.</span></span>  
  
##  <a name="detaching-a-database"></a><a name="DetachDb"></a> <span data-ttu-id="e9b32-113">Desanexando um banco de dados</span><span class="sxs-lookup"><span data-stu-id="e9b32-113">Detaching a Database</span></span>  
 <span data-ttu-id="e9b32-114">Desanexar um banco de dados remove-o da instância do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , mas deixa intacto o banco de dados, com seus arquivos de dados e arquivos de log de transações.</span><span class="sxs-lookup"><span data-stu-id="e9b32-114">Detaching a database removes it from the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] but leaves the database intact within its data files and transaction log files.</span></span> <span data-ttu-id="e9b32-115">Esses arquivos podem então ser usados para anexar o banco de dados a qualquer instância do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], inclusive o servidor do qual o banco de dados foi desanexado.</span><span class="sxs-lookup"><span data-stu-id="e9b32-115">These files can then be used to attach the database to any instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], including the server from which the database was detached.</span></span>  
  
 <span data-ttu-id="e9b32-116">Você não poderá desanexar um banco de dados se alguma das seguintes opções for verdadeira:</span><span class="sxs-lookup"><span data-stu-id="e9b32-116">You cannot detach a database if any of the following are true:</span></span>  
  
-   <span data-ttu-id="e9b32-117">O banco de dados está replicado e publicado.</span><span class="sxs-lookup"><span data-stu-id="e9b32-117">The database is replicated and published.</span></span> <span data-ttu-id="e9b32-118">Se replicado, o banco de dados não pode estar publicado.</span><span class="sxs-lookup"><span data-stu-id="e9b32-118">If replicated, the database must be unpublished.</span></span> <span data-ttu-id="e9b32-119">Antes de poder desanexá-lo, é necessário desabilitar a publicação executando [sp_replicationdboption](/sql/relational-databases/system-stored-procedures/sp-replicationdboption-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="e9b32-119">Before you can detach it, you must disable publishing by running [sp_replicationdboption](/sql/relational-databases/system-stored-procedures/sp-replicationdboption-transact-sql).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="e9b32-120">Se não for possível usar **sp_replicationdboption**, você poderá remover a replicação executando [sp_removedbreplication](/sql/relational-databases/system-stored-procedures/sp-removedbreplication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="e9b32-120">If you cannot use **sp_replicationdboption**, you can remove replication by running [sp_removedbreplication](/sql/relational-databases/system-stored-procedures/sp-removedbreplication-transact-sql).</span></span>  
  
-   <span data-ttu-id="e9b32-121">Há um instantâneo do banco de dados no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e9b32-121">A database snapshot exists on the database.</span></span>  
  
     <span data-ttu-id="e9b32-122">Antes de poder desanexar o banco de dados, você deve descartar todos os seus instantâneos.</span><span class="sxs-lookup"><span data-stu-id="e9b32-122">Before you can detach the database, you must drop all of its snapshots.</span></span> <span data-ttu-id="e9b32-123">Para obter mais informações, veja [Remover um instantâneo do banco de dados &#40;Transact-SQL&#41;](drop-a-database-snapshot-transact-sql.md).</span><span class="sxs-lookup"><span data-stu-id="e9b32-123">For more information, see [Drop a Database Snapshot &#40;Transact-SQL&#41;](drop-a-database-snapshot-transact-sql.md).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="e9b32-124">Um instantâneo do banco de dados não pode ser desanexado ou anexado.</span><span class="sxs-lookup"><span data-stu-id="e9b32-124">A database snapshot cannot be detached or attached.</span></span>  
  
-   <span data-ttu-id="e9b32-125">O banco de dados está sendo espelhado em uma sessão de espelhamento de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e9b32-125">The database is being mirrored in a database mirroring session.</span></span>  
  
     <span data-ttu-id="e9b32-126">O banco de dados não pode ser desanexado, a menos que a sessão seja encerrada.</span><span class="sxs-lookup"><span data-stu-id="e9b32-126">The database cannot be detached unless the session is terminated.</span></span> <span data-ttu-id="e9b32-127">Para obter mais informações, veja [Removendo o espelhamento de banco de dados &#40;SQL Server&#41;](../../database-engine/database-mirroring/database-mirroring-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="e9b32-127">For more information, see [Removing Database Mirroring &#40;SQL Server&#41;](../../database-engine/database-mirroring/database-mirroring-sql-server.md).</span></span>  
  
-   <span data-ttu-id="e9b32-128">O banco de dados é suspeito.</span><span class="sxs-lookup"><span data-stu-id="e9b32-128">The database is suspect.</span></span> <span data-ttu-id="e9b32-129">Um banco de dados suspeito não pode ser desanexado. Para poder desanexá-lo, você deve colocá-lo em modo de emergência.</span><span class="sxs-lookup"><span data-stu-id="e9b32-129">A suspect database cannot be detached; before you can detach it, you must put it into emergency mode.</span></span> <span data-ttu-id="e9b32-130">Para obter mais informações sobre como colocar um banco de dados em modo de emergência, veja [ALTER DATABASE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="e9b32-130">For more information about how to put a database into emergency mode, see [ALTER DATABASE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql).</span></span>  
  
-   <span data-ttu-id="e9b32-131">O banco de dados é um banco de dados de sistema.</span><span class="sxs-lookup"><span data-stu-id="e9b32-131">The database is a system database.</span></span>  
  
### <a name="backup-and-restore-and-detach"></a><span data-ttu-id="e9b32-132">Backup e restauração e desanexação</span><span class="sxs-lookup"><span data-stu-id="e9b32-132">Backup and Restore and Detach</span></span>  
 <span data-ttu-id="e9b32-133">A desanexação de um banco de dados somente leitura perde informações sobre as bases diferenciais de backups diferenciais.</span><span class="sxs-lookup"><span data-stu-id="e9b32-133">Detaching a read-only database loses information about the differential bases of differential backups.</span></span> <span data-ttu-id="e9b32-134">Para obter mais informações, veja [Backups diferenciais &#40;SQL Server&#41;](../backup-restore/differential-backups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="e9b32-134">For more information, see [Differential Backups &#40;SQL Server&#41;](../backup-restore/differential-backups-sql-server.md).</span></span>  
  
### <a name="responding-to-detach-errors"></a><span data-ttu-id="e9b32-135">Respondendo a erros de desanexação</span><span class="sxs-lookup"><span data-stu-id="e9b32-135">Responding to Detach Errors</span></span>  
 <span data-ttu-id="e9b32-136">Os erros produzidos ao desanexar um banco de dados podem impedir que o banco de dados seja desligado corretamente e que o log de transações seja reconstruído.</span><span class="sxs-lookup"><span data-stu-id="e9b32-136">Errors produced while detaching a database can prevent the database from closing cleanly and the transaction log from being rebuilt.</span></span> <span data-ttu-id="e9b32-137">Se você receber uma mensagem de erro, execute as ações corretivas a seguir:</span><span class="sxs-lookup"><span data-stu-id="e9b32-137">If you receive an error message, perform the following corrective actions:</span></span>  
  
1.  <span data-ttu-id="e9b32-138">Reanexe todos os arquivos associados ao banco de dados, e não apenas o arquivo primário.</span><span class="sxs-lookup"><span data-stu-id="e9b32-138">Reattach all files associated with the database, not just the primary file.</span></span>  
  
2.  <span data-ttu-id="e9b32-139">Resolva o problema que causou a mensagem de erro.</span><span class="sxs-lookup"><span data-stu-id="e9b32-139">Resolve the problem that caused the error message.</span></span>  
  
3.  <span data-ttu-id="e9b32-140">Desanexe o banco de dados novamente.</span><span class="sxs-lookup"><span data-stu-id="e9b32-140">Detach the database again.</span></span>  
  
##  <a name="attaching-a-database"></a><a name="AttachDb"></a> <span data-ttu-id="e9b32-141">Anexando um banco de dados</span><span class="sxs-lookup"><span data-stu-id="e9b32-141">Attaching a Database</span></span>  
 <span data-ttu-id="e9b32-142">Você pode anexar um banco de dados do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] copiado ou desanexado.</span><span class="sxs-lookup"><span data-stu-id="e9b32-142">You can attach a copied or detached [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database.</span></span> <span data-ttu-id="e9b32-143">Quando você anexa uma [!INCLUDE[ssVersion2005](../../includes/sscurrent-md.md)] instância de servidor, os arquivos de catálogo são anexados de seu local anterior junto com os outros arquivos de banco de dados, o mesmo que em [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="e9b32-143">When you attach a [!INCLUDE[ssVersion2005](../../includes/sscurrent-md.md)] server instance, the catalog files are attached from their previous location along with the other database files, the same as in [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)].</span></span> <span data-ttu-id="e9b32-144">Para obter mais informações, veja [Atualizar pesquisa de texto completo](../search/upgrade-full-text-search.md).</span><span class="sxs-lookup"><span data-stu-id="e9b32-144">For more information, see [Upgrade Full-Text Search](../search/upgrade-full-text-search.md).</span></span>  
  
 <span data-ttu-id="e9b32-145">Quando você anexa um banco de dados, todos os arquivos de dados (arquivos MDF e NDF) devem estar disponíveis.</span><span class="sxs-lookup"><span data-stu-id="e9b32-145">When you attach a database, all data files (MDF and NDF files) must be available.</span></span> <span data-ttu-id="e9b32-146">Se algum arquivo de dados tiver um caminho diferente de quando o banco de dados foi inicialmente criado ou anexado pela última vez, você deverá especificar o caminho atual do arquivo.</span><span class="sxs-lookup"><span data-stu-id="e9b32-146">If any data file has a different path from when the database was first created or last attached, you must specify the current path of the file.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e9b32-147">Se o arquivo de dados primário que está sendo anexado for somente leitura, o [!INCLUDE[ssDE](../../includes/ssde-md.md)] presumirá que o banco de dados é somente leitura.</span><span class="sxs-lookup"><span data-stu-id="e9b32-147">If the primary data file being attached is read-only, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] assumes that the database is read-only.</span></span>  
  
 <span data-ttu-id="e9b32-148">Quando um banco de dados criptografado é anexado pela primeira vez a uma instância do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , o proprietário do banco de dados deve abrir a chave mestra do banco de dados executando a seguinte instrução: abrir a DEScriptografia da chave mestra por senha = **' *`password`* '**.</span><span class="sxs-lookup"><span data-stu-id="e9b32-148">When an encrypted database is first attached to an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], the database owner must open the master key of the database by executing the following statement: OPEN MASTER KEY DECRYPTION BY PASSWORD = **'*`password`*'**.</span></span> <span data-ttu-id="e9b32-149">Recomendamos habilitar a descriptografia automática da chave mestra executando a instrução seguinte: ALTER MASTER KEY ADD ENCRYPTION BY SERVICE MASTER KEY.</span><span class="sxs-lookup"><span data-stu-id="e9b32-149">We recommend that you enable automatic decryption of the master key by executing the following statement: ALTER MASTER KEY ADD ENCRYPTION BY SERVICE MASTER KEY.</span></span> <span data-ttu-id="e9b32-150">Para obter mais informações, veja [CREATE MASTER KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-master-key-transact-sql) e [ALTER MASTER KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-master-key-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="e9b32-150">For more information, see [CREATE MASTER KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-master-key-transact-sql) and [ALTER MASTER KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-master-key-transact-sql).</span></span>  
  
 <span data-ttu-id="e9b32-151">O requisito para anexar arquivos de log depende, em parte, de o banco de dados ser de leitura e gravação ou apenas leitura:</span><span class="sxs-lookup"><span data-stu-id="e9b32-151">The requirement for attaching log files depends partly on whether the database is read-write or read-only, as follows:</span></span>  
  
-   <span data-ttu-id="e9b32-152">Para um banco de dados de leitura e gravação, você pode geralmente anexar um arquivo de log em um novo local.</span><span class="sxs-lookup"><span data-stu-id="e9b32-152">For a read-write database, you can usually attach a log file in a new location.</span></span> <span data-ttu-id="e9b32-153">No entanto, em alguns casos, a reanexação de um banco de dados exige seus arquivos de log existentes.</span><span class="sxs-lookup"><span data-stu-id="e9b32-153">However, in some cases, reattaching a database requires its existing log files.</span></span> <span data-ttu-id="e9b32-154">Portanto, é importante sempre conservar todos os arquivos de log desanexados, até que o banco de dados tenha sido anexado com êxito sem eles.</span><span class="sxs-lookup"><span data-stu-id="e9b32-154">Therefore, it is important to always keep all the detached log files until the database has been successfully attached without them.</span></span>  
  
     <span data-ttu-id="e9b32-155">Se um banco de dados de leitura e gravação tiver um único arquivo de log e você não especificar um novo local para o arquivo de log, a operação de anexação procurará o arquivo no local antigo.</span><span class="sxs-lookup"><span data-stu-id="e9b32-155">If a read-write database has a single log file and you do not specify a new location for the log file, the attach operation looks in the old location for the file.</span></span> <span data-ttu-id="e9b32-156">Se for achado, o arquivo de log antigo será usado, independentemente de o banco de dados ter sido desligado corretamente.</span><span class="sxs-lookup"><span data-stu-id="e9b32-156">If it is found, the old log file is used, regardless of whether the database was shut down cleanly.</span></span> <span data-ttu-id="e9b32-157">No entanto, se o arquivo de log antigo não for encontrado e se o banco de dados tiver sido desligado corretamente e não tiver nenhuma cadeia de logs ativa, a operação de anexação tentará criar um novo arquivo de log para o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e9b32-157">However, if the old log file is not found and if the database was shut down cleanly and has no active log chain, the attach operation attempts to build a new log file for the database.</span></span>  
  
-   <span data-ttu-id="e9b32-158">Se o arquivo de dados primário que está sendo anexado for somente leitura, o [!INCLUDE[ssDE](../../includes/ssnoversion-md.md)] não poderá atualizar o local do log armazenado no arquivo primário.</span><span class="sxs-lookup"><span data-stu-id="e9b32-158">If the primary data file being attached is read-only, the [!INCLUDE[ssDE](../../includes/ssnoversion-md.md)] cannot update the log location stored in the primary file.</span></span>  
  
  
  
###  <a name="metadata-changes-on-attaching-a-database"></a><a name="Metadata"></a> <span data-ttu-id="e9b32-159">Alterações de metadados na anexação de um banco de dados</span><span class="sxs-lookup"><span data-stu-id="e9b32-159">Metadata Changes on Attaching a Database</span></span>  
 <span data-ttu-id="e9b32-160">Quando um banco de dados somente leitura é desanexado e reanexado, as informações de backup sobre a base diferencial atual são perdidas.</span><span class="sxs-lookup"><span data-stu-id="e9b32-160">When a read-only database is detached and then reattached, the backup information about the current differential base is lost.</span></span> <span data-ttu-id="e9b32-161">A *base diferencial* é o backup completo mais recente de todos os dados no banco de dados ou em um subconjunto dos arquivos ou de grupos de arquivos do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e9b32-161">The *differential base* is the most recent full backup of all the data in the database or in a subset of the files or filegroups of the database.</span></span> <span data-ttu-id="e9b32-162">Sem a informações de backup de base, o banco de dados **master** se torna não sincronizado com o banco de dados somente leitura, portanto backups diferenciais utilizados posteriormente podem fornecer resultados inesperados.</span><span class="sxs-lookup"><span data-stu-id="e9b32-162">Without the base-backup information, the **master** database becomes unsynchronized with the read-only database, so differential backups taken thereafter may provide unexpected results.</span></span> <span data-ttu-id="e9b32-163">Portanto, se você estiver usando backups diferenciais com um banco de dados somente leitura, deverá estabelecer uma nova base diferencial obtendo um backup completo após reanexar o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e9b32-163">Therefore, if you are using differential backups with a read-only database, you should establish a new differential base by taking a full backup after you reattach the database.</span></span> <span data-ttu-id="e9b32-164">Para obter informações sobre backups diferenciais, veja [Backups diferenciais &#40;SQL Server&#41;](../backup-restore/differential-backups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="e9b32-164">For information about differential backups, see [Differential Backups &#40;SQL Server&#41;](../backup-restore/differential-backups-sql-server.md).</span></span>  
  
 <span data-ttu-id="e9b32-165">Na anexação, ocorre inicialização do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e9b32-165">On attach, database startup occurs.</span></span> <span data-ttu-id="e9b32-166">Geralmente, a anexação de um banco de dados coloca-o no mesmo estado em que estava quando foi desanexado ou copiado.</span><span class="sxs-lookup"><span data-stu-id="e9b32-166">Generally, attaching a database places it in the same state that it was in when it was detached or copied.</span></span> <span data-ttu-id="e9b32-167">No entanto, as operações de anexação e desanexação desabilitam o encadeamento de propriedades de bancos de dados para o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e9b32-167">However, attach-and-detach operations both disable cross-database ownership chaining for the database.</span></span> <span data-ttu-id="e9b32-168">Para obter informações sobre como habilitar o encadeamento, veja [Opção cross db ownership chaining de configuração de servidor](../../database-engine/configure-windows/cross-db-ownership-chaining-server-configuration-option.md).</span><span class="sxs-lookup"><span data-stu-id="e9b32-168">For information about how to enable chaining, see [cross db ownership chaining Server Configuration Option](../../database-engine/configure-windows/cross-db-ownership-chaining-server-configuration-option.md).</span></span> <span data-ttu-id="e9b32-169">Além disso, TRUSTWORTHY é definido como OFF sempre que o banco de dados for anexado.</span><span class="sxs-lookup"><span data-stu-id="e9b32-169">Also, TRUSTWORTHY is set to OFF whenever the database is attached.</span></span> <span data-ttu-id="e9b32-170">Para obter informações sobre como definir TRUSTWORTHY como ON, veja [ALTER DATABASE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="e9b32-170">For information about how to set TRUSTWORTHY to ON, see [ALTER DATABASE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql).</span></span>  
  
### <a name="backup-and-restore-and-attach"></a><span data-ttu-id="e9b32-171">Backup e restauração e anexação</span><span class="sxs-lookup"><span data-stu-id="e9b32-171">Backup and Restore and Attach</span></span>  
 <span data-ttu-id="e9b32-172">Como qualquer banco de dados que esteja offline total ou parcialmente, um banco de dados com arquivos de restauração não pode ser anexado.</span><span class="sxs-lookup"><span data-stu-id="e9b32-172">Like any database that is fully or partially offline, a database with restoring files cannot be attached.</span></span> <span data-ttu-id="e9b32-173">Se você interromper a sequência de restauração, poderá anexar o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e9b32-173">If you stop the restore sequence, you can attach the database.</span></span> <span data-ttu-id="e9b32-174">Em seguida, você poderá reiniciar a sequência de restauração.</span><span class="sxs-lookup"><span data-stu-id="e9b32-174">Then, you can restart the restore sequence.</span></span>  
  
###  <a name="attaching-a-database-to-another-server-instance"></a><a name="OtherServerInstance"></a> <span data-ttu-id="e9b32-175">Anexando um banco de dados a outra instância do servidor</span><span class="sxs-lookup"><span data-stu-id="e9b32-175">Attaching a Database to Another Server Instance</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="e9b32-176">Um banco de dados criado por uma versão mais recente do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] não pode ser anexado em versões anteriores.</span><span class="sxs-lookup"><span data-stu-id="e9b32-176">A database created by a more recent version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] cannot be attached in earlier versions.</span></span>  
  
 <span data-ttu-id="e9b32-177">Quando você anexa um banco de dados a outra instância do servidor, para oferecer uma experiência consistente aos usuários e aplicativos, talvez precise recriar alguns ou todos os metadados para o banco de dados, como logons e trabalhos, na outra instância de servidor.</span><span class="sxs-lookup"><span data-stu-id="e9b32-177">When you attach a database onto another server instance, to provide a consistent experience to users and applications, you might have to re-create some or all of the metadata for the database, such as logins and jobs, on the other server instance.</span></span> <span data-ttu-id="e9b32-178">Para obter mais informações, consulte [Gerenciar metadados ao disponibilizar um banco de dados em outra instância do servidor &#40;SQL Server&#41;](manage-metadata-when-making-a-database-available-on-another-server.md).</span><span class="sxs-lookup"><span data-stu-id="e9b32-178">For more information, see [Manage Metadata When Making a Database Available on Another Server Instance &#40;SQL Server&#41;](manage-metadata-when-making-a-database-available-on-another-server.md).</span></span>  
  
##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="e9b32-179">Tarefas relacionadas</span><span class="sxs-lookup"><span data-stu-id="e9b32-179">Related Tasks</span></span>  
 <span data-ttu-id="e9b32-180">**Para desanexar um banco de dados**</span><span class="sxs-lookup"><span data-stu-id="e9b32-180">**To detach a database**</span></span>  
  
-   [<span data-ttu-id="e9b32-181">sp_detach_db &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="e9b32-181">sp_detach_db &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-detach-db-transact-sql)  
  
-   [<span data-ttu-id="e9b32-182">Desanexar um banco de dados</span><span class="sxs-lookup"><span data-stu-id="e9b32-182">Detach a Database</span></span>](detach-a-database.md)  
  
 <span data-ttu-id="e9b32-183">**Para anexar um banco de dados**</span><span class="sxs-lookup"><span data-stu-id="e9b32-183">**To attach a database**</span></span>  
  
-   [<span data-ttu-id="e9b32-184">CREATE DATABASE &#40;SQL Server Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="e9b32-184">CREATE DATABASE &#40;SQL Server Transact-SQL&#41;</span></span>](/sql/t-sql/statements/create-database-sql-server-transact-sql)  
  
-   [<span data-ttu-id="e9b32-185">Anexar um banco de dados</span><span class="sxs-lookup"><span data-stu-id="e9b32-185">Attach a Database</span></span>](attach-a-database.md)  
  
-   [<span data-ttu-id="e9b32-186">sp_attach_db &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="e9b32-186">sp_attach_db &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-attach-db-transact-sql)  
  
-   [<span data-ttu-id="e9b32-187">sp_attach_single_file_db &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="e9b32-187">sp_attach_single_file_db &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-attach-single-file-db-transact-sql)  
  
 <span data-ttu-id="e9b32-188">**Para atualizar um banco de dados usando as operações de anexação e desanexação**</span><span class="sxs-lookup"><span data-stu-id="e9b32-188">**To upgrade a database using detach and attach operations**</span></span>  
  
-   [<span data-ttu-id="e9b32-189">Atualizar um banco de dados usando Desanexar e Anexar &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="e9b32-189">Upgrade a Database Using Detach and Attach &#40;Transact-SQL&#41;</span></span>](upgrade-a-database-using-detach-and-attach-transact-sql.md)  
  
 <span data-ttu-id="e9b32-190">**Para mover um banco de dados usando as operações de anexação e desanexação**</span><span class="sxs-lookup"><span data-stu-id="e9b32-190">**To move a database using detach and attach operations**</span></span>  
  
-   [<span data-ttu-id="e9b32-191">Mover um banco de dados usando Desanexar e Anexar &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="e9b32-191">Move a Database Using Detach and Attach &#40;Transact-SQL&#41;</span></span>](move-a-database-using-detach-and-attach-transact-sql.md)  
  
 <span data-ttu-id="e9b32-192">**Para excluir um instantâneo do banco de dados**</span><span class="sxs-lookup"><span data-stu-id="e9b32-192">**To delete a database snapshot**</span></span>  
  
-   [<span data-ttu-id="e9b32-193">Remover um instantâneo do banco de dados &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="e9b32-193">Drop a Database Snapshot &#40;Transact-SQL&#41;</span></span>](drop-a-database-snapshot-transact-sql.md)  
  
## <a name="see-also"></a><span data-ttu-id="e9b32-194">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="e9b32-194">See Also</span></span>  
 [<span data-ttu-id="e9b32-195">Arquivos e grupos de arquivos do banco de dados</span><span class="sxs-lookup"><span data-stu-id="e9b32-195">Database Files and Filegroups</span></span>](database-files-and-filegroups.md)  
  
  
