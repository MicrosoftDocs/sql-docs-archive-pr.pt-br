---
title: Trabalhando com o provedor WMI para eventos de servidor | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: wmi
ms.topic: reference
helpviewer_keywords:
- event notifications [WMI]
- permissions [WMI]
- connection strings [WMI]
- security [WMI]
- Service Broker [WMI]
- WMI Provider for Server Events, connection strings
- WMI Provider for Server Events, Service Broker
- notifications [WMI]
- WMI Provider for Server Events, security
ms.assetid: cd974b3b-2309-4a20-b9be-7cfc93fc4389
author: CarlRabeler
ms.author: carlrab
ms.openlocfilehash: 79ee9c4402971807263284d10e31db702abeee86
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87679749"
---
# <a name="working-with-the-wmi-provider-for-server-events"></a><span data-ttu-id="b76f2-102">Trabalhando com o Provedor WMI para Eventos de Servidor</span><span class="sxs-lookup"><span data-stu-id="b76f2-102">Working with the WMI Provider for Server Events</span></span>
  <span data-ttu-id="b76f2-103">Este tópico fornece diretrizes que você deve considerar antes de programar o uso do Provedor WMI para Eventos de Servidor.</span><span class="sxs-lookup"><span data-stu-id="b76f2-103">This topic provides guidelines you should consider before you program using the WMI Provider for Server Events.</span></span>  
  
## <a name="enabling-service-broker"></a><span data-ttu-id="b76f2-104">Habilitando o Service Broker</span><span class="sxs-lookup"><span data-stu-id="b76f2-104">Enabling Service Broker</span></span>  
 <span data-ttu-id="b76f2-105">O Provedor WMI para Eventos de Servidor funciona traduzindo consultas WQL de eventos para notificações de eventos no banco de dados de destino.</span><span class="sxs-lookup"><span data-stu-id="b76f2-105">The WMI Provider for Server Events works by translating WQL queries for events into event notifications in the database that you target.</span></span> <span data-ttu-id="b76f2-106">Um entendimento de como funcionam as notificações de eventos pode ser útil ao programar com base no provedor.</span><span class="sxs-lookup"><span data-stu-id="b76f2-106">An understanding of how event notifications work can be useful to you when programming against the provider.</span></span> <span data-ttu-id="b76f2-107">Para obter mais informações, veja [Provedor WMI para conceitos de eventos de servidor](https://technet.microsoft.com/library/ms180560.aspx).</span><span class="sxs-lookup"><span data-stu-id="b76f2-107">For more information, see [WMI Provider for Server Events Concepts](https://technet.microsoft.com/library/ms180560.aspx).</span></span>  
  
 <span data-ttu-id="b76f2-108">Em particular, como as notificações de evento criadas pelo Provedor WMI usam o [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] para enviar mensagens sobre eventos de servidor, esse serviço precisa ser habilitado sempre que são gerados eventos.</span><span class="sxs-lookup"><span data-stu-id="b76f2-108">In particular, because the event notifications created by the WMI Provider use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to send messages about server events, this service must be enabled wherever the events are generated.</span></span> <span data-ttu-id="b76f2-109">Se o programa consultar eventos em uma instância de servidor, o [!INCLUDE[ssSB](../../includes/sssb-md.md)] no msdb dessa instância precisará estar habilitado porque esse é o local do serviço de destino do [!INCLUDE[ssSB](../../includes/sssb-md.md)] (chamado SQL/Notifications/ProcessWMIEventProviderNotification/v1.0) criado pelo provedor.</span><span class="sxs-lookup"><span data-stu-id="b76f2-109">If your program queries events on a server instance, the [!INCLUDE[ssSB](../../includes/sssb-md.md)] in msdb of that instance must be enabled, because that is the location of the target [!INCLUDE[ssSB](../../includes/sssb-md.md)] service (named SQL/Notifications/ProcessWMIEventProviderNotification/v1.0) that is created by the provider.</span></span> <span data-ttu-id="b76f2-110">Se seu programa consultar eventos em um banco de dados ou em um objeto de banco de dados específico, deve ser habilitado o [!INCLUDE[ssSB](../../includes/sssb-md.md)] nesse banco de dados de destino.</span><span class="sxs-lookup"><span data-stu-id="b76f2-110">If your program queries events in a database or on a particular database object, the [!INCLUDE[ssSB](../../includes/sssb-md.md)] in that target database must be enabled.</span></span> <span data-ttu-id="b76f2-111">Se o [!INCLUDE[ssSB](../../includes/sssb-md.md)] correspondente não for habilitado após a implantação do aplicativo, quaisquer eventos gerados pela notificação de evento subjacente serão enviados para a fila do serviço usado pela notificação do evento, mas não serão retornados para o aplicativo de gerenciamento de WMI enquanto o [!INCLUDE[ssSB](../../includes/sssb-md.md)] não estiver habilitado.</span><span class="sxs-lookup"><span data-stu-id="b76f2-111">If the corresponding [!INCLUDE[ssSB](../../includes/sssb-md.md)] is not enabled after your application is deployed, any events generated by the underlying event notification are sent to the queue of the service used by the event notification, but are not returned to your WMI management application until [!INCLUDE[ssSB](../../includes/sssb-md.md)] is enabled.</span></span>  
  
 <span data-ttu-id="b76f2-112">A consulta a seguir determina quais Service Brokers são habilitados em uma instância de servidor, e o GUID de instância do Service Broker:</span><span class="sxs-lookup"><span data-stu-id="b76f2-112">The following query determines which service brokers are enabled on a server instance, and the broker instance GUID:</span></span>  
  
```  
SELECT name, is_broker_enabled, service_broker_guid FROM sys.databases;  
```  
  
 <span data-ttu-id="b76f2-113">A GUID do service broker do msdb é de interesse especial porque é o local do serviço de destino do provedor.</span><span class="sxs-lookup"><span data-stu-id="b76f2-113">The service broker GUID of msdb is of particular interest because that is the location of the target service of the provider.</span></span>  
  
 <span data-ttu-id="b76f2-114">Para habilitar o [!INCLUDE[ssSB](../../includes/sssb-md.md)] em um banco de dados, use a opção ENABLE_BROKER SET da instrução [ALTER DATABASE](/sql/t-sql/statements/alter-database-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="b76f2-114">To enable [!INCLUDE[ssSB](../../includes/sssb-md.md)] in a database, use the ENABLE_BROKER SET option of the [ALTER DATABASE](/sql/t-sql/statements/alter-database-transact-sql) statement.</span></span>  
  
## <a name="specifying-a-connection-string"></a><span data-ttu-id="b76f2-115">Especificando uma cadeia de caracteres de conexão</span><span class="sxs-lookup"><span data-stu-id="b76f2-115">Specifying a Connection String</span></span>  
 <span data-ttu-id="b76f2-116">Os aplicativos direcionam o Provedor WMI para Eventos de Servidor para uma instância do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] conectando-se a um namespace WMI definido pelo provedor.</span><span class="sxs-lookup"><span data-stu-id="b76f2-116">Applications direct the WMI Provider for Server Events to an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] by connecting to a WMI namespace defined by the provider.</span></span> <span data-ttu-id="b76f2-117">O serviço Windows WMI mapeia esse namespace para o DLL do provedor, Sqlwep.dll, e carrega-o na memória.</span><span class="sxs-lookup"><span data-stu-id="b76f2-117">The Windows WMI service maps this namespace to the provider DLL, Sqlwep.dll, and loads it into memory.</span></span> <span data-ttu-id="b76f2-118">Cada instância do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] tem seu próprio namespace WMI, cujo padrão é: \\ \\ . \\ *root* \\ *instance_name*\Microsoft\SqlServer\ServerEvents raiz.</span><span class="sxs-lookup"><span data-stu-id="b76f2-118">Each instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] has its own WMI namespace, which defaults to: \\\\.\\*root*\Microsoft\SqlServer\ServerEvents\\*instance_name*.</span></span> <span data-ttu-id="b76f2-119">*nome_da_instância* é definido como MSSQLSERVER em uma instalação padrão do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b76f2-119">*instance_name* defaults to MSSQLSERVER in a default installation of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
## <a name="permissions-and-server-authentication"></a><span data-ttu-id="b76f2-120">Permissões e autenticação do servidor</span><span class="sxs-lookup"><span data-stu-id="b76f2-120">Permissions and Server Authentication</span></span>  
 <span data-ttu-id="b76f2-121">Para acessar o Provedor WMI para Eventos de Servidor, o cliente em que o aplicativo de gerenciamento de WMI se origina precisa corresponder ao grupo ou logon autenticado do Windows na instância do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] especificado na cadeia de conexão do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="b76f2-121">To access the WMI Provider for Server Events, the client on which a WMI management application originates must correspond to Windows authenticated login or group in the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] specified in the application's connection string of the application.</span></span>  
  
## <a name="permissions-and-event-notification-scope"></a><span data-ttu-id="b76f2-122">Permissões e escopo da notificação de eventos</span><span class="sxs-lookup"><span data-stu-id="b76f2-122">Permissions and Event Notification Scope</span></span>  
 <span data-ttu-id="b76f2-123">O Provedor WMI para Eventos de Servidor traduz as consultas WQL para notificações de eventos no banco de dados de destino.</span><span class="sxs-lookup"><span data-stu-id="b76f2-123">The WMI Provider for Server Events translates WQL queries into event notifications in the target database.</span></span> <span data-ttu-id="b76f2-124">Por isso, o aplicativo de chamada precisa ter não só as permissões mínimas necessárias para acessar o provedor, como também as permissões corretas no banco de dados para criar as notificações de eventos necessárias.</span><span class="sxs-lookup"><span data-stu-id="b76f2-124">Because of this, the calling application must have not only the required minimum permissions to access the provider, but must also have the correct permissions in the database to create the required event notifications.</span></span> <span data-ttu-id="b76f2-125">A seguir estão as permissões:</span><span class="sxs-lookup"><span data-stu-id="b76f2-125">The following are the permissions:</span></span>  
  
-   <span data-ttu-id="b76f2-126">Para criar uma notificação de evento com escopo no banco de dados, no mínimo, é necessária a permissão CREATE DATABASE DDL EVENT NOTIFICATION no banco de dados atual.</span><span class="sxs-lookup"><span data-stu-id="b76f2-126">To create an event notification that is scoped to the database, at a minimum, CREATE DATABASE DDL EVENT NOTIFICATION permission in the current database is required.</span></span>  
  
-   <span data-ttu-id="b76f2-127">Para criar uma notificação de evento em uma instrução DDL com escopo no servidor, no mínimo, é necessária a permissão CREATE DDL EVENT NOTIFICATION no servidor.</span><span class="sxs-lookup"><span data-stu-id="b76f2-127">To create an event notification on a DDL statement that is scoped to the server, at a minimum, CREATE DDL EVENT NOTIFICATION permission in the server is required.</span></span>  
  
-   <span data-ttu-id="b76f2-128">Para criar uma notificação de evento em um evento de rastreamento, no mínimo, é necessária a permissão CREATE TRACE EVENT NOTIFICATION no servidor.</span><span class="sxs-lookup"><span data-stu-id="b76f2-128">To create an event notification on a trace event, at a minimum, CREATE TRACE EVENT NOTIFICATION permission in the server is required.</span></span>  
  
-   <span data-ttu-id="b76f2-129">Para criar uma notificação de evento com escopo em uma fila, no mínimo, é necessária a permissão ALTER na fila.</span><span class="sxs-lookup"><span data-stu-id="b76f2-129">To create an event notification that is scoped to a queue, at a minimum, ALTER permission on the queue is required.</span></span>  
  
 <span data-ttu-id="b76f2-130">Para obter informações sobre o escopo das consultas WQL, consulte [Usando o WQL com o Provedor WMI para eventos de servidor](https://technet.microsoft.com/library/ms180524\(v=sql.105\).aspx).</span><span class="sxs-lookup"><span data-stu-id="b76f2-130">For information about how WQL queries are scoped, see [Using WQL with the WMI Provider for Server Events](https://technet.microsoft.com/library/ms180524\(v=sql.105\).aspx).</span></span>  
  
 <span data-ttu-id="b76f2-131">Para ilustrar escopo, considere um aplicativo de Provedor WMI que inclui a consulta WQL a seguir:</span><span class="sxs-lookup"><span data-stu-id="b76f2-131">To illustrate scope, consider a WMI Provider application that includes the following WQL query:</span></span>  
  
```  
SELECT * FROM ALTER_TABLE  
WHERE DatabaseName = "AdventureWorks2012"   
    AND SchemaName = "Person"  
    AND ObjectName = "Person"  
    AND ObjectType = "TABLE";  
```  
  
 <span data-ttu-id="b76f2-132">O provedor WMI traduz essa consulta para uma notificação de evento que é criada no banco de dados do [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="b76f2-132">The WMI provider translates this query into an event notification that is created in the [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] database.</span></span> <span data-ttu-id="b76f2-133">Isso significa que o chamador precisa ter as permissões necessárias para criar essa notificação de evento, especificamente a permissão CREATE DATABASE DDL EVENT NOTIFICATION no banco de dados do [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="b76f2-133">This means that the caller must have the required permissions to create such an event notification, specifically CREATE DATABASE DDL EVENT NOTIFICATION permission in the [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] database.</span></span>  
  
 <span data-ttu-id="b76f2-134">Se uma consulta WQL especifica uma notificação de evento com escopo no nível de servidor, por exemplo, emitindo a consulta SELECT \* FROM ALTER_TABLE, o aplicativo de chamada precisará ter a permissão CREATE DDL EVENT NOTIFICATION no nível de servidor.</span><span class="sxs-lookup"><span data-stu-id="b76f2-134">If a WQL query specifies an event notification scoped at the server level, for example by issuing the query SELECT \* FROM ALTER_TABLE, the calling application must have the server-level CREATE DDL EVENT NOTIFICATION permission.</span></span> <span data-ttu-id="b76f2-135">Observe que notificações de evento com escopo no servidor são armazenadas no banco de dados mestre.</span><span class="sxs-lookup"><span data-stu-id="b76f2-135">Note that server-scoped event notifications are stored in the master database.</span></span> <span data-ttu-id="b76f2-136">Você pode usar a exibição do catálogo [sys.server_event_notifications](/sql/relational-databases/system-catalog-views/sys-server-event-notifications-transact-sql) para ver seus metadados.</span><span class="sxs-lookup"><span data-stu-id="b76f2-136">You can use the [sys.server_event_notifications](/sql/relational-databases/system-catalog-views/sys-server-event-notifications-transact-sql) catalog view to see their metadata.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="b76f2-137">O escopo da notificação de evento criada pelo Provedor WMI (servidor, banco de dados ou objeto) por fim depende do resultado do processo de verificação de permissões usado pelo provedor WMI.</span><span class="sxs-lookup"><span data-stu-id="b76f2-137">The scope of the event notification that is created by the WMI Provider (server, database, or object) ultimately depends on the outcome of the permissions verification process that is used by the WMI provider.</span></span> <span data-ttu-id="b76f2-138">Isso é afetado pelo conjunto de permissões do usuário que está chamando o provedor e pela verificação do banco de dados que está sendo consultado.</span><span class="sxs-lookup"><span data-stu-id="b76f2-138">This is affected by the permission set of the user that is calling the provider and on the verification of the database that is being queried.</span></span>  
>   
>  <span data-ttu-id="b76f2-139">No exemplo anterior, o provedor tenta primeiro criar uma notificação de evento com escopo no banco de dados (`ON DATABASE`).</span><span class="sxs-lookup"><span data-stu-id="b76f2-139">In the previous example, the provider first tries to create an event notification scoped to the database (`ON DATABASE`).</span></span> <span data-ttu-id="b76f2-140">Se o provedor verifica que o banco de dados existe e que o chamador tem as permissões necessárias para criar uma notificação de evento nele, o registro é bem-sucedido.</span><span class="sxs-lookup"><span data-stu-id="b76f2-140">If the provider verifies that the database exists and that the caller has the required permissions to create an event notification on it, the registration is successful.</span></span> <span data-ttu-id="b76f2-141">Se não for bem-sucedido, o provedor tentará criar uma notificação de evento no servidor (`ON SERVER`).</span><span class="sxs-lookup"><span data-stu-id="b76f2-141">If it is not successful, the provider tries to create an event notification on the server (`ON SERVER`).</span></span> <span data-ttu-id="b76f2-142">Pressupondo que essa tentativa é bem-sucedida, todos os eventos `ALTER_TABLE` que ocorrem no servidor são enviados do processo do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] para o processo do Serviço WMI.</span><span class="sxs-lookup"><span data-stu-id="b76f2-142">Assuming that this attempt is successful, all `ALTER_TABLE` events that occur on the server are sent from the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] process to the WMI Service process.</span></span> <span data-ttu-id="b76f2-143">Entretanto, o provedor filtra quaisquer eventos que não se aplicam ao banco de dados do `AdventureWorks` .</span><span class="sxs-lookup"><span data-stu-id="b76f2-143">However, the provider filters out any events that do not apply to the `AdventureWorks` database.</span></span> <span data-ttu-id="b76f2-144">Apesar de, por um lado, esse processo possivelmente aumentar a quantidade de tráfego de rede necessária para o escopo do evento, por outro, ele também oferece a flexibilidade de registrar consultas WQL no banco de dados antes de serem criadas e de receber os dados de evento depois de o banco de dados ser criado e a atividade de DDL ser iniciada nele.</span><span class="sxs-lookup"><span data-stu-id="b76f2-144">Although this process potentially increases the amount of network traffic necessary for the scope of the event, this process also enables you with the flexibility to register WQL queries on databases before they are created, and then receive event data after the database is created and DDL activity starts on it.</span></span>  
  
## <a name="permissions-and-message-verification"></a><span data-ttu-id="b76f2-145">Permissões e verificação de mensagem</span><span class="sxs-lookup"><span data-stu-id="b76f2-145">Permissions and Message Verification</span></span>  
 <span data-ttu-id="b76f2-146">O Provedor WMI não enviará mensagens para notificações de evento se ambas as condições a seguir forem verdadeiras:</span><span class="sxs-lookup"><span data-stu-id="b76f2-146">The WMI Provider does not send messages for event notifications if both of the following conditions are true:</span></span>  
  
-   <span data-ttu-id="b76f2-147">O usuário que criou a notificação de evento através do Provedor WMI não existe mais no banco de dados ou não tem mais a permissão necessária para criar uma notificação de evento semelhante.</span><span class="sxs-lookup"><span data-stu-id="b76f2-147">The user that created the event notification through the WMI Provider no longer exists in the database, or no longer has the required permission to create a similar event notification.</span></span>  
  
-   <span data-ttu-id="b76f2-148">As notificações de evento são criadas nos eventos a seguir:</span><span class="sxs-lookup"><span data-stu-id="b76f2-148">The event notifications are created on the following events:</span></span>  
  
    -   <span data-ttu-id="b76f2-149">DROP_LOGIN</span><span class="sxs-lookup"><span data-stu-id="b76f2-149">DROP_LOGIN</span></span>  
  
    -   <span data-ttu-id="b76f2-150">ALTER_LOGIN</span><span class="sxs-lookup"><span data-stu-id="b76f2-150">ALTER_LOGIN</span></span>  
  
    -   <span data-ttu-id="b76f2-151">DROP_USER</span><span class="sxs-lookup"><span data-stu-id="b76f2-151">DROP_USER</span></span>  
  
    -   <span data-ttu-id="b76f2-152">ALTER_USER</span><span class="sxs-lookup"><span data-stu-id="b76f2-152">ALTER_USER</span></span>  
  
    -   <span data-ttu-id="b76f2-153">ADD_ROLE_MEMBER</span><span class="sxs-lookup"><span data-stu-id="b76f2-153">ADD_ROLE_MEMBER</span></span>  
  
    -   <span data-ttu-id="b76f2-154">DROP_ROLE_MEMBER</span><span class="sxs-lookup"><span data-stu-id="b76f2-154">DROP_ROLE_MEMBER</span></span>  
  
    -   <span data-ttu-id="b76f2-155">ADD_SERVER_ROLE_MEMBER</span><span class="sxs-lookup"><span data-stu-id="b76f2-155">ADD_SERVER_ROLE_MEMBER</span></span>  
  
    -   <span data-ttu-id="b76f2-156">DROP_SERVER_ROLE_MEMBER</span><span class="sxs-lookup"><span data-stu-id="b76f2-156">DROP_SERVER_ROLE_MEMBER</span></span>  
  
    -   <span data-ttu-id="b76f2-157">DENY ou REVOKE (Aplica-se somente às permissões ALTER DATABASE, ALTER ANY DATABASE EVENT NOTIFICATION, CREATE DATABASE DDL EVENT NOTIFICATION, CONTROL SERVER, ALTER ANY EVENT NOTIFICATION, CREATE DDL EVENT NOTIFICATION ou CREATE TRACE EVENT NOTIFICATION.)</span><span class="sxs-lookup"><span data-stu-id="b76f2-157">DENY or REVOKE (Applies only to ALTER DATABASE, ALTER ANY DATABASE EVENT NOTIFICATION, CREATE DATABASE DDL EVENT NOTIFICATION, CONTROL SERVER, ALTER ANY EVENT NOTIFICATION, CREATE DDL EVENT NOTIFICATION, OR CREATE TRACE EVENT NOTIFICATION permissions.)</span></span>  
  
## <a name="working-with-event-data-on-the-client-side"></a><span data-ttu-id="b76f2-158">Trabalhando com dados de evento no lado do cliente</span><span class="sxs-lookup"><span data-stu-id="b76f2-158">Working with Event Data on the Client Side</span></span>  
 <span data-ttu-id="b76f2-159">Depois que o provedor WMI para eventos de servidor cria a notificação de evento necessária no banco de dados de destino, a notificação de eventos envia dados de evento para o serviço de destino no msdb chamado **SQL/Notifications/ProcessWMIEventProviderNotification/v 1.0**.</span><span class="sxs-lookup"><span data-stu-id="b76f2-159">After the WMI Provider for Server Events creates the required event notification in the target database, the event notification sends event data to the target service in msdb that is named **SQL/Notifications/ProcessWMIEventProviderNotification/v1.0**.</span></span> <span data-ttu-id="b76f2-160">O serviço de destino coloca o evento em uma fila no `msdb` que se chama **WMIEventProviderNotificationQueue**.</span><span class="sxs-lookup"><span data-stu-id="b76f2-160">The target service puts the event into a queue in `msdb` that is named **WMIEventProviderNotificationQueue**.</span></span> <span data-ttu-id="b76f2-161">(O serviço e a fila são criados dinamicamente pelo provedor quando ele se conecta pela primeira vez ao [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .) Em seguida, o provedor lê os dados de evento XML dessa fila e os transforma no MOF (Managed Object Format) antes de retorná-los para o aplicativo cliente.</span><span class="sxs-lookup"><span data-stu-id="b76f2-161">(Both the service and the queue are dynamically created by the provider when it first connects to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].) The provider then reads the XML event data from this queue and transforms it into managed object format (MOF) before returning it to the client application.</span></span> <span data-ttu-id="b76f2-162">Os dados MOF consistem nas propriedades do evento que é solicitado pela consulta WQL como uma definição de classe de modelo CIM.</span><span class="sxs-lookup"><span data-stu-id="b76f2-162">The MOF data is made up of the properties of the event that is requested by the WQL query as a Common Information Model (CIM) class definition.</span></span> <span data-ttu-id="b76f2-163">Cada propriedade tem um tipo CIM correspondente.</span><span class="sxs-lookup"><span data-stu-id="b76f2-163">Each property has a corresponding CIM type.</span></span> <span data-ttu-id="b76f2-164">Por exemplo, a propriedade `SPID` é retornada como tipo CIM `Sint32`.</span><span class="sxs-lookup"><span data-stu-id="b76f2-164">For example, the `SPID` property is returned as CIM type `Sint32`.</span></span> <span data-ttu-id="b76f2-165">São listados os tipos CIM para cada propriedade listada sob cada classe de evento em [Classes e propriedades do Provedor WMI para Eventos de Servidor](../../relational-databases/wmi-provider-server-events/wmi-provider-for-server-events-classes-and-properties.md).</span><span class="sxs-lookup"><span data-stu-id="b76f2-165">The CIM types for each property are listed under each event class in [WMI Provider for Server Events Classes and Properties](../../relational-databases/wmi-provider-server-events/wmi-provider-for-server-events-classes-and-properties.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b76f2-166">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="b76f2-166">See Also</span></span>  
 [<span data-ttu-id="b76f2-167">Provedor WMI para conceitos de eventos de servidor</span><span class="sxs-lookup"><span data-stu-id="b76f2-167">WMI Provider for Server Events Concepts</span></span>](https://technet.microsoft.com/library/ms180560.aspx)  
  
  
