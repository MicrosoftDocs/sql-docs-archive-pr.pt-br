---
title: Restrições de chave primária e chave estrangeira | Microsoft Doc
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: table-view-index
ms.topic: conceptual
helpviewer_keywords:
- foreign keys [SQL Server], cascading referential integrity
- FOREIGN KEY constraints
- foreign keys [SQL Server]
- foreign keys [SQL Server], about foreign key constraints
ms.assetid: 31fbcc9f-2dc5-4bf9-aa50-ed70ec7b5bcd
author: stevestein
ms.author: sstein
ms.openlocfilehash: b6e7b88de880348fabb00cb46d3028716441bc2b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87581708"
---
# <a name="primary-and-foreign-key-constraints"></a><span data-ttu-id="4fc69-102">Restrições de chave primária e chave estrangeira</span><span class="sxs-lookup"><span data-stu-id="4fc69-102">Primary and Foreign Key Constraints</span></span>
  <span data-ttu-id="4fc69-103">Chave primárias e estrangeiras são dois tipos de restrições que podem ser usadas para impor integridade de dados nas tabelas do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="4fc69-103">Primary keys and foreign keys are two types of constraints that can be used to enforce data integrity in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] tables.</span></span> <span data-ttu-id="4fc69-104">Esses são objetos de banco de dados importantes.</span><span class="sxs-lookup"><span data-stu-id="4fc69-104">These are important database objects.</span></span>

 <span data-ttu-id="4fc69-105">Este tópico inclui as seções a seguir.</span><span class="sxs-lookup"><span data-stu-id="4fc69-105">This topic contains the following sections.</span></span>

 [<span data-ttu-id="4fc69-106">Restrições PRIMARY KEY</span><span class="sxs-lookup"><span data-stu-id="4fc69-106">Primary Key Constraints</span></span>](../tables/primary-and-foreign-key-constraints.md#PKeys)

 [<span data-ttu-id="4fc69-107">Foreign Key Constraints</span><span class="sxs-lookup"><span data-stu-id="4fc69-107">Foreign Key Constraints</span></span>](../tables/primary-and-foreign-key-constraints.md#FKeys)

 [<span data-ttu-id="4fc69-108">Tarefas relacionadas</span><span class="sxs-lookup"><span data-stu-id="4fc69-108">Related Tasks</span></span>](../tables/primary-and-foreign-key-constraints.md#Tasks)

##  <a name="primary-key-constraints"></a><a name="PKeys"></a> <span data-ttu-id="4fc69-109">Restrições PRIMARY KEY</span><span class="sxs-lookup"><span data-stu-id="4fc69-109">Primary Key Constraints</span></span>
 <span data-ttu-id="4fc69-110">Geralmente, uma tabela tem uma coluna ou uma combinação de colunas que contém valores que identificam exclusivamente cada linha na tabela.</span><span class="sxs-lookup"><span data-stu-id="4fc69-110">A table typically has a column or combination of columns that contain values that uniquely identify each row in the table.</span></span> <span data-ttu-id="4fc69-111">Essa coluna, ou colunas, é chamada de chave primária (PK) da tabela e impõe a integridade da entidade da mesma.</span><span class="sxs-lookup"><span data-stu-id="4fc69-111">This column, or columns, is called the primary key (PK) of the table and enforces the entity integrity of the table.</span></span> <span data-ttu-id="4fc69-112">Como as restrições PRIMARY KEY garantem dados exclusivos, elas são frequentemente definidas em uma coluna de identidade.</span><span class="sxs-lookup"><span data-stu-id="4fc69-112">Because primary key constraints guarantee unique data, they are frequently defined on an identity column.</span></span>

 <span data-ttu-id="4fc69-113">Quando especificar uma restrição PRIMARY KEY para uma tabela, o [!INCLUDE[ssDE](../../includes/ssde-md.md)] impõe a exclusividade dos dados criando automaticamente um índice exclusivo para as colunas de chave primária.</span><span class="sxs-lookup"><span data-stu-id="4fc69-113">When you specify a primary key constraint for a table, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] enforces data uniqueness by automatically creating a unique index for the primary key columns.</span></span> <span data-ttu-id="4fc69-114">Esse índice também permite um acesso rápido aos dados quando a chave primária é usada em consultas.</span><span class="sxs-lookup"><span data-stu-id="4fc69-114">This index also permits fast access to data when the primary key is used in queries.</span></span> <span data-ttu-id="4fc69-115">Se uma restrição de chave primária for definida em mais de uma coluna, os valores poderão ser duplicados em uma coluna, mas cada combinação de valores de todas as colunas na definição da restrição de chave primária deve ser exclusiva.</span><span class="sxs-lookup"><span data-stu-id="4fc69-115">If a primary key constraint is defined on more than one column, values may be duplicated within one column, but each combination of values from all the columns in the primary key constraint definition must be unique.</span></span>

 <span data-ttu-id="4fc69-116">Conforme mostrado na ilustração a seguir, as colunas **ProductID** e **VendorID** da tabela **Purchasing.ProductVendor** formam uma restrição de chave primária composta para essa tabela.</span><span class="sxs-lookup"><span data-stu-id="4fc69-116">As shown in the following illustration, the **ProductID** and **VendorID** columns in the **Purchasing.ProductVendor** table form a composite primary key constraint for this table.</span></span> <span data-ttu-id="4fc69-117">Isso garante que cada linha da tabela **ProductVendor** tem uma combinação exclusiva de **ProductID** e **VendorID**.</span><span class="sxs-lookup"><span data-stu-id="4fc69-117">This makes sure that every row in the **ProductVendor** table has a unique combination of **ProductID** and **VendorID**.</span></span> <span data-ttu-id="4fc69-118">Isso impede a inserção de linhas duplicadas.</span><span class="sxs-lookup"><span data-stu-id="4fc69-118">This prevents the insertion of duplicate rows.</span></span>

 <span data-ttu-id="4fc69-119">![Restrição de PRIMARY KEY composta](../../database-engine/media/fund04.gif "Restrição de PRIMARY KEY composta")</span><span class="sxs-lookup"><span data-stu-id="4fc69-119">![Composite PRIMARY KEY constraint](../../database-engine/media/fund04.gif "Composite PRIMARY KEY constraint")</span></span>

-   <span data-ttu-id="4fc69-120">Uma tabela pode conter apenas uma restrição PRIMARY KEY.</span><span class="sxs-lookup"><span data-stu-id="4fc69-120">A table can contain only one primary key constraint.</span></span>

-   <span data-ttu-id="4fc69-121">Uma chave primária não pode exceder 16 colunas e o comprimento de chave total de 900 bytes.</span><span class="sxs-lookup"><span data-stu-id="4fc69-121">A primary key cannot exceed 16 columns and a total key length of 900 bytes.</span></span>

-   <span data-ttu-id="4fc69-122">O índice gerado por uma restrição PRIMARY KEY não pode fazer com que o número de índices da tabela exceda 999 índices não clusterizados e 1 índice clusterizado.</span><span class="sxs-lookup"><span data-stu-id="4fc69-122">The index generated by a primary key constraint cannot cause the number of indexes on the table to exceed 999 nonclustered indexes and 1 clustered index.</span></span>

-   <span data-ttu-id="4fc69-123">Se CLUSTERED ou NONCLUSTERED não estiver especificado para uma restrição PRIMARY KEY, CLUSTERED será usado se não houver índices clusterizados na tabela.</span><span class="sxs-lookup"><span data-stu-id="4fc69-123">If clustered or nonclustered is not specified for a primary key constraint, clustered is used if there no clustered index on the table.</span></span>

-   <span data-ttu-id="4fc69-124">Todas as colunas definidas em uma restrição PRIMARY KEY devem ser definidas como NOT NULL.</span><span class="sxs-lookup"><span data-stu-id="4fc69-124">All columns defined within a primary key constraint must be defined as not null.</span></span> <span data-ttu-id="4fc69-125">Se a nulidade não for especificada, todas as colunas participantes de uma restrição PRIMARY KEY deverão ter sua nulidade definida como NOT NULL.</span><span class="sxs-lookup"><span data-stu-id="4fc69-125">If nullability is not specified, all columns participating in a primary key constraint have their nullability set to not null.</span></span>

-   <span data-ttu-id="4fc69-126">Se a chave primária for definida em uma coluna de tipo CLR definida pelo usuário, a implementação do tipo deverá oferecer suporte a uma ordenação binária.</span><span class="sxs-lookup"><span data-stu-id="4fc69-126">If a primary key is defined on a CLR user-defined type column, the implementation of the type must support binary ordering.</span></span>

##  <a name="foreign-key-constraints"></a><a name="FKeys"></a> <span data-ttu-id="4fc69-127">Foreign Key Constraints</span><span class="sxs-lookup"><span data-stu-id="4fc69-127">Foreign Key Constraints</span></span>
 <span data-ttu-id="4fc69-128">Uma chave estrangeira (FK) é uma coluna ou combinação de colunas usada para estabelecer e impor um link entre os dados de duas tabelas, a fim de controlar os dados que podem ser armazenados na tabela de chave estrangeira.</span><span class="sxs-lookup"><span data-stu-id="4fc69-128">A foreign key (FK) is a column or combination of columns that is used to establish and enforce a link between the data in two tables to control the data that can be stored in the foreign key table.</span></span> <span data-ttu-id="4fc69-129">Em uma referência de chave estrangeira, cria-se um link entre duas tabelas quando a coluna ou as colunas que contêm o valor de chave primária para uma tabela são referenciadas pela coluna ou colunas de outra tabela.</span><span class="sxs-lookup"><span data-stu-id="4fc69-129">In a foreign key reference, a link is created between two tables when the column or columns that hold the primary key value for one table are referenced by the column or columns in another table.</span></span> <span data-ttu-id="4fc69-130">Essa coluna torna-se uma chave estrangeira na segunda tabela.</span><span class="sxs-lookup"><span data-stu-id="4fc69-130">This column becomes a foreign key in the second table.</span></span>

 <span data-ttu-id="4fc69-131">Por exemplo, a tabela **Sales.SalesOrderHeader** tem um link de chave estrangeira para a tabela **Sales.SalesPerson** porque existe uma relação lógica entre os pedidos de vendas e os vendedores.</span><span class="sxs-lookup"><span data-stu-id="4fc69-131">For example, the **Sales.SalesOrderHeader** table has a foreign key link to the **Sales.SalesPerson** table because there is a logical relationship between sales orders and salespeople.</span></span> <span data-ttu-id="4fc69-132">A coluna **SalesPersonID** na tabela **SalesOrderHeader** corresponde à coluna de chave primária da tabela **SalesPerson** .</span><span class="sxs-lookup"><span data-stu-id="4fc69-132">The **SalesPersonID** column in the **SalesOrderHeader** table matches the primary key column of the **SalesPerson** table.</span></span> <span data-ttu-id="4fc69-133">A coluna **SalesPersonID** na tabela **SalesOrderHeader** é a chave estrangeira para a tabela **SalesPerson** .</span><span class="sxs-lookup"><span data-stu-id="4fc69-133">The **SalesPersonID** column in the **SalesOrderHeader** table is the foreign key to the **SalesPerson** table.</span></span> <span data-ttu-id="4fc69-134">Criando essa relação de chave estrangeira, um valor para **SalesPersonID** não poderá ser inserido na tabela **SalesOrderHeader** se ela não existir na tabela **SalesPerson** .</span><span class="sxs-lookup"><span data-stu-id="4fc69-134">By creating this foreign key relationship, a value for **SalesPersonID** cannot be inserted into the **SalesOrderHeader** table if it does not already exist in the **SalesPerson** table.</span></span>

### <a name="indexes-on-foreign-key-constraints"></a><span data-ttu-id="4fc69-135">Índices em restrições de chave estrangeira</span><span class="sxs-lookup"><span data-stu-id="4fc69-135">Indexes on Foreign Key Constraints</span></span>
 <span data-ttu-id="4fc69-136">Diferente das restrições de chave primária, a criação de uma restrição de chave estrangeira não cria automaticamente um índice correspondente.</span><span class="sxs-lookup"><span data-stu-id="4fc69-136">Unlike primary key constraints, creating a foreign key constraint does not automatically create a corresponding index.</span></span> <span data-ttu-id="4fc69-137">No entanto, a criação manual de um índice em uma chave estrangeira geralmente é útil pelos seguintes motivos:</span><span class="sxs-lookup"><span data-stu-id="4fc69-137">However, manually creating an index on a foreign key is often useful for the following reasons:</span></span>

-   <span data-ttu-id="4fc69-138">As colunas de chave estrangeira são frequentemente usadas em critérios de junção quando os dados de tabelas relacionadas são combinados em consultas, fazendo a correspondência de uma ou mais colunas na restrição FOREIGN KEY de uma tabela com uma ou mais colunas de chave exclusiva ou primária de outra tabela.</span><span class="sxs-lookup"><span data-stu-id="4fc69-138">Foreign key columns are frequently used in join criteria when the data from related tables is combined in queries by matching the column or columns in the foreign key constraint of one table with the primary or unique key column or columns in the other table.</span></span> <span data-ttu-id="4fc69-139">Um índice habilita o [!INCLUDE[ssDE](../../includes/ssde-md.md)] a localizar rapidamente dados relacionados na tabela de chave estrangeira.</span><span class="sxs-lookup"><span data-stu-id="4fc69-139">An index enables the [!INCLUDE[ssDE](../../includes/ssde-md.md)] to quickly find related data in the foreign key table.</span></span> <span data-ttu-id="4fc69-140">Porém, a criação desse índice não é obrigatória.</span><span class="sxs-lookup"><span data-stu-id="4fc69-140">However, creating this index is not required.</span></span> <span data-ttu-id="4fc69-141">Os dados de duas tabelas relacionadas podem ser combinados até mesmo se nenhuma restrição PRIMARY KEY ou FOREIGN KEY tiver sido definida entre as tabelas, mas uma relação de chave estrangeira entre duas tabelas indica que estas foram otimizadas para serem combinadas em uma consulta que usa chaves como critérios.</span><span class="sxs-lookup"><span data-stu-id="4fc69-141">Data from two related tables can be combined even if no primary key or foreign key constraints are defined between the tables, but a foreign key relationship between two tables indicates that the two tables have been optimized to be combined in a query that uses the keys as its criteria.</span></span>

-   <span data-ttu-id="4fc69-142">As alterações feitas em restrições PRIMARY KEY são verificadas com restrições FOREIGN KEY em tabelas relacionadas.</span><span class="sxs-lookup"><span data-stu-id="4fc69-142">Changes to primary key constraints are checked with foreign key constraints in related tables.</span></span>

### <a name="referential-integrity"></a><span data-ttu-id="4fc69-143">Integridade referencial</span><span class="sxs-lookup"><span data-stu-id="4fc69-143">Referential Integrity</span></span>
 <span data-ttu-id="4fc69-144">Embora o propósito principal da restrição FOREIGN KEY seja controlar os dados que podem ser armazenados na tabela de chave estrangeira, ela também controla as alterações efetuadas nos dados da tabela de chave primária.</span><span class="sxs-lookup"><span data-stu-id="4fc69-144">Although the main purpose of a foreign key constraint is to control the data that can be stored in the foreign key table, it also controls changes to data in the primary key table.</span></span> <span data-ttu-id="4fc69-145">Por exemplo, se a linha de um vendedor for excluída da tabela **Sales.SalesPerson** e a ID do vendedor for usada para pedidos de vendas na tabela **Sales.SalesOrderHeader** , a integridade relacional entre as duas tabelas será quebrada; os pedidos de vendas do vendedor excluído ficarão órfãos na tabela **SalesOrderHeader** sem um link para os dados na tabela **SalesPerson** .</span><span class="sxs-lookup"><span data-stu-id="4fc69-145">For example, if the row for a salesperson is deleted from the **Sales.SalesPerson** table, and the salesperson's ID is used for sales orders in the **Sales.SalesOrderHeader** table, the relational integrity between the two tables is broken; the deleted salesperson's sales orders are orphaned in the **SalesOrderHeader** table without a link to the data in the **SalesPerson** table.</span></span>

 <span data-ttu-id="4fc69-146">Uma restrição FOREIGN KEY impede essa situação.</span><span class="sxs-lookup"><span data-stu-id="4fc69-146">A foreign key constraint prevents this situation.</span></span> <span data-ttu-id="4fc69-147">A restrição impõe a integridade referencial ao garantir que não possam ser feitas alterações na tabela de chave primária se essas alterações invalidarem o link para os dados na tabela de chave estrangeira.</span><span class="sxs-lookup"><span data-stu-id="4fc69-147">The constraint enforces referential integrity by guaranteeing that changes cannot be made to data in the primary key table if those changes invalidate the link to data in the foreign key table.</span></span> <span data-ttu-id="4fc69-148">Se for feita uma tentativa de exclusão da linha em uma tabela de chave primária ou alteração de um valor de chave primária, a ação apresentará falha quando o valor de chave primária excluído ou alterado corresponder a um valor na restrição FOREIGN KEY de outra tabela.</span><span class="sxs-lookup"><span data-stu-id="4fc69-148">If an attempt is made to delete the row in a primary key table or to change a primary key value, the action will fail when the deleted or changed primary key value corresponds to a value in the foreign key constraint of another table.</span></span> <span data-ttu-id="4fc69-149">Para obter sucesso ao alterar ou excluir uma linha em uma restrição FOREIGN KEY, você precisa primeiro excluir os dados de chave estrangeira da tabela de chave estrangeira ou alterar os dados de chave estrangeira na tabela de chave estrangeira, o que vinculará a chave estrangeira aos diversos dados de chave primária.</span><span class="sxs-lookup"><span data-stu-id="4fc69-149">To successfully change or delete a row in a foreign key constraint, you must first either delete the foreign key data in the foreign key table or change the foreign key data in the foreign key table, which links the foreign key to different primary key data.</span></span>

#### <a name="cascading-referential-integrity"></a><span data-ttu-id="4fc69-150">Integridade referencial em cascata</span><span class="sxs-lookup"><span data-stu-id="4fc69-150">Cascading Referential Integrity</span></span>
 <span data-ttu-id="4fc69-151">Usando restrições de integridade referencial em cascata, é possível definir as ações que o [!INCLUDE[ssDE](../../includes/ssde-md.md)] executa quando o usuário tenta excluir ou atualizar uma chave para a qual apontam as chaves estrangeiras existentes.</span><span class="sxs-lookup"><span data-stu-id="4fc69-151">By using cascading referential integrity constraints, you can define the actions that the [!INCLUDE[ssDE](../../includes/ssde-md.md)] takes when a user tries to delete or update a key to which existing foreign keys point.</span></span> <span data-ttu-id="4fc69-152">As ações em cascata a seguir podem ser definidas.</span><span class="sxs-lookup"><span data-stu-id="4fc69-152">The following cascading actions can be defined.</span></span>

 <span data-ttu-id="4fc69-153">NENHUMA ação [!INCLUDE[ssDE](../../includes/ssde-md.md)] gera um erro e a ação excluir ou atualizar na linha na tabela pai é revertida.</span><span class="sxs-lookup"><span data-stu-id="4fc69-153">NO ACTION The [!INCLUDE[ssDE](../../includes/ssde-md.md)] raises an error and the delete or update action on the row in the parent table is rolled back.</span></span>

 <span data-ttu-id="4fc69-154">As linhas correspondentes em cascata são atualizadas ou excluídas na tabela de referência quando essa linha é atualizada ou excluída na tabela pai.</span><span class="sxs-lookup"><span data-stu-id="4fc69-154">CASCADE Corresponding rows are updated or deleted in the referencing table when that row is updated or deleted in the parent table.</span></span> <span data-ttu-id="4fc69-155">CASCADE não poderá ser especificada se uma coluna `timestamp` fizer parte da chave estrangeira ou da chave referenciada.</span><span class="sxs-lookup"><span data-stu-id="4fc69-155">CASCADE cannot be specified if a `timestamp` column is part of either the foreign key or the referenced key.</span></span> <span data-ttu-id="4fc69-156">ON DELETE CASCADE não poderá ser especificada para a tabela que tenha um gatilho INSTEAD OF DELETE.</span><span class="sxs-lookup"><span data-stu-id="4fc69-156">ON DELETE CASCADE cannot be specified for a table that has an INSTEAD OF DELETE trigger.</span></span> <span data-ttu-id="4fc69-157">ON UPDATE CASCADE não poderá ser especificada para tabelas que tenham um gatilho INSTEAD OF UPDATE.</span><span class="sxs-lookup"><span data-stu-id="4fc69-157">ON UPDATE CASCADE cannot be specified for tables that have INSTEAD OF UPDATE triggers.</span></span>

 <span data-ttu-id="4fc69-158">DEFINIR nulo todos os valores que compõem a chave estrangeira são definidos como NULL quando a linha correspondente na tabela pai é atualizada ou excluída.</span><span class="sxs-lookup"><span data-stu-id="4fc69-158">SET NULL All the values that make up the foreign key are set to NULL when the corresponding row in the parent table is updated or deleted.</span></span> <span data-ttu-id="4fc69-159">Para que essa restrição seja executada, as colunas de chave estrangeira devem ser anuláveis.</span><span class="sxs-lookup"><span data-stu-id="4fc69-159">For this constraint to execute, the foreign key columns must be nullable.</span></span> <span data-ttu-id="4fc69-160">Não poderá ser especificada para tabelas que tenham gatilhos INSTEAD OF UPDATE.</span><span class="sxs-lookup"><span data-stu-id="4fc69-160">Cannot be specified for tables that have INSTEAD OF UPDATE triggers.</span></span>

 <span data-ttu-id="4fc69-161">DEFINIR padrão todos os valores que compõem a chave estrangeira serão definidos com seus valores padrão se a linha correspondente na tabela pai for atualizada ou excluída.</span><span class="sxs-lookup"><span data-stu-id="4fc69-161">SET DEFAULT All the values that make up the foreign key are set to their default values if the corresponding row in the parent table is updated or deleted.</span></span> <span data-ttu-id="4fc69-162">Para que essa restrição seja executada, todas as colunas de chave estrangeira devem ter definições padrão.</span><span class="sxs-lookup"><span data-stu-id="4fc69-162">For this constraint to execute, all foreign key columns must have default definitions.</span></span> <span data-ttu-id="4fc69-163">Se a coluna for anulável e não houver nenhum valor padrão explícito definido, NULL se tornará o valor padrão implícito para a coluna.</span><span class="sxs-lookup"><span data-stu-id="4fc69-163">If a column is nullable, and there is no explicit default value set, NULL becomes the implicit default value of the column.</span></span> <span data-ttu-id="4fc69-164">Não poderá ser especificada para tabelas que tenham gatilhos INSTEAD OF UPDATE.</span><span class="sxs-lookup"><span data-stu-id="4fc69-164">Cannot be specified for tables that have INSTEAD OF UPDATE triggers.</span></span>

 <span data-ttu-id="4fc69-165">CASCADE, SET NULL, SET DEFAULT e NO ACTION podem ser combinados nas tabelas que tenham relacionamentos referenciais entre si.</span><span class="sxs-lookup"><span data-stu-id="4fc69-165">CASCADE, SET NULL, SET DEFAULT and NO ACTION can be combined on tables that have referential relationships with each other.</span></span> <span data-ttu-id="4fc69-166">Se o [!INCLUDE[ssDE](../../includes/ssde-md.md)] encontrar NO ACTION, parará e reverterá as ações CASCATA, SET NULL e SET DEFAULT.</span><span class="sxs-lookup"><span data-stu-id="4fc69-166">If the [!INCLUDE[ssDE](../../includes/ssde-md.md)] encounters NO ACTION, it stops and rolls back related CASCADE, SET NULL and SET DEFAULT actions.</span></span> <span data-ttu-id="4fc69-167">Quando uma instrução DELETE provoca uma combinação de ações CASCADE, SET NULL, SET DEFAULT e NO ACTION, todas as ações CASCADE, SET NULL e SET DEFAULT são aplicadas antes que o [!INCLUDE[ssDE](../../includes/ssde-md.md)] verifique se existe alguma NO ACTION.</span><span class="sxs-lookup"><span data-stu-id="4fc69-167">When a DELETE statement causes a combination of CASCADE, SET NULL, SET DEFAULT and NO ACTION actions, all the CASCADE, SET NULL and SET DEFAULT actions are applied before the [!INCLUDE[ssDE](../../includes/ssde-md.md)] checks for any NO ACTION.</span></span>

### <a name="triggers-and-cascading-referential-actions"></a><span data-ttu-id="4fc69-168">Gatilhos e ações referenciais em cascata</span><span class="sxs-lookup"><span data-stu-id="4fc69-168">Triggers and Cascading Referential Actions</span></span>
 <span data-ttu-id="4fc69-169">As ações referenciais em cascata acionam os gatilhos de AFTER UPDATE ou AFTER DELETE da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="4fc69-169">Cascading referential actions fire the AFTER UPDATE or AFTER DELETE triggers in the following manner:</span></span>

-   <span data-ttu-id="4fc69-170">Todas as ações referenciais em cascata causadas diretamente por DELETE ou UPDATE originais são executadas em primeiro lugar.</span><span class="sxs-lookup"><span data-stu-id="4fc69-170">All the cascading referential actions directly caused by the original DELETE or UPDATE are performed first.</span></span>

-   <span data-ttu-id="4fc69-171">Se houver gatilhos AFTER definidos nas tabelas afetadas, esses gatilhos serão acionados depois que todas as ações referenciais em cascata forem executadas.</span><span class="sxs-lookup"><span data-stu-id="4fc69-171">If there are any AFTER triggers defined on the affected tables, these triggers fire after all cascading actions are performed.</span></span> <span data-ttu-id="4fc69-172">Os gatilhos são acionados em ordem oposta à ordem da ação em cascata.</span><span class="sxs-lookup"><span data-stu-id="4fc69-172">These triggers fire in opposite order of the cascading action.</span></span> <span data-ttu-id="4fc69-173">Se houver vários gatilhos em uma única tabela, eles serão acionados em ordem aleatória, a menos que haja um gatilho dedicado final ou inicial para a tabela.</span><span class="sxs-lookup"><span data-stu-id="4fc69-173">If there are multiple triggers on a single table, they fire in random order, unless there is a dedicated first or last trigger for the table.</span></span> <span data-ttu-id="4fc69-174">Essa ordem é especificada usando [sp_settriggerorder](/sql/relational-databases/system-stored-procedures/sp-settriggerorder-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="4fc69-174">This order is as specified by using [sp_settriggerorder](/sql/relational-databases/system-stored-procedures/sp-settriggerorder-transact-sql).</span></span>

-   <span data-ttu-id="4fc69-175">Se várias cadeias em cascata se originarem da tabela que era o destino direto de uma ação UPDATE ou DELETE, a ordem em que essas cadeias acionam seus respectivos gatilhos não é especificada.</span><span class="sxs-lookup"><span data-stu-id="4fc69-175">If multiple cascading chains originate from the table that was the direct target of an UPDATE or DELETE action, the order in which these chains fire their respective triggers is unspecified.</span></span> <span data-ttu-id="4fc69-176">Porém, uma cadeia sempre aciona todos os seus gatilhos antes que outra cadeia inicie o acionamento.</span><span class="sxs-lookup"><span data-stu-id="4fc69-176">However, one chain always fires all its triggers before another chain starts firing.</span></span>

-   <span data-ttu-id="4fc69-177">Um gatilho AFTER em uma tabela que seja o destino direto de ações UPDATE ou DELETE é acionado independentemente de alguma linha ter sido ou não afetada.</span><span class="sxs-lookup"><span data-stu-id="4fc69-177">An AFTER trigger on the table that is the direct target of an UPDATE or DELETE action fires regardless of whether any rows are affected.</span></span> <span data-ttu-id="4fc69-178">Não há nenhuma outra tabela afetada em cascata nesse caso.</span><span class="sxs-lookup"><span data-stu-id="4fc69-178">There are no other tables affected by cascading in this case.</span></span>

-   <span data-ttu-id="4fc69-179">Se algum dos gatilhos anteriores executar operações UPDATE ou DELETE em outras tabelas, essas ações poderão dar início a cadeias secundárias em cascata.</span><span class="sxs-lookup"><span data-stu-id="4fc69-179">If any one of the previous triggers perform UPDATE or DELETE operations on other tables, these actions can start secondary cascading chains.</span></span> <span data-ttu-id="4fc69-180">Essas cadeias secundárias são processadas para todas as operações UPDATE ou DELETE em dado momento após o acionamento de todos os gatilhos em todas as cadeias primárias.</span><span class="sxs-lookup"><span data-stu-id="4fc69-180">These secondary chains are processed for each UPDATE or DELETE operation at a time after all triggers on all primary chains fire.</span></span> <span data-ttu-id="4fc69-181">Esse processo pode ser repetido recursivamente para operações UPDATE ou DELETE subsequentes.</span><span class="sxs-lookup"><span data-stu-id="4fc69-181">This process may be recursively repeated for subsequent UPDATE or DELETE operations.</span></span>

-   <span data-ttu-id="4fc69-182">Executar CREATE, ALTER, DELETE ou outras operações DDL (Data Definition Language) nos gatilhos pode fazer com que os gatilhos DDL sejam acionados.</span><span class="sxs-lookup"><span data-stu-id="4fc69-182">Performing CREATE, ALTER, DELETE, or other data definition language (DDL) operations inside the triggers may cause DDL triggers to fire.</span></span> <span data-ttu-id="4fc69-183">Isso pode, subsequentemente, executar operações DELETE ou UPDATE que iniciam cadeias e gatilhos adicionais em cascata.</span><span class="sxs-lookup"><span data-stu-id="4fc69-183">This may subsequently perform DELETE or UPDATE operations that start additional cascading chains and triggers.</span></span>

-   <span data-ttu-id="4fc69-184">Se um erro for gerado em qualquer cadeia de ação referencial em cascata, um erro é ativado, nenhum gatilho AFTER é acionado naquela cadeia e a operação DELETE ou UPDATE que criou a cadeia é revertida.</span><span class="sxs-lookup"><span data-stu-id="4fc69-184">If an error is generated inside any particular cascading referential action chain, an error is raised, no AFTER triggers are fired in that chain, and the DELETE or UPDATE operation that created the chain is rolled back.</span></span>

-   <span data-ttu-id="4fc69-185">Uma tabela com um gatilho INSTEAD OF não pode ter igualmente uma cláusula REFERENCES especificando uma ação em cascata.</span><span class="sxs-lookup"><span data-stu-id="4fc69-185">A table that has an INSTEAD OF trigger cannot also have a REFERENCES clause that specifies a cascading action.</span></span> <span data-ttu-id="4fc69-186">No entanto, um gatilho AFTER em uma tabela direcionada por uma ação em cascata poderá executar instruções INSERT, UPDATE ou DELETE em outra tabela ou exibição que acionem um gatilho INSTEAD OF definido naquele objeto.</span><span class="sxs-lookup"><span data-stu-id="4fc69-186">However, an AFTER trigger on a table targeted by a cascading action can execute an INSERT, UPDATE, or DELETE statement on another table or view that fires an INSTEAD OF trigger defined on that object.</span></span>

##  <a name="related-tasks"></a><a name="Tasks"></a> <span data-ttu-id="4fc69-187">Tarefas relacionadas</span><span class="sxs-lookup"><span data-stu-id="4fc69-187">Related Tasks</span></span>
 <span data-ttu-id="4fc69-188">A tabela a seguir lista as tarefas comuns associadas às restrições PRIMARY KEY e FOREIGN KEY.</span><span class="sxs-lookup"><span data-stu-id="4fc69-188">The following table lists the common tasks associated with primary key and foreign key constraints.</span></span>

|<span data-ttu-id="4fc69-189">Tarefa</span><span class="sxs-lookup"><span data-stu-id="4fc69-189">Task</span></span>|<span data-ttu-id="4fc69-190">Tópico</span><span class="sxs-lookup"><span data-stu-id="4fc69-190">Topic</span></span>|
|----------|-----------|
|<span data-ttu-id="4fc69-191">Descreve como criar uma chave primária.</span><span class="sxs-lookup"><span data-stu-id="4fc69-191">Describes how to create a primary key.</span></span>|[<span data-ttu-id="4fc69-192">Criar chaves primárias</span><span class="sxs-lookup"><span data-stu-id="4fc69-192">Create Primary Keys</span></span>](../tables/create-primary-keys.md)|
|<span data-ttu-id="4fc69-193">Descreve como excluir uma chave primária.</span><span class="sxs-lookup"><span data-stu-id="4fc69-193">Describes how to delete a primary key.</span></span>|[<span data-ttu-id="4fc69-194">Excluir chaves primárias</span><span class="sxs-lookup"><span data-stu-id="4fc69-194">Delete Primary Keys</span></span>](../tables/delete-primary-keys.md)|
|<span data-ttu-id="4fc69-195">Descreve como modificar uma chave primária.</span><span class="sxs-lookup"><span data-stu-id="4fc69-195">Describes how to modify a primary key.</span></span>|[<span data-ttu-id="4fc69-196">Modificar chaves primárias</span><span class="sxs-lookup"><span data-stu-id="4fc69-196">Modify Primary Keys</span></span>](../tables/modify-primary-keys.md)|
|<span data-ttu-id="4fc69-197">Descreve como criar relações de chave estrangeira</span><span class="sxs-lookup"><span data-stu-id="4fc69-197">Describes how to create foreign key relationships</span></span>|[<span data-ttu-id="4fc69-198">Criar relações de chaves estrangeiras</span><span class="sxs-lookup"><span data-stu-id="4fc69-198">Create Foreign Key Relationships</span></span>](../tables/create-foreign-key-relationships.md)|
|<span data-ttu-id="4fc69-199">Descreve como modificar relações de chave estrangeira.</span><span class="sxs-lookup"><span data-stu-id="4fc69-199">Describes how to modify foreign key relationships.</span></span>|[<span data-ttu-id="4fc69-200">Modificar relações de chave estrangeira</span><span class="sxs-lookup"><span data-stu-id="4fc69-200">Modify Foreign Key Relationships</span></span>](../tables/modify-foreign-key-relationships.md)|
|<span data-ttu-id="4fc69-201">Descreve como excluir relações de chave estrangeira.</span><span class="sxs-lookup"><span data-stu-id="4fc69-201">Describes how to delete foreign key relationships.</span></span>|[<span data-ttu-id="4fc69-202">Excluir relações de chaves estrangeiras</span><span class="sxs-lookup"><span data-stu-id="4fc69-202">Delete Foreign Key Relationships</span></span>](../tables/delete-foreign-key-relationships.md)|
|<span data-ttu-id="4fc69-203">Descreve como exibir propriedades de chave estrangeira.</span><span class="sxs-lookup"><span data-stu-id="4fc69-203">Describes how to view foreign key properties.</span></span>|[<span data-ttu-id="4fc69-204">Exibir propriedades de chave estrangeira</span><span class="sxs-lookup"><span data-stu-id="4fc69-204">View Foreign Key Properties</span></span>](../tables/view-foreign-key-properties.md)|
|<span data-ttu-id="4fc69-205">Descreve como desabilitar restrições de chave estrangeira para replicação.</span><span class="sxs-lookup"><span data-stu-id="4fc69-205">Describes how to disable foreign key constraints for replication.</span></span>|[<span data-ttu-id="4fc69-206">Desabilitar restrições FOREIGN KEY para replicação</span><span class="sxs-lookup"><span data-stu-id="4fc69-206">Disable Foreign Key Constraints for Replication</span></span>](../tables/disable-foreign-key-constraints-for-replication.md)|
|<span data-ttu-id="4fc69-207">Descreve como desabilitar restrições de chave estrangeira durante uma instrução INSERT e UPDATE.</span><span class="sxs-lookup"><span data-stu-id="4fc69-207">Describes how to disable foreign key constraints during an INSERT or UPDATE statement.</span></span>|[<span data-ttu-id="4fc69-208">Desabilitar restrições de chave estrangeira com instruções INSERT e UPDATE</span><span class="sxs-lookup"><span data-stu-id="4fc69-208">Disable Foreign Key Constraints with INSERT and UPDATE Statements</span></span>](../tables/disable-foreign-key-constraints-with-insert-and-update-statements.md)|


