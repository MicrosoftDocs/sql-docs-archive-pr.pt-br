---
title: Índices clusterizados e não clusterizados descritos | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: table-view-index
ms.topic: conceptual
helpviewer_keywords:
- query optimizer [SQL Server], index usage
- index concepts [SQL Server]
ms.assetid: b7d6b323-728d-4763-a987-92e6292f6f7a
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: c9eb51a24000b8af4a466fe4330644a722ad325b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87685130"
---
# <a name="clustered-and-nonclustered-indexes-described"></a><span data-ttu-id="f4cbe-102">Índices clusterizados e não clusterizados descritos</span><span class="sxs-lookup"><span data-stu-id="f4cbe-102">Clustered and Nonclustered Indexes Described</span></span>
  <span data-ttu-id="f4cbe-103">Um índice é uma estrutura em disco associada a uma tabela ou exibição, que agiliza a recuperação das linhas de uma tabela ou exibição.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-103">An index is an on-disk structure associated with a table or view that speeds retrieval of rows from the table or view.</span></span> <span data-ttu-id="f4cbe-104">Um índice contém chaves criadas de uma ou mais colunas da tabela ou exibição.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-104">An index contains keys built from one or more columns in the table or view.</span></span> <span data-ttu-id="f4cbe-105">Essas chaves são armazenadas em uma estrutura (árvore B) que habilita o [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] a localizar a linha ou as linhas associadas aos valores de chave de forma rápida e eficaz.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-105">These keys are stored in a structure (B-tree) that enables [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to find the row or rows associated with the key values quickly and efficiently.</span></span>  
  
 <span data-ttu-id="f4cbe-106">Tabelas ou exibições podem conter os seguintes tipos de índices:</span><span class="sxs-lookup"><span data-stu-id="f4cbe-106">A table or view can contain the following types of indexes:</span></span>  
  
-   <span data-ttu-id="f4cbe-107">Clusterizado</span><span class="sxs-lookup"><span data-stu-id="f4cbe-107">Clustered</span></span>  
  
    -   <span data-ttu-id="f4cbe-108">Os índices clusterizados classificam e armazenam as linhas de dados da tabela ou exibição com base em seus valores de chave.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-108">Clustered indexes sort and store the data rows in the table or view based on their key values.</span></span> <span data-ttu-id="f4cbe-109">Essas são as colunas incluídas na definição do índice.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-109">These are the columns included in the index definition.</span></span> <span data-ttu-id="f4cbe-110">Pode haver apenas um índice clusterizado por tabela, pois as linhas de dados podem ser classificadas somente em uma única ordem.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-110">There can be only one clustered index per table, because the data rows themselves can be sorted in only one order.</span></span>  
  
    -   <span data-ttu-id="f4cbe-111">O único momento em que as linhas de dados de uma tabela são armazenadas na ordem de classificação é quando a tabela contém um índice clusterizado.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-111">The only time the data rows in a table are stored in sorted order is when the table contains a clustered index.</span></span> <span data-ttu-id="f4cbe-112">Se a tabela contiver um índice clusterizado, será denominada tabela clusterizada.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-112">When a table has a clustered index, the table is called a clustered table.</span></span> <span data-ttu-id="f4cbe-113">Se a tabela não possuir nenhum índice clusterizado, suas linhas de dados ficarão armazenadas em uma estrutura não ordenada denominada heap.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-113">If a table has no clustered index, its data rows are stored in an unordered structure called a heap.</span></span>  
  
-   <span data-ttu-id="f4cbe-114">Não clusterizado</span><span class="sxs-lookup"><span data-stu-id="f4cbe-114">Nonclustered</span></span>  
  
    -   <span data-ttu-id="f4cbe-115">Os índices não clusterizados têm uma estrutura distinta das linhas de dados.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-115">Nonclustered indexes have a structure separate from the data rows.</span></span> <span data-ttu-id="f4cbe-116">O índice não clusterizado contém os valores de chave de índice não clusterizado e cada entrada de valor de chave tem um ponteiro para a linha de dados que contém o valor de chave.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-116">A nonclustered index contains the nonclustered index key values and each key value entry has a pointer to the data row that contains the key value.</span></span>  
  
    -   <span data-ttu-id="f4cbe-117">O ponteiro de uma linha de índice em um índice não clusterizado de uma linha de dados é denominado localizador de linhas.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-117">The pointer from an index row in a nonclustered index to a data row is called a row locator.</span></span> <span data-ttu-id="f4cbe-118">A estrutura do localizador de linhas depende de as páginas de dados serem armazenadas em um heap ou em uma tabela clusterizada.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-118">The structure of the row locator depends on whether the data pages are stored in a heap or a clustered table.</span></span> <span data-ttu-id="f4cbe-119">Para o heap, o localizador de linhas é um ponteiro para a linha.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-119">For a heap, a row locator is a pointer to the row.</span></span> <span data-ttu-id="f4cbe-120">Para a tabela clusterizada, o localizador de linhas é a chave de índice clusterizado.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-120">For a clustered table, the row locator is the clustered index key.</span></span>  
  
    -   <span data-ttu-id="f4cbe-121">Você pode adicionar colunas não chave ao nível folha do índice não clusterizado para ignorar os limites de chave de índice existente, as colunas de 900 bytes e 16 colunas de chave e executar consultas completamente abrangidas e indexadas.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-121">You can add nonkey columns to the leaf level of the nonclustered index to by-pass existing index key limits, 900 bytes and 16 key columns, and execute fully covered, indexed, queries.</span></span> <span data-ttu-id="f4cbe-122">Para obter mais informações, consulte [Create Indexes with Included Columns](create-indexes-with-included-columns.md).</span><span class="sxs-lookup"><span data-stu-id="f4cbe-122">For more information, see [Create Indexes with Included Columns](create-indexes-with-included-columns.md).</span></span>  
  
 <span data-ttu-id="f4cbe-123">Tanto os índices clusterizados quanto os não clusterizados podem ser exclusivos.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-123">Both clustered and nonclustered indexes can be unique.</span></span> <span data-ttu-id="f4cbe-124">Isso significa que duas linhas não podem ter o mesmo valor que a chave de índice.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-124">This means no two rows can have the same value for the index key.</span></span> <span data-ttu-id="f4cbe-125">Caso contrário, o índice não será exclusivo e várias linhas poderão compartilhar o mesmo valor de chave.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-125">Otherwise, the index is not unique and multiple rows can share the same key value.</span></span> <span data-ttu-id="f4cbe-126">Para obter mais informações, confira [Criar índices exclusivos](create-unique-indexes.md).</span><span class="sxs-lookup"><span data-stu-id="f4cbe-126">For more information, see [Create Unique Indexes](create-unique-indexes.md).</span></span>  
  
 <span data-ttu-id="f4cbe-127">Os índices são mantidos automaticamente para uma tabela ou exibição sempre que os dados da tabela são modificados.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-127">Indexes are automatically maintained for a table or view whenever the table data is modified.</span></span>  
  
 <span data-ttu-id="f4cbe-128">Veja [Índices](indexes.md) para obter mais tipos de índices de uso geral.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-128">See [Indexes](indexes.md) for additional types of special purpose indexes.</span></span>  
  
## <a name="indexes-and-constraints"></a><span data-ttu-id="f4cbe-129">Índices e restrições</span><span class="sxs-lookup"><span data-stu-id="f4cbe-129">Indexes and Constraints</span></span>  
 <span data-ttu-id="f4cbe-130">Os índices são criados automaticamente quando as restrições PRIMARY KEY e UNIQUE são definidas em colunas de tabelas.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-130">Indexes are automatically created when PRIMARY KEY and UNIQUE constraints are defined on table columns.</span></span> <span data-ttu-id="f4cbe-131">Por exemplo, ao criar uma tabela e identificar determinada coluna como a chave primária, o [!INCLUDE[ssDE](../../includes/ssde-md.md)] cria automaticamente uma restrição PRIMARY KEY e o índice nessa coluna.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-131">For example, when you create a table and identify a particular column to be the primary key, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] automatically creates a PRIMARY KEY constraint and index on that column.</span></span> <span data-ttu-id="f4cbe-132">Para obter mais informações, veja [Criar chaves primárias](../tables/create-primary-keys.md) e [Criar restrições exclusivas](../tables/create-unique-constraints.md).</span><span class="sxs-lookup"><span data-stu-id="f4cbe-132">For more information, see [Create Primary Keys](../tables/create-primary-keys.md) and [Create Unique Constraints](../tables/create-unique-constraints.md).</span></span>  
  
## <a name="how-indexes-are-used-by-the-query-optimizer"></a><span data-ttu-id="f4cbe-133">Como os índices são usados pelo otimizador de consulta</span><span class="sxs-lookup"><span data-stu-id="f4cbe-133">How Indexes Are Used by the Query Optimizer</span></span>  
 <span data-ttu-id="f4cbe-134">Índices bem projetados podem reduzir as operações de E/S de disco e consumir menos recursos de sistema, aprimorando o desempenho das consultas.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-134">Well-designed indexes can reduce disk I/O operations and consume fewer system resources therefore improving query performance.</span></span> <span data-ttu-id="f4cbe-135">Os índices podem ser úteis para uma série de consultas que contêm instruções SELECT, UPDATE, DELETE ou MERGE.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-135">Indexes can be helpful for a variety of queries that contain SELECT, UPDATE, DELETE, or MERGE statements.</span></span> <span data-ttu-id="f4cbe-136">Considere a consulta `SELECT Title, HireDate FROM HumanResources.Employee WHERE EmployeeID = 250` no banco de dados [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="f4cbe-136">Consider the query `SELECT Title, HireDate FROM HumanResources.Employee WHERE EmployeeID = 250` in the [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] database.</span></span> <span data-ttu-id="f4cbe-137">Quando essa consulta é executada, o otimizador de consulta avalia cada método disponível para recuperar os dados e seleciona o mais eficaz.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-137">When this query is executed, the query optimizer evaluates each available method for retrieving the data and selects the most efficient method.</span></span> <span data-ttu-id="f4cbe-138">O método pode ser uma verificação de tabela ou verificação de um ou mais índices, se houver.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-138">The method may be a table scan, or may be scanning one or more indexes if they exist.</span></span>  
  
 <span data-ttu-id="f4cbe-139">Ao executar uma verificação de tabela, o otimizador de consulta lê todas as linhas da tabela e extrai as linhas que atendem os critérios da consulta.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-139">When performing a table scan, the query optimizer reads all the rows in the table, and extracts the rows that meet the criteria of the query.</span></span> <span data-ttu-id="f4cbe-140">Uma verificação de tabela gera várias operações de E/S de disco e pode utilizar muitos recursos.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-140">A table scan generates many disk I/O operations and can be resource intensive.</span></span> <span data-ttu-id="f4cbe-141">No entanto, a verificação de tabela poderá ser o método mais eficaz se, por exemplo, o conjunto de resultados da consulta contiver um alto percentual de linhas da tabela.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-141">However, a table scan could be the most efficient method if, for example, the result set of the query is a high percentage of rows from the table.</span></span>  
  
 <span data-ttu-id="f4cbe-142">Quando o otimizador de consulta utiliza um índice, ele pesquisa as colunas de chave do índice, encontra o local de armazenamento das linhas necessárias à consulta e extrai as linhas que correspondem àquele local.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-142">When the query optimizer uses an index, it searches the index key columns, finds the storage location of the rows needed by the query and extracts the matching rows from that location.</span></span> <span data-ttu-id="f4cbe-143">Em geral, fazer pesquisas no índice é muito mais rápido do que na tabela, porque diferentemente da tabela, o índice contém, com frequência, poucas colunas por linha e as linhas ficam na ordem de classificação.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-143">Generally, searching the index is much faster than searching the table because unlike a table, an index frequently contains very few columns per row and the rows are in sorted order.</span></span>  
  
 <span data-ttu-id="f4cbe-144">Normalmente, o otimizador de consulta seleciona o método mais eficaz ao executar consultas.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-144">The query optimizer typically selects the most efficient method when executing queries.</span></span> <span data-ttu-id="f4cbe-145">No entanto, se não houver índices disponíveis, o otimizador de consulta precisará usar uma verificação de tabela.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-145">However, if no indexes are available, the query optimizer must use a table scan.</span></span> <span data-ttu-id="f4cbe-146">Sua tarefa é criar índices mais adequados ao seu ambiente, para que o otimizador de consulta tenha uma seleção de índices eficientes da qual selecionar.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-146">Your task is to design and create indexes that are best suited to your environment so that the query optimizer has a selection of efficient indexes from which to select.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="f4cbe-147">fornece o [Orientador de Otimização do Mecanismo de Banco de Dados](../performance/database-engine-tuning-advisor.md) para ajudar com a análise de seu ambiente de banco de dados e na seleção de índices apropriados.</span><span class="sxs-lookup"><span data-stu-id="f4cbe-147">provides the [Database Engine Tuning Advisor](../performance/database-engine-tuning-advisor.md) to help with the analysis of your database environment and in the selection of appropriate indexes.</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="f4cbe-148">Related Tasks</span><span class="sxs-lookup"><span data-stu-id="f4cbe-148">Related Tasks</span></span>  
 [<span data-ttu-id="f4cbe-149">Criar índices clusterizados</span><span class="sxs-lookup"><span data-stu-id="f4cbe-149">Create Clustered Indexes</span></span>](create-clustered-indexes.md)  
  
 [<span data-ttu-id="f4cbe-150">Criar índices não clusterizados</span><span class="sxs-lookup"><span data-stu-id="f4cbe-150">Create Nonclustered Indexes</span></span>](create-nonclustered-indexes.md)  
  
  
