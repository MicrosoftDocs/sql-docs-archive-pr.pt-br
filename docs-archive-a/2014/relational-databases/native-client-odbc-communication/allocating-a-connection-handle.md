---
title: Alocando um identificador de conexão | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- ODBC applications, passwords
- ODBC applications, connections
- handles [SQL Server Native Client]
- expiration [SQL Server Native Client]
- passwords [SQL Server], modifying
- SQL Server Native Client ODBC driver, connection handles
- connection handles [SQL Server Native Client]
- modifying passwords
- SQLAllocHandle function
ms.assetid: 471d8a31-199c-4f92-bb10-004fc7733b35
author: rothja
ms.author: jroth
ms.openlocfilehash: d3cf84e541f114d527d9a00cd19bce705a09af30
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87685663"
---
# <a name="allocating-a-connection-handle"></a><span data-ttu-id="ddf63-102">Alocando um identificador de conexão</span><span class="sxs-lookup"><span data-stu-id="ddf63-102">Allocating a Connection Handle</span></span>
  <span data-ttu-id="ddf63-103">Antes de o aplicativo poder se conectar a uma fonte de dados ou driver, ele deve alocar um identificador de conexão.</span><span class="sxs-lookup"><span data-stu-id="ddf63-103">Before the application can connect to a data source or driver, it must allocate a connection handle.</span></span> <span data-ttu-id="ddf63-104">Isso é feito chamando **SQLAllocHandle** com o parâmetro *HandleType* definido como SQL_HANDLE_DBC e *InputHandle* apontando para um identificador de ambiente inicializado.</span><span class="sxs-lookup"><span data-stu-id="ddf63-104">This is done by calling **SQLAllocHandle** with the *HandleType* parameter set to SQL_HANDLE_DBC and *InputHandle* pointing to an initialized environment handle.</span></span>  
  
 <span data-ttu-id="ddf63-105">As características da conexão são controladas pela definição dos atributos de conexão.</span><span class="sxs-lookup"><span data-stu-id="ddf63-105">The characteristics of the connection are controlled by setting connection attributes.</span></span> <span data-ttu-id="ddf63-106">Por exemplo, pelo fato de as transações ocorrerem no nível da conexão, o nível de isolamento da transação é um atributo de conexão.</span><span class="sxs-lookup"><span data-stu-id="ddf63-106">For example, because transactions occur at the connection level, the transaction isolation level is a connection attribute.</span></span> <span data-ttu-id="ddf63-107">De modo semelhante, o tempo limite de logon, ou número de segundos para esperar durante uma tentativa de conexão antes de atingir o tempo limite, é um atributo de conexão.</span><span class="sxs-lookup"><span data-stu-id="ddf63-107">Similarly, the login time-out, or number of seconds to wait while trying to connect before timing out, is a connection attribute.</span></span>  
  
 <span data-ttu-id="ddf63-108">Os atributos de conexão são definidos com [SQLSetConnectAttr](../native-client-odbc-api/sqlsetconnectattr.md), e suas configurações atuais são recuperadas com [SQLGetConnectAttr](../native-client-odbc-api/sqlgetconnectattr.md).</span><span class="sxs-lookup"><span data-stu-id="ddf63-108">Connection attributes are set with [SQLSetConnectAttr](../native-client-odbc-api/sqlsetconnectattr.md), and their current settings are retrieved with [SQLGetConnectAttr](../native-client-odbc-api/sqlgetconnectattr.md).</span></span> <span data-ttu-id="ddf63-109">Se **SQLSetConnectAttr** for chamado antes da tentativa de conexão, o Gerenciador de driver ODBC armazenará os atributos em sua estrutura de conexão e os definirá no driver como parte do processo de conexão.</span><span class="sxs-lookup"><span data-stu-id="ddf63-109">If **SQLSetConnectAttr** is called before a connection is attempted, the ODBC Driver Manager stores the attributes in its connection structure and sets them in the driver as part of the connection process.</span></span> <span data-ttu-id="ddf63-110">Alguns atributos de conexão devem ser definidos antes da tentativa de conexão do aplicativo; outros podem ser definidos depois de estabelecida a conexão.</span><span class="sxs-lookup"><span data-stu-id="ddf63-110">Some connection attributes must be set before the application attempts to connect; others can be set after the connection has completed.</span></span> <span data-ttu-id="ddf63-111">Por exemplo, SQL_ATTR_ODBC_CURSORS deve ser definido antes de se estabelecer a conexão, mas SQL_ATTR_AUTOCOMMIT pode ser definido após o estabelecimento da conexão.</span><span class="sxs-lookup"><span data-stu-id="ddf63-111">For example, SQL_ATTR_ODBC_CURSORS must be set before a connection is made, but SQL_ATTR_AUTOCOMMIT can be set after connecting.</span></span>  
  
 <span data-ttu-id="ddf63-112">Os aplicativos executados no [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] versão 7.0 ou posterior, às vezes, podem melhorar seu desempenho com a redefinição do tamanho do pacote de rede de protocolo TDS (tabular data stream).</span><span class="sxs-lookup"><span data-stu-id="ddf63-112">Applications running against [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] version 7.0 or later can sometimes improve their performance by resetting the tabular data stream (TDS) network packet size.</span></span> <span data-ttu-id="ddf63-113">O tamanho de pacote padrão é definido no servidor como 4 KB.</span><span class="sxs-lookup"><span data-stu-id="ddf63-113">The default packet size is set at the server, at 4 KB.</span></span> <span data-ttu-id="ddf63-114">Um tamanho de pacote de 4 KB a 8 KB geralmente oferece um desempenho melhor.</span><span class="sxs-lookup"><span data-stu-id="ddf63-114">A packet size of 4 KB to 8 KB generally gives the best performance.</span></span> <span data-ttu-id="ddf63-115">Se, na prática, constatar-se que o desempenho melhora com um tamanho de pacote diferente, o aplicativo poderá redefinir o tamanho do pacote.</span><span class="sxs-lookup"><span data-stu-id="ddf63-115">If testing shows that it performs better with a different packet size, the application can reset the packet size.</span></span> <span data-ttu-id="ddf63-116">Os aplicativos ODBC podem fazer isso antes de se conectar chamando **SQLSetConnectAttr** com a opção SQL_ATTR_PACKET_SIZE.</span><span class="sxs-lookup"><span data-stu-id="ddf63-116">ODBC applications can do this before connecting by calling **SQLSetConnectAttr** with the SQL_ATTR_PACKET_SIZE option.</span></span> <span data-ttu-id="ddf63-117">Alguns aplicativos apresentam um desempenho melhor com um tamanho de pacote maior, mas, em geral, os aprimoramentos de desempenho são mínimos em se tratando de tamanhos de pacote maiores que 8 KB.</span><span class="sxs-lookup"><span data-stu-id="ddf63-117">Some applications perform better with a larger packet size, but performance improvements are generally minimal for packet sizes larger than 8 KB.</span></span>  
  
 <span data-ttu-id="ddf63-118">O [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] driver ODBC do Native Client tem vários atributos de conexão estendidos que um aplicativo pode usar para aumentar sua funcionalidade.</span><span class="sxs-lookup"><span data-stu-id="ddf63-118">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver has a number of extended connection attributes that an application can use to increase its functionality.</span></span> <span data-ttu-id="ddf63-119">Alguns desses atributos controlam as mesmas opções que podem ser especificadas em fontes de dados e usadas para substituir qualquer opção definida em uma fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="ddf63-119">Some of these attributes control the same options that can be specified in data sources and used to override whatever option is set in a data source.</span></span> <span data-ttu-id="ddf63-120">Por exemplo, se um aplicativo usa identificadores entre aspas, ele pode definir o atributo específico de driver SQL_COPT_SS_QUOTED_IDENT como SQL_QI_ON para garantir que essa opção seja sempre definida independentemente da definição de qualquer fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="ddf63-120">For example, if an application uses quoted identifiers, it can set the driver-specific attribute SQL_COPT_SS_QUOTED_IDENT to SQL_QI_ON to ensure this option is always set regardless of the setting in any data source.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ddf63-121">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="ddf63-121">See Also</span></span>  
 [<span data-ttu-id="ddf63-122">Comunicando-se com SQL Server &#40;ODBC&#41;</span><span class="sxs-lookup"><span data-stu-id="ddf63-122">Communicating with SQL Server &#40;ODBC&#41;</span></span>](communicating-with-sql-server-odbc.md)  
  
  
