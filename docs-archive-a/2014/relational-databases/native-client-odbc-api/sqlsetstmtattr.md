---
title: SQLSetStmtAttr | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
topic_type:
- apiref
helpviewer_keywords:
- SQLSetStmtAttr function
ms.assetid: 799c80fd-c561-4912-8562-9229076dfd19
author: rothja
ms.author: jroth
ms.openlocfilehash: 725a7917f817af44f17f8da06d484171cbe9a25d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87573966"
---
# <a name="sqlsetstmtattr"></a><span data-ttu-id="d1592-102">SQLSetStmtAttr</span><span class="sxs-lookup"><span data-stu-id="d1592-102">SQLSetStmtAttr</span></span>
  <span data-ttu-id="d1592-103">O driver ODBC do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client não dá suporte ao modelo de cursor misto (conjunto de chaves/dinâmico).</span><span class="sxs-lookup"><span data-stu-id="d1592-103">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver does not support the mixed (keyset/dynamic) cursor model.</span></span> <span data-ttu-id="d1592-104">As tentativas de definir o tamanho do conjunto de chaves usando SQL_ATTR_KEYSET_SIZE falhará se o valor definido não for igual a 0.</span><span class="sxs-lookup"><span data-stu-id="d1592-104">Attempts to set the keyset size using SQL_ATTR_KEYSET_SIZE will fail if the value set is not equal to 0.</span></span>  
  
 <span data-ttu-id="d1592-105">O aplicativo define SQL_ATTR_ROW_ARRAY_SIZE em todas as instruções para declarar o número de linhas retornadas em uma chamada de função **SQLFetch** ou [SQLFetchScroll](sqlfetchscroll.md) .</span><span class="sxs-lookup"><span data-stu-id="d1592-105">The application sets SQL_ATTR_ROW_ARRAY_SIZE on all statements to declare the number of rows returned on a **SQLFetch** or [SQLFetchScroll](sqlfetchscroll.md) function call.</span></span> <span data-ttu-id="d1592-106">Em instruções que indicam um cursor de servidor, o driver usa SQL_ATTR_ROW_ARRAY_SIZE para determinar o tamanho do bloco de linhas que o servidor gera para satisfazer uma solicitação de busca do cursor.</span><span class="sxs-lookup"><span data-stu-id="d1592-106">On statements indicating a server cursor, the driver uses SQL_ATTR_ROW_ARRAY_SIZE to determine the size of the block of rows the server generates to satisfy a fetch request from the cursor.</span></span> <span data-ttu-id="d1592-107">No tamanho do bloco de um cursor dinâmico, a ordenação e a associação de linhas serão fixas se o nível de isolamento da transação for suficiente para assegurar leituras repetidas de transações confirmadas.</span><span class="sxs-lookup"><span data-stu-id="d1592-107">Within the block size of a dynamic cursor, row membership and ordering are fixed if the transaction isolation level is sufficient to ensure repeatable reads of committed transactions.</span></span> <span data-ttu-id="d1592-108">O cursor é completamente dinâmico fora do bloco indicado por esse valor.</span><span class="sxs-lookup"><span data-stu-id="d1592-108">The cursor is completely dynamic outside of the block indicated by this value.</span></span> <span data-ttu-id="d1592-109">O tamanho do bloco de cursor de servidor é completamente dinâmico e pode ser alterado a qualquer momento do processamento de busca.</span><span class="sxs-lookup"><span data-stu-id="d1592-109">Server cursor block size is completely dynamic and can be changed at any point in fetch processing.</span></span>  
  
## <a name="sqlsetstmtattr-and-table-valued-parameters"></a><span data-ttu-id="d1592-110">SQLGetStmtAttr e parâmetros com valor de tabela</span><span class="sxs-lookup"><span data-stu-id="d1592-110">SQLSetStmtAttr and Table-Valued Parameters</span></span>  
 <span data-ttu-id="d1592-111">SQLSetStmtAttr pode ser usado para definir SQL_SOPT_SS_PARAM_FOCUS no descritor de parâmetro do aplicativo (APD) antes de acessar campos de descritor para colunas de parâmetro com valor de tabela.</span><span class="sxs-lookup"><span data-stu-id="d1592-111">SQLSetStmtAttr can be used to set SQL_SOPT_SS_PARAM_FOCUS in the application parameter descriptor (APD) before accessing descriptor fields for table-valued parameter columns.</span></span>  
  
 <span data-ttu-id="d1592-112">Se for feita uma tentativa de definir SQL_SOPT_SS_PARAM_FOCUS para o ordinal de um parâmetro que não seja um parâmetro com valor de tabela, SQLSetStmtAttr retornará SQL_ERROR e um registro de diagnóstico será criado com SQLSTATE = HY024 e a mensagem "valor de atributo inválido".</span><span class="sxs-lookup"><span data-stu-id="d1592-112">If an attempt is made to set SQL_SOPT_SS_PARAM_FOCUS to the ordinal of a parameter that is not a table-valued parameter, SQLSetStmtAttr returns SQL_ERROR and a diagnostic record is created with SQLSTATE = HY024 and the message "Invalid attribute value".</span></span> <span data-ttu-id="d1592-113">SQL_SOPT_SS_PARAM_FOCUS não é alterado quando SQL_ERROR é retornado.</span><span class="sxs-lookup"><span data-stu-id="d1592-113">SQL_SOPT_SS_PARAM_FOCUS is not changed when SQL_ERROR is returned.</span></span>  
  
 <span data-ttu-id="d1592-114">A definição de SQL_SOPT_SS_PARAM_FOCUS como 0 restaura o acesso a registros de descritor para parâmetros.</span><span class="sxs-lookup"><span data-stu-id="d1592-114">Setting SQL_SOPT_SS_PARAM_FOCUS to 0 restores access to descriptor records for parameters.</span></span>  
  
 <span data-ttu-id="d1592-115">SQLSetStmtAttr também pode ser usado para definir SQL_SOPT_SS_NAME_SCOPE.</span><span class="sxs-lookup"><span data-stu-id="d1592-115">SQLSetStmtAttr can also be used to set SQL_SOPT_SS_NAME_SCOPE.</span></span> <span data-ttu-id="d1592-116">Para obter mais informações, consulte a seção SQL_SOPT_SS_NAME_SCOPE posteriormente neste tópico.</span><span class="sxs-lookup"><span data-stu-id="d1592-116">For more information, see the SQL_SOPT_SS_NAME_SCOPE section, later in this topic.</span></span>  
  
 <span data-ttu-id="d1592-117">Para obter mais informações, consulte [metadados de parâmetro com valor de tabela para instruções preparadas](../native-client-odbc-table-valued-parameters/table-valued-parameter-metadata-for-prepared-statements.md).</span><span class="sxs-lookup"><span data-stu-id="d1592-117">For more information, see [Table-Valued Parameter Metadata for Prepared Statements](../native-client-odbc-table-valued-parameters/table-valued-parameter-metadata-for-prepared-statements.md).</span></span>  
  
 <span data-ttu-id="d1592-118">Para obter mais informações sobre parâmetros com valor de tabela, consulte [parâmetros com valor de tabela &#40;&#41;ODBC ](../native-client-odbc-table-valued-parameters/table-valued-parameters-odbc.md).</span><span class="sxs-lookup"><span data-stu-id="d1592-118">For more information about table-valued parameters, see [Table-Valued Parameters &#40;ODBC&#41;](../native-client-odbc-table-valued-parameters/table-valued-parameters-odbc.md).</span></span>  
  
## <a name="sqlsetstmtattr-support-for-sparse-columns"></a><span data-ttu-id="d1592-119">SQLSetStmtAttr Suporte para colunas esparsas</span><span class="sxs-lookup"><span data-stu-id="d1592-119">SQLSetStmtAttr Support for Sparse Columns</span></span>  
 <span data-ttu-id="d1592-120">SQLSetStmtAttr pode ser usado para definir SQL_SOPT_SS_NAME_SCOPE.</span><span class="sxs-lookup"><span data-stu-id="d1592-120">SQLSetStmtAttr can be used to set SQL_SOPT_SS_NAME_SCOPE.</span></span> <span data-ttu-id="d1592-121">Para obter mais informações, consulte a seção SQL_SOPT_SS_NAME_SCOPE, mais adiante neste tópico. Para obter mais informações sobre colunas esparsas, consulte [suporte a colunas esparsas &#40;&#41;ODBC ](../native-client/odbc/sparse-columns-support-odbc.md).</span><span class="sxs-lookup"><span data-stu-id="d1592-121">For more information, see the SQL_SOPT_SS_NAME_SCOPE section, later in this topic.For more information about sparse columns, see [Sparse Columns Support &#40;ODBC&#41;](../native-client/odbc/sparse-columns-support-odbc.md).</span></span>  
  
## <a name="statement-attributes"></a><span data-ttu-id="d1592-122">Atributos de instrução</span><span class="sxs-lookup"><span data-stu-id="d1592-122">Statement Attributes</span></span>  
 <span data-ttu-id="d1592-123">O driver ODBC do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client também dá suporte aos seguintes atributos de instrução específicos do driver.</span><span class="sxs-lookup"><span data-stu-id="d1592-123">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver also supports the following driver-specific statement attributes.</span></span>  
  
### <a name="sql_sopt_ss_cursor_options"></a><span data-ttu-id="d1592-124">SQL_SOPT_SS_CURSOR_OPTIONS</span><span class="sxs-lookup"><span data-stu-id="d1592-124">SQL_SOPT_SS_CURSOR_OPTIONS</span></span>  
 <span data-ttu-id="d1592-125">O atributo SQL_SOPT_SS_CURSOR especifica se o driver usará opções de desempenho específicas do driver em cursores.</span><span class="sxs-lookup"><span data-stu-id="d1592-125">The SQL_SOPT_SS_CURSOR attribute specifies whether the driver will use driver-specific performance options on cursors.</span></span> <span data-ttu-id="d1592-126">[SQLGetData](sqlgetdata.md) não é permitido quando essas opções são definidas.</span><span class="sxs-lookup"><span data-stu-id="d1592-126">[SQLGetData](sqlgetdata.md) is not allowed when these options are set.</span></span> <span data-ttu-id="d1592-127">A configuração padrão é SQL_CO_OFF.</span><span class="sxs-lookup"><span data-stu-id="d1592-127">The default setting is SQL_CO_OFF.</span></span> <span data-ttu-id="d1592-128">O valor *ValuePtr* é do tipo SQLLEN.</span><span class="sxs-lookup"><span data-stu-id="d1592-128">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="d1592-129">Valor de *ValuePtr*</span><span class="sxs-lookup"><span data-stu-id="d1592-129">*ValuePtr* value</span></span>|<span data-ttu-id="d1592-130">Descrição</span><span class="sxs-lookup"><span data-stu-id="d1592-130">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="d1592-131">SQL_CO_OFF</span><span class="sxs-lookup"><span data-stu-id="d1592-131">SQL_CO_OFF</span></span>|<span data-ttu-id="d1592-132">Padrão.</span><span class="sxs-lookup"><span data-stu-id="d1592-132">Default.</span></span> <span data-ttu-id="d1592-133">Desabilita somente encaminhamento rápido, cursores somente leitura e busca rápida, habilita **SQLGetData** em cursores somente de avanço e somente leitura.</span><span class="sxs-lookup"><span data-stu-id="d1592-133">Disables fast forward-only, read-only cursors and autofetch, enables **SQLGetData** on forward-only, read-only cursors.</span></span> <span data-ttu-id="d1592-134">Quando SQL_SOPT_SS_CURSOR_OPTIONS for definido como SQL_CO_OFF, o tipo de cursor não será alterado.</span><span class="sxs-lookup"><span data-stu-id="d1592-134">When SQL_SOPT_SS_CURSOR_OPTIONS is set to SQL_CO_OFF, the cursor type will not change.</span></span> <span data-ttu-id="d1592-135">Ou seja, o cursor somente de avanço rápido permanecerá um cursor somente de avanço rápido.</span><span class="sxs-lookup"><span data-stu-id="d1592-135">That is, fast forward-only cursor will remain a fast forward-only cursor.</span></span> <span data-ttu-id="d1592-136">Para alterar o tipo de cursor, o aplicativo agora deve definir um tipo de cursor diferente usando `SQLSetStmtAttr` /SQL_ATTR_CURSOR_TYPE.</span><span class="sxs-lookup"><span data-stu-id="d1592-136">To change the cursor type, the application must now set a different cursor type using `SQLSetStmtAttr`/SQL_ATTR_CURSOR_TYPE.</span></span>|  
|<span data-ttu-id="d1592-137">SQL_CO_FFO</span><span class="sxs-lookup"><span data-stu-id="d1592-137">SQL_CO_FFO</span></span>|<span data-ttu-id="d1592-138">Permite somente encaminhamento rápido, cursores somente leitura, desabilita **SQLGetData** em cursores somente de avanço e somente leitura.</span><span class="sxs-lookup"><span data-stu-id="d1592-138">Enables fast forward-only, read-only cursors, disables **SQLGetData** on forward-only, read-only cursors.</span></span>|  
|<span data-ttu-id="d1592-139">SQL_CO_AF</span><span class="sxs-lookup"><span data-stu-id="d1592-139">SQL_CO_AF</span></span>|<span data-ttu-id="d1592-140">Habilita a opção autofetch em qualquer tipo de cursor.</span><span class="sxs-lookup"><span data-stu-id="d1592-140">Enables the autofetch option on any cursor type.</span></span> <span data-ttu-id="d1592-141">Quando essa opção é definida para um identificador de instrução, **SQLExecute** ou **SQLExecDirect** gerará um **SQLFetchScroll** implícito (SQL_FIRST).</span><span class="sxs-lookup"><span data-stu-id="d1592-141">When this option is set for a statement handle, **SQLExecute** or **SQLExecDirect** will generate an implicit **SQLFetchScroll** (SQL_FIRST).</span></span> <span data-ttu-id="d1592-142">O cursor é aberto e o primeiro lote de linhas é retornado em uma única viagem de ida e volta ao servidor.</span><span class="sxs-lookup"><span data-stu-id="d1592-142">The cursor is opened and the first batch of rows is returned in a single roundtrip to the server.</span></span>|  
|<span data-ttu-id="d1592-143">SQL_CO_FFO_AF</span><span class="sxs-lookup"><span data-stu-id="d1592-143">SQL_CO_FFO_AF</span></span>|<span data-ttu-id="d1592-144">Habilita cursores somente de avanço rápido com a opção autofetch.</span><span class="sxs-lookup"><span data-stu-id="d1592-144">Enables fast forward-only cursors with the autofetch option.</span></span> <span data-ttu-id="d1592-145">É igual a se SQL_CO_AF e SQL_CO_FFO forem especificados.</span><span class="sxs-lookup"><span data-stu-id="d1592-145">It is the same as if both SQL_CO_AF and SQL_CO_FFO are specified.</span></span>|  
  
 <span data-ttu-id="d1592-146">Quando essas opções são definidas, o servidor fecha o cursor automaticamente ao detectar que a última linha foi buscada.</span><span class="sxs-lookup"><span data-stu-id="d1592-146">When these options are set, the server closes the cursor automatically when it detects that the last row has been fetched.</span></span> <span data-ttu-id="d1592-147">O aplicativo ainda deve chamar [SQLFreeStmt](sqlfreestmt.md) (SQL_CLOSE) ou [SQLCloseCursor](sqlclosecursor.md), mas o driver não precisa enviar a notificação de fechamento para o servidor.</span><span class="sxs-lookup"><span data-stu-id="d1592-147">The application must still call [SQLFreeStmt](sqlfreestmt.md) (SQL_CLOSE) or [SQLCloseCursor](sqlclosecursor.md), but the driver does not have to send the close notification to the server.</span></span>  
  
 <span data-ttu-id="d1592-148">Se a lista de seleção contiver uma coluna **Text**, **ntext**ou **Image** , o cursor de somente avanço rápido será convertido em um cursor dinâmico e **SQLGetData** será permitido.</span><span class="sxs-lookup"><span data-stu-id="d1592-148">If the select list contains a **text**, **ntext**, or **image** column, the fast forward-only cursor is converted to a dynamic cursor and **SQLGetData** is allowed.</span></span>  
  
### <a name="sql_sopt_ss_defer_prepare"></a><span data-ttu-id="d1592-149">SQL_SOPT_SS_DEFER_PREPARE</span><span class="sxs-lookup"><span data-stu-id="d1592-149">SQL_SOPT_SS_DEFER_PREPARE</span></span>  
 <span data-ttu-id="d1592-150">O atributo SQL_SOPT_SS_DEFER_PREPARE determina se a instrução é preparada imediatamente ou adiada até que **SQLExecute**, [SQLDescribeCol](sqldescribecol.md) ou [SQLDescribeParam](sqldescribeparam.md) seja executado.</span><span class="sxs-lookup"><span data-stu-id="d1592-150">The SQL_SOPT_SS_DEFER_PREPARE attribute determines whether the statement is prepared immediately or deferred until **SQLExecute**, [SQLDescribeCol](sqldescribecol.md) or [SQLDescribeParam](sqldescribeparam.md) is executed.</span></span> <span data-ttu-id="d1592-151">No [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 7.0 e anteriores, essa propriedade é ignorada (sem adiamento da preparação).</span><span class="sxs-lookup"><span data-stu-id="d1592-151">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 7.0 and earlier, this property is ignored (no deferred prepare).</span></span> <span data-ttu-id="d1592-152">O valor *ValuePtr* é do tipo SQLLEN.</span><span class="sxs-lookup"><span data-stu-id="d1592-152">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="d1592-153">Valor de *ValuePtr*</span><span class="sxs-lookup"><span data-stu-id="d1592-153">*ValuePtr* value</span></span>|<span data-ttu-id="d1592-154">Descrição</span><span class="sxs-lookup"><span data-stu-id="d1592-154">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="d1592-155">SQL_DP_ON</span><span class="sxs-lookup"><span data-stu-id="d1592-155">SQL_DP_ON</span></span>|<span data-ttu-id="d1592-156">Padrão.</span><span class="sxs-lookup"><span data-stu-id="d1592-156">Default.</span></span> <span data-ttu-id="d1592-157">Depois de chamar a [função SQLPrepare](https://go.microsoft.com/fwlink/?LinkId=59360), a preparação da instrução é adiada até que **SQLExecute** seja chamado ou a operação de metapropriedade (**SQLDescribeCol** ou **SQLDescribeParam**) seja executada.</span><span class="sxs-lookup"><span data-stu-id="d1592-157">After calling [SQLPrepare Function](https://go.microsoft.com/fwlink/?LinkId=59360), the statement preparation is deferred until **SQLExecute** is called or metaproperty operation (**SQLDescribeCol** or **SQLDescribeParam**) is executed.</span></span>|  
|<span data-ttu-id="d1592-158">SQL_DP_OFF</span><span class="sxs-lookup"><span data-stu-id="d1592-158">SQL_DP_OFF</span></span>|<span data-ttu-id="d1592-159">A instrução é preparada assim que **SQLPrepare** é executado.</span><span class="sxs-lookup"><span data-stu-id="d1592-159">The statement is prepared as soon as **SQLPrepare** is executed.</span></span>|  
  
### <a name="sql_sopt_ss_regionalize"></a><span data-ttu-id="d1592-160">SQL_SOPT_SS_REGIONALIZE</span><span class="sxs-lookup"><span data-stu-id="d1592-160">SQL_SOPT_SS_REGIONALIZE</span></span>  
 <span data-ttu-id="d1592-161">O atributo SQL_SOPT_SS_REGIONALIZE é usado para determinar a conversão de dados no nível de instrução.</span><span class="sxs-lookup"><span data-stu-id="d1592-161">The SQL_SOPT_SS_REGIONALIZE attribute is used to determine data conversion at the statement level.</span></span> <span data-ttu-id="d1592-162">O atributo faz o driver respeitar a configuração de localidade do cliente ao converter valores de data, hora, e moeda em cadeias de caracteres.</span><span class="sxs-lookup"><span data-stu-id="d1592-162">The attribute causes the driver to respect the client locale setting when converting date, time, and currency values to character strings.</span></span> <span data-ttu-id="d1592-163">A conversão ocorre somente de tipos de dados nativos do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] em cadeias de caracteres.</span><span class="sxs-lookup"><span data-stu-id="d1592-163">The conversion is from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] native data types to character strings only.</span></span>  
  
 <span data-ttu-id="d1592-164">O valor *ValuePtr* é do tipo SQLLEN.</span><span class="sxs-lookup"><span data-stu-id="d1592-164">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="d1592-165">Valor de *ValuePtr*</span><span class="sxs-lookup"><span data-stu-id="d1592-165">*ValuePtr* value</span></span>|<span data-ttu-id="d1592-166">Descrição</span><span class="sxs-lookup"><span data-stu-id="d1592-166">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="d1592-167">SQL_RE_OFF</span><span class="sxs-lookup"><span data-stu-id="d1592-167">SQL_RE_OFF</span></span>|<span data-ttu-id="d1592-168">Padrão.</span><span class="sxs-lookup"><span data-stu-id="d1592-168">Default.</span></span> <span data-ttu-id="d1592-169">O driver não converte dados de data, hora e moeda em dados de cadeia de caracteres usando a configuração de localidade do cliente.</span><span class="sxs-lookup"><span data-stu-id="d1592-169">The driver does not convert date, time, and currency data to character string data using the client locale setting.</span></span>|  
|<span data-ttu-id="d1592-170">SQL_RE_ON</span><span class="sxs-lookup"><span data-stu-id="d1592-170">SQL_RE_ON</span></span>|<span data-ttu-id="d1592-171">O driver usa a configuração de localidade do cliente ao converter dados de data, hora e moeda em dados de cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="d1592-171">The driver uses the client locale setting when converting date, time, and currency data to character string data.</span></span>|  
  
 <span data-ttu-id="d1592-172">As configurações regionais de conversão se aplicam a tipos de dados de moeda, numéricos e de data e hora.</span><span class="sxs-lookup"><span data-stu-id="d1592-172">Regional conversion settings apply to currency, numeric, date, and time data types.</span></span> <span data-ttu-id="d1592-173">A configuração da conversão é aplicável somente a conversões de saída quando valores de moeda, numéricos, de data ou de hora são convertidos em cadeias de caracteres.</span><span class="sxs-lookup"><span data-stu-id="d1592-173">The conversion setting is only applicable to output conversions when currency, numeric, date, or time values are converted to character strings.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="d1592-174">Quando a opção de instrução SQL_SOPT_SS_REGIONALIZE está ativa, o driver usa as configurações do Registro de localidade do usuário atual.</span><span class="sxs-lookup"><span data-stu-id="d1592-174">When the statement option SQL_SOPT_SS_REGIONALIZE is on, the driver uses the locale registry settings for the current user.</span></span> <span data-ttu-id="d1592-175">O driver não honrará a localidade do thread atual se o aplicativo o definir, por exemplo, chamando **SetThreadLocale**.</span><span class="sxs-lookup"><span data-stu-id="d1592-175">The driver does not honor the current thread's locale if the application sets it by, for example, calling **SetThreadLocale**.</span></span>  
  
 <span data-ttu-id="d1592-176">A alteração do comportamento regional de uma fonte de dados pode fazer o aplicativo falhar.</span><span class="sxs-lookup"><span data-stu-id="d1592-176">Altering the regional behavior of a data source can cause application failure.</span></span> <span data-ttu-id="d1592-177">Um aplicativo que analisa cadeias de caracteres de data e espera que cadeias de caracteres de data sejam exibidas conforme definido pelo ODBC poderia ser afetado adversamente pela alteração desse valor.</span><span class="sxs-lookup"><span data-stu-id="d1592-177">An application that parses date strings and expects date strings to appear as defined by ODBC, could be adversely affected by altering this value.</span></span>  
  
### <a name="sql_sopt_ss_textptr_logging"></a><span data-ttu-id="d1592-178">SQL_SOPT_SS_TEXTPTR_LOGGING</span><span class="sxs-lookup"><span data-stu-id="d1592-178">SQL_SOPT_SS_TEXTPTR_LOGGING</span></span>  
 <span data-ttu-id="d1592-179">O atributo SQL_SOPT_SS_TEXTPTR_LOGGING alterna o log de operações em colunas que contêm dados de **texto** ou **imagem** .</span><span class="sxs-lookup"><span data-stu-id="d1592-179">The SQL_SOPT_SS_TEXTPTR_LOGGING attribute toggles logging of operations on columns containing **text** or **image** data.</span></span> <span data-ttu-id="d1592-180">O valor *ValuePtr* é do tipo SQLLEN.</span><span class="sxs-lookup"><span data-stu-id="d1592-180">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="d1592-181">Valor de *ValuePtr*</span><span class="sxs-lookup"><span data-stu-id="d1592-181">*ValuePtr* value</span></span>|<span data-ttu-id="d1592-182">Descrição</span><span class="sxs-lookup"><span data-stu-id="d1592-182">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="d1592-183">SQL_TL_OFF</span><span class="sxs-lookup"><span data-stu-id="d1592-183">SQL_TL_OFF</span></span>|<span data-ttu-id="d1592-184">Desabilita o registro em log de operações executadas em dados de **texto** e **imagem** .</span><span class="sxs-lookup"><span data-stu-id="d1592-184">Disables logging of operations performed on **text** and **image** data.</span></span>|  
|<span data-ttu-id="d1592-185">SQL_TL_ON</span><span class="sxs-lookup"><span data-stu-id="d1592-185">SQL_TL_ON</span></span>|<span data-ttu-id="d1592-186">Padrão.</span><span class="sxs-lookup"><span data-stu-id="d1592-186">Default.</span></span> <span data-ttu-id="d1592-187">Habilita o registro em log de operações executadas em dados de **texto** e **imagem** .</span><span class="sxs-lookup"><span data-stu-id="d1592-187">Enables logging of operations performed on **text** and **image** data.</span></span>|  
  
### <a name="sql_sopt_ss_hidden_columns"></a><span data-ttu-id="d1592-188">SQL_SOPT_SS_HIDDEN_COLUMNS</span><span class="sxs-lookup"><span data-stu-id="d1592-188">SQL_SOPT_SS_HIDDEN_COLUMNS</span></span>  
 <span data-ttu-id="d1592-189">O atributo SQL_SOPT_SS_HIDDEN_COLUMNS expõe, no conjunto de resultados, colunas ocultas em uma instrução [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] SELECT FOR BROWSE.</span><span class="sxs-lookup"><span data-stu-id="d1592-189">The SQL_SOPT_SS_HIDDEN_COLUMNS attribute exposes, in the result set, columns hidden in a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] SELECT FOR BROWSE statement.</span></span> <span data-ttu-id="d1592-190">Por padrão, o driver não expõe estas colunas.</span><span class="sxs-lookup"><span data-stu-id="d1592-190">The driver does not expose these columns by default.</span></span> <span data-ttu-id="d1592-191">O valor *ValuePtr* é do tipo SQLLEN.</span><span class="sxs-lookup"><span data-stu-id="d1592-191">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="d1592-192">Valor de *ValuePtr*</span><span class="sxs-lookup"><span data-stu-id="d1592-192">*ValuePtr* value</span></span>|<span data-ttu-id="d1592-193">Descrição</span><span class="sxs-lookup"><span data-stu-id="d1592-193">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="d1592-194">SQL_HC_OFF</span><span class="sxs-lookup"><span data-stu-id="d1592-194">SQL_HC_OFF</span></span>|<span data-ttu-id="d1592-195">Padrão.</span><span class="sxs-lookup"><span data-stu-id="d1592-195">Default.</span></span> <span data-ttu-id="d1592-196">As colunas FOR BROWSE são ocultadas do conjunto de resultados.</span><span class="sxs-lookup"><span data-stu-id="d1592-196">FOR BROWSE columns are hidden from the result set.</span></span>|  
|<span data-ttu-id="d1592-197">SQL_HC_ON</span><span class="sxs-lookup"><span data-stu-id="d1592-197">SQL_HC_ON</span></span>|<span data-ttu-id="d1592-198">Expõe colunas FOR BROWSE.</span><span class="sxs-lookup"><span data-stu-id="d1592-198">Exposes FOR BROWSE columns.</span></span>|  
  
### <a name="sql_sopt_ss_querynotification_msgtext"></a><span data-ttu-id="d1592-199">SQL_SOPT_SS_QUERYNOTIFICATION_MSGTEXT</span><span class="sxs-lookup"><span data-stu-id="d1592-199">SQL_SOPT_SS_QUERYNOTIFICATION_MSGTEXT</span></span>  
 <span data-ttu-id="d1592-200">O atributo SQL_SOPT_SS_QUERYNOTIFICATION_MSGTEXT retorna o texto de mensagem para a solicitação de notificação de consulta.</span><span class="sxs-lookup"><span data-stu-id="d1592-200">The SQL_SOPT_SS_QUERYNOTIFICATION_MSGTEXT attribute returns the message text for the query notification request.</span></span>  
  
### <a name="sql_sopt_ss_querynotification_options"></a><span data-ttu-id="d1592-201">SQL_SOPT_SS_QUERYNOTIFICATION_OPTIONS</span><span class="sxs-lookup"><span data-stu-id="d1592-201">SQL_SOPT_SS_QUERYNOTIFICATION_OPTIONS</span></span>  
 <span data-ttu-id="d1592-202">O atributo SQL_SOPT_SS_QUERYNOTIFICATION_OPTIONS especifica as opções usadas para a solicitação de notificação de consulta.</span><span class="sxs-lookup"><span data-stu-id="d1592-202">The SQL_SOPT_SS_QUERYNOTIFICATION_OPTIONS attribute specifies the options used for the query notification request.</span></span> <span data-ttu-id="d1592-203">Elas são especificadas em uma cadeia de caracteres com a sintaxe `name=value` conforme especificado a seguir.</span><span class="sxs-lookup"><span data-stu-id="d1592-203">These are specified in a string with `name=value` syntax as specified below.</span></span> <span data-ttu-id="d1592-204">O aplicativo é responsável por criar o serviço e ler as notificações da fila.</span><span class="sxs-lookup"><span data-stu-id="d1592-204">The application is responsible for creating the service and reading notifications off of the queue.</span></span>  
  
 <span data-ttu-id="d1592-205">A sintaxe da cadeia de caracteres das opções de notificação de consulta é:</span><span class="sxs-lookup"><span data-stu-id="d1592-205">The syntax of the query notifications options string is:</span></span>  
  
 `service=<service-name>[;(local database=<database>|broker instance=<broker instance>)]`  
  
 <span data-ttu-id="d1592-206">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="d1592-206">For example:</span></span>  
  
 `service=mySSBService;local database=mydb`  
  
### <a name="sql_sopt_ss_querynotification_timeout"></a><span data-ttu-id="d1592-207">SQL_SOPT_SS_QUERYNOTIFICATION_TIMEOUT</span><span class="sxs-lookup"><span data-stu-id="d1592-207">SQL_SOPT_SS_QUERYNOTIFICATION_TIMEOUT</span></span>  
 <span data-ttu-id="d1592-208">O atributo SQL_SOPT_SS_QUERYNOTIFICATION_TIMEOUT especifica o número de segundos que a notificação de consulta deve permanecer ativa.</span><span class="sxs-lookup"><span data-stu-id="d1592-208">The SQL_SOPT_SS_QUERYNOTIFICATION_TIMEOUT attribute specifies the number of seconds that the query notification is to remain active.</span></span> <span data-ttu-id="d1592-209">O valor padrão é 432.000 segundos (5 dias).</span><span class="sxs-lookup"><span data-stu-id="d1592-209">The default value is 432000 seconds (5 days).</span></span> <span data-ttu-id="d1592-210">O valor *ValuePtr* é do tipo SQLLEN.</span><span class="sxs-lookup"><span data-stu-id="d1592-210">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
### <a name="sql_sopt_ss_param_focus"></a><span data-ttu-id="d1592-211">SQL_SOPT_SS_PARAM_FOCUS</span><span class="sxs-lookup"><span data-stu-id="d1592-211">SQL_SOPT_SS_PARAM_FOCUS</span></span>  
 <span data-ttu-id="d1592-212">O atributo SQL_SOPT_SS_PARAM_FOCUS especifica o foco para as chamadas SQLBindParameter, SQLGetDescField, SQLSetDescField, SQLGetDescRec e SQLSetDescRec subsequentes.</span><span class="sxs-lookup"><span data-stu-id="d1592-212">The SQL_SOPT_SS_PARAM_FOCUS attribute specifies the focus for subsequent SQLBindParameter, SQLGetDescField, SQLSetDescField, SQLGetDescRec, and SQLSetDescRec calls.</span></span>  
  
 <span data-ttu-id="d1592-213">O tipo para SQL_SOPT_SS_PARAM_FOCUS é SQLULEN.</span><span class="sxs-lookup"><span data-stu-id="d1592-213">The type for SQL_SOPT_SS_PARAM_FOCUS is SQLULEN.</span></span>  
  
 <span data-ttu-id="d1592-214">O padrão é 0, o que significa que estas chamadas são endereçadas a parâmetros que correspondem a marcadores de parâmetro na instrução SQL.</span><span class="sxs-lookup"><span data-stu-id="d1592-214">The default is 0, which means that these calls address parameters that correspond to parameter markers in the SQL statement.</span></span> <span data-ttu-id="d1592-215">Quando definido como o número de um parâmetro com valor de tabela, estas chamadas são endereçadas a colunas desse parâmetro com valor de tabela.</span><span class="sxs-lookup"><span data-stu-id="d1592-215">When set to the parameter number of a table-valued parameter, these calls address columns of that table-valued parameter.</span></span> <span data-ttu-id="d1592-216">Quando definido como um valor que não é o número de um parâmetro com valor de tabela, estas chamadas retornam o erro IM020: "O foco do parâmetro não se refere a um parâmetro com valor de tabela".</span><span class="sxs-lookup"><span data-stu-id="d1592-216">When set to a value that is not the parameter number of a table-valued parameter, these calls return the error IM020: "Parameter focus does not refer to a table-valued parameter".</span></span>  
  
### <a name="sql_sopt_ss_name_scope"></a><span data-ttu-id="d1592-217">SQL_SOPT_SS_NAME_SCOPE</span><span class="sxs-lookup"><span data-stu-id="d1592-217">SQL_SOPT_SS_NAME_SCOPE</span></span>  
 <span data-ttu-id="d1592-218">O atributo SQL_SOPT_SS_NAME_SCOPE especifica o escopo de nome para chamadas de função de catálogo subsequentes.</span><span class="sxs-lookup"><span data-stu-id="d1592-218">The SQL_SOPT_SS_NAME_SCOPE attribute specifies the name scope for subsequent catalog function calls.</span></span> <span data-ttu-id="d1592-219">O conjunto de resultados retornado por SQLColumns depende da configuração de SQL_SOPT_SS_NAME_SCOPE.</span><span class="sxs-lookup"><span data-stu-id="d1592-219">The result set returned by SQLColumns depends on the setting of SQL_SOPT_SS_NAME_SCOPE.</span></span>  
  
 <span data-ttu-id="d1592-220">O tipo para SQL_SOPT_SS_NAME_SCOPE é SQLULEN.</span><span class="sxs-lookup"><span data-stu-id="d1592-220">The type for SQL_SOPT_SS_NAME_SCOPE is SQLULEN.</span></span>  
  
|<span data-ttu-id="d1592-221">Valor de *ValuePtr*</span><span class="sxs-lookup"><span data-stu-id="d1592-221">*ValuePtr* value</span></span>|<span data-ttu-id="d1592-222">Descrição</span><span class="sxs-lookup"><span data-stu-id="d1592-222">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="d1592-223">SQL_SS_NAME_SCOPE_TABLE</span><span class="sxs-lookup"><span data-stu-id="d1592-223">SQL_SS_NAME_SCOPE_TABLE</span></span>|<span data-ttu-id="d1592-224">Padrão.</span><span class="sxs-lookup"><span data-stu-id="d1592-224">Default.</span></span><br /><br /> <span data-ttu-id="d1592-225">Ao usar parâmetros com valor de tabela, indica que metadados de tabelas reais devem ser retornados.</span><span class="sxs-lookup"><span data-stu-id="d1592-225">When using table-valued parameters, indicates that metadata for actual tables should be returned.</span></span><br /><br /> <span data-ttu-id="d1592-226">Ao usar o recurso de colunas esparsas, SQLColumns retornará apenas colunas que não sejam membros do esparso `column_set` .</span><span class="sxs-lookup"><span data-stu-id="d1592-226">When using the sparse columns feature, SQLColumns will return only columns that are not members of the sparse `column_set`.</span></span>|  
|<span data-ttu-id="d1592-227">SQL_SS_NAME_SCOPE_TABLE_TYPE</span><span class="sxs-lookup"><span data-stu-id="d1592-227">SQL_SS_NAME_SCOPE_TABLE_TYPE</span></span>|<span data-ttu-id="d1592-228">Indica que o aplicativo exige metadados para um tipo de tabela, em vez de uma tabela real (funções de catálogo devem retornar metadados para tipos de tabela).</span><span class="sxs-lookup"><span data-stu-id="d1592-228">Indicates that the application requires metadata for a table type, rather than an actual table (catalog functions should return metadata for table types).</span></span> <span data-ttu-id="d1592-229">Em seguida, o aplicativo passa a TYPE_NAME do parâmetro com valor de tabela como o parâmetro *TableName* .</span><span class="sxs-lookup"><span data-stu-id="d1592-229">The application then passes the TYPE_NAME of the table-valued parameter as the *TableName* parameter.</span></span>|  
|<span data-ttu-id="d1592-230">SQL_SS_NAME_SCOPE_EXTENDED</span><span class="sxs-lookup"><span data-stu-id="d1592-230">SQL_SS_NAME_SCOPE_EXTENDED</span></span>|<span data-ttu-id="d1592-231">Ao usar o recurso de colunas esparsas, SQLColumns retorna todas as colunas, independentemente da `column_set` associação.</span><span class="sxs-lookup"><span data-stu-id="d1592-231">When using the sparse columns feature, SQLColumns returns all columns, regardless of `column_set` membership.</span></span>|  
|<span data-ttu-id="d1592-232">SQL_SS_NAME_SCOPE_SPARSE_COLUMN_SET</span><span class="sxs-lookup"><span data-stu-id="d1592-232">SQL_SS_NAME_SCOPE_SPARSE_COLUMN_SET</span></span>|<span data-ttu-id="d1592-233">Ao usar o recurso de colunas esparsas, SQLColumns retorna apenas colunas que são membros do esparso `column_set` .</span><span class="sxs-lookup"><span data-stu-id="d1592-233">When using the sparse columns feature, SQLColumns returns only columns that are members of the sparse `column_set`.</span></span>|  
|<span data-ttu-id="d1592-234">SQL_SS_NAME_SCOPE_DEFAULT</span><span class="sxs-lookup"><span data-stu-id="d1592-234">SQL_SS_NAME_SCOPE_DEFAULT</span></span>|<span data-ttu-id="d1592-235">Igual a SQL_SS_NAME_SCOPE_TABLE.</span><span class="sxs-lookup"><span data-stu-id="d1592-235">Equal to SQL_SS_NAME_SCOPE_TABLE.</span></span>|  
  
 <span data-ttu-id="d1592-236">SS_TYPE_CATALOG_NAME e SS_TYPE_SCHEMA_NAME são usados com os parâmetros *CatalogName* e *SchemaName* , respectivamente, para identificar o catálogo e o esquema para o parâmetro com valor de tabela.</span><span class="sxs-lookup"><span data-stu-id="d1592-236">SS_TYPE_CATALOG_NAME and SS_TYPE_SCHEMA_NAME are used with the *CatalogName* and *SchemaName* parameters, respectively, to identify the catalog and schema for the table-valued parameter.</span></span> <span data-ttu-id="d1592-237">Quando um aplicativo concluir a recuperação de metadados para parâmetros com valor de tabela, ele deve definir SQL_SOPT_SS_NAME_SCOPE novamente com seu valor padrão SQL_SS_NAME_SCOPE_TABLE.</span><span class="sxs-lookup"><span data-stu-id="d1592-237">When an application has finished retrieving metadata for table-valued parameters, it must set SQL_SOPT_SS_NAME_SCOPE back to its default value of SQL_SS_NAME_SCOPE_TABLE.</span></span>  
  
 <span data-ttu-id="d1592-238">Quando SQL_SOPT_SS_NAME_SCOPE for definido como SQL_SS_NAME_SCOPE_TABLE, as consultas a servidores vinculados irão falhar.</span><span class="sxs-lookup"><span data-stu-id="d1592-238">When SQL_SOPT_SS_NAME_SCOPE is set to SQL_SS_NAME_SCOPE_TABLE, queries to linked servers fail.</span></span> <span data-ttu-id="d1592-239">As chamadas para SQLColumns ou SQLPrimaryKeys com um catálogo que contém um componente de servidor falharão.</span><span class="sxs-lookup"><span data-stu-id="d1592-239">Calls to SQLColumns or SQLPrimaryKeys with a catalog that contains a server component will fail.</span></span>  
  
 <span data-ttu-id="d1592-240">Se você tentar definir SQL_SOPT_SS_NAME_SCOPE com um valor inválido, SQL_ERROR será retornado e um registro de diagnóstico será gerado com SQLSTATE HY024 e a mensagem "Valor de atributo inválido".</span><span class="sxs-lookup"><span data-stu-id="d1592-240">If you attempt to set SQL_SOPT_SS_NAME_SCOPE to an invalid value, SQL_ERROR is returned and a diagnostic record is generated with SQLSTATE HY024 and the message "Invalid attribute value".</span></span>  
  
 <span data-ttu-id="d1592-241">Se uma função de catálogo diferente de SQLTables, SQLColumns ou SQLPrimaryKeys for chamada quando SQL_SOPT_SS_NAME_SCOPE tiver um valor diferente de SQL_SS_NAME_SCOPE_TABLE, SQL_ERROR será retornado.</span><span class="sxs-lookup"><span data-stu-id="d1592-241">If a catalog function other then SQLTables, SQLColumns, or SQLPrimaryKeys is called when SQL_SOPT_SS_NAME_SCOPE has a value other than SQL_SS_NAME_SCOPE_TABLE, SQL_ERROR is returned.</span></span> <span data-ttu-id="d1592-242">Um registro de diagnóstico é gerado com SQLSTATE HY010 e a mensagem "Erro de sequência de função (SQL_SOPT_SS_NAME_SCOPE não está definido como SQL_SS_NAME_SCOPE_TABLE)".</span><span class="sxs-lookup"><span data-stu-id="d1592-242">A diagnostic record is generated with SQLSTATE HY010 and the message "Function sequence error (SQL_SOPT_SS_NAME_SCOPE is not set to SQL_SS_NAME_SCOPE_TABLE)".</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d1592-243">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="d1592-243">See Also</span></span>  
 <span data-ttu-id="d1592-244">[Função SQLGetStmtAttr](https://go.microsoft.com/fwlink/?LinkId=59355) </span><span class="sxs-lookup"><span data-stu-id="d1592-244">[SQLGetStmtAttr Function](https://go.microsoft.com/fwlink/?LinkId=59355) </span></span>  
 [<span data-ttu-id="d1592-245">ODBC API Implementation Details</span><span class="sxs-lookup"><span data-stu-id="d1592-245">ODBC API Implementation Details</span></span>](odbc-api-implementation-details.md)  
  
  
