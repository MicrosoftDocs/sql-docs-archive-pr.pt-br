---
title: Associação e Transferência de Dados de parâmetros com valor de tabela e valores de coluna | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- table-valued parameters (ODBC), binding and data transfer
ms.assetid: 0a2ea462-d613-42b6-870f-c7fa086a6b42
author: rothja
ms.author: jroth
ms.openlocfilehash: 2e9e30e22a69b2d500990cc1481506b4edbda99b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87581807"
---
# <a name="binding-and-data-transfer-of-table-valued-parameters-and-column-values"></a><span data-ttu-id="a2b86-102">Associação e transferência de dados de parâmetros com valor de tabela e valores de coluna</span><span class="sxs-lookup"><span data-stu-id="a2b86-102">Binding and Data Transfer of Table-Valued Parameters and Column Values</span></span>
  <span data-ttu-id="a2b86-103">Parâmetros com valor de tabela, como outros parâmetros, devem ser associados antes de serem passados para o servidor.</span><span class="sxs-lookup"><span data-stu-id="a2b86-103">Table-valued parameters, like other parameters, must be bound before they are passed to the server.</span></span> <span data-ttu-id="a2b86-104">O aplicativo associa parâmetros com valor de tabela da mesma forma que associa outros parâmetros: usando SQLBindParameter ou chamadas equivalentes a SQLSetDescField ou SQLSetDescRec.</span><span class="sxs-lookup"><span data-stu-id="a2b86-104">The application binds table-valued parameters the same way it binds other parameters: by using SQLBindParameter or equivalent calls to SQLSetDescField or SQLSetDescRec.</span></span> <span data-ttu-id="a2b86-105">O tipo de dados do servidor para um parâmetro com valor de tabela é SQL_SS_TABLE.</span><span class="sxs-lookup"><span data-stu-id="a2b86-105">The server data type for a table-valued parameter is SQL_SS_TABLE.</span></span> <span data-ttu-id="a2b86-106">O tipo C pode ser especificado como SQL_C_DEFAULT ou SQL_C_BINARY.</span><span class="sxs-lookup"><span data-stu-id="a2b86-106">The C type can be specified either as SQL_C_DEFAULT or SQL_C_BINARY.</span></span>  
  
 <span data-ttu-id="a2b86-107">No [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] ou posterior, só existe suporte para parâmetros com valor de tabela de entrada.</span><span class="sxs-lookup"><span data-stu-id="a2b86-107">In [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] or later, only input table-valued parameters are supported.</span></span> <span data-ttu-id="a2b86-108">Portanto, qualquer tentativa de definir SQL_DESC_PARAMETER_TYPE como um valor diferente de SQL_PARAM_INPUT retornará SQL_ERROR com SQLSTATE = HY105 e a mensagem "Tipo de parâmetro inválido".</span><span class="sxs-lookup"><span data-stu-id="a2b86-108">Therefore, any attempt to set SQL_DESC_PARAMETER_TYPE to a value other than SQL_PARAM_INPUT will return SQL_ERROR with SQLSTATE = HY105 and the message "Invalid parameter type".</span></span>  
  
 <span data-ttu-id="a2b86-109">Valores padrão podem ser atribuídos a colunas inteiras de parâmetros com valor de tabela usando o atributo SQL_CA_SS_COL_HAS_DEFAULT_VALUE.</span><span class="sxs-lookup"><span data-stu-id="a2b86-109">Entire table-valued parameter columns can be assigned default values by using the attribute SQL_CA_SS_COL_HAS_DEFAULT_VALUE.</span></span> <span data-ttu-id="a2b86-110">Os valores de coluna de parâmetro com valor de tabela individual, no entanto, não podem ser atribuídos a valores padrão usando SQL_DEFAULT_PARAM em *StrLen_or_IndPtr* com SQLBindParameter.</span><span class="sxs-lookup"><span data-stu-id="a2b86-110">Individual table-valued parameter column values, however, cannot be assigned default values by using SQL_DEFAULT_PARAM in *StrLen_or_IndPtr* with SQLBindParameter.</span></span> <span data-ttu-id="a2b86-111">Os parâmetros com valor de tabela como um todo não podem ser definidos como um valor padrão usando SQL_DEFAULT_PARAM em *StrLen_or_IndPtr* com SQLBindParameter.</span><span class="sxs-lookup"><span data-stu-id="a2b86-111">Table-valued parameters as a whole cannot be set to a default value by using SQL_DEFAULT_PARAM in *StrLen_or_IndPtr* with SQLBindParameter.</span></span> <span data-ttu-id="a2b86-112">Se essas regras não forem seguidas, SQLExecute ou SQLExecDirect retornará SQL_ERROR.</span><span class="sxs-lookup"><span data-stu-id="a2b86-112">If these rules are not followed, SQLExecute or SQLExecDirect will return SQL_ERROR.</span></span> <span data-ttu-id="a2b86-113">Um registro de diagnóstico será gerado com SQLSTATE = 07S01 e a mensagem "uso inválido do parâmetro padrão para \<p> o parâmetro", em que \<p> é o ORDINAL do TVP na instrução de consulta.</span><span class="sxs-lookup"><span data-stu-id="a2b86-113">A diagnostic record will be generated with SQLSTATE=07S01 and the message "Invalid use of default parameter for parameter \<p>", where \<p> is the ordinal of the TVP in the query statement.</span></span>  
  
 <span data-ttu-id="a2b86-114">Depois de associar o parâmetro com valor de tabela, o aplicativo deverá, então, associar cada coluna de parâmetros com valor de tabela.</span><span class="sxs-lookup"><span data-stu-id="a2b86-114">After binding the table-valued parameter, the application must then bind each table-valued parameter column.</span></span> <span data-ttu-id="a2b86-115">Para fazer isso, o aplicativo primeiro chama SQLSetStmtAttr para definir SQL_SOPT_SS_PARAM_FOCUS para o ordinal de um parâmetro com valor de tabela.</span><span class="sxs-lookup"><span data-stu-id="a2b86-115">To do this, the application first calls SQLSetStmtAttr to set SQL_SOPT_SS_PARAM_FOCUS to the ordinal of a table-valued parameter.</span></span> <span data-ttu-id="a2b86-116">Em seguida, o aplicativo associa as colunas do parâmetro com valor de tabela por meio de chamadas para as seguintes rotinas: SQLBindParameter, SQLSetDescRec e SQLSetDescField.</span><span class="sxs-lookup"><span data-stu-id="a2b86-116">Then the application binds the columns of the table-valued parameter by calls to the following routines: SQLBindParameter, SQLSetDescRec, and SQLSetDescField.</span></span> <span data-ttu-id="a2b86-117">A definição de SQL_SOPT_SS_PARAM_FOCUS como 0 restaura o efeito usual de SQLBindParameter, SQLSetDescRec e SQLSetDescField em operando em parâmetros de nível superior regulares.</span><span class="sxs-lookup"><span data-stu-id="a2b86-117">Setting SQL_SOPT_SS_PARAM_FOCUS to 0 restores the usual effect of SQLBindParameter, SQLSetDescRec, and SQLSetDescField in operating on regular top-level parameters.</span></span>  
  
 <span data-ttu-id="a2b86-118">Nenhum dado real é enviado ou recebido para o próprio parâmetro com valor de tabela, mas dados são enviados e recebidos para cada uma de suas colunas constituintes.</span><span class="sxs-lookup"><span data-stu-id="a2b86-118">No actual data is sent or received for the table-valued parameter itself, but data is sent and received for each of its constituent columns.</span></span> <span data-ttu-id="a2b86-119">Como o parâmetro com valor de tabela é uma pseudo coluna, os parâmetros para SQLBindParameter são usados para fazer referência a atributos diferentes dos outros tipos de dados, da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="a2b86-119">Because the table-valued parameter is a pseudo column, the parameters for SQLBindParameter are used to refer to different attributes than other data types, as follows:</span></span>  
  
|<span data-ttu-id="a2b86-120">Parâmetro</span><span class="sxs-lookup"><span data-stu-id="a2b86-120">Parameter</span></span>|<span data-ttu-id="a2b86-121">Atributo relacionado para tipos de parâmetro não com valor de tabela, incluindo colunas</span><span class="sxs-lookup"><span data-stu-id="a2b86-121">Related attribute for non-table-valued parameter types, including columns</span></span>|<span data-ttu-id="a2b86-122">Atributo relacionado para parâmetros com valor de tabela</span><span class="sxs-lookup"><span data-stu-id="a2b86-122">Related attribute for table-valued parameters</span></span>|  
|---------------|--------------------------------------------------------------------------------|----------------------------------------------------|  
|<span data-ttu-id="a2b86-123">*InputOutputType*</span><span class="sxs-lookup"><span data-stu-id="a2b86-123">*InputOutputType*</span></span>|<span data-ttu-id="a2b86-124">SQL_DESC_PARAMETER_TYPE em IPD.</span><span class="sxs-lookup"><span data-stu-id="a2b86-124">SQL_DESC_PARAMETER_TYPE in IPD.</span></span><br /><br /> <span data-ttu-id="a2b86-125">Para colunas de parâmetros com valor de tabela, isso deve ser igual à configuração do próprio parâmetro com valor de tabela.</span><span class="sxs-lookup"><span data-stu-id="a2b86-125">For table-valued parameter columns, this must be the same as the setting for the table-valued parameter itself.</span></span>|<span data-ttu-id="a2b86-126">SQL_DESC_PARAMETER_TYPE em IPD.</span><span class="sxs-lookup"><span data-stu-id="a2b86-126">SQL_DESC_PARAMETER_TYPE in IPD.</span></span><br /><br /> <span data-ttu-id="a2b86-127">Isso deve ser SQL_PARAM_INPUT.</span><span class="sxs-lookup"><span data-stu-id="a2b86-127">This must be SQL_PARAM_INPUT.</span></span>|  
|<span data-ttu-id="a2b86-128">*ValueType*</span><span class="sxs-lookup"><span data-stu-id="a2b86-128">*ValueType*</span></span>|<span data-ttu-id="a2b86-129">SQL_DESC_TYPE, SQL_DESC_CONCISE_TYPE em APD.</span><span class="sxs-lookup"><span data-stu-id="a2b86-129">SQL_DESC_TYPE, SQL_DESC_CONCISE_TYPE in APD.</span></span>|<span data-ttu-id="a2b86-130">SQL_DESC_TYPE, SQL_DESC_CONCISE_TYPE em APD.</span><span class="sxs-lookup"><span data-stu-id="a2b86-130">SQL_DESC_TYPE, SQL_DESC_CONCISE_TYPE in APD.</span></span><br /><br /> <span data-ttu-id="a2b86-131">Isso deve ser SQL_C_DEFAULT ou SQL_C_BINARY.</span><span class="sxs-lookup"><span data-stu-id="a2b86-131">This must be SQL_C_DEFAULT or SQL_C_BINARY.</span></span>|  
|<span data-ttu-id="a2b86-132">*ParameterType*</span><span class="sxs-lookup"><span data-stu-id="a2b86-132">*ParameterType*</span></span>|<span data-ttu-id="a2b86-133">SQL_DESC_TYPE, SQL_DESC_CONCISE_TYPE em IPD.</span><span class="sxs-lookup"><span data-stu-id="a2b86-133">SQL_DESC_TYPE, SQL_DESC_CONCISE_TYPE in IPD.</span></span>|<span data-ttu-id="a2b86-134">SQL_DESC_TYPE, SQL_DESC_CONCISE_TYPE em IPD.</span><span class="sxs-lookup"><span data-stu-id="a2b86-134">SQL_DESC_TYPE, SQL_DESC_CONCISE_TYPE in IPD.</span></span><br /><br /> <span data-ttu-id="a2b86-135">Isso deve ser SQL_SS_TABLE.</span><span class="sxs-lookup"><span data-stu-id="a2b86-135">This must be SQL_SS_TABLE.</span></span>|  
|<span data-ttu-id="a2b86-136">*ColumnSize*</span><span class="sxs-lookup"><span data-stu-id="a2b86-136">*ColumnSize*</span></span>|<span data-ttu-id="a2b86-137">SQL_DESC_LENGTH ou SQL_DESC_PRECISION em IPD.</span><span class="sxs-lookup"><span data-stu-id="a2b86-137">SQL_DESC_LENGTH or SQL_DESC_PRECISION in IPD.</span></span><br /><br /> <span data-ttu-id="a2b86-138">Isso depende do valor de *ParameterType*.</span><span class="sxs-lookup"><span data-stu-id="a2b86-138">This depends on the value of *ParameterType*.</span></span>|<span data-ttu-id="a2b86-139">SQL_DESC_ARRAY_SIZE</span><span class="sxs-lookup"><span data-stu-id="a2b86-139">SQL_DESC_ARRAY_SIZE</span></span><br /><br /> <span data-ttu-id="a2b86-140">Também poderá ser definido usando SQL_ATTR_PARAM_SET_SIZE quando o foco do parâmetro for definido como o parâmetro com valor de tabela.</span><span class="sxs-lookup"><span data-stu-id="a2b86-140">Can also be set using SQL_ATTR_PARAM_SET_SIZE when the parameter focus is set to the table-valued parameter.</span></span><br /><br /> <span data-ttu-id="a2b86-141">Para um parâmetro com valor de tabela, esse é o número de linhas nos buffers de colunas de parâmetros com valor de tabela.</span><span class="sxs-lookup"><span data-stu-id="a2b86-141">For a table-valued parameter, this is the number of rows in the table-valued parameter column buffers.</span></span>|  
|<span data-ttu-id="a2b86-142">*DecimalDigits*</span><span class="sxs-lookup"><span data-stu-id="a2b86-142">*DecimalDigits*</span></span>|<span data-ttu-id="a2b86-143">SQL_DESC_PRECISION ou SQL_DESC_SCALE em IPD.</span><span class="sxs-lookup"><span data-stu-id="a2b86-143">SQL_DESC_PRECISION or SQL_DESC_SCALE in IPD.</span></span>|<span data-ttu-id="a2b86-144">Não utilizado.</span><span class="sxs-lookup"><span data-stu-id="a2b86-144">Unused.</span></span> <span data-ttu-id="a2b86-145">Isso deve ser 0.</span><span class="sxs-lookup"><span data-stu-id="a2b86-145">This must be 0.</span></span><br /><br /> <span data-ttu-id="a2b86-146">Se esse parâmetro não for 0, SQLBindParameter retornará SQL_ERROR e um registro de diagnóstico será gerado com SQLSTATE = HY104 e a mensagem "precisão ou escala inválida".</span><span class="sxs-lookup"><span data-stu-id="a2b86-146">If this parameter is not 0, SQLBindParameter will return SQL_ERROR, and a diagnostic record will be generated with SQLSTATE= HY104 and the message "Invalid precision or scale".</span></span>|  
|<span data-ttu-id="a2b86-147">*ParameterValuePtr*</span><span class="sxs-lookup"><span data-stu-id="a2b86-147">*ParameterValuePtr*</span></span>|<span data-ttu-id="a2b86-148">SQL_DESC_DATA_PTR em APD.</span><span class="sxs-lookup"><span data-stu-id="a2b86-148">SQL_DESC_DATA_PTR in APD.</span></span>|<span data-ttu-id="a2b86-149">SQL_CA_SS_TYPE_NAME.</span><span class="sxs-lookup"><span data-stu-id="a2b86-149">SQL_CA_SS_TYPE_NAME.</span></span><br /><br /> <span data-ttu-id="a2b86-150">Isso é opcional para chamadas de procedimento armazenado e NULL poderá ser especificado se ele não for necessário.</span><span class="sxs-lookup"><span data-stu-id="a2b86-150">This is optional for stored procedure calls, and NULL can be specified if it is not required.</span></span> <span data-ttu-id="a2b86-151">Deve ser especificado para instruções SQL que não são chamadas de procedimento.</span><span class="sxs-lookup"><span data-stu-id="a2b86-151">It must be specified for SQL statements that are not procedure calls.</span></span><br /><br /> <span data-ttu-id="a2b86-152">Esse parâmetro também funciona como um valor exclusivo que o aplicativo poderá usar para identificar esse parâmetro com valor de tabela quando a associação de linha variável for usada.</span><span class="sxs-lookup"><span data-stu-id="a2b86-152">This parameter also serves as a unique value that the application can use to identify this table-valued parameter when variable row binding is used.</span></span> <span data-ttu-id="a2b86-153">Para obter mais informações, consulte a seção "Associação de linha variável de parâmetros com valor de tabela", mais adiante neste tópico.</span><span class="sxs-lookup"><span data-stu-id="a2b86-153">For more information, see the "Variable Table-Valued Parameter Row Binding" section, later in this topic.</span></span><br /><br /> <span data-ttu-id="a2b86-154">Quando um nome de tipo de parâmetro com valor de tabela é especificado em uma chamada para SQLBindParameter, ele deve ser especificado como um valor Unicode, mesmo em aplicativos criados como aplicativos ANSI.</span><span class="sxs-lookup"><span data-stu-id="a2b86-154">When a table-valued parameter type name is specified on a call to SQLBindParameter, it must be specified as a Unicode value, even in applications that are built as ANSI applications.</span></span> <span data-ttu-id="a2b86-155">O valor usado para o parâmetro *StrLen_or_IndPtr* deve ser SQL_NTS ou o comprimento da cadeia de caracteres do nome multiplicado por sizeof (WCHAR).</span><span class="sxs-lookup"><span data-stu-id="a2b86-155">The value used for the parameter *StrLen_or_IndPtr* should be either SQL_NTS or the string length of the name multiplied by sizeof(WCHAR).</span></span>|  
|<span data-ttu-id="a2b86-156">*BufferLength*</span><span class="sxs-lookup"><span data-stu-id="a2b86-156">*BufferLength*</span></span>|<span data-ttu-id="a2b86-157">SQL_DESC_OCTET_LENGTH em APD.</span><span class="sxs-lookup"><span data-stu-id="a2b86-157">SQL_DESC_OCTET_LENGTH in APD.</span></span>|<span data-ttu-id="a2b86-158">O comprimento do nome do tipo de parâmetro com valor de tabela em bytes.</span><span class="sxs-lookup"><span data-stu-id="a2b86-158">The length of the table-valued parameter type name in bytes.</span></span><br /><br /> <span data-ttu-id="a2b86-159">Isso poderá ser SQL_NTS se o nome do tipo terminar com caractere nulo ou 0 se o nome do tipo de parâmetro com valor de tabela não for necessário.</span><span class="sxs-lookup"><span data-stu-id="a2b86-159">This can be SQL_NTS if the type name is null terminated, or 0 if the table-valued parameter type name is not required.</span></span>|  
|<span data-ttu-id="a2b86-160">*StrLen_or_IndPtr*</span><span class="sxs-lookup"><span data-stu-id="a2b86-160">*StrLen_or_IndPtr*</span></span>|<span data-ttu-id="a2b86-161">SQL_DESC_OCTET_LENGTH_PTR em APD.</span><span class="sxs-lookup"><span data-stu-id="a2b86-161">SQL_DESC_OCTET_LENGTH_PTR in APD.</span></span>|<span data-ttu-id="a2b86-162">SQL_DESC_OCTET_LENGTH_PTR em APD.</span><span class="sxs-lookup"><span data-stu-id="a2b86-162">SQL_DESC_OCTET_LENGTH_PTR in APD.</span></span><br /><br /> <span data-ttu-id="a2b86-163">Para parâmetros com valor de tabela, essa é uma contagem de linhas e não um comprimento de dados.</span><span class="sxs-lookup"><span data-stu-id="a2b86-163">For table-valued parameters, this is a row count rather than a data length.</span></span>|  
  
 <span data-ttu-id="a2b86-164">Existe suporte para dois modos de transferência de dados para parâmetros com valor de tabela: associação de linha fixa e associação de linha variável.</span><span class="sxs-lookup"><span data-stu-id="a2b86-164">Two data transfer modes are supported for table-valued parameters: fixed row binding and variable row binding.</span></span>  
  
## <a name="fixed-table-valued-parameter-row-binding"></a><span data-ttu-id="a2b86-165">Associação de linha fixa de parâmetros com valor de tabela</span><span class="sxs-lookup"><span data-stu-id="a2b86-165">Fixed Table-Valued Parameter Row Binding</span></span>  
 <span data-ttu-id="a2b86-166">Para associação de linha fixa, um aplicativo aloca buffers (ou matrizes de buffers) grandes o bastante para todos os possíveis valores de coluna de entrada.</span><span class="sxs-lookup"><span data-stu-id="a2b86-166">For fixed row binding, an application allocates buffers (or buffer arrays) large enough for all possible input column values.</span></span> <span data-ttu-id="a2b86-167">O aplicativo faz o seguinte:</span><span class="sxs-lookup"><span data-stu-id="a2b86-167">The application does the following:</span></span>  
  
1.  <span data-ttu-id="a2b86-168">Associa todos os parâmetros usando chamadas SQLBindParameter, SQLSetDescRec ou SQLSetDescField.</span><span class="sxs-lookup"><span data-stu-id="a2b86-168">Binds all parameters by using SQLBindParameter, SQLSetDescRec, or SQLSetDescField calls.</span></span>  
  
    1.  <span data-ttu-id="a2b86-169">Define SQL_DESC_ARRAY_SIZE como o número máximo de linhas que podem ser transferidas para cada parâmetro com valor de tabela.</span><span class="sxs-lookup"><span data-stu-id="a2b86-169">Sets SQL_DESC_ARRAY_SIZE to the maximum number of rows that can be transferred for each table-valued parameter.</span></span> <span data-ttu-id="a2b86-170">Isso pode ser feito na chamada SQLBindParameter.</span><span class="sxs-lookup"><span data-stu-id="a2b86-170">This can be done in the SQLBindParameter call.</span></span>  
  
2.  <span data-ttu-id="a2b86-171">Chama SQLSetStmtAttr para definir SQL_SOPT_SS_PARAM_FOCUS para o ordinal de cada parâmetro com valor de tabela.</span><span class="sxs-lookup"><span data-stu-id="a2b86-171">Calls SQLSetStmtAttr to set SQL_SOPT_SS_PARAM_FOCUS to the ordinal of each table-valued parameter.</span></span>  
  
    1.  <span data-ttu-id="a2b86-172">Para cada parâmetro com valor de tabela, o associa colunas de parâmetro com valor de tabela usando chamadas SQLBindParameter, SQLSetDescRec ou SQLSetDescField.</span><span class="sxs-lookup"><span data-stu-id="a2b86-172">For each table-valued parameter, binds table-valued parameter columns by using SQLBindParameter, SQLSetDescRec, or SQLSetDescField calls.</span></span>  
  
    2.  <span data-ttu-id="a2b86-173">Para cada coluna de parâmetro com valor de tabela que deve ter valores padrão, chama SQLSetDescField para definir SQL_CA_SS_COL_HAS_DEFAULT_VALUE como 1.</span><span class="sxs-lookup"><span data-stu-id="a2b86-173">For each table-valued parameter column that is to have default values, calls SQLSetDescField to set SQL_CA_SS_COL_HAS_DEFAULT_VALUE to 1.</span></span>  
  
3.  <span data-ttu-id="a2b86-174">Chama SQLSetStmtAttr para definir SQL_SOPT_SS_PARAM_FOCUS como 0.</span><span class="sxs-lookup"><span data-stu-id="a2b86-174">Calls SQLSetStmtAttr to set SQL_SOPT_SS_PARAM_FOCUS to 0.</span></span> <span data-ttu-id="a2b86-175">Isso deve ser feito antes de SQLExecute ou SQLExecDirect ser chamado.</span><span class="sxs-lookup"><span data-stu-id="a2b86-175">This must be done before SQLExecute or SQLExecDirect is called.</span></span> <span data-ttu-id="a2b86-176">Caso contrário, SQL_ERROR será retornado e um registro de diagnóstico será gerado com SQLSTATE=HY024 e a mensagem "Valor de atributo inválido, SQL_SOPT_SS_PARAM_FOCUS (deve ser zero em tempo de execução)".</span><span class="sxs-lookup"><span data-stu-id="a2b86-176">Otherwise, SQL_ERROR is be returned and a diagnostic record is generated with SQLSTATE=HY024 and the message "Invalid attribute value, SQL_SOPT_SS_PARAM_FOCUS (must be zero at execution time)".</span></span>  
  
4.  <span data-ttu-id="a2b86-177">Define *StrLen_or_IndPtr* ou SQL_DESC_OCTET_LENGTH_PTR como SQL_DEFAULT_PARAM para um parâmetro com valor de tabela sem linhas ou o número de linhas a serem transferidas na próxima chamada de SQLExecute ou SQLExecDirect se o parâmetro com valor de tabela tiver linhas.</span><span class="sxs-lookup"><span data-stu-id="a2b86-177">Sets *StrLen_or_IndPtr* or SQL_DESC_OCTET_LENGTH_PTR to SQL_DEFAULT_PARAM for a table-valued parameter with no rows, or the number of rows to be transferred on the next call of SQLExecute or SQLExecDirect if the table-valued parameter has rows.</span></span> <span data-ttu-id="a2b86-178">Não é possível definir *StrLen_or_IndPtr* ou SQL_DESC_OCTET_LENGTH_PTR como SQL_NULL_DATA para um parâmetro com valor de tabela, pois os parâmetros com valor de tabela não são anuláveis (embora colunas constituintes de parâmetro com valor de tabela possam ser anuláveis).</span><span class="sxs-lookup"><span data-stu-id="a2b86-178">*StrLen_or_IndPtr* or SQL_DESC_OCTET_LENGTH_PTR cannot be set to SQL_NULL_DATA for a table-valued parameter as table-valued parameters are not nullable (though table-valued parameter constituent columns may be nullable).</span></span> <span data-ttu-id="a2b86-179">Se isso for definido como um valor inválido, SQLExecute ou SQLExecDirect retornará SQL_ERROR, e um registro de diagnóstico será gerado com SQLSTATE = HY090 e a mensagem "cadeia de caracteres ou comprimento do buffer inválido para o parâmetro \<p> ", em que p é o número do parâmetro.</span><span class="sxs-lookup"><span data-stu-id="a2b86-179">If this is set to an invalid value, SQLExecute or SQLExecDirect returns SQL_ERROR, and a diagnostic record is generated with SQLSTATE=HY090 and the message "Invalid string or buffer length for parameter \<p>", where p is the parameter number.</span></span>  
  
5.  <span data-ttu-id="a2b86-180">Chama SQLExecute ou SQLExecDirect.</span><span class="sxs-lookup"><span data-stu-id="a2b86-180">Calls SQLExecute or SQLExecDirect.</span></span>  
  
 <span data-ttu-id="a2b86-181">Os valores de coluna de parâmetro com valor de tabela de entrada podem ser passados em partes se *StrLen_or_IndPtr* estiver definido como SQL_LEN_DATA_AT_EXEC (*comprimento*) ou SQL_DATA_AT_EXEC para a coluna.</span><span class="sxs-lookup"><span data-stu-id="a2b86-181">Input table-valued parameter column values can be passed in pieces if *StrLen_or_IndPtr* is set to SQL_LEN_DATA_AT_EXEC(*length*) or SQL_DATA_AT_EXEC for the column.</span></span> <span data-ttu-id="a2b86-182">Isso é semelhante a passar valores em partes quando são usadas matrizes de parâmetros.</span><span class="sxs-lookup"><span data-stu-id="a2b86-182">This is similar to passing values in pieces when arrays of parameters are used.</span></span> <span data-ttu-id="a2b86-183">Assim como ocorre com todos os parâmetros de dados em execução, SQLParamData não indica a linha da matriz para a qual o driver está solicitando dados; o aplicativo deve cuidar disso.</span><span class="sxs-lookup"><span data-stu-id="a2b86-183">As with all data-at-execution parameters, SQLParamData does not indicate which row of the array the driver is requesting data for; the application must take care of this.</span></span> <span data-ttu-id="a2b86-184">O aplicativo não pode fazer nenhuma pressuposição sobre a ordem na qual o driver solicitará valores.</span><span class="sxs-lookup"><span data-stu-id="a2b86-184">The application cannot make any assumptions about the order in which the driver will request values.</span></span>  
  
## <a name="variable-table-valued-parameter-row-binding"></a><span data-ttu-id="a2b86-185">Associação de linha variável de parâmetros com valor de tabela</span><span class="sxs-lookup"><span data-stu-id="a2b86-185">Variable Table-Valued Parameter Row Binding</span></span>  
 <span data-ttu-id="a2b86-186">Para associação de linha variável, as linhas são transferidas em lotes em tempo de execução e o aplicativo passa linhas para o driver sob demanda.</span><span class="sxs-lookup"><span data-stu-id="a2b86-186">For variable row binding, rows are transferred in batches at execution time and the application passes rows to the driver on demand.</span></span> <span data-ttu-id="a2b86-187">Isso é semelhante a dados em execução para valores de parâmetros individuais.</span><span class="sxs-lookup"><span data-stu-id="a2b86-187">This is similar to data-at-execution for individual parameter values.</span></span> <span data-ttu-id="a2b86-188">Para associação de linha variável, o aplicativo faz o seguinte:</span><span class="sxs-lookup"><span data-stu-id="a2b86-188">For variable row binding, the application does the following:</span></span>  
  
1.  <span data-ttu-id="a2b86-189">Associa parâmetros e colunas de parâmetros com valor de tabela como descrito nas etapas de 1 a 3 da seção anterior, "Associação de linha fixa de parâmetros com valor de tabela".</span><span class="sxs-lookup"><span data-stu-id="a2b86-189">Binds parameters and table-valued parameter columns as described in steps 1 to 3 of the previous section, "Fixed Table-Valued Parameter Row Binding".</span></span>  
  
2.  <span data-ttu-id="a2b86-190">Define *StrLen_or_IndPtr* ou SQL_DESC_OCTET_LENGTH_PTR para quaisquer parâmetros com valor de tabela que devem ser passados no momento da execução para SQL_DATA_AT_EXEC.</span><span class="sxs-lookup"><span data-stu-id="a2b86-190">Sets *StrLen_or_IndPtr* or SQL_DESC_OCTET_LENGTH_PTR for any table-valued parameters that are to be passed at execution time to SQL_DATA_AT_EXEC.</span></span> <span data-ttu-id="a2b86-191">Se nenhum dos dois for definido, o parâmetro será processado como descrito na seção anterior.</span><span class="sxs-lookup"><span data-stu-id="a2b86-191">If neither is set, the parameter will be processed as described in the previous section.</span></span>  
  
3.  <span data-ttu-id="a2b86-192">Chama SQLExecute ou SQLExecDirect.</span><span class="sxs-lookup"><span data-stu-id="a2b86-192">Calls SQLExecute or SQLExecDirect.</span></span> <span data-ttu-id="a2b86-193">Isso retornará SQL_NEED_DATA se houver qualquer parâmetro SQL_PARAM_INPUT ou SQL_PARAM_INPUT_OUTPUT para ser tratado como parâmetro de dados em execução.</span><span class="sxs-lookup"><span data-stu-id="a2b86-193">This will return SQL_NEED_DATA if there are any SQL_PARAM_INPUT or SQL_PARAM_INPUT_OUTPUT parameters to be handled as data-at-execution parameters.</span></span> <span data-ttu-id="a2b86-194">Nesse caso, o aplicativo faz o seguinte:</span><span class="sxs-lookup"><span data-stu-id="a2b86-194">In this case, the application does the following:</span></span>  
  
    -   <span data-ttu-id="a2b86-195">Chama SQLParamData.</span><span class="sxs-lookup"><span data-stu-id="a2b86-195">Calls SQLParamData.</span></span> <span data-ttu-id="a2b86-196">Isso retorna o valor de *ParameterValuePtr* para um parâmetro de dados em execução e um código de retorno de SQL_NEED_DATA.</span><span class="sxs-lookup"><span data-stu-id="a2b86-196">This returns the *ParameterValuePtr* value for a data-at-execution parameter and a return code of SQL_NEED_DATA.</span></span> <span data-ttu-id="a2b86-197">Quando todos os dados de parâmetro forem passados para o driver, SQLParamData retornará SQL_SUCCESS, SQL_SUCCESS_WITH_INFO ou SQL_ERROR.</span><span class="sxs-lookup"><span data-stu-id="a2b86-197">When all parameter data has been passed to the driver, SQLParamData returns SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, or SQL_ERROR.</span></span> <span data-ttu-id="a2b86-198">Para parâmetros de dados em execução, *ParameterValuePtr*, que é o mesmo que o campo de descritor SQL_DESC_DATA_PTR, pode ser considerado um token para identificar exclusivamente um parâmetro para o qual um valor é necessário.</span><span class="sxs-lookup"><span data-stu-id="a2b86-198">For data-at-execution parameters, *ParameterValuePtr*, which is the same as the descriptor field SQL_DESC_DATA_PTR, can be regarded as a token to uniquely identify a parameter for which a value is required.</span></span> <span data-ttu-id="a2b86-199">Esse "token" é passado do aplicativo para o driver em tempo de associação e, depois, devolvido ao aplicativo em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="a2b86-199">This "token" is passed from the application to the driver at bind time, then passed back to the application at execution time.</span></span>  
  
4.  <span data-ttu-id="a2b86-200">Para enviar dados de linha de parâmetro com valor de tabela para parâmetros nulos com valor de tabela, se o parâmetro com valor de tabela não tiver linhas, um aplicativo chamará SQLPutData com *StrLen_or_Ind* definido como SQL_DEFAULT_PARAM.</span><span class="sxs-lookup"><span data-stu-id="a2b86-200">To send table-valued parameter row data for null table-valued parameters, if the table-valued parameter has no rows, an application calls SQLPutData with *StrLen_or_Ind* set to SQL_DEFAULT_PARAM.</span></span>  
  
     <span data-ttu-id="a2b86-201">Para TVPs não nulos, um aplicativo:</span><span class="sxs-lookup"><span data-stu-id="a2b86-201">For non-NULL TVPs, an application:</span></span>  
  
    -   <span data-ttu-id="a2b86-202">Define *Str_Len_or_Ind* para todas as colunas de parâmetro com valor de tabela para valores apropriados e popula buffers de dados para colunas de parâmetro com valor de tabela que não sejam parâmetros de dados em execução.</span><span class="sxs-lookup"><span data-stu-id="a2b86-202">Sets *Str_Len_or_Ind* for all the table-valued parameter columns to appropriate values, and populates data buffers for table-valued parameter columns that are not to be data-at-execution parameters.</span></span> <span data-ttu-id="a2b86-203">Você pode usar dados em execução para colunas de parâmetros com valor de tabela de forma semelhante ao modo como parâmetros comuns podem ser passados para o driver em partes.</span><span class="sxs-lookup"><span data-stu-id="a2b86-203">You can use data-at-execution for table-valued parameter columns in a similar way to that in which ordinary parameters can be passed to the driver in pieces.</span></span>  
  
    -   <span data-ttu-id="a2b86-204">Chama SQLPutData com *Str_Len_or_Ind* definido como o número de linhas a serem enviadas ao servidor.</span><span class="sxs-lookup"><span data-stu-id="a2b86-204">Calls SQLPutData with *Str_Len_or_Ind* set to the number of rows to be sent to the server.</span></span> <span data-ttu-id="a2b86-205">Qualquer valor fora do intervalo de 0 a SQL_DESC_ARRAY_SIZE ou SQL_DEFAULT_PARAM é um erro e retornará SQLSTATE HY090, com a mensagem "Comprimento inválido de buffer ou cadeia de caracteres".</span><span class="sxs-lookup"><span data-stu-id="a2b86-205">Any value outside the range 0 to SQL_DESC_ARRAY_SIZE or SQL_DEFAULT_PARAM is an error, and will return SQLSTATE HY090, with the message "Invalid string or buffer length".</span></span> <span data-ttu-id="a2b86-206">0 indica que todas as linhas foram enviadas e não há mais dados para um parâmetro com valor de tabela (como observado no segundo item de marcador desta lista).</span><span class="sxs-lookup"><span data-stu-id="a2b86-206">0 indicates that all rows have been sent and there is no more data for a table-valued parameter (as noted in the second bullet item in this list).</span></span> <span data-ttu-id="a2b86-207">SQL_DEFAULT_PARAM poderá ser usado apenas na primeira vez em que o driver solicitar dados para um parâmetro com valor de tabela (como descrito no primeiro item de marcador desta lista).</span><span class="sxs-lookup"><span data-stu-id="a2b86-207">SQL_DEFAULT_PARAM can only be used the first time the driver requests data for a table-valued parameter (as described in the first bullet item in this list).</span></span>  
  
5.  <span data-ttu-id="a2b86-208">Quando todas as linhas tiverem sido enviadas, o chamará SQLPutData para o parâmetro com valor de tabela com um *Str_Len_or_Ind* valores de 0 e, em seguida, passará para a etapa 3a acima.</span><span class="sxs-lookup"><span data-stu-id="a2b86-208">When all rows have been sent, calls SQLPutData for the table-valued parameter with a *Str_Len_or_Ind* value of 0, then proceeds to step 3a above.</span></span>  
  
6.  <span data-ttu-id="a2b86-209">Chama SQLParamData novamente.</span><span class="sxs-lookup"><span data-stu-id="a2b86-209">Calls SQLParamData again.</span></span> <span data-ttu-id="a2b86-210">Se houver parâmetros de dados em execução entre as colunas de parâmetro com valor de tabela, eles serão identificados pelo valor *ValuePtrPtr* retornado por SQLParamData.</span><span class="sxs-lookup"><span data-stu-id="a2b86-210">If there are any data-at-execution parameters among the table-valued parameter columns, these will be identified by the value *ValuePtrPtr* returned by SQLParamData.</span></span> <span data-ttu-id="a2b86-211">Quando todos os valores de coluna estiverem disponíveis, SQLParamData retornará novamente o valor de *ParameterValuePtr* para o parâmetro com valor de tabela e o aplicativo começará novamente.</span><span class="sxs-lookup"><span data-stu-id="a2b86-211">When all column values are available, SQLParamData will again return the *ParameterValuePtr* value for the table-valued parameter, and the application begins again.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a2b86-212">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="a2b86-212">See Also</span></span>  
 [<span data-ttu-id="a2b86-213">Parâmetros com valor de tabela &#40;&#41;ODBC</span><span class="sxs-lookup"><span data-stu-id="a2b86-213">Table-Valued Parameters &#40;ODBC&#41;</span></span>](table-valued-parameters-odbc.md)  
  
  
