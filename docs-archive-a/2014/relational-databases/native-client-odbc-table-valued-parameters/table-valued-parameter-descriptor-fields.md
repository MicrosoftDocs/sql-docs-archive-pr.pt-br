---
title: Campos de descritor de parâmetro com valor de tabela | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- table-valued parameters (ODBC), descriptor fields
ms.assetid: 4e009eff-c156-4d63-abcf-082ddd304de2
author: rothja
ms.author: jroth
ms.openlocfilehash: 5365229aed0bc46315a7e6db5448bee6963b23fc
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87679935"
---
# <a name="table-valued-parameter-descriptor-fields"></a><span data-ttu-id="4fb32-102">Campos do descritor de parâmetro com valor de tabela</span><span class="sxs-lookup"><span data-stu-id="4fb32-102">Table-Valued Parameter Descriptor Fields</span></span>
  <span data-ttu-id="4fb32-103">O suporte a parâmetros com valor de tabela inclui novos campos específicos do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] em APDs (descritores de parâmetro de aplicativo) e IPDs (descritores de parâmetro de implementação) ODBC.</span><span class="sxs-lookup"><span data-stu-id="4fb32-103">Support for table-valued parameters includes new [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-specific fields in ODBC application parameter descriptors (APDs) and implementation parameter descriptors (IPDs).</span></span>  
  
## <a name="remarks"></a><span data-ttu-id="4fb32-104">Comentários</span><span class="sxs-lookup"><span data-stu-id="4fb32-104">Remarks</span></span>  
  
|<span data-ttu-id="4fb32-105">Nome</span><span class="sxs-lookup"><span data-stu-id="4fb32-105">Name</span></span>|<span data-ttu-id="4fb32-106">Localização</span><span class="sxs-lookup"><span data-stu-id="4fb32-106">Location</span></span>|<span data-ttu-id="4fb32-107">Type</span><span class="sxs-lookup"><span data-stu-id="4fb32-107">Type</span></span>|<span data-ttu-id="4fb32-108">Descrição</span><span class="sxs-lookup"><span data-stu-id="4fb32-108">Description</span></span>|  
|----------|--------------|----------|-----------------|  
|<span data-ttu-id="4fb32-109">SQL_CA_SS_TYPE_NAME</span><span class="sxs-lookup"><span data-stu-id="4fb32-109">SQL_CA_SS_TYPE_NAME</span></span>|<span data-ttu-id="4fb32-110">IPD</span><span class="sxs-lookup"><span data-stu-id="4fb32-110">IPD</span></span>|<span data-ttu-id="4fb32-111">SQLTCHAR\*</span><span class="sxs-lookup"><span data-stu-id="4fb32-111">SQLTCHAR\*</span></span>|<span data-ttu-id="4fb32-112">O nome do tipo de servidor do parâmetro com valor de tabela.</span><span class="sxs-lookup"><span data-stu-id="4fb32-112">The server type name of the table-valued parameter.</span></span><br /><br /> <span data-ttu-id="4fb32-113">Quando um nome de tipo de parâmetro com valor de tabela é especificado em uma chamada para SQLBindParameter, ele sempre deve ser especificado como um valor Unicode, mesmo em aplicativos criados como aplicativos ANSI.</span><span class="sxs-lookup"><span data-stu-id="4fb32-113">When a table-valued parameter type name is specified on a call to SQLBindParameter, it must always be specified as a Unicode value, even in applications that are built as ANSI applications.</span></span> <span data-ttu-id="4fb32-114">O valor usado para o parâmetro *StrLen_or_IndPtr* deve ser SQL_NTS ou o comprimento da cadeia de caracteres do nome multiplicado por sizeof (WCHAR).</span><span class="sxs-lookup"><span data-stu-id="4fb32-114">The value used for the parameter *StrLen_or_IndPtr* should be either SQL_NTS or the string length of the name multiplied by sizeof(WCHAR).</span></span><br /><br /> <span data-ttu-id="4fb32-115">Quando um nome de tipo de parâmetro com valor de tabela é especificado via SQLSetDescField, ele pode ser especificado usando um literal que está de acordo com a maneira como o aplicativo é compilado.</span><span class="sxs-lookup"><span data-stu-id="4fb32-115">When a table-valued parameter type name is specified via SQLSetDescField, it can be specified by using a literal that conforms to the way the application is built.</span></span> <span data-ttu-id="4fb32-116">O Gerenciador do Driver ODBC executará todas as conversões de Unicode necessárias.</span><span class="sxs-lookup"><span data-stu-id="4fb32-116">The ODBC Driver Manager will perform any required Unicode conversion.</span></span>|  
|<span data-ttu-id="4fb32-117">SQL_CA_SS_TYPE_CATALOG_NAME (somente leitura)</span><span class="sxs-lookup"><span data-stu-id="4fb32-117">SQL_CA_SS_TYPE_CATALOG_NAME (read only)</span></span>|<span data-ttu-id="4fb32-118">IPD</span><span class="sxs-lookup"><span data-stu-id="4fb32-118">IPD</span></span>|<span data-ttu-id="4fb32-119">SQLTCHAR\*</span><span class="sxs-lookup"><span data-stu-id="4fb32-119">SQLTCHAR\*</span></span>|<span data-ttu-id="4fb32-120">O catálogo onde o tipo é definido.</span><span class="sxs-lookup"><span data-stu-id="4fb32-120">The catalog where the type is defined.</span></span>|  
|<span data-ttu-id="4fb32-121">SQL_CA_SS_TYPE_SCHEMA_NAME</span><span class="sxs-lookup"><span data-stu-id="4fb32-121">SQL_CA_SS_TYPE_SCHEMA_NAME</span></span>|<span data-ttu-id="4fb32-122">IPD</span><span class="sxs-lookup"><span data-stu-id="4fb32-122">IPD</span></span>|<span data-ttu-id="4fb32-123">SQLTCHAR\*</span><span class="sxs-lookup"><span data-stu-id="4fb32-123">SQLTCHAR\*</span></span>|<span data-ttu-id="4fb32-124">O esquema onde o tipo é definido.</span><span class="sxs-lookup"><span data-stu-id="4fb32-124">The schema where the type is defined.</span></span>|  
  
 <span data-ttu-id="4fb32-125">Os aplicativos não devem ser definidos como SQL_CA_SS_TYPE_CATALOG_NAME para parâmetros com valor de tabela.</span><span class="sxs-lookup"><span data-stu-id="4fb32-125">Applications must not set SQL_CA_SS_TYPE_CATALOG_NAME for table-valued parameters.</span></span> <span data-ttu-id="4fb32-126">Caso isso ocorra, será retornado um SQL_ERROR e será gerado um registro de diagnóstico com SQLSTATE = HY091 e a mensagem "Identificador de campo de descritor inválido".</span><span class="sxs-lookup"><span data-stu-id="4fb32-126">Doing so will return a SQL_ERROR and log a diagnostic record with SQLSTATE = HY091 and the message "Invalid descriptor field identifier".</span></span>  
  
 <span data-ttu-id="4fb32-127">Os seguintes atributos de instrução e campos de cabeçalho do descritor se aplicam a parâmetros com valor de tabela quando o foco do parâmetro está definido como um parâmetro com valor de tabela:</span><span class="sxs-lookup"><span data-stu-id="4fb32-127">The following statement attributes and descriptor header fields apply to table-valued parameters when the parameter focus is set to a table-valued parameter:</span></span>  
  
|<span data-ttu-id="4fb32-128">Nome</span><span class="sxs-lookup"><span data-stu-id="4fb32-128">Name</span></span>|<span data-ttu-id="4fb32-129">Localização</span><span class="sxs-lookup"><span data-stu-id="4fb32-129">Location</span></span>|<span data-ttu-id="4fb32-130">Type</span><span class="sxs-lookup"><span data-stu-id="4fb32-130">Type</span></span>|<span data-ttu-id="4fb32-131">Descrição</span><span class="sxs-lookup"><span data-stu-id="4fb32-131">Description</span></span>|  
|----------|--------------|----------|-----------------|  
|<span data-ttu-id="4fb32-132">SQL_ATTR_PARAMSET_SIZE</span><span class="sxs-lookup"><span data-stu-id="4fb32-132">SQL_ATTR_PARAMSET_SIZE</span></span><br /><br /> <span data-ttu-id="4fb32-133">(É equivalente a SQL_DESC_ARRAY_SIZE no APD.)</span><span class="sxs-lookup"><span data-stu-id="4fb32-133">(This is equivalent to SQL_DESC_ARRAY_SIZE in the APD.)</span></span>|<span data-ttu-id="4fb32-134">APD</span><span class="sxs-lookup"><span data-stu-id="4fb32-134">APD</span></span>|<span data-ttu-id="4fb32-135">SQLUINTEGER</span><span class="sxs-lookup"><span data-stu-id="4fb32-135">SQLUINTEGER</span></span>|<span data-ttu-id="4fb32-136">O tamanho das matrizes de buffers para um parâmetro com valor de tabela.</span><span class="sxs-lookup"><span data-stu-id="4fb32-136">The array size of the buffer arrays for a table-valued parameter.</span></span> <span data-ttu-id="4fb32-137">Esse é o número máximo de linhas que os buffers irão conter ou o tamanho dos buffers em linhas; o próprio valor de parâmetro com valor de tabela pode ter mais ou menos linhas do que os buffers comportam.</span><span class="sxs-lookup"><span data-stu-id="4fb32-137">This is the maximum number of rows the buffers will accommodate or the size of the buffers in rows; the table-valued parameter value itself might have more or fewer rows than the buffers can hold.</span></span> <span data-ttu-id="4fb32-138">O padrão é UTF-1.</span><span class="sxs-lookup"><span data-stu-id="4fb32-138">Default is 1.</span></span> <span data-ttu-id="4fb32-139">**Observação:**  Se SQL_SOPT_SS_PARAM_FOCUS for definido como seu valor padrão de 0, SQL_ATTR_PARAMSET_SIZE se referirá à instrução e especificará o número de conjuntos de parâmetros.</span><span class="sxs-lookup"><span data-stu-id="4fb32-139">**Note:**  If SQL_SOPT_SS_PARAM_FOCUS is set to its default value of 0, SQL_ATTR_PARAMSET_SIZE refers to the statement and specifies the number of parameter sets.</span></span> <span data-ttu-id="4fb32-140">Se SQL_SOPT_SS_PARAM_FOCUS for definido como o ordinal de um parâmetro com valor de tabela, ele fará referência ao parâmetro com valor de tabela e especificará o número de linhas por conjunto de parâmetros para o parâmetro com valor de tabela.</span><span class="sxs-lookup"><span data-stu-id="4fb32-140">If SQL_SOPT_SS_PARAM_FOCUS is set to the ordinal of a table-valued parameter, it refers to the table-valued parameter and specifies the number of rows per parameter set for the table-valued parameter.</span></span>|  
|<span data-ttu-id="4fb32-141">SQL_ATTR_PARAM _BIND_TYPE</span><span class="sxs-lookup"><span data-stu-id="4fb32-141">SQL_ATTR_PARAM _BIND_TYPE</span></span>|<span data-ttu-id="4fb32-142">APD</span><span class="sxs-lookup"><span data-stu-id="4fb32-142">APD</span></span>|<span data-ttu-id="4fb32-143">SQLINTEGER</span><span class="sxs-lookup"><span data-stu-id="4fb32-143">SQLINTEGER</span></span>|<span data-ttu-id="4fb32-144">O padrão é SQL_PARAM_BIND_BY_COLUMN.</span><span class="sxs-lookup"><span data-stu-id="4fb32-144">The default is SQL_PARAM_BIND_BY_COLUMN.</span></span><br /><br /> <span data-ttu-id="4fb32-145">Para selecionar a associação de linha, este campo é definido como o comprimento da estrutura ou uma instância de um buffer que será associada a um conjunto de linhas de parâmetro com valor de tabela.</span><span class="sxs-lookup"><span data-stu-id="4fb32-145">To select row-wise binding, this field is set to the length of the structure or an instance of a buffer that will be bound to a set of table-valued parameter rows.</span></span> <span data-ttu-id="4fb32-146">Esse comprimento deve incluir espaço para todas as colunas associadas e qualquer preenchimento da estrutura ou do buffer.</span><span class="sxs-lookup"><span data-stu-id="4fb32-146">This length must include space for all of the bound columns and any padding of the structure or buffer.</span></span> <span data-ttu-id="4fb32-147">Isso garante que quando o endereço de uma coluna associada for incrementado com o comprimento especificado, o resultado apontará para o início da mesma coluna na linha seguinte.</span><span class="sxs-lookup"><span data-stu-id="4fb32-147">This ensures that when the address of a bound column is incremented with the specified length, the result will point to the beginning of the same column in the next row.</span></span> <span data-ttu-id="4fb32-148">Quando o operador `sizeof` é usado em ANSI C, esse comportamento é garantido.</span><span class="sxs-lookup"><span data-stu-id="4fb32-148">When using the `sizeof` operator in ANSI C, this behavior is guaranteed.</span></span>|  
|<span data-ttu-id="4fb32-149">SQL_ATTR_PARAM_BIND_OFFSET_PTR</span><span class="sxs-lookup"><span data-stu-id="4fb32-149">SQL_ATTR_PARAM_BIND_OFFSET_PTR</span></span>|<span data-ttu-id="4fb32-150">APD</span><span class="sxs-lookup"><span data-stu-id="4fb32-150">APD</span></span>|<span data-ttu-id="4fb32-151">SQLINTEGER\*</span><span class="sxs-lookup"><span data-stu-id="4fb32-151">SQLINTEGER\*</span></span>|<span data-ttu-id="4fb32-152">O padrão é um ponteiro nulo.</span><span class="sxs-lookup"><span data-stu-id="4fb32-152">The default is a null pointer.</span></span><br /><br /> <span data-ttu-id="4fb32-153">Se este campo for não nulo, o driver cancelará o ponteiro, adicionará o valor cancelado a cada um dos campos adiados no registro do descritor (SQL_DESC_DATA_PTR, SQL_DESC_INDICATOR_PTR, e SQL_DESC_OCTET_LENGTH_PTR) e usará os novos valores de ponteiro para acessar valores de dados.</span><span class="sxs-lookup"><span data-stu-id="4fb32-153">If this field is non-null, the driver dereferences the pointer, adds the dereferenced value to each of the deferred fields in the descriptor record (SQL_DESC_DATA_PTR, SQL_DESC_INDICATOR_PTR, and SQL_DESC_OCTET_LENGTH_PTR), and uses the new pointer values to access data values.</span></span>|  
  
 <span data-ttu-id="4fb32-154">Esses campos só são válidos com parâmetros com valor de tabela e são ignorados para outros tipos de dados.</span><span class="sxs-lookup"><span data-stu-id="4fb32-154">These fields are only valid with table-valued parameters, and are ignored for other data types.</span></span>  
  
 <span data-ttu-id="4fb32-155">SQL_CA_SS_TYPE_NAME é opcional para chamadas de procedimento armazenado.</span><span class="sxs-lookup"><span data-stu-id="4fb32-155">SQL_CA_SS_TYPE_NAME is optional for stored procedure calls.</span></span> <span data-ttu-id="4fb32-156">Ele deve ser especificado para instruções SQL que não são chamadas de procedimento para permitir que o servidor determine o tipo do parâmetro com valor de tabela.</span><span class="sxs-lookup"><span data-stu-id="4fb32-156">It must be specified for SQL statements that are not procedure calls to enable the server to determine the type of the table-valued parameter.</span></span>  
  
 <span data-ttu-id="4fb32-157">Se o nome do tipo for necessário e se o tipo de tabela do parâmetro com valor de tabela for definido em um esquema diferente do procedimento armazenado, SQL_CA_SS_TYPE_SCHEMA_NAME deverá ser especificado no IPD (descritor do parâmetro de implementação).</span><span class="sxs-lookup"><span data-stu-id="4fb32-157">If the type name is reqired and the table type for the table-valued parameter is defined in a different schema than the stored procedure, SQL_CA_SS_TYPE_SCHEMA_NAME must be specified in the implementation parameter descriptor (IPD).</span></span> <span data-ttu-id="4fb32-158">Caso contrário, o servidor não poderá determinar o tipo do parâmetro com valor de tabela.</span><span class="sxs-lookup"><span data-stu-id="4fb32-158">If not, the server will not be able to determine the type of the table-valued parameter.</span></span> <span data-ttu-id="4fb32-159">Isso resultará em um erro quando você chamar SQLExecute ou SQLExecDirect.</span><span class="sxs-lookup"><span data-stu-id="4fb32-159">This will result in an error when you call SQLExecute or SQLExecDirect.</span></span> <span data-ttu-id="4fb32-160">O erro terá SQLSTATE = 07006 e a mensagem "Violação do atributo de tipo de dados restrito".</span><span class="sxs-lookup"><span data-stu-id="4fb32-160">The error will have SQLSTATE= 07006 and the message "Restricted data type attribute violation".</span></span>  
  
 <span data-ttu-id="4fb32-161">As colunas de parâmetro com valor de tabela podem usar a associação de linha ou de coluna.</span><span class="sxs-lookup"><span data-stu-id="4fb32-161">Table-valued parameter columns can use either row-wise or column-wise binding.</span></span> <span data-ttu-id="4fb32-162">O padrão é a associação de coluna.</span><span class="sxs-lookup"><span data-stu-id="4fb32-162">The default is column-wise binding.</span></span> <span data-ttu-id="4fb32-163">A associação de linha pode ser especificada definindo-se SQL_ATTR_PARAM_BIND_TYPE e SQL_ATTR_ PARAM_BIND_OFFSET_PTR.</span><span class="sxs-lookup"><span data-stu-id="4fb32-163">Row-wise binding can be specified by setting SQL_ATTR_PARAM_BIND_TYPE and SQL_ATTR_ PARAM_BIND_OFFSET_PTR.</span></span> <span data-ttu-id="4fb32-164">Esse procedimento é equivalente à associação de linha de colunas e parâmetros.</span><span class="sxs-lookup"><span data-stu-id="4fb32-164">This is analogous to row-wise binding of columns and parameters.</span></span>  
  
 <span data-ttu-id="4fb32-165">Também é possível usar SQL_CA_SS_TYPE_CATALOG_NAME e SQL_CA_SS_TYPE_SCHEMA_NAME para recuperar o catálogo e o esquema associados com parâmetros de tipo definido pelo usuário CLR.</span><span class="sxs-lookup"><span data-stu-id="4fb32-165">SQL_CA_SS_TYPE_CATALOG_NAME and SQL_CA_SS_TYPE_SCHEMA_NAME can also be used to retrieve the catalog and schema associated with CLR user-defined type parameters.</span></span> <span data-ttu-id="4fb32-166">Essas são alternativas aos atributos existentes de esquema de catálogo específicos para esses tipos.</span><span class="sxs-lookup"><span data-stu-id="4fb32-166">These are alternatives to the existing type specific catalog schema attributes for these types.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="4fb32-167">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="4fb32-167">See Also</span></span>  
 [<span data-ttu-id="4fb32-168">Parâmetros com valor de tabela &#40;&#41;ODBC</span><span class="sxs-lookup"><span data-stu-id="4fb32-168">Table-Valued Parameters &#40;ODBC&#41;</span></span>](table-valued-parameters-odbc.md)  
  
  
