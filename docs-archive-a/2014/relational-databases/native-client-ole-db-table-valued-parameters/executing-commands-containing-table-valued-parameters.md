---
title: Executando comandos que contêm parâmetros com valor de tabela | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- table-valued parameters, executing commands containing
ms.assetid: 7ecba6f6-fe7a-462a-9aa3-d5115b6d4529
author: rothja
ms.author: jroth
ms.openlocfilehash: e3f616b2b9f95ae558e444bcbdae50eae123fa4c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87571374"
---
# <a name="executing-commands-containing-table-valued-parameters"></a><span data-ttu-id="fc48d-102">Executando comandos que contêm parâmetros com valor de tabela</span><span class="sxs-lookup"><span data-stu-id="fc48d-102">Executing Commands Containing Table-Valued Parameters</span></span>
  <span data-ttu-id="fc48d-103">A execução de um comando que contém parâmetros com valor de tabela exige duas fases:</span><span class="sxs-lookup"><span data-stu-id="fc48d-103">Executing a command that contains table-valued parameters requires two phases:</span></span>  
  
1.  <span data-ttu-id="fc48d-104">Especificar os tipos de parâmetros.</span><span class="sxs-lookup"><span data-stu-id="fc48d-104">Specify the parameter types.</span></span>  
  
2.  <span data-ttu-id="fc48d-105">Associar os dados de parâmetro.</span><span class="sxs-lookup"><span data-stu-id="fc48d-105">Bind the parameter data.</span></span>  
  
## <a name="table-valued-parameter-specification"></a><span data-ttu-id="fc48d-106">Especificação de parâmetros com valor de tabela</span><span class="sxs-lookup"><span data-stu-id="fc48d-106">Table-Valued Parameter Specification</span></span>  
 <span data-ttu-id="fc48d-107">O consumidor pode especificar o tipo do parâmetro com valor de tabela.</span><span class="sxs-lookup"><span data-stu-id="fc48d-107">The consumer can specify the type of the table-valued parameter.</span></span> <span data-ttu-id="fc48d-108">Estas informações incluem o nome do tipo de parâmetro com valor de tabela.</span><span class="sxs-lookup"><span data-stu-id="fc48d-108">This information includes the table-valued parameter type name.</span></span> <span data-ttu-id="fc48d-109">Elas também incluem o nome do esquema, se o tipo de tabela definido pelo usuário para o parâmetro com valor de tabela não estiver no esquema padrão atual para a conexão.</span><span class="sxs-lookup"><span data-stu-id="fc48d-109">It also includes the schema name, if the user-defined table type for the table-valued parameter is not in the current default schema for the connection.</span></span> <span data-ttu-id="fc48d-110">Dependendo do suporte do servidor, o consumidor também pode especificar informações de metadados opcionais, como a classificação de colunas, e pode especificar que todas as linhas de determinadas colunas tenham os valores padrão.</span><span class="sxs-lookup"><span data-stu-id="fc48d-110">Depending on server support, the consumer can also specify optional metadata information, such as ordering of columns, and can specify that all rows for particular columns have the default values.</span></span>  
  
 <span data-ttu-id="fc48d-111">Para especificar um parâmetro com valor de tabela, o consumidor chama ISSCommandWithParameter::SetParameterInfo e, opcionalmente, chama ISSCommandWithParameters::SetParameterProperties.</span><span class="sxs-lookup"><span data-stu-id="fc48d-111">To specify a table-valued parameter, the consumer calls ISSCommandWithParameter::SetParameterInfo, and optionally calls ISSCommandWithParameters::SetParameterProperties.</span></span> <span data-ttu-id="fc48d-112">Para um parâmetro com valor de tabela, o campo *pwszDataSourceType* na estrutura DBPARAMBINDINFO tem um valor DBTYPE_TABLE.</span><span class="sxs-lookup"><span data-stu-id="fc48d-112">For a table-valued parameter, the *pwszDataSourceType* field in the DBPARAMBINDINFO structure has a value of DBTYPE_TABLE.</span></span> <span data-ttu-id="fc48d-113">O campo *ulParamSize* é definido como ~0 para indicar que esse tamanho é desconhecido.</span><span class="sxs-lookup"><span data-stu-id="fc48d-113">The *ulParamSize* field is set to ~0 to indicate that length is unknown.</span></span> <span data-ttu-id="fc48d-114">As propriedades específicas de parâmetros com valor de tabela, como o nome do esquema, o nome do tipo, a ordem das colunas e as colunas padrão, podem ser definidas por meio de ISSCommandWithParameters::SetParameterProperties.</span><span class="sxs-lookup"><span data-stu-id="fc48d-114">Particular properties for table-valued parameters, such as schema name, type name, column order, and default columns, can be set through ISSCommandWithParameters::SetParameterProperties.</span></span>  
  
## <a name="table-valued-parameter-binding"></a><span data-ttu-id="fc48d-115">Associação de parâmetros com valor de tabela</span><span class="sxs-lookup"><span data-stu-id="fc48d-115">Table-Valued Parameter Binding</span></span>  
 <span data-ttu-id="fc48d-116">Um parâmetro com valor de tabela pode ser qualquer objeto de conjunto de linhas.</span><span class="sxs-lookup"><span data-stu-id="fc48d-116">A table-valued parameter can be any rowset object.</span></span> <span data-ttu-id="fc48d-117">O provedor faz a leitura a partir deste objeto enquanto envia parâmetros com valor de tabela ao servidor durante a execução.</span><span class="sxs-lookup"><span data-stu-id="fc48d-117">The provider reads from this object while sending table-valued parameters to the server during execution.</span></span>  
  
 <span data-ttu-id="fc48d-118">Para associar o parâmetro com valor de tabela, o consumidor chama IAccessor::CreateAccessor.</span><span class="sxs-lookup"><span data-stu-id="fc48d-118">To bind the table-valued parameter, the consumer calls IAccessor::CreateAccessor.</span></span> <span data-ttu-id="fc48d-119">O campo *wType* da estrutura DBBINDING para o parâmetro com valor de tabela é definido como DBTYPE_TABLE.</span><span class="sxs-lookup"><span data-stu-id="fc48d-119">The *wType* field of the DBBINDING structure for the table-valued parameter is set to DBTYPE_TABLE.</span></span> <span data-ttu-id="fc48d-120">O membro *pObject* da estrutura DBBINDING é não NULL, e o membro *iid* de *pObject* é definido como IID_IRowset ou como qualquer outra interface de objetos de conjunto de linhas do parâmetro com valor de tabela.</span><span class="sxs-lookup"><span data-stu-id="fc48d-120">The *pObject* member of the DBBINDING structure is non-NULL, and the *pObject*'s *iid* member is set to IID_IRowset or any other table-valued parameter rowset object interfaces.</span></span> <span data-ttu-id="fc48d-121">Os campos restantes na estrutura DBBINDING devem ser definidos da mesma forma que são definidos para BLOBs transmitidos.</span><span class="sxs-lookup"><span data-stu-id="fc48d-121">The remaining fields in the DBBINDING structure should be set the same way they are set for streamed BLOBs.</span></span>  
  
 <span data-ttu-id="fc48d-122">Nas associações para o parâmetro com valor de tabela e o objeto de conjunto de linhas associado a um parâmetro com valor de tabela, as seguintes restrições se aplicam:</span><span class="sxs-lookup"><span data-stu-id="fc48d-122">In the bindings for the table-valued parameter and the rowset object associated with a table-valued parameter, the following restrictions apply:</span></span>  
  
-   <span data-ttu-id="fc48d-123">Os únicos valores de status permitidos para dados da coluna do conjunto de linhas do parâmetro com valor de tabela são DBSTATUS_S_ISNULL e DBSTATUS_S_OK.</span><span class="sxs-lookup"><span data-stu-id="fc48d-123">The only status values allowed for table-valued parameter rowset column data are DBSTATUS_S_ISNULL and DBSTATUS_S_OK.</span></span> <span data-ttu-id="fc48d-124">DBSTATUS_S_DEFAULT resultará em falha e o valor de status associado será definido como DBSTATUS_E_BADSTATUS.</span><span class="sxs-lookup"><span data-stu-id="fc48d-124">DBSTATUS_S_DEFAULT will result in a failure, and the bound status value will be set to DBSTATUS_E_BADSTATUS.</span></span>  
  
-   <span data-ttu-id="fc48d-125">Um parâmetro com valor de tabela pode ser marcado com o status DBSTATUS_S_DEFAULT.</span><span class="sxs-lookup"><span data-stu-id="fc48d-125">A table-valued parameter can be marked with the status DBSTATUS_S_DEFAULT.</span></span> <span data-ttu-id="fc48d-126">Os únicos valores válidos são DBSTATUS_S_DEFAULT e DBSTATUS_S_OK.</span><span class="sxs-lookup"><span data-stu-id="fc48d-126">The only valid values are DBSTATUS_S_DEFAULT and DBSTATUS_S_OK.</span></span> <span data-ttu-id="fc48d-127">Quando o status é definido como DBSTATUS_S_DEFAULT, o valor do parâmetro com valor de tabela corresponde a uma tabela vazia.</span><span class="sxs-lookup"><span data-stu-id="fc48d-127">When the status is set to DBSTATUS_S_DEFAULT, the value of the table-valued parameter corresponds to an empty table.</span></span>  
  
-   <span data-ttu-id="fc48d-128">As colunas somente leitura em parâmetros com valor de tabela (colunas de identidade ou computadas) devem ser marcadas como padrão usando a propriedade SSPROP_PARAM_TABLE_DEFAULT_COLUMNS.</span><span class="sxs-lookup"><span data-stu-id="fc48d-128">Read-only columns in table-valued parameters (identity or computed columns) must be marked as default by using the SSPROP_PARAM_TABLE_DEFAULT_COLUMNS property.</span></span> <span data-ttu-id="fc48d-129">As colunas com um valor padrão também devem ser marcadas como padrão por meio da propriedade SSPROP_PARAM_TABLE_DEFAULT_COLUMNS de forma a permitir que o valor padrão seja usado para os valores de dados da coluna para um determinado parâmetro com valor de tabela.</span><span class="sxs-lookup"><span data-stu-id="fc48d-129">Columns that have a default value must also be marked as default through SSPROP_PARAM_TABLE_DEFAULT_COLUMNS property to allow the default value to be used for the column's data values for a particular table-valued parameter.</span></span> <span data-ttu-id="fc48d-130">O provedor irá ignorar os valores de dados associados com as colunas marcadas como padrão.</span><span class="sxs-lookup"><span data-stu-id="fc48d-130">The provider will ignore the data values bound for the columns marked as default.</span></span>  
  
-   <span data-ttu-id="fc48d-131">Os dados serão enviados ao servidor para colunas com DBPROP_COL_AUTOINCREMENT ou SSPROP_COL_COMPUTED, a menos que SSPROP_PARAM_TABLE_DEFAULT também esteja definido.</span><span class="sxs-lookup"><span data-stu-id="fc48d-131">Data will be sent to the server for columns with DBPROP_COL_AUTOINCREMENT or SSPROP_COL_COMPUTED, unless SSPROP_PARAM_TABLE_DEFAULT is also set.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="fc48d-132">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="fc48d-132">See Also</span></span>  
 <span data-ttu-id="fc48d-133">[Os parâmetros com valor de tabela &#40;OLE DB&#41;](table-valued-parameters-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="fc48d-133">[Table-Valued Parameters &#40;OLE DB&#41;](table-valued-parameters-ole-db.md) </span></span>  
 [<span data-ttu-id="fc48d-134">Usar parâmetros com valor de tabela &#40;OLE DB&#41;</span><span class="sxs-lookup"><span data-stu-id="fc48d-134">Use Table-Valued Parameters &#40;OLE DB&#41;</span></span>](../native-client-ole-db-how-to/use-table-valued-parameters-ole-db.md)  
  
  
