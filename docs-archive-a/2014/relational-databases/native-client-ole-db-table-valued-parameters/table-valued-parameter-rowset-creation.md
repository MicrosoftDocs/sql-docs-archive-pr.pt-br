---
title: Criação do conjunto de linhas do parâmetro com valor de tabela | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- table-valued parameters, rowset creation
ms.assetid: ffe213ca-cc0e-465e-b31c-a8272324c4fe
author: rothja
ms.author: jroth
ms.openlocfilehash: a22ccbd583d95c41daa0a113363985828cf1e9d6
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87572026"
---
# <a name="table-valued-parameter-rowset-creation"></a><span data-ttu-id="453a3-102">Criação do conjunto de linhas do parâmetro com valor de tabela</span><span class="sxs-lookup"><span data-stu-id="453a3-102">Table-Valued Parameter Rowset Creation</span></span>
  <span data-ttu-id="453a3-103">Embora os consumidores possam fornecer qualquer objeto do conjunto de linhas a parâmetros com valor de tabela, objetos do conjunto de linhas típicos são implementados com relação a armazenamentos de dados de back-end e, portanto, fornecem desempenho limitado.</span><span class="sxs-lookup"><span data-stu-id="453a3-103">Although consumers can provide any rowset object for table-valued parameters, typical rowset objects are implemented against back-end data stores, and therefore provide limited performance.</span></span> <span data-ttu-id="453a3-104">Por isso, o provedor OLE DB do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client permite que os consumidores criem um objeto de conjunto de linhas especializado sobre os dados da memória.</span><span class="sxs-lookup"><span data-stu-id="453a3-104">For this reason, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB Provider enables consumers to create a specialized rowset object on top of in-memory data.</span></span> <span data-ttu-id="453a3-105">Esse objeto de conjunto de linhas em memória especial é um novo objeto COM chamado conjunto de linhas de parâmetro COM valor de tabela.</span><span class="sxs-lookup"><span data-stu-id="453a3-105">This special, in-memory rowset object is a new COM object called a table-valued parameter rowset .</span></span> <span data-ttu-id="453a3-106">Ele fornece funcionalidade semelhante para conjuntos de parâmetro.</span><span class="sxs-lookup"><span data-stu-id="453a3-106">It provides functionality similar to parameter sets.</span></span>  
  
 <span data-ttu-id="453a3-107">Os objetos do conjunto de linhas do parâmetro com valor de tabela são criados explicitamente pelo consumidor para parâmetros de entrada por meio de várias interfaces no nível da sessão.</span><span class="sxs-lookup"><span data-stu-id="453a3-107">Table-valued parameter rowset objects are created explicitly by the consumer for input parameters through multiple session-level interfaces.</span></span> <span data-ttu-id="453a3-108">Há uma instância de um objeto do conjunto de linhas do parâmetro com valor de tabela por parâmetro com valor de tabela.</span><span class="sxs-lookup"><span data-stu-id="453a3-108">There is one instance of a table-valued parameter rowset object per table-valued parameter.</span></span> <span data-ttu-id="453a3-109">O consumidor pode criar os objetos do conjunto de linhas do parâmetro com valor de tabela fornecendo informações de metadados já conhecidas (cenário estático) ou descobrindo-as por meio das interfaces do provedor (cenário dinâmico).</span><span class="sxs-lookup"><span data-stu-id="453a3-109">The consumer can create the table-valued parameter rowset objects either by providing metadata information that is already known (static scenario), or by discovering it through provider interfaces (dynamic scenario).</span></span> <span data-ttu-id="453a3-110">As seções a seguir descrevem estes dois cenários.</span><span class="sxs-lookup"><span data-stu-id="453a3-110">The following sections describe these two scenarios.</span></span>  
  
## <a name="static-scenario"></a><span data-ttu-id="453a3-111">Cenário estático</span><span class="sxs-lookup"><span data-stu-id="453a3-111">Static Scenario</span></span>  
 <span data-ttu-id="453a3-112">Quando as informações de tipo são conhecidas, o consumidor usa ITableDefinitionWithConstraints::CreateTableWithConstraints para criar uma instância de um conjunto de linhas do parâmetro com valor de tabela que corresponda a um parâmetro com valor de tabela.</span><span class="sxs-lookup"><span data-stu-id="453a3-112">When the type information is known, the consumer uses ITableDefinitionWithConstraints::CreateTableWithConstraints to instantiate a table-valued parameter rowset object that corresponds to a table-valued parameter.</span></span>  
  
 <span data-ttu-id="453a3-113">O campo *guid* (parâmetro *pTableID*) contém a GUID especial (CLSID_ROWSET_TVP).</span><span class="sxs-lookup"><span data-stu-id="453a3-113">The *guid* field (*pTableID* parameter) contains the special GUID (CLSID_ROWSET_TVP).</span></span> <span data-ttu-id="453a3-114">O membro *pwszName* contém o nome do tipo de parâmetro com valor de tabela para o qual o consumidor deseja criar uma instância.</span><span class="sxs-lookup"><span data-stu-id="453a3-114">The *pwszName* member contains the name of the table-valued parameter type that the consumer wants to instantiate.</span></span> <span data-ttu-id="453a3-115">O campo *eKind* será definido como DBKIND_GUID_NAME.</span><span class="sxs-lookup"><span data-stu-id="453a3-115">The *eKind* field will be set to DBKIND_GUID_NAME.</span></span> <span data-ttu-id="453a3-116">Esse nome é necessário quando a instrução for ad hoc SQL; o nome é opcional, se for uma chamada de procedimento.</span><span class="sxs-lookup"><span data-stu-id="453a3-116">This name is required when the statement is ad hoc SQL; the name is optional if it is a procedure call.</span></span>  
  
 <span data-ttu-id="453a3-117">Para agregação, o consumidor transmite o parâmetro *pUnkOuter* com o controlador IUnknown.</span><span class="sxs-lookup"><span data-stu-id="453a3-117">For aggregation, the consumer passes the *pUnkOuter* parameter with the controlling IUnknown.</span></span>  
  
 <span data-ttu-id="453a3-118">As propriedades do objeto conjunto de linhas de parâmetro com valor de tabela são somente leitura, portanto, não se espera que o consumidor defina as propriedades em *rgPropertySets*.</span><span class="sxs-lookup"><span data-stu-id="453a3-118">The table-valued parameter rowset object properties are read only, so the consumer is not expected to set any properties in *rgPropertySets*.</span></span>  
  
 <span data-ttu-id="453a3-119">Para o membro *rgPropertySets* de cada estrutura DBCOLUMNDESC, o consumidor pode especificar propriedades adicionais para cada coluna.</span><span class="sxs-lookup"><span data-stu-id="453a3-119">For the *rgPropertySets* member of each DBCOLUMNDESC structure, the consumer can specify additional properties for each column.</span></span> <span data-ttu-id="453a3-120">Essas propriedades pertencem ao conjunto de propriedades DBPROPSET_SQLSERVERCOLUMN.</span><span class="sxs-lookup"><span data-stu-id="453a3-120">These properties belong to the DBPROPSET_SQLSERVERCOLUMN property set.</span></span> <span data-ttu-id="453a3-121">Elas permitem que você especifique as configurações computadas e padrão de cada coluna.</span><span class="sxs-lookup"><span data-stu-id="453a3-121">They enable you to specify computed and default settings for each column.</span></span> <span data-ttu-id="453a3-122">Elas também dão suporte a propriedades de coluna existentes, como nulidade e identidade.</span><span class="sxs-lookup"><span data-stu-id="453a3-122">They also support existing column properties, such as nullability and identity.</span></span>  
  
 <span data-ttu-id="453a3-123">Para recuperar informações correspondentes de um objeto do conjunto de linhas do parâmetro com valor de tabela, o consumidor usa IRowsetInfo::GetProperties.</span><span class="sxs-lookup"><span data-stu-id="453a3-123">To retrieve corresponding information from a table-valued parameter rowset object, the consumer uses IRowsetInfo::GetProperties.</span></span>  
  
 <span data-ttu-id="453a3-124">Para recuperar informações sobre o status nulo, exclusivo, computado e de atualização de cada coluna, o consumidor usa IColumnsRowset:: GetColumnsRowset ou IColumnsInfo:: GetColumnInfo.</span><span class="sxs-lookup"><span data-stu-id="453a3-124">To retrieve information about the null, unique, computed, and update status of each column, the consumer use IColumnsRowset::GetColumnsRowset or IColumnsInfo::GetColumnInfo.</span></span> <span data-ttu-id="453a3-125">Esses métodos fornecem informações detalhadas sobre cada coluna do conjunto de linhas do parâmetro com valor de tabela.</span><span class="sxs-lookup"><span data-stu-id="453a3-125">These methods provide detailed information about each table-valued parameter rowset column.</span></span>  
  
 <span data-ttu-id="453a3-126">O consumidor especifica o tipo de cada coluna do parâmetro com valor de tabela.</span><span class="sxs-lookup"><span data-stu-id="453a3-126">The consumer specifies the type of each column of the table-valued parameter.</span></span> <span data-ttu-id="453a3-127">Esse procedimento é semelhante à forma de especificação de colunas quando uma tabela é criada no [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="453a3-127">This is similar to how columns are specified when a table is created in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="453a3-128">O consumidor obtém um objeto de conjunto de linhas de parâmetro com valor de tabela do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] provedor de OLE DB de cliente nativo por meio do parâmetro de saída *ppRowset* .</span><span class="sxs-lookup"><span data-stu-id="453a3-128">The consumer obtains a table-valued parameter rowset object from the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB Provider through the *ppRowset* output parameter.</span></span>  
  
## <a name="dynamic-scenario"></a><span data-ttu-id="453a3-129">Cenário dinâmico</span><span class="sxs-lookup"><span data-stu-id="453a3-129">Dynamic Scenario</span></span>  
 <span data-ttu-id="453a3-130">Quando o consumidor não tem informações de tipo, ele deve usar IOpenRowset:: OpenRowset para instanciar objetos de conjunto de linhas de parâmetro com valor de tabela.</span><span class="sxs-lookup"><span data-stu-id="453a3-130">When the consumer does not have type information, it should use IOpenRowset::OpenRowset to instantiate table-valued parameter rowset objects.</span></span> <span data-ttu-id="453a3-131">O consumidor deve fornecer ao provedor somente o nome do tipo.</span><span class="sxs-lookup"><span data-stu-id="453a3-131">All the consumer has to provide to the provider is the type name.</span></span>  
  
 <span data-ttu-id="453a3-132">Nesse cenário, o provedor obtém as informações de tipo sobre um objeto do conjunto de linhas do parâmetro com valor de tabela do servidor em nome do consumidor.</span><span class="sxs-lookup"><span data-stu-id="453a3-132">In this scenario, the provider obtains type information about a table-valued parameter rowset object from the server on behalf of the consumer.</span></span>  
  
 <span data-ttu-id="453a3-133">Os parâmetros *pTableID* e *pUnkOuter* devem ser definidos como no cenário estático.</span><span class="sxs-lookup"><span data-stu-id="453a3-133">The *pTableID* and *pUnkOuter* parameters should be set as in the static scenario.</span></span> <span data-ttu-id="453a3-134">O [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] provedor de OLE DB de cliente nativo obtém as informações de tipo (restrições e informações de coluna) do servidor e retorna um objeto de conjunto de linhas de parâmetro com valor de tabela por meio do parâmetro *ppRowset* .</span><span class="sxs-lookup"><span data-stu-id="453a3-134">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB Provider then obtains the type information (column information and constraints) from the server, and return a table-valued parameter rowset object through the *ppRowset* parameter.</span></span> <span data-ttu-id="453a3-135">Essa operação requer comunicação com o servidor e, portanto, não tem desempenho tão bom quanto no cenário estático.</span><span class="sxs-lookup"><span data-stu-id="453a3-135">This operation requires communication with the server, and therefore does not perform as well as the static scenario.</span></span> <span data-ttu-id="453a3-136">O cenário dinâmico só funciona com chamadas de procedimento com parâmetros.</span><span class="sxs-lookup"><span data-stu-id="453a3-136">The dynamic scenario works only with parameterized procedure calls.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="453a3-137">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="453a3-137">See Also</span></span>  
 <span data-ttu-id="453a3-138">[Os parâmetros com valor de tabela &#40;OLE DB&#41;](table-valued-parameters-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="453a3-138">[Table-Valued Parameters &#40;OLE DB&#41;](table-valued-parameters-ole-db.md) </span></span>  
 [<span data-ttu-id="453a3-139">Usar parâmetros com valor de tabela &#40;OLE DB&#41;</span><span class="sxs-lookup"><span data-stu-id="453a3-139">Use Table-Valued Parameters &#40;OLE DB&#41;</span></span>](../native-client-ole-db-how-to/use-table-valued-parameters-ole-db.md)  
  
  
