---
title: Configurar segurança de caixa de diálogo para notificações de evento | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: security
ms.topic: conceptual
helpviewer_keywords:
- event notifications [SQL Server], security
ms.assetid: 12afbc84-2d2a-4452-935e-e1c70e8c53c1
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: d83bfe63c3a9b24c2be8d08916dd2384c59edc93
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87581722"
---
# <a name="configure-dialog-security-for-event-notifications"></a><span data-ttu-id="acb6f-102">Configurar segurança de caixa de diálogo para notificações de evento</span><span class="sxs-lookup"><span data-stu-id="acb6f-102">Configure Dialog Security for Event Notifications</span></span>
  [!INCLUDE[ssSB](../../includes/sssb-md.md)] <span data-ttu-id="acb6f-103">deve ser configurada para notificações de eventos que enviam mensagens a um agente de serviços em um servidor remoto.</span><span class="sxs-lookup"><span data-stu-id="acb6f-103">dialog security should be configured for event notifications that send messages to a service broker on a remote server.</span></span> <span data-ttu-id="acb6f-104">A segurança de diálogo deve ser configurada manualmente, de acordo com o modelo de segurança total de diálogo do [!INCLUDE[ssSB](../../includes/sssb-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="acb6f-104">Dialog security must be manually configured according to the [!INCLUDE[ssSB](../../includes/sssb-md.md)] dialog full-security model.</span></span> <span data-ttu-id="acb6f-105">O modelo de segurança total habilita criptografia e decodificação de mensagens enviadas para e de servidores remotos.</span><span class="sxs-lookup"><span data-stu-id="acb6f-105">The full-security model enables encryption and decryption of messages that are sent to and from remote servers.</span></span> <span data-ttu-id="acb6f-106">Embora as notificações de eventos sejam enviadas em uma única direção, outras mensagens, como erros, também são retornadas para a direção oposta.</span><span class="sxs-lookup"><span data-stu-id="acb6f-106">Although event notifications are sent in one direction, other messages, such as errors, are also returned in the opposite direction.</span></span>  
  
## <a name="configuring-dialog-security-for-event-notifications"></a><span data-ttu-id="acb6f-107">Configurando segurança de diálogo para notificações de eventos</span><span class="sxs-lookup"><span data-stu-id="acb6f-107">Configuring Dialog Security for Event Notifications</span></span>  
 <span data-ttu-id="acb6f-108">O processo necessário para implementar segurança de diálogo para notificação de eventos é descrito nas etapas a seguir.</span><span class="sxs-lookup"><span data-stu-id="acb6f-108">The process required to implement dialog security for event notification is described in the following steps.</span></span> <span data-ttu-id="acb6f-109">Elas compreendem ações a serem efetuadas tanto no servidor de origem, quanto no servidor de destino.</span><span class="sxs-lookup"><span data-stu-id="acb6f-109">These steps include actions to take on both the source server and the target server.</span></span> <span data-ttu-id="acb6f-110">O servidor de origem é o servidor no qual a notificação de eventos está sendo criada.</span><span class="sxs-lookup"><span data-stu-id="acb6f-110">The source server is the server on which the event notification is being created.</span></span> <span data-ttu-id="acb6f-111">O servidor de destino é o servidor que recebe a mensagem de notificação de eventos.</span><span class="sxs-lookup"><span data-stu-id="acb6f-111">The target server is the server that receives the event notification message.</span></span> <span data-ttu-id="acb6f-112">É necessário completar as ações de cada etapa em ambos os servidores, de origem e de destino, para poder passar à etapa seguinte.</span><span class="sxs-lookup"><span data-stu-id="acb6f-112">You must complete the actions in each step for both the source server and the target server before you continue to the next step.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="acb6f-113">Todos os certificados devem ser criados com datas válidas de início e de validade.</span><span class="sxs-lookup"><span data-stu-id="acb6f-113">All certificates must be created with valid start and expiration dates.</span></span>  
  
 <span data-ttu-id="acb6f-114">**Etapa 1: Estabeleça um número da porta de TCP e o nome do serviço de destino.**</span><span class="sxs-lookup"><span data-stu-id="acb6f-114">**Step 1: Establish a TCP port number and target service name.**</span></span>  
  
 <span data-ttu-id="acb6f-115">Estabeleça a porta de TCP pela qual o servidor de origem e o servidor de destino receberão mensagens.</span><span class="sxs-lookup"><span data-stu-id="acb6f-115">Establish the TCP port on which both the source server and the target server will receive messages.</span></span> <span data-ttu-id="acb6f-116">Você também deve determinar o nome do serviço de destino.</span><span class="sxs-lookup"><span data-stu-id="acb6f-116">You must also determine the name of the target service.</span></span>  
  
 <span data-ttu-id="acb6f-117">**Etapa 2: Configure criptografia e compartilhamento de certificados para autenticação em nível de banco de dados.**</span><span class="sxs-lookup"><span data-stu-id="acb6f-117">**Step 2: Configure encryption and certificate sharing for database-level authentication.**</span></span>  
  
 <span data-ttu-id="acb6f-118">Efetue as ações abaixo nos servidores de origem e de destino.</span><span class="sxs-lookup"><span data-stu-id="acb6f-118">Complete the following actions on both the source and target servers.</span></span>  
  
|<span data-ttu-id="acb6f-119">Servidor de origem</span><span class="sxs-lookup"><span data-stu-id="acb6f-119">Source server</span></span>|<span data-ttu-id="acb6f-120">Servidor de destino</span><span class="sxs-lookup"><span data-stu-id="acb6f-120">Target server</span></span>|  
|-------------------|-------------------|  
|<span data-ttu-id="acb6f-121">Escolha ou crie um banco de dados para guardar a notificação de eventos e a chave mestra.</span><span class="sxs-lookup"><span data-stu-id="acb6f-121">Choose or create a database to hold the event notification and master key.</span></span>|<span data-ttu-id="acb6f-122">Escolha ou crie um banco de dados para guardar a chave mestra.</span><span class="sxs-lookup"><span data-stu-id="acb6f-122">Choose or create a database to hold the master key.</span></span>|  
|<span data-ttu-id="acb6f-123">Se não existir uma chave mestra para o banco de dados de origem, [crie uma chave mestra](/sql/t-sql/statements/create-master-key-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="acb6f-123">If no master key exists for the source database, [create a master key](/sql/t-sql/statements/create-master-key-transact-sql).</span></span> <span data-ttu-id="acb6f-124">É necessária uma chave mestra em ambos os bancos de dados (origem e destino), para ajudar a proteger seus respectivos certificados.</span><span class="sxs-lookup"><span data-stu-id="acb6f-124">A master key is required on both the source and target databases to help secure their respective certificates.</span></span>|<span data-ttu-id="acb6f-125">Se não existir uma chave mestra para o banco de dados de destino, crie uma chave mestra.</span><span class="sxs-lookup"><span data-stu-id="acb6f-125">If no master key exists for the target database, create a master key.</span></span>|  
|<span data-ttu-id="acb6f-126">[Crie um logon](/sql/t-sql/statements/create-login-transact-sql) e um [usuário](/sql/t-sql/statements/create-user-transact-sql) correspondente para o banco de dados de origem.</span><span class="sxs-lookup"><span data-stu-id="acb6f-126">[Create a login](/sql/t-sql/statements/create-login-transact-sql) and a corresponding [user](/sql/t-sql/statements/create-user-transact-sql) for the source database.</span></span>|<span data-ttu-id="acb6f-127">Crie um logon e um usuário correspondente para o banco de dados de destino.</span><span class="sxs-lookup"><span data-stu-id="acb6f-127">Create a login and a corresponding user for the target database.</span></span>|  
|<span data-ttu-id="acb6f-128">[Crie um certificado](/sql/t-sql/statements/create-certificate-transact-sql) de propriedade do usuário do banco de dados de origem.</span><span class="sxs-lookup"><span data-stu-id="acb6f-128">[Create a certificate](/sql/t-sql/statements/create-certificate-transact-sql) that is owned by the user of the source database.</span></span>|<span data-ttu-id="acb6f-129">Crie um certificado de propriedade do usuário do banco de dados de destino.</span><span class="sxs-lookup"><span data-stu-id="acb6f-129">Create a certificate that is owned by the user of the target database.</span></span>|  
|<span data-ttu-id="acb6f-130">[Faça um backup do certificado](/sql/t-sql/statements/backup-certificate-transact-sql) em um arquivo que possa ser acessado pelo servidor de destino.</span><span class="sxs-lookup"><span data-stu-id="acb6f-130">[Back up the certificate](/sql/t-sql/statements/backup-certificate-transact-sql) to a file that can be accessed by the target server.</span></span>|<span data-ttu-id="acb6f-131">Faça um backup do certificado em um arquivo que possa ser acessado pelo servidor de origem.</span><span class="sxs-lookup"><span data-stu-id="acb6f-131">Back up the certificate to a file that can be accessed by the source server.</span></span>|  
|<span data-ttu-id="acb6f-132">[Crie um usuário](/sql/t-sql/statements/create-user-transact-sql), especificando o usuário do banco de dados de destino e WITHOUT LOGIN.</span><span class="sxs-lookup"><span data-stu-id="acb6f-132">[Create a user](/sql/t-sql/statements/create-user-transact-sql), specifying the user of the target database, and WITHOUT LOGIN.</span></span> <span data-ttu-id="acb6f-133">Este usuário será proprietário do certificado de banco de dados de destino a ser criado a partir do arquivo de backup.</span><span class="sxs-lookup"><span data-stu-id="acb6f-133">This user will own the target database certificate to be created from the backup file.</span></span> <span data-ttu-id="acb6f-134">O usuário não precisa ser mapeado para um logon, pois seu único propósito é possuir o certificado de banco de dados de destino criado na etapa 3 abaixo.</span><span class="sxs-lookup"><span data-stu-id="acb6f-134">The user does not have to be mapped to a login, because the only purpose of this user is to own the target database certificate created in step 3 that follows.</span></span>|<span data-ttu-id="acb6f-135">Crie um usuário, especificando o usuário do banco de dados de origem e WITHOUT LOGIN.</span><span class="sxs-lookup"><span data-stu-id="acb6f-135">Create a user, specifying the user of the source database, and WITHOUT LOGIN.</span></span> <span data-ttu-id="acb6f-136">Este usuário será proprietário do certificado de banco de dados de origem a ser criado a partir do arquivo de backup.</span><span class="sxs-lookup"><span data-stu-id="acb6f-136">This user will own the source database certificate to be created from the backup file.</span></span> <span data-ttu-id="acb6f-137">O usuário não precisa ser mapeado para um logon, pois seu único propósito é possuir o certificado de banco de dados de origem criado na etapa 3 abaixo.</span><span class="sxs-lookup"><span data-stu-id="acb6f-137">The user does not have to be mapped to a login, because the only purpose of this user is to own the source database certificate created in step 3 that follows.</span></span>|  
  
 <span data-ttu-id="acb6f-138">**Etapa 3: Compartilhe os certificados e conceda permissões para autenticação em nível de banco de dados.**</span><span class="sxs-lookup"><span data-stu-id="acb6f-138">**Step 3: Share certificates and grant permissions for database-level authentication.**</span></span>  
  
 <span data-ttu-id="acb6f-139">Efetue as ações abaixo nos servidores de origem e de destino.</span><span class="sxs-lookup"><span data-stu-id="acb6f-139">Complete the following actions on both the source and target servers.</span></span>  
  
|<span data-ttu-id="acb6f-140">Servidor de origem</span><span class="sxs-lookup"><span data-stu-id="acb6f-140">Source server</span></span>|<span data-ttu-id="acb6f-141">Servidor de destino</span><span class="sxs-lookup"><span data-stu-id="acb6f-141">Target server</span></span>|  
|-------------------|-------------------|  
|<span data-ttu-id="acb6f-142">[Crie um certificado](/sql/t-sql/statements/create-certificate-transact-sql) a partir do arquivo de backup do certificado de destino, especificando o usuário do banco de dados de destino como o proprietário.</span><span class="sxs-lookup"><span data-stu-id="acb6f-142">[Create a certificate](/sql/t-sql/statements/create-certificate-transact-sql) from the backup file of the target certificate, specifying the target database user as the owner.</span></span>|<span data-ttu-id="acb6f-143">Crie um certificado a partir do arquivo de backup do certificado de origem, especificando o usuário do banco de dados de origem como o proprietário.</span><span class="sxs-lookup"><span data-stu-id="acb6f-143">Create a certificate from the backup file of the source certificate, specifying the source database user as the owner.</span></span>|  
|<span data-ttu-id="acb6f-144">[Conceda permissão](/sql/t-sql/statements/grant-transact-sql) para criar a notificação de eventos para o usuário do banco de dados de origem.</span><span class="sxs-lookup"><span data-stu-id="acb6f-144">[Grant permission](/sql/t-sql/statements/grant-transact-sql) to create the event notification to the source database user.</span></span> <span data-ttu-id="acb6f-145">Para obter mais informações sobre essa permissão, consulte [CREATE EVENT NOTIFICATION &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-event-notification-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="acb6f-145">For more information about this permission, see [CREATE EVENT NOTIFICATION &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-event-notification-transact-sql).</span></span>|<span data-ttu-id="acb6f-146">Conceda a permissão REFERENCES ao usuário do banco de dados de destino no contrato de notificações de eventos existentes do [!INCLUDE[ssSB](../../includes/sssb-md.md)] : `https://schemas.microsoft.com/SQL/Notifications/PostEventNotification`.</span><span class="sxs-lookup"><span data-stu-id="acb6f-146">Grant REFERENCES permission to the target database user on the existing event notifications [!INCLUDE[ssSB](../../includes/sssb-md.md)] contract: `https://schemas.microsoft.com/SQL/Notifications/PostEventNotification`.</span></span>|  
|<span data-ttu-id="acb6f-147">[Crie uma associação de serviço remoto](/sql/t-sql/statements/create-remote-service-binding-transact-sql) ao serviço de destino e especifique as credenciais do usuário do banco de dados de destino.</span><span class="sxs-lookup"><span data-stu-id="acb6f-147">[Create a remote service binding](/sql/t-sql/statements/create-remote-service-binding-transact-sql) to the target service and specify the credentials of the target database user.</span></span> <span data-ttu-id="acb6f-148">A associação do serviço remoto garante que a chave pública no certificado de propriedade do usuário do banco de dados de origem autentique as mensagens enviadas ao servidor de destino.</span><span class="sxs-lookup"><span data-stu-id="acb6f-148">The remote service binding guarantees that the public key in the certificate owned by the source database user will authenticate messages that are sent to the target server.</span></span>|<span data-ttu-id="acb6f-149">[Conceda](/sql/t-sql/statements/grant-transact-sql) permissões CREATE QUEUE, CREATE SERVICE e CREATE SCHEMA ao usuário do banco de dados de destino.</span><span class="sxs-lookup"><span data-stu-id="acb6f-149">[Grant](/sql/t-sql/statements/grant-transact-sql) CREATE QUEUE, CREATE SERVICE, and CREATE SCHEMA permissions to the target database user.</span></span>|  
||<span data-ttu-id="acb6f-150">Caso ainda não esteja conectado ao banco de dados como usuário do banco de dados de destino, faça-o agora.</span><span class="sxs-lookup"><span data-stu-id="acb6f-150">If not already connected to the database as the target database user, do so now.</span></span>|  
||<span data-ttu-id="acb6f-151">[Crie uma fila](/sql/t-sql/statements/create-queue-transact-sql) para receber as mensagens de notificação de eventos e [crie um serviço](/sql/t-sql/statements/create-service-transact-sql) para entregar as mensagens.</span><span class="sxs-lookup"><span data-stu-id="acb6f-151">[Create a queue](/sql/t-sql/statements/create-queue-transact-sql) to receive the event notification messages and [create a service](/sql/t-sql/statements/create-service-transact-sql) to deliver the messages.</span></span>|  
||<span data-ttu-id="acb6f-152">[Conceda permissão SEND](/sql/t-sql/statements/grant-transact-sql) no serviço de destino ao usuário do banco de dados de origem.</span><span class="sxs-lookup"><span data-stu-id="acb6f-152">[Grant SEND permission](/sql/t-sql/statements/grant-transact-sql) on the target service to the source database user.</span></span>|  
|<span data-ttu-id="acb6f-153">Forneça o identificador do agente de serviços do banco de dados de origem para o servidor de destino.</span><span class="sxs-lookup"><span data-stu-id="acb6f-153">Provide the service broker identifier of the source database to the target server.</span></span> <span data-ttu-id="acb6f-154">Esse identificador pode ser obtido consultando-se a coluna **service_broker_guid** da exibição de catálogo [sys.databases](/sql/relational-databases/system-catalog-views/sys-databases-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="acb6f-154">This identifier can be obtained by querying the **service_broker_guid** column of the [sys.databases](/sql/relational-databases/system-catalog-views/sys-databases-transact-sql) catalog view.</span></span> <span data-ttu-id="acb6f-155">Para uma notificação de eventos de nível de servidor, use o identificador do service broker do **msdb**.</span><span class="sxs-lookup"><span data-stu-id="acb6f-155">For a server-level event notification, use the service broker identifier of **msdb**.</span></span>|<span data-ttu-id="acb6f-156">Forneça o identificador do agente de serviços do banco de dados de destino para o servidor de origem.</span><span class="sxs-lookup"><span data-stu-id="acb6f-156">Provide the service broker identifier of the target database to the source server.</span></span>|  
  
 <span data-ttu-id="acb6f-157">**Etapa 4: Crie rotas e configure autenticação em nível de servidor.**</span><span class="sxs-lookup"><span data-stu-id="acb6f-157">**Step 4: Create routes and set up server-level authentication.**</span></span>  
  
 <span data-ttu-id="acb6f-158">Efetue as ações abaixo nos servidores de origem e de destino.</span><span class="sxs-lookup"><span data-stu-id="acb6f-158">Complete the following actions on both the source and target servers.</span></span>  
  
|<span data-ttu-id="acb6f-159">Servidor de origem</span><span class="sxs-lookup"><span data-stu-id="acb6f-159">Source server</span></span>|<span data-ttu-id="acb6f-160">Servidor de destino</span><span class="sxs-lookup"><span data-stu-id="acb6f-160">Target server</span></span>|  
|-------------------|-------------------|  
|<span data-ttu-id="acb6f-161">[Crie uma rota](/sql/t-sql/statements/create-route-transact-sql) para o serviço de destino e especifique o identificador do service broker do banco de dados de destino e o número da porta de TCP estabelecido.</span><span class="sxs-lookup"><span data-stu-id="acb6f-161">[Create a route](/sql/t-sql/statements/create-route-transact-sql) to the target service, and specify the service broker identifier of the target database and the agreed-upon TCP port number.</span></span>|<span data-ttu-id="acb6f-162">Crie uma rota para o serviço de origem e especifique o identificador do agente de serviços do banco de dados de origem e o número de porta de TCP estabelecido.</span><span class="sxs-lookup"><span data-stu-id="acb6f-162">Create a route to the source service, and specify the service broker identifier of the source database and the agreed-upon TCP port number.</span></span> <span data-ttu-id="acb6f-163">Para especificar o serviço de origem, use o seguinte serviço fornecido: `https://schemas.microsoft.com/SQL/Notifications/EventNotificationService`.</span><span class="sxs-lookup"><span data-stu-id="acb6f-163">To specify the source service, use the following supplied service: `https://schemas.microsoft.com/SQL/Notifications/EventNotificationService`.</span></span>|  
|<span data-ttu-id="acb6f-164">Mude para o banco de dados **mestre** para configurar a autenticação no nível de servidor.</span><span class="sxs-lookup"><span data-stu-id="acb6f-164">Switch to the **master** database to configure server-level authentication.</span></span>|<span data-ttu-id="acb6f-165">Mude para o banco de dados **mestre** para configurar a autenticação no nível de servidor.</span><span class="sxs-lookup"><span data-stu-id="acb6f-165">Switch to the **master** database to configure server-level authentication.</span></span>|  
|<span data-ttu-id="acb6f-166">Se não existir uma chave mestra para o banco de dados de **mestre** , [crie uma chave mestra](/sql/t-sql/statements/create-master-key-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="acb6f-166">If no master key exists for the **master** database, [create a master key](/sql/t-sql/statements/create-master-key-transact-sql).</span></span>|<span data-ttu-id="acb6f-167">Se não existir uma chave mestra para o banco de dados de **mestre** , crie uma chave mestra.</span><span class="sxs-lookup"><span data-stu-id="acb6f-167">If no master key exists for the **master** database, create a master key.</span></span>|  
|<span data-ttu-id="acb6f-168">[Crie um certificado](/sql/t-sql/statements/create-certificate-transact-sql) que autentique o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="acb6f-168">[Create a certificate](/sql/t-sql/statements/create-certificate-transact-sql) that authenticates the database.</span></span>|<span data-ttu-id="acb6f-169">Crie um certificado que autentique o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="acb6f-169">Create a certificate that authenticates the database.</span></span>|  
|<span data-ttu-id="acb6f-170">[Faça um backup do certificado](/sql/t-sql/statements/backup-certificate-transact-sql) em um arquivo que possa ser acessado pelo servidor de destino.</span><span class="sxs-lookup"><span data-stu-id="acb6f-170">[Back up the certificate](/sql/t-sql/statements/backup-certificate-transact-sql) to a file that can be accessed by the target server.</span></span>|<span data-ttu-id="acb6f-171">Faça um backup do certificado em um arquivo que possa ser acessado pelo servidor de origem.</span><span class="sxs-lookup"><span data-stu-id="acb6f-171">Back up the certificate to a file that can be accessed by the source server.</span></span>|  
|<span data-ttu-id="acb6f-172">[Crie um ponto de extremidade](/sql/t-sql/statements/create-endpoint-transact-sql)e especifique o número da porta de TCP estabelecido, FOR SERVICE_BROKER (AUTHENTICATION = CERTIFICATE *certificate_name*) e o nome do certificado de autenticação.</span><span class="sxs-lookup"><span data-stu-id="acb6f-172">[Create an endpoint](/sql/t-sql/statements/create-endpoint-transact-sql), and specify the agreed-upon TCP port number, FOR SERVICE_BROKER (AUTHENTICATION = CERTIFICATE *certificate_name*), and the name of the authenticating certificate.</span></span>|<span data-ttu-id="acb6f-173">Crie um ponto de extremidade e especifique o número da porta de TCP estabelecido, FOR SERVICE_BROKER (AUTHENTICATION = CERTIFICATE *certificate_name*) e o nome do certificado de autenticação.</span><span class="sxs-lookup"><span data-stu-id="acb6f-173">Create an endpoint, and specify the agreed-upon TCP port number, FOR SERVICE_BROKER (AUTHENTICATION = CERTIFICATE *certificate_name*), and the name of the authenticating certificate.</span></span>|  
|<span data-ttu-id="acb6f-174">[Crie um logon](/sql/t-sql/statements/create-login-transact-sql)e especifique o logon do servidor de destino.</span><span class="sxs-lookup"><span data-stu-id="acb6f-174">[Create a login](/sql/t-sql/statements/create-login-transact-sql), and specify the login of the target server.</span></span>|<span data-ttu-id="acb6f-175">Crie um logon e especifique o logon do servidor de origem.</span><span class="sxs-lookup"><span data-stu-id="acb6f-175">Create a login, and specify the login of the source server.</span></span>|  
|<span data-ttu-id="acb6f-176">[Conceda permissão CONNECT](/sql/t-sql/statements/grant-transact-sql) no ponto de extremidade para o logon do autenticador de destino.</span><span class="sxs-lookup"><span data-stu-id="acb6f-176">[Grant CONNECT permission](/sql/t-sql/statements/grant-transact-sql) on the endpoint to the target authenticator login.</span></span>|<span data-ttu-id="acb6f-177">Conceda permissão CONNECT no ponto de extremidade para o logon do autenticador de origem.</span><span class="sxs-lookup"><span data-stu-id="acb6f-177">Grant CONNECT permission on the endpoint to the source authenticator login.</span></span>|  
|<span data-ttu-id="acb6f-178">[Crie um usuário](/sql/t-sql/statements/create-user-transact-sql)e especifique o logon do autenticador de destino.</span><span class="sxs-lookup"><span data-stu-id="acb6f-178">[Create a user](/sql/t-sql/statements/create-user-transact-sql), and specify the target authenticator login.</span></span>|<span data-ttu-id="acb6f-179">Crie um usuário e especifique o logon do autenticador de origem.</span><span class="sxs-lookup"><span data-stu-id="acb6f-179">Create a user, and specify the source authenticator login.</span></span>|  
  
 <span data-ttu-id="acb6f-180">**Etapa 5: Compartilhe certificados para autenticação em nível de servidor e crie a notificação de eventos.**</span><span class="sxs-lookup"><span data-stu-id="acb6f-180">**Step 5: Share certificates for server-level authentication and create the event notification.**</span></span>  
  
 <span data-ttu-id="acb6f-181">Efetue as ações abaixo nos servidores de origem e de destino.</span><span class="sxs-lookup"><span data-stu-id="acb6f-181">Complete the following actions on both the source and target servers.</span></span>  
  
|<span data-ttu-id="acb6f-182">Servidor de origem</span><span class="sxs-lookup"><span data-stu-id="acb6f-182">Source server</span></span>|<span data-ttu-id="acb6f-183">Servidor de destino</span><span class="sxs-lookup"><span data-stu-id="acb6f-183">Target server</span></span>|  
|-------------------|-------------------|  
|<span data-ttu-id="acb6f-184">[Crie um certificado](/sql/t-sql/statements/create-certificate-transact-sql) a partir do arquivo de backup do certificado de destino, especificando o autenticador de destino como o proprietário.</span><span class="sxs-lookup"><span data-stu-id="acb6f-184">[Create a certificate](/sql/t-sql/statements/create-certificate-transact-sql) from the backup file of the target certificate, specifying the target authenticator user as the owner.</span></span>|<span data-ttu-id="acb6f-185">Crie um certificado a partir do arquivo de backup do certificado de origem, especificando o autenticador de origem como o proprietário.</span><span class="sxs-lookup"><span data-stu-id="acb6f-185">Create a certificate from the backup file of the source certificate, specifying the source authenticator user as the owner.</span></span>|  
|<span data-ttu-id="acb6f-186">Alterne para o banco de dados de origem no qual criar a notificação de eventos e, caso ainda não esteja conectado como usuário do banco de dados de origem, faça-o agora.</span><span class="sxs-lookup"><span data-stu-id="acb6f-186">Switch to the source database on which to create the event notification, and if you are not already connected as the source database user, do so now.</span></span>|<span data-ttu-id="acb6f-187">Alterne para o banco de dados de destino a receber as mensagens de notificação de eventos.</span><span class="sxs-lookup"><span data-stu-id="acb6f-187">Switch to the target database to receive event notification messages.</span></span>|  
|<span data-ttu-id="acb6f-188">[Crie a notificação de eventos](/sql/t-sql/statements/create-event-notification-transact-sql)e especifique o agente de serviços e o identificador do banco de dados de destino.</span><span class="sxs-lookup"><span data-stu-id="acb6f-188">[Create the event notification](/sql/t-sql/statements/create-event-notification-transact-sql), and specify the broker service and identifier of the target database.</span></span>||  
  
## <a name="see-also"></a><span data-ttu-id="acb6f-189">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="acb6f-189">See Also</span></span>  
 <span data-ttu-id="acb6f-190">[GRANT &#40;Transact-SQL&#41;](/sql/t-sql/statements/grant-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="acb6f-190">[GRANT &#40;Transact-SQL&#41;](/sql/t-sql/statements/grant-transact-sql) </span></span>  
 <span data-ttu-id="acb6f-191">[BACKUP CERTIFICATE &#40;Transact-SQL&#41;](/sql/t-sql/statements/backup-certificate-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="acb6f-191">[BACKUP CERTIFICATE &#40;Transact-SQL&#41;](/sql/t-sql/statements/backup-certificate-transact-sql) </span></span>  
 <span data-ttu-id="acb6f-192">[sys.databases &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/sys-databases-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="acb6f-192">[sys.databases &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/sys-databases-transact-sql) </span></span>  
 <span data-ttu-id="acb6f-193">[Hierarquia de criptografia](../security/encryption/encryption-hierarchy.md) </span><span class="sxs-lookup"><span data-stu-id="acb6f-193">[Encryption Hierarchy](../security/encryption/encryption-hierarchy.md) </span></span>  
 <span data-ttu-id="acb6f-194">[Implementar notificações de evento](event-notifications.md) </span><span class="sxs-lookup"><span data-stu-id="acb6f-194">[Implement Event Notifications](event-notifications.md) </span></span>  
 <span data-ttu-id="acb6f-195">[CREATE MASTER KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-master-key-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="acb6f-195">[CREATE MASTER KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-master-key-transact-sql) </span></span>  
 <span data-ttu-id="acb6f-196">[CREATE LOGIN &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-login-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="acb6f-196">[CREATE LOGIN &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-login-transact-sql) </span></span>  
 <span data-ttu-id="acb6f-197">[CREATE USER &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-user-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="acb6f-197">[CREATE USER &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-user-transact-sql) </span></span>  
 <span data-ttu-id="acb6f-198">[CREATE CERTIFICATE &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-certificate-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="acb6f-198">[CREATE CERTIFICATE &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-certificate-transact-sql) </span></span>  
 <span data-ttu-id="acb6f-199">[CREATE REMOTE SERVICE BINDING &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-remote-service-binding-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="acb6f-199">[CREATE REMOTE SERVICE BINDING &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-remote-service-binding-transact-sql) </span></span>  
 <span data-ttu-id="acb6f-200">[GRANT &#40;Transact-SQL&#41;](/sql/t-sql/statements/grant-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="acb6f-200">[GRANT &#40;Transact-SQL&#41;](/sql/t-sql/statements/grant-transact-sql) </span></span>  
 <span data-ttu-id="acb6f-201">[CREATE ROUTE &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-route-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="acb6f-201">[CREATE ROUTE &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-route-transact-sql) </span></span>  
 <span data-ttu-id="acb6f-202">[CREATE QUEUE &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-queue-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="acb6f-202">[CREATE QUEUE &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-queue-transact-sql) </span></span>  
 <span data-ttu-id="acb6f-203">[CREATE SERVICE &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-service-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="acb6f-203">[CREATE SERVICE &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-service-transact-sql) </span></span>  
 <span data-ttu-id="acb6f-204">[CREATE ENDPOINT &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-endpoint-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="acb6f-204">[CREATE ENDPOINT &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-endpoint-transact-sql) </span></span>  
 [<span data-ttu-id="acb6f-205">CREATE EVENT NOTIFICATION &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="acb6f-205">CREATE EVENT NOTIFICATION &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/create-event-notification-transact-sql)  
  
  
