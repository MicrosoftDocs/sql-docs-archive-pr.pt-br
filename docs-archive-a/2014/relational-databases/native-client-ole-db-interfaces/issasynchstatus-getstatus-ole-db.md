---
title: ISSAsynchStatus::GetStatus (OLE DB) | Microsoft Docs
ms.custom: ''
ms.date: 06/14/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
api_name:
- ISSAsynchStatus::GetStatus (OLE DB)
topic_type:
- apiref
helpviewer_keywords:
- GetStatus method
ms.assetid: 354b6ee4-b5a1-48f6-9403-da3bdc911067
author: rothja
ms.author: jroth
ms.openlocfilehash: 14c20ae5d9a5cd31139db74aeedabb2d017f6ce6
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87570674"
---
# <a name="issasynchstatusgetstatus-ole-db"></a><span data-ttu-id="c180b-102">ISSAsynchStatus::GetStatus (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="c180b-102">ISSAsynchStatus::GetStatus (OLE DB)</span></span>
  <span data-ttu-id="c180b-103">Retorna o status de uma operação que está sendo executada de forma assíncrona.</span><span class="sxs-lookup"><span data-stu-id="c180b-103">Returns the status of an asynchronously executing operation.</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="c180b-104">Sintaxe</span><span class="sxs-lookup"><span data-stu-id="c180b-104">Syntax</span></span>  
  
```  
  
HRESULT GetStatus(  
  HCHAPTER hChapter,  
  DBASYNCHOP eOperation,  
  DBCOUNTITEM *pulProgress,  
  DBCOUNTITEM *pulProgressMax,  
  DBASYNCHPHASE *peAsynchPhase,  
  LPOLESTR *ppwszStatusText);  
```  
  
## <a name="arguments"></a><span data-ttu-id="c180b-105">Argumentos</span><span class="sxs-lookup"><span data-stu-id="c180b-105">Arguments</span></span>  
 <span data-ttu-id="c180b-106">*hChapter*[in]</span><span class="sxs-lookup"><span data-stu-id="c180b-106">*hChapter*[in]</span></span>  
 <span data-ttu-id="c180b-107">O identificador do capítulo.</span><span class="sxs-lookup"><span data-stu-id="c180b-107">The chapter handle.</span></span> <span data-ttu-id="c180b-108">Se o objeto que está sendo sondado não for um objeto de conjunto de linhas ou se a operação não se aplicar a um capítulo, esse argumento deverá ser definido como DB_NULL_HCHAPTER, que é ignorado pelo provedor.</span><span class="sxs-lookup"><span data-stu-id="c180b-108">If the object being polled is not a rowset object or the operation does not apply to a chapter, this should be set to DB_NULL_HCHAPTER, which is ignored by the provider.</span></span>  
  
 <span data-ttu-id="c180b-109">*eOperation*[in]</span><span class="sxs-lookup"><span data-stu-id="c180b-109">*eOperation*[in]</span></span>  
 <span data-ttu-id="c180b-110">A operação cujo status assíncrono está sendo solicitado.</span><span class="sxs-lookup"><span data-stu-id="c180b-110">The operation for which the asynchronous status is being requested.</span></span> <span data-ttu-id="c180b-111">O valor desse argumento deveria ser o seguinte:</span><span class="sxs-lookup"><span data-stu-id="c180b-111">This should be the following value:</span></span>  
  
 <span data-ttu-id="c180b-112">DBASYNCHOP_OPEN – o consumidor solicita informações sobre a abertura ou população assíncrona de um conjunto de linhas ou sobre a inicialização assíncrona de um objeto de fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="c180b-112">DBASYNCHOP_OPEN-The consumer requests information about the asynchronous opening or population of a rowset or about the asynchronous initialization of a data source object.</span></span> <span data-ttu-id="c180b-113">Se o provedor estiver em conformidade com OLE DB 2.5 e der suporte a associação direta de URL, o consumidor solicitará informações sobre a abertura ou população assíncrona de uma fonte de dados, conjunto de linhas, linha ou objeto de fluxo.</span><span class="sxs-lookup"><span data-stu-id="c180b-113">If the provider is an OLE DB 2.5-compliant provider that supports direct URL binding, the consumer requests information about the asynchronous initialization or population of a data source, rowset, row, or stream object.</span></span>  
  
 <span data-ttu-id="c180b-114">*pulProgress*[out]</span><span class="sxs-lookup"><span data-stu-id="c180b-114">*pulProgress*[out]</span></span>  
 <span data-ttu-id="c180b-115">Um ponteiro de memória no qual retornar o progresso atual da operação assíncrona em relação ao valor máximo esperado do parâmetro *pulProgressMax* .</span><span class="sxs-lookup"><span data-stu-id="c180b-115">A pointer to memory in which to return the current progress of the asynchronous operation relative to the expected maximum indicated in the *pulProgressMax* parameter.</span></span> <span data-ttu-id="c180b-116">Para obter mais informações sobre o significado de *pulProgress*, consulte a descrição de *peAsynchPhase*.</span><span class="sxs-lookup"><span data-stu-id="c180b-116">For more information about the meaning of *pulProgress*, see the description of *peAsynchPhase*.</span></span>  
  
 <span data-ttu-id="c180b-117">Se *pulProgress* for um ponteiro nulo, nenhum progresso será retornado.</span><span class="sxs-lookup"><span data-stu-id="c180b-117">If *pulProgress* is a null pointer, no progress is returned.</span></span>  
  
 <span data-ttu-id="c180b-118">*pulProgressMax*[out]</span><span class="sxs-lookup"><span data-stu-id="c180b-118">*pulProgressMax*[out]</span></span>  
 <span data-ttu-id="c180b-119">Um ponteiro de memória no qual retornar o valor máximo esperado do parâmetro *pulProgress* .</span><span class="sxs-lookup"><span data-stu-id="c180b-119">A pointer to memory in which to return the expected maximum value of the *pulProgress* parameter.</span></span> <span data-ttu-id="c180b-120">Esse valor pode alterar de uma chamada para outra a este método.</span><span class="sxs-lookup"><span data-stu-id="c180b-120">This value may change across calls to this method.</span></span> <span data-ttu-id="c180b-121">Para obter mais informações sobre o significado de *pulProgressMax*, consulte a descrição de *peAsynchPhase*.</span><span class="sxs-lookup"><span data-stu-id="c180b-121">For more information about the meaning of *pulProgressMax*, see the description of *peAsynchPhase*.</span></span>  
  
 <span data-ttu-id="c180b-122">Se *pulProgressMax* for um ponteiro nulo, nenhum valor máximo esperado será retornado.</span><span class="sxs-lookup"><span data-stu-id="c180b-122">If *pulProgressMax* is a null pointer, no expected maximum value is returned.</span></span>  
  
 <span data-ttu-id="c180b-123">*peAsynchPhase*[out]</span><span class="sxs-lookup"><span data-stu-id="c180b-123">*peAsynchPhase*[out]</span></span>  
 <span data-ttu-id="c180b-124">Um ponteiro de memória no qual retornar informações adicionais sobre o progresso da operação assíncrona.</span><span class="sxs-lookup"><span data-stu-id="c180b-124">A pointer to memory in which to return additional information regarding the progress of the asynchronous operation.</span></span> <span data-ttu-id="c180b-125">Os valores válidos incluem:</span><span class="sxs-lookup"><span data-stu-id="c180b-125">Valid values include:</span></span>  
  
 <span data-ttu-id="c180b-126">DBASYNCHPHASE_INITIALIZATION – o objeto está em fase de inicialização.</span><span class="sxs-lookup"><span data-stu-id="c180b-126">DBASYNCHPHASE_INITIALIZATION-The object is in an initialization phase.</span></span> <span data-ttu-id="c180b-127">Os argumentos *pulProgress* e *pulProgressMax* indicam uma taxa estimada de conclusão.</span><span class="sxs-lookup"><span data-stu-id="c180b-127">The arguments *pulProgress* and *pulProgressMax* indicate an estimated ratio of completion.</span></span> <span data-ttu-id="c180b-128">O objeto ainda não se materializou completamente.</span><span class="sxs-lookup"><span data-stu-id="c180b-128">The object is not yet fully materialized.</span></span> <span data-ttu-id="c180b-129">As tentativas de chamar qualquer outra interface podem falhar e o conjunto completo de interfaces pode não estar disponível no objeto.</span><span class="sxs-lookup"><span data-stu-id="c180b-129">Attempting to call any other interfaces may fail, and the full set of interfaces may not be available on the object.</span></span> <span data-ttu-id="c180b-130">Se a operação assíncrona tiver sido resultado de uma chamada de **ICommand::Execute** para um comando que atualiza, exclui ou insere linhas e se *cParamSets* for superior a 1, *pulProgress* e *pulProgressMax* podem indicar o progresso de um único conjunto de parâmetros ou da matriz completa de conjuntos de parâmetros.</span><span class="sxs-lookup"><span data-stu-id="c180b-130">If the asynchronous operation was a result of calling **ICommand::Execute** for a command that updates, deletes, or inserts rows and if *cParamSets* is greater than 1, *pulProgress* and *pulProgressMax* may indicate the progress for a single set of parameters or for the full array of parameter sets.</span></span>  
  
 <span data-ttu-id="c180b-131">DBASYNCHPHASE_POPULATION – o objeto está em fase de rastreamento.</span><span class="sxs-lookup"><span data-stu-id="c180b-131">DBASYNCHPHASE_POPULATION-The object is in a population phase.</span></span> <span data-ttu-id="c180b-132">Embora o conjunto de linhas esteja totalmente inicializado e a gama completa de interfaces esteja disponível no objeto, talvez ainda haja linhas que não foram populadas no conjunto de linhas.</span><span class="sxs-lookup"><span data-stu-id="c180b-132">Although the rowset is fully initialized and the full range of interfaces is available on the object, there may be additional rows not yet populated into the rowset.</span></span> <span data-ttu-id="c180b-133">Embora *pulProgress* e *pulProgressMax* possam ser baseados no número de linhas populadas, em geral, eles se baseiam no tempo ou no esforço necessário para popular o conjunto de linhas.</span><span class="sxs-lookup"><span data-stu-id="c180b-133">While *pulProgress* and *pulProgressMax* can be based on the number of rows populated, they are generally based on the time or effort required to populate the rowset.</span></span> <span data-ttu-id="c180b-134">Dessa forma, um chamador deveria usar essas informações como uma estimativa aproximada de quanto tempo o processo levaria, não a contagem de linhas eventual.</span><span class="sxs-lookup"><span data-stu-id="c180b-134">A caller should therefore use this information as a rough estimate of how long the process might take, not the eventual row count.</span></span> <span data-ttu-id="c180b-135">Essa fase só é retornada durante a população de um conjunto de linhas; ela nunca é retornada na inicialização de um objeto de fonte de dados ou pela execução de um comando que atualiza, exclui ou insere linhas.</span><span class="sxs-lookup"><span data-stu-id="c180b-135">This phase is returned only during population of a rowset; it is never returned in the initialization of a data source object or by the execution of a command that updates, deletes, or inserts rows.</span></span>  
  
 <span data-ttu-id="c180b-136">DBASYNCHPHASE_COMPLETE – todo o processamento assíncrono do objeto foi concluído.</span><span class="sxs-lookup"><span data-stu-id="c180b-136">DBASYNCHPHASE_COMPLETE-All asynchronous processing of the object has completed.</span></span> <span data-ttu-id="c180b-137">**ISSAsynchStatus::GetStatus** retorna um valor de HRESULT que indica o resultado da operação.</span><span class="sxs-lookup"><span data-stu-id="c180b-137">**ISSAsynchStatus::GetStatus** returns an HRESULT indicating the outcome of the operation.</span></span> <span data-ttu-id="c180b-138">Normalmente, esse é o HRESULT que teria sido retornado se a operação tivesse sido chamada de forma síncrona.</span><span class="sxs-lookup"><span data-stu-id="c180b-138">Typically, this will be the HRESULT that would have been returned had the operation been called synchronously.</span></span> <span data-ttu-id="c180b-139">Se a operação assíncrona foi resultado de uma chamada a **ICommand::Execute** para um comando que atualiza, exclui ou insere linhas, *pulProgress* e *pulProgressMax* têm o mesmo número total de linhas afetadas pelo comando.</span><span class="sxs-lookup"><span data-stu-id="c180b-139">If the asynchronous operation was a result of calling **ICommand::Execute** for a command that updates, deletes, or inserts rows, *pulProgress* and *pulProgressMax* are equal to the total number of rows affected by the command.</span></span> <span data-ttu-id="c180b-140">Se *cParamSets* for maior que 1, esse será o número total de linhas afetadas por todos os conjuntos de parâmetros especificados na execução.</span><span class="sxs-lookup"><span data-stu-id="c180b-140">If *cParamSets* is greater than 1, this is the total number of rows affected by all of the sets of parameters specified in the execution.</span></span> <span data-ttu-id="c180b-141">Se *peAsynchPhase* for um ponteiro nulo, nenhum código de status será retornado.</span><span class="sxs-lookup"><span data-stu-id="c180b-141">If *peAsynchPhase* is a null pointer, no status code is returned.</span></span>  
  
 <span data-ttu-id="c180b-142">DBASYNCHPHASE_CANCELED – o processamento assíncrono do objeto foi anulado.</span><span class="sxs-lookup"><span data-stu-id="c180b-142">DBASYNCHPHASE_CANCELED-Asynchronous processing of the object was aborted.</span></span> <span data-ttu-id="c180b-143">**ISSAsynchStatus::GetStatus** retorna DB_E_CANCELED.</span><span class="sxs-lookup"><span data-stu-id="c180b-143">**ISSAsynchStatus::GetStatus** returns DB_E_CANCELED.</span></span> <span data-ttu-id="c180b-144">Se a operação assíncrona tiver sido resultado de uma chamada a **ICommand::Execute** para um comando que atualiza, exclui ou insere linhas, *pulProgress* será igual ao número total de linhas, para todos os conjuntos de parâmetros afetados pelo comando antes do cancelamento.</span><span class="sxs-lookup"><span data-stu-id="c180b-144">If the asynchronous operation was a result of calling **ICommand::Execute** for a command that updates, deletes, or inserts rows, *pulProgress* is equal to the total number of rows, for all parameter sets, affected by the command prior to cancellation.</span></span>  
  
 <span data-ttu-id="c180b-145">*ppwszStatusText*[in/out]</span><span class="sxs-lookup"><span data-stu-id="c180b-145">*ppwszStatusText*[in/out]</span></span>  
 <span data-ttu-id="c180b-146">Um ponteiro de memória que contém informações adicionais sobre a operação.</span><span class="sxs-lookup"><span data-stu-id="c180b-146">A pointer to memory containing additional information about the operation.</span></span> <span data-ttu-id="c180b-147">Um provedor pode usar este valor para fazer a distinção entre os elementos de uma operação – por exemplo, recursos diferentes que são acessados.</span><span class="sxs-lookup"><span data-stu-id="c180b-147">A provider may use this value to distinguish between different elements of an operation-for example, different resources being accessed.</span></span> <span data-ttu-id="c180b-148">Esta cadeia de caracteres é localizada de acordo com a propriedade DBPROP_INIT_LCID no objeto de fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="c180b-148">This string is localized according to the DBPROP_INIT_LCID property on the data source object.</span></span>  
  
 <span data-ttu-id="c180b-149">Se *ppwszStatusText* for não nulo na entrada, o provedor retornará o status associado ao elemento específico identificado por *ppwszStatusText*.</span><span class="sxs-lookup"><span data-stu-id="c180b-149">If *ppwszStatusText* is non-null on input, the provider returns status associated with the particular element identified by *ppwszStatusText*.</span></span> <span data-ttu-id="c180b-150">Se *ppwszStatusText* não indicar um elemento de *eOperation*, o provedor retornará S_OK com *pulProgress* e *pulProgressMax* definidos como o mesmo valor.</span><span class="sxs-lookup"><span data-stu-id="c180b-150">If *ppwszStatusText* does not indicate an element of *eOperation*, the provider returns S_OK with *pulProgress* and *pulProgressMax* set to the same value.</span></span> <span data-ttu-id="c180b-151">Se o provedor não fizer a distinção entre os elementos com base em um identificador textual, ele definirá *ppwszStatusText* como NULL e retornará informações sobre a operação como um todo; caso contrário, se *ppwszStatusText* for não nulo na entrada, o provedor não irá alterar *ppwszStatusText* .</span><span class="sxs-lookup"><span data-stu-id="c180b-151">If the provider does not distinguish between elements based on a textual identifier, it sets *ppwszStatusText* to NULL and returns information about the operation as a whole; otherwise, if *ppwszStatusText* is non-null on input, the provider leaves *ppwszStatusText* untouched.</span></span>  
  
 <span data-ttu-id="c180b-152">Se *ppwszStatusText* for nulo na entrada, o provedor definirá *ppwszStatusText* como um valor que indica mais informações sobre a operação ou como NULL se tais informações não estiverem disponíveis ou se **ISSAsynchStatus::GetStatus** retornar um erro.</span><span class="sxs-lookup"><span data-stu-id="c180b-152">If *ppwszStatusText* is null on input, the provider sets *ppwszStatusText* to a value indicating more information about the operation, or to NULL if no such information is available or if **ISSAsynchStatus::GetStatus** returns an error.</span></span> <span data-ttu-id="c180b-153">Quando *ppwszStatusText* for nulo na entrada, o provedor alocará memória para a cadeia de caracteres de status e retornará o endereço a esta memória.</span><span class="sxs-lookup"><span data-stu-id="c180b-153">When *ppwszStatusText* is null on input, the provider allocates memory for the status string and returns the address to this memory.</span></span> <span data-ttu-id="c180b-154">O consumidor libera esta memória com **IMalloc::Free** quando ela não precisar mais da cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="c180b-154">The consumer releases this memory with **IMalloc::Free** when it no longer needs the string.</span></span>  
  
 <span data-ttu-id="c180b-155">Se *ppwszStatusText* for NULL na entrada, nenhuma cadeia de caracteres de status será retornada e o provedor retornará informações sobre qualquer elemento da operação ou sobre a operação em geral.</span><span class="sxs-lookup"><span data-stu-id="c180b-155">If *ppwszStatusText* is NULL on input, no status string is returned and the provider returns information about any element of the operation or about the operation in general.</span></span>  
  
## <a name="return-code-values"></a><span data-ttu-id="c180b-156">Valores do código de retorno</span><span class="sxs-lookup"><span data-stu-id="c180b-156">Return Code Values</span></span>  
 <span data-ttu-id="c180b-157">S_OK</span><span class="sxs-lookup"><span data-stu-id="c180b-157">S_OK</span></span>  
 <span data-ttu-id="c180b-158">O método foi retornado com êxito.</span><span class="sxs-lookup"><span data-stu-id="c180b-158">The method returned successfully.</span></span>  
  
-   <span data-ttu-id="c180b-159">Se *peAsynchPhase* for igual a DBASYNCHPHASE_INITIALIZATION, é sinal de que o objeto ainda não foi totalmente inicializado; as tentativas de chamar outras interfaces podem falhar e o conjunto completo de interfaces pode não estar disponível no objeto.</span><span class="sxs-lookup"><span data-stu-id="c180b-159">If *peAsynchPhase* is equal to DBASYNCHPHASE_INITIALIZATION, the object is not yet fully initialized; attempting to call any other interfaces might fail, and the full set of interfaces might not be available on the object.</span></span>  
  
-   <span data-ttu-id="c180b-160">Se *peAsynchPhase* for igual a DBASYNCHPHASE_POPULATION, é sinal de que o conjunto de linhas foi totalmente inicializado e a gama completa de interfaces está disponível no objeto; no entanto, talvez haja linhas que ainda não tenham sido populadas no conjunto de linhas.</span><span class="sxs-lookup"><span data-stu-id="c180b-160">If *peAsynchPhase* is equal to DBASYNCHPHASE_POPULATION, the rowset is fully initialized and the full range of interfaces is available on the object; however, there might be additional rows not yet populated into the rowset.</span></span>  
  
-   <span data-ttu-id="c180b-161">Se *peAsynchPhase* for igual a DBASYNCHPHASE_COMPLETE, é sinal de que todo o processamento assíncrono do objeto foi concluído.</span><span class="sxs-lookup"><span data-stu-id="c180b-161">If *peAsynchPhase* is equal to DBASYNCHPHASE_COMPLETE, all asynchronous processing of the object has completed.</span></span> <span data-ttu-id="c180b-162">O objeto está totalmente inicializado e populado.</span><span class="sxs-lookup"><span data-stu-id="c180b-162">The object is fully initialized and populated.</span></span>  
  
 <span data-ttu-id="c180b-163">DB_E_CANCELED</span><span class="sxs-lookup"><span data-stu-id="c180b-163">DB_E_CANCELED</span></span>  
 <span data-ttu-id="c180b-164">O processamento assíncrono foi cancelado durante a população do conjunto de linhas.</span><span class="sxs-lookup"><span data-stu-id="c180b-164">Asynchronous processing was canceled during rowset population.</span></span> <span data-ttu-id="c180b-165">O processo de população para, mas o conjunto de linhas permanece válido para as linhas já populadas.</span><span class="sxs-lookup"><span data-stu-id="c180b-165">Population stops, but the rowset remains valid for the rows already populated.</span></span>  
  
 <span data-ttu-id="c180b-166">O processamento assíncrono foi cancelado durante a inicialização do objeto de fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="c180b-166">Asynchronous processing was canceled during data source object initialization.</span></span> <span data-ttu-id="c180b-167">O objeto de fonte de dados está em um estado não inicializado.</span><span class="sxs-lookup"><span data-stu-id="c180b-167">The data source object is in an uninitialized state.</span></span>  
  
 <span data-ttu-id="c180b-168">E_INVALIDARG</span><span class="sxs-lookup"><span data-stu-id="c180b-168">E_INVALIDARG</span></span>  
 <span data-ttu-id="c180b-169">O parâmetro *hChapter* está incorreto.</span><span class="sxs-lookup"><span data-stu-id="c180b-169">The *hChapter* parameter is incorrect.</span></span>  
  
 <span data-ttu-id="c180b-170">E_UNEXPECTED</span><span class="sxs-lookup"><span data-stu-id="c180b-170">E_UNEXPECTED</span></span>  
 <span data-ttu-id="c180b-171">**ISSAsynchStatus::GetStatus** foi chamado em um objeto de fonte de dados e **IDBInitialize::Initialize** não foi chamado no objeto de fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="c180b-171">**ISSAsynchStatus::GetStatus** was called on a data source object, and **IDBInitialize::Initialize** has not been called on the data source object.</span></span>  
  
 <span data-ttu-id="c180b-172">**ISSAsynchStatus::GetStatus** foi chamado em um conjunto de linhas, **ITransaction::Commit** ou **ITransaction::Abort** foi chamado e o objeto está em um estado zumbi.</span><span class="sxs-lookup"><span data-stu-id="c180b-172">**ISSAsynchStatus::GetStatus** was called on a rowset, **ITransaction::Commit** or **ITransaction::Abort** was called, and the object is in a zombie state.</span></span>  
  
 <span data-ttu-id="c180b-173">**ISSAsynchStatus::GetStatus** foi chamado em um conjunto de linhas cancelado de forma assíncrona em sua fase de inicialização.</span><span class="sxs-lookup"><span data-stu-id="c180b-173">**ISSAsynchStatus::GetStatus** was called on a rowset that was asynchronously canceled in its initialization phase.</span></span> <span data-ttu-id="c180b-174">O conjunto de linhas está em um estado zumbi.</span><span class="sxs-lookup"><span data-stu-id="c180b-174">The rowset is in a zombie state.</span></span>  
  
 <span data-ttu-id="c180b-175">E_FAIL</span><span class="sxs-lookup"><span data-stu-id="c180b-175">E_FAIL</span></span>  
 <span data-ttu-id="c180b-176">Ocorreu um erro específico de provedor.</span><span class="sxs-lookup"><span data-stu-id="c180b-176">A provider-specific error occurred.</span></span>  
  
## <a name="remarks"></a><span data-ttu-id="c180b-177">Comentários</span><span class="sxs-lookup"><span data-stu-id="c180b-177">Remarks</span></span>  
 <span data-ttu-id="c180b-178">O método **ISSAsynchStatus::GetStatus** comporta-se exatamente como o método **IDBAsynchStatus::GetStatus**, a não ser pelo fato de que se a inicialização de um objeto de fonte de dados for anulada, E_UNEXPECTED será retornado em vez de DB_E_CANCELED (embora [ISSAsynchStatus::WaitForAsynchCompletion](issasynchstatus-waitforasynchcompletion-ole-db.md) retorne DB_E_CANCELED).</span><span class="sxs-lookup"><span data-stu-id="c180b-178">The **ISSAsynchStatus::GetStatus** method behaves exactly as the **IDBAsynchStatus::GetStatus** method except that if initialization of a data source object is aborted, E_UNEXPECTED is returned rather than DB_E_CANCELED (although [ISSAsynchStatus::WaitForAsynchCompletion](issasynchstatus-waitforasynchcompletion-ole-db.md) will return DB_E_CANCELED).</span></span> <span data-ttu-id="c180b-179">Isso acontece porque o objeto de fonte de dados não é deixado no estado normal de zumbi que segue uma operação de anulação, para que outras operações futuras de inicialização possam ser tentadas.</span><span class="sxs-lookup"><span data-stu-id="c180b-179">This is because the data source object is not left in the usual zombie state following an abort, in order that further initialization operations may be attempted.</span></span>  
  
 <span data-ttu-id="c180b-180">Se o conjunto de linhas for inicializado ou populado de forma assíncrona, deverá dar suporte a este método.</span><span class="sxs-lookup"><span data-stu-id="c180b-180">If the rowset is initialized or populated asynchronously, it must support this method.</span></span>  
  
 <span data-ttu-id="c180b-181">Além dos valores de retorno listados, **ISSAsynchStatus::GetStatus** pode retornar qualquer HRESULT que teria sido retornado pelo método que iniciou a operação assíncrona, indicando o êxito ou a falha da operação.</span><span class="sxs-lookup"><span data-stu-id="c180b-181">In addition to the return values listed, **ISSAsynchStatus::GetStatus** can return any HRESULT that would have been returned by the method that initiated the asynchronous operation, indicating the success or failure of the operation.</span></span>  
  
 <span data-ttu-id="c180b-182">Algumas operações assíncronas talvez não retornem estados diferentes de "concluído" "não concluído".</span><span class="sxs-lookup"><span data-stu-id="c180b-182">Some asynchronous operations might not be able to return any states other than "finished" and "not finished".</span></span> <span data-ttu-id="c180b-183">Elas devem definir *pulProgressMax* como um valor igual a 1, indicando a granularidade “tudo ou nada” de suas estimativas, de modo que suas respostas seriam 0/1 ou 1/1.</span><span class="sxs-lookup"><span data-stu-id="c180b-183">They should set *pulProgressMax* to a value of 1, indicating the all-or-nothing granularity of their estimate, so their answers would be either 0/1 or 1/1.</span></span>  
  
 <span data-ttu-id="c180b-184">Um provedor pode alterar *pulProgressMax* em chamadas sucessivas e até mesmo retornar uma taxa menor do que a anterior, se isso gerar uma estimativa melhor do grau de conclusão da tarefa.</span><span class="sxs-lookup"><span data-stu-id="c180b-184">A provider may change *pulProgressMax* in successive calls and even return a smaller ratio than previously, if this reflects an improving estimate of the degree of completion of the task.</span></span>  
  
 <span data-ttu-id="c180b-185">O provedor não é obrigado a garantir um nível maior de precisão, mas é incentivado a fazê-lo nos casos em que são possíveis estimativas razoáveis de conclusão.</span><span class="sxs-lookup"><span data-stu-id="c180b-185">The provider is not obliged to guarantee any further accuracy but is encouraged to do so in cases where reasonable estimates of completion are possible.</span></span> <span data-ttu-id="c180b-186">Tais esforços contribuirão para melhorar a qualidade da interface do usuário porque é provável que o uso principal desta função seja fornecer comentários de progresso ao usuário.</span><span class="sxs-lookup"><span data-stu-id="c180b-186">Such efforts will improve user-interface quality because the main use of this function is likely to be to give progress feedback to the user.</span></span> <span data-ttu-id="c180b-187">A satisfação do usuário aumenta com a qualidade dos comentários sobre uma tarefa invisível de longa duração.</span><span class="sxs-lookup"><span data-stu-id="c180b-187">User satisfaction increases with the quality of feedback on an invisible, long-running task.</span></span>  
  
 <span data-ttu-id="c180b-188">Chamar **ISSAsynchStatus::GetStatus** em um objeto de fonte de dados inicializado ou em um conjunto de linhas populado, ou atribuir um valor a *eOperation* diferente de DBASYNCHOP_OPEN, retorna S_OK com *pulProgress* e *pulProgressMax* definidos como o mesmo valor.</span><span class="sxs-lookup"><span data-stu-id="c180b-188">Calling **ISSAsynchStatus::GetStatus** on an initialized data source object or a populated rowset, or passing a value for *eOperation* other than DBASYNCHOP_OPEN, returns S_OK with *pulProgress* and *pulProgressMax* set to the same value.</span></span> <span data-ttu-id="c180b-189">Se **ISSAsynchStatus::GetStatus** for chamado em um objeto criado pela execução de um comando que atualiza, exclui ou insere linhas, ambos *pulProgress* e *pulProgressMax* indicam o número total de linhas afetadas pelo comando.</span><span class="sxs-lookup"><span data-stu-id="c180b-189">If **ISSAsynchStatus::GetStatus** is called on an object created from the execution of a command that updates, deletes, or inserts rows, both *pulProgress* and *pulProgressMax* indicate the total number of rows affected by the command.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c180b-190">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="c180b-190">See Also</span></span>  
 <span data-ttu-id="c180b-191">[Executando operações assíncronas](../native-client/features/performing-asynchronous-operations.md) </span><span class="sxs-lookup"><span data-stu-id="c180b-191">[Performing Asynchronous Operations](../native-client/features/performing-asynchronous-operations.md) </span></span>  
 [<span data-ttu-id="c180b-192">ISSAsynchStatus &#40;OLE DB&#41;</span><span class="sxs-lookup"><span data-stu-id="c180b-192">ISSAsynchStatus &#40;OLE DB&#41;</span></span>](issasynchstatus-ole-db.md)  
  
  
