---
title: O log de transações (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 01/04/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: supportability
ms.topic: conceptual
helpviewer_keywords:
- transaction logs [SQL Server], about
- databases [SQL Server], transaction logs
- logs [SQL Server], transaction logs
ms.assetid: d7be5ac5-4c8e-4d0a-b114-939eb97dac4d
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 025ef22e6dee1fcfaa1225a4709fa01b6c326b12
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87572536"
---
# <a name="the-transaction-log-sql-server"></a><span data-ttu-id="1af29-102">O log de transações (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="1af29-102">The Transaction Log (SQL Server)</span></span>
  <span data-ttu-id="1af29-103">Todo banco de dados do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] tem um log de transações que registra todas as transações e as modificações de banco de dados feitas por cada transação.</span><span class="sxs-lookup"><span data-stu-id="1af29-103">Every [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database has a transaction log that records all transactions and the database modifications made by each transaction.</span></span> <span data-ttu-id="1af29-104">O log de transações deve ser truncado regularmente para impedir o preenchimento.</span><span class="sxs-lookup"><span data-stu-id="1af29-104">The transaction log must be truncated on a regular basis to keep it from filling up.</span></span> <span data-ttu-id="1af29-105">No entanto, alguns fatores podem atrasar o truncamento de log e, portanto, o monitoramento do tamanho do log é importante.</span><span class="sxs-lookup"><span data-stu-id="1af29-105">However, some factors can delay log truncation, so monitoring log size is important.</span></span> <span data-ttu-id="1af29-106">Algumas operações podem ser registradas em log minimamente para reduzir o impacto no tamanho do log de transações.</span><span class="sxs-lookup"><span data-stu-id="1af29-106">Some operations can be minimally logged to reduce their impact on transaction log size.</span></span>  
  
 <span data-ttu-id="1af29-107">O log de transações é um componente crítico do banco de dados e, se houver uma falha do sistema, será necessário que o log de transações retorne seu banco de dados a um estado consistente.</span><span class="sxs-lookup"><span data-stu-id="1af29-107">The transaction log is a critical component of the database and, if there is a system failure, the transaction log might be required to bring your database back to a consistent state.</span></span> <span data-ttu-id="1af29-108">O log de transações nunca deve ser excluído ou movido a menos que você compreenda plenamente as consequências disso.</span><span class="sxs-lookup"><span data-stu-id="1af29-108">The transaction log should never be deleted or moved unless you fully understand the ramifications of doing this.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="1af29-109">Pontos bons conhecidos com base nos quais começar a aplicar logs de transação durante a recuperação de banco de dados são criados por pontos de verificação.</span><span class="sxs-lookup"><span data-stu-id="1af29-109">Known good points from which to begin applying transaction logs during database recovery are created by checkpoints.</span></span> <span data-ttu-id="1af29-110">Para obter mais informações, consulte [Pontos de verificação de banco de dados &#40;SQL Server&#41;](database-checkpoints-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="1af29-110">For more information, see [Database Checkpoints &#40;SQL Server&#41;](database-checkpoints-sql-server.md).</span></span>  
  
 <span data-ttu-id="1af29-111">**Neste tópico:**</span><span class="sxs-lookup"><span data-stu-id="1af29-111">**In this Topic:**</span></span>  
  
-   [<span data-ttu-id="1af29-112">Benefícios: operações com suporte pelo log de transações</span><span class="sxs-lookup"><span data-stu-id="1af29-112">Benefits: Operations Supported by the Transaction Log</span></span>](#Benefits)  
  
-   [<span data-ttu-id="1af29-113">Truncamento do log de transações</span><span class="sxs-lookup"><span data-stu-id="1af29-113">Transaction Log Truncation</span></span>](#Truncation)  
  
-   [<span data-ttu-id="1af29-114">Fatores que podem atrasar o truncamento de log</span><span class="sxs-lookup"><span data-stu-id="1af29-114">Factors That Can Delay Log Truncation</span></span>](#FactorsThatDelayTruncation)  
  
-   [<span data-ttu-id="1af29-115">Operações que podem ser minimamente registradas em log</span><span class="sxs-lookup"><span data-stu-id="1af29-115">Operations That Can Be Minimally Logged</span></span>](#MinimallyLogged)  
  
-   [<span data-ttu-id="1af29-116">Tarefas relacionadas</span><span class="sxs-lookup"><span data-stu-id="1af29-116">Related Tasks</span></span>](#RelatedTasks)  
  
##  <a name="benefits-operations-supported-by-the-transaction-log"></a><a name="Benefits"></a><span data-ttu-id="1af29-117">Benefícios: operações com suporte no log de transações</span><span class="sxs-lookup"><span data-stu-id="1af29-117">Benefits: Operations Supported by the Transaction Log</span></span>  
 <span data-ttu-id="1af29-118">O log de transações dá suporte às seguintes operações:</span><span class="sxs-lookup"><span data-stu-id="1af29-118">The transaction log supports the following operations:</span></span>  
  
-   <span data-ttu-id="1af29-119">Recuperação de transações individuais.</span><span class="sxs-lookup"><span data-stu-id="1af29-119">Recovery of individual transactions.</span></span>  
  
-   <span data-ttu-id="1af29-120">Recuperação de todas as transações incompletas quando [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] é iniciado.</span><span class="sxs-lookup"><span data-stu-id="1af29-120">Recovery of all incomplete transactions when [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is started.</span></span>  
  
-   <span data-ttu-id="1af29-121">Rolando um banco de dados restaurado, arquivo, grupo de arquivo ou página até ao ponto de falha.</span><span class="sxs-lookup"><span data-stu-id="1af29-121">Rolling a restored database, file, filegroup, or page forward to the point of failure.</span></span>  
  
-   <span data-ttu-id="1af29-122">Dando suporte à replicação transacional.</span><span class="sxs-lookup"><span data-stu-id="1af29-122">Supporting transactional replication.</span></span>  
  
-   <span data-ttu-id="1af29-123">Dando suporte a soluções de alta disponibilidade e recuperação de desastre: [!INCLUDE[ssHADR](../../includes/sshadr-md.md)], espelhamento de banco de dados e envio de log.</span><span class="sxs-lookup"><span data-stu-id="1af29-123">Supporting high availability and disaster recovery solutions: [!INCLUDE[ssHADR](../../includes/sshadr-md.md)], database mirroring, and log shipping.</span></span>  
  
##  <a name="transaction-log-truncation"></a><a name="Truncation"></a> <span data-ttu-id="1af29-124">Truncamento do log de transações</span><span class="sxs-lookup"><span data-stu-id="1af29-124">Transaction Log Truncation</span></span>  
 <span data-ttu-id="1af29-125">O truncamento de log libera espaço no arquivo de log para ser reutilizado pelo log de transações.</span><span class="sxs-lookup"><span data-stu-id="1af29-125">Log truncation frees space in the log file for reuse by the transaction log.</span></span> <span data-ttu-id="1af29-126">O truncamento de log é essencial para impedir o preenchimento do log.</span><span class="sxs-lookup"><span data-stu-id="1af29-126">Log truncation is essential to keep the log from filling.</span></span> <span data-ttu-id="1af29-127">O truncamento de log exclui arquivos de log virtuais inativos do log de transações lógicas de um banco de dados do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , liberando espaço no log lógico para reutilização pelo log de transações físicas.</span><span class="sxs-lookup"><span data-stu-id="1af29-127">Log truncation deletes inactive virtual log files from the logical transaction log of a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database, freeing space in the logical log for reuse by the Physical transaction log.</span></span> <span data-ttu-id="1af29-128">Se um log de transações nunca foi truncado, eventualmente, ele preencherá todo o espaço em disco alocado para seus arquivos de log físicos.</span><span class="sxs-lookup"><span data-stu-id="1af29-128">If a transaction log were never truncated, it would eventually fill all the disk space that is allocated to its physical log files.</span></span>  
  
 <span data-ttu-id="1af29-129">Para evitar esse problema, a menos que o truncamento de log esteja sendo atrasado por alguma razão, o truncamento ocorrerá automaticamente depois dos seguintes eventos:</span><span class="sxs-lookup"><span data-stu-id="1af29-129">To avoid this problem, unless log truncation is being delayed for some reason, truncation occurs automatically after the following events:</span></span>  
  
-   <span data-ttu-id="1af29-130">No modelo de recuperação simples, depois de um ponto de verificação.</span><span class="sxs-lookup"><span data-stu-id="1af29-130">Under the simple recovery model, after a checkpoint.</span></span>  
  
-   <span data-ttu-id="1af29-131">No modelo de recuperação completa ou bulk-logged, se um ponto de verificação ocorreu desde o backup anterior, o truncamento ocorrerá depois de um backup de log (a menos que esse seja um backup de log de cópia somente).</span><span class="sxs-lookup"><span data-stu-id="1af29-131">Under the full recovery model or bulk-logged recovery model, if a checkpoint has occurred since the previous backup, truncation occurs after a log backup (unless it is a copy-only log backup).</span></span>  
  
 <span data-ttu-id="1af29-132">Para obter mais informações, consulte [fatores que podem atrasar o truncamento de log](#FactorsThatDelayTruncation), mais adiante neste tópico.</span><span class="sxs-lookup"><span data-stu-id="1af29-132">For more information, see [Factors That Can Delay Log Truncation](#FactorsThatDelayTruncation), later in this topic.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="1af29-133">O truncamento de log não reduz o tamanho do arquivo de log físico.</span><span class="sxs-lookup"><span data-stu-id="1af29-133">Log truncation does not reduce the size of the physical log file.</span></span> <span data-ttu-id="1af29-134">Para reduzir o tamanho físico de um arquivo de log físico, você precisa reduzir o arquivo de log.</span><span class="sxs-lookup"><span data-stu-id="1af29-134">To reduce the physical size of a physical log file, you need to shrink the log file.</span></span> <span data-ttu-id="1af29-135">Para obter informações sobre como encolher o tamanho do arquivo de log físico, consulte [Gerenciar o tamanho do arquivo de log de transações](manage-the-size-of-the-transaction-log-file.md).</span><span class="sxs-lookup"><span data-stu-id="1af29-135">For information about shrinking the size of the physical log file, see [Manage the Size of the Transaction Log File](manage-the-size-of-the-transaction-log-file.md).</span></span>  
  
##  <a name="factors-that-can-delay-log-truncation"></a><a name="FactorsThatDelayTruncation"></a><span data-ttu-id="1af29-136">Fatores que podem atrasar o truncamento de log</span><span class="sxs-lookup"><span data-stu-id="1af29-136">Factors That Can Delay Log Truncation</span></span>  
 <span data-ttu-id="1af29-137">Quando os registros de log permanecem ativos por muito tempo, o truncamento do log de transações é atrasado e esse log poderá ocupar todo o espaço.</span><span class="sxs-lookup"><span data-stu-id="1af29-137">When log records remain active for a long time transaction log truncation is delayed, and potentially the transaction log can fill up.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="1af29-138">Para obter informações sobre como responder a um log de transação completa, consulte [Troubleshoot a Full Transaction Log &#40;SQL Server Error 9002&#41;](troubleshoot-a-full-transaction-log-sql-server-error-9002.md).</span><span class="sxs-lookup"><span data-stu-id="1af29-138">For information about how to respond to a full transaction log, see [Troubleshoot a Full Transaction Log &#40;SQL Server Error 9002&#41;](troubleshoot-a-full-transaction-log-sql-server-error-9002.md).</span></span>  
  
 <span data-ttu-id="1af29-139">O truncamento de log pode ser atrasado por uma variedade de fatores.</span><span class="sxs-lookup"><span data-stu-id="1af29-139">Log truncation can be delayed by a variety of factors.</span></span> <span data-ttu-id="1af29-140">É possível descobrir se, de fato, há algo impedindo o truncamento de log consultando as colunas **log_reuse_wait** e **log_reuse_wait_desc** da exibição do catálogo [sys.databases](/sql/relational-databases/system-catalog-views/sys-databases-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="1af29-140">You can discover what, if anything, is preventing log truncation by querying the **log_reuse_wait** and **log_reuse_wait_desc** columns of the [sys.databases](/sql/relational-databases/system-catalog-views/sys-databases-transact-sql) catalog view.</span></span> <span data-ttu-id="1af29-141">A tabela a seguir descreve os valores dessas colunas.</span><span class="sxs-lookup"><span data-stu-id="1af29-141">The following table describes the values of these columns.</span></span>  
  
|<span data-ttu-id="1af29-142">Valor log_reuse_wait</span><span class="sxs-lookup"><span data-stu-id="1af29-142">log_reuse_wait value</span></span>|<span data-ttu-id="1af29-143">Valor log_reuse_wait_desc</span><span class="sxs-lookup"><span data-stu-id="1af29-143">log_reuse_wait_desc value</span></span>|<span data-ttu-id="1af29-144">Descrição</span><span class="sxs-lookup"><span data-stu-id="1af29-144">Description</span></span>|  
|----------------------------|----------------------------------|-----------------|  
|<span data-ttu-id="1af29-145">0</span><span class="sxs-lookup"><span data-stu-id="1af29-145">0</span></span>|<span data-ttu-id="1af29-146">NOTHING</span><span class="sxs-lookup"><span data-stu-id="1af29-146">NOTHING</span></span>|<span data-ttu-id="1af29-147">Atualmente há um ou mais arquivos de log virtuais reutilizáveis.</span><span class="sxs-lookup"><span data-stu-id="1af29-147">Currently there are one or more reusable virtual log files.</span></span>|  
|<span data-ttu-id="1af29-148">1</span><span class="sxs-lookup"><span data-stu-id="1af29-148">1</span></span>|<span data-ttu-id="1af29-149">CHECKPOINT</span><span class="sxs-lookup"><span data-stu-id="1af29-149">CHECKPOINT</span></span>|<span data-ttu-id="1af29-150">Não aconteceu nenhum ponto de verificação desde o último truncamento de log, ou o início do log ainda não foi movido para fora de um arquivo de log virtual.</span><span class="sxs-lookup"><span data-stu-id="1af29-150">No checkpoint has occurred since the last log truncation, or the head of the log has not yet moved beyond a virtual log file.</span></span> <span data-ttu-id="1af29-151">(Todos os modelos de recuperação)</span><span class="sxs-lookup"><span data-stu-id="1af29-151">(All recovery models)</span></span><br /><br /> <span data-ttu-id="1af29-152">Essa é uma razão rotineira para atrasar o truncamento de log.</span><span class="sxs-lookup"><span data-stu-id="1af29-152">This is a routine reason for delaying log truncation.</span></span> <span data-ttu-id="1af29-153">Para obter mais informações, consulte [Pontos de verificação de banco de dados &#40;SQL Server&#41;](database-checkpoints-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="1af29-153">For more information, see [Database Checkpoints &#40;SQL Server&#41;](database-checkpoints-sql-server.md).</span></span>|  
|<span data-ttu-id="1af29-154">2</span><span class="sxs-lookup"><span data-stu-id="1af29-154">2</span></span>|<span data-ttu-id="1af29-155">LOG_BACKUP</span><span class="sxs-lookup"><span data-stu-id="1af29-155">LOG_BACKUP</span></span>|<span data-ttu-id="1af29-156">Um backup de log é necessário antes do truncamento do log de transações.</span><span class="sxs-lookup"><span data-stu-id="1af29-156">A log backup is required before the transaction log can be truncated.</span></span> <span data-ttu-id="1af29-157">(Modelos de recuperação completa e bulk-logged somente)</span><span class="sxs-lookup"><span data-stu-id="1af29-157">(Full or bulk-logged recovery models only)</span></span><br /><br /> <span data-ttu-id="1af29-158">Quando o backup de log seguinte é concluído, parte do espaço do log poder se tornar reutilizável.</span><span class="sxs-lookup"><span data-stu-id="1af29-158">When the next log backup is completed, some log space might become reusable.</span></span>|  
|<span data-ttu-id="1af29-159">3</span><span class="sxs-lookup"><span data-stu-id="1af29-159">3</span></span>|<span data-ttu-id="1af29-160">ACTIVE_BACKUP_OR_RESTORE</span><span class="sxs-lookup"><span data-stu-id="1af29-160">ACTIVE_BACKUP_OR_RESTORE</span></span>|<span data-ttu-id="1af29-161">Um backup de dados ou uma restauração está em andamento (todos os modelos de recuperação).</span><span class="sxs-lookup"><span data-stu-id="1af29-161">A data backup or a restore is in progress (all recovery models).</span></span><br /><br /> <span data-ttu-id="1af29-162">Se um backup de dados estiver evitando o truncamento de log, a operação de backup pode ajudar a solucionar o problema imediatamente.</span><span class="sxs-lookup"><span data-stu-id="1af29-162">If a data backup is preventing log truncation, canceling the backup operation might help the immediate problem.</span></span>|  
|<span data-ttu-id="1af29-163">4</span><span class="sxs-lookup"><span data-stu-id="1af29-163">4</span></span>|<span data-ttu-id="1af29-164">ACTIVE_TRANSACTION</span><span class="sxs-lookup"><span data-stu-id="1af29-164">ACTIVE_TRANSACTION</span></span>|<span data-ttu-id="1af29-165">Uma transação está ativa (todos os modelos de recuperação).</span><span class="sxs-lookup"><span data-stu-id="1af29-165">A transaction is active (all recovery models).</span></span><br /><br /> <span data-ttu-id="1af29-166">É possível haver uma transação de longa execução no início do backup de log.</span><span class="sxs-lookup"><span data-stu-id="1af29-166">A long-running transaction might exist at the start of the log backup.</span></span> <span data-ttu-id="1af29-167">Nesse caso, a liberação de espaço pode exigir outro backup de log.</span><span class="sxs-lookup"><span data-stu-id="1af29-167">In this case, freeing the space might require another log backup.</span></span> <span data-ttu-id="1af29-168">Observe que as transações de execução longa impedem o truncamento de log em todos os modelos de recuperação, incluindo o modelo de recuperação simples, sob o qual o log de transações geralmente fica truncado em cada ponto de verificação automático.</span><span class="sxs-lookup"><span data-stu-id="1af29-168">Note that a long-running transactions prevent log truncation under all recovery models, including the simple recovery model, under which the transaction log is generally truncated on each automatic checkpoint.</span></span><br /><br /> <span data-ttu-id="1af29-169">Uma transação é adiada.</span><span class="sxs-lookup"><span data-stu-id="1af29-169">A transaction is deferred.</span></span> <span data-ttu-id="1af29-170">Uma *transação adiada* é efetivamente uma transação ativa cuja reversão é bloqueada por causa de algum recurso indisponível.</span><span class="sxs-lookup"><span data-stu-id="1af29-170">A *deferred transaction* is effectively an active transaction whose rollback is blocked because of some unavailable resource.</span></span> <span data-ttu-id="1af29-171">Para obter informações sobre as causas de transações adiadas e como fazer com que elas saiam do estado adiado, consulte [Transações adiadas &#40;SQL Server&#41;](../backup-restore/deferred-transactions-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="1af29-171">For information about the causes of deferred transactions and how to move them out of the deferred state, see [Deferred Transactions &#40;SQL Server&#41;](../backup-restore/deferred-transactions-sql-server.md).</span></span> <br /><br /><span data-ttu-id="1af29-172">Transações demoradas também podem preencher o log de transações do tempdb.</span><span class="sxs-lookup"><span data-stu-id="1af29-172">Long-running transactions might also fill up tempdb's transaction log.</span></span> <span data-ttu-id="1af29-173">Tempdb é usado implicitamente por transações de usuário para objetos internos, como tabelas de trabalho para classificação, arquivos de trabalho para hashing, tabelas de trabalho do cursor e a controle de versão de linha.</span><span class="sxs-lookup"><span data-stu-id="1af29-173">Tempdb is used implicitly by user transactions for internal objects such as work tables for sorting, work files for hashing, cursor work tables, and row versioning.</span></span> <span data-ttu-id="1af29-174">Mesmo se a transação do usuário incluir apenas a leitura de dados (consultas SELECT), os objetos internos poderão ser criados e usados em transações do usuário.</span><span class="sxs-lookup"><span data-stu-id="1af29-174">Even if the user transaction includes only reading data (SELECT queries), internal objects may be created and used under user transactions.</span></span> <span data-ttu-id="1af29-175">Dessa forma, o log de transações de tempdb pode ser preenchido.</span><span class="sxs-lookup"><span data-stu-id="1af29-175">Then the tempdb transaction log can be filled.</span></span>|  
|<span data-ttu-id="1af29-176">5</span><span class="sxs-lookup"><span data-stu-id="1af29-176">5</span></span>|<span data-ttu-id="1af29-177">DATABASE_MIRRORING</span><span class="sxs-lookup"><span data-stu-id="1af29-177">DATABASE_MIRRORING</span></span>|<span data-ttu-id="1af29-178">O espelhamento de banco de dados está pausado, ou em um modo de alto desempenho, o banco de dados espelho fica significativamente atrás do banco de dados principal.</span><span class="sxs-lookup"><span data-stu-id="1af29-178">Database mirroring is paused, or under high-performance mode, the mirror database is significantly behind the principal database.</span></span> <span data-ttu-id="1af29-179">(Apenas modelo de recuperação completa)</span><span class="sxs-lookup"><span data-stu-id="1af29-179">(Full recovery model only)</span></span><br /><br /> <span data-ttu-id="1af29-180">Para obter mais informações, consulte [Espelhamento de banco de dados &#40;SQL Server&#41;](../../database-engine/database-mirroring/database-mirroring-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="1af29-180">For more information, see [Database Mirroring &#40;SQL Server&#41;](../../database-engine/database-mirroring/database-mirroring-sql-server.md).</span></span>|  
|<span data-ttu-id="1af29-181">6</span><span class="sxs-lookup"><span data-stu-id="1af29-181">6</span></span>|<span data-ttu-id="1af29-182">REPLICAÇÃO</span><span class="sxs-lookup"><span data-stu-id="1af29-182">REPLICATION</span></span>|<span data-ttu-id="1af29-183">Durante as replicações transacionais, as transações relevantes para as publicações ainda não foram entregues no banco de dados de distribuição.</span><span class="sxs-lookup"><span data-stu-id="1af29-183">During transactional replications, transactions relevant to the publications are still undelivered to the distribution database.</span></span> <span data-ttu-id="1af29-184">(Apenas modelo de recuperação completa)</span><span class="sxs-lookup"><span data-stu-id="1af29-184">(Full recovery model only)</span></span><br /><br /> <span data-ttu-id="1af29-185">Para obter mais informações sobre a replicação transacional, consulte [SQL Server Replication](../../relational-databases/replication/sql-server-replication.md).</span><span class="sxs-lookup"><span data-stu-id="1af29-185">For information about transactional replication, see [SQL Server Replication](../../relational-databases/replication/sql-server-replication.md).</span></span>|  
|<span data-ttu-id="1af29-186">7</span><span class="sxs-lookup"><span data-stu-id="1af29-186">7</span></span>|<span data-ttu-id="1af29-187">DATABASE_SNAPSHOT_CREATION</span><span class="sxs-lookup"><span data-stu-id="1af29-187">DATABASE_SNAPSHOT_CREATION</span></span>|<span data-ttu-id="1af29-188">Um instantâneo de banco de dados está sendo criado.</span><span class="sxs-lookup"><span data-stu-id="1af29-188">A database snapshot is being created.</span></span> <span data-ttu-id="1af29-189">(Todos os modelos de recuperação)</span><span class="sxs-lookup"><span data-stu-id="1af29-189">(All recovery models)</span></span><br /><br /> <span data-ttu-id="1af29-190">Esse é um motivo rotineiro e, normalmente breve, de truncamento de log atrasado.</span><span class="sxs-lookup"><span data-stu-id="1af29-190">This is a routine, and typically brief, cause of delayed log truncation.</span></span>|  
|<span data-ttu-id="1af29-191">8</span><span class="sxs-lookup"><span data-stu-id="1af29-191">8</span></span>|<span data-ttu-id="1af29-192">LOG_SCAN</span><span class="sxs-lookup"><span data-stu-id="1af29-192">LOG_SCAN</span></span>|<span data-ttu-id="1af29-193">Um exame de log está ocorrendo.</span><span class="sxs-lookup"><span data-stu-id="1af29-193">A log scan is occurring.</span></span> <span data-ttu-id="1af29-194">(Todos os modelos de recuperação)</span><span class="sxs-lookup"><span data-stu-id="1af29-194">(All recovery models)</span></span><br /><br /> <span data-ttu-id="1af29-195">Esse é um motivo rotineiro e, normalmente breve, de truncamento de log atrasado.</span><span class="sxs-lookup"><span data-stu-id="1af29-195">This is a routine, and typically brief, cause of delayed log truncation.</span></span>|  
|<span data-ttu-id="1af29-196">9</span><span class="sxs-lookup"><span data-stu-id="1af29-196">9</span></span>|<span data-ttu-id="1af29-197">AVAILABILITY_REPLICA</span><span class="sxs-lookup"><span data-stu-id="1af29-197">AVAILABILITY_REPLICA</span></span>|<span data-ttu-id="1af29-198">Uma réplica secundária de um grupo de disponibilidade está aplicando registros de log de transações desse banco de dados para um banco de dados secundário correspondente.</span><span class="sxs-lookup"><span data-stu-id="1af29-198">A secondary replica of an availability group is applying transaction log records of this database to a corresponding secondary database.</span></span> <span data-ttu-id="1af29-199">(Modelo de recuperação completa)</span><span class="sxs-lookup"><span data-stu-id="1af29-199">(Full recovery model)</span></span><br /><br /> <span data-ttu-id="1af29-200">Para obter mais informações, consulte [visão geral do Grupos de Disponibilidade AlwaysOn &#40;SQL Server&#41;](../../database-engine/availability-groups/windows/overview-of-always-on-availability-groups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="1af29-200">For more information, see [Overview of AlwaysOn Availability Groups &#40;SQL Server&#41;](../../database-engine/availability-groups/windows/overview-of-always-on-availability-groups-sql-server.md).</span></span>|  
|<span data-ttu-id="1af29-201">10</span><span class="sxs-lookup"><span data-stu-id="1af29-201">10</span></span>|-|<span data-ttu-id="1af29-202">Apenas para uso interno</span><span class="sxs-lookup"><span data-stu-id="1af29-202">For internal use only</span></span>|  
|<span data-ttu-id="1af29-203">11</span><span class="sxs-lookup"><span data-stu-id="1af29-203">11</span></span>|-|<span data-ttu-id="1af29-204">Apenas para uso interno</span><span class="sxs-lookup"><span data-stu-id="1af29-204">For internal use only</span></span>|  
|<span data-ttu-id="1af29-205">12</span><span class="sxs-lookup"><span data-stu-id="1af29-205">12</span></span>|-|<span data-ttu-id="1af29-206">Apenas para uso interno</span><span class="sxs-lookup"><span data-stu-id="1af29-206">For internal use only</span></span>|  
|<span data-ttu-id="1af29-207">13</span><span class="sxs-lookup"><span data-stu-id="1af29-207">13</span></span>|<span data-ttu-id="1af29-208">OLDEST_PAGE</span><span class="sxs-lookup"><span data-stu-id="1af29-208">OLDEST_PAGE</span></span>|<span data-ttu-id="1af29-209">Se um banco de dados estiver configurado para usar pontos de verificação indiretos, a página mais antiga no banco de dados poderá ser mais antiga do que o LSN do ponto de verificação.</span><span class="sxs-lookup"><span data-stu-id="1af29-209">If a database is configured to use indirect checkpoints, the oldest page on the database might be older than the checkpoint LSN.</span></span> <span data-ttu-id="1af29-210">Nesse caso, a página mais antiga pode atrasar o truncamento de log.</span><span class="sxs-lookup"><span data-stu-id="1af29-210">In this case, the oldest page can delay log truncation.</span></span> <span data-ttu-id="1af29-211">(Todos os modelos de recuperação)</span><span class="sxs-lookup"><span data-stu-id="1af29-211">(All recovery models)</span></span><br /><br /> <span data-ttu-id="1af29-212">Para obter informações sobre pontos de verificação indiretos, consulte [Database Checkpoints &#40;SQL Server&#41;](database-checkpoints-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="1af29-212">For information about indirect checkpoints, see [Database Checkpoints &#40;SQL Server&#41;](database-checkpoints-sql-server.md).</span></span>|  
|<span data-ttu-id="1af29-213">14</span><span class="sxs-lookup"><span data-stu-id="1af29-213">14</span></span>|<span data-ttu-id="1af29-214">OTHER_TRANSIENT</span><span class="sxs-lookup"><span data-stu-id="1af29-214">OTHER_TRANSIENT</span></span>|<span data-ttu-id="1af29-215">Esse valor não é usado atualmente.</span><span class="sxs-lookup"><span data-stu-id="1af29-215">This value is currently not used.</span></span>|  
|<span data-ttu-id="1af29-216">16</span><span class="sxs-lookup"><span data-stu-id="1af29-216">16</span></span>|<span data-ttu-id="1af29-217">XTP_CHECKPOINT</span><span class="sxs-lookup"><span data-stu-id="1af29-217">XTP_CHECKPOINT</span></span>|<span data-ttu-id="1af29-218">Quando um banco de dados tem um grupo de arquivos com otimização de memória, o log de transações não pode truncar até o ponto de verificação automático [!INCLUDE[hek_2](../../includes/hek-2-md.md)] ser acionado (o que acontece a cada 512 MB de aumento do log).</span><span class="sxs-lookup"><span data-stu-id="1af29-218">When a database has a memory-optimized filegroup, the transaction log may not truncate until automatic [!INCLUDE[hek_2](../../includes/hek-2-md.md)] checkpoint is triggered (which happens at every 512 MB of log growth).</span></span><br /><br /> <span data-ttu-id="1af29-219">Observação: para truncar o log de transações antes do tamanho de 512 MB, acione o comando de ponto de verificação manualmente no banco de dados em questão.</span><span class="sxs-lookup"><span data-stu-id="1af29-219">Note: To truncate transaction log before 512 MB size, fire the Checkpoint command manually against the database in question.</span></span>|  
  
##  <a name="operations-that-can-be-minimally-logged"></a><a name="MinimallyLogged"></a><span data-ttu-id="1af29-220">Operações que podem ser minimamente registradas em log</span><span class="sxs-lookup"><span data-stu-id="1af29-220">Operations That Can Be Minimally Logged</span></span>  
 <span data-ttu-id="1af29-221">O*registro mínimo em log* envolve o registro somente das informações que são necessárias para recuperar a transação sem oferecer suporte à recuperação pontual.</span><span class="sxs-lookup"><span data-stu-id="1af29-221">*Minimal logging* involves logging only the information that is required to recover the transaction without supporting point-in-time recovery.</span></span> <span data-ttu-id="1af29-222">Este tópico identifica as operações com registro mínimo em log no modelo de recuperação bulk-logged (como também no modelo de recuperação simples, exceto quando há um backup em execução).</span><span class="sxs-lookup"><span data-stu-id="1af29-222">This topic identifies the operations that are minimally logged under the bulk-logged recovery model (as well as under the simple recovery model, except when a backup is running).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="1af29-223">O log mínimo não tem suporte para tabelas com otimização de memória.</span><span class="sxs-lookup"><span data-stu-id="1af29-223">Minimal logging is not supported for memory-optimized tables.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="1af29-224">No modelo de recuperação completa, todas as operações em massa são completamente registradas.</span><span class="sxs-lookup"><span data-stu-id="1af29-224">Under the full recovery model, all bulk operations are fully logged.</span></span> <span data-ttu-id="1af29-225">Porém, você pode minimizar o log de um conjunto de operações em massa alternando o banco de dados temporariamente para o modelo de recuperação bulk-logged, nas operações em massa.</span><span class="sxs-lookup"><span data-stu-id="1af29-225">However, you can minimize logging for a set of bulk operations by switching the database to the bulk-logged recovery model temporarily for bulk operations.</span></span> <span data-ttu-id="1af29-226">O registro mínimo em log é mais eficiente do que o registro completo, e reduz a possibilidade de que uma operação em massa em grande escala preencha o espaço do log de transações disponível durante uma transação em massa.</span><span class="sxs-lookup"><span data-stu-id="1af29-226">Minimal logging is more efficient than full logging, and it reduces the possibility of a large-scale bulk operation filling the available transaction log space during a bulk transaction.</span></span> <span data-ttu-id="1af29-227">Porém, se o banco de dados for danificado ou perdido quando o registro mínimo em log estiver em vigor, você não poderá recuperar o banco de dados até o ponto de falha.</span><span class="sxs-lookup"><span data-stu-id="1af29-227">However, if the database is damaged or lost when minimal logging is in effect, you cannot recover the database to the point of failure.</span></span>  
  
 <span data-ttu-id="1af29-228">As operações a seguir, completamente registradas sob o modelo de recuperação completa, têm log mínimo no modelo de recuperação simples e bulk-logged:</span><span class="sxs-lookup"><span data-stu-id="1af29-228">The following operations, which are fully logged under the full recovery model, are minimally logged under the simple and bulk-logged recovery model:</span></span>  
  
-   <span data-ttu-id="1af29-229">Operações de importação em massa ([bcp](../../tools/bcp-utility.md), [BULK INSERT](/sql/t-sql/statements/bulk-insert-transact-sql) e [INSERT... SELECT](/sql/t-sql/statements/insert-transact-sql)).</span><span class="sxs-lookup"><span data-stu-id="1af29-229">Bulk import operations ([bcp](../../tools/bcp-utility.md), [BULK INSERT](/sql/t-sql/statements/bulk-insert-transact-sql), and [INSERT... SELECT](/sql/t-sql/statements/insert-transact-sql)).</span></span> <span data-ttu-id="1af29-230">Para obter mais informações sobre quando a importação em massa para uma tabela é minimamente registrada em log, consulte [Prerequisites for Minimal Logging in Bulk Import](../import-export/prerequisites-for-minimal-logging-in-bulk-import.md).</span><span class="sxs-lookup"><span data-stu-id="1af29-230">For more information about when bulk import into a table is minimally logged, see [Prerequisites for Minimal Logging in Bulk Import](../import-export/prerequisites-for-minimal-logging-in-bulk-import.md).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="1af29-231">Quando a replicação transacional está habilitada, as operações BULK INSERT são completamente registradas mesmo no modelo de recuperação bulk-logged.</span><span class="sxs-lookup"><span data-stu-id="1af29-231">When transactional replication is enabled, BULK INSERT operations are fully logged even under the Bulk Logged recovery model.</span></span>  
  
-   <span data-ttu-id="1af29-232">Operações SELECT [into](/sql/t-sql/queries/select-into-clause-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="1af29-232">SELECT [INTO](/sql/t-sql/queries/select-into-clause-transact-sql) operations.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="1af29-233">Quando a replicação transacional está habilitada, as operações SELECT INTO são completamente registradas mesmo no modelo de recuperação bulk-logged.</span><span class="sxs-lookup"><span data-stu-id="1af29-233">When transactional replication is enabled, SELECT INTO operations are fully logged even under the Bulk Logged recovery model.</span></span>  
  
-   <span data-ttu-id="1af29-234">Atualizações parciais em tipos de dados de valor grande, usando a cláusula .WRITE na instrução [UPDATE](/sql/t-sql/queries/update-transact-sql) ao inserir ou anexar novos dados.</span><span class="sxs-lookup"><span data-stu-id="1af29-234">Partial updates to large value data types, using the .WRITE clause in the [UPDATE](/sql/t-sql/queries/update-transact-sql) statement when inserting or appending new data.</span></span> <span data-ttu-id="1af29-235">Observe que o log mínimo não é usado quando valores existentes estão sendo atualizados.</span><span class="sxs-lookup"><span data-stu-id="1af29-235">Note that minimal logging is not used when existing values are updated.</span></span> <span data-ttu-id="1af29-236">Para obter mais informações sobre tipos de dados de valor grandes, consulte [Tipos de dados &#40;Transact-SQL&#41;](/sql/t-sql/data-types/data-types-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="1af29-236">For more information about large value data types, see [Data Types &#40;Transact-SQL&#41;](/sql/t-sql/data-types/data-types-transact-sql).</span></span>  
  
-   <span data-ttu-id="1af29-237">Instruções [WRITETEXT](/sql/t-sql/queries/writetext-transact-sql) e [UPDATETEXT](/sql/t-sql/queries/updatetext-transact-sql) ao inserir ou acrescentar novos dados nas colunas de `text` tipo de `ntext` dados, e `image` .</span><span class="sxs-lookup"><span data-stu-id="1af29-237">[WRITETEXT](/sql/t-sql/queries/writetext-transact-sql) and [UPDATETEXT](/sql/t-sql/queries/updatetext-transact-sql) statements when inserting or appending new data into the `text`, `ntext`, and `image` data type columns.</span></span> <span data-ttu-id="1af29-238">Observe que o log mínimo não é usado quando valores existentes estão sendo atualizados.</span><span class="sxs-lookup"><span data-stu-id="1af29-238">Note that minimal logging is not used when existing values are updated.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="1af29-239">As instruções WRITETEXT e UPDATETEXT são preteridas, portanto evite usá-las em novos aplicativos.</span><span class="sxs-lookup"><span data-stu-id="1af29-239">The WRITETEXT and UPDATETEXT statements are deprecated, so you should avoid using them in new applications.</span></span>  
  
-   <span data-ttu-id="1af29-240">Se o banco de dados for definido como o modelo de recuperação simples ou bulk-logged, algumas operações INDEX DDL terão log mínimo, independentemente de elas serem executadas offline ou online.</span><span class="sxs-lookup"><span data-stu-id="1af29-240">If the database is set to the simple or bulk-logged recovery model, some index DDL operations are minimally logged whether the operation is executed offline or online.</span></span> <span data-ttu-id="1af29-241">As operações de índice de log mínimo são:</span><span class="sxs-lookup"><span data-stu-id="1af29-241">The minimally logged index operations are as follows:</span></span>  
  
    -   <span data-ttu-id="1af29-242">Operações[CREATE INDEX](/sql/t-sql/statements/create-index-transact-sql) (incluindo exibições indexadas).</span><span class="sxs-lookup"><span data-stu-id="1af29-242">[CREATE INDEX](/sql/t-sql/statements/create-index-transact-sql) operations (including indexed views).</span></span>  
  
    -   <span data-ttu-id="1af29-243">Operações[ALTER INDEX](/sql/t-sql/statements/alter-index-transact-sql) REBUILD ou DBCC DBREINDEX.</span><span class="sxs-lookup"><span data-stu-id="1af29-243">[ALTER INDEX](/sql/t-sql/statements/alter-index-transact-sql) REBUILD or DBCC DBREINDEX operations.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="1af29-244">A instrução DBCC DBREINDEX é preterida, portanto evite usá-la em novos aplicativos.</span><span class="sxs-lookup"><span data-stu-id="1af29-244">The DBCC DBREINDEX statement is deprecated so you should avoid using it in new applications.</span></span>  
  
    -   <span data-ttu-id="1af29-245">Recriação de novo heap DROP INDEX (se aplicável).</span><span class="sxs-lookup"><span data-stu-id="1af29-245">DROP INDEX new heap rebuild (if applicable).</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="1af29-246"> A desalocação de páginas de índice durante uma operação [DROP INDEX](/sql/t-sql/statements/drop-index-transact-sql) sempre é totalmente registrada em log.</span><span class="sxs-lookup"><span data-stu-id="1af29-246">Index page deallocation during a [DROP INDEX](/sql/t-sql/statements/drop-index-transact-sql) operation is always fully logged.</span></span>  
  
##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="1af29-247">Tarefas relacionadas</span><span class="sxs-lookup"><span data-stu-id="1af29-247">Related Tasks</span></span>  
 `Managing the transaction log`  
  
-   [<span data-ttu-id="1af29-248">Gerenciar o tamanho do arquivo de log de transações</span><span class="sxs-lookup"><span data-stu-id="1af29-248">Manage the Size of the Transaction Log File</span></span>](manage-the-size-of-the-transaction-log-file.md)  
  
-   [<span data-ttu-id="1af29-249">Solução de problemas de um log de transação completa &#40;Erro do SQL Server 9002&#41;</span><span class="sxs-lookup"><span data-stu-id="1af29-249">Troubleshoot a Full Transaction Log &#40;SQL Server Error 9002&#41;</span></span>](troubleshoot-a-full-transaction-log-sql-server-error-9002.md)  
  
 <span data-ttu-id="1af29-250">**Fazendo backup do log de transações (Modelo de recuperação completa)**</span><span class="sxs-lookup"><span data-stu-id="1af29-250">**Backing Up the Transaction Log (Full Recovery Model)**</span></span>  
  
-   [<span data-ttu-id="1af29-251">Fazer backup de um log de transações &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="1af29-251">Back Up a Transaction Log &#40;SQL Server&#41;</span></span>](../backup-restore/back-up-a-transaction-log-sql-server.md)  
  
 <span data-ttu-id="1af29-252">**Restaurando o log de transações (Modelo de recuperação completa)**</span><span class="sxs-lookup"><span data-stu-id="1af29-252">**Restoring the Transaction Log (Full Recovery Model)**</span></span>  
  
-  [<span data-ttu-id="1af29-253">Restaurar um backup de log de transações</span><span class="sxs-lookup"><span data-stu-id="1af29-253">Restore a Transaction Log Backup</span></span>](../backup-restore/restore-a-transaction-log-backup-sql-server.md)   
  
## <a name="see-also"></a><span data-ttu-id="1af29-254">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="1af29-254">See Also</span></span>  
 <span data-ttu-id="1af29-255">[Controlar a durabilidade da transação](control-transaction-durability.md) </span><span class="sxs-lookup"><span data-stu-id="1af29-255">[Control Transaction Durability](control-transaction-durability.md) </span></span>  
 <span data-ttu-id="1af29-256">[Pré-requisitos para log mínimo em importação em massa](../import-export/prerequisites-for-minimal-logging-in-bulk-import.md) </span><span class="sxs-lookup"><span data-stu-id="1af29-256">[Prerequisites for Minimal Logging in Bulk Import](../import-export/prerequisites-for-minimal-logging-in-bulk-import.md) </span></span>  
 <span data-ttu-id="1af29-257">[Fazer backup e restaurar bancos de dados do SQL Server](../backup-restore/back-up-and-restore-of-sql-server-databases.md) </span><span class="sxs-lookup"><span data-stu-id="1af29-257">[Back Up and Restore of SQL Server Databases](../backup-restore/back-up-and-restore-of-sql-server-databases.md) </span></span>  
 <span data-ttu-id="1af29-258">[Pontos de verificação de banco de dados &#40;SQL Server&#41;](database-checkpoints-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="1af29-258">[Database Checkpoints &#40;SQL Server&#41;](database-checkpoints-sql-server.md) </span></span>  
 <span data-ttu-id="1af29-259">[Exibir ou alterar as propriedades de um banco de dados](../databases/view-or-change-the-properties-of-a-database.md) </span><span class="sxs-lookup"><span data-stu-id="1af29-259">[View or Change the Properties of a Database](../databases/view-or-change-the-properties-of-a-database.md) </span></span>  
 [<span data-ttu-id="1af29-260">Modelos de recuperação &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="1af29-260">Recovery Models &#40;SQL Server&#41;</span></span>](../backup-restore/recovery-models-sql-server.md)  
  
  
