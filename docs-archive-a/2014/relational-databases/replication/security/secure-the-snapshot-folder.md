---
title: Proteger a pasta de instantâneo | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- snapshots [SQL Server replication], security
ms.assetid: 3cd877d1-ffb8-48fd-a72b-98eb948aad27
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: c977936ad2aca6e5a98ee685a15662a00b625494
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87576274"
---
# <a name="secure-the-snapshot-folder"></a><span data-ttu-id="e8033-102">Proteger uma pasta de instantâneo</span><span class="sxs-lookup"><span data-stu-id="e8033-102">Secure the Snapshot Folder</span></span>
  <span data-ttu-id="e8033-103">A pasta de instantâneo é um diretório que armazena arquivos de instantâneos, recomendamos que você dedique o diretório para o armazenamento de instantâneos.</span><span class="sxs-lookup"><span data-stu-id="e8033-103">The snapshot folder is a directory that stores snapshot files; it is recommended that you dedicate the directory for snapshot storage.</span></span> <span data-ttu-id="e8033-104">Conceda permissão de gravação ao Agente de Instantâneo para a pasta e assegure que a permissão de leitura seja fornecida somente para a conta do Windows usada pelo Agente de Distribuição ou Agente de Mesclagem para acessar a pasta.</span><span class="sxs-lookup"><span data-stu-id="e8033-104">Grant the Snapshot Agent write permission to the folder, and ensure that read permission is granted only to the Windows account that the Merge Agent or Distribution agent uses when accessing the folder.</span></span> <span data-ttu-id="e8033-105">A conta do Windows associada com o agente deve ser uma conta de domínio para acessar uma pasta de instantâneo que está localiza em um computador remoto.</span><span class="sxs-lookup"><span data-stu-id="e8033-105">The Windows account associated with the agent must be a domain account to access a snapshot folder that is located on a remote computer.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e8033-106">O UAC (Controle de Conta de Usuário) ajuda os administradores a gerenciar o uso de direitos do usuário elevados (algumas vezes chamados de *privilégios*).</span><span class="sxs-lookup"><span data-stu-id="e8033-106">User Account Control (UAC)  helps administrators manage their elevated user rights (sometimes called *privileges*).</span></span> <span data-ttu-id="e8033-107">Ao ser executado em sistemas operacionais com UAC habilitado, os administradores não usam seus direitos administrativos.</span><span class="sxs-lookup"><span data-stu-id="e8033-107">When running on operating systems that have UAC enabled, administrators do not use their administrative rights.</span></span> <span data-ttu-id="e8033-108">Em vez disso, eles executam a maioria das ações como usuários padrão (não administrativos), assumindo temporariamente seus direitos administrativos somente quando necessário.</span><span class="sxs-lookup"><span data-stu-id="e8033-108">Instead, they perform most actions as standard (non-administrative) users, temporarily assuming their administrative rights only when it is required.</span></span> <span data-ttu-id="e8033-109">O UAC pode impedir o acesso administrativo ao compartilhamento de instantâneos.</span><span class="sxs-lookup"><span data-stu-id="e8033-109">UAC can prevent administrative access to the snapshot share.</span></span> <span data-ttu-id="e8033-110">Portanto, você deve conceder permissões de compartilhamento de instantâneos explicitamente às contas do Windows usadas pelo Agente de Instantâneo, pelo Agente de Distribuição, e pelo Agente de Mesclagem.</span><span class="sxs-lookup"><span data-stu-id="e8033-110">You must therefore explicitly grant snapshot share permissions to the Windows accounts that are used by the Snapshot Agent, Distribution Agent, and Merge Agent.</span></span> <span data-ttu-id="e8033-111">Faça isso, mesmo se as contas do Windows forem membros do grupo de Administradores.</span><span class="sxs-lookup"><span data-stu-id="e8033-111">You must do this even if the Windows accounts are members of the Administrators group.</span></span>  
  
 <span data-ttu-id="e8033-112">Ao configurar um Distribuidor por meio do Assistente para Configurar Distribuição ou do Assistente para Nova Publicação, a pasta de instantâneo usa por padrão um caminho local: X:\\Arquivos de Programas\Microsoft SQL Server\\ *\<instance>* \MSSQL\ReplData.</span><span class="sxs-lookup"><span data-stu-id="e8033-112">When configuring a Distributor through the Configure Distribution Wizard or the New Publication Wizard, the snapshot folder defaults to a local path: X:\Program Files\Microsoft SQL Server\\*\<instance>* \MSSQL\ReplData.</span></span> <span data-ttu-id="e8033-113">Se estiver usando um Distribuidor remoto ou assinaturas pull, você deverá especificar um compartilhamento de rede UNC (como \\\\<*computername>* \snapshot) em vez de um caminho local.</span><span class="sxs-lookup"><span data-stu-id="e8033-113">If you are using a remote Distributor or pull subscriptions, you must specify a UNC network share (such as \\\\<*computername>* \snapshot) rather than a local path.</span></span>  
  
 <span data-ttu-id="e8033-114">Ao fornecer permissões de acesso para a pasta de instantâneos, você deve fornecê-las de acordo com o modo como a pasta é acessada.</span><span class="sxs-lookup"><span data-stu-id="e8033-114">When granting permissions to access the snapshot folder, you must grant them according to the way in which the folder is accessed.</span></span> <span data-ttu-id="e8033-115">As guias de caixa de diálogo abaixo são usadas no [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows 2003:</span><span class="sxs-lookup"><span data-stu-id="e8033-115">The following dialog box tabs are used in [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows 2003:</span></span>  
  
-   <span data-ttu-id="e8033-116">Se você especificar um caminho local, forneça permissões para a pasta por meio da guia **Segurança** da caixa de diálogo **Propriedades** .</span><span class="sxs-lookup"><span data-stu-id="e8033-116">If you specify a local path, grant permissions through the **Security** tab of the **Properties** dialog box for the folder.</span></span>  
  
-   <span data-ttu-id="e8033-117">Se você especificar um compartilhamento de rede, forneça permissões para a pasta por meio da guia **Compartilhamento** da caixa de diálogo **Propriedades** .</span><span class="sxs-lookup"><span data-stu-id="e8033-117">If you specify a network share, grant permissions through the **Sharing** tab of the **Properties** dialog box for the folder.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="e8033-118">Se o agente de replicação for executado no Distribuidor, use a guia **Segurança** da caixa de diálogo **Propriedades** da pasta para conceder permissões para a conta do Windows usada para executar o agente.</span><span class="sxs-lookup"><span data-stu-id="e8033-118">If the replication agent runs on the Distributor, use the **Security** tab of the **Properties** dialog box for the folder to grant permissions to the Windows account used to run the agent.</span></span> <span data-ttu-id="e8033-119">Faça isso até mesmo quando for usado um compartilhamento de rede.</span><span class="sxs-lookup"><span data-stu-id="e8033-119">Do this even when a network share is used.</span></span> <span data-ttu-id="e8033-120">Isso se aplica ao Agente de Distribuição e ao Agente de Mesclagem para uma assinatura push e ao Agente de Instantâneo quando o Publicador e o Distribuidor estiverem no mesmo computador.</span><span class="sxs-lookup"><span data-stu-id="e8033-120">This applies to the Merge Agent and Distribution Agent for a push subscription and to the Snapshot Agent when the Publisher and Distributor are on the same computer.</span></span>  
  
 <span data-ttu-id="e8033-121">Para obter mais informações sobre como configurar permissões para caminhos locais e compartilhamentos de rede, consulte a documentação do Windows.</span><span class="sxs-lookup"><span data-stu-id="e8033-121">For more information about setting permissions for local paths and network shares, see the Windows documentation.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e8033-122">Se uma publicação for cancelada, a replicação tentará remover a pasta de instantâneo no contexto de segurança da conta de serviço do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="e8033-122">If a publication is dropped, replication attempts to remove the snapshot folder under the security context of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] service account.</span></span> <span data-ttu-id="e8033-123">Caso esta conta não tenha privilégios suficientes, faça logon com uma conta que possua privilégios suficientes e remova a pasta manualmente.</span><span class="sxs-lookup"><span data-stu-id="e8033-123">If this account does not have sufficient privileges, log in with an account that does have sufficient privileges and remove the folder manually.</span></span> <span data-ttu-id="e8033-124">A remoção de uma pasta exige o privilégio **Modificar** se a pasta estiver em um caminho local ou o privilégio **Controle Total** se a pasta estiver em um caminho de rede.</span><span class="sxs-lookup"><span data-stu-id="e8033-124">Removing a folder requires the **Modify** privilege if the folder is a local path or the **Full Control** privilege if the folder is a network path.</span></span>  
  
## <a name="delivering-snapshots-through-ftp"></a><span data-ttu-id="e8033-125">Entregando instantâneos por FTP</span><span class="sxs-lookup"><span data-stu-id="e8033-125">Delivering Snapshots Through FTP</span></span>  
 <span data-ttu-id="e8033-126">Sugerimos como prática recomendada que os instantâneos sejam armazenados em um compartilhamento UNC, porém os instantâneos podem ser armazenados em um compartilhamento FTP e então enviados a um Assinante via FTP.</span><span class="sxs-lookup"><span data-stu-id="e8033-126">It is recommended as a security best practice that snapshots be stored in a UNC share, but snapshots can be stored in an FTP share and then delivered to a Subscriber through FTP.</span></span> <span data-ttu-id="e8033-127">Ao configurar o servidor FTP, assegure que o diretório virtual expõe um compartilhamento UNC subjacente que permite o acesso de gravação pelo Agente de Instantâneo para a publicação.</span><span class="sxs-lookup"><span data-stu-id="e8033-127">When configuring the FTP server, ensure that the virtual directory exposes an underlying UNC share that permits write access by the Snapshot Agent for the publication.</span></span>  
  
 <span data-ttu-id="e8033-128">Para configurar um Assinante para recuperar o Instantâneo via FTP, defina primeiro um servidor FTP com um logon e senha que permita aos Assinantes acesso de leitura (ou “obter”) para permitir que os arquivos dos instantâneos possam ser baixados.</span><span class="sxs-lookup"><span data-stu-id="e8033-128">To configure a Subscriber to retrieve the Snapshot via FTP, first set up an FTP server with an FTP login and password that allows Subscribers read (or "get") access to allow the snapshot files to be downloaded.</span></span>  
  
 <span data-ttu-id="e8033-129">Para entregar um instantâneo por FTP, consulte [Entregar um instantâneo por FTP](../publish/deliver-a-snapshot-through-ftp.md).</span><span class="sxs-lookup"><span data-stu-id="e8033-129">To deliver snapshots through FTP, see [Deliver a Snapshot Through FTP](../publish/deliver-a-snapshot-through-ftp.md).</span></span>  
  
 <span data-ttu-id="e8033-130">Para obter mais informações sobre a configuração e alteração de senha para acesso a instantâneos via FTP, consulte a seção "Entrega de instantâneo por FTP" neste tópico [Secure the Publisher](secure-the-publisher.md).</span><span class="sxs-lookup"><span data-stu-id="e8033-130">For information about setting and changing the password for access to snapshots through FTP, see the section "FTP Snapshot Delivery" in the topic [Secure the Publisher](secure-the-publisher.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e8033-131">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="e8033-131">See Also</span></span>  
 <span data-ttu-id="e8033-132">[Locais de pastas de instantâneos alternativos](../alternate-snapshot-folder-locations.md) </span><span class="sxs-lookup"><span data-stu-id="e8033-132">[Alternate Snapshot Folder Locations](../alternate-snapshot-folder-locations.md) </span></span>  
 <span data-ttu-id="e8033-133">[Inicializar uma assinatura com um instantâneo](../initialize-a-subscription-with-a-snapshot.md) </span><span class="sxs-lookup"><span data-stu-id="e8033-133">[Initialize a Subscription with a Snapshot](../initialize-a-subscription-with-a-snapshot.md) </span></span>  
 <span data-ttu-id="e8033-134">[Replication Security Best Practices](replication-security-best-practices.md) </span><span class="sxs-lookup"><span data-stu-id="e8033-134">[Replication Security Best Practices](replication-security-best-practices.md) </span></span>  
 <span data-ttu-id="e8033-135">[Segurança de Replicação do SQL Server](view-and-modify-replication-security-settings.md) </span><span class="sxs-lookup"><span data-stu-id="e8033-135">[SQL Server Replication Security](view-and-modify-replication-security-settings.md) </span></span>  
 [<span data-ttu-id="e8033-136">Transferir instantâneos pelo FTP</span><span class="sxs-lookup"><span data-stu-id="e8033-136">Transfer Snapshots Through FTP</span></span>](../transfer-snapshots-through-ftp.md)  
  
  
