---
title: Configurar Topologia (replicação ponto a ponto) | Microsoft Docs
ms.custom: ''
ms.date: 03/08/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
f1_keywords:
- sql12.rep.p2pwizard.peers.f1
ms.assetid: 5377c59f-2e25-4852-a306-c87ae3dca9fd
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 2dfc09f5ae7f488afd46f29c301d11b7687e0a4b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87569383"
---
# <a name="configure-topology-peer-to-peer-replication"></a><span data-ttu-id="8d694-102">Configurar Topologia (replicação ponto a ponto)</span><span class="sxs-lookup"><span data-stu-id="8d694-102">Configure Topology (Peer-to-Peer Replication)</span></span>
  <span data-ttu-id="8d694-103">Use a página **Configurar Topologia** para executar tarefas de configuração comuns, como adicionar novos nós, excluir nós e adicionar novas conexões entre nós existentes.</span><span class="sxs-lookup"><span data-stu-id="8d694-103">Use the **Configure topology** page to perform common configuration tasks, such as adding new nodes, deleting nodes, and adding new connections between existing nodes.</span></span> <span data-ttu-id="8d694-104">O nó selecionado na página **Publicação** desse assistente é exibido na superfície de design.</span><span class="sxs-lookup"><span data-stu-id="8d694-104">The node you selected on the **Publication** page of this wizard is displayed on the design surface.</span></span> <span data-ttu-id="8d694-105">Para especificar opções de configuração, clique com o botão direito do mouse em um nó, em uma conexão ou na superfície de design.</span><span class="sxs-lookup"><span data-stu-id="8d694-105">To specify configuration options, right-click a node, a connection, or the design surface.</span></span>

> [!NOTE]
>  <span data-ttu-id="8d694-106">O Assistente para Configurar Topologia Ponto a Ponto solicita as informações da topologia quando o assistente é fechado.</span><span class="sxs-lookup"><span data-stu-id="8d694-106">The Configure Peer to Peer Topology Wizard requests topology information when the wizard is closed.</span></span> <span data-ttu-id="8d694-107">Se o assistente for fechado e reaberto antes de todos os nós responderem à solicitação de informações, o assistente poderá mostrar uma rede parcial.</span><span class="sxs-lookup"><span data-stu-id="8d694-107">If the wizard is closed and reopened before all nodes respond to the request for information, the wizard might show a partial network.</span></span>

## <a name="options"></a><span data-ttu-id="8d694-108">Opções</span><span class="sxs-lookup"><span data-stu-id="8d694-108">Options</span></span>
 <span data-ttu-id="8d694-109">A página **Configurar topologia** contém elementos de interface e opções disponíveis ao clicar com o botão direito do mouse em um elemento.</span><span class="sxs-lookup"><span data-stu-id="8d694-109">The **Configure topology** page contains interface elements and options that are available when you right-click an element.</span></span> <span data-ttu-id="8d694-110">A tabela a seguir descreve cada elemento de interface.</span><span class="sxs-lookup"><span data-stu-id="8d694-110">The following table describes each interface element.</span></span>

|<span data-ttu-id="8d694-111">Elemento de interface</span><span class="sxs-lookup"><span data-stu-id="8d694-111">Interface Element</span></span>|<span data-ttu-id="8d694-112">DESCRIÇÃO</span><span class="sxs-lookup"><span data-stu-id="8d694-112">Description</span></span>|
|-----------------------|-----------------|
|<span data-ttu-id="8d694-113">Superfície de design</span><span class="sxs-lookup"><span data-stu-id="8d694-113">Design surface</span></span>|<span data-ttu-id="8d694-114">Exibe outros elementos de interface.</span><span class="sxs-lookup"><span data-stu-id="8d694-114">Displays other interface elements.</span></span> <span data-ttu-id="8d694-115">Para adicionar elementos, clique com o botão direito do mouse na superfície de design.</span><span class="sxs-lookup"><span data-stu-id="8d694-115">To add elements, right-click the design surface.</span></span>|
|<span data-ttu-id="8d694-116">![O primeiro nó em uma topologia](media/p2pwizard-firstnode.gif "O primeiro nó em uma topologia")</span><span class="sxs-lookup"><span data-stu-id="8d694-116">![The first node in a topology](media/p2pwizard-firstnode.gif "The first node in a topology")</span></span>|<span data-ttu-id="8d694-117">O nó original na topologia.</span><span class="sxs-lookup"><span data-stu-id="8d694-117">The original node in the topology.</span></span> <span data-ttu-id="8d694-118">Novos nós são iniciados usando uma cópia do banco de dados de publicação do nó original.</span><span class="sxs-lookup"><span data-stu-id="8d694-118">New nodes are initialized by using a copy of the publication database from the original node.</span></span>|
|<span data-ttu-id="8d694-119">![Um nó para o qual temos informações completas](media/p2pwizard-complete.gif "Um nó para o qual temos informações completas") ou uma versão posterior, para a qual a replicação tem informações completas.</span><span class="sxs-lookup"><span data-stu-id="8d694-119">![A node for which we have complete information](media/p2pwizard-complete.gif "A node for which we have complete information") or a later version, for which replication has complete information.</span></span> <span data-ttu-id="8d694-120">Para especificar opções de configuração, clique com o botão direito do mouse no nó.</span><span class="sxs-lookup"><span data-stu-id="8d694-120">To specify configuration options, right-click the node.</span></span>|
|<span data-ttu-id="8d694-121">![Um nó para o qual temos informações incompletas](media/p2pwizard-incomplete.gif "Um nó para o qual temos informações incompletas")</span><span class="sxs-lookup"><span data-stu-id="8d694-121">![A node for which we have incomplete information](media/p2pwizard-incomplete.gif "A node for which we have incomplete information")</span></span>|<span data-ttu-id="8d694-122">Um nó para o qual a replicação tem informações incompletas.</span><span class="sxs-lookup"><span data-stu-id="8d694-122">A node for which replication has incomplete information.</span></span> <span data-ttu-id="8d694-123">Para especificar opções de configuração, clique com o botão direito do mouse no nó.</span><span class="sxs-lookup"><span data-stu-id="8d694-123">To specify configuration options, right-click the node.</span></span> <span data-ttu-id="8d694-124">A replicação tem informações incompletas por um dos seguintes motivos:</span><span class="sxs-lookup"><span data-stu-id="8d694-124">Replication has incomplete information because of one of the following reasons:</span></span><br /><br /> <span data-ttu-id="8d694-125">O nó está executando uma instância do [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] que não armazena todos os metadados exigidos pelo assistente.</span><span class="sxs-lookup"><span data-stu-id="8d694-125">The node is running an instance of [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)], which does not store all the metadata required by the wizard.</span></span><br /><br /> <span data-ttu-id="8d694-126">O nó está executando uma versão posterior do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], mas a replicação não consegue recuperar informações de assinatura do nó.</span><span class="sxs-lookup"><span data-stu-id="8d694-126">The node is running a later version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], but replication cannot retrieve subscription information from the node.</span></span> <span data-ttu-id="8d694-127">Para solucionar essa situação:</span><span class="sxs-lookup"><span data-stu-id="8d694-127">To troubleshoot this situation:</span></span><br /><span data-ttu-id="8d694-128">-Verifique se o banco de dados no nó está online e se você pode se conectar a ele usando as mesmas credenciais que os agentes de distribuição que se conectam ao nó.</span><span class="sxs-lookup"><span data-stu-id="8d694-128">-Make sure that the database at the node is online and that you can connect to it by using the same credentials as the Distribution Agents that connect to the node.</span></span><br /><span data-ttu-id="8d694-129">-Verifique se o Agente de Leitor de Log e todos os agentes de distribuição que se conectam ao nó estão em execução.</span><span class="sxs-lookup"><span data-stu-id="8d694-129">-Make sure that the Log Reader Agent and all Distribution Agents that connect to the node are running.</span></span><br /><span data-ttu-id="8d694-130">-Verifique se o tempo limite de atualização está definido como alto o suficiente para coletar todas as informações de topologia.</span><span class="sxs-lookup"><span data-stu-id="8d694-130">-Make sure that the refresh timeout is set high enough to gather all topology information.</span></span> <span data-ttu-id="8d694-131">Para definir o tempo limite, clique com o botão direito do mouse na superfície de design e clique em **Selecionar Tempo Limite de Atualização**.</span><span class="sxs-lookup"><span data-stu-id="8d694-131">To set the time-out, right-click the design surface, and click **Set Refresh Timeout**.</span></span>|
|<span data-ttu-id="8d694-132">Linhas cinza com setas</span><span class="sxs-lookup"><span data-stu-id="8d694-132">Gray line with arrows</span></span>|<span data-ttu-id="8d694-133">Conexão entre dois nós.</span><span class="sxs-lookup"><span data-stu-id="8d694-133">The connection between two nodes.</span></span> <span data-ttu-id="8d694-134">Para adicionar uma conexão, clique com o botão direito do mouse em um dos nós que você quer conectar.</span><span class="sxs-lookup"><span data-stu-id="8d694-134">To add a connection, right-click one of the nodes that you want to connect.</span></span> <span data-ttu-id="8d694-135">Para remover uma conexão, clique com o botão direito do mouse na conexão.</span><span class="sxs-lookup"><span data-stu-id="8d694-135">To remove a connection, right-click the connection.</span></span><br /><br /> <span data-ttu-id="8d694-136">Se a linha tiver uma única seta, a replicação terá informações incompletas para um dos nós.</span><span class="sxs-lookup"><span data-stu-id="8d694-136">If the line has a single arrow, replication has incomplete information for one of the nodes.</span></span>|

### <a name="options-for-the-design-surface"></a><span data-ttu-id="8d694-137">Opções para a superfície de design</span><span class="sxs-lookup"><span data-stu-id="8d694-137">Options for the Design Surface</span></span>
 <span data-ttu-id="8d694-138">**Redesenhar grafo** Redesenhe os objetos na superfície de design sem Atualizar a topologia.</span><span class="sxs-lookup"><span data-stu-id="8d694-138">**Redraw Graph** Redraw the objects on the design surface without refreshing the topology.</span></span> <span data-ttu-id="8d694-139">O novo desenho deverá fornecer uma exibição melhor da topologia.</span><span class="sxs-lookup"><span data-stu-id="8d694-139">Redrawing might provide a better view of the topology.</span></span>

 <span data-ttu-id="8d694-140">**Atualizar topologia** Consulte cada nó na topologia e exiba informações atualizadas sobre cada nó.</span><span class="sxs-lookup"><span data-stu-id="8d694-140">**Refresh Topology** Query each node in the topology, and display updated information about each node.</span></span> <span data-ttu-id="8d694-141">Se houver muitos nós, esse processo pode levar vários minutos.</span><span class="sxs-lookup"><span data-stu-id="8d694-141">With many nodes, this process can take several minutes.</span></span>

 <span data-ttu-id="8d694-142">Se o assistente solicitar informações de topologia, e, você fechar e reabrir o assistente, antes que todos os nós respondam à solicitação, essa página poderá não exibir todos os nós na topologia.</span><span class="sxs-lookup"><span data-stu-id="8d694-142">If the wizard requests topology information, and then you close and reopen the wizard before all nodes respond to the request, this page might not display all nodes in the topology.</span></span>

 <span data-ttu-id="8d694-143">**Adicionar um novo nó par** Adicione uma instância do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] à topologia ponto a ponto.</span><span class="sxs-lookup"><span data-stu-id="8d694-143">**Add a New Peer Node** Add an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to the peer-to-peer topology.</span></span> <span data-ttu-id="8d694-144">A adição de uma instância, como um nó, cria uma publicação nessa instância depois que o assistente é concluído.</span><span class="sxs-lookup"><span data-stu-id="8d694-144">Adding an instance as a node creates a publication at that instance after the wizard completes.</span></span> <span data-ttu-id="8d694-145">Depois de adicionar o nó, clique com o botão direito do mouse, para adicionar uma conexão entre o nó novo e um nó existente.</span><span class="sxs-lookup"><span data-stu-id="8d694-145">After you add the node, right-click it to add a connection between the new node and an existing node.</span></span>

 <span data-ttu-id="8d694-146">Para participar de uma topologia ponto a ponto, a instância deve satisfazer os seguintes requisitos:</span><span class="sxs-lookup"><span data-stu-id="8d694-146">To participate in a peer-to-peer topology, the instance must meet the following requirements:</span></span>

-   <span data-ttu-id="8d694-147">Deverá estar configurada como um Distribuidor ou associada a um Distribuidor remoto.</span><span class="sxs-lookup"><span data-stu-id="8d694-147">It must already be configured as a Distributor or be associated with a remote Distributor.</span></span>

-   <span data-ttu-id="8d694-148">Deve conter uma cópia do banco de dados envolvido na replicação.</span><span class="sxs-lookup"><span data-stu-id="8d694-148">It must contain a copy of the database involved in replication.</span></span> <span data-ttu-id="8d694-149">Essa cópia é normalmente um backup restaurado do banco de dados de publicação original.</span><span class="sxs-lookup"><span data-stu-id="8d694-149">This copy is typically a restored backup of the original publication database.</span></span>

 <span data-ttu-id="8d694-150">**Selecionar nó (s) para exibição** Selecione os nós a serem exibidos na superfície de design.</span><span class="sxs-lookup"><span data-stu-id="8d694-150">**Select Node(s) to View** Select which nodes to view on the design surface.</span></span> <span data-ttu-id="8d694-151">Essa opção será útil se a topologia tiver um grande número de nós.</span><span class="sxs-lookup"><span data-stu-id="8d694-151">This option is useful if the topology has a large number of nodes.</span></span> <span data-ttu-id="8d694-152">Observe que você só poderá adicionar conexões entre nós visíveis na superfície de design.</span><span class="sxs-lookup"><span data-stu-id="8d694-152">Be aware that you can add connections only between nodes that are visible on the design surface.</span></span>

 <span data-ttu-id="8d694-153">**Definir tempo limite de atualização** Especifique por quanto tempo o processo de atualização pode ser executado antes que a operação expire.</span><span class="sxs-lookup"><span data-stu-id="8d694-153">**Set Refresh Timeout** Specify how long the refresh process can run before the operation times out.</span></span>

### <a name="options-for-each-node"></a><span data-ttu-id="8d694-154">Opções para cada nó</span><span class="sxs-lookup"><span data-stu-id="8d694-154">Options for Each Node</span></span>
 <span data-ttu-id="8d694-155">**Adicionar uma nova conexão de mesmo nível** Adicione uma conexão entre dois nós.</span><span class="sxs-lookup"><span data-stu-id="8d694-155">**Add a New Peer Connection** Add a connection between two nodes.</span></span> <span data-ttu-id="8d694-156">Por exemplo, se você adicionar uma conexão entre o Nó A e o Nó B, a replicação adicionará duas assinaturas: a primeira habilitará o Nó A a receber alterações de publicação no Nó B e a segunda habilitará o Nó B a receber alterações de publicação no Nó A.</span><span class="sxs-lookup"><span data-stu-id="8d694-156">For example, if you add a connection between Node A and Node B, replication adds two subscriptions: The first enables Node A to receive changes from the publication at Node B, and the second enables Node B to receive changes from the publication at Node A.</span></span>

 <span data-ttu-id="8d694-157">**Excluir nó par** Remove um nó da topologia.</span><span class="sxs-lookup"><span data-stu-id="8d694-157">**Delete Peer Node** Removes a node from the topology.</span></span> <span data-ttu-id="8d694-158">Por exemplo, se você remover Nó C, a publicação desse nó será removida.</span><span class="sxs-lookup"><span data-stu-id="8d694-158">For example, if you remove Node C, the publication at that node is removed.</span></span> <span data-ttu-id="8d694-159">As assinaturas entre Nó A e Nó C, Nó B e Nó C também serão removidas.</span><span class="sxs-lookup"><span data-stu-id="8d694-159">Subscriptions between Node A and Node C, and Node B and Node C are also removed.</span></span> <span data-ttu-id="8d694-160">O banco de dados no Nó C não é excluído, e, a publicação e a distribuição não são desabilitadas.</span><span class="sxs-lookup"><span data-stu-id="8d694-160">The database at Node C is not deleted, and publishing and distribution are not disabled.</span></span>

> [!NOTE]
>  <span data-ttu-id="8d694-161">Quando você configurar replicação ponto a ponto, especifique uma ID para cada nó.</span><span class="sxs-lookup"><span data-stu-id="8d694-161">When you configure peer-to-peer replication, you specify an ID for each node.</span></span> <span data-ttu-id="8d694-162">Esta ID, que deve ser exclusiva em todos os nós na topologia, é armazenada na coluna originator_id na tabela do sistema [MSpeer_originatorid_history](/sql/relational-databases/system-tables/mspeer-originatorid-history-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="8d694-162">This ID, which must be unique across all nodes in the topology, is stored in the originator_id column in the [MSpeer_originatorid_history](/sql/relational-databases/system-tables/mspeer-originatorid-history-transact-sql) system table.</span></span> <span data-ttu-id="8d694-163">Se um nó for removido da topologia, a ID ainda será mantida na tabela de histórico.</span><span class="sxs-lookup"><span data-stu-id="8d694-163">If a node is removed from the topology, the ID is still retained in the history table.</span></span> <span data-ttu-id="8d694-164">A ID é mantida para impedir a ocorrência de falsos conflitos caso sejam feitas alterações do nó removido que ainda sejam replicadas na topologia.</span><span class="sxs-lookup"><span data-stu-id="8d694-164">The ID is retained to prevent false conflicts from occurring if there are changes from the removed node that are still being replicated across the topology.</span></span> <span data-ttu-id="8d694-165">Se você quiser reutilizar a ID para um novo nó, primeiro exclua manualmente a ID da tabela MSpeer_originatorid_history em todos os nós.</span><span class="sxs-lookup"><span data-stu-id="8d694-165">If you want to reuse the ID for a new node, you must first manually delete the ID from the MSpeer_originatorid_history table at all nodes.</span></span> <span data-ttu-id="8d694-166">Antes de excluir uma ID de um nó, execute [sp_requestpeerresponse](/sql/relational-databases/system-stored-procedures/sp-requestpeerresponse-transact-sql) para verificar se todas as alterações originadas desse nó foram replicadas.</span><span class="sxs-lookup"><span data-stu-id="8d694-166">Before you delete an ID for a node, execute [sp_requestpeerresponse](/sql/relational-databases/system-stored-procedures/sp-requestpeerresponse-transact-sql) to verify that all changes that originated from that node have been replicated.</span></span>

 <span data-ttu-id="8d694-167">**Conectar-se a todos os nós exibidos** Adiciona conexões entre o nó selecionado e todos os outros nós.</span><span class="sxs-lookup"><span data-stu-id="8d694-167">**Connect to ALL Displayed Nodes** Adds connections between the selected node and all other nodes.</span></span> <span data-ttu-id="8d694-168">Por exemplo, se você selecionou essa opção para o Nó C em uma topologia de nós de árvore, a replicação adicionará quatro assinaturas: duas para habilitar o Nó A e Nó B a receber alterações da publicação no Nó C, e, duas para habilitar o Nó C a receber alterações de publicações no Nó A e Nó B.</span><span class="sxs-lookup"><span data-stu-id="8d694-168">For example, if you selected this option for Node C in a three node topology, replication adds four subscriptions: two that enable Node A and Node B to receive changes from the publication at Node C, and two that enable Node C to receive changes from the publications at Node A and Node B.</span></span>

 <span data-ttu-id="8d694-169">**Selecionar nó (s) para exibição** Selecione os nós a serem exibidos na superfície de design.</span><span class="sxs-lookup"><span data-stu-id="8d694-169">**Select Node(s) to View** Select which nodes to view on the design surface.</span></span> <span data-ttu-id="8d694-170">Essa opção será útil se a topologia tiver um grande número de nós.</span><span class="sxs-lookup"><span data-stu-id="8d694-170">This option is useful if the topology has a large number of nodes.</span></span> <span data-ttu-id="8d694-171">Observe que você só poderá adicionar conexões entre nós visíveis na superfície de design.</span><span class="sxs-lookup"><span data-stu-id="8d694-171">Be aware that you can add connections only between nodes that are visible on the design surface.</span></span>

### <a name="options-for-the-connection-arrows"></a><span data-ttu-id="8d694-172">Opções para as setas de conexão</span><span class="sxs-lookup"><span data-stu-id="8d694-172">Options for the Connection Arrows</span></span>
 <span data-ttu-id="8d694-173">**Remover conexão de mesmo nível** Remova uma conexão entre dois nós.</span><span class="sxs-lookup"><span data-stu-id="8d694-173">**Remove Peer Connection** Remove a connection between two nodes.</span></span> <span data-ttu-id="8d694-174">Por exemplo, se você remover uma conexão entre o Nó A e o Nó B, a replicação descartará duas assinaturas: a que habilita o Nó A a receber alterações de publicação no Nó B e a que habilita o Nó B a receber alterações de publicação no Nó A.</span><span class="sxs-lookup"><span data-stu-id="8d694-174">For example, if you remove a connection between Node A and Node B, replication drops two subscriptions: the one that enables Node A to receive changes from the publication at Node B, and the one that enables Node B to receive changes from the publication at Node A.</span></span>

## <a name="see-also"></a><span data-ttu-id="8d694-175">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="8d694-175">See Also</span></span>
 <span data-ttu-id="8d694-176">[Configurar a publicação e a distribuição](configure-publishing-and-distribution.md) [administrar uma topologia ponto a ponto &#40;Programação Transact-SQL de replicação&#41;](administration/administer-a-peer-to-peer-topology-replication-transact-sql-programming.md) [replicação transacional ponto a ponto](transactional/peer-to-peer-transactional-replication.md)</span><span class="sxs-lookup"><span data-stu-id="8d694-176">[Configure Publishing and Distribution](configure-publishing-and-distribution.md) [Administer a Peer-to-Peer Topology &#40;Replication Transact-SQL Programming&#41;](administration/administer-a-peer-to-peer-topology-replication-transact-sql-programming.md) [Peer-to-Peer Transactional Replication](transactional/peer-to-peer-transactional-replication.md)</span></span>


