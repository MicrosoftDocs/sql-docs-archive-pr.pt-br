---
title: Implementar um resolvedor de conflitos personalizado para um artigo de mesclagem | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
dev_langs:
- TSQL
helpviewer_keywords:
- merge replication conflict resolution [SQL Server replication], stored procedure-based resolvers
- articles [SQL Server replication], conflict resolution
- conflict resolution [SQL Server replication], merge replication
ms.assetid: 76bd8524-ebc1-4d80-b5a2-4169944d6ac0
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 23e684213114f3c9bb2f1ad56de06fcfc89b819a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87569887"
---
# <a name="implement-a-custom-conflict-resolver-for-a-merge-article"></a><span data-ttu-id="c5f79-102">Implementar o resolvedor de conflitos personalizado para um artigo de mesclagem</span><span class="sxs-lookup"><span data-stu-id="c5f79-102">Implement a Custom Conflict Resolver for a Merge Article</span></span>
  <span data-ttu-id="c5f79-103"> Este tópico descreve como implementar um resolvedor de conflitos personalizado para um artigo de mesclagem no [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] usando o [!INCLUDE[tsql](../../includes/tsql-md.md)] ou um [resolvedor personalizado com base em COM](merge/advanced-merge-replication-conflict-com-based-custom-resolvers.md).</span><span class="sxs-lookup"><span data-stu-id="c5f79-103">This topic describes how to implement custom conflict resolver for a merge article in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] by using [!INCLUDE[tsql](../../includes/tsql-md.md)] or a [COM-based custom resolver](merge/advanced-merge-replication-conflict-com-based-custom-resolvers.md).</span></span>  
  
 <span data-ttu-id="c5f79-104">**Neste tópico**</span><span class="sxs-lookup"><span data-stu-id="c5f79-104">**In This Topic**</span></span>  
  
-   <span data-ttu-id="c5f79-105">**Para implementar o resolvedor de conflitos personalizado para um artigo de mesclagem, usando:**</span><span class="sxs-lookup"><span data-stu-id="c5f79-105">**To implement custom conflict resolver for a merge article, using:**</span></span>  
  
     [<span data-ttu-id="c5f79-106">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="c5f79-106">Transact-SQL</span></span>](#TsqlProcedure)  
  
     [<span data-ttu-id="c5f79-107">Resolvedor baseado em COM</span><span class="sxs-lookup"><span data-stu-id="c5f79-107">COM-based Resolver</span></span>](#COM)  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="c5f79-108">Usando o Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="c5f79-108">Using Transact-SQL</span></span>  
 <span data-ttu-id="c5f79-109">Você pode gravar seu próprio resolvedor de conflito personalizado como um procedimento armazenado [!INCLUDE[tsql](../../includes/tsql-md.md)] em cada Publicador.</span><span class="sxs-lookup"><span data-stu-id="c5f79-109">You can write your own custom conflict resolver as a [!INCLUDE[tsql](../../includes/tsql-md.md)] stored procedure at each Publisher.</span></span> <span data-ttu-id="c5f79-110">Durante a sincronização, esse procedimento armazenado será invocado quando forem encontrados conflitos em um artigo para o qual o resolvedor foi registrado, e a informação na linha em conflito é passada pelo Merge Agent para os parâmetros requeridos do procedimento.</span><span class="sxs-lookup"><span data-stu-id="c5f79-110">During synchronization, this stored procedure is invoked when conflicts are encountered in an article to which the resolver was registered, and information on the conflict row is passed by the Merge Agent to the required parameters of the procedure.</span></span> <span data-ttu-id="c5f79-111">Resolvedores de conflito personalizados com base em procedimento armazenado sempre são criados no Publicador.</span><span class="sxs-lookup"><span data-stu-id="c5f79-111">Stored procedure-based custom conflict resolvers are always created at the Publisher.</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[msCoName](../../includes/msconame-md.md)]<span data-ttu-id="c5f79-112">os [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] resolvedores de procedimento armazenado são invocados apenas para lidar com conflitos baseados em alteração de linha.</span><span class="sxs-lookup"><span data-stu-id="c5f79-112">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] stored procedure resolvers are only invoked to handle row change-based conflicts.</span></span> <span data-ttu-id="c5f79-113">Eles não podem ser usados para tratar de outros tipos de conflitos como falhas de inserção devido a violações de PRIMARY KEY ou violações de restrições de índice exclusivo.</span><span class="sxs-lookup"><span data-stu-id="c5f79-113">They cannot be used to handle other types of conflicts such as insert failures due to PRIMARY KEY violations or unique index constraint violations.</span></span>  
  
#### <a name="to-create-a-stored-procedure-based-custom-conflict-resolver"></a><span data-ttu-id="c5f79-114">Para criar um resolvedor de conflitos personalizado com base em procedimentos armazenados</span><span class="sxs-lookup"><span data-stu-id="c5f79-114">To create a stored procedure-based custom conflict resolver</span></span>  
  
1.  <span data-ttu-id="c5f79-115">No Publicador em cada publicação ou banco de dados **msdb** , crie um novo procedimento armazenado de sistema que implementa os seguintes parâmetros requeridos:</span><span class="sxs-lookup"><span data-stu-id="c5f79-115">At the Publisher in either the publication or **msdb** database, create a new system stored procedure that implements the following required parameters:</span></span>  
  
    |<span data-ttu-id="c5f79-116">Parâmetro</span><span class="sxs-lookup"><span data-stu-id="c5f79-116">Parameter</span></span>|<span data-ttu-id="c5f79-117">Tipo de dados</span><span class="sxs-lookup"><span data-stu-id="c5f79-117">Data type</span></span>|<span data-ttu-id="c5f79-118">Descrição</span><span class="sxs-lookup"><span data-stu-id="c5f79-118">Description</span></span>|  
    |---------------|---------------|-----------------|  
    |**@tableowner**|`sysname`|<span data-ttu-id="c5f79-119">Nome do proprietário da tabela para a qual um conflito está estando resolvido.</span><span class="sxs-lookup"><span data-stu-id="c5f79-119">Name of the owner of the table for which a conflict is being resolved.</span></span> <span data-ttu-id="c5f79-120">Esse é o proprietário para a tabela no banco de dados de publicação.</span><span class="sxs-lookup"><span data-stu-id="c5f79-120">This is the owner for the table in the publication database.</span></span>|  
    |**@tablename**|`sysname`|<span data-ttu-id="c5f79-121">Nome da tabela para a qual um conflito está estando resolvido.</span><span class="sxs-lookup"><span data-stu-id="c5f79-121">Name of the table for which a conflict is being resolved.</span></span>|  
    |**@rowguid**|`uniqueidentifier`|<span data-ttu-id="c5f79-122">Identificador exclusivo para a linha que tem o conflito.</span><span class="sxs-lookup"><span data-stu-id="c5f79-122">Unique identifier for the row having the conflict.</span></span>|  
    |**@subscriber**|`sysname`|<span data-ttu-id="c5f79-123">Nome do servidor de onde uma alteração conflitante está sendo propagada.</span><span class="sxs-lookup"><span data-stu-id="c5f79-123">Name of the server from where a conflicting change is being propagated.</span></span>|  
    |**@subscriber_db**|`sysname`|<span data-ttu-id="c5f79-124">Nome do banco de dados de onde uma alteração conflitante está sendo propagada.</span><span class="sxs-lookup"><span data-stu-id="c5f79-124">Name of the database from where conflicting change is being propagated.</span></span>|  
    |<span data-ttu-id="c5f79-125">**@log_conflictDER**</span><span class="sxs-lookup"><span data-stu-id="c5f79-125">**@log_conflict OUTPUT**</span></span>|`int`|<span data-ttu-id="c5f79-126">Se o processo de mesclagem deveria registrar um conflito para resolução posterior:</span><span class="sxs-lookup"><span data-stu-id="c5f79-126">Whether the merge process should log a conflict for later resolution:</span></span><br /><br /> <span data-ttu-id="c5f79-127">**0** = Não registre o conflito.</span><span class="sxs-lookup"><span data-stu-id="c5f79-127">**0** = Do not log the conflict.</span></span><br /><br /> <span data-ttu-id="c5f79-128">**1** = O Assinante é o perdedor de conflito.</span><span class="sxs-lookup"><span data-stu-id="c5f79-128">**1** = Subscriber is the conflict loser.</span></span><br /><br /> <span data-ttu-id="c5f79-129">**2** = O Publicador é o perdedor de conflito.</span><span class="sxs-lookup"><span data-stu-id="c5f79-129">**2** = Publisher is the conflict loser.</span></span>|  
    |<span data-ttu-id="c5f79-130">**@conflict_messageDER**</span><span class="sxs-lookup"><span data-stu-id="c5f79-130">**@conflict_message OUTPUT**</span></span>|`nvarchar(512)`|<span data-ttu-id="c5f79-131">Mensagem a ser dada sobre a resolução se o conflito for registrado.</span><span class="sxs-lookup"><span data-stu-id="c5f79-131">Message to be given about the resolution if the conflict is logged.</span></span>|  
    |**@destowner**|`sysname`|<span data-ttu-id="c5f79-132">O proprietário da tabela publicada no Assinante.</span><span class="sxs-lookup"><span data-stu-id="c5f79-132">The owner of the published table at the Subscriber.</span></span>|  
  
     <span data-ttu-id="c5f79-133">Esse procedimento armazenado usa os valores passados pelo Merge Agent para esses parâmetros para implementar sua lógica de resolução de conflito personalizada; ele deverá retornar um conjunto de resultados de linha única que é idêntico em estrutura à tabela base e contem os valores de dados para a versão vencedora da linha.</span><span class="sxs-lookup"><span data-stu-id="c5f79-133">This stored procedure uses the values passed by the Merge Agent to these parameters to implement your custom conflict resolution logic; it must return a single row result set that is identical in structure to the base table and contains the data values for the winning version of the row.</span></span>  
  
2.  <span data-ttu-id="c5f79-134">Conceda permissões EXECUTE no procedimento armazenado para qualquer logon usado por Assinantes para conexão com o Publicador.</span><span class="sxs-lookup"><span data-stu-id="c5f79-134">Grant EXECUTE permissions on the stored procedure to any logins used by Subscribers to connect to the Publisher.</span></span>  
  
#### <a name="to-use-a-custom-conflict-resolver-with-a-new-table-article"></a><span data-ttu-id="c5f79-135">Para usar um resolvedor de conflito personalizado com um novo artigo de tabela</span><span class="sxs-lookup"><span data-stu-id="c5f79-135">To use a custom conflict resolver with a new table article</span></span>  
  
1.  <span data-ttu-id="c5f79-136">Execute [sp_addmergearticle](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) para definir um artigo, especificando um valor do **MicrosoftSQL** **resolvedor de procedimentos armazenados do servidor** MicrosoftSQL para o **@article_resolver** parâmetro e o nome do procedimento armazenado que implementa a lógica do resolvedor de conflitos para o **@resolver_info** parâmetro.</span><span class="sxs-lookup"><span data-stu-id="c5f79-136">Execute [sp_addmergearticle](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) to define an article, specifying a value of **MicrosoftSQL** **Server Stored Procedure Resolver** for the **@article_resolver** parameter and the name of the stored procedure that implements the conflict resolver logic for the **@resolver_info** parameter.</span></span> <span data-ttu-id="c5f79-137">Para obter mais informações, consulte [Define an Article](publish/define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="c5f79-137">For more information, see [Define an Article](publish/define-an-article.md).</span></span>  
  
#### <a name="to-use-a-custom-conflict-resolver-with-an-existing-table-article"></a><span data-ttu-id="c5f79-138">Para usar um resolvedor de conflito personalizado com um artigo de tabela existente</span><span class="sxs-lookup"><span data-stu-id="c5f79-138">To use a custom conflict resolver with an existing table article</span></span>  
  
1.  <span data-ttu-id="c5f79-139">Execute [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql), especificando **@publication** , **@article** , um valor de **article_resolver** para **@property** , e um valor de servidor **MicrosoftSQL** **armazenado ProcedureResolver** para **@value** .</span><span class="sxs-lookup"><span data-stu-id="c5f79-139">Execute [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql), specifying **@publication**, **@article**, a value of **article_resolver** for **@property**, and a value of **MicrosoftSQL** **Server Stored ProcedureResolver** for **@value**.</span></span>  
  
2.  <span data-ttu-id="c5f79-140">Execute [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql), especificando **@publication** , **@article** , um valor de **resolver_info** para **@property** , e o nome do procedimento armazenado que implementa a lógica do resolvedor de conflitos para **@value** .</span><span class="sxs-lookup"><span data-stu-id="c5f79-140">Execute [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql), specifying **@publication**, **@article**, a value of **resolver_info** for **@property**, and the name of the stored procedure that implements the conflict resolver logic for **@value**.</span></span>  
  
##  <a name="using-a-com-based-custom-resolver"></a><a name="COM"></a><span data-ttu-id="c5f79-141">Usando um resolvedor personalizado com base em COM</span><span class="sxs-lookup"><span data-stu-id="c5f79-141">Using a COM-based Custom Resolver</span></span>  
 <span data-ttu-id="c5f79-142">O namespace <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport> implementa uma interface, permitindo que você grave lógicas empresariais complexas para manipular eventos e resolva conflitos que ocorram durante o processo de sincronização da replicação de mesclagem.</span><span class="sxs-lookup"><span data-stu-id="c5f79-142">The <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport> namespace implements an interface that enables you to write complex business logic to handle events and resolve conflicts that occur during the merge replication synchronization process.</span></span> <span data-ttu-id="c5f79-143">Para obter mais informações, consulte [Implementar um manipulador de lógica de negócios para um artigo de mesclagem](implement-a-business-logic-handler-for-a-merge-article.md).</span><span class="sxs-lookup"><span data-stu-id="c5f79-143">For more information, see [Implement a Business Logic Handler for a Merge Article](implement-a-business-logic-handler-for-a-merge-article.md).</span></span> <span data-ttu-id="c5f79-144">Você também pode gravar sua própria lógica corporativa personalizada com base em código nativo para resolver conflitos.</span><span class="sxs-lookup"><span data-stu-id="c5f79-144">You can also write your own native code-based custom business logic to resolve conflicts.</span></span> <span data-ttu-id="c5f79-145">Essa lógica é criada como um componente COM e compilada em bibliotecas de vínculo dinâmico (DLL), usando produtos como o [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual C++.</span><span class="sxs-lookup"><span data-stu-id="c5f79-145">This logic is built as a COM component and compiled into dynamic-link libraries (DLL), using products such as [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual C++.</span></span> <span data-ttu-id="c5f79-146">Um resolvedor de conflitos personalizado baseado em COM deve implementar a interface **ICustomResolver** , que é projetada especificamente para resolução de conflitos.</span><span class="sxs-lookup"><span data-stu-id="c5f79-146">Such a COM-based custom conflict resolver must implement the **ICustomResolver** interface, which is designed specifically for conflict resolution.</span></span>  
  
#### <a name="to-create-and-register-a-com-based-custom-conflict-resolver"></a><span data-ttu-id="c5f79-147">Para criar e registrar um resolvedor de conflitos personalizado com base em COM</span><span class="sxs-lookup"><span data-stu-id="c5f79-147">To create and register a COM-based custom conflict resolver</span></span>  
  
1.  <span data-ttu-id="c5f79-148">Em um ambiente de criação compatível com o COM, adicione referências à biblioteca do Resolvedor de Conflitos Personalizado.</span><span class="sxs-lookup"><span data-stu-id="c5f79-148">In a COM-compatible authoring environment, add references to the Custom Conflict Resolver library.</span></span>  
  
2.  <span data-ttu-id="c5f79-149">Para um projeto de Visual C++, use a diretiva #import para importar essa biblioteca para o seu projeto.</span><span class="sxs-lookup"><span data-stu-id="c5f79-149">For a Visual C++ project, use the #import directive to import this library into your project.</span></span>  
  
3.  <span data-ttu-id="c5f79-150">Crie uma classe que implemente a interface **ICustomResolver** .</span><span class="sxs-lookup"><span data-stu-id="c5f79-150">Create a class that implements the **ICustomResolver** interface.</span></span>  
  
4.  <span data-ttu-id="c5f79-151">Implemente certos métodos e propriedades.</span><span class="sxs-lookup"><span data-stu-id="c5f79-151">Implement certain methods and properties.</span></span>  
  
5.  <span data-ttu-id="c5f79-152">Construa o projeto para criar o arquivo da biblioteca do resolvedor de conflitos.</span><span class="sxs-lookup"><span data-stu-id="c5f79-152">Build the project to create the custom conflict resolver library file.</span></span>  
  
6.  <span data-ttu-id="c5f79-153">Implemente a biblioteca no diretório que contém o executável do agente de mesclagem (normalmente \Microsoft SQL Server\100\COM).</span><span class="sxs-lookup"><span data-stu-id="c5f79-153">Deploy the library in the directory containing the merge agent executable (usually \Microsoft SQL Server\100\COM).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="c5f79-154">Um resolvedor de conflitos personalizado deve ser implantado no Assinante para uma assinatura pull, no Distribuidor para uma assinatura push ou no servidor Web usado com a sincronização da Web.</span><span class="sxs-lookup"><span data-stu-id="c5f79-154">A custom conflict resolver must be deployed at the Subscriber for a pull subscription, at the Distributor for a push subscription, or at the Web server used with Web synchronization.</span></span>  
  
7.  <span data-ttu-id="c5f79-155">Registre a biblioteca do resolvedor de conflitos personalizado usando o regsvr32.exe do diretório de implantação como segue:</span><span class="sxs-lookup"><span data-stu-id="c5f79-155">Register the custom conflict resolver library using regsvr32.exe from the deployment directory as follows:</span></span>  
  
    ```  
    regsvr32.exe mycustomresolver.dll  
    ```  
  
8.  <span data-ttu-id="c5f79-156">No Publicador, execute [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) para verificar se a biblioteca já não está registrada como um resolvedor de conflitos personalizado.</span><span class="sxs-lookup"><span data-stu-id="c5f79-156">At the Publisher, execute [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) to verify that the library is not already registered as a custom conflict resolver.</span></span>  
  
9. <span data-ttu-id="c5f79-157">Para registrar a biblioteca como um resolvedor de conflitos personalizado, execute [sp_registercustomresolver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-registercustomresolver-transact-sql), no Distributor.</span><span class="sxs-lookup"><span data-stu-id="c5f79-157">To register the library as a custom conflict resolver, execute [sp_registercustomresolver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-registercustomresolver-transact-sql), at the Distributor.</span></span> <span data-ttu-id="c5f79-158">Especifique o nome amigável do objeto COM para **@article_resolver** , a ID da biblioteca (CLSID) para **@resolver_clsid** e um valor de `false` para **@is_dotnet_assembly** .</span><span class="sxs-lookup"><span data-stu-id="c5f79-158">Specify the friendly name of the COM object for **@article_resolver**, the library's ID (CLSID) for **@resolver_clsid**, and a value of `false` for **@is_dotnet_assembly**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="c5f79-159">Quando não for mais necessário, um resolvedor de conflitos personalizado poderá ter o registrado cancelado, usando [sp_unregistercustomresolver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-unregistercustomresolver-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="c5f79-159">When no longer needed, a custom conflict resolver can be unregistered using [sp_unregistercustomresolver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-unregistercustomresolver-transact-sql).</span></span>  
  
10. <span data-ttu-id="c5f79-160">(Opcional) Em um cluster, repita as etapas de 5 a 8 para registrar o resolvedor personalizado em todos os nós do cluster.</span><span class="sxs-lookup"><span data-stu-id="c5f79-160">(Optional) On a cluster, repeat steps 5-8 to register the custom resolver on all nodes of the cluster.</span></span> <span data-ttu-id="c5f79-161">Isso é necessário para garantir que o resolvedor personalizado esteja apto a carregar adequadamente o reconciliador, seguindo um failover.</span><span class="sxs-lookup"><span data-stu-id="c5f79-161">This is required to ensure that the custom resolver will be able to properly load the reconciler following a failover.</span></span>  
  
#### <a name="to-use-a-custom-conflict-resolver-with-a-new-table-article"></a><span data-ttu-id="c5f79-162">Para usar um resolvedor de conflito personalizado com um novo artigo de tabela</span><span class="sxs-lookup"><span data-stu-id="c5f79-162">To use a custom conflict resolver with a new table article</span></span>  
  
1.  <span data-ttu-id="c5f79-163">No Publicador, execute [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) e observe o nome amigável do resolvedor desejado.</span><span class="sxs-lookup"><span data-stu-id="c5f79-163">At the Publisher, execute [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) and note the friendly name of the desired resolver.</span></span>  
  
2.  <span data-ttu-id="c5f79-164">No Publicador no banco de dados de publicação, execute o [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) para definir um artigo.</span><span class="sxs-lookup"><span data-stu-id="c5f79-164">At the Publisher on the publication database, execute [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) to define an article.</span></span> <span data-ttu-id="c5f79-165">Especifique o nome amigável do resolvedor de artigo da etapa 1 para **@article_resolver** .</span><span class="sxs-lookup"><span data-stu-id="c5f79-165">Specify the friendly name of the article resolver from step 1 for **@article_resolver**.</span></span> <span data-ttu-id="c5f79-166">Para obter mais informações, consulte [Define an Article](publish/define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="c5f79-166">For more information, see [Define an Article](publish/define-an-article.md).</span></span>  
  
#### <a name="to-use-a-custom-conflict-resolver-with-an-existing-table-article"></a><span data-ttu-id="c5f79-167">Para usar um resolvedor de conflito personalizado com um artigo de tabela existente</span><span class="sxs-lookup"><span data-stu-id="c5f79-167">To use a custom conflict resolver with an existing table article</span></span>  
  
1.  <span data-ttu-id="c5f79-168">No Publicador, execute [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) e observe o nome amigável do resolvedor desejado.</span><span class="sxs-lookup"><span data-stu-id="c5f79-168">At the Publisher, execute [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) and note the friendly name of the desired resolver.</span></span>  
  
2.  <span data-ttu-id="c5f79-169">Execute [sp_changemergearticle &#40;&#41;Transact-SQL ](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql), especificando **@publication** , **@article** , um valor de **article_resolver** para **@property** e o nome amigável do resolvedor de artigo da etapa 1 para **@value** .</span><span class="sxs-lookup"><span data-stu-id="c5f79-169">Execute [sp_changemergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql), specifying **@publication**, **@article**, a value of **article_resolver** for **@property**, and the friendly name of the article resolver from step 1 for **@value**.</span></span>  
  
#### <a name="viewing-a-sample-custom-resolver"></a><span data-ttu-id="c5f79-170">Exibindo um resolvedor personalizado de exemplo</span><span class="sxs-lookup"><span data-stu-id="c5f79-170">Viewing a Sample Custom Resolver</span></span>  
  
1.  <span data-ttu-id="c5f79-171">Um exemplo está disponível nos arquivos de exemplo do SQL Server 2000.</span><span class="sxs-lookup"><span data-stu-id="c5f79-171">A sample is available in the SQL Server 2000 sample files.</span></span> <span data-ttu-id="c5f79-172">Baixe o [**sql2000samples.zip**](https://github.com/Microsoft/sql-server-samples/blob/master/samples/tutorials/Miscellaneous/sql2000samples.zip).</span><span class="sxs-lookup"><span data-stu-id="c5f79-172">Download the [**sql2000samples.zip**](https://github.com/Microsoft/sql-server-samples/blob/master/samples/tutorials/Miscellaneous/sql2000samples.zip).</span></span> <span data-ttu-id="c5f79-173">Isso baixa 3 arquivos de valor para 6,9 MB.</span><span class="sxs-lookup"><span data-stu-id="c5f79-173">This downloads 3 files amounting to 6.9 MB.</span></span>  
  
2.  <span data-ttu-id="c5f79-174">Extraia os arquivos do arquivo .cab compactado que foi baixado.</span><span class="sxs-lookup"><span data-stu-id="c5f79-174">Extract the files from downloaded compressed .cab file.</span></span>  
  
3.  <span data-ttu-id="c5f79-175">Executar **setup.exe**</span><span class="sxs-lookup"><span data-stu-id="c5f79-175">Run **setup.exe**</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="c5f79-176">Ao escolher as opções de instalação, é necessário apenas instalar os exemplos de **Replicação** .</span><span class="sxs-lookup"><span data-stu-id="c5f79-176">When choosing the installation options, it is only necessary to install the **Replication** samples.</span></span> <span data-ttu-id="c5f79-177">(O caminho de instalação padrão é **C:\Program Files (x86) \microsoft SQL Server \\ 2000 Samples\1033**)</span><span class="sxs-lookup"><span data-stu-id="c5f79-177">(The default installation path is **C:\Program Files (x86)\Microsoft SQL Server 2000 Samples\1033\\**)</span></span>  
  
4.  <span data-ttu-id="c5f79-178">Vá para a pasta de instalação.</span><span class="sxs-lookup"><span data-stu-id="c5f79-178">Go to installation folder.</span></span> <span data-ttu-id="c5f79-179">(A pasta padrão é **C:\Arquivos de Programas (x86) \Microsoft SQL Server 2000 Samples\1033\sqlrepl\unzip_sqlreplSP3.exe**)</span><span class="sxs-lookup"><span data-stu-id="c5f79-179">(The default folder is **C:\Program Files (x86)\Microsoft SQL Server 2000 Samples\1033\sqlrepl\unzip_sqlreplSP3.exe**)</span></span>  
  
5.  <span data-ttu-id="c5f79-180">Execute o programa **unzip_sqlreplSP3.exe** .</span><span class="sxs-lookup"><span data-stu-id="c5f79-180">Run the **unzip_sqlreplSP3.exe** program.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="c5f79-181">O resolvedor com de exemplo será instalado (por padrão) para a pasta **C:\Arquivos de Programas (x86) \Microsoft SQL Server 2000 Samples\1033\sqlrepl\resolver\subspres** .</span><span class="sxs-lookup"><span data-stu-id="c5f79-181">The sample com resolver will install (by default) to the **C:\Program Files (x86)\Microsoft SQL Server 2000 Samples\1033\sqlrepl\resolver\subspres** folder.</span></span>  
  
6.  <span data-ttu-id="c5f79-182">Na pasta **subspres** , localize todas as ocorrências de **#include sqlres.h** em todos os arquivos de origem e substitua-os por **#import "replrec.dll" no_namespace, raw_interfaces_only**</span><span class="sxs-lookup"><span data-stu-id="c5f79-182">In the **subspres** folder, find all occurrences of **#include sqlres.h** in all of the source files and replace them with **#import "replrec.dll" no_namespace, raw_interfaces_only**</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c5f79-183">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="c5f79-183">See Also</span></span>  
 <span data-ttu-id="c5f79-184">[Detecção e resolução de conflito de replicação de mesclagem avançada](merge/advanced-merge-replication-conflict-detection-and-resolution.md) </span><span class="sxs-lookup"><span data-stu-id="c5f79-184">[Advanced Merge Replication Conflict Detection and Resolution](merge/advanced-merge-replication-conflict-detection-and-resolution.md) </span></span>  
 <span data-ttu-id="c5f79-185">[Resolvedores personalizados baseados em COM](merge/advanced-merge-replication-conflict-com-based-custom-resolvers.md) </span><span class="sxs-lookup"><span data-stu-id="c5f79-185">[COM-Based Custom Resolvers](merge/advanced-merge-replication-conflict-com-based-custom-resolvers.md) </span></span>  
 [<span data-ttu-id="c5f79-186">Replication Security Best Practices</span><span class="sxs-lookup"><span data-stu-id="c5f79-186">Replication Security Best Practices</span></span>](security/replication-security-best-practices.md)  
  
  
