---
title: Inicializar uma assinatura transacional sem um instantâneo | Microsoft Docs
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- transactional replication, initializing
- replication [SQL Server], initializing
- initializing subscriptions [SQL Server replication], without snapshots
ms.assetid: 75c8c1f8-60bc-44a8-944b-d18d1f6bda11
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 88e240b75cdbb239548cfcb8e5d8df5eb2af2973
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87569881"
---
# <a name="initialize-a-transactional-subscription-without-a-snapshot"></a><span data-ttu-id="a3125-102">Inicializar uma assinatura transacional sem um instantâneo</span><span class="sxs-lookup"><span data-stu-id="a3125-102">Initialize a Transactional Subscription Without a Snapshot</span></span>
  <span data-ttu-id="a3125-103">Por padrão, uma assinatura a uma publicação transacional é inicializada com um instantâneo, que é gerado pelo Agente de Instantâneo e aplicado pelo Agente de Distribuição.</span><span class="sxs-lookup"><span data-stu-id="a3125-103">By default, a subscription to a transactional publication is initialized with a snapshot, which is generated by the Snapshot Agent and applied by the Distribution Agent.</span></span> <span data-ttu-id="a3125-104">Em alguns cenários, como os que envolvem grandes conjuntos de dados iniciais, é preferível inicializar uma assinatura usando outro método.</span><span class="sxs-lookup"><span data-stu-id="a3125-104">In some scenarios, such as those involving large initial datasets, it is preferable to initialize a subscription using another method.</span></span> <span data-ttu-id="a3125-105">Outros métodos de inicializar um Assinante incluem:</span><span class="sxs-lookup"><span data-stu-id="a3125-105">Other methods of initializing a Subscriber include:</span></span>  
  
-   <span data-ttu-id="a3125-106">Especificando um backup.</span><span class="sxs-lookup"><span data-stu-id="a3125-106">Specifying a backup.</span></span> <span data-ttu-id="a3125-107">Restaure o backup no Assinante e, então, o Agente de Distribuição copia os metadados de replicação e procedimentos do sistema necessários.</span><span class="sxs-lookup"><span data-stu-id="a3125-107">Restore the backup on the Subscriber, and then the Distribution Agent copies any required replication metadata and system procedures.</span></span> <span data-ttu-id="a3125-108">Inicializando com um backup é a forma mais fácil de entregar os dados ao Assinante e é conveniente, porque qualquer backup recente pode ser usado se for feito após a publicação ter sido habilitada para inicialização com um backup.</span><span class="sxs-lookup"><span data-stu-id="a3125-108">Initializing with a backup is the fastest way to deliver data to the Subscriber and is convenient, because any recent backup can be used if it was taken after the publication was enabled for initialization with a backup.</span></span>  
  
-   <span data-ttu-id="a3125-109">Copiando um conjunto de dados inicial ao Assinante por outro mecanismo, como anexando um banco de dados.</span><span class="sxs-lookup"><span data-stu-id="a3125-109">Copying an initial dataset to the Subscriber through another mechanism, such as attaching a database.</span></span> <span data-ttu-id="a3125-110">Você deve assegurar-se de que os dados e o esquema corretos estão no Assinante e, então, o Agente de Distribuição copia os metadados e procedimentos do sistema necessários.</span><span class="sxs-lookup"><span data-stu-id="a3125-110">You must ensure the correct data and schema are at the Subscriber, and then the Distribution Agent copies any required metadata and system procedures.</span></span>  
  
## <a name="initializing-a-subscription-with-a-backup"></a><span data-ttu-id="a3125-111">Inicializando uma assinatura com um backup</span><span class="sxs-lookup"><span data-stu-id="a3125-111">Initializing a subscription with a backup</span></span>  
 <span data-ttu-id="a3125-112">Um backup contém um banco de dados inteiro; portanto, cada banco de dados de assinatura conterá uma cópia completa do banco de dados de publicação quando este for inicializado:</span><span class="sxs-lookup"><span data-stu-id="a3125-112">A backup contains an entire database; therefore each subscription database will contain a complete copy of the publication database when it is initialized:</span></span>  
  
-   <span data-ttu-id="a3125-113">O backup inclui tabelas que não são especificadas como artigos para a publicação.</span><span class="sxs-lookup"><span data-stu-id="a3125-113">The backup includes tables not specified as articles for the publication.</span></span>  
  
-   <span data-ttu-id="a3125-114">O backup inclui todos os dados, até mesmo se filtros de linha ou de coluna forem especificados em uma tabela.</span><span class="sxs-lookup"><span data-stu-id="a3125-114">The backup includes all data, even if row or column filters are specified on a table.</span></span>  
  
 <span data-ttu-id="a3125-115">É da responsabilidade do administrador ou aplicativo remover quaisquer objetos ou dados não desejados depois que o backup tiver sido restaurado.</span><span class="sxs-lookup"><span data-stu-id="a3125-115">It is the responsibility of the administrator or application to remove any unwanted objects or data after the backup has been restored.</span></span> <span data-ttu-id="a3125-116">Em sincronizações subsequentes, as alterações de dados só serão replicadas se elas se aplicarem às tabelas que são especificadas como artigos e satisfizerem os critérios de filtragem que você especificou.</span><span class="sxs-lookup"><span data-stu-id="a3125-116">In subsequent synchronizations, data changes are only replicated if they apply to tables specified as articles, and the changes meet any filtering criteria you specified.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="a3125-117">Ao restaurar um backup, você deve garantir que o backup é proveniente de um Publicador se desejar que o Assinante sincronize automaticamente.</span><span class="sxs-lookup"><span data-stu-id="a3125-117">When restoring a backup, you must ensure that the backup came from the Publisher if you want the Subscriber to automatically synchronize.</span></span> <span data-ttu-id="a3125-118">Os valores LSN (número de sequência de log) no backup (usados para definir o ponto para iniciar a sincronização) são específicos ao Publicador.</span><span class="sxs-lookup"><span data-stu-id="a3125-118">The log sequence number (LSN) values in the backup (which are used to set the point at which to start synchronizing) are specific to the Publisher.</span></span>  
  
 <span data-ttu-id="a3125-119">**Para inicializar uma assinatura com um backup**</span><span class="sxs-lookup"><span data-stu-id="a3125-119">**To initialize a subscription with a backup**</span></span>  
  
 <span data-ttu-id="a3125-120">Para inicializar uma assinatura com um backup, você deve primeiro habilitar a opção ao criar a publicação e, então, especificar valores para um número de opções quando criar a assinatura.</span><span class="sxs-lookup"><span data-stu-id="a3125-120">To initialize a subscription with a backup, you first must enable the option when you create a publication, and then specify values for a number of options when you create a subscription.</span></span> <span data-ttu-id="a3125-121">As publicações podem ser habilitadas pelo Assistente para Nova Publicação ou programaticamente.</span><span class="sxs-lookup"><span data-stu-id="a3125-121">Publications can be enabled through the New Publication Wizard or programmatically.</span></span> <span data-ttu-id="a3125-122">Porém, os valores requeridos para as opções de assinatura só podem ser especificados programaticamente.</span><span class="sxs-lookup"><span data-stu-id="a3125-122">However, the values required for the subscription options can only be specified programmatically.</span></span>  
  
-   [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]<span data-ttu-id="a3125-123">: [Habilitar a inicialização com um backup para publicações transacionais &#40;SQL Server Management Studio&#41;](enable-initialization-with-backup-for-transactional-publications.md)</span><span class="sxs-lookup"><span data-stu-id="a3125-123">: [Enable Initialization with a Backup for Transactional Publications &#40;SQL Server Management Studio&#41;](enable-initialization-with-backup-for-transactional-publications.md)</span></span>  
  
-   <span data-ttu-id="a3125-124">Programação Transact-SQL de replicação: [Inicializar uma assinatura transacional de um backup &#40;programação Transact-SQL de replicação&#41;](initialize-a-transactional-subscription-from-a-backup.md)</span><span class="sxs-lookup"><span data-stu-id="a3125-124">Replication Transact-SQL programming: [Initialize a Transactional Subscription from a Backup &#40;Replication Transact-SQL Programming&#41;](initialize-a-transactional-subscription-from-a-backup.md)</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="a3125-125">Se uma assinatura for inicializada sem usar um instantâneo, a em que o serviço do SQL Server será executado no Publicador deverá ter permissões para gravação na pasta do instantâneo no Distribuidor.</span><span class="sxs-lookup"><span data-stu-id="a3125-125">If a subscription is initialized without using a snapshot, the account under which the SQL Server service runs at the Publisher must have write permissions on the snapshot folder at the Distributor.</span></span> <span data-ttu-id="a3125-126">Para obter mais informações sobre permissões, consulte [Replication Agent Security Model](security/replication-agent-security-model.md).</span><span class="sxs-lookup"><span data-stu-id="a3125-126">For more information about permissions, see [Replication Agent Security Model](security/replication-agent-security-model.md).</span></span>  
  
### <a name="ensuring-the-suitability-of-a-backup"></a><span data-ttu-id="a3125-127">Assegurando que um backup é adequado</span><span class="sxs-lookup"><span data-stu-id="a3125-127">Ensuring the suitability of a backup</span></span>  
 <span data-ttu-id="a3125-128">Um backup será adequado para inicializar um Assinante se todas as transações que ocorreram, feitas após o backup, estiverem armazenadas no Distribuidor.</span><span class="sxs-lookup"><span data-stu-id="a3125-128">A backup is suitable for initializing a Subscriber if all transactions that occur after the backup was taken are stored at the Distributor.</span></span> <span data-ttu-id="a3125-129">A replicação exibirá uma mensagem de erro se o backup não for adequado.</span><span class="sxs-lookup"><span data-stu-id="a3125-129">Replication will display an error message if the backup is not suitable.</span></span>  
  
 <span data-ttu-id="a3125-130">Para ajudar assegurar que um backup é adequado para uso, siga estas diretrizes:</span><span class="sxs-lookup"><span data-stu-id="a3125-130">To help ensure that a backup is suitable for use, follow these guidelines:</span></span>  
  
-   <span data-ttu-id="a3125-131">Use o último backup disponível, e se esse for mais antigo que o período máximo de retenção máximo da distribuição, crie um novo backup antes de tentar inicializar a assinatura com um backup.</span><span class="sxs-lookup"><span data-stu-id="a3125-131">Use the latest backup available, and if the latest backup is older than the maximum distribution retention period, create a new backup before attempting to initialize a subscription with a backup.</span></span> <span data-ttu-id="a3125-132">Para obter mais informações sobre período de retenção, consulte [Subscription Expiration and Deactivation](subscription-expiration-and-deactivation.md).</span><span class="sxs-lookup"><span data-stu-id="a3125-132">For more information about retention period, see [Subscription Expiration and Deactivation](subscription-expiration-and-deactivation.md).</span></span>  
  
-   <span data-ttu-id="a3125-133">Por padrão, o trabalho de limpeza de distribuição desmarca transações com mais de 72 horas do banco de dados de distribuição.</span><span class="sxs-lookup"><span data-stu-id="a3125-133">By default, the distribution cleanup job clears transactions older than 72 hours from the distribution database.</span></span> <span data-ttu-id="a3125-134">A limpeza é baseada no conjunto de período de retenção para a publicação.</span><span class="sxs-lookup"><span data-stu-id="a3125-134">Cleanup is based on the retention period set for the publication.</span></span> <span data-ttu-id="a3125-135">Ao sincronizar com backups mais antigos, considere desabilitar temporariamente o trabalho antes de fazer o backup que gostaria de restaurar e habilite novamente após a assinatura ter sido criada com êxito.</span><span class="sxs-lookup"><span data-stu-id="a3125-135">When synchronizing with older backups, consider temporarily disabling the job before the backup you would like to restore and re-enabling it after the subscription is successfully created.</span></span> <span data-ttu-id="a3125-136">Isto previne a remoção de transações do banco de dados de distribuição que poderiam ser necessárias para sincronizar do backup com êxito.</span><span class="sxs-lookup"><span data-stu-id="a3125-136">This prevents removal of transactions from the distribution database that might be needed to synchronize successfully from the backup.</span></span> <span data-ttu-id="a3125-137">Para mais informações sobre execução de trabalhos de limpeza, consulte [Executar trabalhos de manutenção de replicação &#40;SQL Server Management Studio&#41;](administration/run-replication-maintenance-jobs-sql-server-management-studio.md).</span><span class="sxs-lookup"><span data-stu-id="a3125-137">For information about running cleanup jobs, see [Run Replication Maintenance Jobs &#40;SQL Server Management Studio&#41;](administration/run-replication-maintenance-jobs-sql-server-management-studio.md).</span></span>  
  
 <span data-ttu-id="a3125-138">Em alguns casos você deverá fazer as personalizações manualmente no banco de dados restaurado no Assinante após definir que as assinaturas serão inicializadas com um backup.</span><span class="sxs-lookup"><span data-stu-id="a3125-138">In some cases you must manually perform customizations in the restored Subscriber database after setting up subscriptions that are initialized with a backup.</span></span> <span data-ttu-id="a3125-139">Em geral, modificações manuais no banco de dados restaurado do Assinante são requeridas se a publicação for definida de tal forma que se espere que o conteúdo do banco de dados do Assinante seja diferente do conteúdo do banco de dados Publicador.</span><span class="sxs-lookup"><span data-stu-id="a3125-139">In general, manual modifications at the restored Subscriber database are required if the Publication is defined in such a way that the Subscriber database content is expected to be different from the Publisher database content.</span></span>  
  
-   <span data-ttu-id="a3125-140">Exibições indexadas ao banco de dados restaurado terão de ser convertidas a tabelas se elas forem publicadas como artigos de exibição indexada para tabela baseados em log</span><span class="sxs-lookup"><span data-stu-id="a3125-140">Indexed-views at the restored database have to be converted to tables if they are published as log-based indexed-view-to-table articles</span></span>  
  
-   <span data-ttu-id="a3125-141">Colunas de carimbo de hora assinadas no banco de dados restaurado devem ser convertidas a colunas **binárias(8)** : copie o conteúdo das tabelas contendo colunas de carimbo de hora para as novas tabelas com esquemas correspondentes a menos que existam colunas **binárias (8)** no lugar de colunas de carimbo de hora, descarte as tabelas originais e renomeie as novas tabelas com os mesmos nomes das tabelas originais.</span><span class="sxs-lookup"><span data-stu-id="a3125-141">Subscribed timestamp columns at the restored database must be converted to **binary(8)** columns: copy the content of the tables containing timestamp columns to new tables with matching schemas except having **binary(8)** columns in place of the timestamp columns, drop the original tables, and rename the new tables with the same names as the original tables.</span></span>  
  
## <a name="initializing-a-subscription-with-an-alternative-method"></a><span data-ttu-id="a3125-142">Inicializando uma assinatura com um método alternativo</span><span class="sxs-lookup"><span data-stu-id="a3125-142">Initializing a subscription with an alternative method</span></span>  
 <span data-ttu-id="a3125-143">É possível inicializar uma assinatura usando qualquer método que permita copiar o esquema do banco de dados de publicação e dados ao Assinante, como [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a3125-143">It is possible to initialize a subscription using any method that allows you to copy the publication database schema and data to the Subscriber, such as [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)].</span></span> <span data-ttu-id="a3125-144">Quando você usar um método alternativo para inicializar o Assinante, objetos de suporte de replicação são copiados ao Assinante.</span><span class="sxs-lookup"><span data-stu-id="a3125-144">When you use an alternative method to initialize the Subscriber, replication support objects are copied to the Subscriber.</span></span>  
  
 <span data-ttu-id="a3125-145">Diferente de inicializar com um backup, você ou seu aplicativo devem assegurar que os dados e o esquema estão sincronizados corretamente na hora que você adicionar a assinatura.</span><span class="sxs-lookup"><span data-stu-id="a3125-145">Unlike initializing with a backup, you or your application must ensure the data and schema are properly synchronized at the time you add the subscription.</span></span> <span data-ttu-id="a3125-146">Por exemplo, se houver atividade no Publicador, durante o tempo em que os dados e o esquema são copiados no Assinante e a Assinatura é adicionada, as alterações resultantes dessa atividade poderão não ser replicadas no Assinante.</span><span class="sxs-lookup"><span data-stu-id="a3125-146">If, for example, there is activity on the Publisher between the time data and schema are copied to the Subscriber and the time at which the subscription is added, changes resulting from this activity might not be replicated to the Subscriber.</span></span>  
  
 <span data-ttu-id="a3125-147">Para inicializar uma assinatura com um método alternativo, consulte [Initialize a Subscription Manually](initialize-a-subscription-manually.md).</span><span class="sxs-lookup"><span data-stu-id="a3125-147">To initialize a subscription with an alternative method, see [Initialize a Subscription Manually](initialize-a-subscription-manually.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a3125-148">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="a3125-148">See Also</span></span>  
 [<span data-ttu-id="a3125-149">Inicializar uma Assinatura</span><span class="sxs-lookup"><span data-stu-id="a3125-149">Initialize a Subscription</span></span>](initialize-a-subscription.md)  
  
  
