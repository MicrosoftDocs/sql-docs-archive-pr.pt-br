---
title: Agrupar alterações a linhas relacionadas com registros lógicos | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- merge replication logical records [SQL Server replication]
- articles [SQL Server replication], logical records
- logical records [SQL Server replication]
ms.assetid: ad76799c-4486-4b98-9705-005433041321
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 433e0edbe83d102e6002bd133f967f27a236f66e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87568505"
---
# <a name="group-changes-to-related-rows-with-logical-records"></a><span data-ttu-id="d5b9e-102">Agrupar alterações a linhas relacionadas com registros lógicos</span><span class="sxs-lookup"><span data-stu-id="d5b9e-102">Group Changes to Related Rows with Logical Records</span></span>
  
> [!NOTE]
>  [!INCLUDE[ssNoteDepFutureAvoid](../../../includes/ssnotedepfutureavoid-md.md)]

 <span data-ttu-id="d5b9e-103">Por padrão, os dados de processos de replicação de mesclagem são alterados em uma base de linha por linha.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-103">By default, merge replication processes data changes on a row-by-row basis.</span></span> <span data-ttu-id="d5b9e-104">Em muitas circunstâncias isto é apropriado, mas para alguns aplicativos, é essencial que as linhas relacionadas sejam processadas como uma unidade.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-104">In many circumstances this is appropriate, but for some applications, it is essential that related rows be processed as a unit.</span></span> <span data-ttu-id="d5b9e-105">O recurso de registro lógico de replicação de mesclagem permite que você defina uma relação entre linhas relacionadas em diferentes tabelas para que as linhas sejam processadas como uma unidade.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-105">The logical records feature of merge replication allows you to define a relationship between related rows in different tables so that the rows are processed as a unit.</span></span>

> [!NOTE]
>  <span data-ttu-id="d5b9e-106">O recurso de registros lógicos pode ser usado só ou junto com filtros de junção.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-106">The logical records feature can be used alone or in conjunction with join filters.</span></span> <span data-ttu-id="d5b9e-107">Para obter mais informações sobre filtros de junção, consulte [Join Filters](join-filters.md).</span><span class="sxs-lookup"><span data-stu-id="d5b9e-107">For more information about join filters, see [Join Filters](join-filters.md).</span></span> <span data-ttu-id="d5b9e-108">Para usar registros lógicos, o nível de compatibilidade da publicação deve ser pelo menos 90RTM.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-108">To use logical records, the compatibility level of the publication must be at least 90RTM.</span></span>

 <span data-ttu-id="d5b9e-109">Considere estas três tabelas relacionadas:</span><span class="sxs-lookup"><span data-stu-id="d5b9e-109">Consider these three related tables:</span></span>

 <span data-ttu-id="d5b9e-110">![Registro lógico de três tabelas, somente com nomes de coluna](../media/logical-records-01.gif "Registro lógico de três tabelas, somente com nomes de coluna")</span><span class="sxs-lookup"><span data-stu-id="d5b9e-110">![Three table logical record, with column names only](../media/logical-records-01.gif "Three table logical record, with column names only")</span></span>

 <span data-ttu-id="d5b9e-111">A tabela **Customers** é a tabela pai nesta relação e tem uma coluna de chave primária **CustID**.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-111">The **Customers** table is the parent table in this relationship and has a primary key column **CustID**.</span></span> <span data-ttu-id="d5b9e-112">A tabela **Orders** tem uma coluna de chave primária **OrderID**, com uma restrição de chave estrangeira na coluna **CustID** que faz referência à coluna **CustID** na tabela **Customers** .</span><span class="sxs-lookup"><span data-stu-id="d5b9e-112">The **Orders** table has a primary key column **OrderID**, with a foreign key constraint on the **CustID** column that references the **CustID** column in the **Customers** table.</span></span> <span data-ttu-id="d5b9e-113">De forma semelhante, a tabela **OrderItems** tem uma coluna de chave primária **OrderItemID**, com uma restrição de chave estrangeira na coluna **OrderID** que faz referência à coluna **OrderID** na tabela **Orders** .</span><span class="sxs-lookup"><span data-stu-id="d5b9e-113">Similarly, the **OrderItems** table has a primary key column **OrderItemID**, with a foreign key constraint on the **OrderID** column that references the **OrderID** column in the **Orders** table.</span></span>

 <span data-ttu-id="d5b9e-114">Neste exemplo, um registro lógico consiste de todas as linhas na tabela **Orders** que são relacionadas a um valor **CustID** único e todas as linhas na tabela **OrderItems** são relacionadas a aquelas linhas na tabela **Orders** .</span><span class="sxs-lookup"><span data-stu-id="d5b9e-114">In this example, a logical record consists of all the rows in the **Orders** table that are related to a single **CustID** value and all of the rows in the **OrderItems** table that are related to those rows in the **Orders** table.</span></span> <span data-ttu-id="d5b9e-115">Este diagrama exibe todas as linhas nas três tabelas que estão no registro lógico para Customer2:</span><span class="sxs-lookup"><span data-stu-id="d5b9e-115">This diagram shows all the rows in the three tables that are in the logical record for Customer2:</span></span>

 <span data-ttu-id="d5b9e-116">![Registro lógico de três tabelas com valores](../media/logical-records-02.gif "Registro lógico de três tabelas com valores")</span><span class="sxs-lookup"><span data-stu-id="d5b9e-116">![Three table logical record with values](../media/logical-records-02.gif "Three table logical record with values")</span></span>

 <span data-ttu-id="d5b9e-117">Definir uma relação de registro lógico entre artigos, consulte [Definir uma relação de registro lógico entre artigos da tabela de mesclagem](../publish/define-a-logical-record-relationship-between-merge-table-articles.md).</span><span class="sxs-lookup"><span data-stu-id="d5b9e-117">To define a logical record relationship between articles, see [Define a Logical Record Relationship Between Merge Table Articles](../publish/define-a-logical-record-relationship-between-merge-table-articles.md).</span></span>

## <a name="benefits-of-logical-records"></a><span data-ttu-id="d5b9e-118">Benefícios de registros lógicos</span><span class="sxs-lookup"><span data-stu-id="d5b9e-118">Benefits of Logical Records</span></span>
 <span data-ttu-id="d5b9e-119">O recurso de registros lógicos tem dois benefícios primários:</span><span class="sxs-lookup"><span data-stu-id="d5b9e-119">The logical records feature has two primary benefits:</span></span>

-   <span data-ttu-id="d5b9e-120">Aplicação de alterações de dados como uma unidade.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-120">Application of data changes as a unit.</span></span>

-   <span data-ttu-id="d5b9e-121">A detecção e resolução de conflitos simultaneamente em várias linhas de várias tabelas.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-121">The detection and resolution of conflicts simultaneously on multiple rows from multiple tables.</span></span>

### <a name="the-application-of-changes-as-a-unit"></a><span data-ttu-id="d5b9e-122">A aplicação de alterações como uma unidade</span><span class="sxs-lookup"><span data-stu-id="d5b9e-122">The Application of Changes As a Unit</span></span>
 <span data-ttu-id="d5b9e-123">Se o processamento de mesclagem for interrompido, como no caso de uma conexão descartada, o conjunto parcialmente completado de alterações replicadas relacionadas será revertido se forem usados registros lógicos.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-123">If merge processing is interrupted, such as in the case of a dropped connection, the partially completed set of related replicated changes is rolled back if logical records are used.</span></span> <span data-ttu-id="d5b9e-124">Por exemplo, considere o caso onde um Assinante adiciona um novo pedido com **OrderID** = 6 e duas novas linhas na tabela **OrderItems** com **OrderItemID** = 10 e **OrderItemID** = 11 para **OrderID** = 6.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-124">For example, consider the case where a Subscriber adds a new order with **OrderID** = 6 and two new rows in the **OrderItems** table with **OrderItemID** = 10 and **OrderItemID** = 11 for **OrderID** = 6.</span></span>

 <span data-ttu-id="d5b9e-125">![Registro lógico de três tabelas com valores](../media/logical-records-04.gif "Registro lógico de três tabelas com valores")</span><span class="sxs-lookup"><span data-stu-id="d5b9e-125">![Three table logical record with values](../media/logical-records-04.gif "Three table logical record with values")</span></span>

 <span data-ttu-id="d5b9e-126">Se o processo de replicação for interrompido depois da linha **Pedidos** , para **OrderID** = 6 está concluído, mas, antes que os **OrderItems** 10 e 11 sejam concluídos e os registros lógicos não sejam usados, o valor de **OrderTotal** para **OrderID** = 6 não será consistente com a soma dos valores **OrderAmount** das linhas **OrderItems** .</span><span class="sxs-lookup"><span data-stu-id="d5b9e-126">If the replication process is interrupted after the **Orders** row for **OrderID** = 6 is complete, but before the **OrderItems** 10 and 11 are completed, and logical records are not used, the **OrderTotal** value for **OrderID** = 6 will not be consistent with the sum of the **OrderAmount** values for the **OrderItems** rows.</span></span> <span data-ttu-id="d5b9e-127">Se forem usados registros lógicos, a linha **Orders** para **OrderID** = 6 não será confirmada até que as alterações **OrderItems** sejam replicadas.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-127">If logical records are used, the **Orders** row for **OrderID** = 6 is not committed until the related **OrderItems** changes are replicated.</span></span>

 <span data-ttu-id="d5b9e-128">Em um cenário diferente, se forem usados registros lógicos e alguém estiver consultando tabelas quando o processo de mesclagem estiver aplicando alterações, o usuário não verá alterações replicadas parcialmente até que todas elas sejam concluídas.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-128">In a different scenario, if logical records are used, and someone is querying tables when the merge process is applying changes, the user will not see the partially replicated changes until they are all complete.</span></span> <span data-ttu-id="d5b9e-129">Por exemplo, se o processo de replicação tiver carregado a linha de Pedidos para **OrderID** = 6, mas um usuário consultar as tabelas antes que o processo de replicação tenha replicado as linhas de **OrderItems** , o valor de **OrderTotal** não será o mesmo da soma dos valores de **OrderAmount** .</span><span class="sxs-lookup"><span data-stu-id="d5b9e-129">For example, the replication process has uploaded the Orders row for **OrderID** = 6, but a user queries the tables before the replication process has replicated the **OrderItems** rows, the **OrderTotal** value would not be the same as the sum of the **OrderAmount** values.</span></span> <span data-ttu-id="d5b9e-130">Se forem usados registros lógicos, a linha de **Pedidos** não será visível ate que as linhas de **OrderItems** sejam concluídas e a transação seja confirmada como uma unidade.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-130">If logical records are used, the **Orders** row would not be visible until the **OrderItems** rows are complete and the transaction has been committed as a unit.</span></span>

### <a name="the-application-of-conflict-handling-to-more-than-one-table"></a><span data-ttu-id="d5b9e-131">A aplicação de manipulação de conflito para mais do que uma tabela</span><span class="sxs-lookup"><span data-stu-id="d5b9e-131">The Application of Conflict Handling to More Than One Table</span></span>
 <span data-ttu-id="d5b9e-132">Considere o caso e quem dois Assinantes têm os dados acima definidos:</span><span class="sxs-lookup"><span data-stu-id="d5b9e-132">Consider the case where two Subscribers have the data set above:</span></span>

-   <span data-ttu-id="d5b9e-133">Um usuário no primeiro Assinante altera o **OrderAmount** do **OrderItemID** 5 de 100 para 150 e o **OrderTotal** do **OrderID** 3 de 200 para 250.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-133">A user at the first Subscriber changes the **OrderAmount** of **OrderItemID** 5 from 100 to 150 and the **OrderTotal** of **OrderID** 3 from 200 to 250.</span></span>

-   <span data-ttu-id="d5b9e-134">Um usuário no segundo Assinante altera o **OrderAmount** do **OrderItemID** 6 de 25 para 125 e o **OrderTotal** do **OrderID** 3 de 200 para 300.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-134">A user at the second Subscriber changes the **OrderAmount** of **OrderItemID** 6 from 25 to 125 and the **OrderTotal** of **OrderID** 3 from 200 to 300.</span></span>

 <span data-ttu-id="d5b9e-135">Se essas alterações forem replicadas sem usar registros lógicos, os valores diferentes de **OrderTotal** resultarão em um conflito e apenas um deles será replicado.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-135">If these changes are replicated without using logical records, the different **OrderTotal** values would result in a conflict and only one of them would be replicated.</span></span> <span data-ttu-id="d5b9e-136">Mas as alterações não conflitantes na tabela **OrderItems** serão replicadas sem conflito, deixando os valores finais **OrderTotal** em um estado inconsistente em relação às linhas **OrderItems** .</span><span class="sxs-lookup"><span data-stu-id="d5b9e-136">But the non-conflicting changes in the **OrderItems** table would be replicated without conflict, leaving the final **OrderTotal** values in an inconsistent state with respect to the **OrderItems** rows.</span></span> <span data-ttu-id="d5b9e-137">Se forem usados registros lógicos neste cenário, a alteração de **OrderItems** associada com a alteração perdida da tabela **Orders** será revertida e o valor final de **OrderTotal** será um resumo preciso das linhas de **OrderItems** .</span><span class="sxs-lookup"><span data-stu-id="d5b9e-137">If logical records are used in this scenario, the **OrderItems** change associated with the losing **Orders** table change would also be rolled back, and the final **OrderTotal** value would be an accurate summary of the **OrderItems** rows.</span></span>

 <span data-ttu-id="d5b9e-138">Para mais informações sobre as opções relacionadas à detecção e à resolução de conflitos com registros lógicos, consulte [Detectando e resolvendo conflitos em registros lógicos](advanced-merge-replication-conflict-resolving-in-logical-record.md).</span><span class="sxs-lookup"><span data-stu-id="d5b9e-138">For more information about options related to conflict detection and resolution with logical records, see [Detecting and Resolving Conflicts in Logical Records](advanced-merge-replication-conflict-resolving-in-logical-record.md).</span></span>

## <a name="considerations-for-using-logical-records"></a><span data-ttu-id="d5b9e-139">Considerações para usar registros lógicos</span><span class="sxs-lookup"><span data-stu-id="d5b9e-139">Considerations for Using Logical Records</span></span>
 <span data-ttu-id="d5b9e-140">Lembre-se das seguintes considerações ao usar registros lógicos:</span><span class="sxs-lookup"><span data-stu-id="d5b9e-140">Keep the following considerations in mind when using logical records.</span></span>

### <a name="general-considerations"></a><span data-ttu-id="d5b9e-141">Considerações gerais</span><span class="sxs-lookup"><span data-stu-id="d5b9e-141">General Considerations</span></span>

-   <span data-ttu-id="d5b9e-142">É recomendável que você mantenha o número de tabelas em um registro lógico o mais baixo possível; cinco tabelas ou menos é o recomendável.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-142">It is recommended that you keep the number of tables in a logical record as low as possible; five tables or less is recommended.</span></span>

-   <span data-ttu-id="d5b9e-143">Registros lógicos não podem fazer referência a colunas com quaisquer dos tipos de dados seguintes:</span><span class="sxs-lookup"><span data-stu-id="d5b9e-143">Logical records cannot reference columns with any of the following data types:</span></span>

    -   <span data-ttu-id="d5b9e-144">`varchar(max)` e `nvarchar(max)`</span><span class="sxs-lookup"><span data-stu-id="d5b9e-144">`varchar(max)` and `nvarchar(max)`</span></span>

    -   `varbinary(max)`

    -   <span data-ttu-id="d5b9e-145">`text` e `ntext`</span><span class="sxs-lookup"><span data-stu-id="d5b9e-145">`text` and `ntext`</span></span>

    -   `image`

    -   `XML`

    -   `UDT`

-   <span data-ttu-id="d5b9e-146">Não podem ser definidas relações de chave estrangeira em tabelas publicadas com a opção CASCADE.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-146">Foreign key relationships in published tables cannot be defined with the CASCADE option.</span></span> <span data-ttu-id="d5b9e-147">Para mais informações, consulte [CREATE TABLE &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-table-transact-sql) e [ALTER TABLE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-table-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="d5b9e-147">For more information, see [CREATE TABLE &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-table-transact-sql) and [ALTER TABLE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-table-transact-sql).</span></span>

-   <span data-ttu-id="d5b9e-148">Você não pode atualizar qualquer coluna que é usada na cláusula de relação lógica.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-148">You cannot update any columns that are used in the logical relation clause.</span></span>

-   <span data-ttu-id="d5b9e-149">A resolução de conflitos personalizada com manipuladores de lógica de negócios ou resolvedores personalizados não tem suporte para artigos que não são incluídos em um registro lógico.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-149">Custom conflict resolution with business logic handlers or custom resolvers is not supported for articles that are included in a logical record.</span></span>

-   <span data-ttu-id="d5b9e-150">Se registros lógicos forem usados em uma publicação que inclui filtros com parâmetros, você deverá inicializar cada Assinante com um instantâneo de sua partição.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-150">If logical records are used in a publication that includes parameterized filters, you must initialize each Subscriber with a snapshot for its partition.</span></span> <span data-ttu-id="d5b9e-151">Se você inicializar um Assinante com outro método, o Merge Agent falhará.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-151">If you initialize a Subscriber with another method, the Merge Agent will fail.</span></span> <span data-ttu-id="d5b9e-152">Para obter mais informações, consulte [Snapshots for Merge Publications with Parameterized Filters](../snapshots-for-merge-publications-with-parameterized-filters.md).</span><span class="sxs-lookup"><span data-stu-id="d5b9e-152">For more information, see [Snapshots for Merge Publications with Parameterized Filters](../snapshots-for-merge-publications-with-parameterized-filters.md).</span></span>

-   <span data-ttu-id="d5b9e-153">Não são exibidos conflitos que envolvem registros lógicos no Visualizador de Conflitos.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-153">Conflicts that involve logical records are not displayed in Conflict Viewer.</span></span> <span data-ttu-id="d5b9e-154">Para exibir informações sobre esses conflitos, use procedimentos armazenados de replicação.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-154">To view information about these conflicts, use replication stored procedures.</span></span> <span data-ttu-id="d5b9e-155">Para obter mais informações, consulte [Exibir informações sobre conflitos em publicações de mesclagem &#40;Programação Transact-SQL de replicação&#41;](../view-conflict-information-for-merge-publications.md).</span><span class="sxs-lookup"><span data-stu-id="d5b9e-155">For more information, see [View Conflict Information for Merge Publications &#40;Replication Transact-SQL Programming&#41;](../view-conflict-information-for-merge-publications.md).</span></span>

### <a name="publication-settings"></a><span data-ttu-id="d5b9e-156">Configurações de Publicação</span><span class="sxs-lookup"><span data-stu-id="d5b9e-156">Publication Settings</span></span>

-   <span data-ttu-id="d5b9e-157">A publicação deve ter um nível de compatibilidade de 90RTM ou maior.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-157">The publication must have a compatibility level of 90RTM or greater.</span></span> <span data-ttu-id="d5b9e-158">Para mais informações, consulte a seção "Nível de Compatibilidade para publicações” em [Compatibilidade com a replicação](../replication-backward-compatibility.md).</span><span class="sxs-lookup"><span data-stu-id="d5b9e-158">For more information, see the "Publication Compatibility Level" section of [Replication Backward Compatibility](../replication-backward-compatibility.md).</span></span>

-   <span data-ttu-id="d5b9e-159">A publicação deve usar modo de instantâneo nativo.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-159">The publication must use native snapshot mode.</span></span> <span data-ttu-id="d5b9e-160">Este é o padrão a menos que você esteja replicando para [!INCLUDE[ssEW](../../../includes/ssew-md.md)], que não oferece suporte a registros lógicos.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-160">This is the default unless you are replicating to [!INCLUDE[ssEW](../../../includes/ssew-md.md)], which does not support logical records.</span></span>

-   <span data-ttu-id="d5b9e-161">A publicação não pode permitir sincronização da Web.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-161">The publication cannot allow Web synchronization.</span></span> <span data-ttu-id="d5b9e-162">Para obter mais informações sobre a sincronização da Web, consulte [Web Synchronization for Merge Replication](../web-synchronization-for-merge-replication.md).</span><span class="sxs-lookup"><span data-stu-id="d5b9e-162">For more information about Web synchronization, see [Web Synchronization for Merge Replication](../web-synchronization-for-merge-replication.md).</span></span>

-   <span data-ttu-id="d5b9e-163">Para usar registros lógicos em uma publicação filtrada:</span><span class="sxs-lookup"><span data-stu-id="d5b9e-163">In order to use logical records on a filtered publication:</span></span>

    -   <span data-ttu-id="d5b9e-164">Também devem ser usadas partições pré-computadas.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-164">Precomputed partitions must also be used.</span></span> <span data-ttu-id="d5b9e-165">Os requisitos de partições pré-computadas também se aplicam a registros lógicos.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-165">The requirements of precomputed partitions also apply to logical records.</span></span> <span data-ttu-id="d5b9e-166">Para obter mais informações, consulte [Optimize Parameterized Filter Performance with Precomputed Partitions](parameterized-filters-optimize-for-precomputed-partitions.md) (Otimizar o desempenho do filtro parametrizado com partições pré-computadas).</span><span class="sxs-lookup"><span data-stu-id="d5b9e-166">For more information, see [Optimize Parameterized Filter Performance with Precomputed Partitions](parameterized-filters-optimize-for-precomputed-partitions.md).</span></span>

    -   <span data-ttu-id="d5b9e-167">Você não pode usar filtros com parâmetros que não se sobrepõem.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-167">You cannot use nonoverlapping parameterized filters.</span></span> <span data-ttu-id="d5b9e-168">Para obter mais informações, consulte a seção "Configurando opções de partição" em [Filtros de linha com parâmetros](parameterized-filters-parameterized-row-filters.md).</span><span class="sxs-lookup"><span data-stu-id="d5b9e-168">For more information, see the "Setting 'partition options'" section of [Parameterized Row Filters](parameterized-filters-parameterized-row-filters.md).</span></span>

-   <span data-ttu-id="d5b9e-169">Se a publicação usar filtros de junções, a propriedade **juntar chave exclusiva** deverá ser definida como **verdadeiro** para todos os filtros de junção que são envolvidos em relações de registro lógico.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-169">If the publication uses join filters, the **join unique key** property must be set to **true** for all join filters that are involved in logical record relationships.</span></span> <span data-ttu-id="d5b9e-170">Para obter mais informações, consulte [Join Filters](join-filters.md).</span><span class="sxs-lookup"><span data-stu-id="d5b9e-170">For more information, see [Join Filters](join-filters.md).</span></span>

### <a name="relationships-between-tables"></a><span data-ttu-id="d5b9e-171">Relações entre tabelas</span><span class="sxs-lookup"><span data-stu-id="d5b9e-171">Relationships Between Tables</span></span>

-   <span data-ttu-id="d5b9e-172">Tabelas relacionadas por registros lógicos devem ter uma relação chave primária-chave estrangeira.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-172">Tables related through logical records must have a primary key-foreign key relationship.</span></span>

-   <span data-ttu-id="d5b9e-173">A opção NOT FOR REPLICATION não pode ser definida para restrições de chave estrangeira.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-173">The NOT FOR REPLICATION option cannot be set for foreign key constraints.</span></span>

-   <span data-ttu-id="d5b9e-174">Tabelas filho podem ter só uma tabela pai.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-174">Child tables can have only one parent table.</span></span>

     <span data-ttu-id="d5b9e-175">Por exemplo, um banco de dados que rastreia classes e estudantes poderá ter um design semelhante a:</span><span class="sxs-lookup"><span data-stu-id="d5b9e-175">For example, a database tracking classes and students might have a design similar to:</span></span>

     <span data-ttu-id="d5b9e-176">![Tabela filho com mais de uma tabela pai](../media/logical-records-03.gif "Tabela filho com mais de uma tabela pai")</span><span class="sxs-lookup"><span data-stu-id="d5b9e-176">![Child table with more than one parent table](../media/logical-records-03.gif "Child table with more than one parent table")</span></span>

     <span data-ttu-id="d5b9e-177">Você não pode usar um registro lógico para representar as três tabelas nessa relação, porque as linhas em **ClassMembers** não são associadas com uma linha de chave primária única.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-177">You cannot use a logical record to represent the three tables in this relationship, because the rows in **ClassMembers** are not associated with a single primary key row.</span></span> <span data-ttu-id="d5b9e-178">As tabelas **Classes** e **ClassMembers** poderiam ainda formar um registro lógico, como poderiam as tabelas **ClassMembers** e **Students**, mas não todas as três.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-178">The tables **Classes** and **ClassMembers** could still form a logical record, as could the tables **ClassMembers** and **Students**, but not all three.</span></span>

-   <span data-ttu-id="d5b9e-179">A publicação não pode conter relações de filtro de junção circulares.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-179">The publication cannot contain circular join filter relationships.</span></span>

     <span data-ttu-id="d5b9e-180">Usando o exemplo com as tabelas **Customers**, **Orders**e **OrderItems**, você não poderia usar registros lógicos se a tabela **Orders** também tivesse uma restrição de chave estrangeira que fez referência à tabela **OrderItems** .</span><span class="sxs-lookup"><span data-stu-id="d5b9e-180">Using the example with the tables **Customers**, **Orders**, and **OrderItems**, you could not use logical records if the **Orders** table also had a foreign key constraint that referenced the **OrderItems** table.</span></span>

## <a name="performance-implications-of-logical-records"></a><span data-ttu-id="d5b9e-181">Implicações de desempenho de registros lógicos</span><span class="sxs-lookup"><span data-stu-id="d5b9e-181">Performance implications of logical records</span></span>
 <span data-ttu-id="d5b9e-182">O recurso de registro lógico vem com um custo de desempenho.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-182">The logical record feature does come with a performance cost.</span></span> <span data-ttu-id="d5b9e-183">Se não forem usados registros lógicos, o agente de replicação poderá processar todas as alterações para um determinado artigo ao mesmo tempo, e como as alterações são aplicadas no modo linha por linha, os requisitos de bloqueio e log de transação, necessários para aplicar as alterações, serão mínimos.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-183">If logical records are not used, the replication agent can process all of the changes for a given article at the same time, and because the changes are applied in a row-by-row fashion, the locking and transaction log requirements necessary for applying the changes are minimal.</span></span>

 <span data-ttu-id="d5b9e-184">Se registros lógicos forem usados, o Merge Agent deverá processar as alterações para cada registro lógico inteiro, de forma conjunta.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-184">If logical records are used, the Merge Agent must process the changes for each entire logical record together.</span></span> <span data-ttu-id="d5b9e-185">Isto tem um efeito no tempo necessário para o Merge Agent replicar as linhas.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-185">This has an effect on the amount of time it takes the Merge Agent to replicate the rows.</span></span> <span data-ttu-id="d5b9e-186">Adicionalmente, como o agente abre uma transação separada para cada registro lógico, os requisitos de bloqueio podem aumentar.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-186">Additionally, because the agent opens a separate transaction for each logical record, locking requirements can increase.</span></span>

## <a name="see-also"></a><span data-ttu-id="d5b9e-187">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="d5b9e-187">See Also</span></span>
 [<span data-ttu-id="d5b9e-188">Opções de artigos para a replicação de mesclagem</span><span class="sxs-lookup"><span data-stu-id="d5b9e-188">Article Options for Merge Replication</span></span>](article-options-for-merge-replication.md)


