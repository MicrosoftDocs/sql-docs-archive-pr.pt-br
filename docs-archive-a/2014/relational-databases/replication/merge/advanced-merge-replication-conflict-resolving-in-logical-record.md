---
title: Detectando e solucionando conflitos em registros lógicos | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- logical records [SQL Server replication]
- conflict resolution [SQL Server replication], merge replication
ms.assetid: f2e55040-ca69-4ccf-97d1-c362e1633f26
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: f9822cd153af67538a36a894de0ec1b4716e54cf
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87568518"
---
# <a name="detecting-and-resolving-conflicts-in-logical-records"></a><span data-ttu-id="e9317-102">Detecting and Resolving Conflicts in Logical Records</span><span class="sxs-lookup"><span data-stu-id="e9317-102">Detecting and Resolving Conflicts in Logical Records</span></span>
  <span data-ttu-id="e9317-103">Este tópico cobre as várias abordagens de combinações de detecção e resolução de conflitos possíveis ao usar registros lógicos.</span><span class="sxs-lookup"><span data-stu-id="e9317-103">This topic covers the various combinations of conflict detection and conflict resolution approaches possible when using logical records.</span></span> <span data-ttu-id="e9317-104">Um conflito na replicação de mesclagem ocorre quando mais de um nó altera os mesmos dados ou quando a replicação de mesclagem encontra determinados tipos de erros, como violação de restrição, durante a replicação de alterações.</span><span class="sxs-lookup"><span data-stu-id="e9317-104">A conflict in merge replication occurs when more than one node changes the same data, or merge replication encounters certain types of errors, such as a constraint violation, when replicating changes.</span></span> <span data-ttu-id="e9317-105">Para obter mais informações sobre detecção e resolução de conflitos, consulte [Advanced Merge Replication Conflict Detection and Resolution](advanced-merge-replication-conflict-detection-and-resolution.md).</span><span class="sxs-lookup"><span data-stu-id="e9317-105">For more information about conflict detection and resolution, see [Advanced Merge Replication Conflict Detection and Resolution](advanced-merge-replication-conflict-detection-and-resolution.md).</span></span>

 <span data-ttu-id="e9317-106">Para especificar o nível de controle e resolução de conflitos para um artigo, consulte [especificar o nível de resolução e de rastreamento de conflito para artigos de mesclagem](../publish/specify-merge-replication-properties.md#interactive-conflict-resolution).</span><span class="sxs-lookup"><span data-stu-id="e9317-106">To specify the conflict tracking and resolution level for an article, see [Specify the Conflict Tracking and Resolution Level for Merge Articles](../publish/specify-merge-replication-properties.md#interactive-conflict-resolution).</span></span>

## <a name="conflict-detection"></a><span data-ttu-id="e9317-107">Detecção de conflito</span><span class="sxs-lookup"><span data-stu-id="e9317-107">Conflict Detection</span></span>
 <span data-ttu-id="e9317-108">A forma pela qual os conflitos são detectados para registros lógicos é determinada por duas propriedades do artigo: **column_tracking** e **logical_record_level_conflict_detection**.</span><span class="sxs-lookup"><span data-stu-id="e9317-108">The way in which conflicts are detected for logical records is determined by two article properties: **column_tracking** and **logical_record_level_conflict_detection**.</span></span> <span data-ttu-id="e9317-109">O[!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] e versões posteriores também dão suporte à detecção do nível de registro lógico.</span><span class="sxs-lookup"><span data-stu-id="e9317-109">[!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions also support logical record-level detection.</span></span>

 <span data-ttu-id="e9317-110">A propriedade de artigo **logical_record_level_conflict_detection** pode ser definida como TRUE ou FALSE.</span><span class="sxs-lookup"><span data-stu-id="e9317-110">The **logical_record_level_conflict_detection** article property can be set to TRUE or FALSE.</span></span> <span data-ttu-id="e9317-111">O valor deve ser definido apenas para o artigo pai de alto nível, sendo ignorado pelos artigos filho.</span><span class="sxs-lookup"><span data-stu-id="e9317-111">The value should only be set for the top-level parent article and will be ignored by child articles.</span></span> <span data-ttu-id="e9317-112">Se esse valor for FALSE, a replicação de mesclagem detectará conflitos como nas versões anteriores do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], com base unicamente no valor da propriedade **column_tracking** do artigo.</span><span class="sxs-lookup"><span data-stu-id="e9317-112">If this value is FALSE, merge replication detects conflicts as in previous versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], based solely on the value of the **column_tracking** property for the article.</span></span> <span data-ttu-id="e9317-113">Se esse valor for TRUE, a replicação de mesclagem ignorará a propriedade **column_tracking** do artigo, e detectará um conflito se alterações forem feitas em qualquer lugar do registro lógico.</span><span class="sxs-lookup"><span data-stu-id="e9317-113">If this value is TRUE, merge replication will ignore the **column_tracking** property of the article, and detect a conflict if changes are made anywhere in the logical record.</span></span> <span data-ttu-id="e9317-114">Por exemplo, considere este cenário:</span><span class="sxs-lookup"><span data-stu-id="e9317-114">For example, consider this scenario:</span></span>

 <span data-ttu-id="e9317-115">![Registro lógico de três tabelas com valores](../media/logical-records-05.gif "Registro lógico de três tabelas com valores")</span><span class="sxs-lookup"><span data-stu-id="e9317-115">![Three table logical record with values](../media/logical-records-05.gif "Three table logical record with values")</span></span>

 <span data-ttu-id="e9317-116">Um conflito é detectado caso dois usuários alterem quaisquer valores do registro lógico Customer2 nas tabelas **Customers**, **Orders**ou **OrderItems** .</span><span class="sxs-lookup"><span data-stu-id="e9317-116">A conflict is detected if two users change any values for the Customer2 logical record in the **Customers**, **Orders**, or **OrderItems** tables.</span></span> <span data-ttu-id="e9317-117">Esse exemplo invoca alterações feitas por meio da instrução UPDATE, mas o conflito pode igualmente ser detectado pelas alterações feitas com as instruções INSERT ou DELETE.</span><span class="sxs-lookup"><span data-stu-id="e9317-117">This example involves changes made via an UPDATE statement, but the conflict can also be detected by changes made with INSERT or DELETE statements.</span></span>

## <a name="conflict-resolution"></a><span data-ttu-id="e9317-118">Resolução de conflitos</span><span class="sxs-lookup"><span data-stu-id="e9317-118">Conflict Resolution</span></span>
 <span data-ttu-id="e9317-119">Por padrão, a replicação de mesclagem usa uma lógica fundamentada na prioridade para resolver conflitos.</span><span class="sxs-lookup"><span data-stu-id="e9317-119">By default, merge replication uses priority-based logic to resolve conflicts.</span></span> <span data-ttu-id="e9317-120">Se for feita uma alteração conflitante em dois bancos de dados de Assinante, a alteração do Assinante com alta prioridade de assinatura vence ou, se a prioridade for a mesma, a primeira alteração para alcançar o Publicador vence.</span><span class="sxs-lookup"><span data-stu-id="e9317-120">If a conflicting change is made in two Subscriber databases, the change for the Subscriber with the higher subscription priority wins, or if the priority is the same, the first change to reach the Publisher wins.</span></span> <span data-ttu-id="e9317-121">Com a detecção em nível de linha e em nível de coluna, toda a linha vencedora substitui a linha perdedora.</span><span class="sxs-lookup"><span data-stu-id="e9317-121">With row-level and column-level detection, the entire winning row always overwrites the losing row.</span></span>

 <span data-ttu-id="e9317-122">A propriedade de artigo **logical_record_level_conflict_resolution** pode ser definida como TRUE ou FALSE.</span><span class="sxs-lookup"><span data-stu-id="e9317-122">The **logical_record_level_conflict_resolution** article property can be set to TRUE or FALSE.</span></span> <span data-ttu-id="e9317-123">O valor deve ser definido apenas para o artigo pai de alto nível, sendo ignorado pelos artigos filho.</span><span class="sxs-lookup"><span data-stu-id="e9317-123">The value should only be set for the top-level parent article and will be ignored by child articles.</span></span> <span data-ttu-id="e9317-124">Se o valor for TRUE, todo o registro lógico vencedor substituirá o registro lógico perdedor.</span><span class="sxs-lookup"><span data-stu-id="e9317-124">If the value is TRUE, the entire winning logical record overwrites the losing logical record.</span></span> <span data-ttu-id="e9317-125">Se for FALSE, as linhas vencedoras individuais poderão vir de outros Assinantes ou Publicadores.</span><span class="sxs-lookup"><span data-stu-id="e9317-125">If it is FALSE, individual winning rows can come from different Subscribers or Publishers.</span></span> <span data-ttu-id="e9317-126">Por exemplo, o Assinante A pode vencer um conflito em uma linha da tabela **Orders** , e o Assinante B pode vencer em uma linha associada da tabela **OrderItems** .</span><span class="sxs-lookup"><span data-stu-id="e9317-126">For example, Subscriber A could win a conflict on a row from the **Orders** table, and Subscriber B could win on a related row from the **OrderItems** table.</span></span> <span data-ttu-id="e9317-127">O resultado é um registro lógico com as linhas **Orders** do Assinante A e a linha **OrderItems** do Assinante B.</span><span class="sxs-lookup"><span data-stu-id="e9317-127">The result is a logical record with the **Orders** row from Subscriber A and the **OrderItems** row from Subscriber B.</span></span>

## <a name="interaction-of-conflict-resolution-and-detection-settings"></a><span data-ttu-id="e9317-128">Interação das configurações de resolução e detecção de conflitos</span><span class="sxs-lookup"><span data-stu-id="e9317-128">Interaction of Conflict Resolution and Detection Settings</span></span>
 <span data-ttu-id="e9317-129">O resultado dos conflitos depende da interação das configurações de detecção e resolução de conflitos.</span><span class="sxs-lookup"><span data-stu-id="e9317-129">The outcome of conflicts depends on the interaction of conflict detection and resolution settings.</span></span> <span data-ttu-id="e9317-130">Com relação aos exemplos abaixo, supõe-se que a resolução de conflitos com base na prioridade está em uso.</span><span class="sxs-lookup"><span data-stu-id="e9317-130">For the examples below, it is assumed that the priority-based conflict resolution is being used.</span></span> <span data-ttu-id="e9317-131">Quando se usam registros lógicos, as possibilidades são:</span><span class="sxs-lookup"><span data-stu-id="e9317-131">When using logical records, the possibilities are:</span></span>

-   <span data-ttu-id="e9317-132">Detecção em nível de linha ou coluna, resolução em nível de linha</span><span class="sxs-lookup"><span data-stu-id="e9317-132">Row or column level detection, row level resolution</span></span>

-   <span data-ttu-id="e9317-133">Detecção em nível de coluna, resolução de registro lógico</span><span class="sxs-lookup"><span data-stu-id="e9317-133">Column level detection, logical record resolution</span></span>

-   <span data-ttu-id="e9317-134">Detecção em nível de linha, resolução de registro lógico</span><span class="sxs-lookup"><span data-stu-id="e9317-134">Row level detection, logical record resolution</span></span>

-   <span data-ttu-id="e9317-135">Detecção de registro lógico, resolução de registro lógico</span><span class="sxs-lookup"><span data-stu-id="e9317-135">Logical record detection, logical record resolution</span></span>

### <a name="row-or-column-level-detection-row-level-resolution"></a><span data-ttu-id="e9317-136">Detecção em nível de linha ou coluna, resolução em nível de linha</span><span class="sxs-lookup"><span data-stu-id="e9317-136">Row or Column Level Detection, Row Level Resolution</span></span>
 <span data-ttu-id="e9317-137">Nesse exemplo, a publicação é configurada com:</span><span class="sxs-lookup"><span data-stu-id="e9317-137">In this example, the publication is configured with:</span></span>

-   <span data-ttu-id="e9317-138">**column_tracking** é TRUE ou FALSE</span><span class="sxs-lookup"><span data-stu-id="e9317-138">**column_tracking** is TRUE or FALSE</span></span>

-   <span data-ttu-id="e9317-139">**logical_record_level_conflict_detection** é FALSE</span><span class="sxs-lookup"><span data-stu-id="e9317-139">**logical_record_level_conflict_detection** is FALSE</span></span>

-   <span data-ttu-id="e9317-140">**logical_record_level_conflict_resolution** é FALSE</span><span class="sxs-lookup"><span data-stu-id="e9317-140">**logical_record_level_conflict_resolution** is FALSE</span></span>

 <span data-ttu-id="e9317-141">Nesse caso, a detecção permanece em nível de linha ou coluna e a resolução em nível de linha.</span><span class="sxs-lookup"><span data-stu-id="e9317-141">In this case, detection is at the row or column level and resolution is at the row level.</span></span> <span data-ttu-id="e9317-142">Essas configurações são usadas para usufruir o fato de todas as alterações de um registro lógico serem replicadas como uma unidade; contudo, sem detecção ou resolução de conflitos em nível de registro lógico.</span><span class="sxs-lookup"><span data-stu-id="e9317-142">These settings are used to take advantage of having all changes to a logical record replicate as a unit, but without conflict detection or resolution at the logical record level.</span></span>

### <a name="column-level-detection-logical-record-resolution"></a><span data-ttu-id="e9317-143">Detecção em nível de coluna, resolução de registro lógico</span><span class="sxs-lookup"><span data-stu-id="e9317-143">Column Level Detection, Logical Record Resolution</span></span>
 <span data-ttu-id="e9317-144">Nesse exemplo, a publicação é configurada com:</span><span class="sxs-lookup"><span data-stu-id="e9317-144">In this example, the publication is configured with:</span></span>

-   <span data-ttu-id="e9317-145">**column_tracking** é TRUE</span><span class="sxs-lookup"><span data-stu-id="e9317-145">**column_tracking** is TRUE</span></span>

-   <span data-ttu-id="e9317-146">**logical_record_level_conflict_detection** é FALSE</span><span class="sxs-lookup"><span data-stu-id="e9317-146">**logical_record_level_conflict_detection** is FALSE</span></span>

-   <span data-ttu-id="e9317-147">**logical_record_level_conflict_resolution** é TRUE</span><span class="sxs-lookup"><span data-stu-id="e9317-147">**logical_record_level_conflict_resolution** is TRUE</span></span>

 <span data-ttu-id="e9317-148">Um Publicador ou Assinante começa com o mesmo conjunto de dados, e um registro lógico é definido entre as tabelas **orders** e **customers** .</span><span class="sxs-lookup"><span data-stu-id="e9317-148">A Publisher and Subscriber start with the same data set, and a logical record is defined between the **orders** and **customers** tables.</span></span> <span data-ttu-id="e9317-149">O Publicador altera a coluna **custcol1** na tabela **customers** , e **ordercol1** na tabela **orders** .</span><span class="sxs-lookup"><span data-stu-id="e9317-149">The Publisher changes the **custcol1** column in the **customers** table and the **ordercol1** in the **orders** table.</span></span> <span data-ttu-id="e9317-150">O Publicador altera **custcol1** na mesma linha da tabela **customers** , e a coluna **ordercol2** , na mesma coluna da tabela **orders** .</span><span class="sxs-lookup"><span data-stu-id="e9317-150">The Subscriber changes **custcol1** in the same row of the **customers** table and the **ordercol2** column in the same row of the **orders** table.</span></span> <span data-ttu-id="e9317-151">As alterações na mesma coluna da tabela **customer** resultam em conflito; contudo, as alterações na tabela **orders** não são conflitantes.</span><span class="sxs-lookup"><span data-stu-id="e9317-151">The changes to the same column in the **customer** table result in a conflict, but the changes to the **orders** table are not in conflict.</span></span>

 <span data-ttu-id="e9317-152">Como os conflitos são resolvidos em nível de registro lógico, as alterações vencedoras feitas no Publicador substituem as alterações feitas nas tabelas do Assinante durante o processo de replicação.</span><span class="sxs-lookup"><span data-stu-id="e9317-152">Because the conflicts are resolved at the logical record level, the winning changes made at the Publisher replace the changes made in the Subscriber tables during replication processing.</span></span>

 <span data-ttu-id="e9317-153">![Série de tabelas mostrando alterações nas linhas relacionadas](../media/logical-records-06.gif "Série de tabelas mostrando alterações nas linhas relacionadas")</span><span class="sxs-lookup"><span data-stu-id="e9317-153">![Series of tables showing changes to related rows](../media/logical-records-06.gif "Series of tables showing changes to related rows")</span></span>

### <a name="row-level-detection-logical-record-resolution"></a><span data-ttu-id="e9317-154">Detecção em nível de linha, resolução de registro lógico</span><span class="sxs-lookup"><span data-stu-id="e9317-154">Row Level Detection, Logical Record Resolution</span></span>
 <span data-ttu-id="e9317-155">Nesse exemplo, a publicação é configurada com:</span><span class="sxs-lookup"><span data-stu-id="e9317-155">In this example, the publication is configured with:</span></span>

-   <span data-ttu-id="e9317-156">**column_tracking** é FALSE</span><span class="sxs-lookup"><span data-stu-id="e9317-156">**column_tracking** is FALSE</span></span>

-   <span data-ttu-id="e9317-157">**logical_record_level_conflict_detection** é FALSE</span><span class="sxs-lookup"><span data-stu-id="e9317-157">**logical_record_level_conflict_detection** is FALSE</span></span>

-   <span data-ttu-id="e9317-158">**logical_record_level_conflict_resolution** é TRUE</span><span class="sxs-lookup"><span data-stu-id="e9317-158">**logical_record_level_conflict_resolution** is TRUE</span></span>

 <span data-ttu-id="e9317-159">O Publicador e o Assinante são iniciados com o mesmo conjunto de dados.</span><span class="sxs-lookup"><span data-stu-id="e9317-159">A Publisher and Subscriber start with the same data set.</span></span> <span data-ttu-id="e9317-160">O Publicador altera a coluna **custcol1** na tabela **customers** .</span><span class="sxs-lookup"><span data-stu-id="e9317-160">The Publisher changes the **custcol1** column in the **customers** table.</span></span> <span data-ttu-id="e9317-161">O Assinante altera **custcol2** na tabela **customers** , e na coluna **ordercol2** da tabela **orders** .</span><span class="sxs-lookup"><span data-stu-id="e9317-161">The Subscriber changes **custcol2** in the **customers** table and the **ordercol2** column in the **orders** table.</span></span> <span data-ttu-id="e9317-162">As alterações da mesma linha da tabela **customers** resultam em conflito; contudo, as alterações do Assinante na tabela **orders** não estão em conflito.</span><span class="sxs-lookup"><span data-stu-id="e9317-162">The changes to the same row in the **customers** table result in a conflict, but the Subscriber changes to the **orders** table are not in conflict.</span></span>

 <span data-ttu-id="e9317-163">Como os conflitos são resolvidos em nível de registro lógico, as alterações vencedoras feitas no Publicador substituem as alterações feitas nas tabelas do Assinante durante o processamento da replicação.</span><span class="sxs-lookup"><span data-stu-id="e9317-163">Because the conflicts are resolved at the logical record level, during synchronization the winning changes made at the Publisher replace the changes made in the Subscriber tables.</span></span>

 <span data-ttu-id="e9317-164">![Série de tabelas mostrando alterações nas linhas relacionadas](../media/logical-records-07.gif "Série de tabelas mostrando alterações nas linhas relacionadas")</span><span class="sxs-lookup"><span data-stu-id="e9317-164">![Series of tables showing changes to related rows](../media/logical-records-07.gif "Series of tables showing changes to related rows")</span></span>

### <a name="logical-record-detection-logical-record-resolution"></a><span data-ttu-id="e9317-165">Detecção de registro lógico, resolução de registro lógico</span><span class="sxs-lookup"><span data-stu-id="e9317-165">Logical Record Detection, Logical Record Resolution</span></span>
 <span data-ttu-id="e9317-166">Nesse exemplo, a publicação é configurada com:</span><span class="sxs-lookup"><span data-stu-id="e9317-166">In this example, the publication is configured with:</span></span>

-   <span data-ttu-id="e9317-167">**logical_record_level_conflict_detection** é TRUE</span><span class="sxs-lookup"><span data-stu-id="e9317-167">**logical_record_level_conflict_detection** is TRUE</span></span>

-   <span data-ttu-id="e9317-168">**logical_record_level_conflict_resolution** é TRUE</span><span class="sxs-lookup"><span data-stu-id="e9317-168">**logical_record_level_conflict_resolution** is TRUE</span></span>

 <span data-ttu-id="e9317-169">O Publicador e o Assinante são iniciados com o mesmo conjunto de dados.</span><span class="sxs-lookup"><span data-stu-id="e9317-169">A Publisher and Subscriber start with the same data set.</span></span> <span data-ttu-id="e9317-170">O Publicador altera a coluna **custcol1** na tabela **customers** .</span><span class="sxs-lookup"><span data-stu-id="e9317-170">The Publisher changes the **custcol1** column in the **customers** table.</span></span> <span data-ttu-id="e9317-171">O Assinante altera a coluna **ordercol1** na tabela **orders** .</span><span class="sxs-lookup"><span data-stu-id="e9317-171">The Subscriber changes the **ordercol1** column in the **orders** table.</span></span> <span data-ttu-id="e9317-172">Não há alterações na mesma linha ou colunas, mas, como as alterações são feitas no mesmo registro lógico de **custid**=1, as alterações são detectadas como conflito no nível do registro lógico.</span><span class="sxs-lookup"><span data-stu-id="e9317-172">There are no changes to the same row or columns, but because the changes are made in the same logical record for **custid**=1, the changes are detected as a conflict at the logical record level.</span></span>

 <span data-ttu-id="e9317-173">Como os conflitos são também resolvidos no nível do registro lógico, durante a sincronização a alteração vencedora feita no Publicador substitui a alteração feita nas tabelas do Assinante.</span><span class="sxs-lookup"><span data-stu-id="e9317-173">Because the conflicts are also resolved at the logical record level, during synchronization the winning change made at the Publisher replaces the change made in the Subscriber tables.</span></span>

 <span data-ttu-id="e9317-174">![Série de tabelas mostrando alterações nas linhas relacionadas](../media/logical-records-08.gif "Série de tabelas mostrando alterações nas linhas relacionadas")</span><span class="sxs-lookup"><span data-stu-id="e9317-174">![Series of tables showing changes to related rows](../media/logical-records-08.gif "Series of tables showing changes to related rows")</span></span>

## <a name="see-also"></a><span data-ttu-id="e9317-175">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="e9317-175">See Also</span></span>
 [<span data-ttu-id="e9317-176">Agrupar alterações em linhas relacionadas com registros lógicos</span><span class="sxs-lookup"><span data-stu-id="e9317-176">Group Changes to Related Rows with Logical Records</span></span>](group-changes-to-related-rows-with-logical-records.md)


