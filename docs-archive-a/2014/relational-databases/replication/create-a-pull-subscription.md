---
title: Criar uma assinatura pull | Microsoft Docs
ms.custom: ''
ms.date: 05/24/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- pull subscriptions [SQL Server replication], creating
- merge replication subscribing [SQL Server replication], pull subscriptions
- subscriptions [SQL Server replication], pull
- snapshot replication [SQL Server], subscribing
- transactional replication, subscribing
ms.assetid: 41d1886d-59c9-41fc-9bd6-a59b40e0af6e
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 12ef7d658496c0fb7281827259e8e46f0c5fac64
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87584119"
---
# <a name="create-a-pull-subscription"></a><span data-ttu-id="abc40-102">Create a Pull Subscription</span><span class="sxs-lookup"><span data-stu-id="abc40-102">Create a Pull Subscription</span></span>
  <span data-ttu-id="abc40-103">Este tópico descreve como criar uma assinatura pull no [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] usando o [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../includes/tsql-md.md)]ou RMO (Replication Management Objects).</span><span class="sxs-lookup"><span data-stu-id="abc40-103">This topic describes how create a pull subscription in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../includes/tsql-md.md)], or Replication Management Objects (RMO).</span></span>  
  
 <span data-ttu-id="abc40-104">A configuração de uma assinatura pull para a replicação de P2P é possível por script, mas não está disponível por meio do assistente.</span><span class="sxs-lookup"><span data-stu-id="abc40-104">Setting up a pull subscription for P2P replication is possible by script, but is not available through the wizard.</span></span>  
  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="abc40-105">Usando o SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="abc40-105">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="abc40-106">Crie uma assinatura pull no Publicador ou Assinante, usando o Assistente para Novas Assinaturas.</span><span class="sxs-lookup"><span data-stu-id="abc40-106">Create a pull subscription at the Publisher or the Subscriber using the New Subscription Wizard.</span></span> <span data-ttu-id="abc40-107">Siga as páginas no assistente para:</span><span class="sxs-lookup"><span data-stu-id="abc40-107">Follow the pages in the wizard to:</span></span>  
  
-   <span data-ttu-id="abc40-108">Especificar o Publicador e a publicação.</span><span class="sxs-lookup"><span data-stu-id="abc40-108">Specify the Publisher and publication.</span></span>  
  
-   <span data-ttu-id="abc40-109">Selecione onde os agentes de replicação executarão.</span><span class="sxs-lookup"><span data-stu-id="abc40-109">Select where replication agents will run.</span></span> <span data-ttu-id="abc40-110">Para uma assinatura pull, selecione **Executar cada agente como seu assinante (assinaturas pull)** na página **Local do Distribution Agent** ou na página **Local do Merge Agent** , dependendo do tipo de publicação.</span><span class="sxs-lookup"><span data-stu-id="abc40-110">For a pull subscription, select **Run each agent at its Subscriber (pull subscriptions)** on the **Distribution Agent Location** page or **Merge Agent Location** page, depending on the type of publication.</span></span>  
  
-   <span data-ttu-id="abc40-111">Especifique Assinantes e bancos de dados de assinatura.</span><span class="sxs-lookup"><span data-stu-id="abc40-111">Specify Subscribers and subscription databases.</span></span>  
  
-   <span data-ttu-id="abc40-112">Especifique os logons e senhas usadas para conexões feitas por agentes de replicação:</span><span class="sxs-lookup"><span data-stu-id="abc40-112">Specify the logins and passwords used for connections made by replication agents:</span></span>  
  
    -   <span data-ttu-id="abc40-113">Para assinaturas para instantâneos e publicações transacionais, especifique as credenciais na página **Segurança do Distribution Agent** .</span><span class="sxs-lookup"><span data-stu-id="abc40-113">For subscriptions to snapshot and transactional publications, specify credentials on the **Distribution Agent Security** page.</span></span>  
  
    -   <span data-ttu-id="abc40-114">Para assinaturas para publicações de mesclagem, especifique as credenciais na página **Segurança do Merge Agent** .</span><span class="sxs-lookup"><span data-stu-id="abc40-114">For subscriptions to merge publications, specify credentials on the **Merge Agent Security** page.</span></span>  
  
     <span data-ttu-id="abc40-115">Para obter informações sobre as permissões exigidas por cada agente, consulte [Replication Agent Security Model](security/replication-agent-security-model.md).</span><span class="sxs-lookup"><span data-stu-id="abc40-115">For information about the permissions required by each agent, see [Replication Agent Security Model](security/replication-agent-security-model.md).</span></span>  
  
-   <span data-ttu-id="abc40-116">Especifique uma agenda de sincronização e quando o Assinante deve ser inicializado.</span><span class="sxs-lookup"><span data-stu-id="abc40-116">Specify a synchronization schedule and when the Subscriber should be initialized.</span></span>  
  
-   <span data-ttu-id="abc40-117">Especifique opções adicionais para as publicações de mesclagem: tipo da assinatura; valores para filtragem com parâmetros e as informações para sincronização através de HTTPS se a publicação estiver habilitada para sincronização da Web.</span><span class="sxs-lookup"><span data-stu-id="abc40-117">Specify additional options for merge publications: subscription type; values for parameterized filtering; and information for synchronization through HTTPS if the publication is enabled for Web synchronization.</span></span>  
  
-   <span data-ttu-id="abc40-118">Especifique opções adicionais para publicações transacionais que permitem assinaturas de atualização: se os Assinantes devem confirmar alterações no Publicador imediatamente ou gravá-las em uma fila; credenciais usadas do Assinante para o Publicador.</span><span class="sxs-lookup"><span data-stu-id="abc40-118">Specify additional options for transactional publications that allow updating subscriptions: whether Subscribers should commit changes at the Publisher immediately or write them to a queue; credentials used to connect from the Subscriber to the Publisher.</span></span>  
  
-   <span data-ttu-id="abc40-119">Opcionalmente, faça o script da assinatura.</span><span class="sxs-lookup"><span data-stu-id="abc40-119">Optionally script the subscription.</span></span>  
  
#### <a name="to-create-a-pull-subscription-from-the-publisher"></a><span data-ttu-id="abc40-120">Para criar uma assinatura pull do Publicador</span><span class="sxs-lookup"><span data-stu-id="abc40-120">To create a pull subscription from the Publisher</span></span>  
  
1.  <span data-ttu-id="abc40-121">Conecte-se ao Publicador no [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] e, em seguida, expanda o nó de servidor.</span><span class="sxs-lookup"><span data-stu-id="abc40-121">Connect to the Publisher in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], and then expand the server node.</span></span>  
  
2.  <span data-ttu-id="abc40-122">Expanda a pasta **Replicação** e, em seguida, a pasta **Publicações Locais** .</span><span class="sxs-lookup"><span data-stu-id="abc40-122">Expand the **Replication** folder, and then expand the **Local Publications** folder.</span></span>  
  
3.  <span data-ttu-id="abc40-123">Clique com o botão direito do mouse na publicação na qual você deseja criar uma ou mais assinaturas e clique em **Novas Assinaturas**.</span><span class="sxs-lookup"><span data-stu-id="abc40-123">Right-click the publication for which you want to create one or more subscriptions, and then click **New Subscriptions**.</span></span>  
  
4.  <span data-ttu-id="abc40-124">Complete as páginas no Assistente para Novas Assinaturas.</span><span class="sxs-lookup"><span data-stu-id="abc40-124">Complete the pages in the New Subscription Wizard.</span></span>  
  
#### <a name="to-create-a-pull-subscription-from-the-subscriber"></a><span data-ttu-id="abc40-125">Para criar uma assinatura pull do Assinante</span><span class="sxs-lookup"><span data-stu-id="abc40-125">To create a pull subscription from the Subscriber</span></span>  
  
1.  <span data-ttu-id="abc40-126">Conecte-se ao Assinante no [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]e expanda o nó do servidor.</span><span class="sxs-lookup"><span data-stu-id="abc40-126">Connect to the Subscriber in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], and then expand the server node.</span></span>  
  
2.  <span data-ttu-id="abc40-127">Expanda a pasta **Replicação** .</span><span class="sxs-lookup"><span data-stu-id="abc40-127">Expand the **Replication** folder.</span></span>  
  
3.  <span data-ttu-id="abc40-128">Clique com o botão direito do mouse na pasta **Assinaturas Locais** e depois clique em **Novas Assinaturas**.</span><span class="sxs-lookup"><span data-stu-id="abc40-128">Right-click the **Local Subscriptions** folder, and then click **New Subscriptions**.</span></span>  
  
4.  <span data-ttu-id="abc40-129">Na página **Publicação** do Assistente para Nova Assinatura, selecione **\<Find SQL Server Publisher>** ou **\<Find Oracle Publisher>** na lista suspensa **Editor**.</span><span class="sxs-lookup"><span data-stu-id="abc40-129">On the **Publication** page of the New Subscription Wizard, select **\<Find SQL Server Publisher>** or **\<Find Oracle Publisher>** from the **Publisher** drop-down list.</span></span>  
  
5.  <span data-ttu-id="abc40-130">Conecte-se ao Publicador na caixa de diálogo **Conectar ao Servidor** .</span><span class="sxs-lookup"><span data-stu-id="abc40-130">Connect to the Publisher in the **Connect to Server** dialog box.</span></span>  
  
6.  <span data-ttu-id="abc40-131">Selecione uma publicação na página **Publicação** .</span><span class="sxs-lookup"><span data-stu-id="abc40-131">Select a publication on the **Publication** page.</span></span>  
  
7.  <span data-ttu-id="abc40-132">Complete as páginas no Assistente para Novas Assinaturas.</span><span class="sxs-lookup"><span data-stu-id="abc40-132">Complete the pages in the New Subscription Wizard.</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="abc40-133">Usando o Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="abc40-133">Using Transact-SQL</span></span>  
 <span data-ttu-id="abc40-134">As assinaturas pull podem ser criadas de forma programada, usando os procedimentos de replicação armazenados.</span><span class="sxs-lookup"><span data-stu-id="abc40-134">Pull subscriptions can be created programmatically using replication stored procedures.</span></span> <span data-ttu-id="abc40-135">Os procedimentos armazenados usados dependem do tipo de publicação ao qual a assinatura pertence.</span><span class="sxs-lookup"><span data-stu-id="abc40-135">The stored procedures used will depend on the type of publication to which the subscription belongs.</span></span>  
  
#### <a name="to-create-a-pull-subscription-to-a-snapshot-or-transactional-publication"></a><span data-ttu-id="abc40-136">Para criar uma assinatura pull em um instantâneo ou em uma publicação transacional</span><span class="sxs-lookup"><span data-stu-id="abc40-136">To create a pull subscription to a snapshot or transactional publication</span></span>  
  
1.  <span data-ttu-id="abc40-137">No Publicador, verifique se a publicação dá suporte a assinaturas pull executando [sp_helppublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="abc40-137">At the Publisher, verify that the publication supports pull subscriptions by executing [sp_helppublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span></span>  
  
    -   <span data-ttu-id="abc40-138">Se o valor de **allow_pull** no conjunto de resultados for **1**, a publicação terá suporte para as assinaturas pull.</span><span class="sxs-lookup"><span data-stu-id="abc40-138">If the value of **allow_pull** in the result set is **1**, then the publication supports pull subscriptions.</span></span>  
  
    -   <span data-ttu-id="abc40-139">Se o valor de **allow_pull** for **0**, execute [SP_CHANGEPUBLICATION &#40;&#41;Transact-SQL ](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql), especificando **allow_pull** para **@property** e `true` para **@value** .</span><span class="sxs-lookup"><span data-stu-id="abc40-139">If the value of **allow_pull** is **0**, execute [sp_changepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql), specifying **allow_pull** for **@property** and `true` for **@value**.</span></span>  
  
2.  <span data-ttu-id="abc40-140">No Assinante, execute [sp_addpullsubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="abc40-140">At the Subscriber, execute [sp_addpullsubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-transact-sql).</span></span> <span data-ttu-id="abc40-141">Especifique **@publisher** e **@publication** .</span><span class="sxs-lookup"><span data-stu-id="abc40-141">Specify **@publisher** and **@publication**.</span></span> <span data-ttu-id="abc40-142">Para obter mais informações sobre assinaturas de atualização, consulte [Criar uma assinatura atualizável em uma publicação transacional](publish/create-an-updatable-subscription-to-a-transactional-publication.md)</span><span class="sxs-lookup"><span data-stu-id="abc40-142">For information about updating subscriptions, see [Create an Updatable Subscription to a Transactional Publication](publish/create-an-updatable-subscription-to-a-transactional-publication.md).</span></span>  
  
3.  <span data-ttu-id="abc40-143">No Assinante, execute [sp_addpullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="abc40-143">At the Subscriber, execute [sp_addpullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql).</span></span> <span data-ttu-id="abc40-144">Especifique o seguinte:</span><span class="sxs-lookup"><span data-stu-id="abc40-144">Specify the following:</span></span>  
  
    -   <span data-ttu-id="abc40-145">Os **@publisher** **@publisher_db** parâmetros, e **@publication** .</span><span class="sxs-lookup"><span data-stu-id="abc40-145">The **@publisher**, **@publisher_db**, and **@publication** parameters.</span></span>  
  
    -   <span data-ttu-id="abc40-146">As [!INCLUDE[msCoName](../../includes/msconame-md.md)] credenciais do Windows sob as quais o agente de distribuição no assinante é executado para **@job_login** e **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="abc40-146">The [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows credentials under which the Distribution Agent at the Subscriber runs for **@job_login** and **@job_password**.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="abc40-147">As conexões feitas usando a autenticação integrada do Windows sempre usam as credenciais do Windows especificadas por **@job_login** e **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="abc40-147">Connections made using Windows Integrated Authentication always use the Windows credentials specified by **@job_login** and **@job_password**.</span></span> <span data-ttu-id="abc40-148">O Distribution Agent sempre faz a conexão local ao Assinante usando a Autenticação Integrada do Windows.</span><span class="sxs-lookup"><span data-stu-id="abc40-148">The Distribution Agent always makes the local connection to the Subscriber using Windows Integrated Authentication.</span></span> <span data-ttu-id="abc40-149">Por padrão, o agente conecta-se ao Distribuidor usando a Autenticação Integrada do Windows.</span><span class="sxs-lookup"><span data-stu-id="abc40-149">By default, the agent will connect to the Distributor using Windows Integrated Authentication.</span></span>  
  
    -   <span data-ttu-id="abc40-150">(Opcional) Um valor de **0** para **@distributor_security_mode** e as informações de logon do [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] para **@distributor_login** e **@distributor_password**, se for necessário usar a Autenticação do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ao se conectar ao Distribuidor.</span><span class="sxs-lookup"><span data-stu-id="abc40-150">(Optional) A value of **0** for **@distributor_security_mode** and the [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] login information for **@distributor_login** and **@distributor_password**, if you need to use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication when connecting to the Distributor.</span></span>  
  
    -   <span data-ttu-id="abc40-151">Agenda para o trabalho do Distribution Agent para essa assinatura.</span><span class="sxs-lookup"><span data-stu-id="abc40-151">A schedule for the Distribution Agent job for this subscription.</span></span> <span data-ttu-id="abc40-152">Para obter mais informações, consulte [Specify Synchronization Schedules](specify-synchronization-schedules.md).</span><span class="sxs-lookup"><span data-stu-id="abc40-152">For more information, see [Specify Synchronization Schedules](specify-synchronization-schedules.md).</span></span>  
  
4.  <span data-ttu-id="abc40-153">No Publicador, execute [sp_addsubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql) para registrar a assinatura pull.</span><span class="sxs-lookup"><span data-stu-id="abc40-153">At the Publisher, execute [sp_addsubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql) to register the pull subscription.</span></span> <span data-ttu-id="abc40-154">Especifique **@publication** , **@subscriber** , e **@destination_db** .</span><span class="sxs-lookup"><span data-stu-id="abc40-154">Specify **@publication**, **@subscriber**, and **@destination_db**.</span></span> <span data-ttu-id="abc40-155">Especifique um valor de **pull** para **@subscription_type**.</span><span class="sxs-lookup"><span data-stu-id="abc40-155">Specify a value of **pull** for **@subscription_type**.</span></span>  
  
#### <a name="to-create-a-pull-subscription-to-a-merge-publication"></a><span data-ttu-id="abc40-156">Para criar uma assinatura pull para a publicação de mesclagem</span><span class="sxs-lookup"><span data-stu-id="abc40-156">To create a pull subscription to a merge publication</span></span>  
  
1.  <span data-ttu-id="abc40-157">No Publicador, verifique se a publicação dá suporte a assinaturas pull executando [sp_helpmergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helpmergepublication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="abc40-157">At the Publisher, verify that the publication supports pull subscriptions by executing [sp_helpmergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helpmergepublication-transact-sql).</span></span>  
  
    -   <span data-ttu-id="abc40-158">Se o valor de **allow_pull** no conjunto de resultados for **1**, a publicação terá suporte para as assinaturas pull.</span><span class="sxs-lookup"><span data-stu-id="abc40-158">If the value of **allow_pull** in the result set is **1**, then the publication supports pull subscriptions.</span></span>  
  
    -   <span data-ttu-id="abc40-159">Se o valor de **allow_pull** for **0**, execute [SP_CHANGEMERGEPUBLICATION &#40;&#41;Transact-SQL ](/sql/relational-databases/system-stored-procedures/sp-changemergepublication-transact-sql), especificando **allow_pull** para **@property** e `true` para **@value** .</span><span class="sxs-lookup"><span data-stu-id="abc40-159">If the value of **allow_pull** is **0**, execute [sp_changemergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-changemergepublication-transact-sql), specifying **allow_pull** for **@property** and `true` for **@value**.</span></span>  
  
2.  <span data-ttu-id="abc40-160">No Assinante, execute [sp_addmergepullsubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="abc40-160">At the Subscriber, execute [sp_addmergepullsubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-transact-sql).</span></span> <span data-ttu-id="abc40-161">Especifique **@publisher** , **@publisher_db** , **@publication** e os seguintes parâmetros:</span><span class="sxs-lookup"><span data-stu-id="abc40-161">Specify **@publisher**, **@publisher_db**, **@publication**, and the following parameters:</span></span>  
  
    -   <span data-ttu-id="abc40-162">**@subscriber_type**-Especifique **local** para uma assinatura de cliente e **global** para uma assinatura de servidor.</span><span class="sxs-lookup"><span data-stu-id="abc40-162">**@subscriber_type** - specify **local** for a client subscription and **global** for a server subscription.</span></span>  
  
    -   <span data-ttu-id="abc40-163">**@subscription_priority**-Especifique uma prioridade para a assinatura (**0, 0** a **99,99**).</span><span class="sxs-lookup"><span data-stu-id="abc40-163">**@subscription_priority** - Specify a priority for the subscription (**0.00** to **99.99**).</span></span> <span data-ttu-id="abc40-164">Isso só é necessário para uma assinatura de servidor.</span><span class="sxs-lookup"><span data-stu-id="abc40-164">This is only required for a server subscription.</span></span>  
  
         <span data-ttu-id="abc40-165">Para obter mais informações, consulte [Replicação de mesclagem avançada – detecção e resolução de conflito](merge/advanced-merge-replication-conflict-detection-and-resolution.md).</span><span class="sxs-lookup"><span data-stu-id="abc40-165">For more information, see [Advanced Merge Replication Conflict Detection and Resolution](merge/advanced-merge-replication-conflict-detection-and-resolution.md).</span></span>  
  
3.  <span data-ttu-id="abc40-166">No Assinante, execute [sp_addmergepullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="abc40-166">At the Subscriber, execute [sp_addmergepullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql).</span></span> <span data-ttu-id="abc40-167">Especifique os seguintes parâmetros:</span><span class="sxs-lookup"><span data-stu-id="abc40-167">Specify the following parameters:</span></span>  
  
    -   <span data-ttu-id="abc40-168">**@publisher**, **@publisher_db** e **@publication** .</span><span class="sxs-lookup"><span data-stu-id="abc40-168">**@publisher**, **@publisher_db**, and **@publication**.</span></span>  
  
    -   <span data-ttu-id="abc40-169">As credenciais do Windows sob as quais o Agente de Mesclagem no assinante é executado para **@job_login** e **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="abc40-169">The Windows credentials under which the Merge Agent at the Subscriber runs for **@job_login** and **@job_password**.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="abc40-170">As conexões feitas usando a autenticação integrada do Windows sempre usam as credenciais do Windows especificadas por **@job_login** e **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="abc40-170">Connections made using Windows Integrated Authentication always use the Windows credentials specified by **@job_login** and **@job_password**.</span></span> <span data-ttu-id="abc40-171">O Merge Agent sempre faz a conexão local ao Assinante usando a Autenticação Integrada do Windows.</span><span class="sxs-lookup"><span data-stu-id="abc40-171">The Merge Agent always makes the local connection to the Subscriber using Windows Integrated Authentication.</span></span> <span data-ttu-id="abc40-172">Por padrão, o agente se conecta ao Distribuidor e ao Publicador usando a Autenticação Integrada do Windows.</span><span class="sxs-lookup"><span data-stu-id="abc40-172">By default, the agent will connect to the Distributor and Publisher using Windows Integrated Authentication.</span></span>  
  
    -   <span data-ttu-id="abc40-173">(Opcional) Um valor de **0** para **@distributor_security_mode** e as informações de logon do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] para **@distributor_login** e **@distributor_password**, se for necessário usar a Autenticação do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ao se conectar ao Distribuidor.</span><span class="sxs-lookup"><span data-stu-id="abc40-173">(Optional) A value of **0** for **@distributor_security_mode** and the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] login information for **@distributor_login** and **@distributor_password**, if you need to use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication when connecting to the Distributor.</span></span>  
  
    -   <span data-ttu-id="abc40-174">(Opcional) Um valor de **0** para **@publisher_security_mode** e as informações de logon do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] para **@publisher_login** e **@publisher_password**, se for necessário usar a Autenticação do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ao conectar-se ao Publicador.</span><span class="sxs-lookup"><span data-stu-id="abc40-174">(Optional) A value of **0** for **@publisher_security_mode** and the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] login information for **@publisher_login** and **@publisher_password**, if you need to use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication when connecting to the Publisher.</span></span>  
  
    -   <span data-ttu-id="abc40-175">Agenda para o trabalho do Merge Agent para essa assinatura.</span><span class="sxs-lookup"><span data-stu-id="abc40-175">A schedule for the Merge Agent job for this subscription.</span></span> <span data-ttu-id="abc40-176">Para obter mais informações, consulte [Criar uma assinatura atualizável em uma publicação transacional](publish/create-an-updatable-subscription-to-a-transactional-publication.md)</span><span class="sxs-lookup"><span data-stu-id="abc40-176">For more information, see [Create an Updatable Subscription to a Transactional Publication](publish/create-an-updatable-subscription-to-a-transactional-publication.md).</span></span>  
  
4.  <span data-ttu-id="abc40-177">No Publicador, execute [sp_addmergesubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="abc40-177">At the Publisher, execute [sp_addmergesubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql).</span></span> <span data-ttu-id="abc40-178">Especifique **@publication** , **@subscriber** , e **@subscriber_db** um valor de **pull** para **@subscription_type** .</span><span class="sxs-lookup"><span data-stu-id="abc40-178">Specify **@publication**, **@subscriber**, **@subscriber_db**, and a value of **pull** for **@subscription_type**.</span></span> <span data-ttu-id="abc40-179">Isso registra a assinatura pull.</span><span class="sxs-lookup"><span data-stu-id="abc40-179">This registers the pull subscription.</span></span>  
  
###  <a name="examples-transact-sql"></a><a name="TsqlExample"></a> <span data-ttu-id="abc40-180">Exemplos (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="abc40-180">Examples (Transact-SQL)</span></span>  
 <span data-ttu-id="abc40-181">O exemplo a seguir cria uma nova assinatura pull para uma publicação transacional.</span><span class="sxs-lookup"><span data-stu-id="abc40-181">The following example creates a pull subscription to a transactional publication.</span></span> <span data-ttu-id="abc40-182">O primeiro lote é executado no Assinante, e o segundo lote é executado no Publicador.</span><span class="sxs-lookup"><span data-stu-id="abc40-182">The first batch is executed at the Subscriber, and the second batch is executed at the Publisher.</span></span> <span data-ttu-id="abc40-183">Os valores para o logon e senha são fornecidos no runtime usando as variáveis sqlcmd scripting.</span><span class="sxs-lookup"><span data-stu-id="abc40-183">Login and password values are supplied at runtime using sqlcmd scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_addtranpullsubscriptionagent](../../snippets/tsql/SQL15/replication/howto/tsql/createtranpullsub.sql#sp_addtranpullsubscriptionagent)]  
  
 [!code-sql[HowTo#sp_addtranpullsubscription](../../snippets/tsql/SQL15/replication/howto/tsql/createtranpullsub.sql#sp_addtranpullsubscription)]  
  
 <span data-ttu-id="abc40-184">O exemplo a seguir cria uma nova assinatura pull para uma publicação de mesclagem.</span><span class="sxs-lookup"><span data-stu-id="abc40-184">The following example creates a pull subscription to a merge publication.</span></span> <span data-ttu-id="abc40-185">O primeiro lote é executado no Assinante, e o segundo lote é executado no Publicador.</span><span class="sxs-lookup"><span data-stu-id="abc40-185">The first batch is executed at the Subscriber, and the second batch is executed at the Publisher.</span></span> <span data-ttu-id="abc40-186">Os valores de logon e senha são fornecidos em runtime através das variáveis de script **sqlcmd** .</span><span class="sxs-lookup"><span data-stu-id="abc40-186">Login and password values are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_addmergepullsubscriptionagent](../../snippets/tsql/SQL15/replication/howto/tsql/createmergepullsub.sql#sp_addmergepullsubscriptionagent)]  
  
 [!code-sql[HowTo#sp_addmergepullsubscription](../../snippets/tsql/SQL15/replication/howto/tsql/createmergepullsub.sql#sp_addmergepullsubscription)]  
  
##  <a name="using-replication-management-objects-rmo"></a><a name="RMOProcedure"></a> <span data-ttu-id="abc40-187">Usando o RMO (Replication Management Objects)</span><span class="sxs-lookup"><span data-stu-id="abc40-187">Using Replication Management Objects (RMO)</span></span>  
 <span data-ttu-id="abc40-188">As classes RMO usadas para criar uma assinatura pull dependem do tipo de publicação ao qual a assinatura pertence.</span><span class="sxs-lookup"><span data-stu-id="abc40-188">The RMO classes used to create a pull subscription depend on the type of publication to which the subscription belongs.</span></span>  
  
#### <a name="to-create-a-pull-subscription-to-a-snapshot-or-transactional-publication"></a><span data-ttu-id="abc40-189">Para criar uma assinatura pull em um instantâneo ou em uma publicação transacional</span><span class="sxs-lookup"><span data-stu-id="abc40-189">To create a pull subscription to a snapshot or transactional publication</span></span>  
  
1.  <span data-ttu-id="abc40-190">Crie conexões para o Assinante e Publicador, usando a classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="abc40-190">Create connections to both the Subscriber and Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> Class.</span></span>  
  
2.  <span data-ttu-id="abc40-191">Crie uma instância da classe <xref:Microsoft.SqlServer.Replication.TransPublication> usando a conexão com o Publicador da etapa 1.</span><span class="sxs-lookup"><span data-stu-id="abc40-191">Create an instance of the <xref:Microsoft.SqlServer.Replication.TransPublication> class by using the Publisher connection from step 1.</span></span> <span data-ttu-id="abc40-192">Especifique <xref:Microsoft.SqlServer.Replication.Publication.Name%2A>, <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> e <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span><span class="sxs-lookup"><span data-stu-id="abc40-192">Specify <xref:Microsoft.SqlServer.Replication.Publication.Name%2A>, <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> and <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
3.  <span data-ttu-id="abc40-193">Chame o método <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> .</span><span class="sxs-lookup"><span data-stu-id="abc40-193">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method.</span></span> <span data-ttu-id="abc40-194">Se esse método retornar `false`, as propriedades especificadas na etapa 2 estarão incorretas ou a publicação não existe no servidor.</span><span class="sxs-lookup"><span data-stu-id="abc40-194">If this method returns `false`, either the properties specified in step 2 are incorrect or the publication does not exist on the server.</span></span>  
  
4.  <span data-ttu-id="abc40-195">Realize uma lógica AND de bit a bit (`&` no Visual C# e `And` no Visual Basic) entre a propriedade <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> e <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPull>.</span><span class="sxs-lookup"><span data-stu-id="abc40-195">Perform a bitwise logical AND (`&` in Visual C# and `And` in Visual Basic) between the <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> property and <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPull>.</span></span> <span data-ttu-id="abc40-196">Se o resultado for <xref:Microsoft.SqlServer.Replication.PublicationAttributes.None>, defina <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> para o resultado de uma lógica bit a bit OR (`|` em Visual C# e `Or` em Visual Basic) entre <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> e <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPull>.</span><span class="sxs-lookup"><span data-stu-id="abc40-196">If the result is <xref:Microsoft.SqlServer.Replication.PublicationAttributes.None>, set <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> to the result of a bitwise logical OR (`|` in Visual C# and `Or` in Visual Basic) between <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> and <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPull>.</span></span> <span data-ttu-id="abc40-197">Em seguida, chame <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> para habilitar assinaturas pull.</span><span class="sxs-lookup"><span data-stu-id="abc40-197">Then, call <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> to enable pull subscriptions.</span></span>  
  
5.  <span data-ttu-id="abc40-198">Se não houver banco de dados de assinatura, crie-o usando a classe <xref:Microsoft.SqlServer.Management.Smo.Database> .</span><span class="sxs-lookup"><span data-stu-id="abc40-198">If the subscription database does not exist, create it by using the <xref:Microsoft.SqlServer.Management.Smo.Database> class.</span></span> <span data-ttu-id="abc40-199">Para obter mais informações, consulte [Creating, Altering, and Removing Databases](../server-management-objects-smo/tasks/creating-altering-and-removing-databases.md) (Criando, alterando e removendo bancos de dados).</span><span class="sxs-lookup"><span data-stu-id="abc40-199">For more information, see [Creating, Altering, and Removing Databases](../server-management-objects-smo/tasks/creating-altering-and-removing-databases.md).</span></span>  
  
6.  <span data-ttu-id="abc40-200">Criar uma instância da classe <xref:Microsoft.SqlServer.Replication.TransPullSubscription>.</span><span class="sxs-lookup"><span data-stu-id="abc40-200">Create an instance of the <xref:Microsoft.SqlServer.Replication.TransPullSubscription> class.</span></span>  
  
7.  <span data-ttu-id="abc40-201">Defina as seguintes propriedades de assinatura:</span><span class="sxs-lookup"><span data-stu-id="abc40-201">Set the following subscription properties:</span></span>  
  
    -   <span data-ttu-id="abc40-202">O <xref:Microsoft.SqlServer.Management.Common.ServerConnection> para o Assinante criado na etapa 1 para <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span><span class="sxs-lookup"><span data-stu-id="abc40-202">The <xref:Microsoft.SqlServer.Management.Common.ServerConnection> to the Subscriber created in step 1 for <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
    -   <span data-ttu-id="abc40-203">Nome do banco de dados de assinatura para <xref:Microsoft.SqlServer.Replication.PullSubscription.DatabaseName%2A>.</span><span class="sxs-lookup"><span data-stu-id="abc40-203">Name of the subscription database for <xref:Microsoft.SqlServer.Replication.PullSubscription.DatabaseName%2A>.</span></span>  
  
    -   <span data-ttu-id="abc40-204">Nome do Publicador para <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherName%2A>.</span><span class="sxs-lookup"><span data-stu-id="abc40-204">Name of the Publisher for <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherName%2A>.</span></span>  
  
    -   <span data-ttu-id="abc40-205">Nome do banco de dados de publicação para <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationDBName%2A>.</span><span class="sxs-lookup"><span data-stu-id="abc40-205">Name of the publication database for <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationDBName%2A>.</span></span>  
  
    -   <span data-ttu-id="abc40-206">Nome da publicação para <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationName%2A>.</span><span class="sxs-lookup"><span data-stu-id="abc40-206">Name of the publication for <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationName%2A>.</span></span>  
  
    -   <span data-ttu-id="abc40-207">Os campos <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> e <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> ou <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.SecurePassword%2A> de <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A> para fornecer as credenciais para a conta do Windows [!INCLUDE[msCoName](../../includes/msconame-md.md)] em que o Distribution Agent é executado no Assinante.</span><span class="sxs-lookup"><span data-stu-id="abc40-207">The <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> and <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> or <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.SecurePassword%2A> fields of <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A> to provide the credentials for the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows account under which the Distribution Agent runs at the Subscriber.</span></span> <span data-ttu-id="abc40-208">Essa conta é usada para fazer conexões locais com o Assinante e para fazer conexões remotas que usam a Autenticação do Windows.</span><span class="sxs-lookup"><span data-stu-id="abc40-208">This account is used to make local connections to the Subscriber and to make remote connections using Windows Authentication.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="abc40-209">Não é necessário definir <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A> quando a assinatura for criada por um membro da função de servidor fixa `sysadmin`; no entanto, é recomendado.</span><span class="sxs-lookup"><span data-stu-id="abc40-209">Setting <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A> is not required when the subscription is created by a member of the `sysadmin` fixed server role, however it is recommended.</span></span> <span data-ttu-id="abc40-210">Nesse caso, o agente representará a conta do SQL Server Agent.</span><span class="sxs-lookup"><span data-stu-id="abc40-210">In this case, the agent will impersonate the SQL Server Agent account.</span></span> <span data-ttu-id="abc40-211">Para obter mais informações, consulte [Replication Agent Security Model](security/replication-agent-security-model.md).</span><span class="sxs-lookup"><span data-stu-id="abc40-211">For more information, see [Replication Agent Security Model](security/replication-agent-security-model.md).</span></span>  
  
    -   <span data-ttu-id="abc40-212">(Opcional) Um valor de `true` para <xref:Microsoft.SqlServer.Replication.PullSubscription.CreateSyncAgentByDefault%2A> para criar um trabalho de agente que seja usado para sincronizar a assinatura.</span><span class="sxs-lookup"><span data-stu-id="abc40-212">(Optional) A value of `true` for <xref:Microsoft.SqlServer.Replication.PullSubscription.CreateSyncAgentByDefault%2A> to create an agent job that is used to synchronize the subscription.</span></span> <span data-ttu-id="abc40-213">Se você especificar `false` (o padrão), a assinatura pode ser sincronizada apenas de forma programada e é preciso especificar propriedades adicionais para <xref:Microsoft.SqlServer.Replication.TransSynchronizationAgent> ao acessar esse objeto da propriedade <xref:Microsoft.SqlServer.Replication.TransPullSubscription.SynchronizationAgent%2A>.</span><span class="sxs-lookup"><span data-stu-id="abc40-213">If you specify `false` (the default), the subscription can only be synchronized programmatically and you must specify additional properties of <xref:Microsoft.SqlServer.Replication.TransSynchronizationAgent> when you access this object from the <xref:Microsoft.SqlServer.Replication.TransPullSubscription.SynchronizationAgent%2A> property.</span></span> <span data-ttu-id="abc40-214">Para obter mais informações, consulte [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="abc40-214">For more information, see [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="abc40-215">O SQL Server Agent não está disponível em todas as edições do [!INCLUDE[msCoName](../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="abc40-215">SQL Server Agent is not available in every edition of [!INCLUDE[msCoName](../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="abc40-216">Para obter uma lista de recursos com suporte nas edições do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], consulte [Features Supported by the Editions of SQL Server 2014](../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md).</span><span class="sxs-lookup"><span data-stu-id="abc40-216">For a list of features that are supported by the editions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], see [Features Supported by the Editions of SQL Server 2014](../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md).</span></span> <span data-ttu-id="abc40-217">Quando você especifica um valor de `true` para Assinantes do Express, o trabalho de agente não é criado.</span><span class="sxs-lookup"><span data-stu-id="abc40-217">When you specify a value of `true` for Express Subscribers, the agent job is not created.</span></span> <span data-ttu-id="abc40-218">Porém, importantes metadados relacionados a assinatura são armazenados no Assinante.</span><span class="sxs-lookup"><span data-stu-id="abc40-218">However, important subscription-related metadata is stored at the Subscriber.</span></span>  
  
    -   <span data-ttu-id="abc40-219">(Opcional) Defina os campos <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> e <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> ou <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> de <xref:Microsoft.SqlServer.Replication.PullSubscription.DistributorSecurity%2A> ao usar a Autenticação do SQL Server para conexão com o Distribuidor.</span><span class="sxs-lookup"><span data-stu-id="abc40-219">(Optional) Set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> or <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> fields of <xref:Microsoft.SqlServer.Replication.PullSubscription.DistributorSecurity%2A> when using SQL Server Authentication to connect to the Distributor.</span></span>  
  
8.  <span data-ttu-id="abc40-220">Chame o método <xref:Microsoft.SqlServer.Replication.PullSubscription.Create%2A> .</span><span class="sxs-lookup"><span data-stu-id="abc40-220">Call the <xref:Microsoft.SqlServer.Replication.PullSubscription.Create%2A> method.</span></span>  
  
9. <span data-ttu-id="abc40-221">Crie uma instância da classe <xref:Microsoft.SqlServer.Replication.TransPublication> da etapa 2, chame o método <xref:Microsoft.SqlServer.Replication.TransPublication.MakePullSubscriptionWellKnown%2A> para registrar a assinatura pull com o Publicador.</span><span class="sxs-lookup"><span data-stu-id="abc40-221">Using the instance of the <xref:Microsoft.SqlServer.Replication.TransPublication> class from step 2, call the <xref:Microsoft.SqlServer.Replication.TransPublication.MakePullSubscriptionWellKnown%2A> method to register the pull subscription with the Publisher.</span></span> <span data-ttu-id="abc40-222">Se esse registro já existir, haverá uma exceção.</span><span class="sxs-lookup"><span data-stu-id="abc40-222">If this registration already exists, an exception occurs.</span></span>  
  
#### <a name="to-create-a-pull-subscription-to-a-merge-publication"></a><span data-ttu-id="abc40-223">Para criar uma assinatura pull para a publicação de mesclagem</span><span class="sxs-lookup"><span data-stu-id="abc40-223">To create a pull subscription to a merge publication</span></span>  
  
1.  <span data-ttu-id="abc40-224">Crie conexões para o Assinante e o Publicador usando a classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="abc40-224">Create connections to both the Subscriber and Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="abc40-225">Crie uma instância da classe <xref:Microsoft.SqlServer.Replication.MergePublication> usando a conexão com o Publicador da etapa 1.</span><span class="sxs-lookup"><span data-stu-id="abc40-225">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergePublication> class by using the Publisher connection from step 1.</span></span> <span data-ttu-id="abc40-226">Especifique <xref:Microsoft.SqlServer.Replication.Publication.Name%2A>, <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A>, e <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span><span class="sxs-lookup"><span data-stu-id="abc40-226">Specify <xref:Microsoft.SqlServer.Replication.Publication.Name%2A>, <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A>, and <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
3.  <span data-ttu-id="abc40-227">Chame o método <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> .</span><span class="sxs-lookup"><span data-stu-id="abc40-227">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method.</span></span> <span data-ttu-id="abc40-228">Se esse método retornar `false`, as propriedades especificadas na etapa 2 estarão incorretas ou a publicação não existe no servidor.</span><span class="sxs-lookup"><span data-stu-id="abc40-228">If this method returns `false`, either the properties specified in step 2 are incorrect or the publication does not exist on the server.</span></span>  
  
4.  <span data-ttu-id="abc40-229">Realize uma lógica AND de bit a bit (`&` no Visual C# e `And` no Visual Basic) entre a propriedade <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> e <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPull>.</span><span class="sxs-lookup"><span data-stu-id="abc40-229">Perform a bitwise logical AND (`&` in Visual C# and `And` in Visual Basic) between the <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> property and <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPull>.</span></span> <span data-ttu-id="abc40-230">Se o resultado for <xref:Microsoft.SqlServer.Replication.PublicationAttributes.None>, defina <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> para o resultado de uma lógica bit a bit OR (`|` em Visual C# e `Or` em Visual Basic) entre <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> e <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPull>.</span><span class="sxs-lookup"><span data-stu-id="abc40-230">If the result is <xref:Microsoft.SqlServer.Replication.PublicationAttributes.None>, set <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> to the result of a bitwise logical OR (`|` in Visual C# and `Or` in Visual Basic) between <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> and <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPull>.</span></span> <span data-ttu-id="abc40-231">Em seguida, chame <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> para habilitar assinaturas pull.</span><span class="sxs-lookup"><span data-stu-id="abc40-231">Then, call <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> to enable pull subscriptions.</span></span>  
  
5.  <span data-ttu-id="abc40-232">Se não houver banco de dados de assinatura, crie-o usando a classe <xref:Microsoft.SqlServer.Management.Smo.Database> .</span><span class="sxs-lookup"><span data-stu-id="abc40-232">If the subscription database does not exist, create it by using the <xref:Microsoft.SqlServer.Management.Smo.Database> class.</span></span> <span data-ttu-id="abc40-233">Para obter mais informações, consulte [Creating, Altering, and Removing Databases](../server-management-objects-smo/tasks/creating-altering-and-removing-databases.md) (Criando, alterando e removendo bancos de dados).</span><span class="sxs-lookup"><span data-stu-id="abc40-233">For more information, see [Creating, Altering, and Removing Databases](../server-management-objects-smo/tasks/creating-altering-and-removing-databases.md).</span></span>  
  
6.  <span data-ttu-id="abc40-234">Criar uma instância da classe <xref:Microsoft.SqlServer.Replication.MergePullSubscription>.</span><span class="sxs-lookup"><span data-stu-id="abc40-234">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergePullSubscription> class.</span></span>  
  
7.  <span data-ttu-id="abc40-235">Defina as seguintes propriedades de assinatura:</span><span class="sxs-lookup"><span data-stu-id="abc40-235">Set the following subscription properties:</span></span>  
  
    -   <span data-ttu-id="abc40-236">O <xref:Microsoft.SqlServer.Management.Common.ServerConnection> para o Assinante criado na etapa 1 para <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span><span class="sxs-lookup"><span data-stu-id="abc40-236">The <xref:Microsoft.SqlServer.Management.Common.ServerConnection> to the Subscriber created in step 1 for <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
    -   <span data-ttu-id="abc40-237">Nome do banco de dados de assinatura para <xref:Microsoft.SqlServer.Replication.PullSubscription.DatabaseName%2A>.</span><span class="sxs-lookup"><span data-stu-id="abc40-237">Name of the subscription database for <xref:Microsoft.SqlServer.Replication.PullSubscription.DatabaseName%2A>.</span></span>  
  
    -   <span data-ttu-id="abc40-238">Nome do Publicador para <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherName%2A>.</span><span class="sxs-lookup"><span data-stu-id="abc40-238">Name of the Publisher for <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherName%2A>.</span></span>  
  
    -   <span data-ttu-id="abc40-239">Nome do banco de dados de publicação para <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationDBName%2A>.</span><span class="sxs-lookup"><span data-stu-id="abc40-239">Name of the publication database for <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationDBName%2A>.</span></span>  
  
    -   <span data-ttu-id="abc40-240">Nome da publicação para <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationName%2A>.</span><span class="sxs-lookup"><span data-stu-id="abc40-240">Name of the publication for <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationName%2A>.</span></span>  
  
    -   <span data-ttu-id="abc40-241">Os campos <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> e <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> ou <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.SecurePassword%2A> de <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A> para fornecer as credenciais para a conta do Windows [!INCLUDE[msCoName](../../includes/msconame-md.md)] na qual o Merge Agent é executado no Assinante.</span><span class="sxs-lookup"><span data-stu-id="abc40-241">The <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> and <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> or <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.SecurePassword%2A> fields of <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A> to provide the credentials for the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows account under which the Merge Agent runs at the Subscriber.</span></span> <span data-ttu-id="abc40-242">Essa conta é usada para fazer conexões locais com o Assinante e para fazer conexões remotas que usam a Autenticação do Windows.</span><span class="sxs-lookup"><span data-stu-id="abc40-242">This account is used to make local connections to the Subscriber and to make remote connections using Windows Authentication.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="abc40-243">Não é necessário definir <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A> quando a assinatura for criada por um membro da função de servidor fixa `sysadmin`; no entanto, é recomendado.</span><span class="sxs-lookup"><span data-stu-id="abc40-243">Setting <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A> is not required when the subscription is created by a member of the `sysadmin` fixed server role, however it is recommended.</span></span> <span data-ttu-id="abc40-244">Nesse caso, o agente representará a conta do SQL Server Agent.</span><span class="sxs-lookup"><span data-stu-id="abc40-244">In this case, the agent will impersonate the SQL Server Agent account.</span></span> <span data-ttu-id="abc40-245">Para obter mais informações, consulte [Replication Agent Security Model](security/replication-agent-security-model.md).</span><span class="sxs-lookup"><span data-stu-id="abc40-245">For more information, see [Replication Agent Security Model](security/replication-agent-security-model.md).</span></span>  
  
    -   <span data-ttu-id="abc40-246">(Opcional) Um valor de `true` para <xref:Microsoft.SqlServer.Replication.PullSubscription.CreateSyncAgentByDefault%2A> para criar um trabalho de agente que seja usado para sincronizar a assinatura.</span><span class="sxs-lookup"><span data-stu-id="abc40-246">(Optional) A value of `true` for <xref:Microsoft.SqlServer.Replication.PullSubscription.CreateSyncAgentByDefault%2A> to create an agent job that is used to synchronize the subscription.</span></span> <span data-ttu-id="abc40-247">Se você especificar `false` (o padrão), a assinatura pode ser sincronizada apenas de forma programada e é preciso especificar propriedades adicionais para <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent> ao acessar esse objeto da propriedade <xref:Microsoft.SqlServer.Replication.MergePullSubscription.SynchronizationAgent%2A>.</span><span class="sxs-lookup"><span data-stu-id="abc40-247">If you specify `false` (the default), the subscription can only be synchronized programmatically and you must specify additional properties of <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent> when you access this object from the <xref:Microsoft.SqlServer.Replication.MergePullSubscription.SynchronizationAgent%2A> property.</span></span> <span data-ttu-id="abc40-248">Para obter mais informações, consulte [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="abc40-248">For more information, see [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span></span>  
  
    -   <span data-ttu-id="abc40-249">(Opcional) Defina os campos <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> e <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> ou <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> de <xref:Microsoft.SqlServer.Replication.PullSubscription.DistributorSecurity%2A> ao usar a Autenticação do SQL Server para conexão com o Distribuidor.</span><span class="sxs-lookup"><span data-stu-id="abc40-249">(Optional) Set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> or <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> fields of <xref:Microsoft.SqlServer.Replication.PullSubscription.DistributorSecurity%2A> when using SQL Server Authentication to connect to the Distributor.</span></span>  
  
    -   <span data-ttu-id="abc40-250">(Opcional) Defina os campos <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> e <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> ou <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> de <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherSecurity%2A> ao usar a Autenticação do SQL Server para conexão com o Publicador.</span><span class="sxs-lookup"><span data-stu-id="abc40-250">(Optional) Set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> or <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> fields of <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherSecurity%2A> when using SQL Server Authentication to connect to the Publisher.</span></span>  
  
8.  <span data-ttu-id="abc40-251">Chame o método <xref:Microsoft.SqlServer.Replication.PullSubscription.Create%2A> .</span><span class="sxs-lookup"><span data-stu-id="abc40-251">Call the <xref:Microsoft.SqlServer.Replication.PullSubscription.Create%2A> method.</span></span>  
  
9. <span data-ttu-id="abc40-252">Crie uma instância da classe <xref:Microsoft.SqlServer.Replication.MergePublication> da etapa 2, chame o método <xref:Microsoft.SqlServer.Replication.MergePublication.MakePullSubscriptionWellKnown%2A> para registrar a assinatura pull com o Publicador.</span><span class="sxs-lookup"><span data-stu-id="abc40-252">Using the instance of the <xref:Microsoft.SqlServer.Replication.MergePublication> class from step 2, call the <xref:Microsoft.SqlServer.Replication.MergePublication.MakePullSubscriptionWellKnown%2A> method to register the pull subscription with the Publisher.</span></span> <span data-ttu-id="abc40-253">Se esse registro já existir, haverá uma exceção.</span><span class="sxs-lookup"><span data-stu-id="abc40-253">If this registration already exists, an exception occurs.</span></span>  
  
###  <a name="example-rmo"></a><a name="PShellExample"></a> <span data-ttu-id="abc40-254">Exemplo (RMO)</span><span class="sxs-lookup"><span data-stu-id="abc40-254">Example (RMO)</span></span>  
 <span data-ttu-id="abc40-255">Esse exemplo cria uma assinatura pull para uma publicação transacional.</span><span class="sxs-lookup"><span data-stu-id="abc40-255">This example creates a pull subscription to a transactional publication.</span></span> <span data-ttu-id="abc40-256">As credenciais da conta do Windows [!INCLUDE[msCoName](../../includes/msconame-md.md)] usadas para criar o trabalho do Distribution Agent são passadas em runtime.</span><span class="sxs-lookup"><span data-stu-id="abc40-256">The [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows account credentials used to create the Distribution Agent job are passed at runtime.</span></span>  
  
 [!code-csharp[HowTo#rmo_CreateTranPullSub](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_createtranpullsub)]  
  
 [!code-vb[HowTo#rmo_vb_CreateTranPullSub](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_createtranpullsub)]  
  
 <span data-ttu-id="abc40-257">Esse exemplo cria uma assinatura pull para uma publicação de mesclagem.</span><span class="sxs-lookup"><span data-stu-id="abc40-257">This example creates a pull subscription to a merge publication.</span></span> <span data-ttu-id="abc40-258">As credenciais da conta do Windows usadas para criar o trabalho do Agente de Mesclagem são passadas em runtime.</span><span class="sxs-lookup"><span data-stu-id="abc40-258">The Windows account credentials used to create the Merge Agent job are passed at runtime.</span></span>  
  
 [!code-csharp[HowTo#rmo_CreateMergePullSub](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_createmergepullsub)]  
  
 [!code-vb[HowTo#rmo_vb_CreateMergePullSub](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_createmergepullsub)]  
  
 <span data-ttu-id="abc40-259">Esse exemplo cria uma assinatura pull para uma publicação de mesclagem, sem criar um trabalho de agente associado e metadados de assinatura em [MSsubscription_properties](/sql/relational-databases/system-tables/mssubscription-properties-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="abc40-259">This example creates a pull subscription to a merge publication without creating an associated agent job and subscription metadata in [MSsubscription_properties](/sql/relational-databases/system-tables/mssubscription-properties-transact-sql).</span></span> <span data-ttu-id="abc40-260">As credenciais da conta do Windows usadas para criar o trabalho do Agente de Mesclagem são passadas em runtime.</span><span class="sxs-lookup"><span data-stu-id="abc40-260">The Windows account credentials used to create the Merge Agent job are passed at runtime.</span></span>  
  
 [!code-csharp[HowTo#rmo_CreateMergePullSub_NoJob](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_createmergepullsub_nojob)]  
  
 [!code-vb[HowTo#rmo_vb_CreateMergePullSub_NoJob](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_createmergepullsub_nojob)]  
  
 <span data-ttu-id="abc40-261">Esse exemplo cria uma assinatura pull para uma publicação de mesclagem que pode ser sincronizada pela Internet usando-se sincronização da Web.</span><span class="sxs-lookup"><span data-stu-id="abc40-261">This example creates a pull subscription to a merge publication that can be synchronized over the Internet using Web synchronization.</span></span> <span data-ttu-id="abc40-262">As credenciais da conta do Windows usadas para criar o trabalho do Agente de Mesclagem são passadas em runtime.</span><span class="sxs-lookup"><span data-stu-id="abc40-262">The Windows account credentials used to create the Merge Agent job are passed at runtime.</span></span> <span data-ttu-id="abc40-263">Para obter mais informações, consulte [Configurar sincronização da Web](configure-web-synchronization.md).</span><span class="sxs-lookup"><span data-stu-id="abc40-263">For more information, see [Configure Web Synchronization](configure-web-synchronization.md).</span></span>  
  
 [!code-csharp[HowTo#rmo_CreateMergePullSub_WebSync](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_createmergepullsub_websync)]  
  
 [!code-vb[HowTo#rmo_vb_CreateMergePullSub_WebSync](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_createmergepullsub_websync)]  
  
## <a name="see-also"></a><span data-ttu-id="abc40-264">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="abc40-264">See Also</span></span>  
 <span data-ttu-id="abc40-265">[Replication Management Objects Concepts](concepts/replication-management-objects-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="abc40-265">[Replication Management Objects Concepts](concepts/replication-management-objects-concepts.md) </span></span>  
 <span data-ttu-id="abc40-266">[Exibir e modificar propriedades de assinatura pull](view-and-modify-pull-subscription-properties.md) </span><span class="sxs-lookup"><span data-stu-id="abc40-266">[View and Modify Pull Subscription Properties](view-and-modify-pull-subscription-properties.md) </span></span>  
 <span data-ttu-id="abc40-267">[Configure Web Synchronization](configure-web-synchronization.md) </span><span class="sxs-lookup"><span data-stu-id="abc40-267">[Configure Web Synchronization](configure-web-synchronization.md) </span></span>  
 <span data-ttu-id="abc40-268">[Subscribe to Publications](subscribe-to-publications.md) </span><span class="sxs-lookup"><span data-stu-id="abc40-268">[Subscribe to Publications](subscribe-to-publications.md) </span></span>  
 [<span data-ttu-id="abc40-269">Replication Security Best Practices</span><span class="sxs-lookup"><span data-stu-id="abc40-269">Replication Security Best Practices</span></span>](security/replication-security-best-practices.md)  
  
  
