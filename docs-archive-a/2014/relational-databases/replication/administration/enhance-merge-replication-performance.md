---
title: Aprimorar o desempenho de replicação de mesclagem | Microsoft Docs
ms.custom: ''
ms.date: 03/08/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- publications [SQL Server replication], design and performance
- designing databases [SQL Server], replication performance
- Merge Agent, performance
- snapshots [SQL Server replication], performance considerations
- merge replication performance [SQL Server replication]
- subscriptions [SQL Server replication], performance considerations
- performance [SQL Server replication], merge replication
- agents [SQL Server replication], performance
ms.assetid: f929226f-b83d-4900-a07c-a62f64527c7f
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 41dc258e9b45e9839ad142e73cb145999d02986c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87685586"
---
# <a name="enhance-merge-replication-performance"></a><span data-ttu-id="aa559-102">Aprimorar o desempenho de replicação de mesclagem</span><span class="sxs-lookup"><span data-stu-id="aa559-102">Enhance Merge Replication Performance</span></span>
  <span data-ttu-id="aa559-103">Após considerar as dicas para o desempenho geral descritas em [Aprimorando o Desempenho Geral da Replicação](enhance-general-replication-performance.md), considere estas áreas adicionais específicas da replicação de mesclagem.</span><span class="sxs-lookup"><span data-stu-id="aa559-103">After considering the general performance tips described in [Enhancing General Replication Performance](enhance-general-replication-performance.md), consider these additional areas specific to merge replication.</span></span>  
  
## <a name="database-design"></a><span data-ttu-id="aa559-104">Design de banco de dados</span><span class="sxs-lookup"><span data-stu-id="aa559-104">Database Design</span></span>  
  
-   <span data-ttu-id="aa559-105">Colunas de índice usadas em filtros de linha e filtros de junção.</span><span class="sxs-lookup"><span data-stu-id="aa559-105">Index columns used in row filters and join filters.</span></span>  
  
     <span data-ttu-id="aa559-106">Quando usar um filtro de linha em um artigo publicado, crie um índice em cada uma das colunas usadas na cláusula WHERE do filtro.</span><span class="sxs-lookup"><span data-stu-id="aa559-106">When you use a row filter on a published article, create an index on each of the columns that is used in the filter's WHERE clause.</span></span> <span data-ttu-id="aa559-107">Sem um índice, o [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] precisa ler cada linha da tabela para determinar se a linha deve ser incluída na partição.</span><span class="sxs-lookup"><span data-stu-id="aa559-107">Without an index, [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] has to read each row in the table to determine whether the row should be included in the partition.</span></span> <span data-ttu-id="aa559-108">Com um índice, o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] consegue localizar rapidamente quais as linhas que deverão ser incluídas.</span><span class="sxs-lookup"><span data-stu-id="aa559-108">With an index, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] can quickly locate which rows should be included.</span></span> <span data-ttu-id="aa559-109">O processamento mais rápido ocorre se a replicação conseguir resolver inteiramente a cláusula WHERE do filtro do índice de modo autônomo.</span><span class="sxs-lookup"><span data-stu-id="aa559-109">The fastest processing takes place if replication can fully resolve the WHERE clause of the filter from the index alone.</span></span>  
  
     <span data-ttu-id="aa559-110">Indexar todas as colunas usadas em filtros de junção também é importante.</span><span class="sxs-lookup"><span data-stu-id="aa559-110">Indexing all the columns used in join filters is also important.</span></span> <span data-ttu-id="aa559-111">Cada vez que o Merge Agent é executado, ele pesquisa a tabela base para determinar quais as linhas da tabela pai e quais as linhas nas tabelas relacionadas estão incluídas na partição.</span><span class="sxs-lookup"><span data-stu-id="aa559-111">Each time the Merge Agent runs, it searches the base table to determine which rows in a parent table and which rows in related tables are included in a partition.</span></span> <span data-ttu-id="aa559-112">Criar um índice em colunas unidas evita que o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] precise ler cada linha da tabela todas as vezes que o Merge Agent for executado.</span><span class="sxs-lookup"><span data-stu-id="aa559-112">Creating an index on the joined columns avoids having [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] read each row in the table every time the Merge Agent runs.</span></span>  
  
     <span data-ttu-id="aa559-113">Para mais informações sobre filtragem, consulte [Filtrar dados publicados para replicação de mesclagem](../merge/filter-published-data-for-merge-replication.md).</span><span class="sxs-lookup"><span data-stu-id="aa559-113">For more information on filtering, see [Filter Published Data for Merge Replication](../merge/filter-published-data-for-merge-replication.md).</span></span>  
  
-   <span data-ttu-id="aa559-114">Considere tabelas supernormalizadas que incluam tipos de dados LOB (Large Object).</span><span class="sxs-lookup"><span data-stu-id="aa559-114">Consider overnormalizing tables that include Large Object (LOB) data types.</span></span>  
  
     <span data-ttu-id="aa559-115">Quando a sincronização ocorre, o Merge Agent poderá precisar ler e transferir a linha de dados inteira de um Publicador ou Assinante.</span><span class="sxs-lookup"><span data-stu-id="aa559-115">When synchronization occurs, the Merge Agent might need to read and transfer the entire data row from a Publisher or Subscriber.</span></span> <span data-ttu-id="aa559-116">Se a linha contiver colunas que usam LOBs, esse processo poderá precisar alocar memória adicional e comprometer o desempenho negativamente, embora essas colunas possam não ter sido atualizadas.</span><span class="sxs-lookup"><span data-stu-id="aa559-116">If the row contains columns that use LOBs, this process can require additional memory allocation and negatively impact performance even though these columns may not have been updated.</span></span> <span data-ttu-id="aa559-117">Para reduzir a probabilidade de ocorrer esse comprometimento no desempenho, considere colocar colunas LOB em uma tabela separada, usando uma relação um para um no resto dos dados de linha.</span><span class="sxs-lookup"><span data-stu-id="aa559-117">To reduce the likelihood that this performance impact occurs, consider putting LOB columns in a separate table using a one-to-one relationship to the rest of the row data.</span></span> <span data-ttu-id="aa559-118">Os tipos de dados `text`, `ntext` e `image`são preteridos.</span><span class="sxs-lookup"><span data-stu-id="aa559-118">The data types `text`, `ntext`, and `image` are deprecated.</span></span> <span data-ttu-id="aa559-119">Se incluir LOBs, recomendamos o uso dos tipos de dados `varchar(max)`, `nvarchar(max)`, `varbinary(max)`, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="aa559-119">If you do include LOBs, we recommend that you use the data types `varchar(max)`, `nvarchar(max)`, `varbinary(max)`, respectively.</span></span>  
  
## <a name="publication-design"></a><span data-ttu-id="aa559-120">Design de publicação</span><span class="sxs-lookup"><span data-stu-id="aa559-120">Publication Design</span></span>  
  
-   <span data-ttu-id="aa559-121">Use um nível de compatibilidade de publicação de 90RTM ([!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] ou uma versão posterior).</span><span class="sxs-lookup"><span data-stu-id="aa559-121">Use a publication compatibility level of 90RTM ([!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] or a later version).</span></span>  
  
     <span data-ttu-id="aa559-122">Exceto se um ou mais Assinantes usarem uma versão diferente do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], especifique que a publicação deve oferecer suporte somente para o [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] ou para uma versão posterior.</span><span class="sxs-lookup"><span data-stu-id="aa559-122">Unless one or more Subscribers use a different version of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], specify that the publication must support only [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] or a later version.</span></span> <span data-ttu-id="aa559-123">Isso permite à publicação beneficiar-se de novos recursos e otimizações de desempenho.</span><span class="sxs-lookup"><span data-stu-id="aa559-123">This allows the publication to take advantage of new features and performance optimizations.</span></span>  
  
-   <span data-ttu-id="aa559-124">Use as configurações de retenção da publicação apropriadas.</span><span class="sxs-lookup"><span data-stu-id="aa559-124">Use appropriate publication retention settings.</span></span>  
  
     <span data-ttu-id="aa559-125">O período de retenção da publicação, que é a quantidade máxima de tempo antes que a assinatura tenha de ser sincronizada, determina por quanto tempo os metadados de controle são armazenados.</span><span class="sxs-lookup"><span data-stu-id="aa559-125">The publication retention period, which is the maximum amount of time before a subscription must be synchronized, determines how long tracking metadata is stored.</span></span> <span data-ttu-id="aa559-126">Um valor alto pode afetar armazenamento e o desempenho do processamento.</span><span class="sxs-lookup"><span data-stu-id="aa559-126">A high value can affect storage and processing performance.</span></span> <span data-ttu-id="aa559-127">Para obter mais informações sobre como definir o período de retenção de publicação, consulte [Subscription Expiration and Deactivation](../subscription-expiration-and-deactivation.md).</span><span class="sxs-lookup"><span data-stu-id="aa559-127">For more information about setting the publication retention period, see [Subscription Expiration and Deactivation](../subscription-expiration-and-deactivation.md).</span></span>  
  
-   <span data-ttu-id="aa559-128">Use artigos de somente download nessas tabelas que só são alteradas no Publicador.</span><span class="sxs-lookup"><span data-stu-id="aa559-128">Use download-only articles on those tables that are only changed at the Publisher.</span></span> <span data-ttu-id="aa559-129">Para obter mais informações, consulte [Otimizar o desempenho da replicação de mesclagem com artigos somente para download](../merge/optimize-merge-replication-performance-with-download-only-articles.md).</span><span class="sxs-lookup"><span data-stu-id="aa559-129">For more information, see [Optimize Merge Replication Performance with Download-Only Articles](../merge/optimize-merge-replication-performance-with-download-only-articles.md).</span></span>  
  
### <a name="filter-design-and-use"></a><span data-ttu-id="aa559-130">Design e uso de filtro</span><span class="sxs-lookup"><span data-stu-id="aa559-130">Filter Design and Use</span></span>  
  
-   <span data-ttu-id="aa559-131">Limite a complexidade das cláusulas de filtro de linha.</span><span class="sxs-lookup"><span data-stu-id="aa559-131">Limit the complexity of row filter clauses.</span></span>  
  
     <span data-ttu-id="aa559-132">Limitar a complexidade dos critérios de filtragem ajuda a melhorar o desempenho, quando o Merge Agent estiver avaliando alterações de linha para enviar aos Assinantes.</span><span class="sxs-lookup"><span data-stu-id="aa559-132">Limiting the complexity of the filtering criteria helps improve performance when the Merge Agent is evaluating row changes to send to Subscribers.</span></span> <span data-ttu-id="aa559-133">Evite usar subseleções em cláusulas de filtro de linha de mesclagem.</span><span class="sxs-lookup"><span data-stu-id="aa559-133">Avoid using sub-selects within merge row filter clauses.</span></span> <span data-ttu-id="aa559-134">Em vez disso, considere o uso de filtros de junção, normalmente mais eficientes, quando usado para particionar dados em uma tabela baseada em uma cláusula de filtro de outra tabela.</span><span class="sxs-lookup"><span data-stu-id="aa559-134">Instead, consider using join filters, which are generally more efficient when used to partition data in one table based on the row filter clause in another table.</span></span> <span data-ttu-id="aa559-135">Para mais informações sobre filtragem, consulte [Filtrar dados publicados para replicação de mesclagem](../merge/filter-published-data-for-merge-replication.md).</span><span class="sxs-lookup"><span data-stu-id="aa559-135">For more information about filtering, see [Filter Published Data for Merge Replication](../merge/filter-published-data-for-merge-replication.md).</span></span>  
  
-   <span data-ttu-id="aa559-136">Use partições pré-computadas com filtros com parâmetros (esse recurso é usado por padrão).</span><span class="sxs-lookup"><span data-stu-id="aa559-136">Use precomputed partitions with parameterized filters (this feature is used by default).</span></span> <span data-ttu-id="aa559-137">Para obter mais informações, consulte [Optimize Parameterized Filter Performance with Precomputed Partitions](../merge/parameterized-filters-optimize-for-precomputed-partitions.md) (Otimizar o desempenho do filtro parametrizado com partições pré-computadas).</span><span class="sxs-lookup"><span data-stu-id="aa559-137">For more information, see [Optimize Parameterized Filter Performance with Precomputed Partitions](../merge/parameterized-filters-optimize-for-precomputed-partitions.md).</span></span>  
  
     <span data-ttu-id="aa559-138">Partições pré-computadas impõem vários limites no comportamento de filtragem.</span><span class="sxs-lookup"><span data-stu-id="aa559-138">Precomputed partitions impose a number of limits on filtering behavior.</span></span> <span data-ttu-id="aa559-139">Se seu aplicativo não puder aderir a essas limitações, defina a opção **keep_partition_changes** como **True**, fornecendo um benefício de desempenho.</span><span class="sxs-lookup"><span data-stu-id="aa559-139">If your application cannot adhere to these limitations, set the **keep_partition_changes** option to **True**, which provides a performance benefit.</span></span> <span data-ttu-id="aa559-140">Para obter mais informações, consulte [Filtros de linha com parâmetros](../merge/parameterized-filters-parameterized-row-filters.md).</span><span class="sxs-lookup"><span data-stu-id="aa559-140">For more information, see [Parameterized Row Filters](../merge/parameterized-filters-parameterized-row-filters.md).</span></span>  
  
-   <span data-ttu-id="aa559-141">Use partições não sobrepostas se os dados forem filtrados, mas não forem compartilhados entre os usuários.</span><span class="sxs-lookup"><span data-stu-id="aa559-141">Use nonoverlapping partitions if data is filtered but not shared among users.</span></span>  
  
     <span data-ttu-id="aa559-142">A replicação pode aperfeiçoar o desempenho para obter dados que não são compartilhados entre as partições ou assinaturas.</span><span class="sxs-lookup"><span data-stu-id="aa559-142">Replication can optimize performance for data that is not shared between partitions or subscriptions.</span></span> <span data-ttu-id="aa559-143">Para obter mais informações, consulte [Filtros de linha com parâmetros](../merge/parameterized-filters-parameterized-row-filters.md).</span><span class="sxs-lookup"><span data-stu-id="aa559-143">For more information, see [Parameterized Row Filters](../merge/parameterized-filters-parameterized-row-filters.md).</span></span>  
  
-   <span data-ttu-id="aa559-144">Não crie hierarquias de filtro de junção complexas.</span><span class="sxs-lookup"><span data-stu-id="aa559-144">Do not create complex join filter hierarchies.</span></span>  
  
     <span data-ttu-id="aa559-145">Filtros de junção com cinco ou mais tabelas podem comprometer o desempenho significativamente durante o processamento de mesclagem.</span><span class="sxs-lookup"><span data-stu-id="aa559-145">Join filters with five or more tables can significantly impact performance during merge processing.</span></span> <span data-ttu-id="aa559-146">Se você estiver gerando filtros de junção de cinco ou mais tabelas, recomendamos que considere outras soluções:</span><span class="sxs-lookup"><span data-stu-id="aa559-146">We recommend that if you are generating join filters of five or more tables that you consider other solutions:</span></span>  
  
    -   <span data-ttu-id="aa559-147">Evite tabelas de filtragem que são, em sua maioria, tabelas de pesquisa, tabelas menores e tabelas que não estão sujeitas às alterações.</span><span class="sxs-lookup"><span data-stu-id="aa559-147">Avoid filtering tables that are primarily lookup tables, smaller tables, and tables that are not subject to change.</span></span> <span data-ttu-id="aa559-148">Torne essas tabelas parte da publicação na sua totalidade.</span><span class="sxs-lookup"><span data-stu-id="aa559-148">Make those tables part of the publication in their entirety.</span></span> <span data-ttu-id="aa559-149">Recomendamos que você use filtros de junção apenas entre as tabelas que devem ser particionadas entre os Assinantes.</span><span class="sxs-lookup"><span data-stu-id="aa559-149">We recommend that you use join filters only between tables that must be partitioned among Subscribers.</span></span> <span data-ttu-id="aa559-150">Para obter mais informações, consulte [Join Filters](../merge/join-filters.md).</span><span class="sxs-lookup"><span data-stu-id="aa559-150">For more information, see [Join Filters](../merge/join-filters.md).</span></span>  
  
    -   <span data-ttu-id="aa559-151">Considere a desnormalização do design do banco de dados ou o uso de uma tabela de mapeamento, se houver um grande número de tabelas em uma junção.</span><span class="sxs-lookup"><span data-stu-id="aa559-151">Consider denormalizing the database design or using a mapping table if there are a large number of tables in a join.</span></span> <span data-ttu-id="aa559-152">Por exemplo, se um vendedor necessita apenas dos dados de seus clientes, mas precisa de seis junções para associar um cliente ao vendedor, considere a adição de uma coluna à tabela do cliente, identificando o vendedor.</span><span class="sxs-lookup"><span data-stu-id="aa559-152">For example, if a sales person needs only the data for her customers, but it requires six joins to associate a customer with a sales person, consider adding a column to the customer table that identifies the sales person.</span></span> <span data-ttu-id="aa559-153">Os dados do vendedor são redundantes, mas os custos de desnormalização de tabelas podem ser compensados pelos benefícios de desempenho para o particionamento de replicação.</span><span class="sxs-lookup"><span data-stu-id="aa559-153">The sales person data is redundant, but the costs of denormalizing the tables somewhat might be outweighed by the performance benefits for replication partitioning.</span></span>  
  
    -   <span data-ttu-id="aa559-154">Para melhorar o desempenho de partições pré-computadas, quando os lotes contêm muitas alterações de dados, projete seu aplicativo com atenção.</span><span class="sxs-lookup"><span data-stu-id="aa559-154">To improve the performance of precomputed partitions when batches contain lots of data changes, design your application with care.</span></span> <span data-ttu-id="aa559-155">Assegure-se de que as alterações de dados na tabela pai em um filtro de junção sejam feitas antes das alterações correspondentes nas tabelas filho.</span><span class="sxs-lookup"><span data-stu-id="aa559-155">Make sure that changes to data in the parent table in a join filter are made before corresponding changes in the child tables.</span></span>  
  
-   <span data-ttu-id="aa559-156">Defina a opção **join_unique_key** como **1** , se a lógica permitir.</span><span class="sxs-lookup"><span data-stu-id="aa559-156">Set the **join_unique_key** option to **1** if logic allows.</span></span>  
  
     <span data-ttu-id="aa559-157">Definir esse parâmetro como **1** indica que a relação entre tabelas pai e filho, em um filtro de junção, é de um para um ou de um para muitos.</span><span class="sxs-lookup"><span data-stu-id="aa559-157">Setting this parameter to **1** indicates that the relationship between the child and parent tables in a join filter is one to one or one to many.</span></span> <span data-ttu-id="aa559-158">Selecione esse parâmetro como **1** , apenas se houver uma restrição na coluna de junção na tabela filho garantindo a exclusividade.</span><span class="sxs-lookup"><span data-stu-id="aa559-158">Only set this parameter to **1** if you have a constraint on the joining column in the child table that guarantees uniqueness.</span></span> <span data-ttu-id="aa559-159">Se o parâmetro for definido incorretamente como **1** , poderá ocorrer a não convergência dos dados.</span><span class="sxs-lookup"><span data-stu-id="aa559-159">If the parameter is set to **1** incorrectly, non-convergence of data can occur.</span></span> <span data-ttu-id="aa559-160">Para obter mais informações, consulte [Join Filters](../merge/join-filters.md).</span><span class="sxs-lookup"><span data-stu-id="aa559-160">For more information, see [Join Filters](../merge/join-filters.md).</span></span>  
  
-   <span data-ttu-id="aa559-161">Evite executar lotes com muitas alterações quando você usar partições pré-computadas.</span><span class="sxs-lookup"><span data-stu-id="aa559-161">Avoid executing batches with lots of changes when you use precomputed partitions.</span></span>  
  
     <span data-ttu-id="aa559-162">Quando o Merge Agent é executado depois que você executou um lote, contendo lotes de alterações de dados, o agente tenta dividir o lote maior em lotes menores.</span><span class="sxs-lookup"><span data-stu-id="aa559-162">When the Merge Agent is run after you run a batch that contains lots of data changes, the agent tries to divide the large batch into smaller batches.</span></span> <span data-ttu-id="aa559-163">Durante esse tempo, podem ser bloqueados outros processos do Merge Agent.</span><span class="sxs-lookup"><span data-stu-id="aa559-163">During this time, other Merge Agent processes may be blocked.</span></span> <span data-ttu-id="aa559-164">Considere a redução do número de alterações em um lote e execute o Merge Agent entre os lotes.</span><span class="sxs-lookup"><span data-stu-id="aa559-164">Consider reducing the number of changes in a batch and run the Merge Agent between batches.</span></span> <span data-ttu-id="aa559-165">Se isso não puder ser feito, aumente o valor de **generation_leveling_threshold** para a publicação.</span><span class="sxs-lookup"><span data-stu-id="aa559-165">If this cannot be done, increase the value of **generation_leveling_threshold** for the publication.</span></span>  
  
## <a name="subscription-considerations"></a><span data-ttu-id="aa559-166">Considerações sobre assinatura</span><span class="sxs-lookup"><span data-stu-id="aa559-166">Subscription Considerations</span></span>  
  
-   <span data-ttu-id="aa559-167">Divida os agendamentos de sincronização de assinatura.</span><span class="sxs-lookup"><span data-stu-id="aa559-167">Stagger subscription synchronization schedules.</span></span>  
  
     <span data-ttu-id="aa559-168">Se um grande número de Assinantes sincronizarem com o Publicador, divida os agendamentos para que os Merge Agents sejam executados em momentos diferentes.</span><span class="sxs-lookup"><span data-stu-id="aa559-168">If a large number of Subscribers synchronize with a Publisher, consider staggering the schedules so that Merge Agents run at different times.</span></span> <span data-ttu-id="aa559-169">Para obter mais informações, consulte [Specify Synchronization Schedules](../specify-synchronization-schedules.md).</span><span class="sxs-lookup"><span data-stu-id="aa559-169">For more information, see [Specify Synchronization Schedules](../specify-synchronization-schedules.md).</span></span>  
  
## <a name="merge-agent-parameters"></a><span data-ttu-id="aa559-170">Parâmetros do Merge Agent</span><span class="sxs-lookup"><span data-stu-id="aa559-170">Merge Agent Parameters</span></span>  
 <span data-ttu-id="aa559-171">Para obter informações sobre o Merge Agent e seus parâmetros, consulte [Replication Merge Agent](../agents/replication-merge-agent.md).</span><span class="sxs-lookup"><span data-stu-id="aa559-171">For information about the Merge Agent and its parameters, see [Replication Merge Agent](../agents/replication-merge-agent.md).</span></span>  
  
-   <span data-ttu-id="aa559-172">Atualize todos os Assinantes com assinaturas pull do [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] ou de uma versão posterior.</span><span class="sxs-lookup"><span data-stu-id="aa559-172">Upgrade all Subscribers for pull subscriptions to [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] or a later version.</span></span>  
  
     <span data-ttu-id="aa559-173">Atualizar o Assinante para o [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] ou para uma versão posterior atualiza o Merge Agent usado pelas assinaturas do Assinante.</span><span class="sxs-lookup"><span data-stu-id="aa559-173">Upgrading the Subscriber to [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] or a later version upgrades the Merge Agent used by the subscriptions at that Subscriber.</span></span> <span data-ttu-id="aa559-174">Para se beneficiar dos muitos recursos e otimizações de desempenho, é necessário o Merge Agent do [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] ou de uma versão posterior.</span><span class="sxs-lookup"><span data-stu-id="aa559-174">To take advantage of many of the new features and performance optimizations, the Merge Agent from [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] or a later version is required.</span></span>  
  
-   <span data-ttu-id="aa559-175">Se uma assinatura for sincronizada em uma conexão rápida e as alterações forem enviadas do Editor e do Assinante, use o parâmetro **–ParallelUploadDownload** para o Agente de Mesclagem.</span><span class="sxs-lookup"><span data-stu-id="aa559-175">If a subscription is synchronized over a fast connection and changes are sent from the Publisher and Subscriber, use the **-ParallelUploadDownload** parameter for the Merge Agent.</span></span>  
  
     <span data-ttu-id="aa559-176">O[!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] introduziu um novo parâmetro no Agente de Mesclagem: **–ParallelUploadDownload**.</span><span class="sxs-lookup"><span data-stu-id="aa559-176">[!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] introduced a new Merge Agent parameter: **-ParallelUploadDownload**.</span></span> <span data-ttu-id="aa559-177">Definir esse parâmetro permite ao Merge Agent processar em paralelo as mudanças carregadas no Publicador e as baixadas no Assinante.</span><span class="sxs-lookup"><span data-stu-id="aa559-177">Setting this parameter allows the Merge Agent to process in parallel the changes uploaded to the Publisher and those downloaded to the Subscriber.</span></span> <span data-ttu-id="aa559-178">É útil em ambientes com grandes volumes e largura de banda de rede alta.</span><span class="sxs-lookup"><span data-stu-id="aa559-178">This is useful in high volume environments with high network bandwidth.</span></span> <span data-ttu-id="aa559-179">Os parâmetros de agente podem ser especificados em perfis de agente e na linha de comando.</span><span class="sxs-lookup"><span data-stu-id="aa559-179">Agent parameters can be specified in agent profiles and on the command line.</span></span> <span data-ttu-id="aa559-180">Para obter mais informações, consulte:</span><span class="sxs-lookup"><span data-stu-id="aa559-180">For more information, see:</span></span>  
  
    -   [<span data-ttu-id="aa559-181">Trabalhar com perfis do Agente de Replicação</span><span class="sxs-lookup"><span data-stu-id="aa559-181">Work with Replication Agent Profiles</span></span>](../agents/replication-agent-profiles.md)  
  
    -   [<span data-ttu-id="aa559-182">Exibir e modificar parâmetros do prompt de comando de agentes de replicação &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="aa559-182">View and Modify Replication Agent Command Prompt Parameters &#40;SQL Server Management Studio&#41;</span></span>](../agents/view-and-modify-replication-agent-command-prompt-parameters.md)  
  
    -   [<span data-ttu-id="aa559-183">Conceitos dos executáveis do Replication Agent</span><span class="sxs-lookup"><span data-stu-id="aa559-183">Replication Agent Executables Concepts</span></span>](../concepts/replication-agent-executables-concepts.md)  
  
-   <span data-ttu-id="aa559-184">Considere aumentar o valor do parâmetro **-MakeGenerationInterval** , especialmente se a sincronização envolver mais carregamentos de Assinantes do que downloads para Assinantes.</span><span class="sxs-lookup"><span data-stu-id="aa559-184">Consider increasing the value of the **-MakeGenerationInterval** parameter, especially if synchronization involves more uploads from Subscribers than downloads to Subscribers.</span></span>  
  
-   <span data-ttu-id="aa559-185">Quando sincronizar linhas de dados com um grande volume de dados, como linhas com colunas LOB, a sincronização da Web poderá necessitar de alocação de memória adicional e prejudicar o desempenho.</span><span class="sxs-lookup"><span data-stu-id="aa559-185">When you synchronize data rows with a large amount of data, such as rows with LOB columns, Web synchronization can require additional memory allocation and hurt performance.</span></span> <span data-ttu-id="aa559-186">Isso ocorre quando o Merge Agent gera uma mensagem XML contendo muitas linhas, com um grande volume de dados.</span><span class="sxs-lookup"><span data-stu-id="aa559-186">This occurs when the Merge Agent generates an XML message that contains too many data rows with large amounts of data.</span></span> <span data-ttu-id="aa559-187">Se o Merge Agent estiver consumindo muitos recursos durante a sincronização da Web, reduza o número de linhas enviadas em uma única mensagem, usando uma das seguintes opções:</span><span class="sxs-lookup"><span data-stu-id="aa559-187">If the Merge Agent is consuming too many resources during Web synchronization, reduce the number of rows sent in a single message in one of the following ways:</span></span>  
  
    -   <span data-ttu-id="aa559-188">Use o perfil do agente de vínculo lento para o Merge Agent.</span><span class="sxs-lookup"><span data-stu-id="aa559-188">Use the slow link agent profile for the Merge Agent.</span></span> <span data-ttu-id="aa559-189">Para saber mais, confira [Replication Agent Profiles](../agents/replication-agent-profiles.md).</span><span class="sxs-lookup"><span data-stu-id="aa559-189">For more information, see [Replication Agent Profiles](../agents/replication-agent-profiles.md).</span></span>  
  
    -   <span data-ttu-id="aa559-190">Diminua os parâmetros **- DownloadGenerationsPerBatch** e **- UploadGenerationsPerBatch** do Agente de Mesclagem para um valor menor ou igual a 10.</span><span class="sxs-lookup"><span data-stu-id="aa559-190">Decrease the **-DownloadGenerationsPerBatch** and **-UploadGenerationsPerBatch** parameters for the Merge Agent to a value of 10 or less.</span></span> <span data-ttu-id="aa559-191">O valor padrão desses parâmetros é 50.</span><span class="sxs-lookup"><span data-stu-id="aa559-191">The default value of these parameters is 50.</span></span>  
  
## <a name="snapshot-considerations"></a><span data-ttu-id="aa559-192">Considerações de instantâneo</span><span class="sxs-lookup"><span data-stu-id="aa559-192">Snapshot Considerations</span></span>  
  
-   <span data-ttu-id="aa559-193">Crie uma coluna ROWGUIDCOL nas tabelas grandes, antes de gerar o instantâneo inicial.</span><span class="sxs-lookup"><span data-stu-id="aa559-193">Create a ROWGUIDCOL column on large tables prior to generating the initial snapshot.</span></span>  
  
     <span data-ttu-id="aa559-194">A replicação de mesclagem requer que cada tabela publicada tenha uma coluna ROWGUIDCOL.</span><span class="sxs-lookup"><span data-stu-id="aa559-194">Merge replication requires that each published table have a ROWGUIDCOL column.</span></span> <span data-ttu-id="aa559-195">Se a coluna ROWGUIDCOL não existir na tabela antes do Snapshot Agent criar arquivos de instantâneo inicial, o agente deve primeiro adicionar e popular a coluna ROWGUIDCOL.</span><span class="sxs-lookup"><span data-stu-id="aa559-195">If a ROWGUIDCOL column does not exist in the table before the Snapshot Agent creates the initial snapshot files, the agent must first add and populate the ROWGUIDCOL column.</span></span> <span data-ttu-id="aa559-196">Para obter uma vantagem de desempenho ao gerar instantâneos, crie uma coluna ROWGUIDCOL em cada tabela antes de publicar.</span><span class="sxs-lookup"><span data-stu-id="aa559-196">To gain a performance advantage when generating snapshots during merge replication, create the ROWGUIDCOL column on each table before publishing.</span></span> <span data-ttu-id="aa559-197">A coluna pode ter qualquer nome (**rowguid** é usado pelo Snapshot Agent, por padrão), mas deve ter as seguintes características de tipos de dados:</span><span class="sxs-lookup"><span data-stu-id="aa559-197">The column can have any name (**rowguid** is used by the Snapshot Agent by default), but must have the following data type characteristics:</span></span>  
  
    -   <span data-ttu-id="aa559-198">Dados do tipo UNIQUEIDENTIFIER.</span><span class="sxs-lookup"><span data-stu-id="aa559-198">A data type of UNIQUEIDENTIFIER.</span></span>  
  
    -   <span data-ttu-id="aa559-199">Um padrão NEWSEQUENTIALID() ou NEWID().</span><span class="sxs-lookup"><span data-stu-id="aa559-199">A default of NEWSEQUENTIALID() or NEWID().</span></span> <span data-ttu-id="aa559-200">NEWSEQUENTIALID() é o recomendado, pois pode fornecer um desempenho melhor ao fazer e controlar alterações.</span><span class="sxs-lookup"><span data-stu-id="aa559-200">NEWSEQUENTIALID() is recommended because it can provide increased performance when making and tracking changes.</span></span>  
  
    -   <span data-ttu-id="aa559-201">O conjunto de propriedades ROWGUIDCOL.</span><span class="sxs-lookup"><span data-stu-id="aa559-201">The ROWGUIDCOL property set.</span></span>  
  
    -   <span data-ttu-id="aa559-202">Um índice exclusivo na coluna.</span><span class="sxs-lookup"><span data-stu-id="aa559-202">A unique index on the column.</span></span>  
  
-   <span data-ttu-id="aa559-203">Gere os instantâneos previamente e/ou permita que os Assinantes solicitem a geração e a aplicação de instantâneos, na primeira vez que fizerem a sincronização.</span><span class="sxs-lookup"><span data-stu-id="aa559-203">Pre-generate snapshots and/or allow Subscribers to request snapshot generation and application the first time they synchronize.</span></span>  
  
     <span data-ttu-id="aa559-204">Use uma, ou ambas as opções, para fornecer instantâneos para publicações que usam filtros com parâmetros.</span><span class="sxs-lookup"><span data-stu-id="aa559-204">Use one or both of these options to provide snapshots for publications that use parameterized filters.</span></span> <span data-ttu-id="aa559-205">Se você não especificar uma dessas opções, as assinaturas serão inicializadas usando uma série de instruções SELECT e INSERT, ao invés de usar o utilitário **bcp** , esse processo é muito mais lento.</span><span class="sxs-lookup"><span data-stu-id="aa559-205">If you do not specify one of these options, subscriptions are initialized using a series of SELECT and INSERT statements, rather than using the **bcp** utility; this process is much slower.</span></span> <span data-ttu-id="aa559-206">Para obter mais informações, consulte [Snapshots for Merge Publications with Parameterized Filters](../snapshots-for-merge-publications-with-parameterized-filters.md).</span><span class="sxs-lookup"><span data-stu-id="aa559-206">For more information, see [Snapshots for Merge Publications with Parameterized Filters](../snapshots-for-merge-publications-with-parameterized-filters.md).</span></span>  
  
## <a name="maintenance-and-monitoring-considerations"></a><span data-ttu-id="aa559-207">Considerações sobre manutenção e monitoramento</span><span class="sxs-lookup"><span data-stu-id="aa559-207">Maintenance and Monitoring Considerations</span></span>  
  
-   <span data-ttu-id="aa559-208">Esporadicamente, indexe novamente as tabelas do sistema de replicação de mesclagem.</span><span class="sxs-lookup"><span data-stu-id="aa559-208">Occasionally re-index merge replication system tables.</span></span>  
  
     <span data-ttu-id="aa559-209">Como parte da manutenção da replicação de mesclagem, verifique esporadicamente o crescimento das tabelas do sistema associadas à replicação de mesclagem: **MSmerge_contents**, **MSmerge_genhistory**, **MSmerge_tombstone**, **MSmerge_current_partition_mappings**e **MSmerge_past_partition_mappings**.</span><span class="sxs-lookup"><span data-stu-id="aa559-209">As part of maintenance for merge replication, occasionally check the growth of the system tables associated with merge replication: **MSmerge_contents**, **MSmerge_genhistory**, and **MSmerge_tombstone**, **MSmerge_current_partition_mappings**, and **MSmerge_past_partition_mappings**.</span></span> <span data-ttu-id="aa559-210">Periodicamente, indexe novamente essas tabelas.</span><span class="sxs-lookup"><span data-stu-id="aa559-210">Periodically re-index these tables.</span></span> <span data-ttu-id="aa559-211">Para obter mais informações, veja [Reorganizar e recriar índices](../../indexes/reorganize-and-rebuild-indexes.md).</span><span class="sxs-lookup"><span data-stu-id="aa559-211">For more information, see [Reorganize and Rebuild Indexes](../../indexes/reorganize-and-rebuild-indexes.md).</span></span>  
  
-   <span data-ttu-id="aa559-212">Monitore o desempenho de sincronização usando a guia **Histórico de Sincronização** no Replication Monitor.</span><span class="sxs-lookup"><span data-stu-id="aa559-212">Monitor synchronization performance using the **Synchronization History** tab in Replication Monitor.</span></span>  
  
     <span data-ttu-id="aa559-213">Para a replicação de mesclagem, o Replication Monitor exibe as estatísticas detalhadas na guia **Histórico de Sincronizações** para cada artigo processado durante a sincronização, incluindo tempo gasto em cada fase do processamento (carregar alterações, baixar alterações e assim por diante).</span><span class="sxs-lookup"><span data-stu-id="aa559-213">For merge replication, Replication Monitor displays detailed statistics in the **Synchronization History** tab for each article processed during synchronization, including the amount of time spent in each processing phase (uploading changes, downloading changes, and so on).</span></span> <span data-ttu-id="aa559-214">Ajuda a definir tabelas específicas que estão causando lentidão e é o melhor local para a solução de problemas de desempenho com assinaturas de mesclagem.</span><span class="sxs-lookup"><span data-stu-id="aa559-214">It can help pinpoint specific tables that are causing slow downs and is the best place to troubleshoot performance issues with merge subscriptions.</span></span> <span data-ttu-id="aa559-215">Para obter mais informações sobre como exibir estatísticas detalhadas, confira [Exibir informações e executar tarefas usando o Replication Monitor](../monitor/view-information-and-perform-tasks-replication-monitor.md).</span><span class="sxs-lookup"><span data-stu-id="aa559-215">For more information on viewing detailed statistics, see [View Information and Perform Tasks using Replication Monitor](../monitor/view-information-and-perform-tasks-replication-monitor.md).</span></span>  
  
  
