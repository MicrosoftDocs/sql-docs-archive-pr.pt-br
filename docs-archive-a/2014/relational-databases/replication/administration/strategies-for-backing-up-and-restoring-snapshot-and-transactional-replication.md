---
title: Estratégias para fazer backup e restaurar o instantâneo e a replicação transacional | Microsoft Docs
ms.custom: ''
ms.date: 03/08/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- backups [SQL Server replication], snapshot replication
- restoring [SQL Server replication], transactional replication
- snapshot replication [SQL Server], backup and restore
- restoring [SQL Server replication], snapshot replication
- recovery [SQL Server replication], transactional replication
- transactional replication, backup and restore
- recovery [SQL Server replication], snapshot replication
- sync with backup [SQL Server replication]
- backups [SQL Server replication], transactional replication
ms.assetid: a8afcdbc-55db-4916-a219-19454f561f9e
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: e26f6cf1a61e4df9db79bc5fd90429f86d70a99f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87584126"
---
# <a name="strategies-for-backing-up-and-restoring-snapshot-and-transactional-replication"></a><span data-ttu-id="0c208-102">Estratégias para fazer backup e restaurar o instantâneo e a replicação transacional</span><span class="sxs-lookup"><span data-stu-id="0c208-102">Strategies for Backing Up and Restoring Snapshot and Transactional Replication</span></span>
  <span data-ttu-id="0c208-103">Ao projetar uma estratégia de backup e restauração para instantâneo e replicação transacional, há três áreas a serem consideradas:</span><span class="sxs-lookup"><span data-stu-id="0c208-103">When you design a backup and restore strategy for snapshot and transactional replication, there are three areas to consider:</span></span>  
  
-   <span data-ttu-id="0c208-104">Quais bancos de dados para fazer o backup.</span><span class="sxs-lookup"><span data-stu-id="0c208-104">Which databases to back up.</span></span>  
  
-   <span data-ttu-id="0c208-105">Configurações de backup para replicação transacional.</span><span class="sxs-lookup"><span data-stu-id="0c208-105">Backup settings for transactional replication.</span></span>  
  
-   <span data-ttu-id="0c208-106">As etapas que são exigidas para restaurar um banco de dados.</span><span class="sxs-lookup"><span data-stu-id="0c208-106">The steps that are required to restore a database.</span></span> <span data-ttu-id="0c208-107">Dependem do tipo de replicação e das opções escolhidas.</span><span class="sxs-lookup"><span data-stu-id="0c208-107">These depend on the type of replication and options chosen.</span></span>  
  
 <span data-ttu-id="0c208-108">Este tópico abrange cada uma dessas áreas nas próximas três seções.</span><span class="sxs-lookup"><span data-stu-id="0c208-108">This topic covers each of these areas in the next three sections.</span></span> <span data-ttu-id="0c208-109">Para obter informações sobre backup e restauração para publicação Oracle, consulte [Backup e restauração para Publicadores Oracle](../non-sql/backup-and-restore-for-oracle-publishers.md).</span><span class="sxs-lookup"><span data-stu-id="0c208-109">For information about backup and restore for Oracle publishing, see [Backup and Restore for Oracle Publishers](../non-sql/backup-and-restore-for-oracle-publishers.md).</span></span>  
  
## <a name="backing-up-databases"></a><span data-ttu-id="0c208-110">Fazendo backup de bancos de dados</span><span class="sxs-lookup"><span data-stu-id="0c208-110">Backing up Databases</span></span>  
 <span data-ttu-id="0c208-111">Para instantâneo e replicação transacional, é necessário fazer o backup regularmente dos seguintes bancos de dados:</span><span class="sxs-lookup"><span data-stu-id="0c208-111">For snapshot and transactional replication, you should regularly back up the following databases:</span></span>  
  
-   <span data-ttu-id="0c208-112">O banco de dados de publicação no Publicador.</span><span class="sxs-lookup"><span data-stu-id="0c208-112">The publication database at the Publisher.</span></span>  
  
-   <span data-ttu-id="0c208-113">O banco de dados de distribuição no Distribuidor.</span><span class="sxs-lookup"><span data-stu-id="0c208-113">The distribution database at the Distributor.</span></span>  
  
-   <span data-ttu-id="0c208-114">O banco de dados de assinatura em cada Assinante.</span><span class="sxs-lookup"><span data-stu-id="0c208-114">The subscription database at each Subscriber.</span></span>  
  
-   <span data-ttu-id="0c208-115">Os bancos de dados de sistema **mestre** e **msdb** no Publicador, Distribuidor e todos os Assinantes.</span><span class="sxs-lookup"><span data-stu-id="0c208-115">The **master** and **msdb** system databases at the Publisher, Distributor and all Subscribers.</span></span> <span data-ttu-id="0c208-116">Esses bancos de dados devem ter, cada um, seus backups realizados em simultâneo com o banco de dados de replicação relevante.</span><span class="sxs-lookup"><span data-stu-id="0c208-116">These databases should be backed up at the same time as each other and the relevant replication database.</span></span> <span data-ttu-id="0c208-117">Por exemplo, faça o backup dos bancos de dados **mestre** e **msdb** no Publicador na mesma hora que faz o backup do banco de dados de publicação.</span><span class="sxs-lookup"><span data-stu-id="0c208-117">For example, back up the **master** and **msdb** databases at the Publisher at the same time that you back up the publication database.</span></span> <span data-ttu-id="0c208-118">Se o banco de dados de publicação for restaurado, certifique-–e de que os bancos de dados **mestre** e **msdb** são consistentes com o banco de dados de publicação com respeito à configuração de replicação e às configurações.</span><span class="sxs-lookup"><span data-stu-id="0c208-118">If the publication database is restored, make sure that the **master** and **msdb** databases are consistent with the publication database with regard to replication configuration and settings.</span></span>  
  
 <span data-ttu-id="0c208-119">Se você executar backups de log regulares, qualquer alteração relacionada à replicação deverá ser capturada nos backups de log.</span><span class="sxs-lookup"><span data-stu-id="0c208-119">If you perform regular log backups, any replication-related changes should be captured in the log backups.</span></span> <span data-ttu-id="0c208-120">Se não executar backups de log, um backup deve ser executado sempre que uma configuração pertinente à replicação for alterada.</span><span class="sxs-lookup"><span data-stu-id="0c208-120">If you do not perform log backups, a backup should be performed whenever a setting relevant to replication is changed.</span></span> <span data-ttu-id="0c208-121">Para obter mais informações, consulte [Common Actions Requiring an Updated Backup](common-actions-requiring-an-updated-backup.md).</span><span class="sxs-lookup"><span data-stu-id="0c208-121">For more information, see [Common Actions Requiring an Updated Backup](common-actions-requiring-an-updated-backup.md).</span></span>  
  
## <a name="backup-settings-for-transactional-replication"></a><span data-ttu-id="0c208-122">Configurações de backup para replicação transacional</span><span class="sxs-lookup"><span data-stu-id="0c208-122">Backup Settings for Transactional Replication</span></span>  
 <span data-ttu-id="0c208-123">A replicação transacional inclui o uso da opção **sync with backup** que pode ser definida no banco de dados de distribuição e no banco de dados de publicação.</span><span class="sxs-lookup"><span data-stu-id="0c208-123">Transactional replication includes using the **sync with backup** option, which can be set on the distribution database and the publication database:</span></span>  
  
-   <span data-ttu-id="0c208-124">Nós recomendamos essa opção seja sempre definida no banco de dados de distribuição.</span><span class="sxs-lookup"><span data-stu-id="0c208-124">We recommend that you always set this option on the distribution database.</span></span>  
  
     <span data-ttu-id="0c208-125">Definir essa opção no banco de dados de distribuição assegura que as transações no log do banco de dados de publicação não serão truncadas até ser realizado o backup do banco de dados de distribuição.</span><span class="sxs-lookup"><span data-stu-id="0c208-125">Setting this option on the distribution database ensures that transactions in the log of the publication database will not be truncated until they have been backed up at the distribution database.</span></span> <span data-ttu-id="0c208-126">O banco de dados de distribuição pode ser restaurado ao último backup, e quaisquer transações perdidas são entregues do banco de dados de publicação ao banco de dados de distribuição.</span><span class="sxs-lookup"><span data-stu-id="0c208-126">The distribution database can be restored to the last backup, and any missing transactions are delivered from the publication database to the distribution database.</span></span> <span data-ttu-id="0c208-127">A replicação continua sem ser afetada.</span><span class="sxs-lookup"><span data-stu-id="0c208-127">Replication continues unaffected.</span></span>  
  
     <span data-ttu-id="0c208-128">Definir essa opção no banco de dados de distribuição não afeta a latência de replicação.</span><span class="sxs-lookup"><span data-stu-id="0c208-128">Setting this option on the distribution database does not affect replication latency.</span></span> <span data-ttu-id="0c208-129">Entretanto, a opção retardará o truncamento do log no banco de dados de publicação até ser realizado o backup das transações correspondentes no banco de dados de distribuição.</span><span class="sxs-lookup"><span data-stu-id="0c208-129">However, the option will delay the truncation of the log on the publication database until the corresponding transactions in the distribution database have been backed up.</span></span> <span data-ttu-id="0c208-130">(Isso pode criar um log de transação maior no banco de dados de publicação.)</span><span class="sxs-lookup"><span data-stu-id="0c208-130">(This can create a larger transaction log in the publication database.)</span></span>  
  
-   <span data-ttu-id="0c208-131">Nós recomendamos a definição dessa opção no banco de dados de publicação se seu aplicativo puder tolerar a latência adicional.</span><span class="sxs-lookup"><span data-stu-id="0c208-131">We recommend that you set this option on the publication database if your application can tolerate additional latency.</span></span>  
  
     <span data-ttu-id="0c208-132">Definir essa opção no banco de dados de publicação assegura que as transações não serão entregues ao banco de dados de distribuição até ser realizado o backup do banco de dados de publicação.</span><span class="sxs-lookup"><span data-stu-id="0c208-132">Setting this option on the publication database ensures that transactions are not delivered to the distribution database until they are backed up at the publication database.</span></span> <span data-ttu-id="0c208-133">O último backup do banco de dados de publicação poderá, então, ser restaurado no Publicador sem qualquer chance do banco de dados de distribuição possuir transações que o banco de dados de publicação restaurado não possua.</span><span class="sxs-lookup"><span data-stu-id="0c208-133">The last publication database backup can then be restored at the Publisher without any chance of the distribution database having transactions that the restored publication database does not have.</span></span>  
  
     <span data-ttu-id="0c208-134">A latência e a taxa de transferência serão afetadas porque as transações não poderão ser entregues ao banco de dados de distribuição até que o backup tenha sido feito no Publicador.</span><span class="sxs-lookup"><span data-stu-id="0c208-134">Latency and throughput are affected because transactions cannot be delivered to the distribution database until they have been backed up at the Publisher.</span></span> <span data-ttu-id="0c208-135">Por exemplo, se o log de transações tem seu backup realizado a cada cinco minutos, haverá cinco minutos adicionais de latência quando a transação é confirmada no Publicador, e quando a transação é entregue ao banco de dados de distribuição e, subsequentemente, ao Assinante.</span><span class="sxs-lookup"><span data-stu-id="0c208-135">For example, if the transaction log is backed up every five minutes, there is an additional five minutes of latency between when a transaction is committed at the Publisher and when the transaction is delivered to the distribution database, and subsequently the Subscriber.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="0c208-136">A opção **sync with backup** assegura a consistência entre o banco de dados de publicação e banco de dados de distribuição, mas a opção não dá garantia contra perda de dados.</span><span class="sxs-lookup"><span data-stu-id="0c208-136">The **sync with backup** option ensures consistency between the publication database and the distribution database, but the option does not guarantee against data loss.</span></span> <span data-ttu-id="0c208-137">Por exemplo, se o log de transações for perdido, as transações que foram confirmadas desde o último backup do log de transações não estarão disponíveis no banco de dados de publicação ou no banco de dados de distribuição.</span><span class="sxs-lookup"><span data-stu-id="0c208-137">For example, if the transaction log is lost, transactions that have been committed since the last transaction log backup will not be available in the publication database or the distribution database.</span></span> <span data-ttu-id="0c208-138">Esse é o mesmo comportamento de um banco de dados não replicado.</span><span class="sxs-lookup"><span data-stu-id="0c208-138">This is the same behavior as a nonreplicated database.</span></span>  
  
 <span data-ttu-id="0c208-139">**Para definir a opção sync with backup**</span><span class="sxs-lookup"><span data-stu-id="0c208-139">**To set the sync with backup option**</span></span>  
  
-   <span data-ttu-id="0c208-140">Programação [!INCLUDE[tsql](../../../includes/tsql-md.md)] de replicação: [Habilitar backups coordenados para a replicação transacional &#40;programação Transact-SQL de replicação&#41;](enable-coordinated-backups-for-transactional-replication.md)</span><span class="sxs-lookup"><span data-stu-id="0c208-140">Replication [!INCLUDE[tsql](../../../includes/tsql-md.md)] programming: [Enable Coordinated Backups for Transactional Replication &#40;Replication Transact-SQL Programming&#41;](enable-coordinated-backups-for-transactional-replication.md)</span></span>  
  
## <a name="restoring-databases-involved-in-replication"></a><span data-ttu-id="0c208-141">Restaurando bancos de dados envolvidos em replicação</span><span class="sxs-lookup"><span data-stu-id="0c208-141">Restoring Databases Involved in Replication</span></span>  
 <span data-ttu-id="0c208-142">É possível restaurar todos os bancos de dados em uma topologia de replicação se backups recentes estiverem disponíveis e as etapas adequadas forem seguidas.</span><span class="sxs-lookup"><span data-stu-id="0c208-142">You can restore all databases in a replication topology if recent backups are available and the appropriate steps are followed.</span></span> <span data-ttu-id="0c208-143">As etapas de restauração para o banco de dados de publicação dependem do tipo de replicação e das opções que foram usadas; entretanto, as etapas de restauração para todos os outros bancos de dados independem de tipo e opções.</span><span class="sxs-lookup"><span data-stu-id="0c208-143">The restore steps for the publication database depend on the type of replication and options that are used; however, the restore steps for all other databases are independent of the type and options.</span></span>  
  
 <span data-ttu-id="0c208-144">A replicação oferece suporte à restauração de bancos de dados replicados para o mesmo servidor e banco de dados dos quais o backup foi criado.</span><span class="sxs-lookup"><span data-stu-id="0c208-144">Replication supports restoring replicated databases to the same server and database from which the backup was created.</span></span> <span data-ttu-id="0c208-145">Se você restaurar um backup de um banco de dados replicado para outro servidor ou banco de dados, as configurações de replicação não poderão ser preservadas.</span><span class="sxs-lookup"><span data-stu-id="0c208-145">If you restore a backup of a replicated database to another server or database, replication settings cannot be preserved.</span></span> <span data-ttu-id="0c208-146">Nesse caso, é necessário recriar todas as publicações e assinaturas depois que os backups forem restaurados.</span><span class="sxs-lookup"><span data-stu-id="0c208-146">In this case, you must re-create all publications and subscriptions after backups are restored.</span></span>  
  
### <a name="publisher"></a><span data-ttu-id="0c208-147">Publicador</span><span class="sxs-lookup"><span data-stu-id="0c208-147">Publisher</span></span>  
 <span data-ttu-id="0c208-148">Há etapas de restauração fornecidas para os seguintes tipos de replicação:</span><span class="sxs-lookup"><span data-stu-id="0c208-148">There are restore steps provided for the following types of replication:</span></span>  
  
-   <span data-ttu-id="0c208-149">Replicação de instantâneo</span><span class="sxs-lookup"><span data-stu-id="0c208-149">Snapshot replication</span></span>  
  
-   <span data-ttu-id="0c208-150">Replicação transacional somente para leitura</span><span class="sxs-lookup"><span data-stu-id="0c208-150">Read-only transactional replication</span></span>  
  
-   <span data-ttu-id="0c208-151">Replicação transacional com assinaturas de atualização</span><span class="sxs-lookup"><span data-stu-id="0c208-151">Transactional replication with updating subscriptions</span></span>  
  
-   <span data-ttu-id="0c208-152">Replicação transacional ponto a ponto</span><span class="sxs-lookup"><span data-stu-id="0c208-152">Peer-to-peer transactional replication</span></span>  
  
 <span data-ttu-id="0c208-153">A restauração dos bancos de dados **msdb** e **mestre** , que também são tratados nesta seção, é a mesma para todos os quatro tipos.</span><span class="sxs-lookup"><span data-stu-id="0c208-153">The restore of the **msdb** and **master** databases, which are also covered in this section, is the same for all four types.</span></span>  
  
#### <a name="publication-database-snapshot-replication"></a><span data-ttu-id="0c208-154">Banco de Dados de Publicação: Replicação de instantâneo</span><span class="sxs-lookup"><span data-stu-id="0c208-154">Publication Database: Snapshot Replication</span></span>  
  
1.  <span data-ttu-id="0c208-155">Restaure o último backup de banco de dados do banco de dados de publicação.</span><span class="sxs-lookup"><span data-stu-id="0c208-155">Restore the latest backup of the publication database.</span></span> <span data-ttu-id="0c208-156">Vá para a etapa 2.</span><span class="sxs-lookup"><span data-stu-id="0c208-156">Go to step 2.</span></span>  
  
2.  <span data-ttu-id="0c208-157">O backup do banco de dados de publicação contém a configuração mais recente de todas as publicações e assinaturas?</span><span class="sxs-lookup"><span data-stu-id="0c208-157">Does the publication database backup contain the latest configuration for all publications and subscriptions?</span></span> <span data-ttu-id="0c208-158">Se a resposta for afirmativa, a restauração está concluída.</span><span class="sxs-lookup"><span data-stu-id="0c208-158">If yes, the restore is completed.</span></span> <span data-ttu-id="0c208-159">Se não, vá para a etapa 3.</span><span class="sxs-lookup"><span data-stu-id="0c208-159">If no, go to step 3.</span></span>  
  
3.  <span data-ttu-id="0c208-160">Remova a configuração de replicação do Publicador, Distribuidor e Assinantes e, em seguida, recrie a configuração.</span><span class="sxs-lookup"><span data-stu-id="0c208-160">Remove the replication configuration from the Publisher, Distributor and Subscribers, and then re-create the configuration.</span></span> <span data-ttu-id="0c208-161">A restauração está concluída.</span><span class="sxs-lookup"><span data-stu-id="0c208-161">Restore is completed.</span></span>  
  
     <span data-ttu-id="0c208-162">Para obter mais informações sobre como remover a replicação, consulte [sp_removedbreplication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-removedbreplication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="0c208-162">For more information about how to remove replication, see [sp_removedbreplication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-removedbreplication-transact-sql).</span></span>  
  
#### <a name="publication-database-read-only-transactional-replication"></a><span data-ttu-id="0c208-163">Banco de Dados de Publicação: Replicação transacional somente leitura</span><span class="sxs-lookup"><span data-stu-id="0c208-163">Publication Database: Read-Only Transactional Replication</span></span>  
  
1.  <span data-ttu-id="0c208-164">Restaure o último backup de banco de dados do banco de dados de publicação.</span><span class="sxs-lookup"><span data-stu-id="0c208-164">Restore the latest backup of the publication database.</span></span> <span data-ttu-id="0c208-165">Vá para a etapa 2.</span><span class="sxs-lookup"><span data-stu-id="0c208-165">Go to step 2.</span></span>  
  
2.  <span data-ttu-id="0c208-166">A configuração **sync with backup** foi habilitada no banco de dados de publicação antes da falha?</span><span class="sxs-lookup"><span data-stu-id="0c208-166">Was the **sync with backup** setting enabled on the publication database before the failure?</span></span> <span data-ttu-id="0c208-167">Em caso afirmativo, vá para a etapa 3; caso contrário, vá para a etapa 5.</span><span class="sxs-lookup"><span data-stu-id="0c208-167">If yes, go to step 3; if no, go to step 5.</span></span>  
  
     <span data-ttu-id="0c208-168">Se a configuração estiver habilitada, a consulta `SELECT DATABASEPROPERTYEX('<PublicationDatabaseName>', 'IsSyncWithBackup')` retornará ‘1'.</span><span class="sxs-lookup"><span data-stu-id="0c208-168">If the setting is enabled, the query `SELECT DATABASEPROPERTYEX('<PublicationDatabaseName>', 'IsSyncWithBackup')` returns '1'.</span></span>  
  
3.  <span data-ttu-id="0c208-169">O backup restaurado está completo e atualizado?</span><span class="sxs-lookup"><span data-stu-id="0c208-169">Is the restored backup complete and up-to-date?</span></span> <span data-ttu-id="0c208-170">Ele contém a configuração mais recente para todas as publicações e assinaturas?</span><span class="sxs-lookup"><span data-stu-id="0c208-170">Does it contain the latest configuration for all publications and subscriptions?</span></span> <span data-ttu-id="0c208-171">Se a resposta for afirmativa, a restauração está concluída.</span><span class="sxs-lookup"><span data-stu-id="0c208-171">If yes, the restore is completed.</span></span> <span data-ttu-id="0c208-172">Se não, vá para a etapa 4.</span><span class="sxs-lookup"><span data-stu-id="0c208-172">If no, go to step 4.</span></span>  
  
4.  <span data-ttu-id="0c208-173">As informações de configuração no banco de dados de publicação restauradas não estão atualizadas.</span><span class="sxs-lookup"><span data-stu-id="0c208-173">The configuration information in the restored publication database is not up-to-date.</span></span> <span data-ttu-id="0c208-174">Consequentemente, é necessário certificar-se de que os Assinantes têm todos os comandos pendentes no banco de dados de distribuição e, então, descartar e recriar a configuração da replicação.</span><span class="sxs-lookup"><span data-stu-id="0c208-174">Therefore, you must make sure that the Subscribers have all outstanding commands in the distribution database, and then drop and re-create the replication configuration.</span></span>  
  
    1.  <span data-ttu-id="0c208-175">Execute o Distribution Agent até que todos os Assinantes estejam sincronizados com os comandos pendentes no banco de dados de distribuição.</span><span class="sxs-lookup"><span data-stu-id="0c208-175">Run the Distribution Agent until all Subscribers are synchronized with the outstanding commands in the distribution database.</span></span> <span data-ttu-id="0c208-176">Verifique se todos os comandos foram entregues aos Assinantes usando a guia **Comandos não Distribuídos** no Replication Monitor ou consultando a exibição [MSdistribuition_status](/sql/relational-databases/system-views/msdistribution-status-transact-sql) no banco de dados de distribuição.</span><span class="sxs-lookup"><span data-stu-id="0c208-176">Verify that all commands are delivered to Subscribers by using the **Undistributed Commands** tab in Replication Monitor or by querying the [MSdistribution_status](/sql/relational-databases/system-views/msdistribution-status-transact-sql) view in the distribution database.</span></span> <span data-ttu-id="0c208-177">Vá para a etapa b.</span><span class="sxs-lookup"><span data-stu-id="0c208-177">Go to step b.</span></span>  
  
         <span data-ttu-id="0c208-178">Para obter mais informações sobre como executar um Agente de Distribuição, consulte [Iniciar e parar um agente de replicação &#40;SQL Server Management Studio&#41;](../agents/start-and-stop-a-replication-agent-sql-server-management-studio.md) e [Conceitos dos executáveis do agente de replicação](../concepts/replication-agent-executables-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="0c208-178">For more information about how to run the Distribution Agent, see [Start and Stop a Replication Agent &#40;SQL Server Management Studio&#41;](../agents/start-and-stop-a-replication-agent-sql-server-management-studio.md) and [Replication Agent Executables Concepts](../concepts/replication-agent-executables-concepts.md).</span></span>  
  
         <span data-ttu-id="0c208-179">Para obter mais informações sobre como verificar comandos, consulte [exibir comandos replicados e outras informações no banco de dados de distribuição &#40;Programação Transact-SQL de replicação&#41;](../monitor/view-replicated-commands-and-information-in-distribution-database.md) e [Exibir informações e executar tarefas usando o Replication Monitor](../monitor/view-information-and-perform-tasks-replication-monitor.md).</span><span class="sxs-lookup"><span data-stu-id="0c208-179">For more information about how to verify commands, see [View Replicated Commands and Other Information in the Distribution Database &#40;Replication Transact-SQL Programming&#41;](../monitor/view-replicated-commands-and-information-in-distribution-database.md) and [View Information and Perform Tasks using Replication Monitor](../monitor/view-information-and-perform-tasks-replication-monitor.md).</span></span>  
  
    2.  <span data-ttu-id="0c208-180">Remova a configuração de replicação do Publicador, Distribuidor e Assinantes e, em seguida, recrie a configuração.</span><span class="sxs-lookup"><span data-stu-id="0c208-180">Remove the replication configuration from the Publisher, Distributor and Subscribers, and then re-create the configuration.</span></span> <span data-ttu-id="0c208-181">Ao recriar as assinaturas, especifique que o Assinante já tem os dados.</span><span class="sxs-lookup"><span data-stu-id="0c208-181">When you re-create subscriptions, specify that the Subscriber already has the data.</span></span> <span data-ttu-id="0c208-182">A restauração está concluída.</span><span class="sxs-lookup"><span data-stu-id="0c208-182">The restore is completed.</span></span>  
  
         <span data-ttu-id="0c208-183">Para obter mais informações sobre como remover a replicação, consulte [sp_removedbreplication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-removedbreplication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="0c208-183">For more information about how to remove replication, see [sp_removedbreplication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-removedbreplication-transact-sql).</span></span>  
  
         <span data-ttu-id="0c208-184">Para obter mais informações sobre como especificar que o Assinante já tem os dados, consulte [Initialize a Subscription Manually](../initialize-a-subscription-manually.md).</span><span class="sxs-lookup"><span data-stu-id="0c208-184">For more information about how to specify that the Subscriber already has the data, see [Initialize a Subscription Manually](../initialize-a-subscription-manually.md).</span></span>  
  
5.  <span data-ttu-id="0c208-185">A opção **sync with backup** não estava definida no banco de dados de publicação.</span><span class="sxs-lookup"><span data-stu-id="0c208-185">The **sync with backup** option was not set on the publication database.</span></span> <span data-ttu-id="0c208-186">Portanto, as transações que não foram incluídas no backup restaurado podem ter sido entregues ao Distribuidor e Assinantes.</span><span class="sxs-lookup"><span data-stu-id="0c208-186">Therefore, transactions that were not included in the restored backup might have been delivered to the Distributor and Subscribers.</span></span> <span data-ttu-id="0c208-187">Agora, é necessário assegurar-se de que os Assinantes têm todos os comandos pendentes no banco de dados de distribuição e, em seguida, aplicar manualmente ao banco de dados de publicação quaisquer transações que não tenham sido incluídas no backup restaurado.</span><span class="sxs-lookup"><span data-stu-id="0c208-187">You must now make sure that Subscribers have all outstanding commands in the distribution database, and then manually apply to the publication database any transactions that are not included in the restored backup.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="0c208-188">Realizar esse processo pode fazer com que tabelas publicadas sejam restauradas em um point-in-time que é mais recente que o point-in-time de outras tabelas não publicadas que foram restauradas a partir do backup.</span><span class="sxs-lookup"><span data-stu-id="0c208-188">Performing this process can cause published tables to be restored to a point in time that is more recent than the point in time of other nonpublished tables that are restored from the backup.</span></span>  
  
    1.  <span data-ttu-id="0c208-189">Execute o Distribution Agent até que todos os Assinantes estejam sincronizados com os comandos pendentes no banco de dados de distribuição.</span><span class="sxs-lookup"><span data-stu-id="0c208-189">Run the Distribution Agent until all Subscribers are synchronized with the outstanding commands in the distribution database.</span></span> <span data-ttu-id="0c208-190">Verifique se todos os comandos foram entregues aos Assinantes usando a guia **Comandos não Distribuídos** no Replication Monitor ou consultando a exibição [MSdistribuition_status](/sql/relational-databases/system-views/msdistribution-status-transact-sql) no banco de dados de distribuição.</span><span class="sxs-lookup"><span data-stu-id="0c208-190">Verify that all commands are delivered to Subscribers by using the **Undistributed Commands** tab in Replication Monitor or by querying the [MSdistribution_status](/sql/relational-databases/system-views/msdistribution-status-transact-sql) view in the distribution database.</span></span> <span data-ttu-id="0c208-191">Vá para a etapa b.</span><span class="sxs-lookup"><span data-stu-id="0c208-191">Go to step b.</span></span>  
  
         <span data-ttu-id="0c208-192">Para obter mais informações sobre como executar um Agente de Distribuição, consulte [Iniciar e parar um agente de replicação &#40;SQL Server Management Studio&#41;](../agents/start-and-stop-a-replication-agent-sql-server-management-studio.md) e [Conceitos dos executáveis do agente de replicação](../concepts/replication-agent-executables-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="0c208-192">For more information about how to run the Distribution Agent, see [Start and Stop a Replication Agent &#40;SQL Server Management Studio&#41;](../agents/start-and-stop-a-replication-agent-sql-server-management-studio.md) and [Replication Agent Executables Concepts](../concepts/replication-agent-executables-concepts.md).</span></span>  
  
         <span data-ttu-id="0c208-193">Para obter mais informações sobre como verificar comandos, consulte [exibir comandos replicados e outras informações no banco de dados de distribuição &#40;Programação Transact-SQL de replicação&#41;](../monitor/view-replicated-commands-and-information-in-distribution-database.md) e [Exibir informações e executar tarefas usando o Replication Monitor](../monitor/view-information-and-perform-tasks-replication-monitor.md).</span><span class="sxs-lookup"><span data-stu-id="0c208-193">For more information about how to verify commands, see [View Replicated Commands and Other Information in the Distribution Database &#40;Replication Transact-SQL Programming&#41;](../monitor/view-replicated-commands-and-information-in-distribution-database.md) and [View Information and Perform Tasks using Replication Monitor](../monitor/view-information-and-perform-tasks-replication-monitor.md).</span></span>  
  
    2.  <span data-ttu-id="0c208-194">Use o [tablediff utility](../../../tools/tablediff-utility.md) ou outra ferramenta para sincronizar manualmente o Publicador com o Assinante.</span><span class="sxs-lookup"><span data-stu-id="0c208-194">Use the [tablediff utility](../../../tools/tablediff-utility.md) or another tool to manually synchronize the Publisher with the Subscriber.</span></span> <span data-ttu-id="0c208-195">Isso permitirá a recuperação dos dados do banco de dados de assinatura que não estavam contidos no backup de banco de dados de publicação.</span><span class="sxs-lookup"><span data-stu-id="0c208-195">This enables you to recover data from the subscription database that was not contained in the publication database backup.</span></span> <span data-ttu-id="0c208-196">Vá para a etapa c.</span><span class="sxs-lookup"><span data-stu-id="0c208-196">Go to step c.</span></span>  
  
         <span data-ttu-id="0c208-197">Para mais informações sobre como usar o utilitário **tablediff**, consulte [Comparar diferenças de tabelas replicadas &#40;Programação de Replicação&#41;](compare-replicated-tables-for-differences-replication-programming.md).</span><span class="sxs-lookup"><span data-stu-id="0c208-197">For more information about the **tablediff** utility, see [Compare Replicated Tables for Differences &#40;Replication Programming&#41;](compare-replicated-tables-for-differences-replication-programming.md).</span></span>  
  
    3.  <span data-ttu-id="0c208-198">O backup restaurado está completo e atualizado?</span><span class="sxs-lookup"><span data-stu-id="0c208-198">Is the restored backup complete and up-to-date?</span></span> <span data-ttu-id="0c208-199">Ele contém a configuração mais recente para todas as publicações e assinaturas?</span><span class="sxs-lookup"><span data-stu-id="0c208-199">Does it contain the latest configuration for all publications and subscriptions?</span></span> <span data-ttu-id="0c208-200">Se sim, execute o procedimento armazenado [sp_replrestart](/sql/relational-databases/system-stored-procedures/sp-replrestart-transact-sql) para sincronizar novamente os metadados do Publicador com os metadados do Distribuidor.</span><span class="sxs-lookup"><span data-stu-id="0c208-200">If yes, execute the [sp_replrestart](/sql/relational-databases/system-stored-procedures/sp-replrestart-transact-sql) stored procedure to resynchronize the Publisher metadata with the Distributor metadata.</span></span> <span data-ttu-id="0c208-201">A restauração está concluída.</span><span class="sxs-lookup"><span data-stu-id="0c208-201">The restore is completed.</span></span> <span data-ttu-id="0c208-202">Se não, vá para a etapa d.</span><span class="sxs-lookup"><span data-stu-id="0c208-202">If no, go to step d.</span></span>  
  
    4.  <span data-ttu-id="0c208-203">Remova a configuração de replicação do Publicador, Distribuidor e Assinantes e, em seguida, recrie a configuração.</span><span class="sxs-lookup"><span data-stu-id="0c208-203">Remove the replication configuration from the Publisher, Distributor and Subscribers, and then re-create the configuration.</span></span> <span data-ttu-id="0c208-204">Ao recriar as assinaturas, especifique que o Assinante já tem os dados.</span><span class="sxs-lookup"><span data-stu-id="0c208-204">When you re-create subscriptions, specify that the Subscriber already has the data.</span></span> <span data-ttu-id="0c208-205">A restauração está concluída.</span><span class="sxs-lookup"><span data-stu-id="0c208-205">The restore is completed.</span></span>  
  
         <span data-ttu-id="0c208-206">Para obter mais informações sobre como remover a replicação, consulte [sp_removedbreplication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-removedbreplication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="0c208-206">For more information about how to remove replication, see [sp_removedbreplication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-removedbreplication-transact-sql).</span></span>  
  
         <span data-ttu-id="0c208-207">Para obter mais informações sobre como especificar que o Assinante já tem os dados, consulte [Initialize a Subscription Manually](../initialize-a-subscription-manually.md).</span><span class="sxs-lookup"><span data-stu-id="0c208-207">For more information about how to specify that the Subscriber already has the data, see [Initialize a Subscription Manually](../initialize-a-subscription-manually.md).</span></span>  
  
#### <a name="publication-database-transactional-replication-with-updating-subscriptions"></a><span data-ttu-id="0c208-208">Banco de Dados de Publicação: Replicação transacional com assinaturas de atualização</span><span class="sxs-lookup"><span data-stu-id="0c208-208">Publication Database: Transactional Replication with Updating Subscriptions</span></span>  
  
1.  <span data-ttu-id="0c208-209">Restaure o último backup de banco de dados do banco de dados de publicação.</span><span class="sxs-lookup"><span data-stu-id="0c208-209">Restore the latest backup of the publication database.</span></span> <span data-ttu-id="0c208-210">Vá para a etapa 2.</span><span class="sxs-lookup"><span data-stu-id="0c208-210">Go to step 2.</span></span>  
  
2.  <span data-ttu-id="0c208-211">Execute o Distribution Agent até que todos os Assinantes estejam sincronizados com os comandos pendentes no banco de dados de distribuição.</span><span class="sxs-lookup"><span data-stu-id="0c208-211">Run the Distribution Agent until all Subscribers are synchronized with the outstanding commands in the distribution database.</span></span> <span data-ttu-id="0c208-212">Verifique se todos os comandos foram entregues aos Assinantes usando a guia **Comandos não Distribuídos** no Replication Monitor ou consultando a exibição [MSdistribuition_status](/sql/relational-databases/system-views/msdistribution-status-transact-sql) no banco de dados de distribuição.</span><span class="sxs-lookup"><span data-stu-id="0c208-212">Verify that all commands are delivered to Subscribers by using the **Undistributed Commands** tab in Replication Monitor, or by querying the [MSdistribution_status](/sql/relational-databases/system-views/msdistribution-status-transact-sql) view in the distribution database.</span></span> <span data-ttu-id="0c208-213">Vá para a etapa 3.</span><span class="sxs-lookup"><span data-stu-id="0c208-213">Go to step 3.</span></span>  
  
     <span data-ttu-id="0c208-214">Para obter mais informações sobre como executar um Agente de Distribuição, consulte [Iniciar e parar um agente de replicação &#40;SQL Server Management Studio&#41;](../agents/start-and-stop-a-replication-agent-sql-server-management-studio.md) e [Conceitos dos executáveis do agente de replicação](../concepts/replication-agent-executables-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="0c208-214">For more information about how to run the Distribution Agent, see [Start and Stop a Replication Agent &#40;SQL Server Management Studio&#41;](../agents/start-and-stop-a-replication-agent-sql-server-management-studio.md) and [Replication Agent Executables Concepts](../concepts/replication-agent-executables-concepts.md).</span></span>  
  
     <span data-ttu-id="0c208-215">Para obter mais informações sobre como verificar comandos, consulte [exibir comandos replicados e outras informações no banco de dados de distribuição &#40;Programação Transact-SQL de replicação&#41;](../monitor/view-replicated-commands-and-information-in-distribution-database.md) e [Exibir informações e executar tarefas usando o Replication Monitor](../monitor/view-information-and-perform-tasks-replication-monitor.md).</span><span class="sxs-lookup"><span data-stu-id="0c208-215">For more information about how to verify commands, see [View Replicated Commands and Other Information in the Distribution Database &#40;Replication Transact-SQL Programming&#41;](../monitor/view-replicated-commands-and-information-in-distribution-database.md) and [View Information and Perform Tasks using Replication Monitor](../monitor/view-information-and-perform-tasks-replication-monitor.md).</span></span>  
  
3.  <span data-ttu-id="0c208-216">Se você estiver usando assinaturas de atualização em fila, conecte a cada Assinante e exclua todas as linhas da tabela [MSreplication_queue &#40;Transact-SQL&#41;](/sql/relational-databases/system-tables/msreplication-queue-transact-sql) no banco de dados de assinatura.</span><span class="sxs-lookup"><span data-stu-id="0c208-216">If you are using queued updating subscriptions, connect to each Subscriber and delete all rows from the [MSreplication_queue &#40;Transact-SQL&#41;](/sql/relational-databases/system-tables/msreplication-queue-transact-sql) table in the subscription database.</span></span> <span data-ttu-id="0c208-217">Vá para a etapa 4.</span><span class="sxs-lookup"><span data-stu-id="0c208-217">Go to step 4.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="0c208-218">Se estiver usando assinaturas de atualização em fila e alguma tabela contiver colunas de identidade, é necessário assegurar-se de que os intervalos de identidade corretos serão atribuídos após a restauração.</span><span class="sxs-lookup"><span data-stu-id="0c208-218">If you are using queued updating subscriptions and any tables contain identity columns, you must make sure that the correct identity ranges are assigned after a restore.</span></span> <span data-ttu-id="0c208-219">Para obter mais informações, consulte [Replicar colunas de identidade](../publish/replicate-identity-columns.md).</span><span class="sxs-lookup"><span data-stu-id="0c208-219">For more information, see [Replicate Identity Columns](../publish/replicate-identity-columns.md).</span></span>  
  
4.  <span data-ttu-id="0c208-220">Agora, é necessário assegurar-se de que os Assinantes têm todos os comandos pendentes no banco de dados de distribuição e, em seguida, aplicar manualmente ao banco de dados de publicação quaisquer transações que não tenham sido incluídas no backup restaurado.</span><span class="sxs-lookup"><span data-stu-id="0c208-220">You must now make sure that Subscribers have all outstanding commands in the distribution database, and then manually apply to the publication database any transactions that are not included in the restored backup.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="0c208-221">Realizar esse processo pode fazer com que tabelas publicadas sejam restauradas em um point-in-time que é mais recente que o point-in-time de outras tabelas não publicadas que foram restauradas a partir do backup.</span><span class="sxs-lookup"><span data-stu-id="0c208-221">Performing this process can cause published tables to be restored to a point in time that is more recent than the point in time of other nonpublished tables that are restored from the backup.</span></span>  
  
    1.  <span data-ttu-id="0c208-222">Execute o Distribution Agent até que todos os Assinantes estejam sincronizados com os comandos pendentes no banco de dados de distribuição.</span><span class="sxs-lookup"><span data-stu-id="0c208-222">Run the Distribution Agent until all Subscribers are synchronized with the outstanding commands in the distribution database.</span></span> <span data-ttu-id="0c208-223">Verifique se todos os comandos foram entregues aos Assinantes usando o Replication Monitor ou consultando a exibição [MSdistribuition_status](/sql/relational-databases/system-views/msdistribution-status-transact-sql) no banco de dados de distribuição.</span><span class="sxs-lookup"><span data-stu-id="0c208-223">Verify that all commands are delivered to Subscribers by using Replication Monitor or by querying the [MSdistribution_status](/sql/relational-databases/system-views/msdistribution-status-transact-sql) view in the distribution database.</span></span> <span data-ttu-id="0c208-224">Vá para a etapa b.</span><span class="sxs-lookup"><span data-stu-id="0c208-224">Go to step b.</span></span>  
  
    2.  <span data-ttu-id="0c208-225">Use o [tablediff Utility](../../../tools/tablediff-utility.md) ou outra ferramenta para sincronizar manualmente o Publicador com o Assinante.</span><span class="sxs-lookup"><span data-stu-id="0c208-225">Use the [tablediff Utility](../../../tools/tablediff-utility.md) or another tool to manually synchronize the Publisher with the Subscriber.</span></span> <span data-ttu-id="0c208-226">Isso permitirá a recuperação dos dados do banco de dados de assinatura que não estavam contidos no backup de banco de dados de publicação.</span><span class="sxs-lookup"><span data-stu-id="0c208-226">This enables you to recover data from the subscription database that was not contained in the publication database backup.</span></span> <span data-ttu-id="0c208-227">Vá para a etapa c.</span><span class="sxs-lookup"><span data-stu-id="0c208-227">Go to step c.</span></span>  
  
         <span data-ttu-id="0c208-228">Para mais informações sobre como usar o utilitário **tablediff**, consulte [Comparar diferenças de tabelas replicadas &#40;Programação de Replicação&#41;](compare-replicated-tables-for-differences-replication-programming.md).</span><span class="sxs-lookup"><span data-stu-id="0c208-228">For more information about the **tablediff** utility, see [Compare Replicated Tables for Differences &#40;Replication Programming&#41;](compare-replicated-tables-for-differences-replication-programming.md).</span></span>  
  
    3.  <span data-ttu-id="0c208-229">O backup restaurado está completo e atualizado?</span><span class="sxs-lookup"><span data-stu-id="0c208-229">Is the restored backup complete and up-to-date?</span></span> <span data-ttu-id="0c208-230">Ele contém a configuração mais recente para todas as publicações e assinaturas?</span><span class="sxs-lookup"><span data-stu-id="0c208-230">Does it contain the latest configuration for all publications and subscriptions?</span></span> <span data-ttu-id="0c208-231">Se sim, execute o procedimento armazenado [sp_replrestart](/sql/relational-databases/system-stored-procedures/sp-replrestart-transact-sql) para sincronizar novamente os metadados do Publicador com os metadados do Distribuidor.</span><span class="sxs-lookup"><span data-stu-id="0c208-231">If yes, execute the [sp_replrestart](/sql/relational-databases/system-stored-procedures/sp-replrestart-transact-sql) stored procedure to resynchronize the Publisher metadata with the Distributor metadata.</span></span> <span data-ttu-id="0c208-232">A restauração está concluída.</span><span class="sxs-lookup"><span data-stu-id="0c208-232">The restore is completed.</span></span> <span data-ttu-id="0c208-233">Se não, vá para a etapa d.</span><span class="sxs-lookup"><span data-stu-id="0c208-233">If no, go to step d.</span></span>  
  
    4.  <span data-ttu-id="0c208-234">Remova a configuração de replicação do Publicador, Distribuidor e Assinantes e, em seguida, recrie a configuração.</span><span class="sxs-lookup"><span data-stu-id="0c208-234">Remove the replication configuration from the Publisher, Distributor and Subscribers, and then re-create the configuration.</span></span> <span data-ttu-id="0c208-235">Ao recriar as assinaturas, especifique que o Assinante já tem os dados.</span><span class="sxs-lookup"><span data-stu-id="0c208-235">When you re-create subscriptions, specify that the Subscriber already has the data.</span></span> <span data-ttu-id="0c208-236">A restauração está concluída.</span><span class="sxs-lookup"><span data-stu-id="0c208-236">The restore is completed.</span></span>  
  
         <span data-ttu-id="0c208-237">Para obter mais informações sobre como remover a replicação, consulte e [sp_removedbreplication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-removedbreplication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="0c208-237">For more information about how to remove replication, see and [sp_removedbreplication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-removedbreplication-transact-sql).</span></span>  
  
         <span data-ttu-id="0c208-238">Para obter mais informações sobre como especificar que o Assinante já tem os dados, consulte [Initialize a Subscription Manually](../initialize-a-subscription-manually.md).</span><span class="sxs-lookup"><span data-stu-id="0c208-238">For more information about how to specify that the Subscriber already has the data, see [Initialize a Subscription Manually](../initialize-a-subscription-manually.md).</span></span>  
  
#### <a name="publication-database-peer-to-peer-transactional-replication"></a><span data-ttu-id="0c208-239">Banco de Dados de Publicação: Peer-to-Peer Transactional Replication</span><span class="sxs-lookup"><span data-stu-id="0c208-239">Publication Database: Peer-to-Peer Transactional Replication</span></span>  
 <span data-ttu-id="0c208-240">Nas etapas seguintes, os bancos de dados de publicação **A**, **B**e **C** estão em uma topologia de replicação transacional ponto a ponto.</span><span class="sxs-lookup"><span data-stu-id="0c208-240">In the following steps, publication databases **A**, **B**, and **C** are in a peer-to-peer transactional replication topology.</span></span> <span data-ttu-id="0c208-241">Os bancos de dados **A** e **C** estão online e funcionando corretamente; o banco de dados **B** é o banco de dados a ser restaurado.</span><span class="sxs-lookup"><span data-stu-id="0c208-241">Databases **A** and **C** are online and functioning properly; database **B** is the database to be restored.</span></span> <span data-ttu-id="0c208-242">O processo aqui descrito, especialmente as etapas 7,10 e 11, são muito similares ao processo requerido para adicionar um nó a uma topologia ponto a ponto.</span><span class="sxs-lookup"><span data-stu-id="0c208-242">The process described here, especially steps 7, 10, and 11, is very similar to the process required to add a node to a peer-to-peer topology.</span></span> <span data-ttu-id="0c208-243">O modo mais direto para executar essas etapas é por meio do Assistente para Configurar Topologia Ponto a Ponto, mas você também pode usar procedimentos armazenados.</span><span class="sxs-lookup"><span data-stu-id="0c208-243">The most straightforward way to perform these steps is to use the Configure Peer-to-Peer Topology Wizard, but you can also use stored procedures.</span></span>  
  
1.  <span data-ttu-id="0c208-244">Execute os Agentes de Distribuição para sincronizar as assinaturas nos bancos de dados **A** e **C**. Vá para a etapa 2.</span><span class="sxs-lookup"><span data-stu-id="0c208-244">Run the Distribution Agents to synchronize the subscriptions at databases **A** and **C**. Go to step 2.</span></span>  
  
     <span data-ttu-id="0c208-245">Para obter mais informações sobre como executar um Agente de Distribuição, consulte [Iniciar e parar um agente de replicação &#40;SQL Server Management Studio&#41;](../agents/start-and-stop-a-replication-agent-sql-server-management-studio.md) e [Conceitos dos executáveis do agente de replicação](../concepts/replication-agent-executables-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="0c208-245">For more information about how to run the Distribution Agent, see [Start and Stop a Replication Agent &#40;SQL Server Management Studio&#41;](../agents/start-and-stop-a-replication-agent-sql-server-management-studio.md) and [Replication Agent Executables Concepts](../concepts/replication-agent-executables-concepts.md).</span></span>  
  
2.  <span data-ttu-id="0c208-246">Se o banco de dados de distribuição que **B** usa ainda estiver disponível, execute os Agentes de Distribuição para sincronizar as assinaturas entre os bancos de dados **B** e **A** e os bancos de dados B e **C**. Vá para a etapa 3.</span><span class="sxs-lookup"><span data-stu-id="0c208-246">If the distribution database that **B** uses is still available, run Distribution Agents to synchronize subscriptions between databases **B** and **A** and databases and B and **C**. Go to step 3.</span></span>  
  
3.  <span data-ttu-id="0c208-247">Remova os metadados do banco de dados de distribuição que **B** usa executando [sp_removedistpublisherdbreplication](/sql/relational-databases/system-stored-procedures/sp-removedistpublisherdbreplication-transact-sql) no banco de dados de distribuição para **B**. Vá para a etapa 4.</span><span class="sxs-lookup"><span data-stu-id="0c208-247">Remove metadata from the distribution database that **B** uses by executing [sp_removedistpublisherdbreplication](/sql/relational-databases/system-stored-procedures/sp-removedistpublisherdbreplication-transact-sql) at the distribution database for **B**. Go to step 4.</span></span>  
  
4.  <span data-ttu-id="0c208-248">Nos bancos de dados **A** e **C**, remova as assinaturas para a publicação no banco de dados **B**. Vá para a etapa 5.</span><span class="sxs-lookup"><span data-stu-id="0c208-248">At databases **A** and **C**, drop the subscriptions to the publication at database **B**. Go to step 5.</span></span>  
  
     <span data-ttu-id="0c208-249">Para obter mais informações sobre como descartar assinaturas, consulte [Subscribe to Publications](../subscribe-to-publications.md).</span><span class="sxs-lookup"><span data-stu-id="0c208-249">For more information about how to drop subscriptions, see [Subscribe to Publications](../subscribe-to-publications.md).</span></span>  
  
5.  <span data-ttu-id="0c208-250">Execute um backup de log ou um backup de banco de dados completo do banco de dados **A**. Vá para a etapa 6.</span><span class="sxs-lookup"><span data-stu-id="0c208-250">Perform a log backup or full backup of database **A**. Go to step 6.</span></span>  
  
6.  <span data-ttu-id="0c208-251">Restaure o backup do banco de dados **A** no banco de dados **B**. O banco de dados **B** agora tem os dados do banco de dados **A**, mas não a configuração de replicação.</span><span class="sxs-lookup"><span data-stu-id="0c208-251">Restore the backup of database **A** at database **B**. Database **B** now has the data from database **A**, but not the replication configuration.</span></span> <span data-ttu-id="0c208-252">Ao restaurar um backup em outro servidor, a replicação é removida, portanto a replicação foi removida do banco de dados **B**. Vá para a etapa 7.</span><span class="sxs-lookup"><span data-stu-id="0c208-252">When you restore a backup to another server, replication is removed; therefore, replication has been removed from database **B**. Go to step 7.</span></span>  
  
7.  <span data-ttu-id="0c208-253">Recrie a publicação no banco de dados **B** e, então, recrie as assinaturas entre os bancos de dados **A** e **B**. (Assinaturas que envolvem o banco de dados **C** serão tratadas mais tarde.).</span><span class="sxs-lookup"><span data-stu-id="0c208-253">Re-create the publication at database **B**, and then re-create subscriptions between databases **A** and **B**. (Subscriptions that involve database **C** are handled at a later stage.).</span></span>  
  
    1.  <span data-ttu-id="0c208-254">Recrie a publicação no banco de dados **B**. Vá para a etapa b.</span><span class="sxs-lookup"><span data-stu-id="0c208-254">Re-create the publication at database **B**. Go to step b.</span></span>  
  
    2.  <span data-ttu-id="0c208-255">Recrie a assinatura no banco de dados **B** para a publicação no banco **de dados a**, especificando que a assinatura deve ser inicializada com um backup (um valor de **inicializar com backup** para o **@sync_type** parâmetro de [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql)).</span><span class="sxs-lookup"><span data-stu-id="0c208-255">Re-create the subscription at database **B** to the publication at database **A**, specifying that the subscription should be initialized with a backup (a value of **initialize with backup** for the **@sync_type** parameter of [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql)).</span></span> <span data-ttu-id="0c208-256">Vá para a etapa c.</span><span class="sxs-lookup"><span data-stu-id="0c208-256">Go to step c.</span></span>  
  
    3.  <span data-ttu-id="0c208-257">Recrie a assinatura no banco **de** dados a para a publicação no banco de dado **B**, especificando que o Assinante já tem os dados (um valor de **suporte de replicação somente** para o **@sync_type** parâmetro de [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql)).</span><span class="sxs-lookup"><span data-stu-id="0c208-257">Re-create the subscription at database **A** to the publication at database **B**, specifying that the Subscriber already has the data (a value of **replication support only** for the **@sync_type** parameter of [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql)).</span></span> <span data-ttu-id="0c208-258">Vá para a etapa 8.</span><span class="sxs-lookup"><span data-stu-id="0c208-258">Go to step 8.</span></span>  
  
8.  <span data-ttu-id="0c208-259">Execute o Agente de Distribuição para sincronizar as assinaturas nos bancos de dados **A** e **B**. Se houver alguma coluna de identidade nas tabelas publicadas, vá para a etapa 9.</span><span class="sxs-lookup"><span data-stu-id="0c208-259">Run the Distribution Agents to synchronize the subscriptions at databases **A** and **B**. If there are any identity columns in published tables, go to step 9.</span></span> <span data-ttu-id="0c208-260">Caso contrário, vá para a etapa 10.</span><span class="sxs-lookup"><span data-stu-id="0c208-260">If not, go to step 10.</span></span>  
  
9. <span data-ttu-id="0c208-261">Após a restauração, o intervalo de identidade atribuído para cada tabela no banco de dados **A** será usado também no banco de dados **B**. Verifique se o banco de dados restaurado **B** recebeu todas as alterações do banco de dados que apresentou falha **B** que foram propagadas para o banco de dados **A** e o banco de dados **C**; e, então, propague novamente o intervalo de identidade para cada tabela.</span><span class="sxs-lookup"><span data-stu-id="0c208-261">After the restore, the identity range that you assigned for each table in database **A** would also be used in database **B**. Make sure that the restored database **B** has received all changes from the failed database **B** that were propagated to database **A** and database **C**; and then reseed the identity range for each table.</span></span>  
  
    1.  <span data-ttu-id="0c208-262">Execute [sp_requestpeerresponse](/sql/relational-databases/system-stored-procedures/sp-requestpeerresponse-transact-sql) no banco de dados **B** e recupere o parâmetro de saída **@request_id** .</span><span class="sxs-lookup"><span data-stu-id="0c208-262">Execute [sp_requestpeerresponse](/sql/relational-databases/system-stored-procedures/sp-requestpeerresponse-transact-sql) at database **B** and retrieve the output parameter **@request_id**.</span></span> <span data-ttu-id="0c208-263">Vá para a etapa b.</span><span class="sxs-lookup"><span data-stu-id="0c208-263">Go to step b.</span></span>  
  
    2.  <span data-ttu-id="0c208-264">Por padrão, o Distribution Agent está definido para executar continuamente; portanto, tokens devem ser enviados automaticamente a todos os nós.</span><span class="sxs-lookup"><span data-stu-id="0c208-264">By default, the Distribution Agent is set to run continuously; therefore, tokens should be sent to all nodes automatically.</span></span> <span data-ttu-id="0c208-265">Se o Distribution Agent não estiver executando em modo contínuo, execute o agente.</span><span class="sxs-lookup"><span data-stu-id="0c208-265">If the Distribution Agent is not running in continuous mode, run the agent.</span></span> <span data-ttu-id="0c208-266">Para obter mais informações, consulte [Conceitos Executáveis do Agente de Replicação](../concepts/replication-agent-executables-concepts.md) ou [Iniciar e Parar um Agente de Replicação &#40;SQL Server Management Studio&#41;](../agents/start-and-stop-a-replication-agent-sql-server-management-studio.md).</span><span class="sxs-lookup"><span data-stu-id="0c208-266">For more information, see [Replication Agent Executables Concepts](../concepts/replication-agent-executables-concepts.md) or [Start and Stop a Replication Agent &#40;SQL Server Management Studio&#41;](../agents/start-and-stop-a-replication-agent-sql-server-management-studio.md).</span></span> <span data-ttu-id="0c208-267">Vá para a etapa c.</span><span class="sxs-lookup"><span data-stu-id="0c208-267">Go to step c.</span></span>  
  
    3.  <span data-ttu-id="0c208-268">Execute [sp_helppeerresponses](/sql/relational-databases/system-stored-procedures/sp-helppeerresponses-transact-sql), fornecendo o **@request_id** valor recuperado na etapa b.</span><span class="sxs-lookup"><span data-stu-id="0c208-268">Execute [sp_helppeerresponses](/sql/relational-databases/system-stored-procedures/sp-helppeerresponses-transact-sql), providing the **@request_id** value retrieved in step b.</span></span> <span data-ttu-id="0c208-269">Espere até que todos os nós indiquem ter recebido a solicitação par.</span><span class="sxs-lookup"><span data-stu-id="0c208-269">Wait until all nodes indicate they have received the peer request.</span></span> <span data-ttu-id="0c208-270">Vá para a etapa d.</span><span class="sxs-lookup"><span data-stu-id="0c208-270">Go to step d.</span></span>  
  
    4.  <span data-ttu-id="0c208-271">Use [DBCC CHECKIDENT](/sql/t-sql/database-console-commands/dbcc-checkident-transact-sql) para propagar novamente cada tabela no banco de dados **B** para ter certeza de que um intervalo apropriado seja usado.</span><span class="sxs-lookup"><span data-stu-id="0c208-271">Use [DBCC CHECKIDENT](/sql/t-sql/database-console-commands/dbcc-checkident-transact-sql) to reseed each table in database **B** to make sure that an appropriate range is used.</span></span> <span data-ttu-id="0c208-272">Vá para a etapa 10.</span><span class="sxs-lookup"><span data-stu-id="0c208-272">Go to step 10.</span></span>  
  
     <span data-ttu-id="0c208-273">Para obter mais informações sobre como administrar os intervalos de identidade, consulte a seção “Atribuindo intervalos para administração manual do intervalo de identidade” de [Replicar colunas de identidades](../publish/replicate-identity-columns.md).</span><span class="sxs-lookup"><span data-stu-id="0c208-273">For more information about how to manage identity ranges, see the "Assigning ranges for manual identity range management" section of [Replicate Identity Columns](../publish/replicate-identity-columns.md).</span></span>  
  
10. <span data-ttu-id="0c208-274">Nesse ponto, o banco de dados **B** e o banco de dados **C** não estão diretamente conectados, mas receberão as alterações através do banco de dados **A**. Se a topologia contiver qualquer nó que estiver executando o [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], vá para a etapa 11; caso contrário, vá para a etapa 12.</span><span class="sxs-lookup"><span data-stu-id="0c208-274">At this point, database **B** and database **C** are not directly connected, but they will receive changes through database **A**. If the topology contains any nodes that are running [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], go to step 11; otherwise, go to step 12.</span></span>  
  
11. <span data-ttu-id="0c208-275">Confirme o sistema e, em seguida, recrie a assinatura entre os bancos de dados **B** e **C**. Confirmar um sistema envolve parar as atividades nas tabelas publicadas em todos os nós, e certificar-se de que todos os nós tenham recebido todas as alterações de todos os demais nós.</span><span class="sxs-lookup"><span data-stu-id="0c208-275">Quiesce the system, and then re-create the subscription between databases **B** and **C**. Quiescing a system involves stopping activity on published tables at all nodes and making sure of that each node has received all changes from all other nodes.</span></span>  
  
    1.  <span data-ttu-id="0c208-276">Pare todas as atividades nas tabelas publicadas na topologia ponto a ponto.</span><span class="sxs-lookup"><span data-stu-id="0c208-276">Stop all activity on published tables in the peer-to-peer topology.</span></span> <span data-ttu-id="0c208-277">Vá para a etapa b.</span><span class="sxs-lookup"><span data-stu-id="0c208-277">Go to step b.</span></span>  
  
    2.  <span data-ttu-id="0c208-278">Execute [sp_requestpeerresponse](/sql/relational-databases/system-stored-procedures/sp-requestpeerresponse-transact-sql) no banco de dados **B** e recupere o parâmetro de saída **@request_id** .</span><span class="sxs-lookup"><span data-stu-id="0c208-278">Execute [sp_requestpeerresponse](/sql/relational-databases/system-stored-procedures/sp-requestpeerresponse-transact-sql) at database **B** and retrieve the output parameter **@request_id**.</span></span> <span data-ttu-id="0c208-279">Vá para a etapa c.</span><span class="sxs-lookup"><span data-stu-id="0c208-279">Go to step c.</span></span>  
  
    3.  <span data-ttu-id="0c208-280">Por padrão, o Distribution Agent está definido para executar continuamente; portanto, tokens devem ser enviados automaticamente a todos os nós.</span><span class="sxs-lookup"><span data-stu-id="0c208-280">By default, the Distribution Agent is set to run continuously; therefore, tokens should be sent to all nodes automatically.</span></span> <span data-ttu-id="0c208-281">Se o Distribution Agent não estiver executando em modo contínuo, execute o agente.</span><span class="sxs-lookup"><span data-stu-id="0c208-281">If the Distribution Agent is not running in continuous mode, run the agent.</span></span> <span data-ttu-id="0c208-282">Vá para a etapa d.</span><span class="sxs-lookup"><span data-stu-id="0c208-282">Go to step d.</span></span>  
  
    4.  <span data-ttu-id="0c208-283">Execute [sp_helppeerresponses](/sql/relational-databases/system-stored-procedures/sp-helppeerresponses-transact-sql), fornecendo o **@request_id** valor recuperado na etapa b.</span><span class="sxs-lookup"><span data-stu-id="0c208-283">Execute [sp_helppeerresponses](/sql/relational-databases/system-stored-procedures/sp-helppeerresponses-transact-sql), providing the **@request_id** value retrieved in step b.</span></span> <span data-ttu-id="0c208-284">Espere até que todos os nós indiquem ter recebido a solicitação par.</span><span class="sxs-lookup"><span data-stu-id="0c208-284">Wait until all nodes indicate they have received the peer request.</span></span> <span data-ttu-id="0c208-285">Vá para a etapa e.</span><span class="sxs-lookup"><span data-stu-id="0c208-285">Go to step e.</span></span>  
  
    5.  <span data-ttu-id="0c208-286">Recrie a assinatura no banco de dados **B** para a publicação no banco de dados **C**, especificando que o Assinante já possui os dados.</span><span class="sxs-lookup"><span data-stu-id="0c208-286">Re-create the subscription at database **B** to the publication at database **C**, specifying that the Subscriber already has the data.</span></span> <span data-ttu-id="0c208-287">Vá para a etapa b.</span><span class="sxs-lookup"><span data-stu-id="0c208-287">Go to step b.</span></span>  
  
    6.  <span data-ttu-id="0c208-288">Recrie a assinatura no banco de dados **C** para a publicação no banco de dados **B**, especificando que o Assinante já possui os dados.</span><span class="sxs-lookup"><span data-stu-id="0c208-288">Re-create the subscription at database **C** to the publication at database **B**, specifying that the Subscriber already has the data.</span></span> <span data-ttu-id="0c208-289">Vá para a etapa 13.</span><span class="sxs-lookup"><span data-stu-id="0c208-289">Go to step 13.</span></span>  
  
12. <span data-ttu-id="0c208-290">Recrie a assinatura entre os bancos de dados **B** e **C**:</span><span class="sxs-lookup"><span data-stu-id="0c208-290">Re-create the subscription between databases **B** and **C**:</span></span>  
  
    1.  <span data-ttu-id="0c208-291">No banco de dados **B**, consulte a tabela [MSpeer_lsns](/sql/relational-databases/system-tables/mspeer-lsns-transact-sql) para recuperar o LSN (número de sequência de log) da mais recente transação que o banco de dados **B** recebeu do banco de dados **C**.</span><span class="sxs-lookup"><span data-stu-id="0c208-291">At database **B**, query the [MSpeer_lsns](/sql/relational-databases/system-tables/mspeer-lsns-transact-sql) table to retrieve the log sequence number (LSN) of the most recent transaction that database **B** has received from database **C**.</span></span>  
  
    2.  <span data-ttu-id="0c208-292">Recrie a assinatura no banco de dados **B** para a publicação no banco de dados **C**, especificando que a assinatura deve ser inicializada com base no LSN (um valor de **inicializar do lsn** para o **@sync_type** parâmetro de [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql)).</span><span class="sxs-lookup"><span data-stu-id="0c208-292">Re-create the subscription at database **B** to the publication at database **C**, specifying that the subscription should be initialized based on LSN (a value of **initialize from lsn** for the **@sync_type** parameter of [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql)).</span></span> <span data-ttu-id="0c208-293">Vá para a etapa b.</span><span class="sxs-lookup"><span data-stu-id="0c208-293">Go to step b.</span></span>  
  
    3.  <span data-ttu-id="0c208-294">Recrie a assinatura no banco de dados **C** para a publicação no banco de dados **B**, especificando que o Assinante já possui os dados.</span><span class="sxs-lookup"><span data-stu-id="0c208-294">Re-create the subscription at database **C** to the publication at database **B**, specifying that the Subscriber already has the data.</span></span> <span data-ttu-id="0c208-295">Vá para a etapa 13.</span><span class="sxs-lookup"><span data-stu-id="0c208-295">Go to step 13.</span></span>  
  
13. <span data-ttu-id="0c208-296">Execute os Distribution Agents para sincronizar as assinaturas nos bancos de dados **B** e **C**. A restauração está concluída.</span><span class="sxs-lookup"><span data-stu-id="0c208-296">Run the Distribution Agents to synchronize the subscriptions at databases **B** and **C**. The restore is completed.</span></span>  
  
#### <a name="msdb-database-publisher"></a><span data-ttu-id="0c208-297">Banco de dados msdb (Publicador)</span><span class="sxs-lookup"><span data-stu-id="0c208-297">msdb Database (Publisher)</span></span>  
  
1.  <span data-ttu-id="0c208-298">Restaure o último backup do banco de dados **msdb** .</span><span class="sxs-lookup"><span data-stu-id="0c208-298">Restore the latest backup of the **msdb** database.</span></span>  
  
2.  <span data-ttu-id="0c208-299">O backup restaurado está completo e atualizado?</span><span class="sxs-lookup"><span data-stu-id="0c208-299">Is the restored backup complete and up-to-date?</span></span> <span data-ttu-id="0c208-300">Ele contém a configuração mais recente para todas as publicações e assinaturas?</span><span class="sxs-lookup"><span data-stu-id="0c208-300">Does it contain the latest configuration for all publications and subscriptions?</span></span> <span data-ttu-id="0c208-301">Se sim, a recuperação está concluída.</span><span class="sxs-lookup"><span data-stu-id="0c208-301">If yes, recovery is completed.</span></span> <span data-ttu-id="0c208-302">Se não, vá para a etapa 3.</span><span class="sxs-lookup"><span data-stu-id="0c208-302">If no, go to step 3.</span></span>  
  
3.  <span data-ttu-id="0c208-303">Recrie o trabalho de limpeza de assinatura de seus scripts de replicação.</span><span class="sxs-lookup"><span data-stu-id="0c208-303">Re-create the subscription cleanup job from your replication scripts.</span></span> <span data-ttu-id="0c208-304">A recuperação está concluída.</span><span class="sxs-lookup"><span data-stu-id="0c208-304">Recovery is completed.</span></span>  
  
#### <a name="master-database-publisher"></a><span data-ttu-id="0c208-305">Banco de dados mestre (Publicador)</span><span class="sxs-lookup"><span data-stu-id="0c208-305">master Database (Publisher)</span></span>  
  
1.  <span data-ttu-id="0c208-306">Restaure o último backup do banco de dados **mestre** .</span><span class="sxs-lookup"><span data-stu-id="0c208-306">Restore the latest backup of the **master** database.</span></span>  
  
2.  <span data-ttu-id="0c208-307">Tenha certeza de que o banco de dados é consistente com o banco de dados de publicação com respeito a configuração de replicação e configurações.</span><span class="sxs-lookup"><span data-stu-id="0c208-307">Make sure that the database is consistent with the publication database with regard to replication configuration and settings.</span></span>  
  
### <a name="databases-at-the-distributor"></a><span data-ttu-id="0c208-308">Bancos de dados no Distribuidor</span><span class="sxs-lookup"><span data-stu-id="0c208-308">Databases at the Distributor</span></span>  
  
#### <a name="distribution-database"></a><span data-ttu-id="0c208-309">Banco de dados de distribuição</span><span class="sxs-lookup"><span data-stu-id="0c208-309">Distribution Database</span></span>  
  
1.  <span data-ttu-id="0c208-310">Restaure o último backup de banco de dados do banco de dados de distribuição.</span><span class="sxs-lookup"><span data-stu-id="0c208-310">Restore the latest backup of the distribution database.</span></span>  
  
2.  <span data-ttu-id="0c208-311">A configuração **sync with backup** foi habilitada no banco de dados de distribuição antes da falha?</span><span class="sxs-lookup"><span data-stu-id="0c208-311">Was the **sync with backup** setting enabled on the distribution database before the failure?</span></span> <span data-ttu-id="0c208-312">Em caso afirmativo, vá para a etapa 3; se não, vá para a etapa 4.</span><span class="sxs-lookup"><span data-stu-id="0c208-312">If yes, go to step 3; if no, go to step 4.</span></span>  
  
     <span data-ttu-id="0c208-313">Se a configuração estiver habilitada, a consulta `SELECT DATABASEPROPERTYEX('<DistributionDatabaseName>', 'IsSyncWithBackup')` retornará ‘1'.</span><span class="sxs-lookup"><span data-stu-id="0c208-313">If the setting is enabled, the query `SELECT DATABASEPROPERTYEX('<DistributionDatabaseName>', 'IsSyncWithBackup')` returns '1'.</span></span>  
  
3.  <span data-ttu-id="0c208-314">O backup restaurado está completo e atualizado?</span><span class="sxs-lookup"><span data-stu-id="0c208-314">Is the restored backup complete and up-to-date?</span></span> <span data-ttu-id="0c208-315">Ele contém a configuração mais recente para todas as publicações e assinaturas?</span><span class="sxs-lookup"><span data-stu-id="0c208-315">Does it contain the latest configuration for all publications and subscriptions?</span></span> <span data-ttu-id="0c208-316">Se sim, a recuperação está concluída.</span><span class="sxs-lookup"><span data-stu-id="0c208-316">If yes, recovery is completed.</span></span> <span data-ttu-id="0c208-317">Se não, vá para a etapa 4.</span><span class="sxs-lookup"><span data-stu-id="0c208-317">If no, go to step 4.</span></span>  
  
4.  <span data-ttu-id="0c208-318">A informação de configuração do banco de dados de distribuição restaurado não está atualizada ou a opção **sync with backup** não foi definida no banco de dados de distribuição.</span><span class="sxs-lookup"><span data-stu-id="0c208-318">Either the configuration information in the restored distribution database is not up-to-date, or the **sync with backup** option was not set on the distribution database.</span></span> <span data-ttu-id="0c208-319">(Após a restauração, o banco de dados de distribuição pode ter transações faltantes que foram confirmadas no Publicador, mas que ainda não foram entregues aos Assinantes). Remova e recrie a replicação. Depois, execute a validação.</span><span class="sxs-lookup"><span data-stu-id="0c208-319">(After the restore, the distribution database might be missing transactions that were committed at the Publisher but have not yet been delivered to Subscribers.) Drop and re-create replication, and then run validation.</span></span>  
  
    1.  <span data-ttu-id="0c208-320">Remova a configuração de replicação do Publicador, Distribuidor e Assinantes e, em seguida, recrie a configuração.</span><span class="sxs-lookup"><span data-stu-id="0c208-320">Remove the replication configuration from the Publisher, Distributor and Subscribers, and then re-create the configuration.</span></span> <span data-ttu-id="0c208-321">Ao recriar as assinaturas, especifique que o Assinante já tem os dados.</span><span class="sxs-lookup"><span data-stu-id="0c208-321">When you re-create subscriptions, specify that the Subscriber already has the data.</span></span> <span data-ttu-id="0c208-322">Vá para a etapa b.</span><span class="sxs-lookup"><span data-stu-id="0c208-322">Go to step b.</span></span>  
  
         <span data-ttu-id="0c208-323">Para obter mais informações sobre como remover a replicação, consulte [sp_removedbreplication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-removedbreplication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="0c208-323">For more information about how to remove replication, see [sp_removedbreplication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-removedbreplication-transact-sql).</span></span>  
  
         <span data-ttu-id="0c208-324">Para obter mais informações sobre como especificar que o Assinante já tem os dados, consulte [Initialize a Subscription Manually](../initialize-a-subscription-manually.md).</span><span class="sxs-lookup"><span data-stu-id="0c208-324">For more information about how to specify that the Subscriber already has the data, see [Initialize a Subscription Manually](../initialize-a-subscription-manually.md).</span></span>  
  
    2.  <span data-ttu-id="0c208-325">Marque todas as publicações para validação.</span><span class="sxs-lookup"><span data-stu-id="0c208-325">Mark all publications for validation.</span></span> <span data-ttu-id="0c208-326">Reinicialize quaisquer assinaturas com falha de validação.</span><span class="sxs-lookup"><span data-stu-id="0c208-326">Reinitialize any subscriptions that fail validation.</span></span> <span data-ttu-id="0c208-327">A recuperação está concluída.</span><span class="sxs-lookup"><span data-stu-id="0c208-327">Recovery is completed.</span></span>  
  
         <span data-ttu-id="0c208-328">Para obter mais informações sobre validação, consulte [Validate Replicated Data](../validate-data-at-the-subscriber.md).</span><span class="sxs-lookup"><span data-stu-id="0c208-328">For more information about validation, see [Validate Replicated Data](../validate-data-at-the-subscriber.md).</span></span> <span data-ttu-id="0c208-329">Para mais informações sobre reinicialização, consulte [Reinicializar as assinaturas](../reinitialize-subscriptions.md).</span><span class="sxs-lookup"><span data-stu-id="0c208-329">For more information about reinitialization, see [Reinitialize Subscriptions](../reinitialize-subscriptions.md).</span></span>  
  
#### <a name="msdb-database-distributor"></a><span data-ttu-id="0c208-330">Banco de dados msdb (Distribuidor)</span><span class="sxs-lookup"><span data-stu-id="0c208-330">msdb Database (Distributor)</span></span>  
  
1.  <span data-ttu-id="0c208-331">Restaure o último backup do banco de dados **msdb** .</span><span class="sxs-lookup"><span data-stu-id="0c208-331">Restore the latest backup of the **msdb** database.</span></span>  
  
2.  <span data-ttu-id="0c208-332">O backup restaurado está completo e atualizado?</span><span class="sxs-lookup"><span data-stu-id="0c208-332">Is the restored backup complete and up-to-date?</span></span> <span data-ttu-id="0c208-333">Ele contém a configuração mais recente para todas as publicações e assinaturas?</span><span class="sxs-lookup"><span data-stu-id="0c208-333">Does it contain the latest configuration for all publications and subscriptions?</span></span> <span data-ttu-id="0c208-334">Se sim, a recuperação está concluída.</span><span class="sxs-lookup"><span data-stu-id="0c208-334">If yes, recovery is completed.</span></span> <span data-ttu-id="0c208-335">Se não, vá para a etapa 3.</span><span class="sxs-lookup"><span data-stu-id="0c208-335">If no, go to step 3.</span></span>  
  
3.  <span data-ttu-id="0c208-336">Remova a configuração de replicação do Publicador, Distribuidor e Assinantes e, em seguida, recrie a configuração.</span><span class="sxs-lookup"><span data-stu-id="0c208-336">Remove the replication configuration from the Publisher, Distributor and Subscribers, and then re-create the configuration.</span></span> <span data-ttu-id="0c208-337">Ao recriar as assinaturas, especifique que o Assinante já tem os dados.</span><span class="sxs-lookup"><span data-stu-id="0c208-337">When you re-create subscriptions, specify that the Subscriber already has the data.</span></span> <span data-ttu-id="0c208-338">Vá para a etapa 4.</span><span class="sxs-lookup"><span data-stu-id="0c208-338">Go to step 4.</span></span>  
  
     <span data-ttu-id="0c208-339">Para obter mais informações sobre como remover a replicação, consulte [sp_removedbreplication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-removedbreplication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="0c208-339">For more information about how to remove replication, see [sp_removedbreplication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-removedbreplication-transact-sql).</span></span>  
  
     <span data-ttu-id="0c208-340">Para obter mais informações sobre como especificar que o Assinante já tem os dados, consulte [Initialize a Subscription Manually](../initialize-a-subscription-manually.md).</span><span class="sxs-lookup"><span data-stu-id="0c208-340">For more information about how to specify that the Subscriber already has the data, see [Initialize a Subscription Manually](../initialize-a-subscription-manually.md).</span></span>  
  
4.  <span data-ttu-id="0c208-341">Marque todas as publicações para validação.</span><span class="sxs-lookup"><span data-stu-id="0c208-341">Mark all publications for validation.</span></span> <span data-ttu-id="0c208-342">Reinicialize quaisquer assinaturas com falha de validação.</span><span class="sxs-lookup"><span data-stu-id="0c208-342">Reinitialize any subscriptions that fail validation.</span></span> <span data-ttu-id="0c208-343">A recuperação está concluída.</span><span class="sxs-lookup"><span data-stu-id="0c208-343">Recovery is completed.</span></span>  
  
     <span data-ttu-id="0c208-344">Para obter mais informações sobre validação, consulte [Validate Replicated Data](../validate-data-at-the-subscriber.md).</span><span class="sxs-lookup"><span data-stu-id="0c208-344">For more information about validation, see [Validate Replicated Data](../validate-data-at-the-subscriber.md).</span></span> <span data-ttu-id="0c208-345">Para mais informações sobre reinicialização, consulte [Reinicializar as assinaturas](../reinitialize-subscriptions.md).</span><span class="sxs-lookup"><span data-stu-id="0c208-345">For more information about reinitialization, see [Reinitialize Subscriptions](../reinitialize-subscriptions.md).</span></span>  
  
#### <a name="master-database-distributor"></a><span data-ttu-id="0c208-346">Banco de dados mestre (Distribuidor)</span><span class="sxs-lookup"><span data-stu-id="0c208-346">master Database (Distributor)</span></span>  
  
1.  <span data-ttu-id="0c208-347">Restaure o último backup do banco de dados **mestre** .</span><span class="sxs-lookup"><span data-stu-id="0c208-347">Restore the latest backup of the **master** database.</span></span>  
  
2.  <span data-ttu-id="0c208-348">Tenha certeza de que o banco de dados é consistente com o banco de dados de publicação com respeito a configuração de replicação e configurações.</span><span class="sxs-lookup"><span data-stu-id="0c208-348">Make sure that the database is consistent with the publication database with regard to replication configuration and settings.</span></span>  
  
### <a name="databases-at-the-subscriber"></a><span data-ttu-id="0c208-349">Bancos de dados no Assinante</span><span class="sxs-lookup"><span data-stu-id="0c208-349">Databases at the Subscriber</span></span>  
  
#### <a name="subscription-database"></a><span data-ttu-id="0c208-350">Banco de dados de assinatura</span><span class="sxs-lookup"><span data-stu-id="0c208-350">Subscription Database</span></span>  
  
1.  <span data-ttu-id="0c208-351">É o último backup do banco de dados de assinaturas mais recente do que a configuração de retenção mínima de distribuição no banco de dados de distribuição?</span><span class="sxs-lookup"><span data-stu-id="0c208-351">Is the latest subscription database backup more recent than the minimum distribution retention setting on the distribution database?</span></span> <span data-ttu-id="0c208-352">(Isso determina se o Distribuidor ainda tem todos os comandos que são exigidos para deixar o Assinante atualizado.) Se sim, vá para a etapa 2.</span><span class="sxs-lookup"><span data-stu-id="0c208-352">(This determines whether the Distributor still has all the commands that are required to bring the Subscriber up-to-date.) If yes, go to step 2.</span></span> <span data-ttu-id="0c208-353">Se não, reinicialize a assinatura.</span><span class="sxs-lookup"><span data-stu-id="0c208-353">If no, reinitialize the subscription.</span></span> <span data-ttu-id="0c208-354">A recuperação está concluída.</span><span class="sxs-lookup"><span data-stu-id="0c208-354">Recovery is completed.</span></span>  
  
     <span data-ttu-id="0c208-355">Para determinar a configuração de máxima retenção de distribuição, execute [sp_helpdistributiondb](/sql/relational-databases/system-stored-procedures/sp-helpdistributiondb-transact-sql) e recupere o valor da coluna **max_distretention** (esse valor é em horas).</span><span class="sxs-lookup"><span data-stu-id="0c208-355">To determine the maximum distribution retention setting, execute [sp_helpdistributiondb](/sql/relational-databases/system-stored-procedures/sp-helpdistributiondb-transact-sql) and retrieve the value from the **max_distretention** column (this value is in hours).</span></span>  
  
     <span data-ttu-id="0c208-356">Para obter mais informações sobre como reinicializar uma assinatura, consulte [Reinitialize a Subscription](../reinitialize-a-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="0c208-356">For more information about how to reinitialize a subscription, see [Reinitialize a Subscription](../reinitialize-a-subscription.md).</span></span>  
  
2.  <span data-ttu-id="0c208-357">Restaure o último backup de banco de dados de assinatura.</span><span class="sxs-lookup"><span data-stu-id="0c208-357">Restore the latest subscription database backup.</span></span> <span data-ttu-id="0c208-358">Vá para a etapa 3.</span><span class="sxs-lookup"><span data-stu-id="0c208-358">Go to step 3.</span></span>  
  
3.  <span data-ttu-id="0c208-359">Se o banco de dados de assinatura só contiver assinaturas push, vá para etapa 4.</span><span class="sxs-lookup"><span data-stu-id="0c208-359">If the subscription database contains only push subscriptions, go to step 4.</span></span> <span data-ttu-id="0c208-360">Se o banco de dados de assinatura contiver qualquer assinatura pull, faça as seguintes perguntas: As informações de assinatura estão atualizadas?</span><span class="sxs-lookup"><span data-stu-id="0c208-360">If the subscription database contains any pull subscriptions, ask the following questions: Is the subscription information current?</span></span> <span data-ttu-id="0c208-361">O banco de dados inclui todas as tabelas e opções que foram definidas na hora da falha?</span><span class="sxs-lookup"><span data-stu-id="0c208-361">Does the database include all tables and options that were set at the time of failure.</span></span> <span data-ttu-id="0c208-362">Se sim, vá para a etapa 4.</span><span class="sxs-lookup"><span data-stu-id="0c208-362">If yes, go to step 4.</span></span> <span data-ttu-id="0c208-363">Se não, reinicialize a assinatura.</span><span class="sxs-lookup"><span data-stu-id="0c208-363">If no, reinitialize the subscription.</span></span> <span data-ttu-id="0c208-364">A recuperação está concluída.</span><span class="sxs-lookup"><span data-stu-id="0c208-364">Recovery is completed.</span></span>  
  
4.  <span data-ttu-id="0c208-365">Para sincronizar o Assinante, execute o Distribution Agent.</span><span class="sxs-lookup"><span data-stu-id="0c208-365">To synchronize the Subscriber, run the Distribution Agent.</span></span> <span data-ttu-id="0c208-366">A recuperação está concluída.</span><span class="sxs-lookup"><span data-stu-id="0c208-366">Recovery is completed.</span></span>  
  
     <span data-ttu-id="0c208-367">Para obter mais informações sobre como executar um Agente de Distribuição, consulte [Iniciar e parar um agente de replicação &#40;SQL Server Management Studio&#41;](../agents/start-and-stop-a-replication-agent-sql-server-management-studio.md) e [Conceitos dos executáveis do agente de replicação](../concepts/replication-agent-executables-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="0c208-367">For more information about how to run the Distribution Agent, see [Start and Stop a Replication Agent &#40;SQL Server Management Studio&#41;](../agents/start-and-stop-a-replication-agent-sql-server-management-studio.md) and [Replication Agent Executables Concepts](../concepts/replication-agent-executables-concepts.md).</span></span>  
  
#### <a name="msdb-database-subscriber"></a><span data-ttu-id="0c208-368">Banco de dados msdb (Assinante)</span><span class="sxs-lookup"><span data-stu-id="0c208-368">msdb Database (Subscriber)</span></span>  
  
1.  <span data-ttu-id="0c208-369">Restaure o último backup do banco de dados **msdb** .</span><span class="sxs-lookup"><span data-stu-id="0c208-369">Restore the latest backup of the **msdb** database.</span></span> <span data-ttu-id="0c208-370">São usadas assinaturas pull nesse Assinante?</span><span class="sxs-lookup"><span data-stu-id="0c208-370">Are pull subscriptions used at this Subscriber?</span></span> <span data-ttu-id="0c208-371">Se não, a restauração está concluída.</span><span class="sxs-lookup"><span data-stu-id="0c208-371">If no, the restore is completed.</span></span> <span data-ttu-id="0c208-372">Se sim, vá para a etapa 2.</span><span class="sxs-lookup"><span data-stu-id="0c208-372">If yes, go to step 2.</span></span>  
  
2.  <span data-ttu-id="0c208-373">O backup restaurado está completo e atualizado?</span><span class="sxs-lookup"><span data-stu-id="0c208-373">Is the restored backup complete and up-to-date?</span></span> <span data-ttu-id="0c208-374">Ele contém a configuração mais recente para todas as assinaturas pull?</span><span class="sxs-lookup"><span data-stu-id="0c208-374">Does it contain the latest configuration for all pull subscriptions?</span></span> <span data-ttu-id="0c208-375">Se sim, a recuperação está concluída.</span><span class="sxs-lookup"><span data-stu-id="0c208-375">If yes, recovery is completed.</span></span> <span data-ttu-id="0c208-376">Se não, vá para a etapa 3.</span><span class="sxs-lookup"><span data-stu-id="0c208-376">If no, go to step 3.</span></span>  
  
3.  <span data-ttu-id="0c208-377">Descartar e recriar as assinaturas pull.</span><span class="sxs-lookup"><span data-stu-id="0c208-377">Drop and re-create the pull subscriptions.</span></span> <span data-ttu-id="0c208-378">Ao recriar as assinaturas, especifique que o Assinante já tem os dados.</span><span class="sxs-lookup"><span data-stu-id="0c208-378">When you re-create the subscriptions, specify that the Subscriber already has the data.</span></span> <span data-ttu-id="0c208-379">A restauração está concluída.</span><span class="sxs-lookup"><span data-stu-id="0c208-379">The restore is completed.</span></span>  
  
     <span data-ttu-id="0c208-380">Para obter mais informações sobre como descartar assinaturas, consulte [Subscribe to Publications](../subscribe-to-publications.md).</span><span class="sxs-lookup"><span data-stu-id="0c208-380">For more information about how to drop subscriptions, see [Subscribe to Publications](../subscribe-to-publications.md).</span></span>  
  
     <span data-ttu-id="0c208-381">Para obter mais informações sobre como especificar que o Assinante já tem os dados, consulte [Initialize a Subscription Manually](../initialize-a-subscription-manually.md).</span><span class="sxs-lookup"><span data-stu-id="0c208-381">For more information about how to specify that the Subscriber already has the data, see [Initialize a Subscription Manually](../initialize-a-subscription-manually.md).</span></span>  
  
#### <a name="master-database-subscriber"></a><span data-ttu-id="0c208-382">Banco de dados mestre (Assinante)</span><span class="sxs-lookup"><span data-stu-id="0c208-382">master Database (Subscriber)</span></span>  
  
1.  <span data-ttu-id="0c208-383">Restaure o último backup do banco de dados **mestre** .</span><span class="sxs-lookup"><span data-stu-id="0c208-383">Restore the latest backup of the **master** database.</span></span>  
  
2.  <span data-ttu-id="0c208-384">Tenha certeza de que o banco de dados é consistente com o banco de dados de publicação com respeito a configuração de replicação e configurações.</span><span class="sxs-lookup"><span data-stu-id="0c208-384">Make sure that the database is consistent with the publication database with regard to replication configuration and settings.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0c208-385">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="0c208-385">See Also</span></span>  
 <span data-ttu-id="0c208-386">[Fazer backup e restaurar bancos de dados do SQL Server](../../backup-restore/back-up-and-restore-of-sql-server-databases.md) </span><span class="sxs-lookup"><span data-stu-id="0c208-386">[Back Up and Restore of SQL Server Databases](../../backup-restore/back-up-and-restore-of-sql-server-databases.md) </span></span>  
 <span data-ttu-id="0c208-387">[Fazer backup e restaurar bancos de dados replicados](back-up-and-restore-replicated-databases.md) </span><span class="sxs-lookup"><span data-stu-id="0c208-387">[Back Up and Restore Replicated Databases](back-up-and-restore-replicated-databases.md) </span></span>  
 <span data-ttu-id="0c208-388">[Configurar Distribuição](../configure-distribution.md) </span><span class="sxs-lookup"><span data-stu-id="0c208-388">[Configure Distribution](../configure-distribution.md) </span></span>  
 <span data-ttu-id="0c208-389">[Publicar dados e objetos de banco de dados](../publish/publish-data-and-database-objects.md) </span><span class="sxs-lookup"><span data-stu-id="0c208-389">[Publish Data and Database Objects](../publish/publish-data-and-database-objects.md) </span></span>  
 <span data-ttu-id="0c208-390">[Subscribe to Publications](../subscribe-to-publications.md) </span><span class="sxs-lookup"><span data-stu-id="0c208-390">[Subscribe to Publications](../subscribe-to-publications.md) </span></span>  
 <span data-ttu-id="0c208-391">[Inicializar uma assinatura](../initialize-a-subscription.md) </span><span class="sxs-lookup"><span data-stu-id="0c208-391">[Initialize a Subscription](../initialize-a-subscription.md) </span></span>  
 [<span data-ttu-id="0c208-392">Sincronizar dados</span><span class="sxs-lookup"><span data-stu-id="0c208-392">Synchronize Data</span></span>](../synchronize-data.md)  
  
  
