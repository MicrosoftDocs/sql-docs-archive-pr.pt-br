---
title: Criar uma assinatura push | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- push subscriptions [SQL Server replication], creating
- merge replication subscribing [SQL Server replication], push subscriptions
- subscriptions [SQL Server replication], push
- snapshot replication [SQL Server], subscribing
- transactional replication, subscribing
ms.assetid: adfbbc61-58d1-4330-9ad6-b14ab1142e2b
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 2195d96f4337cc60ba213deb5e3cc2831d27da76
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87584118"
---
# <a name="create-a-push-subscription"></a><span data-ttu-id="dae0d-102">Criar uma assinatura push</span><span class="sxs-lookup"><span data-stu-id="dae0d-102">Create a Push Subscription</span></span>
  <span data-ttu-id="dae0d-103">Este tópico descreve como criar uma assinatura push no [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] usando o [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../includes/tsql-md.md)]ou RMO (Replication Management Objects).</span><span class="sxs-lookup"><span data-stu-id="dae0d-103">This topic describes how to create a push subscription in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../includes/tsql-md.md)], or Replication Management Objects (RMO).</span></span> <span data-ttu-id="dae0d-104">Para obter informações sobre como criar uma assinatura push para um assinante não [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , consulte [criar uma assinatura para um assinante não SQL Server](create-a-subscription-for-a-non-sql-server-subscriber.md).</span><span class="sxs-lookup"><span data-stu-id="dae0d-104">For information about creating a push subscription for a non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscriber, see [Create a Subscription for a Non-SQL Server Subscriber](create-a-subscription-for-a-non-sql-server-subscriber.md).</span></span>  
  
  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="dae0d-105">Usando o SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="dae0d-105">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="dae0d-106">Crie uma assinatura push no Publicador ou Assinante, usando o Assistente para Novas Assinaturas.</span><span class="sxs-lookup"><span data-stu-id="dae0d-106">Create a push subscription at the Publisher or the Subscriber using the New Subscription Wizard.</span></span> <span data-ttu-id="dae0d-107">Siga as páginas no assistente para:</span><span class="sxs-lookup"><span data-stu-id="dae0d-107">Follow the pages in the wizard to:</span></span>  
  
-   <span data-ttu-id="dae0d-108">Especificar o Publicador e a publicação.</span><span class="sxs-lookup"><span data-stu-id="dae0d-108">Specify the Publisher and publication.</span></span>  
  
-   <span data-ttu-id="dae0d-109">Selecione onde os agentes de replicação executarão.</span><span class="sxs-lookup"><span data-stu-id="dae0d-109">Select where replication agents will run.</span></span> <span data-ttu-id="dae0d-110">Para uma assinatura push, selecione **Executar todos os agentes no Distribuidor (assinaturas push)** na página **Local do Distribution Agent** ou na página **Local do Merge Agent** , dependendo do tipo de publicação.</span><span class="sxs-lookup"><span data-stu-id="dae0d-110">For a push subscription, select **Run all agents at the Distributor (push subscriptions)** on the **Distribution Agent Location** page or **Merge Agent Location** page, depending on the type of publication.</span></span>  
  
-   <span data-ttu-id="dae0d-111">Especifique Assinantes e bancos de dados de assinatura.</span><span class="sxs-lookup"><span data-stu-id="dae0d-111">Specify Subscribers and subscription databases.</span></span>  
  
-   <span data-ttu-id="dae0d-112">Especifique os logons e senhas usadas para conexões feitas por agentes de replicação:</span><span class="sxs-lookup"><span data-stu-id="dae0d-112">Specify the logins and passwords used for connections made by replication agents:</span></span>  
  
    -   <span data-ttu-id="dae0d-113">Para assinaturas para instantâneos e publicações transacionais, especifique as credenciais na página **Segurança do Distribution Agent** .</span><span class="sxs-lookup"><span data-stu-id="dae0d-113">For subscriptions to snapshot and transactional publications, specify credentials on the **Distribution Agent Security** page.</span></span>  
  
    -   <span data-ttu-id="dae0d-114">Para assinaturas para publicações de mesclagem, especifique as credenciais na página **Segurança do Merge Agent** .</span><span class="sxs-lookup"><span data-stu-id="dae0d-114">For subscriptions to merge publications, specify credentials on the **Merge Agent Security** page.</span></span>  
  
     <span data-ttu-id="dae0d-115">Para obter informações sobre as permissões exigidas por cada agente, consulte [Replication Agent Security Model](security/replication-agent-security-model.md).</span><span class="sxs-lookup"><span data-stu-id="dae0d-115">For information about the permissions required by each agent, see [Replication Agent Security Model](security/replication-agent-security-model.md).</span></span>  
  
-   <span data-ttu-id="dae0d-116">Especifique uma agenda de sincronização e quando o Assinante deve ser inicializado.</span><span class="sxs-lookup"><span data-stu-id="dae0d-116">Specify a synchronization schedule and when the Subscriber should be initialized.</span></span>  
  
-   <span data-ttu-id="dae0d-117">Especifique opções adicionais para publicações de mesclagem: tipo de assinatura e valores para filtragem com parâmetros.</span><span class="sxs-lookup"><span data-stu-id="dae0d-117">Specify additional options for merge publications: subscription type; and values for parameterized filtering.</span></span>  
  
-   <span data-ttu-id="dae0d-118">Especifique opções adicionais para publicações transacionais que permitem assinaturas de atualização: se os Assinantes devem confirmar alterações no Publicador imediatamente ou gravá-las em uma fila; credenciais usadas do Assinante para o Publicador.</span><span class="sxs-lookup"><span data-stu-id="dae0d-118">Specify additional options for transactional publications that allow updating subscriptions: whether Subscribers should commit changes at the Publisher immediately or write them to a queue; credentials used to connect from the Subscriber to the Publisher.</span></span>  
  
-   <span data-ttu-id="dae0d-119">Opcionalmente, faça o script da assinatura.</span><span class="sxs-lookup"><span data-stu-id="dae0d-119">Optionally script the subscription.</span></span>  
  
#### <a name="to-create-a-push-subscription-from-the-publisher"></a><span data-ttu-id="dae0d-120">Para criar uma assinatura push do Publicador</span><span class="sxs-lookup"><span data-stu-id="dae0d-120">To create a push subscription from the Publisher</span></span>  
  
1.  <span data-ttu-id="dae0d-121">Conecte-se ao Publicador no [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] e, em seguida, expanda o nó de servidor.</span><span class="sxs-lookup"><span data-stu-id="dae0d-121">Connect to the Publisher in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], and then expand the server node.</span></span>  
  
2.  <span data-ttu-id="dae0d-122">Expanda a pasta **Replicação** e, em seguida, a pasta **Publicações Locais** .</span><span class="sxs-lookup"><span data-stu-id="dae0d-122">Expand the **Replication** folder, and then expand the **Local Publications** folder.</span></span>  
  
3.  <span data-ttu-id="dae0d-123">Clique com o botão direito do mouse na publicação na qual você deseja criar uma ou mais assinaturas e clique em **Novas Assinaturas**.</span><span class="sxs-lookup"><span data-stu-id="dae0d-123">Right-click the publication for which you want to create one or more subscriptions, and then click **New Subscriptions**.</span></span>  
  
4.  <span data-ttu-id="dae0d-124">Complete as páginas no Assistente para Novas Assinaturas.</span><span class="sxs-lookup"><span data-stu-id="dae0d-124">Complete the pages in the New Subscription Wizard.</span></span>  
  
#### <a name="to-create-a-push-subscription-from-the-subscriber"></a><span data-ttu-id="dae0d-125">Para criar uma assinatura push do Assinante</span><span class="sxs-lookup"><span data-stu-id="dae0d-125">To create a push subscription from the Subscriber</span></span>  
  
1.  <span data-ttu-id="dae0d-126">Conecte-se ao Assinante no [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]e expanda o nó do servidor.</span><span class="sxs-lookup"><span data-stu-id="dae0d-126">Connect to the Subscriber in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], and then expand the server node.</span></span>  
  
2.  <span data-ttu-id="dae0d-127">Expanda a pasta **Replicação** .</span><span class="sxs-lookup"><span data-stu-id="dae0d-127">Expand the **Replication** folder.</span></span>  
  
3.  <span data-ttu-id="dae0d-128">Clique com o botão direito do mouse na pasta **Assinaturas Locais** e depois clique em **Novas Assinaturas**.</span><span class="sxs-lookup"><span data-stu-id="dae0d-128">Right-click the **Local Subscriptions** folder, and then click **New Subscriptions**.</span></span>  
  
4.  <span data-ttu-id="dae0d-129">Na página **Publicação** do Assistente para Nova Assinatura, selecione **\<Find SQL Server Publisher>** ou **\<Find Oracle Publisher>** na lista suspensa **Editor**.</span><span class="sxs-lookup"><span data-stu-id="dae0d-129">On the **Publication** page of the New Subscription Wizard, select **\<Find SQL Server Publisher>** or **\<Find Oracle Publisher>** from the **Publisher** drop-down list.</span></span>  
  
5.  <span data-ttu-id="dae0d-130">Conecte-se ao Publicador na caixa de diálogo **Conectar ao Servidor** .</span><span class="sxs-lookup"><span data-stu-id="dae0d-130">Connect to the Publisher in the **Connect to Server** dialog box.</span></span>  
  
6.  <span data-ttu-id="dae0d-131">Selecione uma publicação na página **Publicação** .</span><span class="sxs-lookup"><span data-stu-id="dae0d-131">Select a publication on the **Publication** page.</span></span>  
  
7.  <span data-ttu-id="dae0d-132">Complete as páginas no Assistente para Novas Assinaturas.</span><span class="sxs-lookup"><span data-stu-id="dae0d-132">Complete the pages in the New Subscription Wizard.</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="dae0d-133">Usando o Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="dae0d-133">Using Transact-SQL</span></span>  
 <span data-ttu-id="dae0d-134">As assinaturas push podem ser criadas de forma programada, usando procedimentos armazenados de replicação.</span><span class="sxs-lookup"><span data-stu-id="dae0d-134">Push subscriptions can be created programmatically using replication stored procedures.</span></span> <span data-ttu-id="dae0d-135">Os procedimentos armazenados usados dependem do tipo de publicação ao qual a assinatura pertence.</span><span class="sxs-lookup"><span data-stu-id="dae0d-135">The stored procedures used will depend on the type of publication to which the subscription belongs.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="dae0d-136">Quando possível, solicite aos usuários que insiram as credenciais de segurança em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="dae0d-136">When possible, prompt users to enter security credentials at run time.</span></span> <span data-ttu-id="dae0d-137">Se for necessário armazenar credenciais em um arquivo de script, você deverá proteger o arquivo para impedir acesso não autorizado.</span><span class="sxs-lookup"><span data-stu-id="dae0d-137">If you must store credentials in a script file, you must secure the file to prevent unauthorized access.</span></span>  
  
#### <a name="to-create-a-push-subscription-to-a-snapshot-or-transactional-publication"></a><span data-ttu-id="dae0d-138">Para criar uma assinatura push em um instantâneo ou publicação transacional</span><span class="sxs-lookup"><span data-stu-id="dae0d-138">To create a push subscription to a snapshot or transactional publication</span></span>  
  
1.  <span data-ttu-id="dae0d-139">No Publicador do banco de dados de publicação, verifique se a publicação oferece suporte às assinaturas push, executando [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="dae0d-139">At the Publisher on the publication database, verify that the publication supports push subscriptions by executing [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span></span>  
  
    -   <span data-ttu-id="dae0d-140">Se o valor de **allow_push** for **1**, as assinaturas push terão suporte.</span><span class="sxs-lookup"><span data-stu-id="dae0d-140">If the value of **allow_push** is **1**, push subscriptions are supported.</span></span>  
  
    -   <span data-ttu-id="dae0d-141">Se o valor de **allow_push** for **0**, execute [sp_changepublication](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql), especificando **allow_push** para **@property** e `true` para **@value** .</span><span class="sxs-lookup"><span data-stu-id="dae0d-141">If the value of **allow_push** is **0**, execute [sp_changepublication](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql), specifying **allow_push** for **@property** and `true` for **@value**.</span></span>  
  
2.  <span data-ttu-id="dae0d-142">No Publicador do banco de dados da publicação, execute [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="dae0d-142">At the Publisher on the publication database, execute [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql).</span></span> <span data-ttu-id="dae0d-143">Especifique **@publication** , **@subscriber** e **@destination_db** .</span><span class="sxs-lookup"><span data-stu-id="dae0d-143">Specify **@publication**, **@subscriber** and **@destination_db**.</span></span> <span data-ttu-id="dae0d-144">Especifique um valor **push** para **@subscription_type**.</span><span class="sxs-lookup"><span data-stu-id="dae0d-144">Specify a value of **push** for **@subscription_type**.</span></span> <span data-ttu-id="dae0d-145">Para obter informações sobre como atualizar assinaturas, consulte [criar uma assinatura atualizável para uma publicação transacional](publish/create-an-updatable-subscription-to-a-transactional-publication.md)</span><span class="sxs-lookup"><span data-stu-id="dae0d-145">For information about how to update subscriptions, see [Create an Updatable Subscription to a Transactional Publication](publish/create-an-updatable-subscription-to-a-transactional-publication.md)</span></span>  
  
3.  <span data-ttu-id="dae0d-146">No Publicador do banco de dados de publicação, execute [sp_addpushsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="dae0d-146">At the Publisher on the publication database, execute [sp_addpushsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql).</span></span> <span data-ttu-id="dae0d-147">Especifique o seguinte:</span><span class="sxs-lookup"><span data-stu-id="dae0d-147">Specify the following:</span></span>  
  
    -   <span data-ttu-id="dae0d-148">Os **@subscriber** **@subscriber_db** parâmetros, e **@publication** .</span><span class="sxs-lookup"><span data-stu-id="dae0d-148">The **@subscriber**, **@subscriber_db**, and **@publication** parameters.</span></span>  
  
    -   <span data-ttu-id="dae0d-149">As [!INCLUDE[msCoName](../../includes/msconame-md.md)] credenciais do Windows sob as quais o agente de distribuição no distribuidor é executado para **@job_login** e **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="dae0d-149">The [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows credentials under which the Distribution Agent at the Distributor runs for **@job_login** and **@job_password**.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="dae0d-150">As conexões feitas usando a autenticação integrada do Windows sempre usam as credenciais do Windows especificadas por **@job_login** e **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="dae0d-150">Connections made using Windows Integrated Authentication always use the Windows credentials specified by **@job_login** and **@job_password**.</span></span> <span data-ttu-id="dae0d-151">O Distribution Agent sempre faz a conexão local com o Distribuidor usando a Autenticação Integrada do Windows.</span><span class="sxs-lookup"><span data-stu-id="dae0d-151">The Distribution Agent always makes the local connection to the Distributor using Windows Integrated Authentication.</span></span> <span data-ttu-id="dae0d-152">Por padrão, o agente se conecta ao Assinante usando a Autenticação Integrada do Windows.</span><span class="sxs-lookup"><span data-stu-id="dae0d-152">By default, the agent will connect to the Subscriber using Windows Integrated Authentication.</span></span>  
  
    -   <span data-ttu-id="dae0d-153">(Opcional) Valor de **0** para **@subscriber_security_mode** e informações de logon do [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] para **@subscriber_login** e **@subscriber_password**.</span><span class="sxs-lookup"><span data-stu-id="dae0d-153">(Optional) A value of **0** for **@subscriber_security_mode** and the [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] login information for **@subscriber_login** and **@subscriber_password**.</span></span> <span data-ttu-id="dae0d-154">Especifique esses parâmetros se for necessário usar a Autenticação do SQL Server para conexão com o Assinante.</span><span class="sxs-lookup"><span data-stu-id="dae0d-154">Specify these parameters if you need to use SQL Server Authentication when connecting to the Subscriber.</span></span>  
  
    -   <span data-ttu-id="dae0d-155">Agenda para o trabalho do Distribution Agent para essa assinatura.</span><span class="sxs-lookup"><span data-stu-id="dae0d-155">A schedule for the Distribution Agent job for this subscription.</span></span> <span data-ttu-id="dae0d-156">Para obter mais informações, consulte [Specify Synchronization Schedules](specify-synchronization-schedules.md).</span><span class="sxs-lookup"><span data-stu-id="dae0d-156">For more information, see [Specify Synchronization Schedules](specify-synchronization-schedules.md).</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="dae0d-157">Ao criar uma assinatura push em um Publicador com um Distribuidor remoto, os valores especificados para todos os parâmetros, inclusive *job_login* e *job_password*são enviados para o Distribuidor como texto sem-formatação.</span><span class="sxs-lookup"><span data-stu-id="dae0d-157">When creating a push subscription at a Publisher with a remote Distributor, the values supplied for all parameters, including *job_login* and *job_password*, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="dae0d-158">Você deve criptografar a conexão entre o Publicador e seu Distribuidor remoto antes de executar esse procedimento armazenado.</span><span class="sxs-lookup"><span data-stu-id="dae0d-158">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="dae0d-159">Para obter mais informações, veja [Habilitar conexões criptografadas no Mecanismo de Banco de Dados &#40;SQL Server Configuration Manager&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span><span class="sxs-lookup"><span data-stu-id="dae0d-159">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
#### <a name="to-create-a-push-subscription-to-a-merge-publication"></a><span data-ttu-id="dae0d-160">Para criar uma assinatura push para publicação de mesclagem</span><span class="sxs-lookup"><span data-stu-id="dae0d-160">To create a push subscription to a merge publication</span></span>  
  
1.  <span data-ttu-id="dae0d-161">No Publicador do banco de dados de publicação, verifique se a publicação oferece suporte às assinaturas push, executando [sp_helpmergepublication](/sql/relational-databases/system-stored-procedures/sp-helpmergepublication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="dae0d-161">At the Publisher on the publication database, verify that the publication supports push subscriptions by executing [sp_helpmergepublication](/sql/relational-databases/system-stored-procedures/sp-helpmergepublication-transact-sql).</span></span>  
  
    -   <span data-ttu-id="dae0d-162">Se o valor de **allow_push** for **1**, a publicação dará suporte às assinaturas push.</span><span class="sxs-lookup"><span data-stu-id="dae0d-162">If the value of **allow_push** is **1**, the publication supports push subscriptions.</span></span>  
  
    -   <span data-ttu-id="dae0d-163">Se o valor de **allow_push** não for **1**, execute [sp_changemergepublication](/sql/relational-databases/system-stored-procedures/sp-changemergepublication-transact-sql), especificando **allow_push** para **@property** e `true` para **@value** .</span><span class="sxs-lookup"><span data-stu-id="dae0d-163">If the value of **allow_push** is not **1**, execute [sp_changemergepublication](/sql/relational-databases/system-stored-procedures/sp-changemergepublication-transact-sql), specifying **allow_push** for **@property** and `true` for **@value**.</span></span>  
  
2.  <span data-ttu-id="dae0d-164">No Publicador, no banco de dados de publicação, execute [sp_addmergesubscription](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql), especificando os seguintes parâmetros:</span><span class="sxs-lookup"><span data-stu-id="dae0d-164">At the Publisher on the publication database, execute [sp_addmergesubscription](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql), specifying the following parameters:</span></span>  
  
    -   <span data-ttu-id="dae0d-165">**@publication**.</span><span class="sxs-lookup"><span data-stu-id="dae0d-165">**@publication**.</span></span> <span data-ttu-id="dae0d-166">Esse é o nome da publicação.</span><span class="sxs-lookup"><span data-stu-id="dae0d-166">This is the name of the publication.</span></span>  
  
    -   <span data-ttu-id="dae0d-167">**@subscriber_type**.</span><span class="sxs-lookup"><span data-stu-id="dae0d-167">**@subscriber_type**.</span></span> <span data-ttu-id="dae0d-168">Para uma assinatura de cliente, especifique **local** e, para uma assinatura de servidor, especifique **global**.</span><span class="sxs-lookup"><span data-stu-id="dae0d-168">For a client subscription, specify **local** and for a server subscription, specify **global**.</span></span>  
  
    -   <span data-ttu-id="dae0d-169">**@subscription_priority**.</span><span class="sxs-lookup"><span data-stu-id="dae0d-169">**@subscription_priority**.</span></span> <span data-ttu-id="dae0d-170">Para uma assinatura de servidor, especifique uma prioridade para a assinatura de (**0,00** a **99,99**).</span><span class="sxs-lookup"><span data-stu-id="dae0d-170">For a server subscription, specify a priority for the subscription (**0.00** to **99.99**).</span></span>  
  
         <span data-ttu-id="dae0d-171">Para obter mais informações, consulte [Replicação de mesclagem avançada – detecção e resolução de conflito](merge/advanced-merge-replication-conflict-detection-and-resolution.md).</span><span class="sxs-lookup"><span data-stu-id="dae0d-171">For more information, see [Advanced Merge Replication Conflict Detection and Resolution](merge/advanced-merge-replication-conflict-detection-and-resolution.md).</span></span>  
  
3.  <span data-ttu-id="dae0d-172">No Publicador, no banco de dados da publicação, execute [sp_addmergepushsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="dae0d-172">At the Publisher on the publication database, execute [sp_addmergepushsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql).</span></span> <span data-ttu-id="dae0d-173">Especifique o seguinte:</span><span class="sxs-lookup"><span data-stu-id="dae0d-173">Specify the following:</span></span>  
  
    -   <span data-ttu-id="dae0d-174">Os **@subscriber** **@subscriber_db** parâmetros, e **@publication** .</span><span class="sxs-lookup"><span data-stu-id="dae0d-174">The **@subscriber**, **@subscriber_db**, and **@publication** parameters.</span></span>  
  
    -   <span data-ttu-id="dae0d-175">As credenciais do Windows sob as quais o Agente de Mesclagem no distribuidor é executado para **@job_login** e **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="dae0d-175">The Windows credentials under which the Merge Agent at the Distributor runs for **@job_login** and **@job_password**.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="dae0d-176">As conexões feitas usando a autenticação integrada do Windows sempre usam as credenciais do Windows especificadas por **@job_login** e **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="dae0d-176">Connections made using Windows Integrated Authentication always use the Windows credentials specified by **@job_login** and **@job_password**.</span></span> <span data-ttu-id="dae0d-177">O Merge Agent sempre faz a conexão local com o Distribuidor usando a Autenticação Integrada do Windows.</span><span class="sxs-lookup"><span data-stu-id="dae0d-177">The Merge Agent always makes the local connection to the Distributor using Windows Integrated Authentication.</span></span> <span data-ttu-id="dae0d-178">Por padrão, o agente se conecta ao Assinante usando a Autenticação Integrada do Windows.</span><span class="sxs-lookup"><span data-stu-id="dae0d-178">By default, the agent will connect to the Subscriber using Windows Integrated Authentication.</span></span>  
  
    -   <span data-ttu-id="dae0d-179">(Opcional) Valor de **0** para **@subscriber_security_mode** e informações de logon do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] para **@subscriber_login** e **@subscriber_password**.</span><span class="sxs-lookup"><span data-stu-id="dae0d-179">(Optional) A value of **0** for **@subscriber_security_mode** and the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] login information for **@subscriber_login** and **@subscriber_password**.</span></span> <span data-ttu-id="dae0d-180">Especifique esses parâmetros se for necessário usar a Autenticação do SQL Server para conexão com o Assinante.</span><span class="sxs-lookup"><span data-stu-id="dae0d-180">Specify these parameters if you need to use SQL Server Authentication when connecting to the Subscriber.</span></span>  
  
    -   <span data-ttu-id="dae0d-181">(Opcional) Valor de **0** para **@publisher_security_mode** e informações de logon do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] para **@publisher_login** e **@publisher_password**.</span><span class="sxs-lookup"><span data-stu-id="dae0d-181">(Optional) A value of **0** for **@publisher_security_mode** and the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] login information for **@publisher_login** and **@publisher_password**.</span></span> <span data-ttu-id="dae0d-182">Especifique esses valores se for necessário usar a Autenticação do SQL Server para conexão com o Publicador.</span><span class="sxs-lookup"><span data-stu-id="dae0d-182">Specify these values if you need to use SQL Server Authentication when connecting to the Publisher.</span></span>  
  
    -   <span data-ttu-id="dae0d-183">Agenda para o trabalho do Merge Agent para essa assinatura.</span><span class="sxs-lookup"><span data-stu-id="dae0d-183">A schedule for the Merge Agent job for this subscription.</span></span> <span data-ttu-id="dae0d-184">Para obter mais informações, consulte [Specify Synchronization Schedules](specify-synchronization-schedules.md).</span><span class="sxs-lookup"><span data-stu-id="dae0d-184">For more information, see [Specify Synchronization Schedules](specify-synchronization-schedules.md).</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="dae0d-185">Ao criar uma assinatura push em um Publicador com um Distribuidor remoto, os valores especificados para todos os parâmetros, inclusive *job_login* e *job_password*são enviados para o Distribuidor como texto sem-formatação.</span><span class="sxs-lookup"><span data-stu-id="dae0d-185">When creating a push subscription at a Publisher with a remote Distributor, the values supplied for all parameters, including *job_login* and *job_password*, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="dae0d-186">Você deve criptografar a conexão entre o Publicador e seu Distribuidor remoto antes de executar esse procedimento armazenado.</span><span class="sxs-lookup"><span data-stu-id="dae0d-186">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="dae0d-187">Para obter mais informações, veja [Habilitar conexões criptografadas no Mecanismo de Banco de Dados &#40;SQL Server Configuration Manager&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span><span class="sxs-lookup"><span data-stu-id="dae0d-187">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
###  <a name="examples-transact-sql"></a><a name="TsqlExample"></a> <span data-ttu-id="dae0d-188">Exemplos (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="dae0d-188">Examples (Transact-SQL)</span></span>  
 <span data-ttu-id="dae0d-189">O exemplo a seguir cria uma nova assinatura push para uma publicação transacional.</span><span class="sxs-lookup"><span data-stu-id="dae0d-189">The following example creates a push subscription to a transactional publication.</span></span> <span data-ttu-id="dae0d-190">Os valores de logon e senha são fornecidos em tempo de execução, usando as variáveis de script **sqlcmd** .</span><span class="sxs-lookup"><span data-stu-id="dae0d-190">Login and password values are supplied at run time by using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_addtranpushsubscription_agent](../../snippets/tsql/SQL15/replication/howto/tsql/createtranpushsub.sql#sp_addtranpushsubscription_agent)]  
  
 <span data-ttu-id="dae0d-191">O exemplo a seguir cria uma nova assinatura push para uma publicação de mesclagem.</span><span class="sxs-lookup"><span data-stu-id="dae0d-191">The following example creates a push subscription to a merge publication.</span></span> <span data-ttu-id="dae0d-192">Os valores de logon e senha são fornecidos em tempo de execução, usando as variáveis de script **sqlcmd** .</span><span class="sxs-lookup"><span data-stu-id="dae0d-192">Login and password values are supplied at run time by using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_addmergepushsubscriptionagent](../../snippets/tsql/SQL15/replication/howto/tsql/createmergepushsub.sql#sp_addmergepushsubscriptionagent)]  
  
##  <a name="using-replication-management-objects-rmo"></a><a name="RMOProcedure"></a> <span data-ttu-id="dae0d-193">Usando o RMO (Replication Management Objects)</span><span class="sxs-lookup"><span data-stu-id="dae0d-193">Using Replication Management Objects (RMO)</span></span>  
 <span data-ttu-id="dae0d-194">Crie assinaturas push de forma programada, usando RMO (Replication Management Objects).</span><span class="sxs-lookup"><span data-stu-id="dae0d-194">You can create push subscriptions programmatically by using Replication Management Objects (RMO).</span></span> <span data-ttu-id="dae0d-195">As classes RMO usadas para criar uma assinatura push dependem do tipo de publicação no qual a assinatura é criada.</span><span class="sxs-lookup"><span data-stu-id="dae0d-195">The RMO classes you use to create a push subscription depend on the type of publication to which the subscription is created.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="dae0d-196">Quando possível, solicite que os usuários insiram as credenciais de segurança em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="dae0d-196">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="dae0d-197">Se for preciso armazenar credenciais, use os serviços [criptográficos](https://go.microsoft.com/fwlink/?LinkId=34733) fornecidos pelo [!INCLUDE[msCoName](../../includes/msconame-md.md)] .NET Framework do Windows.</span><span class="sxs-lookup"><span data-stu-id="dae0d-197">If you must store credentials, use the [cryptographic services](https://go.microsoft.com/fwlink/?LinkId=34733) provided by the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows .NET Framework.</span></span>  
  
#### <a name="to-create-a-push-subscription-to-a-snapshot-or-transactional-publication"></a><span data-ttu-id="dae0d-198">Para criar uma assinatura push em um instantâneo ou publicação transacional</span><span class="sxs-lookup"><span data-stu-id="dae0d-198">To create a push subscription to a snapshot or transactional publication</span></span>  
  
1.  <span data-ttu-id="dae0d-199">Crie uma conexão com o Publicador usando a classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="dae0d-199">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="dae0d-200">Crie uma instância da classe <xref:Microsoft.SqlServer.Replication.TransPublication> usando a conexão com o Publicador da etapa 1.</span><span class="sxs-lookup"><span data-stu-id="dae0d-200">Create an instance of the <xref:Microsoft.SqlServer.Replication.TransPublication> class by using the Publisher connection from step 1.</span></span> <span data-ttu-id="dae0d-201">Especifique <xref:Microsoft.SqlServer.Replication.Publication.Name%2A>, <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A>, e <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span><span class="sxs-lookup"><span data-stu-id="dae0d-201">Specify <xref:Microsoft.SqlServer.Replication.Publication.Name%2A>, <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A>, and <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
3.  <span data-ttu-id="dae0d-202">Chame o método <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> .</span><span class="sxs-lookup"><span data-stu-id="dae0d-202">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method.</span></span> <span data-ttu-id="dae0d-203">Se esse método retornar `false`, as propriedades da Etapa 2 estão incorretas ou a publicação não existe no servidor.</span><span class="sxs-lookup"><span data-stu-id="dae0d-203">If this method returns `false`, either the properties specified in step 2 are incorrect or the publication does not exists on the server.</span></span>  
  
4.  <span data-ttu-id="dae0d-204">Realize uma lógica AND de bit a bit (`&` no Visual C# e `And` no Visual Basic) entre a propriedade <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> e <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPush>.</span><span class="sxs-lookup"><span data-stu-id="dae0d-204">Perform a bitwise logical AND (`&` in Visual C# and `And` in Visual Basic) between the <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> property and <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPush>.</span></span> <span data-ttu-id="dae0d-205">Se o resultado for <xref:Microsoft.SqlServer.Replication.PublicationAttributes.None>, defina <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> para o resultado de uma lógica bit a bit OR (`|` em Visual C# e `Or` em Visual Basic) entre <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> e <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPush>.</span><span class="sxs-lookup"><span data-stu-id="dae0d-205">If the result is <xref:Microsoft.SqlServer.Replication.PublicationAttributes.None>, set <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> to the result of a bitwise logical OR (`|` in Visual C# and `Or` in Visual Basic) between <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> and <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPush>.</span></span> <span data-ttu-id="dae0d-206">Em seguida, chame <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> para ativar assinaturas push.</span><span class="sxs-lookup"><span data-stu-id="dae0d-206">Then, call <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> to enable push subscriptions.</span></span>  
  
5.  <span data-ttu-id="dae0d-207">Se não houver banco de dados de assinatura, crie-o usando a classe <xref:Microsoft.SqlServer.Management.Smo.Database> .</span><span class="sxs-lookup"><span data-stu-id="dae0d-207">If the subscription database does not exist, create it by using the <xref:Microsoft.SqlServer.Management.Smo.Database> class.</span></span> <span data-ttu-id="dae0d-208">Para obter mais informações, consulte [Creating, Altering, and Removing Databases](../server-management-objects-smo/tasks/creating-altering-and-removing-databases.md) (Criando, alterando e removendo bancos de dados).</span><span class="sxs-lookup"><span data-stu-id="dae0d-208">For more information, see [Creating, Altering, and Removing Databases](../server-management-objects-smo/tasks/creating-altering-and-removing-databases.md).</span></span>  
  
6.  <span data-ttu-id="dae0d-209">Criar uma instância da classe <xref:Microsoft.SqlServer.Replication.TransSubscription>.</span><span class="sxs-lookup"><span data-stu-id="dae0d-209">Create an instance of the <xref:Microsoft.SqlServer.Replication.TransSubscription> class.</span></span>  
  
7.  <span data-ttu-id="dae0d-210">Defina as seguintes propriedades de assinatura:</span><span class="sxs-lookup"><span data-stu-id="dae0d-210">Set the following subscription properties:</span></span>  
  
    -   <span data-ttu-id="dae0d-211">O <xref:Microsoft.SqlServer.Management.Common.ServerConnection> para o Publicador criado na Etapa 1 para <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span><span class="sxs-lookup"><span data-stu-id="dae0d-211">The <xref:Microsoft.SqlServer.Management.Common.ServerConnection> to the Publisher created in step 1 for <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
    -   <span data-ttu-id="dae0d-212">Nome do banco de dados de assinatura para <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A>.</span><span class="sxs-lookup"><span data-stu-id="dae0d-212">Name of the subscription database for <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A>.</span></span>  
  
    -   <span data-ttu-id="dae0d-213">Nome do Assinante para <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>.</span><span class="sxs-lookup"><span data-stu-id="dae0d-213">Name of the Subscriber for <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>.</span></span>  
  
    -   <span data-ttu-id="dae0d-214">Nome do banco de dados de publicação para <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>.</span><span class="sxs-lookup"><span data-stu-id="dae0d-214">Name of the publication database for <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>.</span></span>  
  
    -   <span data-ttu-id="dae0d-215">Nome da publicação para <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>.</span><span class="sxs-lookup"><span data-stu-id="dae0d-215">Name of the publication for <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>.</span></span>  
  
    -   <span data-ttu-id="dae0d-216">Os campos <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> e <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> ou <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.SecurePassword%2A> de <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A> para fornecer as credenciais para a conta do Windows [!INCLUDE[msCoName](../../includes/msconame-md.md)] em que o Distribution Agent é executado no Distribuidor.</span><span class="sxs-lookup"><span data-stu-id="dae0d-216">The <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> and <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> or <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.SecurePassword%2A> fields of <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A> to provide the credentials for the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows account under which the Distribution Agent runs at the Distributor.</span></span> <span data-ttu-id="dae0d-217">Essa conta é usada para fazer conexões locais com o Distribuidor e para fazer conexões remotas que usam a Autenticação do Windows.</span><span class="sxs-lookup"><span data-stu-id="dae0d-217">This account is used to make local connections to the Distributor and to make remote connections using Windows Authentication.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="dae0d-218">Não é necessário definir <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A> quando a assinatura for criada por um membro da função de servidor fixa `sysadmin`; no entanto, é recomendado.</span><span class="sxs-lookup"><span data-stu-id="dae0d-218">Setting <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A> is not required when the subscription is created by a member of the `sysadmin` fixed server role, however it is recommended.</span></span> <span data-ttu-id="dae0d-219">Nesse caso, o agente representará a conta do SQL Server Agent.</span><span class="sxs-lookup"><span data-stu-id="dae0d-219">In this case, the agent will impersonate the SQL Server Agent account.</span></span> <span data-ttu-id="dae0d-220">Para obter mais informações, consulte [Replication Agent Security Model](security/replication-agent-security-model.md).</span><span class="sxs-lookup"><span data-stu-id="dae0d-220">For more information, see [Replication Agent Security Model](security/replication-agent-security-model.md).</span></span>  
  
    -   <span data-ttu-id="dae0d-221">(Opcional) Um valor de `true` (padrão) para <xref:Microsoft.SqlServer.Replication.Subscription.CreateSyncAgentByDefault%2A> para criar um trabalho de agente que seja usado para sincronizar a assinatura.</span><span class="sxs-lookup"><span data-stu-id="dae0d-221">(Optional) A value of `true` (the default) for <xref:Microsoft.SqlServer.Replication.Subscription.CreateSyncAgentByDefault%2A> to create an agent job that is used to synchronize the subscription.</span></span> <span data-ttu-id="dae0d-222">Se você especificar `false`, a assinatura só poderá ser sincronizada programaticamente.</span><span class="sxs-lookup"><span data-stu-id="dae0d-222">If you specify `false`, the subscription can only be synchronized programmatically.</span></span>  
  
    -   <span data-ttu-id="dae0d-223">(Opcional) Defina os campos <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> e <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> ou <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> de <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> ao usar a Autenticação do SQL Server para conexão com o Assinante.</span><span class="sxs-lookup"><span data-stu-id="dae0d-223">(Optional) Set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> or <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> fields of <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> when using SQL Server Authentication to connect to the Subscriber.</span></span>  
  
8.  <span data-ttu-id="dae0d-224">Chame o método <xref:Microsoft.SqlServer.Replication.Subscription.Create%2A> .</span><span class="sxs-lookup"><span data-stu-id="dae0d-224">Call the <xref:Microsoft.SqlServer.Replication.Subscription.Create%2A> method.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="dae0d-225">Ao criar uma assinatura push no Publicador com um Distribuidor remoto, os valores fornecidos para todas as propriedades, inclusive <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>, são enviados para o Distribuidor como texto sem-formatação.</span><span class="sxs-lookup"><span data-stu-id="dae0d-225">When creating a push subscription at a Publisher with a remote Distributor, the values supplied for all properties, including <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="dae0d-226">É necessário criptografar a conexão entre o Publicador e o respectivo Distribuidor remoto antes de chamar o método <xref:Microsoft.SqlServer.Replication.Subscription.Create%2A>.</span><span class="sxs-lookup"><span data-stu-id="dae0d-226">You should encrypt the connection between the Publisher and its remote Distributor before calling the <xref:Microsoft.SqlServer.Replication.Subscription.Create%2A> method.</span></span> <span data-ttu-id="dae0d-227">Para obter mais informações, veja [Habilitar conexões criptografadas no Mecanismo de Banco de Dados &#40;SQL Server Configuration Manager&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span><span class="sxs-lookup"><span data-stu-id="dae0d-227">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
#### <a name="to-create-a-push-subscription-to-a-merge-publication"></a><span data-ttu-id="dae0d-228">Para criar uma assinatura push para publicação de mesclagem</span><span class="sxs-lookup"><span data-stu-id="dae0d-228">To create a push subscription to a merge publication</span></span>  
  
1.  <span data-ttu-id="dae0d-229">Crie uma conexão com o Publicador usando a classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="dae0d-229">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="dae0d-230">Crie uma instância da classe <xref:Microsoft.SqlServer.Replication.MergePublication> usando a conexão com o Publicador da etapa 1.</span><span class="sxs-lookup"><span data-stu-id="dae0d-230">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergePublication> class by using the Publisher connection from step 1.</span></span> <span data-ttu-id="dae0d-231">Especifique <xref:Microsoft.SqlServer.Replication.Publication.Name%2A>, <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A>, e <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span><span class="sxs-lookup"><span data-stu-id="dae0d-231">Specify <xref:Microsoft.SqlServer.Replication.Publication.Name%2A>, <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A>, and <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
3.  <span data-ttu-id="dae0d-232">Chame o método <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> .</span><span class="sxs-lookup"><span data-stu-id="dae0d-232">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method.</span></span> <span data-ttu-id="dae0d-233">Se esse método retornar `false`, as propriedades da Etapa 2 estão incorretas ou a publicação não existe no servidor.</span><span class="sxs-lookup"><span data-stu-id="dae0d-233">If this method returns `false`, either the properties specified in step 2 are incorrect or the publication does not exists on the server.</span></span>  
  
4.  <span data-ttu-id="dae0d-234">Realize uma lógica AND de bit a bit (`&` no Visual C# e `And` no Visual Basic) entre a propriedade <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> e <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPush>.</span><span class="sxs-lookup"><span data-stu-id="dae0d-234">Perform a bitwise logical AND (`&` in Visual C# and `And` in Visual Basic) between the <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> property and <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPush>.</span></span> <span data-ttu-id="dae0d-235">Se o resultado for <xref:Microsoft.SqlServer.Replication.PublicationAttributes.None>, defina <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> para o resultado de uma lógica bit a bit OR (`|` em Visual C# e `Or` em Visual Basic) entre <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> e <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPush>.</span><span class="sxs-lookup"><span data-stu-id="dae0d-235">If the result is <xref:Microsoft.SqlServer.Replication.PublicationAttributes.None>, set <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> to the result of a bitwise logical OR (`|` in Visual C# and `Or` in Visual Basic) between <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> and <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPush>.</span></span> <span data-ttu-id="dae0d-236">Em seguida, chame <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> para ativar assinaturas push.</span><span class="sxs-lookup"><span data-stu-id="dae0d-236">Then, call <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> to enable push subscriptions.</span></span>  
  
5.  <span data-ttu-id="dae0d-237">Se não houver banco de dados de assinatura, crie-o usando a classe <xref:Microsoft.SqlServer.Management.Smo.Database> .</span><span class="sxs-lookup"><span data-stu-id="dae0d-237">If the subscription database does not exist, create it by using the <xref:Microsoft.SqlServer.Management.Smo.Database> class.</span></span> <span data-ttu-id="dae0d-238">Para obter mais informações, consulte [Creating, Altering, and Removing Databases](../server-management-objects-smo/tasks/creating-altering-and-removing-databases.md) (Criando, alterando e removendo bancos de dados).</span><span class="sxs-lookup"><span data-stu-id="dae0d-238">For more information, see [Creating, Altering, and Removing Databases](../server-management-objects-smo/tasks/creating-altering-and-removing-databases.md).</span></span>  
  
6.  <span data-ttu-id="dae0d-239">Criar uma instância da classe <xref:Microsoft.SqlServer.Replication.MergeSubscription>.</span><span class="sxs-lookup"><span data-stu-id="dae0d-239">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergeSubscription> class.</span></span>  
  
7.  <span data-ttu-id="dae0d-240">Defina as seguintes propriedades de assinatura:</span><span class="sxs-lookup"><span data-stu-id="dae0d-240">Set the following subscription properties:</span></span>  
  
    -   <span data-ttu-id="dae0d-241">O <xref:Microsoft.SqlServer.Management.Common.ServerConnection> para o Publicador criado na Etapa 1 para <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span><span class="sxs-lookup"><span data-stu-id="dae0d-241">The <xref:Microsoft.SqlServer.Management.Common.ServerConnection> to the Publisher created in step 1 for <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
    -   <span data-ttu-id="dae0d-242">Nome do banco de dados de assinatura para <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A>.</span><span class="sxs-lookup"><span data-stu-id="dae0d-242">Name of the subscription database for <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A>.</span></span>  
  
    -   <span data-ttu-id="dae0d-243">Nome do Assinante para <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>.</span><span class="sxs-lookup"><span data-stu-id="dae0d-243">Name of the Subscriber for <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>.</span></span>  
  
    -   <span data-ttu-id="dae0d-244">Nome do banco de dados de publicação para <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>.</span><span class="sxs-lookup"><span data-stu-id="dae0d-244">Name of the publication database for <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>.</span></span>  
  
    -   <span data-ttu-id="dae0d-245">Nome da publicação para <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>.</span><span class="sxs-lookup"><span data-stu-id="dae0d-245">Name of the publication for <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>.</span></span>  
  
    -   <span data-ttu-id="dae0d-246">Os campos <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> e <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> ou <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.SecurePassword%2A> de <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A> para fornecer as credenciais para a conta do Windows [!INCLUDE[msCoName](../../includes/msconame-md.md)] na qual o Merge Agent é executado no Distribuidor.</span><span class="sxs-lookup"><span data-stu-id="dae0d-246">The <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> and <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> or <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.SecurePassword%2A> fields of <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A> to provide the credentials for the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows account under which the Merge Agent runs at the Distributor.</span></span> <span data-ttu-id="dae0d-247">Essa conta é usada para fazer conexões locais com o Distribuidor e para fazer conexões remotas que usam a Autenticação do Windows.</span><span class="sxs-lookup"><span data-stu-id="dae0d-247">This account is used to make local connections to the Distributor and to make remote connections using Windows Authentication.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="dae0d-248">Não é necessário definir <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A> quando a assinatura for criada por um membro da função de servidor fixa `sysadmin`; no entanto, é recomendado.</span><span class="sxs-lookup"><span data-stu-id="dae0d-248">Setting <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A> is not required when the subscription is created by a member of the `sysadmin` fixed server role, however it is recommended.</span></span> <span data-ttu-id="dae0d-249">Nesse caso, o agente representará a conta do SQL Server Agent.</span><span class="sxs-lookup"><span data-stu-id="dae0d-249">In this case, the agent will impersonate the SQL Server Agent account.</span></span> <span data-ttu-id="dae0d-250">Para obter mais informações, consulte [Replication Agent Security Model](security/replication-agent-security-model.md).</span><span class="sxs-lookup"><span data-stu-id="dae0d-250">For more information, see [Replication Agent Security Model](security/replication-agent-security-model.md).</span></span>  
  
    -   <span data-ttu-id="dae0d-251">(Opcional) Um valor de `true` (padrão) para <xref:Microsoft.SqlServer.Replication.Subscription.CreateSyncAgentByDefault%2A> para criar um trabalho de agente que seja usado para sincronizar a assinatura.</span><span class="sxs-lookup"><span data-stu-id="dae0d-251">(Optional) A value of `true` (the default) for <xref:Microsoft.SqlServer.Replication.Subscription.CreateSyncAgentByDefault%2A> to create an agent job that is used to synchronize the subscription.</span></span> <span data-ttu-id="dae0d-252">Se você especificar `false`, a assinatura só poderá ser sincronizada programaticamente.</span><span class="sxs-lookup"><span data-stu-id="dae0d-252">If you specify `false`, the subscription can only be synchronized programmatically.</span></span>  
  
    -   <span data-ttu-id="dae0d-253">(Opcional) Defina os campos <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> e <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> ou <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> de <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> ao usar a Autenticação do SQL Server para conexão com o Assinante.</span><span class="sxs-lookup"><span data-stu-id="dae0d-253">(Optional) Set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> or <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> fields of <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> when using SQL Server Authentication to connect to the Subscriber.</span></span>  
  
    -   <span data-ttu-id="dae0d-254">(Opcional) Defina os campos <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> e <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> ou <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> de <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherSecurity%2A> ao usar a Autenticação do SQL Server para conexão com o Publicador.</span><span class="sxs-lookup"><span data-stu-id="dae0d-254">(Optional) Set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> or <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> fields of <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherSecurity%2A> when using SQL Server Authentication to connect to the Publisher.</span></span>  
  
8.  <span data-ttu-id="dae0d-255">Chame o método <xref:Microsoft.SqlServer.Replication.Subscription.Create%2A> .</span><span class="sxs-lookup"><span data-stu-id="dae0d-255">Call the <xref:Microsoft.SqlServer.Replication.Subscription.Create%2A> method.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="dae0d-256">Ao criar uma assinatura push no Publicador com um Distribuidor remoto, os valores fornecidos para todas as propriedades, inclusive <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>, são enviados para o Distribuidor como texto sem-formatação.</span><span class="sxs-lookup"><span data-stu-id="dae0d-256">When creating a push subscription at a Publisher with a remote Distributor, the values supplied for all properties, including <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="dae0d-257">É necessário criptografar a conexão entre o Publicador e o respectivo Distribuidor remoto antes de chamar o método <xref:Microsoft.SqlServer.Replication.Subscription.Create%2A>.</span><span class="sxs-lookup"><span data-stu-id="dae0d-257">You should encrypt the connection between the Publisher and its remote Distributor before calling the <xref:Microsoft.SqlServer.Replication.Subscription.Create%2A> method.</span></span> <span data-ttu-id="dae0d-258">Para obter mais informações, veja [Habilitar conexões criptografadas no Mecanismo de Banco de Dados &#40;SQL Server Configuration Manager&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span><span class="sxs-lookup"><span data-stu-id="dae0d-258">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
###  <a name="examples-rmo"></a><a name="PShellExample"></a> <span data-ttu-id="dae0d-259">Exemplos (RMO)</span><span class="sxs-lookup"><span data-stu-id="dae0d-259">Examples (RMO)</span></span>  
 <span data-ttu-id="dae0d-260">Esse exemplo cria uma nova assinatura push para uma publicação transacional.</span><span class="sxs-lookup"><span data-stu-id="dae0d-260">This example creates a new push subscription to a transactional publication.</span></span> <span data-ttu-id="dae0d-261">As credenciais da conta do Windows usadas para executar o trabalho do Distribution Agent são passadas em runtime.</span><span class="sxs-lookup"><span data-stu-id="dae0d-261">The Windows account credentials you use to run the Distribution Agent job are passed at runtime.</span></span>  
  
 [!code-csharp[HowTo#rmo_CreateTranPushSub](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_createtranpushsub)]  
  
 [!code-vb[HowTo#rmo_vb_CreateTranPushSub](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_createtranpushsub)]  
  
 <span data-ttu-id="dae0d-262">Esse exemplo cria uma nova assinatura push para uma publicação de mesclagem.</span><span class="sxs-lookup"><span data-stu-id="dae0d-262">This example creates a new push subscription to a merge publication.</span></span> <span data-ttu-id="dae0d-263">As credenciais da conta do Windows usadas para executar o trabalho do Agente de Mesclagem são passadas em runtime.</span><span class="sxs-lookup"><span data-stu-id="dae0d-263">The Windows account credentials you use to run the Merge Agent job are passed at runtime.</span></span>  
  
 [!code-csharp[HowTo#rmo_CreateMergePushSub](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_createmergepushsub)]  
  
 [!code-vb[HowTo#rmo_vb_CreateMergePushSub](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_createmergepushsub)]  
  
## <a name="see-also"></a><span data-ttu-id="dae0d-264">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="dae0d-264">See Also</span></span>  
 <span data-ttu-id="dae0d-265">[Exibir e modificar propriedades de assinatura push](view-and-modify-push-subscription-properties.md) </span><span class="sxs-lookup"><span data-stu-id="dae0d-265">[View and Modify Push Subscription Properties](view-and-modify-push-subscription-properties.md) </span></span>  
 <span data-ttu-id="dae0d-266">[Replication Security Best Practices](security/replication-security-best-practices.md) </span><span class="sxs-lookup"><span data-stu-id="dae0d-266">[Replication Security Best Practices](security/replication-security-best-practices.md) </span></span>  
 <span data-ttu-id="dae0d-267">[Create a Publication](publish/create-a-publication.md) </span><span class="sxs-lookup"><span data-stu-id="dae0d-267">[Create a Publication](publish/create-a-publication.md) </span></span>  
 <span data-ttu-id="dae0d-268">[Replication Management Objects Concepts](concepts/replication-management-objects-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="dae0d-268">[Replication Management Objects Concepts](concepts/replication-management-objects-concepts.md) </span></span>  
 <span data-ttu-id="dae0d-269">[Sincronizar uma assinatura push](synchronize-a-push-subscription.md) </span><span class="sxs-lookup"><span data-stu-id="dae0d-269">[Synchronize a Push Subscription](synchronize-a-push-subscription.md) </span></span>  
 <span data-ttu-id="dae0d-270">[Subscribe to Publications](subscribe-to-publications.md) </span><span class="sxs-lookup"><span data-stu-id="dae0d-270">[Subscribe to Publications](subscribe-to-publications.md) </span></span>  
 [<span data-ttu-id="dae0d-271">Usar sqlcmd com variáveis de script</span><span class="sxs-lookup"><span data-stu-id="dae0d-271">Use sqlcmd with Scripting Variables</span></span>](../scripting/sqlcmd-use-with-scripting-variables.md)  
  
  
