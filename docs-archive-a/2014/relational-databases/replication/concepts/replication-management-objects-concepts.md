---
title: Conceitos dos objetos de gerenciamento de replicação | Microsoft Docs
ms.custom: ''
ms.date: 04/27/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: reference
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- replication [SQL Server], RMO
- programming interfaces [SQL Server replication]
- replication [SQL Server], how-to topics
- RMO [SQL Server]
- Replication Management Objects
- programming [SQL Server replication], RMO
ms.assetid: 37476d50-fb47-49e3-9504-3b163ac381d8
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 0dc41416e0fb585db376c6b72f28f7c30cfff052
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87573923"
---
# <a name="replication-management-objects-concepts"></a><span data-ttu-id="5ecb8-102">Replication Management Objects Concepts</span><span class="sxs-lookup"><span data-stu-id="5ecb8-102">Replication Management Objects Concepts</span></span>
  <span data-ttu-id="5ecb8-103">O RMO (Replication Management Objects) é um assembly de código gerenciado que encapsula funcionalidades de replicação para o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="5ecb8-103">Replication Management Objects (RMO) is a managed code assembly that encapsulates replication functionalities for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="5ecb8-104">O RMO é implementado pelo namespace <xref:Microsoft.SqlServer.Replication>.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-104">RMO is implemented by the <xref:Microsoft.SqlServer.Replication> namespace.</span></span>  
  
 <span data-ttu-id="5ecb8-105">Os tópicos das seções a seguir descrevem como você pode usar o RMO para controlar as tarefas de replicação de forma programática.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-105">The topics in the following sections describe how you can use RMO to programmatically control replication tasks:</span></span>  
  
 [<span data-ttu-id="5ecb8-106">Configurar Distribuição</span><span class="sxs-lookup"><span data-stu-id="5ecb8-106">Configure Distribution</span></span>](../configure-distribution.md)  
 <span data-ttu-id="5ecb8-107">Os tópicos desta seção mostram como usar o RMO para configurar a publicação e a distribuição.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-107">Topics in this section show how to use RMO to configure publishing and distribution.</span></span>  
  
 [<span data-ttu-id="5ecb8-108">Criar uma publicação</span><span class="sxs-lookup"><span data-stu-id="5ecb8-108">Create a Publication</span></span>](../publish/create-a-publication.md)  
 <span data-ttu-id="5ecb8-109">Os tópicos desta seção mostram como usar o RMO para criar, excluir e modificar publicações e artigos.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-109">Topics in this section show how to use RMO to create, delete, and modify publications and articles.</span></span>  
  
 [<span data-ttu-id="5ecb8-110">Assinar publicações</span><span class="sxs-lookup"><span data-stu-id="5ecb8-110">Subscribe to Publications</span></span>](../subscribe-to-publications.md)  
 <span data-ttu-id="5ecb8-111">Os tópicos desta seção mostram como usar o RMO para criar, excluir e modificar assinaturas.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-111">Topics in this section show how to use RMO to create, delete, and modify subscriptions.</span></span>  
  
 [<span data-ttu-id="5ecb8-112">Proteger uma topologia de replicação</span><span class="sxs-lookup"><span data-stu-id="5ecb8-112">Secure a Replication Topology</span></span>](../security/view-and-modify-replication-security-settings.md)  
 <span data-ttu-id="5ecb8-113">Os tópicos desta seção mostram como usar o RMO para exibir e modificar configurações de segurança.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-113">Topics in this section show how to use RMO to view and modify security settings.</span></span>  
  
 [<span data-ttu-id="5ecb8-114">Sincronizar assinaturas &#40;replicação&#41;</span><span class="sxs-lookup"><span data-stu-id="5ecb8-114">Synchronize Subscriptions &#40;Replication&#41;</span></span>](../synchronize-data.md)  
 <span data-ttu-id="5ecb8-115">Os tópicos desta seção mostram como sincronizar assinaturas.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-115">Topics in this section show how to synchronize subscriptions.</span></span>  
  
 [<span data-ttu-id="5ecb8-116">Monitorando a Replicação</span><span class="sxs-lookup"><span data-stu-id="5ecb8-116">Monitoring Replication</span></span>](../monitoring-replication.md)  
 <span data-ttu-id="5ecb8-117">Os tópicos desta seção mostram como monitorar uma topologia de replicação programaticamente.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-117">Topics in this section show how to programmatically monitor a replication topology.</span></span>  
  
## <a name="introduction-to-rmo-programming"></a><span data-ttu-id="5ecb8-118">Introdução à programação RMO</span><span class="sxs-lookup"><span data-stu-id="5ecb8-118">Introduction to RMO Programming</span></span>  
 <span data-ttu-id="5ecb8-119">O RMO é criado para a programação de todos os aspectos da replicação do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="5ecb8-119">RMO is designed for programming all aspects of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] replication.</span></span> <span data-ttu-id="5ecb8-120">O namespace RMO é <xref:Microsoft.SqlServer.Replication> e é implementado pelo Microsoft.SqlServer.Rmo.dll, um assembly [!INCLUDE[msCoName](../../../includes/msconame-md.md)] do .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-120">The RMO namespace is <xref:Microsoft.SqlServer.Replication>, and it is implemented by the Microsoft.SqlServer.Rmo.dll, which is a [!INCLUDE[msCoName](../../../includes/msconame-md.md)] .NET Framework assembly.</span></span> <span data-ttu-id="5ecb8-121">O assembly Microsoft.SqlServer.Replication.dll, que também pertence ao namespace <xref:Microsoft.SqlServer.Replication>, implementa uma interface de código gerenciado para a programação de vários agentes de replicação (Snapshot Agent, Distribution Agent e Merge Agent).</span><span class="sxs-lookup"><span data-stu-id="5ecb8-121">The Microsoft.SqlServer.Replication.dll assembly, which also belongs to the <xref:Microsoft.SqlServer.Replication> namespace, implements a managed code interface for programming the various replication agents (Snapshot Agent, Distribution Agent, and Merge Agent).</span></span> <span data-ttu-id="5ecb8-122">Suas classes podem ser acessadas do RMO para a sincronização de assinaturas.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-122">Its classes can be accessed from RMO to synchronize subscriptions.</span></span> <span data-ttu-id="5ecb8-123">As classes do namespace <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport>, implementadas pelo assembly Microsoft.SqlServer.Replication.BusinessLogicSupport.dll, são usadas na criação de lógica de negócios personalizada para replicação de mesclagem.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-123">Classes in the <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport> namespace, implemented by the Microsoft.SqlServer.Replication.BusinessLogicSupport.dll assembly, are used to create custom business logic for merge replication.</span></span> <span data-ttu-id="5ecb8-124">Esse assembly é independente do RMO.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-124">This assembly is independent from RMO.</span></span>  
  
## <a name="deploying-applications-based-on-rmo"></a><span data-ttu-id="5ecb8-125">Implantando aplicativos baseados em RMO</span><span class="sxs-lookup"><span data-stu-id="5ecb8-125">Deploying Applications Based on RMO</span></span>  
 <span data-ttu-id="5ecb8-126">O RMO depende dos componentes de replicação e de conectividade de cliente incluídos em todas as versões do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], exceto no SQL Server Compact.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-126">RMO depends on the replication components and client connectivity components that are included with all versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] except SQL Server Compact.</span></span> <span data-ttu-id="5ecb8-127">Para implantar um aplicativo baseado em RMO, instale uma versão do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] que inclui componentes de replicação e de conectividade de cliente no computador em que o aplicativo será executado.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-127">To deploy an application based on RMO, you must install a version of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] that includes replication components and client connectivity components on the computer on which the application will run.</span></span>  
  
## <a name="getting-started-with-rmo"></a><span data-ttu-id="5ecb8-128">Introdução ao RMO</span><span class="sxs-lookup"><span data-stu-id="5ecb8-128">Getting Started with RMO</span></span>  
 <span data-ttu-id="5ecb8-129">Esta seção descreve como começar um projeto simples de RMO usando o Visual Studio do [!INCLUDE[msCoName](../../../includes/msconame-md.md)].</span><span class="sxs-lookup"><span data-stu-id="5ecb8-129">This section describes how to start a simple RMO project using [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Studio.</span></span>  
  
#### <a name="to-create-a-new-microsoft-visual-c-project"></a><span data-ttu-id="5ecb8-130">Para criar um novo projeto do Microsoft Visual C#</span><span class="sxs-lookup"><span data-stu-id="5ecb8-130">To create a new Microsoft Visual C# project</span></span>  
  
1.  <span data-ttu-id="5ecb8-131">Inicie o Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-131">Start Visual Studio.</span></span>  
  
2.  <span data-ttu-id="5ecb8-132">No menu **Arquivo**, clique em **NewProject.**</span><span class="sxs-lookup"><span data-stu-id="5ecb8-132">On the **File** menu, click **NewProject.**</span></span> <span data-ttu-id="5ecb8-133">A caixa de diálogo **Novo Projeto** aparecerá.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-133">The **New Project** dialog box appears.</span></span>  
  
3.  <span data-ttu-id="5ecb8-134">Na caixa de diálogo **Tipos de Projeto**, selecione **Projetos do Visual C#** .</span><span class="sxs-lookup"><span data-stu-id="5ecb8-134">In the **Project Types** dialog box, select **Visual C# Projects**.</span></span> <span data-ttu-id="5ecb8-135">No painel **Modelos**, selecione **Aplicativos do Windows**.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-135">In the **Templates** pane, select **Windows Application**.</span></span>  
  
4.  <span data-ttu-id="5ecb8-136">(Opcional) Em **Nome**, digite o nome do novo aplicativo.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-136">(Optional) In **Name**, type the name of the new application.</span></span>  
  
5.  <span data-ttu-id="5ecb8-137">Clique em **OK** para carregar o modelo do Windows do Visual C#.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-137">Click **OK** to load the Visual C# Windows template.</span></span>  
  
6.  <span data-ttu-id="5ecb8-138">No menu **Projeto**, selecione o item **Adicionar Referência**.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-138">On the **Project** menu, select **Add Reference** item.</span></span> <span data-ttu-id="5ecb8-139">A caixa de diálogo **Adicionar Referência** é exibida.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-139">The **Add Reference** dialog box appears.</span></span>  
  
7.  <span data-ttu-id="5ecb8-140">Selecione os assemblies a seguir na lista da guia **.NET** e clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-140">Select the following assemblies from the list on the **.NET** tab, and then click **OK**.</span></span>  
  
    -   <span data-ttu-id="5ecb8-141">Interface de programação .NET Microsoft.SqlServer.Replication</span><span class="sxs-lookup"><span data-stu-id="5ecb8-141">Microsoft.SqlServer.Replication .NET Programming Interface</span></span>  
  
    -   <span data-ttu-id="5ecb8-142">Microsoft.SqlServer.ConnectionInfo</span><span class="sxs-lookup"><span data-stu-id="5ecb8-142">Microsoft.SqlServer.ConnectionInfo</span></span>  
  
    -   <span data-ttu-id="5ecb8-143">Biblioteca de agentes de replicação</span><span class="sxs-lookup"><span data-stu-id="5ecb8-143">Replication Agent Library</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="5ecb8-144">Use a tecla CTRL para selecionar mais de um arquivo.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-144">Use the CTRL key to select more than one file.</span></span>  
  
8.  <span data-ttu-id="5ecb8-145">(Opcional) Repita a etapa 6.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-145">(Optional) Repeat step 6.</span></span> <span data-ttu-id="5ecb8-146">Clique na guia **Procurar**, navegue para [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]COM, selecione Microsoft.SqlServer.Replication.BusinessLogicSupport.dll e clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-146">Click the **Browse** tab, navigate to [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]COM, select Microsoft.SqlServer.Replication.BusinessLogicSupport.dll, and then click **OK**.</span></span>  
  
9. <span data-ttu-id="5ecb8-147">No menu **Exibir** , clique em **Código**.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-147">On the **View** menu, click **Code**.</span></span>  
  
10. <span data-ttu-id="5ecb8-148">No código, antes da instrução do namespace, digite as instruções `using` a seguir para qualificar os tipos nos namespaces RMO:</span><span class="sxs-lookup"><span data-stu-id="5ecb8-148">In the code, before the namespace statement, type the following `using` statements to qualify the types in the RMO namespaces:</span></span>  
  
    ```  
    // These namespaces are required.  
    using Microsoft.SqlServer.Replication;  
    using Microsoft.SqlServer.Management.Common;  
    // This namespace is only used when creating custom business  
    // logic for merge replication.  
    using Microsoft.SqlServer.Replication.BusinessLogicSupport;   
    ```  
  
#### <a name="to-create-a-new-microsoft-visual-basic-net-project"></a><span data-ttu-id="5ecb8-149">Para criar um novo projeto do Microsoft Visual Basic .NET</span><span class="sxs-lookup"><span data-stu-id="5ecb8-149">To create a new Microsoft Visual Basic .NET project</span></span>  
  
1.  <span data-ttu-id="5ecb8-150">Inicie o Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-150">Start Visual Studio.</span></span>  
  
2.  <span data-ttu-id="5ecb8-151">No menu **Arquivo**, selecione **Novo Projeto**.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-151">On the **File** menu, select **New Project**.</span></span> <span data-ttu-id="5ecb8-152">A caixa de diálogo **Novo Projeto** aparecerá.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-152">The **New Project** dialog box appears.</span></span>  
  
3.  <span data-ttu-id="5ecb8-153">No painel Tipos de Projeto, selecione **Visual Basic**.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-153">In the Project Types pane, select **Visual Basic**.</span></span> <span data-ttu-id="5ecb8-154">No painel Modelos, selecione **Aplicativos do Windows**.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-154">In the Templates pane, select **Windows Application**.</span></span>  
  
4.  <span data-ttu-id="5ecb8-155">(Opcional) Na caixa **Nome**, digite o nome do novo aplicativo.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-155">(Optional) In the **Name** box, type the name of the new application.</span></span>  
  
5.  <span data-ttu-id="5ecb8-156">Clique em **OK** para carregar o modelo do Windows do Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-156">Click **OK** to load the Visual Basic Windows template.</span></span>  
  
6.  <span data-ttu-id="5ecb8-157">No menu **Projeto**, selecione **Adicionar Referência**.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-157">On the **Project** menu, select **Add Reference**.</span></span> <span data-ttu-id="5ecb8-158">A caixa de diálogo **Adicionar Referência** é exibida.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-158">The **Add Reference** dialog box appears.</span></span>  
  
7.  <span data-ttu-id="5ecb8-159">Selecione os assemblies a seguir na lista da guia **.NET** e clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-159">Select the following assemblies from the list on the **.NET** tab, and then click **OK**.</span></span>  
  
    -   <span data-ttu-id="5ecb8-160">Interface de programação .NET Microsoft.SqlServer.Replication</span><span class="sxs-lookup"><span data-stu-id="5ecb8-160">Microsoft.SqlServer.Replication .NET Programming Interface</span></span>  
  
    -   <span data-ttu-id="5ecb8-161">Microsoft.SqlServer.ConnectionInfo</span><span class="sxs-lookup"><span data-stu-id="5ecb8-161">Microsoft.SqlServer.ConnectionInfo</span></span>  
  
    -   <span data-ttu-id="5ecb8-162">Biblioteca de agentes de replicação</span><span class="sxs-lookup"><span data-stu-id="5ecb8-162">Replication Agent Library</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="5ecb8-163">Use a tecla CTRL para selecionar mais de um arquivo.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-163">Use the CTRL key to select more than one file.</span></span>  
  
8.  <span data-ttu-id="5ecb8-164">(Opcional) Repita a etapa 6.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-164">(Optional) Repeat step 6.</span></span> <span data-ttu-id="5ecb8-165">Clique na guia **Procurar**, navegue para [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]COM, selecione Microsoft.SqlServer.Replication.BusinessLogicSupport.dll e clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-165">Click the **Browse** tab, navigate to [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]COM, select Microsoft.SqlServer.Replication.BusinessLogicSupport.dll, and then click **OK**.</span></span>  
  
9. <span data-ttu-id="5ecb8-166">No menu **Exibir** , clique em **Código**.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-166">On the **View** menu, click **Code**.</span></span>  
  
10. <span data-ttu-id="5ecb8-167">No código, antes de qualquer instrução, digite as instruções `Imports` a seguir para qualificar os tipos nos namespaces RMO.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-167">In the code, before any declarations, type the following `Imports` statements to qualify the types in the RMO namespaces.</span></span>  
  
    ```  
    ' These namespaces are required.  
    Imports Microsoft.SqlServer.Replication  
    Imports Microsoft.SqlServer.Management.Common  
    ' This namespace is only used when creating custom business  
    ' logic for merge replication.  
    Imports Microsoft.SqlServer.Replication.BusinessLogicSupport   
    ```  
  
## <a name="connecting-to-a-replication-server"></a><span data-ttu-id="5ecb8-168">Conectando a um servidor de replicação</span><span class="sxs-lookup"><span data-stu-id="5ecb8-168">Connecting to a Replication Server</span></span>  
 <span data-ttu-id="5ecb8-169">Os objetos de programação RMO exigem que uma conexão a uma instância do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] seja feita por meio de uma instância da classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection>.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-169">RMO programming objects require that a connection to an instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] is made by using an instance of the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span> <span data-ttu-id="5ecb8-170">Essa conexão ao servidor é feita de forma independente de qualquer objeto da programação RMO.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-170">This connection to the server is made independently of any RMO programming objects.</span></span> <span data-ttu-id="5ecb8-171">Então, ela é passada para o objeto RMO, seja durante a criação da instância, seja pela atribuição à propriedade <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> do objeto.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-171">It is then passed to the RMO object either during instance creation or by assignment to the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property of the object.</span></span> <span data-ttu-id="5ecb8-172">Dessa maneira, um objeto de programação de RMO e as instâncias de objeto de conexão podem ser criados e gerenciados separadamente, e um único objeto de conexão pode ser reutilizado com vários objetos de programação de RMO.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-172">In this manner, an RMO programming object and the connection object instances can be created and managed separately, and a single connection object can be reused with multiple RMO programming objects.</span></span> <span data-ttu-id="5ecb8-173">As regras a seguir se aplicam a conexões com um servidor de replicação:</span><span class="sxs-lookup"><span data-stu-id="5ecb8-173">The following rules apply for connections to a replication server:</span></span>  
  
-   <span data-ttu-id="5ecb8-174">Todas as propriedades da conexão são definidas para um determinado objeto de <xref:Microsoft.SqlServer.Management.Common.ServerConnection>.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-174">All properties for the connection are defined for a given <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object.</span></span>  
  
-   <span data-ttu-id="5ecb8-175">Uma conexão com cada instância do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] precisa ter seu próprio objeto <xref:Microsoft.SqlServer.Management.Common.ServerConnection>.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-175">A connection to each instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] must have its own <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object.</span></span>  
  
-   <span data-ttu-id="5ecb8-176">O objeto <xref:Microsoft.SqlServer.Management.Common.ServerConnection> é atribuído à propriedade <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> do objeto da programação RMO criado ou acessado no servidor.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-176">The <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object is assigned to the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property of the RMO programming object being created or accessed on the server.</span></span>  
  
-   <span data-ttu-id="5ecb8-177">O método <xref:Microsoft.SqlServer.Management.Common.ConnectionManager.Connect%2A> abre a conexão ao servidor.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-177">The <xref:Microsoft.SqlServer.Management.Common.ConnectionManager.Connect%2A> method opens the connection to the server.</span></span> <span data-ttu-id="5ecb8-178">Esse método deve ser chamado antes da chamada a qualquer método que acesse o servidor em qualquer objeto da programação RMO que usa a conexão.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-178">This method must be called before calling any methods that access the server on any RMO programming objects using the connection.</span></span>  
  
-   <span data-ttu-id="5ecb8-179">Como o RMO e o SMO do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] usam a classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> para conexões ao [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], a mesma conexão poderá ser usada por objetos RMO e SMO.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-179">Because RMO and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Management Objects (SMO) both use the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class for connections to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], the same connection can be used by both RMO and SMO objects.</span></span> <span data-ttu-id="5ecb8-180">Para obter mais informações, consulte [Conectando a uma instância do SQL Server](../../server-management-objects-smo/create-program/connecting-to-an-instance-of-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="5ecb8-180">For more information, see [Connecting to an Instance of SQL Server](../../server-management-objects-smo/create-program/connecting-to-an-instance-of-sql-server.md).</span></span>  
  
-   <span data-ttu-id="5ecb8-181">Todas as informações sobre autenticação para estabelecer com êxito a conexão e o logon no servidor são fornecidas no objeto <xref:Microsoft.SqlServer.Management.Common.ServerConnection>.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-181">All authentication information to make the connection and successfully log on to the server is supplied in the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object.</span></span>  
  
-   <span data-ttu-id="5ecb8-182">A Autenticação do Windows é o padrão.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-182">Windows Authentication is the default.</span></span> <span data-ttu-id="5ecb8-183">Para usar a Autenticação do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.LoginSecure%2A> deve ser definido como `false` e <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.Login%2A> e <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.Password%2A> deve ser definido como um logon e uma senha do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] válidos.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-183">To use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication, <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.LoginSecure%2A> must be set to `false` and <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.Login%2A> and <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.Password%2A> must be set to a valid [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] logon and password.</span></span> <span data-ttu-id="5ecb8-184">As credenciais de segurança sempre deverão ser armazenadas e manipuladas com segurança, além de serem fornecidas em tempo de execução quando possível.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-184">Security credentials must always be stored and handled securely, and supplied at run-time whenever possible.</span></span>  
  
-   <span data-ttu-id="5ecb8-185">Para aplicativos multithreaded, um objeto <xref:Microsoft.SqlServer.Management.Common.ServerConnection> separado deveria ser usado em cada thread.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-185">For multithreaded applications, a separate <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object should be used in each thread.</span></span>  
  
 <span data-ttu-id="5ecb8-186">Chame o método <xref:Microsoft.SqlServer.Management.Common.ConnectionManager.Disconnect%2A> no objeto <xref:Microsoft.SqlServer.Management.Common.ServerConnection> para fechar conexões de servidor ativas usadas por objetos RMO.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-186">Call the <xref:Microsoft.SqlServer.Management.Common.ConnectionManager.Disconnect%2A> method on the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object to close active server connections used by RMO objects.</span></span>  
  
## <a name="setting-rmo-properties"></a><span data-ttu-id="5ecb8-187">Definindo propriedades RMO</span><span class="sxs-lookup"><span data-stu-id="5ecb8-187">Setting RMO Properties</span></span>  
 <span data-ttu-id="5ecb8-188">As propriedades de objetos da programação RMO representam as propriedades desses objetos de replicação no servidor.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-188">The properties of RMO programming objects represent the properties of these replication objects at the server.</span></span> <span data-ttu-id="5ecb8-189">Durante a criação de novos objetos de replicação no servidor, serão usadas propriedades RMO em sua definição.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-189">When creating new replication objects at the server, RMO properties are used to define these objects.</span></span> <span data-ttu-id="5ecb8-190">Para objetos existentes, as propriedades RMO representam as propriedades do objeto existente, que só poderão ser modificadas para as propriedades passíveis de escrita ou configuração.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-190">For existing objects, the RMO properties represent the existing object's properties, which can be modified only for properties that are writable or settable.</span></span> <span data-ttu-id="5ecb8-191">As propriedades só podem ser definidas em objetos novos ou em objetos existentes.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-191">Properties can be set on new objects or existing objects.</span></span>  
  
### <a name="setting-properties-for-new-replication-objects"></a><span data-ttu-id="5ecb8-192">Definindo propriedades para objetos de replicação novos</span><span class="sxs-lookup"><span data-stu-id="5ecb8-192">Setting Properties for New Replication Objects</span></span>  
 <span data-ttu-id="5ecb8-193">Durante a criação de um novo objeto de replicação no servidor, será preciso especificar todas as propriedades exigidas antes de chamar o método `Create` do objeto.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-193">When creating a new replication object at the server, you must specify all required properties before calling the `Create` method of the object.</span></span> <span data-ttu-id="5ecb8-194">Para obter mais informações sobre como definir propriedades para um novo objeto de replicação, consulte [Configurar a publicação e a distribuição](../configure-publishing-and-distribution.md).</span><span class="sxs-lookup"><span data-stu-id="5ecb8-194">For more information about setting properties for a new replication object, see [Configure Publishing and Distribution](../configure-publishing-and-distribution.md).</span></span>  
  
### <a name="setting-properties-for-existing-replication-objects"></a><span data-ttu-id="5ecb8-195">Definindo propriedades para objetos de replicação existentes</span><span class="sxs-lookup"><span data-stu-id="5ecb8-195">Setting Properties for Existing Replication Objects</span></span>  
 <span data-ttu-id="5ecb8-196">Para objetos de replicação existentes no servidor, dependendo do objeto, o RMO poderia oferecer suporte à capacidade de alterar algumas ou todas as suas propriedades.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-196">For replication objects that exist at the server, depending on the object, RMO might support the ability to change some or all of its properties.</span></span> <span data-ttu-id="5ecb8-197">Somente as propriedades passíveis de escrita ou configuração podem ser alteradas.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-197">Only writable or settable properties can be changed.</span></span> <span data-ttu-id="5ecb8-198">Antes de alterar as propriedades, chame o método `Load` ou o método <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> para obter as propriedades atuais do servidor.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-198">Before properties can be changed, either the `Load` or the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method must be called to get the current properties from the server.</span></span> <span data-ttu-id="5ecb8-199">Chamar esses métodos indica que um objeto existente está sendo modificado.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-199">Calling these methods indicates that an existing object is being modified.</span></span>  
  
 <span data-ttu-id="5ecb8-200">Por padrão, ao alterar propriedades do objeto, o RMO confirma essas alterações no servidor com base no modo de execução do <xref:Microsoft.SqlServer.Management.Common.ServerConnection> usado.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-200">By default, when changing object properties, RMO commits these changes to the server based on the execution mode of the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> being used.</span></span> <span data-ttu-id="5ecb8-201">O método <xref:Microsoft.SqlServer.Replication.ReplicationObject.IsExistingObject%2A> pode ser usado para verificar a existência de um objeto no servidor antes da tentativa de recuperação ou de alteração de suas propriedades.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-201">The <xref:Microsoft.SqlServer.Replication.ReplicationObject.IsExistingObject%2A> method can be used to verify that an object exists at the server before attempting to retrieve or change its properties.</span></span> <span data-ttu-id="5ecb8-202">Para obter mais informações sobre como alterar as propriedades de um objeto de replicação, consulte [Exibir e modificar as propriedades do Distribuidor e do Publicador](../view-and-modify-distributor-and-publisher-properties.md).</span><span class="sxs-lookup"><span data-stu-id="5ecb8-202">For more information about changing the properties of a replication object, see [View and Modify Distributor and Publisher Properties](../view-and-modify-distributor-and-publisher-properties.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="5ecb8-203">Quando vários clientes RMO ou várias instâncias de um objeto da programação RMO estiverem acessando o mesmo objeto de replicação no servidor, o método `Refresh` do objeto RMO poderá ser chamado para atualizar as propriedades com base no estado atual do objeto no servidor.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-203">When multiple RMO clients or multiple instances of an RMO programming object are accessing the same replication object at the server, the `Refresh` method of the RMO object can be called to update the properties based on the current state of the object at the server.</span></span>  
  
### <a name="caching-property-changes"></a><span data-ttu-id="5ecb8-204">Armazenando alterações de propriedade em cache</span><span class="sxs-lookup"><span data-stu-id="5ecb8-204">Caching Property Changes</span></span>  
 <span data-ttu-id="5ecb8-205">Quando a propriedade <xref:Microsoft.SqlServer.Management.Common.SqlExecutionModes> é definida como <xref:Microsoft.SqlServer.Management.Common.SqlExecutionModes.CaptureSql>, todas as instruções [!INCLUDE[tsql](../../../includes/tsql-md.md)] geradas pelo RMO são capturadas para que possam ser executadas manualmente em um único lote usando um dos métodos de execução.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-205">When the <xref:Microsoft.SqlServer.Management.Common.SqlExecutionModes> property is set to <xref:Microsoft.SqlServer.Management.Common.SqlExecutionModes.CaptureSql> all [!INCLUDE[tsql](../../../includes/tsql-md.md)] statements generated by RMO are captured so that they can be executed manually in a single batch by using one of the execution methods.</span></span> <span data-ttu-id="5ecb8-206">O RMO permite que você armazene alterações de propriedade em cache e confirme-as em um único lote usando o método <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> do objeto.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-206">RMO lets you cache property changes and commit them together in a single batch by using the <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> method of the object.</span></span> <span data-ttu-id="5ecb8-207">Para armazenar as alterações de propriedade em cache, a propriedade <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> do objeto deve ser definida como `true`.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-207">To cache property changes, the <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> property of the object must be set to `true`.</span></span> <span data-ttu-id="5ecb8-208">Durante o armazenamento das alterações de propriedade em cache no RMO, o objeto <xref:Microsoft.SqlServer.Management.Common.ServerConnection> ainda controlará o momento em que as alterações serão enviadas ao servidor.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-208">When caching property changes in RMO, the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object still controls when changes are sent to the server.</span></span> <span data-ttu-id="5ecb8-209">Para obter mais informações sobre como armazenar em cache as alterações de propriedade de um objeto de replicação, consulte [Exibir e modificar as propriedades do Distribuidor e do Publicador](../view-and-modify-distributor-and-publisher-properties.md).</span><span class="sxs-lookup"><span data-stu-id="5ecb8-209">For more information about caching property changes for a replication object, see [View and Modify Distributor and Publisher Properties](../view-and-modify-distributor-and-publisher-properties.md).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="5ecb8-210">Embora a classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> ofereça suporte à declaração explícita de transações durante a configuração de propriedades, tais transações poderão interferir em transações internas de replicação, poderão gerar resultados inesperados e não deverão ser usadas com RMO.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-210">Although the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class supports declaring explicit transactions when setting properties, such transactions may interfere with internal replication transactions, can produce unanticipated results, and should not be used with RMO.</span></span>  
  
## <a name="example"></a><span data-ttu-id="5ecb8-211">Exemplo</span><span class="sxs-lookup"><span data-stu-id="5ecb8-211">Example</span></span>  
 <span data-ttu-id="5ecb8-212">Este exemplo demonstra o cache de alterações de propriedade.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-212">This example demonstrates the caching of property changes.</span></span> <span data-ttu-id="5ecb8-213">As alterações feitas nos atributos de uma publicação transacional são armazenadas em cache até serem explicitamente enviadas ao servidor.</span><span class="sxs-lookup"><span data-stu-id="5ecb8-213">Changes made to the attributes of a transactional publication are cached until they are explicitly sent to the server.</span></span>  
  
 [!code-csharp[HowTo#rmo_ChangeTranPub_cached](../../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_ChangeTranPub_cached)]  
  
## <a name="see-also"></a><span data-ttu-id="5ecb8-214">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="5ecb8-214">See Also</span></span>  
 <span data-ttu-id="5ecb8-215">[Replication System Stored Procedures Concepts](replication-system-stored-procedures-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="5ecb8-215">[Replication System Stored Procedures Concepts](replication-system-stored-procedures-concepts.md) </span></span>  
 [<span data-ttu-id="5ecb8-216">Conceitos de programação de replicação</span><span class="sxs-lookup"><span data-stu-id="5ecb8-216">Replication Programming Concepts</span></span>](replication-programming-concepts.md)  
  
  
