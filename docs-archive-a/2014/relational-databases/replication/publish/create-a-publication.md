---
title: Criar uma publicação | Microsoft Docs
ms.custom: ''
ms.date: 06/30/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- publications [SQL Server replication], creating
- articles [SQL Server replication], defining
- adding articles
- articles [SQL Server replication], adding
ms.assetid: 52ee6de9-1d58-4cb9-8711-372bddbe7154
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 14d8b3f1a998b18ae0153c1771fa11afd925da9c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87583508"
---
# <a name="create-a-publication"></a><span data-ttu-id="356c2-102">Create a Publication</span><span class="sxs-lookup"><span data-stu-id="356c2-102">Create a Publication</span></span>
  <span data-ttu-id="356c2-103">Este tópico descreve como criar uma publicação no [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] usando o [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../../includes/tsql-md.md)]ou RMO (Replication Management Objects).</span><span class="sxs-lookup"><span data-stu-id="356c2-103">This topic describes how to create a publication in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../../includes/tsql-md.md)], or Replication Management Objects (RMO).</span></span>  
  
 <span data-ttu-id="356c2-104">**Neste tópico**</span><span class="sxs-lookup"><span data-stu-id="356c2-104">**In This Topic**</span></span>  
  
-   <span data-ttu-id="356c2-105">**Antes de começar:**</span><span class="sxs-lookup"><span data-stu-id="356c2-105">**Before you begin:**</span></span>  
  
     [<span data-ttu-id="356c2-106">Limitações e restrições</span><span class="sxs-lookup"><span data-stu-id="356c2-106">Limitations and Restrictions</span></span>](#Restrictions)  
  
     [<span data-ttu-id="356c2-107">Segurança</span><span class="sxs-lookup"><span data-stu-id="356c2-107">Security</span></span>](#Security)  
  
-   <span data-ttu-id="356c2-108">**Para criar uma publicação e definir artigos, usando:**</span><span class="sxs-lookup"><span data-stu-id="356c2-108">**To create a publication and define articles, using:**</span></span>  
  
     [<span data-ttu-id="356c2-109">SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="356c2-109">SQL Server Management Studio</span></span>](#SSMSProcedure)  
  
     [<span data-ttu-id="356c2-110">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="356c2-110">Transact-SQL</span></span>](#TsqlProcedure)  
  
     [<span data-ttu-id="356c2-111">RMO (Replication Management Objects)</span><span class="sxs-lookup"><span data-stu-id="356c2-111">Replication Management Objects (RMO)</span></span>](#RMOProcedure)  
  
##  <a name="before-you-begin"></a><a name="BeforeYouBegin"></a> <span data-ttu-id="356c2-112">Antes de começar</span><span class="sxs-lookup"><span data-stu-id="356c2-112">Before You Begin</span></span>  
  
###  <a name="limitations-and-restrictions"></a><a name="Restrictions"></a> <span data-ttu-id="356c2-113">Limitações e restrições</span><span class="sxs-lookup"><span data-stu-id="356c2-113">Limitations and Restrictions</span></span>  
  
-   <span data-ttu-id="356c2-114">Os nomes de publicação e de artigo não podem incluir nenhum dos seguintes caracteres: % , \* , [ , ] , | , : , " , ?</span><span class="sxs-lookup"><span data-stu-id="356c2-114">Publication and article names cannot include any of the following characters: % , \* , [ , ] , | , : , " , ?</span></span> <span data-ttu-id="356c2-115">, ' , \ , / , \< , >.</span><span class="sxs-lookup"><span data-stu-id="356c2-115">, ' , \ , / , \< , >.</span></span> <span data-ttu-id="356c2-116">Se algum objeto do banco de dados incluir qualquer um desses caracteres, para replicá-los será necessário especificar um nome de artigo que seja diferente do nome do objeto na caixa de diálogo **Propriedades do Artigo – \<Article>** , disponível na página **Artigos** no assistente.</span><span class="sxs-lookup"><span data-stu-id="356c2-116">If objects in the database include any of these characters and you want to replicate them, you must specify an article name that is different from the object name in the **Article Properties - \<Article>** dialog box, which is available from the **Articles** page in the wizard.</span></span>  
  
###  <a name="security"></a><a name="Security"></a> <span data-ttu-id="356c2-117">Segurança</span><span class="sxs-lookup"><span data-stu-id="356c2-117">Security</span></span>  
 <span data-ttu-id="356c2-118">Quando possível, solicite que os usuários insiram as credenciais de segurança em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="356c2-118">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="356c2-119">Se for preciso armazenar credenciais, use os serviços [criptográficos](https://go.microsoft.com/fwlink/?LinkId=34733) fornecidos pelo [!INCLUDE[msCoName](../../../includes/msconame-md.md)] .NET Framework do Windows.</span><span class="sxs-lookup"><span data-stu-id="356c2-119">If you must store credentials, use the [cryptographic services](https://go.microsoft.com/fwlink/?LinkId=34733) provided by the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows .NET Framework.</span></span>  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="356c2-120">Usando o SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="356c2-120">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="356c2-121">Crie publicações e defina artigos com o Assistente para Nova Publicação.</span><span class="sxs-lookup"><span data-stu-id="356c2-121">Create publications and define articles with the New Publication Wizard.</span></span> <span data-ttu-id="356c2-122">Após a criação de uma publicação, veja e modifique as propriedades da publicação na caixa de diálogo **Propriedades da Publicação – \<Publication>** .</span><span class="sxs-lookup"><span data-stu-id="356c2-122">After a publication is created, view and modify publication properties in the **Publication Properties - \<Publication>** dialog box.</span></span> <span data-ttu-id="356c2-123">Para obter informações sobre como criar uma publicação de um banco de dados Oracle, consulte [Criar uma publicação de um banco de dados Oracle](create-a-publication-from-an-oracle-database.md).</span><span class="sxs-lookup"><span data-stu-id="356c2-123">For information about creating a publication from an Oracle database, see [Create a Publication from an Oracle Database](create-a-publication-from-an-oracle-database.md).</span></span>  
  
#### <a name="to-create-a-publication-and-define-articles"></a><span data-ttu-id="356c2-124">Para criar uma publicação e definir artigos</span><span class="sxs-lookup"><span data-stu-id="356c2-124">To create a publication and define articles</span></span>  
  
1.  <span data-ttu-id="356c2-125">Conecte-se ao Publicador no [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] e, em seguida, expanda o nó de servidor.</span><span class="sxs-lookup"><span data-stu-id="356c2-125">Connect to the Publisher in [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], and then expand the server node.</span></span>  
  
2.  <span data-ttu-id="356c2-126">Expanda a pasta **Replicação** e clique com o botão direito do mouse na pasta **Publicações Locais** .</span><span class="sxs-lookup"><span data-stu-id="356c2-126">Expand the **Replication** folder, and then right-click the **Local Publications** folder.</span></span>  
  
3.  <span data-ttu-id="356c2-127">Clique em **Nova Publicação**.</span><span class="sxs-lookup"><span data-stu-id="356c2-127">Click **New Publication**.</span></span>  
  
4.  <span data-ttu-id="356c2-128">Siga as páginas no Assistente para Nova Publicação para:</span><span class="sxs-lookup"><span data-stu-id="356c2-128">Follow the pages in the New Publication Wizard to:</span></span>  
  
    -   <span data-ttu-id="356c2-129">Especificar um Distribuidor se a distribuição não foi configurada no servidor.</span><span class="sxs-lookup"><span data-stu-id="356c2-129">Specify a Distributor if distribution has not been configured on the server.</span></span> <span data-ttu-id="356c2-130">Para obter mais informações sobre a configuração de distribuição, consulte [Configure Publishing and Distribution](../configure-publishing-and-distribution.md) (Configurar publicação e distribuição).</span><span class="sxs-lookup"><span data-stu-id="356c2-130">For more information about configuring distribution, see [Configure Publishing and Distribution](../configure-publishing-and-distribution.md).</span></span>  
  
         <span data-ttu-id="356c2-131">Se especificar na página do **Distribuidor** que o servidor do Publicador atuará como o seu próprio Distribuidor (um Distribuidor local) e o servidor não estiver configurado como um Distribuidor, o Assistente para Nova Publicação configurará o servidor.</span><span class="sxs-lookup"><span data-stu-id="356c2-131">If you specify on the **Distributor** page that the Publisher server will act as its own Distributor (a local Distributor), and the server is not configured as a Distributor, the New Publication Wizard will configure the server.</span></span> <span data-ttu-id="356c2-132">Você especificará uma pasta de instantâneo padrão para o Distribuidor na página **Pasta de Instantâneos** .</span><span class="sxs-lookup"><span data-stu-id="356c2-132">You will specify a default snapshot folder for the Distributor on the **Snapshot Folder** page.</span></span> <span data-ttu-id="356c2-133">A pasta de instantâneo é simplesmente um diretório que você designou como um compartilhamento, agentes que leem essa pasta e gravam nela devem ter permissões suficientes para acessá-la.</span><span class="sxs-lookup"><span data-stu-id="356c2-133">The snapshot folder is simply a directory that you have designated as a share; agents that read from and write to this folder must have sufficient permissions to access it.</span></span> <span data-ttu-id="356c2-134">Para obter mais informações sobre como proteger a pasta adequadamente, consulte [Secure the Snapshot Folder](../security/secure-the-snapshot-folder.md) (Proteger a pasta de instantâneo).</span><span class="sxs-lookup"><span data-stu-id="356c2-134">For more information about securing the folder appropriately, see [Secure the Snapshot Folder](../security/secure-the-snapshot-folder.md).</span></span>  
  
         <span data-ttu-id="356c2-135">Se você especificar que um outro servidor deverá atuar como um Distribuidor, você deverá inserir uma senha na página **Senha Administrativa** para conexões feitas do Publicador ao Distribuidor.</span><span class="sxs-lookup"><span data-stu-id="356c2-135">If you specify that another server should act as the Distributor, you must enter a password on the **Administrative Password** page for connections made from the Publisher to the Distributor.</span></span> <span data-ttu-id="356c2-136">Esta senha deve corresponder à senha especificada quando o Publicador foi habilitado no Distribuidor remoto.</span><span class="sxs-lookup"><span data-stu-id="356c2-136">This password must match the password specified when the Publisher was enabled at the remote Distributor.</span></span>  
  
         <span data-ttu-id="356c2-137">Para obter mais informações, consulte [Configure Distribution](../configure-distribution.md).</span><span class="sxs-lookup"><span data-stu-id="356c2-137">For more information, see [Configure Distribution](../configure-distribution.md).</span></span>  
  
    -   <span data-ttu-id="356c2-138">Escolha um banco de dados de publicação.</span><span class="sxs-lookup"><span data-stu-id="356c2-138">Choose a publication database.</span></span>  
  
    -   <span data-ttu-id="356c2-139">Selecione um tipo de publicação.</span><span class="sxs-lookup"><span data-stu-id="356c2-139">Select a publication type.</span></span> <span data-ttu-id="356c2-140">Para obter mais informações, consulte [Types of Replication](../types-of-replication.md) (Tipos de replicação).</span><span class="sxs-lookup"><span data-stu-id="356c2-140">For more information, see [Types of Replication](../types-of-replication.md).</span></span>  
  
    -   <span data-ttu-id="356c2-141">Especifique os dados e os objetos de banco de dados para serem publicados; opcionalmente filtre as colunas de artigos de tabela e defina as propriedades dos artigos.</span><span class="sxs-lookup"><span data-stu-id="356c2-141">Specify data and database objects to publish; optionally filter columns from table articles, and set article properties.</span></span>  
  
    -   <span data-ttu-id="356c2-142">Opcionalmente filtre as linhas de artigos de tabela.</span><span class="sxs-lookup"><span data-stu-id="356c2-142">Optionally filter rows from table articles.</span></span> <span data-ttu-id="356c2-143">Para obter mais informações, consulte [Filter Published Data](filter-published-data.md) (Filtrar dados publicados).</span><span class="sxs-lookup"><span data-stu-id="356c2-143">For more information, see [Filter Published Data](filter-published-data.md).</span></span>  
  
    -   <span data-ttu-id="356c2-144">Defina a agenda do Snapshot Agent.</span><span class="sxs-lookup"><span data-stu-id="356c2-144">Set the Snapshot Agent schedule.</span></span>  
  
    -   <span data-ttu-id="356c2-145">Especifique as credenciais sob as quais os agentes de replicação a seguir executam e fazem conexões:</span><span class="sxs-lookup"><span data-stu-id="356c2-145">Specify the credentials under which the following replication agents run and make connections:</span></span>  
  
         <span data-ttu-id="356c2-146">\- Snapshot Agent para todas as publicações.</span><span class="sxs-lookup"><span data-stu-id="356c2-146">\- Snapshot Agent for all publications.</span></span>  
  
         <span data-ttu-id="356c2-147">\- O Agente de Leitor de Log para todas as publicações transacionais.</span><span class="sxs-lookup"><span data-stu-id="356c2-147">\- Log Reader Agent for all transactional publications.</span></span>  
  
         <span data-ttu-id="356c2-148">\- O Queue Reader Agent para as publicações transacionais que permitem atualização de assinaturas.</span><span class="sxs-lookup"><span data-stu-id="356c2-148">\- Queue Reader Agent for transactional publications that allow updating subscriptions.</span></span>  
  
         <span data-ttu-id="356c2-149">Para obter mais informações, consulte [Replication Agent Security Model](../security/replication-agent-security-model.md) e [Replication Security Best Practices](../security/replication-security-best-practices.md).</span><span class="sxs-lookup"><span data-stu-id="356c2-149">For more information, see [Replication Agent Security Model](../security/replication-agent-security-model.md) and [Replication Security Best Practices](../security/replication-security-best-practices.md).</span></span>  
  
    -   <span data-ttu-id="356c2-150">Opcionalmente faça o script da publicação.</span><span class="sxs-lookup"><span data-stu-id="356c2-150">Optionally script the publication.</span></span> <span data-ttu-id="356c2-151">Para obter mais informações, consulte [Scripting Replication](../scripting-replication.md).</span><span class="sxs-lookup"><span data-stu-id="356c2-151">For more information, see [Scripting Replication](../scripting-replication.md).</span></span>  
  
    -   <span data-ttu-id="356c2-152">Especifique um nome para a publicação.</span><span class="sxs-lookup"><span data-stu-id="356c2-152">Specify a name for the publication.</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="356c2-153">Usando o Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="356c2-153">Using Transact-SQL</span></span>  
 <span data-ttu-id="356c2-154">Publicações podem ser criadas programaticamente usando procedimentos armazenados de replicação.</span><span class="sxs-lookup"><span data-stu-id="356c2-154">Publications can be created programmatically using replication stored procedures.</span></span> <span data-ttu-id="356c2-155">Os procedimentos armazenados a serem usados dependerão do tipo de publicação a ser criada.</span><span class="sxs-lookup"><span data-stu-id="356c2-155">The stored procedures that are used will depend on the type of publication being created.</span></span>  
  
#### <a name="to-create-a-snapshot-or-transactional-publication"></a><span data-ttu-id="356c2-156">Para criar uma publicação de instantâneo ou transacional</span><span class="sxs-lookup"><span data-stu-id="356c2-156">To create a snapshot or transactional publication</span></span>  
  
1.  <span data-ttu-id="356c2-157">No Publicador do banco de dados de publicação, execute [sp_replicationdboption &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-replicationdboption-transact-sql) para habilitar publicação do banco de dados atual usando replicação de instantâneo ou transacional.</span><span class="sxs-lookup"><span data-stu-id="356c2-157">At the Publisher on the publication database, execute [sp_replicationdboption &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-replicationdboption-transact-sql) to enable publication of the current database using snapshot or transactional replication.</span></span>  
  
2.  <span data-ttu-id="356c2-158">Para uma publicação transacional, determine se um existe um trabalho do Log Reader Agent para o banco de dados de publicação.</span><span class="sxs-lookup"><span data-stu-id="356c2-158">For a transactional publication, determine whether a Log Reader Agent job exists for the publication database.</span></span> <span data-ttu-id="356c2-159">(Essa etapa não é requerida para publicações de instantâneo.)</span><span class="sxs-lookup"><span data-stu-id="356c2-159">(This step is not required for snapshot publications.)</span></span>  
  
    -   <span data-ttu-id="356c2-160">Se já houver um trabalho do Log Reader Agent para o banco de dados de publicação, passe à etapa 3.</span><span class="sxs-lookup"><span data-stu-id="356c2-160">If a Log Reader Agent job exists for the publication database, proceed to step 3.</span></span>  
  
    -   <span data-ttu-id="356c2-161">Se você não estiver seguro quanto à existência de um trabalho do Agente do Leitor de Log para um banco de dados publicado, execute [sp_helplogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helplogreader-agent-transact-sql) no Publicador do banco de dados de publicação.</span><span class="sxs-lookup"><span data-stu-id="356c2-161">If you are unsure whether a Log Reader Agent job exists for a published database, execute [sp_helplogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helplogreader-agent-transact-sql) at the Publisher on the publication database.</span></span>  
  
    -   <span data-ttu-id="356c2-162">Se o conjunto de resultados estiver vazio, crie um trabalho do Log Reader Agent.</span><span class="sxs-lookup"><span data-stu-id="356c2-162">If the result set is empty, create a Log Reader Agent job.</span></span> <span data-ttu-id="356c2-163">No Publicador, execute [sp_addlogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlogreader-agent-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="356c2-163">At the Publisher, execute [sp_addlogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlogreader-agent-transact-sql).</span></span> <span data-ttu-id="356c2-164">Especifique as credenciais do [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows com as quais o agente é executado em **\@job_name** e **\@password**.</span><span class="sxs-lookup"><span data-stu-id="356c2-164">Specify the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows credentials under which the agent runs for **\@job_name** and **\@password**.</span></span> <span data-ttu-id="356c2-165">Se o agente pretender usar a Autenticação do SQL Server ao se conectar ao Publicador, você também precisará especificar um valor igual a **0** em **\@publisher_security_mode** e as informações de logon do [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] em **\@publisher_login** e **\@publisher_password**.</span><span class="sxs-lookup"><span data-stu-id="356c2-165">If the agent will use SQL Server Authentication when connecting to the Publisher, you must also specify a value of **0** for **\@publisher_security_mode** and the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login information for **\@publisher_login** and **\@publisher_password**.</span></span> <span data-ttu-id="356c2-166">Passe para a etapa 3.</span><span class="sxs-lookup"><span data-stu-id="356c2-166">Proceed to step 3.</span></span>  
  
3.  <span data-ttu-id="356c2-167">No Publicador, execute [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="356c2-167">At the Publisher, execute [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql).</span></span> <span data-ttu-id="356c2-168">Especifique um nome de publicação para \*\* \@ publicação**e, para o parâmetro \*\* \@ repl_freq** , especifique um valor de `snapshot` para uma publicação de instantâneo ou um valor de `continuous` para uma publicação transacional.</span><span class="sxs-lookup"><span data-stu-id="356c2-168">Specify a publication name for **\@publication**, and, for the **\@repl_freq** parameter, specify a value of `snapshot` for a snapshot publication or a value of `continuous` for a transactional publication.</span></span> <span data-ttu-id="356c2-169">Especifique quaisquer outras opções de publicação.</span><span class="sxs-lookup"><span data-stu-id="356c2-169">Specify any other publication options.</span></span> <span data-ttu-id="356c2-170">Isso define a publicação.</span><span class="sxs-lookup"><span data-stu-id="356c2-170">This defines the publication.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="356c2-171">Os nomes de publicação não podem incluir nenhum dos caracteres a seguir:</span><span class="sxs-lookup"><span data-stu-id="356c2-171">Publication names cannot include the following characters:</span></span>  
    >   
    >  <span data-ttu-id="356c2-172">% \* [ ] | : " ?</span><span class="sxs-lookup"><span data-stu-id="356c2-172">% \* [ ] | : " ?</span></span> <span data-ttu-id="356c2-173">\ / \< ></span><span class="sxs-lookup"><span data-stu-id="356c2-173">\ / \< ></span></span>  
  
4.  <span data-ttu-id="356c2-174">No Publicador, execute [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="356c2-174">At the Publisher, execute [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql).</span></span> <span data-ttu-id="356c2-175">Especifique o nome da publicação usado na etapa 3 em **\@publication** e as credenciais do Windows com as quais o Agente de Instantâneo é executado em **\@snapshot_job_name** e **\@password**.</span><span class="sxs-lookup"><span data-stu-id="356c2-175">Specify the publication name used in step 3 for **\@publication** and the Windows credentials under which the Snapshot Agent runs for **\@snapshot_job_name** and **\@password**.</span></span> <span data-ttu-id="356c2-176">Se o agente pretender usar a Autenticação do SQL Server ao se conectar ao Publicador, você também precisará especificar um valor igual a **0** em **\@publisher_security_mode** e as informações de logon do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] em **\@publisher_login** e **\@publisher_password**.</span><span class="sxs-lookup"><span data-stu-id="356c2-176">If the agent will use SQL Server Authentication when connecting to the Publisher, you must also specify a value of **0** for **\@publisher_security_mode** and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login information for **\@publisher_login** and **\@publisher_password**.</span></span> <span data-ttu-id="356c2-177">Isso cria um trabalho do Agente de Instantâneo para a publicação.</span><span class="sxs-lookup"><span data-stu-id="356c2-177">This creates a Snapshot Agent job for the publication.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="356c2-178">Quando um Publicador é configurado com um Distribuidor remoto, os valores fornecidos para todos os parâmetros, inclusive *job_login* e *job_password*, são enviados ao Distribuidor como texto sem-formatação.</span><span class="sxs-lookup"><span data-stu-id="356c2-178">When configuring a Publisher with a remote Distributor, the values supplied for all parameters, including *job_login* and *job_password*, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="356c2-179">Você deve criptografar a conexão entre o Publicador e seu Distribuidor remoto antes de executar esse procedimento armazenado.</span><span class="sxs-lookup"><span data-stu-id="356c2-179">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="356c2-180">Para obter mais informações, veja [Habilitar conexões criptografadas no Mecanismo de Banco de Dados &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span><span class="sxs-lookup"><span data-stu-id="356c2-180">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
5.  <span data-ttu-id="356c2-181">Adicione artigos à publicação.</span><span class="sxs-lookup"><span data-stu-id="356c2-181">Add articles to the publication.</span></span> <span data-ttu-id="356c2-182">Para obter mais informações, consulte [Define an Article](define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="356c2-182">For more information, see [Define an Article](define-an-article.md).</span></span>  
  
6.  <span data-ttu-id="356c2-183">Inicie o trabalho do Agente de Instantâneo para gerar o instantâneo inicial para essa publicação.</span><span class="sxs-lookup"><span data-stu-id="356c2-183">Start the Snapshot Agent job to generate the initial snapshot for this publication.</span></span> <span data-ttu-id="356c2-184">Para obter mais informações, consulte [Criar e aplicar o instantâneo inicial](../create-and-apply-the-initial-snapshot.md).</span><span class="sxs-lookup"><span data-stu-id="356c2-184">For more information, see [Create and Apply the Initial Snapshot](../create-and-apply-the-initial-snapshot.md).</span></span>  
  
#### <a name="to-create-a-merge-publication"></a><span data-ttu-id="356c2-185">Para criar uma publicação de mesclagem</span><span class="sxs-lookup"><span data-stu-id="356c2-185">To create a merge publication</span></span>  
  
1.  <span data-ttu-id="356c2-186">No Publicador, execute [sp_replicationdboption &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-replicationdboption-transact-sql) para habilitar a publicação do banco de dados atual usando a replicação de mesclagem.</span><span class="sxs-lookup"><span data-stu-id="356c2-186">At the Publisher, execute [sp_replicationdboption &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-replicationdboption-transact-sql) to enable publication of the current database using merge replication.</span></span>  
  
2.  <span data-ttu-id="356c2-187">No Publicador do banco de dados de publicação, execute [sp_addmergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="356c2-187">At the Publisher on the publication database, execute [sp_addmergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql).</span></span> <span data-ttu-id="356c2-188">Especifique o nome da publicação em **\@publication** e as outras opções de publicação.</span><span class="sxs-lookup"><span data-stu-id="356c2-188">Specify a name for the publication for **\@publication** and any other publication options.</span></span> <span data-ttu-id="356c2-189">Isso define a publicação.</span><span class="sxs-lookup"><span data-stu-id="356c2-189">This defines the publication.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="356c2-190">Os nomes de publicação não podem incluir nenhum dos caracteres a seguir:</span><span class="sxs-lookup"><span data-stu-id="356c2-190">Publication names cannot include the following characters:</span></span>  
    >   
    >  <span data-ttu-id="356c2-191">% \* [ ] | : " ?</span><span class="sxs-lookup"><span data-stu-id="356c2-191">% \* [ ] | : " ?</span></span> <span data-ttu-id="356c2-192">\ / \< ></span><span class="sxs-lookup"><span data-stu-id="356c2-192">\ / \< ></span></span>  
  
3.  <span data-ttu-id="356c2-193">No Publicador, execute [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="356c2-193">At the Publisher, execute [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql).</span></span> <span data-ttu-id="356c2-194">Especifique o nome da publicação usado na etapa 2 em **\@publication** e as credenciais do Windows com as quais o Agente de Instantâneo é executado em **\@snapshot_job_name** e **\@password**.</span><span class="sxs-lookup"><span data-stu-id="356c2-194">Specify the publication name used in step 2 for **\@publication** and the Windows credentials under which the Snapshot Agent runs for **\@snapshot_job_name** and **\@password**.</span></span> <span data-ttu-id="356c2-195">Se o agente pretender usar a Autenticação do SQL Server ao se conectar ao Publicador, você também precisará especificar um valor igual a **0** em **\@publisher_security_mode** e as informações de logon do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] em **\@publisher_login** e **\@publisher_password**.</span><span class="sxs-lookup"><span data-stu-id="356c2-195">If the agent will use SQL Server Authentication when connecting to the Publisher, you must also specify a value of **0** for **\@publisher_security_mode** and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login information for **\@publisher_login** and **\@publisher_password**.</span></span> <span data-ttu-id="356c2-196">Isso cria um trabalho do Agente de Instantâneo para a publicação.</span><span class="sxs-lookup"><span data-stu-id="356c2-196">This creates a Snapshot Agent job for the publication.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="356c2-197">Quando um Publicador é configurado com um Distribuidor remoto, os valores fornecidos para todos os parâmetros, inclusive *job_login* e *job_password*, são enviados ao Distribuidor como texto sem-formatação.</span><span class="sxs-lookup"><span data-stu-id="356c2-197">When configuring a Publisher with a remote Distributor, the values supplied for all parameters, including *job_login* and *job_password*, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="356c2-198">Você deve criptografar a conexão entre o Publicador e seu Distribuidor remoto antes de executar esse procedimento armazenado.</span><span class="sxs-lookup"><span data-stu-id="356c2-198">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="356c2-199">Para obter mais informações, veja [Habilitar conexões criptografadas no Mecanismo de Banco de Dados &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span><span class="sxs-lookup"><span data-stu-id="356c2-199">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
4.  <span data-ttu-id="356c2-200">Adicione artigos à publicação.</span><span class="sxs-lookup"><span data-stu-id="356c2-200">Add articles to the publication.</span></span> <span data-ttu-id="356c2-201">Para obter mais informações, consulte [Define an Article](define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="356c2-201">For more information, see [Define an Article](define-an-article.md).</span></span>  
  
5.  <span data-ttu-id="356c2-202">Inicie o trabalho do Agente de Instantâneo para gerar o instantâneo inicial para essa publicação.</span><span class="sxs-lookup"><span data-stu-id="356c2-202">Start the Snapshot Agent job to generate the initial snapshot for this publication.</span></span> <span data-ttu-id="356c2-203">Para obter mais informações, consulte [Criar e aplicar o instantâneo inicial](../create-and-apply-the-initial-snapshot.md).</span><span class="sxs-lookup"><span data-stu-id="356c2-203">For more information, see [Create and Apply the Initial Snapshot](../create-and-apply-the-initial-snapshot.md).</span></span>  
  
###  <a name="example-transact-sql"></a><a name="TsqlExample"></a> <span data-ttu-id="356c2-204">Exemplo (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="356c2-204">Example (Transact-SQL)</span></span>  
 <span data-ttu-id="356c2-205">Este exemplo cria uma publicação transacional.</span><span class="sxs-lookup"><span data-stu-id="356c2-205">This example creates a transactional publication.</span></span> <span data-ttu-id="356c2-206">As variáveis de script são usadas para passar as credenciais do Windows necessárias para criar trabalhos do Agente de Instantâneo e do Agente de Leitor de Log.</span><span class="sxs-lookup"><span data-stu-id="356c2-206">Scripting variables are used to pass Windows credentials that are needed to create jobs for the Snapshot Agent and Log Reader Agent.</span></span>  
  
 [!code-sql[HowTo#sp_AddTranPub](../../../snippets/tsql/SQL15/replication/howto/tsql/createtranpub.sql#sp_addtranpub)]  
  
 <span data-ttu-id="356c2-207">Este exemplo cria uma publicação de mesclagem.</span><span class="sxs-lookup"><span data-stu-id="356c2-207">This example creates a merge publication.</span></span> <span data-ttu-id="356c2-208">As variáveis de script são usadas para passar as credenciais do Windows necessárias para criar o trabalho do Agente de Instantâneo.</span><span class="sxs-lookup"><span data-stu-id="356c2-208">Scripting variables are used to pass Windows credentials that are needed to create the job for the Snapshot Agent.</span></span>  
  
 [!code-sql[HowTo#sp_AddMergePub](../../../snippets/tsql/SQL15/replication/howto/tsql/createmergepub.sql#sp_addmergepub)]  
  
##  <a name="using-replication-management-objects-rmo"></a><a name="RMOProcedure"></a> <span data-ttu-id="356c2-209">Usando o RMO (Replication Management Objects)</span><span class="sxs-lookup"><span data-stu-id="356c2-209">Using Replication Management Objects (RMO)</span></span>  
 <span data-ttu-id="356c2-210">Crie publicações de forma programada, usando o RMO (Replication Management Objects).</span><span class="sxs-lookup"><span data-stu-id="356c2-210">You can create publications programmatically by using Replication Management Objects (RMO).</span></span> <span data-ttu-id="356c2-211">As classes de RMO usadas para criar uma publicação dependem do tipo de publicação criada.</span><span class="sxs-lookup"><span data-stu-id="356c2-211">The RMO classes that you use to create a publication depend on the type of publication you create.</span></span>  
  
#### <a name="to-create-a-snapshot-or-transactional-publication"></a><span data-ttu-id="356c2-212">Para criar uma publicação de instantâneo ou transacional</span><span class="sxs-lookup"><span data-stu-id="356c2-212">To create a snapshot or transactional publication</span></span>  
  
1.  <span data-ttu-id="356c2-213">Crie uma conexão com o Publicador usando a classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="356c2-213">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="356c2-214">Crie uma instância da classe <xref:Microsoft.SqlServer.Replication.ReplicationDatabase> para o banco de dados de publicação; defina a propriedade <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> para a instância de <xref:Microsoft.SqlServer.Management.Common.ServerConnection> da etapa 1 e chame o método <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> .</span><span class="sxs-lookup"><span data-stu-id="356c2-214">Create an instance of the <xref:Microsoft.SqlServer.Replication.ReplicationDatabase> class for the publication database, set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the instance of <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1, and call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method.</span></span> <span data-ttu-id="356c2-215">Se <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> retornar `false`, verifique se o banco de dados existe.</span><span class="sxs-lookup"><span data-stu-id="356c2-215">If <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> returns `false`, verify that the database exists.</span></span>  
  
3.  <span data-ttu-id="356c2-216">Se a propriedade <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.EnabledTransPublishing%2A> for `false`, defina-a como `true`.</span><span class="sxs-lookup"><span data-stu-id="356c2-216">If the <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.EnabledTransPublishing%2A> property is `false`, set it to `true`.</span></span>  
  
4.  <span data-ttu-id="356c2-217">Para uma publicação transacional, verifique o valor da <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.LogReaderAgentExists%2A> propriedade.</span><span class="sxs-lookup"><span data-stu-id="356c2-217">For a transactional publication, check the value of the <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.LogReaderAgentExists%2A> property.</span></span> <span data-ttu-id="356c2-218">Se essa propriedade for `true`, um trabalho do Log Reader Agent já existirá para esse banco de dados.</span><span class="sxs-lookup"><span data-stu-id="356c2-218">If this property is `true`, a Log Read Agent job already exists for this database.</span></span> <span data-ttu-id="356c2-219">Se essa propriedade for `false`, faça o seguinte:</span><span class="sxs-lookup"><span data-stu-id="356c2-219">If this property is `false`, do the following:</span></span>  
  
    -   <span data-ttu-id="356c2-220">Defina os campos <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> e <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> ou <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.SecurePassword%2A> de <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.LogReaderAgentProcessSecurity%2A> para fornecer as credenciais da conta do Windows do [!INCLUDE[msCoName](../../../includes/msconame-md.md)] na qual o Log Reader Agent é executado.</span><span class="sxs-lookup"><span data-stu-id="356c2-220">Set the <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> and <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> or <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.SecurePassword%2A> fields of <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.LogReaderAgentProcessSecurity%2A> to provide the credentials for the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows account under which the Log Reader Agent runs.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="356c2-221">Não é necessário definir <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.LogReaderAgentProcessSecurity%2A> quando a publicação é criada por um membro da função de servidor fixa `sysadmin`.</span><span class="sxs-lookup"><span data-stu-id="356c2-221">Setting <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.LogReaderAgentProcessSecurity%2A> is not required when the publication is created by a member of the `sysadmin` fixed server role.</span></span> <span data-ttu-id="356c2-222">Nesse caso, o agente representará a conta do SQL Server Agent.</span><span class="sxs-lookup"><span data-stu-id="356c2-222">In this case, the agent will impersonate the SQL Server Agent account.</span></span> <span data-ttu-id="356c2-223">Para obter mais informações, consulte [Replication Agent Security Model](../security/replication-agent-security-model.md).</span><span class="sxs-lookup"><span data-stu-id="356c2-223">For more information, see [Replication Agent Security Model](../security/replication-agent-security-model.md).</span></span>  
  
    -   <span data-ttu-id="356c2-224">(Opcional) Defina os campos <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> e <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> ou <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> de <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.LogReaderAgentPublisherSecurity%2A> ao usar a Autenticação do SQL Server para conexão com o Publicador.</span><span class="sxs-lookup"><span data-stu-id="356c2-224">(Optional) Set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> or <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> fields of <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.LogReaderAgentPublisherSecurity%2A> when using SQL Server Authentication to connect to the Publisher.</span></span>  
  
    -   <span data-ttu-id="356c2-225">Chame o método <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.CreateLogReaderAgent%2A> para criar o trabalho do Log Reader Agent para o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="356c2-225">Call the <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.CreateLogReaderAgent%2A> method to create the Log Reader Agent job for the database.</span></span>  
  
5.  <span data-ttu-id="356c2-226">Crie uma instância da classe <xref:Microsoft.SqlServer.Replication.TransPublication> e defina as propriedades a seguir para esse objeto:</span><span class="sxs-lookup"><span data-stu-id="356c2-226">Create an instance of the <xref:Microsoft.SqlServer.Replication.TransPublication> class, and set the following properties for this object:</span></span>  
  
    -   <span data-ttu-id="356c2-227">O <xref:Microsoft.SqlServer.Management.Common.ServerConnection> da Etapa 1 para <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span><span class="sxs-lookup"><span data-stu-id="356c2-227">The <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1 for <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
    -   <span data-ttu-id="356c2-228">Nome do banco de dados publicado para <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A>.</span><span class="sxs-lookup"><span data-stu-id="356c2-228">The name of the published database for <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A>.</span></span>  
  
    -   <span data-ttu-id="356c2-229">Um nome para a publicação para <xref:Microsoft.SqlServer.Replication.Publication.Name%2A>.</span><span class="sxs-lookup"><span data-stu-id="356c2-229">A name for the publication for <xref:Microsoft.SqlServer.Replication.Publication.Name%2A>.</span></span>  
  
    -   <span data-ttu-id="356c2-230">Um <xref:Microsoft.SqlServer.Replication.PublicationType> de ambos <xref:Microsoft.SqlServer.Replication.PublicationType.Transactional> ou <xref:Microsoft.SqlServer.Replication.PublicationType.Snapshot>.</span><span class="sxs-lookup"><span data-stu-id="356c2-230">A <xref:Microsoft.SqlServer.Replication.PublicationType> of either <xref:Microsoft.SqlServer.Replication.PublicationType.Transactional> or <xref:Microsoft.SqlServer.Replication.PublicationType.Snapshot>.</span></span>  
  
    -   <span data-ttu-id="356c2-231">Os campos <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> e <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> de <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A> para fornecer as credenciais para a conta do Windows em que o Snapshot Agent é executado.</span><span class="sxs-lookup"><span data-stu-id="356c2-231">The <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> and <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> fields of <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A> to provide the credentials for the Windows account under which the Snapshot Agent runs.</span></span> <span data-ttu-id="356c2-232">Essa conta é também usada quando o Snapshot Agent faz conexões com o Distributor local e para conexões remotas quando se usa a Autenticação do Windows.</span><span class="sxs-lookup"><span data-stu-id="356c2-232">This account is also used when the Snapshot Agent makes connections to the local Distributor and for any remote connections when using Windows Authentication.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="356c2-233">Não é necessário definir <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A> quando a publicação é criada por um membro da função de servidor fixa `sysadmin`.</span><span class="sxs-lookup"><span data-stu-id="356c2-233">Setting <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A> is not required when the publication is created by a member of the `sysadmin` fixed server role.</span></span> <span data-ttu-id="356c2-234">Nesse caso, o agente representará a conta do SQL Server Agent.</span><span class="sxs-lookup"><span data-stu-id="356c2-234">In this case, the agent will impersonate the SQL Server Agent account.</span></span> <span data-ttu-id="356c2-235">Para obter mais informações, consulte [Replication Agent Security Model](../security/replication-agent-security-model.md).</span><span class="sxs-lookup"><span data-stu-id="356c2-235">For more information, see [Replication Agent Security Model](../security/replication-agent-security-model.md).</span></span>  
  
    -   <span data-ttu-id="356c2-236">(Opcional) Os campos <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> e <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> ou <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> de <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentPublisherSecurity%2A> ao usar a Autenticação do SQL Server para conexão com o Publicador.</span><span class="sxs-lookup"><span data-stu-id="356c2-236">(Optional) The <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> or <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> fields of <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentPublisherSecurity%2A> when using SQL Server Authentication to connect to the Publisher.</span></span>  
  
    -   <span data-ttu-id="356c2-237">(Opcional) Use o operador OR de lógica inclusiva (`|` no Visual C# e `Or` no Visual Basic) e o operador OR de lógica exclusiva (`^` no Visual C# e `Xor` no Visual Basic) para definir os valores <xref:Microsoft.SqlServer.Replication.PublicationAttributes> da propriedade <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A>.</span><span class="sxs-lookup"><span data-stu-id="356c2-237">(Optional) Use the inclusive logical OR operator (`|` in Visual C# and `Or` in Visual Basic) and the exclusive logical OR operator (`^` in Visual C# and `Xor` in Visual Basic) to set the <xref:Microsoft.SqlServer.Replication.PublicationAttributes> values for the <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> property.</span></span>  
  
    -   <span data-ttu-id="356c2-238">(Opcional) O nome do Publicador para <xref:Microsoft.SqlServer.Replication.TransPublication.PublisherName%2A> quando o Publicador é não SQL Server.</span><span class="sxs-lookup"><span data-stu-id="356c2-238">(Optional) The name of the Publisher for <xref:Microsoft.SqlServer.Replication.TransPublication.PublisherName%2A> when the Publisher is a non-SQL Server Publisher.</span></span>  
  
6.  <span data-ttu-id="356c2-239">Chame o método <xref:Microsoft.SqlServer.Replication.Publication.Create%2A> para criar a publicação.</span><span class="sxs-lookup"><span data-stu-id="356c2-239">Call the <xref:Microsoft.SqlServer.Replication.Publication.Create%2A> method to create the publication.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="356c2-240">Quando um Publicador é configurado com um Distribuidor remoto, os valores fornecidos para todas as propriedades, inclusive <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A>, são enviados ao Distribuidor como texto sem-formatação.</span><span class="sxs-lookup"><span data-stu-id="356c2-240">When configuring a Publisher with a remote Distributor, the values supplied for all properties, including <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A>, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="356c2-241">É necessário criptografar a conexão entre o Publicador e o respectivo Distribuidor remoto antes de chamar o método <xref:Microsoft.SqlServer.Replication.Publication.Create%2A>.</span><span class="sxs-lookup"><span data-stu-id="356c2-241">You should encrypt the connection between the Publisher and its remote Distributor before calling the <xref:Microsoft.SqlServer.Replication.Publication.Create%2A> method.</span></span> <span data-ttu-id="356c2-242">Para obter mais informações, veja [Habilitar conexões criptografadas no Mecanismo de Banco de Dados &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span><span class="sxs-lookup"><span data-stu-id="356c2-242">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
7.  <span data-ttu-id="356c2-243">Chame o método <xref:Microsoft.SqlServer.Replication.Publication.CreateSnapshotAgent%2A> para criar o trabalho do Agente de Instantâneo para a publicação.</span><span class="sxs-lookup"><span data-stu-id="356c2-243">Call the <xref:Microsoft.SqlServer.Replication.Publication.CreateSnapshotAgent%2A> method to create the Snapshot Agent job for the publication.</span></span>  
  
#### <a name="to-create-a-merge-publication"></a><span data-ttu-id="356c2-244">Para criar uma publicação de mesclagem</span><span class="sxs-lookup"><span data-stu-id="356c2-244">To create a merge publication</span></span>  
  
1.  <span data-ttu-id="356c2-245">Crie uma conexão com o Publicador usando a classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="356c2-245">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="356c2-246">Crie uma instância da classe <xref:Microsoft.SqlServer.Replication.ReplicationDatabase> para o banco de dados de publicação; defina a propriedade <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> para a instância de <xref:Microsoft.SqlServer.Management.Common.ServerConnection> da etapa 1 e chame o método <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> .</span><span class="sxs-lookup"><span data-stu-id="356c2-246">Create an instance of the <xref:Microsoft.SqlServer.Replication.ReplicationDatabase> class for the publication database, set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the instance of <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1, and call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method.</span></span> <span data-ttu-id="356c2-247">Se <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> retornar `false`, verifique se o banco de dados existe.</span><span class="sxs-lookup"><span data-stu-id="356c2-247">If <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> returns `false`, verify that the database exists.</span></span>  
  
3.  <span data-ttu-id="356c2-248">Se <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.EnabledMergePublishing%2A> a propriedade for `false` , defina-a como `true` e chame <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> .</span><span class="sxs-lookup"><span data-stu-id="356c2-248">If <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.EnabledMergePublishing%2A> Property is `false`, set it to `true`, and call <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A>.</span></span>  
  
4.  <span data-ttu-id="356c2-249">Crie uma instância da classe <xref:Microsoft.SqlServer.Replication.MergePublication> e defina as propriedades a seguir para esse objeto:</span><span class="sxs-lookup"><span data-stu-id="356c2-249">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergePublication> class, and set the following properties for this object:</span></span>  
  
    -   <span data-ttu-id="356c2-250">O <xref:Microsoft.SqlServer.Management.Common.ServerConnection> da Etapa 1 para <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span><span class="sxs-lookup"><span data-stu-id="356c2-250">The <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1 for <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
    -   <span data-ttu-id="356c2-251">Nome do banco de dados publicado para <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A>.</span><span class="sxs-lookup"><span data-stu-id="356c2-251">The name of the published database for <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A>.</span></span>  
  
    -   <span data-ttu-id="356c2-252">Um nome para a publicação para <xref:Microsoft.SqlServer.Replication.Publication.Name%2A>.</span><span class="sxs-lookup"><span data-stu-id="356c2-252">A name for the publication for <xref:Microsoft.SqlServer.Replication.Publication.Name%2A>.</span></span>  
  
    -   <span data-ttu-id="356c2-253">Os campos <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> e <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> de <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A> para fornecer as credenciais para a conta do Windows em que o Snapshot Agent é executado.</span><span class="sxs-lookup"><span data-stu-id="356c2-253">The <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> and <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> fields of <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A> to provide the credentials for the Windows account under which the Snapshot Agent runs.</span></span> <span data-ttu-id="356c2-254">Essa conta é também usada quando o Snapshot Agent faz conexões com o Distributor local e para conexões remotas quando se usa a Autenticação do Windows.</span><span class="sxs-lookup"><span data-stu-id="356c2-254">This account is also used when the Snapshot Agent makes connections to the local Distributor and for any remote connections when using Windows Authentication.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="356c2-255">Não é necessário definir <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A> quando a publicação é criada por um membro da função de servidor fixa `sysadmin`.</span><span class="sxs-lookup"><span data-stu-id="356c2-255">Setting <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A> is not required when the publication is created by a member of the `sysadmin` fixed server role.</span></span> <span data-ttu-id="356c2-256">Para obter mais informações, consulte [Replication Agent Security Model](../security/replication-agent-security-model.md).</span><span class="sxs-lookup"><span data-stu-id="356c2-256">For more information, see [Replication Agent Security Model](../security/replication-agent-security-model.md).</span></span>  
  
    -   <span data-ttu-id="356c2-257">(Opcional) Use o operador OR de lógica inclusiva (`|` no Visual C# e `Or` no Visual Basic) e o operador OR de lógica exclusiva (`^` no Visual C# e `Xor` no Visual Basic) para definir os valores <xref:Microsoft.SqlServer.Replication.PublicationAttributes> da propriedade <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A>.</span><span class="sxs-lookup"><span data-stu-id="356c2-257">(Optional) Use the inclusive logical OR operator (`|` in Visual C# and `Or` in Visual Basic) and the exclusive logical OR operator (`^` in Visual C# and `Xor` in Visual Basic) to set the <xref:Microsoft.SqlServer.Replication.PublicationAttributes> values for the <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> property.</span></span>  
  
5.  <span data-ttu-id="356c2-258">Chame o método <xref:Microsoft.SqlServer.Replication.Publication.Create%2A> para criar a publicação.</span><span class="sxs-lookup"><span data-stu-id="356c2-258">Call the <xref:Microsoft.SqlServer.Replication.Publication.Create%2A> method to create the publication.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="356c2-259">Quando um Publicador é configurado com um Distribuidor remoto, os valores fornecidos para todas as propriedades, inclusive <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A>, são enviados ao Distribuidor como texto sem-formatação.</span><span class="sxs-lookup"><span data-stu-id="356c2-259">When configuring a Publisher with a remote Distributor, the values supplied for all properties, including <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A>, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="356c2-260">É necessário criptografar a conexão entre o Publicador e o respectivo Distribuidor remoto antes de chamar o método <xref:Microsoft.SqlServer.Replication.Publication.Create%2A>.</span><span class="sxs-lookup"><span data-stu-id="356c2-260">You should encrypt the connection between the Publisher and its remote Distributor before calling the <xref:Microsoft.SqlServer.Replication.Publication.Create%2A> method.</span></span> <span data-ttu-id="356c2-261">Para obter mais informações, veja [Habilitar conexões criptografadas no Mecanismo de Banco de Dados &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span><span class="sxs-lookup"><span data-stu-id="356c2-261">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
6.  <span data-ttu-id="356c2-262">Chame o método <xref:Microsoft.SqlServer.Replication.Publication.CreateSnapshotAgent%2A> para criar o trabalho do Agente de Instantâneo para a publicação.</span><span class="sxs-lookup"><span data-stu-id="356c2-262">Call the <xref:Microsoft.SqlServer.Replication.Publication.CreateSnapshotAgent%2A> method to create the Snapshot Agent job for the publication.</span></span>  
  
###  <a name="examples-rmo"></a><a name="PShellExample"></a> <span data-ttu-id="356c2-263">Exemplos (RMO)</span><span class="sxs-lookup"><span data-stu-id="356c2-263">Examples (RMO)</span></span>  
 <span data-ttu-id="356c2-264">Esse exemplo ativa o banco de dados AdventureWorks para publicação transacional; define um trabalho do Agente de Leitor de Log e cria a publicação AdvWorksProductTran.</span><span class="sxs-lookup"><span data-stu-id="356c2-264">This example enables the AdventureWorks database for transactional publishing, defines a Log Reader Agent job, and creates the AdvWorksProductTran publication.</span></span> <span data-ttu-id="356c2-265">É preciso definir um artigo para essa publicação.</span><span class="sxs-lookup"><span data-stu-id="356c2-265">An article must be defined for this publication.</span></span> <span data-ttu-id="356c2-266">As credenciais da conta do Windows necessárias para criar o trabalho do Log Reader Agent e o do Snapshot Agent são passadas em runtime.</span><span class="sxs-lookup"><span data-stu-id="356c2-266">The Windows account credentials that are needed to create the Log Reader Agent job and the Snapshot Agent job are passed at runtime.</span></span> <span data-ttu-id="356c2-267">Para saber como usar RMO para definir artigos instantâneos e transacionais, consulte [Define an Article](define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="356c2-267">To learn how to use RMO to define snapshot and transactional articles, see [Define an Article](define-an-article.md).</span></span>  
  
 [!code-csharp[HowTo#rmo_CreateTranPub](../../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_createtranpub)]  
  
 [!code-vb[HowTo#rmo_vb_CreateTranPub](../../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_createtranpub)]  
  
 <span data-ttu-id="356c2-268">Esse exemplo ativa o banco de dados AdventureWorks para publicação de mesclagem e cria a publicação AdvWorksSalesOrdersMerge.</span><span class="sxs-lookup"><span data-stu-id="356c2-268">This example enables the AdventureWorks database for merge publishing and creates the AdvWorksSalesOrdersMerge publication.</span></span> <span data-ttu-id="356c2-269">Artigos ainda precisam ser definidos para essa publicação.</span><span class="sxs-lookup"><span data-stu-id="356c2-269">Articles must still be defined for this publication.</span></span> <span data-ttu-id="356c2-270">As credenciais da conta do Windows, necessárias para criar o trabalho do Agente de Instantâneo, são passadas em runtime.</span><span class="sxs-lookup"><span data-stu-id="356c2-270">The Windows account credentials that are needed to create the Snapshot Agent job are passed at runtime.</span></span> <span data-ttu-id="356c2-271">Para saber como usar RMO para definir artigos de mesclagem, consulte [Define an Article](define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="356c2-271">To learn how to use RMO to define merge articles, see [Define an Article](define-an-article.md).</span></span>  
  
 [!code-csharp[HowTo#rmo_CreateMergePub](../../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_createmergepub)]  
  
 [!code-vb[HowTo#rmo_vb_CreateMergePub](../../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_createmergepub)]  
  
## <a name="see-also"></a><span data-ttu-id="356c2-272">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="356c2-272">See Also</span></span>  
 <span data-ttu-id="356c2-273">[Usar sqlcmd com variáveis de script](../../scripting/sqlcmd-use-with-scripting-variables.md) </span><span class="sxs-lookup"><span data-stu-id="356c2-273">[Use sqlcmd with Scripting Variables](../../scripting/sqlcmd-use-with-scripting-variables.md) </span></span>  
 <span data-ttu-id="356c2-274">[Publicar dados e objetos de banco de dados](publish-data-and-database-objects.md) </span><span class="sxs-lookup"><span data-stu-id="356c2-274">[Publish Data and Database Objects](publish-data-and-database-objects.md) </span></span>  
 <span data-ttu-id="356c2-275">[Replication Management Objects Concepts](../concepts/replication-management-objects-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="356c2-275">[Replication Management Objects Concepts](../concepts/replication-management-objects-concepts.md) </span></span>  
 <span data-ttu-id="356c2-276">[Define an Article](define-an-article.md) </span><span class="sxs-lookup"><span data-stu-id="356c2-276">[Define an Article](define-an-article.md) </span></span>  
 <span data-ttu-id="356c2-277">[Exibir e modificar as propriedades da publicação](view-and-modify-publication-properties.md) </span><span class="sxs-lookup"><span data-stu-id="356c2-277">[View and Modify Publication Properties](view-and-modify-publication-properties.md) </span></span>  
 <span data-ttu-id="356c2-278">[Configurar Distribuição](../configure-distribution.md) </span><span class="sxs-lookup"><span data-stu-id="356c2-278">[Configure Distribution](../configure-distribution.md) </span></span>  
 <span data-ttu-id="356c2-279">[Proteger o Distribuidor](../security/secure-the-distributor.md) </span><span class="sxs-lookup"><span data-stu-id="356c2-279">[Secure the Distributor](../security/secure-the-distributor.md) </span></span>  
 [<span data-ttu-id="356c2-280">Proteger o Publicador</span><span class="sxs-lookup"><span data-stu-id="356c2-280">Secure the Publisher</span></span>](../security/secure-the-publisher.md)  
  
  
