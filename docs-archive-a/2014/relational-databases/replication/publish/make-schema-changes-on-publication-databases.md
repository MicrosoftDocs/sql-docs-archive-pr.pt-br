---
title: Fazer alterações de esquema em bancos de dados de publicação | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- replication [SQL Server], schema changes
- snapshot replication [SQL Server], replicating schema changes
- merge replication [SQL Server replication], replicating schema changes
- transactional replication, replicating schema changes
- schemas [SQL Server replication], replicating changes
- publishing [SQL Server replication], schema changes
ms.assetid: 926c88d7-a844-402f-bcb9-db49e5013b69
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: e26d3e89fcba41d474ca56637f9e465f17127348
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87569344"
---
# <a name="make-schema-changes-on-publication-databases"></a><span data-ttu-id="7d584-102">Fazer alterações de esquema em bancos de dados de publicação</span><span class="sxs-lookup"><span data-stu-id="7d584-102">Make Schema Changes on Publication Databases</span></span>
  <span data-ttu-id="7d584-103">A replicação oferece suporte para um amplo intervalo de alterações de esquema para objetos publicados.</span><span class="sxs-lookup"><span data-stu-id="7d584-103">Replication supports a wide range of schema changes to published objects.</span></span> <span data-ttu-id="7d584-104">Ao se fazer qualquer uma das seguintes alterações de esquema no objeto publicado adequado em um Editor do [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], essa alteração será propagada por padrão para todos os Assinantes do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]:</span><span class="sxs-lookup"><span data-stu-id="7d584-104">When you make any of the following schema changes on the appropriate published object at a [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Publisher, that change is propagated by default to all [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Subscribers:</span></span>  
  
-   <span data-ttu-id="7d584-105">ALTER TABLE</span><span class="sxs-lookup"><span data-stu-id="7d584-105">ALTER TABLE</span></span>  
  
-   <span data-ttu-id="7d584-106">ALTER TABLE SET LOCK ESCALATION não deverá ser usado se a replicação da alteração de esquema estiver habilitada e uma topologia incluir [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] ou [!INCLUDE[ssEWnoversion](../../../includes/ssewnoversion-md.md)] Subscribers.ALTER VIEW</span><span class="sxs-lookup"><span data-stu-id="7d584-106">ALTER TABLE SET LOCK ESCALATION should not be used if schema change replication is enabled and a topology includes [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] or [!INCLUDE[ssEWnoversion](../../../includes/ssewnoversion-md.md)] Subscribers.ALTER VIEW</span></span>  
  
-   <span data-ttu-id="7d584-107">ALTER PROCEDURE</span><span class="sxs-lookup"><span data-stu-id="7d584-107">ALTER PROCEDURE</span></span>  
  
-   <span data-ttu-id="7d584-108">ALTER FUNCTION</span><span class="sxs-lookup"><span data-stu-id="7d584-108">ALTER FUNCTION</span></span>  
  
-   <span data-ttu-id="7d584-109">ALTER TRIGGER</span><span class="sxs-lookup"><span data-stu-id="7d584-109">ALTER TRIGGER</span></span>  
  
     <span data-ttu-id="7d584-110">ALTER TRIGGER pode ser usado somente para gatilhos DML [linguagem de manipulação de dados], pois os gatilhos DDL [linguagem de definição de dados] não podem ser replicados.</span><span class="sxs-lookup"><span data-stu-id="7d584-110">ALTER TRIGGER can be used only for data manipulation language [DML] triggers because data definition language [DDL] triggers cannot be replicated.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="7d584-111">As alterações de esquema para tabelas devem ser feitas usando-se [!INCLUDE[tsql](../../../includes/tsql-md.md)] ou SMO ( [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Management Objects).</span><span class="sxs-lookup"><span data-stu-id="7d584-111">Schema changes to tables must be made by using [!INCLUDE[tsql](../../../includes/tsql-md.md)] or [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Management Objects (SMO).</span></span> <span data-ttu-id="7d584-112">Quando alterações de esquema forem feitas em [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[ssManStudio](../../../includes/ssmanstudio-md.md)] tenta descartar e recriar a tabela.</span><span class="sxs-lookup"><span data-stu-id="7d584-112">When schema changes are made in [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[ssManStudio](../../../includes/ssmanstudio-md.md)] attempts to drop and re-create the table.</span></span> <span data-ttu-id="7d584-113">Não é possível descartar objetos publicados; portanto, há falha na alteração de esquema.</span><span class="sxs-lookup"><span data-stu-id="7d584-113">You cannot drop published objects, therefore the schema change fails.</span></span>  
  
 <span data-ttu-id="7d584-114">Para replicação transacional e replicação de mesclagem, alterações de esquema são propagadas de forma incremental quando o Distribution Agent ou o Merge Agent são executados.</span><span class="sxs-lookup"><span data-stu-id="7d584-114">For transactional replication and merge replication, schema changes are propagated incrementally when the Distribution Agent or Merge Agent runs.</span></span> <span data-ttu-id="7d584-115">Para replicação de instantâneo, alterações de esquema são propagadas quando um instantâneo novo for aplicado ao Assinante.</span><span class="sxs-lookup"><span data-stu-id="7d584-115">For snapshot replication, schema changes are propagated when a new snapshot is applied at the Subscriber.</span></span> <span data-ttu-id="7d584-116">Em replicação de instantâneo, uma cópia nova do esquema é enviada ao Assinante a cada vez que ocorrer sincronização.</span><span class="sxs-lookup"><span data-stu-id="7d584-116">In snapshot replication, a new copy of the schema is sent to the Subscriber each time synchronization occurs.</span></span> <span data-ttu-id="7d584-117">Assim, todas as alterações de esquema (não apenas aquelas listadas acima) para objetos previamente publicados são propagadas automaticamente com cada sincronização.</span><span class="sxs-lookup"><span data-stu-id="7d584-117">Therefore, all schema changes (not just those listed above) to previously published objects are automatically propagated with each synchronization.</span></span>  
  
 <span data-ttu-id="7d584-118">Para obter informações sobre como adicionar e remover artigos de publicações, consulte [Adicionar e remover artigos de publicações existentes](add-articles-to-and-drop-articles-from-existing-publications.md).</span><span class="sxs-lookup"><span data-stu-id="7d584-118">For information about adding and removing articles from publications, see [Add Articles to and Drop Articles from Existing Publications](add-articles-to-and-drop-articles-from-existing-publications.md).</span></span>  
  
 <span data-ttu-id="7d584-119">**Para replicar alterações de esquema**</span><span class="sxs-lookup"><span data-stu-id="7d584-119">**To replicate schema changes**</span></span>  
  
 <span data-ttu-id="7d584-120">As alterações de esquema listadas acima são replicadas por padrão.</span><span class="sxs-lookup"><span data-stu-id="7d584-120">The schema changes listed above are replicated by default.</span></span> <span data-ttu-id="7d584-121">Para obter informações sobre como desabilitar a replicação de alterações de esquema, consulte [Replicate Schema Changes](replicate-schema-changes.md).</span><span class="sxs-lookup"><span data-stu-id="7d584-121">For information about disabling the replication of schema changes, see [Replicate Schema Changes](replicate-schema-changes.md).</span></span>  
  
## <a name="considerations-for-schema-changes"></a><span data-ttu-id="7d584-122">Considerações para alterações de esquema</span><span class="sxs-lookup"><span data-stu-id="7d584-122">Considerations for Schema Changes</span></span>  
 <span data-ttu-id="7d584-123">Lembre-se das seguintes considerações ao replicar alterações de esquema.</span><span class="sxs-lookup"><span data-stu-id="7d584-123">Keep the following considerations in mind when replicating schema changes.</span></span>  
  
### <a name="general-considerations"></a><span data-ttu-id="7d584-124">Considerações gerais</span><span class="sxs-lookup"><span data-stu-id="7d584-124">General Considerations</span></span>  
  
-   <span data-ttu-id="7d584-125">As alterações de esquema estão sujeitas a qualquer restrição imposta por [!INCLUDE[tsql](../../../includes/tsql-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7d584-125">Schema changes are subject to any restrictions imposed by [!INCLUDE[tsql](../../../includes/tsql-md.md)].</span></span> <span data-ttu-id="7d584-126">Por exemplo, ALTER TABLE não lhe permite ALTER colunas de chave primária.</span><span class="sxs-lookup"><span data-stu-id="7d584-126">For example, ALTER TABLE does not allow you to ALTER primary key columns.</span></span>  
  
-   <span data-ttu-id="7d584-127">O mapeamento de tipo de dados só é executado para o instantâneo inicial.</span><span class="sxs-lookup"><span data-stu-id="7d584-127">Data type mapping is performed only for the initial snapshot.</span></span> <span data-ttu-id="7d584-128">As alterações de esquema não são mapeadas para versões anteriores de tipos de dados.</span><span class="sxs-lookup"><span data-stu-id="7d584-128">Schema changes are not mapped to previous versions of data types.</span></span> <span data-ttu-id="7d584-129">Por exemplo, se a instrução `ALTER TABLE ADD datetime2 column` for usada no [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)], o tipo de dados não será convertido em `nvarchar` para Assinantes do [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7d584-129">For example, if the statement `ALTER TABLE ADD datetime2 column` is used in [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)], the data type is not translated to `nvarchar` for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] Subscribers.</span></span> <span data-ttu-id="7d584-130">Em alguns casos, as alterações de esquema são bloqueadas no Publicador.</span><span class="sxs-lookup"><span data-stu-id="7d584-130">In some cases, schema changes are blocked on the Publisher.</span></span>  
  
-   <span data-ttu-id="7d584-131">Se uma publicação é definida para permitir a propagação de alterações de esquema, alterações de esquema são propagadas independentemente de como a opção de esquema correspondente é definida para um artigo na publicação.</span><span class="sxs-lookup"><span data-stu-id="7d584-131">If a publication is set to allow the propagation of schema changes, schema changes are propagated regardless of how the related schema option is set for an article in the publication.</span></span> <span data-ttu-id="7d584-132">Por exemplo, se você selecionar não replicar restrições de chave estrangeira para um artigo de tabela, mas então emitir um comando ALTER TABLE que adiciona uma chave estrangeira à tabela no Publicador, a chave estrangeira será acrescentada à tabela no Assinante.</span><span class="sxs-lookup"><span data-stu-id="7d584-132">For example, if you select not to replicate foreign key constraints for a table article, but then issue an ALTER TABLE command that adds a foreign key to the table at the Publisher, the foreign key is added to the table at the Subscriber.</span></span> <span data-ttu-id="7d584-133">Para evitar isso, desabilite a propagação de alterações de esquema antes de emitir o comando ALTER TABLE.</span><span class="sxs-lookup"><span data-stu-id="7d584-133">To prevent this, disable the propagation of schema changes before issuing the ALTER TABLE command.</span></span>  
  
-   <span data-ttu-id="7d584-134">As alterações de esquema devem ser feitas somente no Publicador, não em Assinantes (inclusive Assinantes de republicação).</span><span class="sxs-lookup"><span data-stu-id="7d584-134">Schema changes should be made only at the Publisher, not at Subscribers (including republishing Subscribers).</span></span> <span data-ttu-id="7d584-135">Replicação de mesclagem evita alterações de esquema no Assinante.</span><span class="sxs-lookup"><span data-stu-id="7d584-135">Merge replication prevents schema changes at the Subscriber.</span></span> <span data-ttu-id="7d584-136">Replicação transacional não evita as alterações, mas as alterações podem levar à falha da replicação.</span><span class="sxs-lookup"><span data-stu-id="7d584-136">Transactional replication does not prevent the changes, but the changes can cause replication to fail.</span></span>  
  
-   <span data-ttu-id="7d584-137">Alterações propagadas para um Assinante de republicação são, por padrão, propagadas para seus Assinantes.</span><span class="sxs-lookup"><span data-stu-id="7d584-137">Changes propagated to a republishing Subscriber are by default propagated to its Subscribers.</span></span>  
  
-   <span data-ttu-id="7d584-138">Se a alteração de esquema faz referência a objetos ou restrições existentes no Publicador mas não no Assinante, a alteração de esquema tem êxito no Publicador mas não no Assinante.</span><span class="sxs-lookup"><span data-stu-id="7d584-138">If the schema change references objects or constraints existing on the Publisher but not on the Subscriber, the schema change will succeed on the Publisher but will fail on the Subscriber.</span></span>  
  
-   <span data-ttu-id="7d584-139">Todos os objetos no Assinante que são referenciados ao se adicionar uma chave estrangeira devem ter o mesmo nome e proprietário que o objeto correspondente no Publicador.</span><span class="sxs-lookup"><span data-stu-id="7d584-139">All objects on the Subscriber that are referenced when adding a foreign key must have the same name and owner as the corresponding object on the Publisher.</span></span>  
  
-   <span data-ttu-id="7d584-140">Não há suporte ao se adicionar, descartar ou alterar índices explicitamente.</span><span class="sxs-lookup"><span data-stu-id="7d584-140">Explicitly adding, dropping, or altering indexes is not supported.</span></span> <span data-ttu-id="7d584-141">Índices criados implicitamente para restrições (como uma restrição de chave primária) têm suporte.</span><span class="sxs-lookup"><span data-stu-id="7d584-141">Indexes created implicitly for constraints (such as a primary key constraint) are supported.</span></span>  
  
-   <span data-ttu-id="7d584-142">Não há suporte ao se alterar ou descartar colunas de identidade gerenciadas por replicação.</span><span class="sxs-lookup"><span data-stu-id="7d584-142">Altering or dropping identity columns that are managed by replication is not supported.</span></span> <span data-ttu-id="7d584-143">Para obter mais informações sobre o gerenciamento automático de colunas de identidade, consulte [Replicar colunas de identidade](replicate-identity-columns.md).</span><span class="sxs-lookup"><span data-stu-id="7d584-143">For more information about automatic management of identity columns, see [Replicate Identity Columns](replicate-identity-columns.md).</span></span>  
  
-   <span data-ttu-id="7d584-144">As alterações de esquema que incluem funções não determinísticas não têm suporte, pois podem resultar em dados diferentes no Publicador e no Assinante (o que é chamado de não convergência).</span><span class="sxs-lookup"><span data-stu-id="7d584-144">Schema changes that include nondeterministic functions are not supported because they can result in data at the Publisher and Subscriber being different (referred to as non-convergence).</span></span> <span data-ttu-id="7d584-145">Por exemplo, se você emitir o seguinte comando no Publicador: `ALTER TABLE SalesOrderDetail ADD OrderDate DATETIME DEFAULT GETDATE()`, os valores são diferentes quando o comando é replicado para o Assinante e executado.</span><span class="sxs-lookup"><span data-stu-id="7d584-145">For example, if you issue the following command at the Publisher: `ALTER TABLE SalesOrderDetail ADD OrderDate DATETIME DEFAULT GETDATE()`, the values are different when the command is replicated to the Subscriber and executed.</span></span> <span data-ttu-id="7d584-146">Para obter mais informações sobre funções não determinísticas, consulte [Deterministic and Nondeterministic Functions](../../user-defined-functions/deterministic-and-nondeterministic-functions.md).</span><span class="sxs-lookup"><span data-stu-id="7d584-146">For more information about nondeterministic functions, see [Deterministic and Nondeterministic Functions](../../user-defined-functions/deterministic-and-nondeterministic-functions.md).</span></span>  
  
-   <span data-ttu-id="7d584-147">Recomenda-se que restrições sejam nomeadas explicitamente.</span><span class="sxs-lookup"><span data-stu-id="7d584-147">It is recommended that constraints be explicitly named.</span></span> <span data-ttu-id="7d584-148">Se uma restrição não for nomeada explicitamente, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] gerará um nome para a restrição e esses nomes serão diferentes no Publicador e em cada Assinante.</span><span class="sxs-lookup"><span data-stu-id="7d584-148">If a constraint is not explicitly named, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] generates a name for the constraint, and these names will be different on the Publisher and each Subscriber.</span></span> <span data-ttu-id="7d584-149">Isso pode causar problemas durante a replicação de alterações de esquema.</span><span class="sxs-lookup"><span data-stu-id="7d584-149">This can cause issues during the replication of schema changes.</span></span> <span data-ttu-id="7d584-150">Por exemplo, se você descartar uma coluna no Publicador e uma restrição dependente for descartada, a replicação tentará descartar a restrição no Assinante.</span><span class="sxs-lookup"><span data-stu-id="7d584-150">For example, if you drop a column at the Publisher and a dependent constraint is dropped, replication will attempt to drop the constraint at the Subscriber.</span></span> <span data-ttu-id="7d584-151">O descarte no Assinante irá falhar porque o nome da restrição é diferente.</span><span class="sxs-lookup"><span data-stu-id="7d584-151">The drop at the Subscriber will fail because the name of the constraint is different.</span></span> <span data-ttu-id="7d584-152">Se a sincronização falhar devido a um problema de nomeação de restrição, descarte manualmente a restrição no Assinante e, então, execute novamente o Merge Agent.</span><span class="sxs-lookup"><span data-stu-id="7d584-152">If synchronization fails because of a constraint naming issue, manually drop the constraint at the Subscriber and then rerun the Merge Agent.</span></span>  
  
-   <span data-ttu-id="7d584-153">Se uma tabela é publicada para replicação, não é possível alterar uma coluna naquela tabela para um tipo de dados XML se um instantâneo de publicação já tiver sido gerado. Para alterar a coluna, você deve primeiramente remover a replicação.</span><span class="sxs-lookup"><span data-stu-id="7d584-153">If a table is published for replication, it is not possible to alter a column in that table to a data type of XML if a publication snapshot has already been generated To alter the column, you must first remove replication.</span></span>  
  
-   <span data-ttu-id="7d584-154">Leitura não confirmada não é um nível de isolamento com suporte ao fazer o DDL em uma tabela publicada.</span><span class="sxs-lookup"><span data-stu-id="7d584-154">Read uncommitted is not a supported isolation level when doing DDL on a published table.</span></span>  
  
-   <span data-ttu-id="7d584-155">`SET CONTEXT_INFO` não deve ser usado para modificar o contexto de transações em que as alterações de esquema são executadas em objetos publicados.</span><span class="sxs-lookup"><span data-stu-id="7d584-155">`SET CONTEXT_INFO` should not be used to modify the context of transactions where schema changes are performed against published objects.</span></span>  
  
#### <a name="adding-columns"></a><span data-ttu-id="7d584-156">Adicionando colunas</span><span class="sxs-lookup"><span data-stu-id="7d584-156">Adding Columns</span></span>  
  
-   <span data-ttu-id="7d584-157">Para adicionar uma nova coluna a uma tabela e incluir essa coluna em uma publicação existente, execute ALTER TABLE \<Table> ADD \<Column>.</span><span class="sxs-lookup"><span data-stu-id="7d584-157">To add a new column to a table and include that column in an existing publication, execute ALTER TABLE \<Table> ADD \<Column>.</span></span> <span data-ttu-id="7d584-158">Por padrão, a coluna é replicada para todos os Assinantes.</span><span class="sxs-lookup"><span data-stu-id="7d584-158">By default, the column is then replicated to all Subscribers.</span></span> <span data-ttu-id="7d584-159">A coluna deve permitir valores NULL ou incluir uma restrição padrão.</span><span class="sxs-lookup"><span data-stu-id="7d584-159">The column must allow NULL values or include a default constraint.</span></span> <span data-ttu-id="7d584-160">Para obter mais informações sobre como adicionar colunas, consulte a seção “Replicação de mesclagem” neste tópico.</span><span class="sxs-lookup"><span data-stu-id="7d584-160">For more information about adding columns, see the "Merge Replication" section in this topic.</span></span>  
  
-   <span data-ttu-id="7d584-161">Para adicionar uma nova coluna a uma tabela sem incluir essa coluna em uma publicação existente, desabilite a replicação de alterações de esquema e, em seguida, execute ALTER TABLE \<Table> ADD \<Column>.</span><span class="sxs-lookup"><span data-stu-id="7d584-161">To add a new column to a table and not include that column in an existing publication, disable the replication of schema changes, and then execute ALTER TABLE \<Table> ADD \<Column>.</span></span>  
  
-   <span data-ttu-id="7d584-162">Para incluir uma coluna existente em uma publicação existente, use [sp_articlecolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-articlecolumn-transact-sql), [sp_mergearticlecolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-mergearticlecolumn-transact-sql) ou a caixa de diálogo **Propriedades da Publicação – \<Publication>** .</span><span class="sxs-lookup"><span data-stu-id="7d584-162">To include an existing column in an existing publication, use [sp_articlecolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-articlecolumn-transact-sql), [sp_mergearticlecolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-mergearticlecolumn-transact-sql), or the **Publication Properties - \<Publication>** dialog box.</span></span>  
  
     <span data-ttu-id="7d584-163">Para obter mais informações, consulte [Definir e modificar um filtro de colunas](define-and-modify-a-column-filter.md).</span><span class="sxs-lookup"><span data-stu-id="7d584-163">For more information, see [Define and Modify a Column Filter](define-and-modify-a-column-filter.md).</span></span> <span data-ttu-id="7d584-164">Isso exigirá que as assinaturas sejam reinicializadas.</span><span class="sxs-lookup"><span data-stu-id="7d584-164">This will require subscriptions to be reinitialized.</span></span>  
  
-   <span data-ttu-id="7d584-165">Não há suporte para adicionar uma coluna de identidade a uma tabela publicada, pois isso pode resultar em não convergência quando a coluna é replicada no Assinante.</span><span class="sxs-lookup"><span data-stu-id="7d584-165">Adding an identity column to a published table is not supported, because it can result in non-convergence when the column is replicated to the Subscriber.</span></span> <span data-ttu-id="7d584-166">Os valores na coluna de identidade no Publicador dependerão da ordem em que as linhas para a tabela afetada forem armazenadas fisicamente.</span><span class="sxs-lookup"><span data-stu-id="7d584-166">The values in the identity column at the Publisher depend on the order in which the rows for the affected table are physically stored.</span></span> <span data-ttu-id="7d584-167">As linhas podem ser armazenadas de forma diversa no Assinante; assim, o valor da coluna de identidade pode ser diferente para as mesmas linhas.</span><span class="sxs-lookup"><span data-stu-id="7d584-167">The rows might be stored differently at the Subscriber; therefore the value for the identity column can be different for the same rows.</span></span>  
  
#### <a name="dropping-columns"></a><span data-ttu-id="7d584-168">Descartando colunas</span><span class="sxs-lookup"><span data-stu-id="7d584-168">Dropping Columns</span></span>  
  
-   <span data-ttu-id="7d584-169">Para remover uma coluna de uma publicação existente e remover a coluna da tabela no Publicador, execute ALTER TABLE \<Table> DROP \<Column>.</span><span class="sxs-lookup"><span data-stu-id="7d584-169">To drop a column from an existing publication and drop the column from the table at the Publisher, execute ALTER TABLE \<Table> DROP \<Column>.</span></span> <span data-ttu-id="7d584-170">Por padrão, a coluna é então descartada da tabela em todos os Assinantes.</span><span class="sxs-lookup"><span data-stu-id="7d584-170">By default, the column is then dropped from the table at all Subscribers.</span></span>  
  
-   <span data-ttu-id="7d584-171">Para remover uma coluna de uma publicação existente, mas manter a coluna na tabela no Publicador, use [sp_articlecolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-articlecolumn-transact-sql), [sp_mergearticlecolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-mergearticlecolumn-transact-sql) ou a caixa de diálogo **Propriedades da Publicação – \<Publication>** .</span><span class="sxs-lookup"><span data-stu-id="7d584-171">To drop a column from an existing publication but retain the column in the table at the Publisher, use [sp_articlecolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-articlecolumn-transact-sql), [sp_mergearticlecolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-mergearticlecolumn-transact-sql), or the **Publication Properties - \<Publication>** dialog box.</span></span>  
  
     <span data-ttu-id="7d584-172">Para obter mais informações, consulte [Definir e modificar um filtro de colunas](define-and-modify-a-column-filter.md).</span><span class="sxs-lookup"><span data-stu-id="7d584-172">For more information, see [Define and Modify a Column Filter](define-and-modify-a-column-filter.md).</span></span> <span data-ttu-id="7d584-173">Isso exigirá a geração de um instantâneo novo.</span><span class="sxs-lookup"><span data-stu-id="7d584-173">This will require a new snapshot to be generated.</span></span>  
  
-   <span data-ttu-id="7d584-174">A coluna a ser descartada não pode ser usada nas cláusulas de filtro de nenhum artigo de nenhuma publicação no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="7d584-174">The column to be dropped cannot be used in the filter clauses of any article of any publication in the database.</span></span>  
  
-   <span data-ttu-id="7d584-175">Ao descartar uma coluna de um artigo publicado, considere quaisquer restrições, índices ou propriedades da coluna que possam afetar o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="7d584-175">When dropping a column from a published article, take into consideration any constraints, indexes, or properties of the column that could affect the database.</span></span> <span data-ttu-id="7d584-176">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="7d584-176">For example:</span></span>  
  
    -   <span data-ttu-id="7d584-177">Não é possível descartar colunas usadas em uma chave primária de artigos em publicações transacionais, uma vez que elas são usadas pela replicação.</span><span class="sxs-lookup"><span data-stu-id="7d584-177">You cannot drop columns used in a primary key from articles in transactional publications, because they are used by replication.</span></span>  
  
    -   <span data-ttu-id="7d584-178">Não é possível descartar a coluna rowguid de artigos em publicações de mesclagem ou a coluna mstran_repl_version de artigos em publicações transacionais que suportam assinaturas de atualização, uma vez que elas são usadas pela replicação.</span><span class="sxs-lookup"><span data-stu-id="7d584-178">You cannot drop the rowguid column from articles in merge publications or the mstran_repl_version column from articles in transactional publications that support updating subscriptions, because they are used by replication.</span></span>  
  
    -   <span data-ttu-id="7d584-179">As alterações de índices não são propagadas para Assinantes: se você descartar uma coluna no Publicador e um índice dependente for descartado, o índice descartado não será replicado.</span><span class="sxs-lookup"><span data-stu-id="7d584-179">Index changes are not propagated to Subscribers: if you drop a column at the Publisher and a dependent index is dropped, the index drop is not replicated.</span></span> <span data-ttu-id="7d584-180">Deve-se descartar o índice no Assinante antes de descartar as colunas no Publicador, de forma que o descarte da coluna tenha êxito quando for replicado do Publicador para o Assinante.</span><span class="sxs-lookup"><span data-stu-id="7d584-180">You should drop the index at the Subscriber before dropping the column at the Publisher, so that the column drop succeeds when it is replicated from the Publisher to the Subscriber.</span></span> <span data-ttu-id="7d584-181">Se a sincronização falhar devido a um índice no Assinante, descarte manualmente o índice e, então, execute novamente o Merge Agent.</span><span class="sxs-lookup"><span data-stu-id="7d584-181">If synchronization fails because of an index at the Subscriber, manually drop the index and then rerun the Merge Agent.</span></span>  
  
    -   <span data-ttu-id="7d584-182">Restrições devem ser explicitamente nomeadas para permitir que sejam descartadas.</span><span class="sxs-lookup"><span data-stu-id="7d584-182">Constraints should be explicitly named to allow for dropping.</span></span> <span data-ttu-id="7d584-183">Para obter mais informações, consulte a seção "Considerações gerais" anteriormente neste tópico.</span><span class="sxs-lookup"><span data-stu-id="7d584-183">For more information, see the "General Considerations" section earlier in this topic.</span></span>  
  
### <a name="transactional-replication"></a><span data-ttu-id="7d584-184">Replicação transacional</span><span class="sxs-lookup"><span data-stu-id="7d584-184">Transactional Replication</span></span>  
  
-   <span data-ttu-id="7d584-185">As alterações de esquema são propagadas para Assinantes que estão executando versões anteriores de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], mas a instrução DDL deverá incluir apenas sintaxe que tenha suporte da versão do Assinante.</span><span class="sxs-lookup"><span data-stu-id="7d584-185">Schema changes are propagated to Subscribers running previous versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], but the DDL statement should only include syntax supported by the version at the Subscriber.</span></span>  
  
     <span data-ttu-id="7d584-186">Se o Assinante republicar dados, as únicas alterações de esquema com suporte incluem adicionar e descartar uma coluna.</span><span class="sxs-lookup"><span data-stu-id="7d584-186">If the Subscriber republishes data, the only supported schema changes are adding and dropping a column.</span></span> <span data-ttu-id="7d584-187">Essas alterações devem ser feitas no Publicador usando [sp_repladdcolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-repladdcolumn-transact-sql) e [sp_repldropcolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-repldropcolumn-transact-sql) em vez da sintaxe ALTER TABLE DDL.</span><span class="sxs-lookup"><span data-stu-id="7d584-187">These changes should be made on the Publisher using [sp_repladdcolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-repladdcolumn-transact-sql) and [sp_repldropcolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-repldropcolumn-transact-sql) rather than ALTER TABLE DDL syntax.</span></span>  
  
-   <span data-ttu-id="7d584-188">Não são replicadas alterações de esquema a Assinantes de não SQL Server.</span><span class="sxs-lookup"><span data-stu-id="7d584-188">Schema changes are not replicated to non-SQL Server Subscribers.</span></span>  
  
-   <span data-ttu-id="7d584-189">As alterações de esquema não são propagadas de Publicadores não[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="7d584-189">Schema changes are not propagated from non-[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Publishers.</span></span>  
  
-   <span data-ttu-id="7d584-190">Não é possível alterar exibições indexadas que são replicadas como tabelas.</span><span class="sxs-lookup"><span data-stu-id="7d584-190">You cannot alter indexed views that are replicated as tables.</span></span> <span data-ttu-id="7d584-191">Exibições indexadas que são replicadas como exibições indexadas podem ser alteradas, mas sua alteração irá fazer com que sejam exibições regulares e não exibições indexadas.</span><span class="sxs-lookup"><span data-stu-id="7d584-191">Indexed views that are replicated as indexed views can be altered, but altering them will cause them to become regular views, rather than indexed views.</span></span>  
  
-   <span data-ttu-id="7d584-192">Se a publicação oferecer suporte à atualização imediata ou a assinaturas de atualização enfileirada, o sistema deverá ser confirmado antes que sejam feitas alterações de esquema: toda atividade na tabela publicada deve ser interrompida no Publicador e nos Assinantes, e as alterações de dados pendentes deverão ser propagadas para todos os nós.</span><span class="sxs-lookup"><span data-stu-id="7d584-192">If the publication supports immediate updating or queued updating subscriptions, the system must be quiesced before making schema changes: all activity on the published table must be stopped at the Publisher and Subscribers, and pending data changes must be propagated to all nodes.</span></span> <span data-ttu-id="7d584-193">Depois que as alterações de esquema tenham se propagado para todos os nós, a atividade pode ser retomada nas tabelas publicadas.</span><span class="sxs-lookup"><span data-stu-id="7d584-193">After the schema changes have propagated to all nodes, activity can resume on the published tables.</span></span>  
  
-   <span data-ttu-id="7d584-194">Se a publicação estiver em uma topologia ponto a ponto, o sistema deve ser confirmado antes que sejam feitas alterações de esquema.</span><span class="sxs-lookup"><span data-stu-id="7d584-194">If the publication is in a peer-to-peer topology, the system must be quiesced before making schema changes.</span></span> <span data-ttu-id="7d584-195">Para obter mais informações, consulte [Como confirmar uma topologia de replicação &#40;Programação Transact-SQL de replicação&#41;](../administration/quiesce-a-replication-topology-replication-transact-sql-programming.md).</span><span class="sxs-lookup"><span data-stu-id="7d584-195">For more information, see [Quiesce a Replication Topology &#40;Replication Transact-SQL Programming&#41;](../administration/quiesce-a-replication-topology-replication-transact-sql-programming.md).</span></span>  
  
-   <span data-ttu-id="7d584-196">O adição de uma coluna de carimbo e o mapeamento do carimbo para binário(8) levam o artigo a ser reinicializado para todas as assinaturas ativas.</span><span class="sxs-lookup"><span data-stu-id="7d584-196">Adding a timestamp column to a table and mapping the timestamp to binary(8) causes the article to be reinitialized for all active subscriptions.</span></span>  
  
### <a name="merge-replication"></a><span data-ttu-id="7d584-197">Replicação de mesclagem</span><span class="sxs-lookup"><span data-stu-id="7d584-197">Merge Replication</span></span>  
  
-   <span data-ttu-id="7d584-198">A maneira como a replicação de mesclagem trata alterações de esquema é determinada pelo nível de compatibilidade da publicação e pela definição do instantâneo como modo nativo (padrão) ou modo de caractere:</span><span class="sxs-lookup"><span data-stu-id="7d584-198">How merge replication handles schema changes is determined by the publication compatibility level, and whether the snapshot is set to native mode (default) or character mode:</span></span>  
  
    -   <span data-ttu-id="7d584-199">Para replicar alterações de esquema, o nível de compatibilidade da publicação deve ser pelo menos 90RTM.</span><span class="sxs-lookup"><span data-stu-id="7d584-199">To replicate schema changes, the compatibility level of the publication must be at least 90RTM.</span></span> <span data-ttu-id="7d584-200">Se os Assinantes estiverem executando versões anteriores do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ou o nível de compatibilidade for inferior a 90RTM, você poderá usar [sp_repladdcolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-repladdcolumn-transact-sql) e [sp_repldropcolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-repldropcolumn-transact-sql) para adicionar e remover colunas.</span><span class="sxs-lookup"><span data-stu-id="7d584-200">If Subscribers are running previous versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] or the compatibility level is less than 90RTM you can use [sp_repladdcolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-repladdcolumn-transact-sql) and [sp_repldropcolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-repldropcolumn-transact-sql) to add and drop columns.</span></span> <span data-ttu-id="7d584-201">Porém, estes procedimentos não são recomendados.</span><span class="sxs-lookup"><span data-stu-id="7d584-201">However, these procedures are deprecated.</span></span>  
  
    -   <span data-ttu-id="7d584-202">Se você tentar adicionar a um artigo existente uma coluna com um tipo de dados que foi lançado no [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)], o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] terá o seguinte comportamento:</span><span class="sxs-lookup"><span data-stu-id="7d584-202">If you try to add to an existing article a column with a data type that was introduced in [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)], [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] has the following behavior:</span></span>  
  
        ||<span data-ttu-id="7d584-203">100RTM, instantâneo nativo</span><span class="sxs-lookup"><span data-stu-id="7d584-203">100RTM, native snapshot</span></span>|<span data-ttu-id="7d584-204">100RTM, instantâneo de caractere</span><span class="sxs-lookup"><span data-stu-id="7d584-204">100RTM, character snapshot</span></span>|<span data-ttu-id="7d584-205">Todos os outros níveis de compatibilidade</span><span class="sxs-lookup"><span data-stu-id="7d584-205">All other compatibility levels</span></span>|  
        |-|-----------------------------|--------------------------------|------------------------------------|  
        |`hierarchyid`|<span data-ttu-id="7d584-206">Permitir alteração</span><span class="sxs-lookup"><span data-stu-id="7d584-206">Allow change</span></span>|<span data-ttu-id="7d584-207">Bloquear alteração</span><span class="sxs-lookup"><span data-stu-id="7d584-207">Block change</span></span>|<span data-ttu-id="7d584-208">Bloquear alteração</span><span class="sxs-lookup"><span data-stu-id="7d584-208">Block change</span></span>|  
        |<span data-ttu-id="7d584-209">`geography` e `geometry`</span><span class="sxs-lookup"><span data-stu-id="7d584-209">`geography` and `geometry`</span></span>|<span data-ttu-id="7d584-210">Permitir alteração</span><span class="sxs-lookup"><span data-stu-id="7d584-210">Allow change</span></span>|<span data-ttu-id="7d584-211">Permitir alteração<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="7d584-211">Allow change<sup>1</sup></span></span>|<span data-ttu-id="7d584-212">Bloquear alteração</span><span class="sxs-lookup"><span data-stu-id="7d584-212">Block change</span></span>|  
        |`filestream`|<span data-ttu-id="7d584-213">Permitir alteração</span><span class="sxs-lookup"><span data-stu-id="7d584-213">Allow change</span></span>|<span data-ttu-id="7d584-214">Bloquear alteração</span><span class="sxs-lookup"><span data-stu-id="7d584-214">Block change</span></span>|<span data-ttu-id="7d584-215">Bloquear alteração</span><span class="sxs-lookup"><span data-stu-id="7d584-215">Block change</span></span>|  
        |<span data-ttu-id="7d584-216">`date`, `time`, `datetime2` e `datetimeoffset`</span><span class="sxs-lookup"><span data-stu-id="7d584-216">`date`, `time`, `datetime2`, and `datetimeoffset`</span></span>|<span data-ttu-id="7d584-217">Permitir alteração</span><span class="sxs-lookup"><span data-stu-id="7d584-217">Allow change</span></span>|<span data-ttu-id="7d584-218">Permitir alteração<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="7d584-218">Allow change<sup>1</sup></span></span>|<span data-ttu-id="7d584-219">Bloquear alteração</span><span class="sxs-lookup"><span data-stu-id="7d584-219">Block change</span></span>|  
  
         <span data-ttu-id="7d584-220"><sup>1</sup> os assinantes do SQL Server Compact convertem esses tipos de dados no Assinante.</span><span class="sxs-lookup"><span data-stu-id="7d584-220"><sup>1</sup> SQL Server Compact Subscribers convert these data types at the Subscriber.</span></span>  
  
-   <span data-ttu-id="7d584-221">Se um erro ocorrer ao ser aplicada uma alteração de esquema (como um erro resultante da adição de uma chave estrangeira que faz referência a uma tabela não disponível no Assinante), a sincronização falhará e a assinatura deverá ser reinicializada.</span><span class="sxs-lookup"><span data-stu-id="7d584-221">If an error occurs when applying a schema change (such as an error resulting from adding a foreign key that references a table not available at the Subscriber), synchronization fails and the subscription must be reinitialized.</span></span>  
  
-   <span data-ttu-id="7d584-222">Se uma alteração de esquema for feita em uma coluna envolvida em um filtro de junção ou filtro com parâmetros, deve reinicializar-se todas as assinaturas e gerar novamente o instantâneo.</span><span class="sxs-lookup"><span data-stu-id="7d584-222">If a schema change is made on a column involved in a join filter or parameterized filter, you must reinitialize all subscriptions and regenerate the snapshot.</span></span>  
  
-   <span data-ttu-id="7d584-223">A replicação de mesclagem leva os procedimentos armazenados a ignorar alterações de esquema durante a solução de problemas.</span><span class="sxs-lookup"><span data-stu-id="7d584-223">Merge replication provides stored procedures to skip schema changes during troubleshooting.</span></span> <span data-ttu-id="7d584-224">Para obter mais informações, consulte [sp_markpendingschemachange &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-markpendingschemachange-transact-sql) e [sp_enumeratependingschemachanges &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumeratependingschemachanges-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="7d584-224">For more information, see [sp_markpendingschemachange &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-markpendingschemachange-transact-sql) and [sp_enumeratependingschemachanges &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumeratependingschemachanges-transact-sql).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="7d584-225">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="7d584-225">See Also</span></span>  
 <span data-ttu-id="7d584-226">[ALTER TABLE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-table-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="7d584-226">[ALTER TABLE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-table-transact-sql) </span></span>  
 <span data-ttu-id="7d584-227">[ALTER VIEW &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-view-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="7d584-227">[ALTER VIEW &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-view-transact-sql) </span></span>  
 <span data-ttu-id="7d584-228">[ALTER PROCEDURE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-procedure-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="7d584-228">[ALTER PROCEDURE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-procedure-transact-sql) </span></span>  
 <span data-ttu-id="7d584-229">[ALTER FUNCTION &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-function-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="7d584-229">[ALTER FUNCTION &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-function-transact-sql) </span></span>  
 <span data-ttu-id="7d584-230">[ALTER TRIGGER &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-trigger-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="7d584-230">[ALTER TRIGGER &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-trigger-transact-sql) </span></span>  
 <span data-ttu-id="7d584-231">[Publicar dados e objetos de banco de dados](publish-data-and-database-objects.md) </span><span class="sxs-lookup"><span data-stu-id="7d584-231">[Publish Data and Database Objects](publish-data-and-database-objects.md) </span></span>  
 [<span data-ttu-id="7d584-232">Regenerar os procedimentos transacionais personalizados para refletir alterações de esquema</span><span class="sxs-lookup"><span data-stu-id="7d584-232">Regenerate Custom Transactional Procedures to Reflect Schema Changes</span></span>](../transactional/transactional-articles-regenerate-to-reflect-schema-changes.md)  
  
  
