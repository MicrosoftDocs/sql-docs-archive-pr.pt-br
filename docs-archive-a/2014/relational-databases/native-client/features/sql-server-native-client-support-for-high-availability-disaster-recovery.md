---
title: Suporte SQL Server Native Client para alta disponibilidade e recuperação de desastre | Microsoft Docs
ms.custom: ''
ms.date: 08/31/2016
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
ms.assetid: 2b06186b-4090-4728-b96b-90d6ebd9f66f
author: rothja
ms.author: jroth
ms.openlocfilehash: 43c835d5c0e1c064387aee7fb0db65f577c3aa26
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87582426"
---
# <a name="sql-server-native-client-support-for-high-availability-disaster-recovery"></a><span data-ttu-id="a47a4-102">Suporte do SQL Server Native Client à alta disponibilidade e recuperação de desastre</span><span class="sxs-lookup"><span data-stu-id="a47a4-102">SQL Server Native Client Support for High Availability, Disaster Recovery</span></span>
  <span data-ttu-id="a47a4-103">Este tópico discute o suporte do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client (adicionado no [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)]) para [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a47a4-103">This topic discusses [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client support (added in [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)]) for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span></span> <span data-ttu-id="a47a4-104">Para obter mais informações sobre [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], consulte [Ouvintes do Grupo de Disponibilidade, Conectividade do Cliente e Failover do Aplicativo &#40;SQL Server&#41;](../../../database-engine/listeners-client-connectivity-application-failover.md), [Criação e Configuração de Grupos de Disponibilidade &#40;SQL Server&#41;](../../../database-engine/availability-groups/windows/creation-and-configuration-of-availability-groups-sql-server.md), [Clustering de Failover e Grupos de Disponibilidade AlwaysOn &#40;SQL Server&#41;](../../../database-engine/availability-groups/windows/failover-clustering-and-always-on-availability-groups-sql-server.md) e [Secundárias Ativas: Réplicas Secundárias Legíveis (Grupos de Disponibilidade AlwaysOn)](../../../database-engine/availability-groups/windows/active-secondaries-readable-secondary-replicas-always-on-availability-groups.md).</span><span class="sxs-lookup"><span data-stu-id="a47a4-104">For more information about [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], see [Availability Group Listeners, Client Connectivity, and Application Failover &#40;SQL Server&#41;](../../../database-engine/listeners-client-connectivity-application-failover.md), [Creation and Configuration of Availability Groups &#40;SQL Server&#41;](../../../database-engine/availability-groups/windows/creation-and-configuration-of-availability-groups-sql-server.md), [Failover Clustering and AlwaysOn Availability Groups &#40;SQL Server&#41;](../../../database-engine/availability-groups/windows/failover-clustering-and-always-on-availability-groups-sql-server.md), and [Active Secondaries: Readable Secondary Replicas (AlwaysOn Availability Groups)](../../../database-engine/availability-groups/windows/active-secondaries-readable-secondary-replicas-always-on-availability-groups.md).</span></span>  
  
 <span data-ttu-id="a47a4-105">Você pode especificar o ouvinte de um determinado grupo de disponibilidade na cadeia de conexão.</span><span class="sxs-lookup"><span data-stu-id="a47a4-105">You can specify the availability group listener of a given availability group in the connection string.</span></span> <span data-ttu-id="a47a4-106">Se um aplicativo do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client estiver conectado a um banco de dados em um grupo de disponibilidade que executa failover, a conexão original será interrompida e o aplicativo deverá abrir uma nova conexão para continuar o trabalho após o failover.</span><span class="sxs-lookup"><span data-stu-id="a47a4-106">If a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client application is connected to a database in an availability group that fails over, the original connection is broken, and the application must open a new connection to continue work after the failover.</span></span>  
  
 <span data-ttu-id="a47a4-107">Se você não estiver se conectando a um ouvinte de grupo de disponibilidade, e se vários endereços IP forem associados com um nome de host, o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client irá iterar em sequência por todos os endereços IP associados à entrada DNS.</span><span class="sxs-lookup"><span data-stu-id="a47a4-107">If you are not connecting to an availability group listener, and if multiple IP addresses are associated with a hostname, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client will iterate sequentially through all IP addresses associated with DNS entry.</span></span> <span data-ttu-id="a47a4-108">Isso pode demorar muito se o primeiro endereço IP retornado pelo servidor DNS não estiver associado a nenhuma NIC (placa de interface de rede).</span><span class="sxs-lookup"><span data-stu-id="a47a4-108">This can be time consuming if the first IP address returned by DNS server is not bound to any network interface card (NIC).</span></span> <span data-ttu-id="a47a4-109">Ao se conectar a um ouvinte de grupo de disponibilidade, o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client tenta estabelecer conexões com todos os endereços IP em paralelo e, se uma tentativa de conexão for bem-sucedida, o driver descartará as tentativas de conexão pendentes.</span><span class="sxs-lookup"><span data-stu-id="a47a4-109">When connecting to an availability group listener, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client attempts to establish connections to all IP addresses in parallel and if a connection attempt succeeds, the driver will discard any pending connection attempts.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="a47a4-110">O aumento do tempo limite de conexão e a implementação de lógica de repetição de conexão aumentarão a probabilidade de um aplicativo se conectar a um grupo de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="a47a4-110">Increasing connection timeout and implementing connection retry logic will increase the probability that an application will connect to an availability group.</span></span> <span data-ttu-id="a47a4-111">Além disso, como uma conexão pode falhar devido a um failover de grupo de disponibilidade, você deve implementar lógica de repetição de conexão, repetindo uma conexão com falha até se reconectar.</span><span class="sxs-lookup"><span data-stu-id="a47a4-111">Also, because a connection can fail because of an availability group failover, you should implement connection retry logic, retrying a failed connection until it reconnects.</span></span>  
  
## <a name="connecting-with-multisubnetfailover"></a><span data-ttu-id="a47a4-112">Conectando-se ao MultiSubnetFailover</span><span class="sxs-lookup"><span data-stu-id="a47a4-112">Connecting With MultiSubnetFailover</span></span>  
 <span data-ttu-id="a47a4-113">Sempre especifique `MultiSubnetFailover=Yes` quando for se conectar a um ouvinte de grupo de disponibilidade do SQL Server 2012 ou uma instância de cluster de failover do SQL Server 2012.</span><span class="sxs-lookup"><span data-stu-id="a47a4-113">Always specify `MultiSubnetFailover=Yes` when connecting to a SQL Server 2012 availability group listener or SQL Server 2012 Failover Cluster Instance.</span></span> <span data-ttu-id="a47a4-114">`MultiSubnetFailover` permite o failover mais rápido para todos os grupos de disponibilidade e as instâncias de cluster de failover do SQL Server 2012, e reduz significativamente o tempo de failover para topologias AlwaysOn de uma ou várias sub-redes.</span><span class="sxs-lookup"><span data-stu-id="a47a4-114">`MultiSubnetFailover` enables faster failover for all Availability Groups and failover cluster instance in SQL Server 2012 and will significantly reduce failover time for single and multi-subnet AlwaysOn topologies.</span></span> <span data-ttu-id="a47a4-115">Durante um failover de várias sub-redes, o cliente tentará conexões em paralelo.</span><span class="sxs-lookup"><span data-stu-id="a47a4-115">During a multi-subnet failover, the client will attempt connections in parallel.</span></span> <span data-ttu-id="a47a4-116">Durante um failover de sub-rede, o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client tentará novamente a conexão TCP de forma agressiva.</span><span class="sxs-lookup"><span data-stu-id="a47a4-116">During a subnet failover, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client will aggressively retry the TCP connection.</span></span>  
  
 <span data-ttu-id="a47a4-117">A propriedade de conexão `MultiSubnetFailover` indica que o aplicativo está sendo implantado em um grupo de disponibilidade ou instância de cluster de failover e que o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client tentará se conectar ao banco de dados na instância primária do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] tentando se conectar a todos os endereços IP do grupo de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="a47a4-117">The `MultiSubnetFailover` connection property indicates that the application is being deployed in an availability group or Failover Cluster Instance, and that [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client will try to connect to the database on the primary [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance by trying to connect to all the IP addresses.</span></span> <span data-ttu-id="a47a4-118">Quando `MultiSubnetFailover=Yes` é especificado para uma conexão, o cliente tenta novamente as tentativas de conexão TCP mais rápido do que os intervalos de retransmissão TCP padrão do sistema operacional.</span><span class="sxs-lookup"><span data-stu-id="a47a4-118">When `MultiSubnetFailover=Yes` is specified for a connection, the client retries TCP connection attempts faster than the operating system's default TCP retransmit intervals.</span></span> <span data-ttu-id="a47a4-119">Isto permite uma reconexão mais rápida depois de failover de um Grupo de disponibilidade AlwaysOn ou uma Instância de Cluster de Failover AlwaysOn e é aplicável a Grupos de disponibilidade único e de várias sub-redes e Instâncias de Cluster de Failover.</span><span class="sxs-lookup"><span data-stu-id="a47a4-119">This enables faster reconnection after failover of either an AlwaysOn Availability Group or an AlwaysOn Failover Cluster Instance, and is applicable to both single- and multi-subnet Availability Groups and Failover Cluster Instances.</span></span>  
  
 <span data-ttu-id="a47a4-120">Para obter mais informações sobre palavras-chave de cadeia de conexão, consulte [Usando palavras-chave da cadeia de conexão com o SQL Server Native Client](../applications/using-connection-string-keywords-with-sql-server-native-client.md).</span><span class="sxs-lookup"><span data-stu-id="a47a4-120">For more information about connection string keywords, see [Using Connection String Keywords with SQL Server Native Client](../applications/using-connection-string-keywords-with-sql-server-native-client.md).</span></span>  
  
 <span data-ttu-id="a47a4-121">Especificar `MultiSubnetFailover=Yes` ao conectar-se a algo que não seja um ouvinte de grupo de disponibilidade ou uma Instância de Cluster de Failover pode resultar em um impacto de desempenho negativo, para o qual não há suporte.</span><span class="sxs-lookup"><span data-stu-id="a47a4-121">Specifying `MultiSubnetFailover=Yes` when connecting to something other than an availability group listener or Failover Cluster Instance may result in a negative performance impact, and is not supported.</span></span>  
  
 <span data-ttu-id="a47a4-122">Use as diretrizes a seguir para conectar-se a um servidor em um grupo de disponibilidade ou Instância de Cluster de Failover:</span><span class="sxs-lookup"><span data-stu-id="a47a4-122">Use the following guidelines to connect to a server in an availability group or Failover Cluster Instance:</span></span>  
  
-   <span data-ttu-id="a47a4-123">Use a propriedade de conexão `MultiSubnetFailover` para conectar-se a uma ou várias sub-redes; isso melhorará o desempenho de ambos.</span><span class="sxs-lookup"><span data-stu-id="a47a4-123">Use the `MultiSubnetFailover` connection property when connecting to a single subnet or multi-subnet; it will improve performance for both.</span></span>  
  
-   <span data-ttu-id="a47a4-124">Para conectar-se a um grupo de disponibilidade, especifique o ouvinte do grupo de disponibilidade como o servidor em sua cadeia de conexão.</span><span class="sxs-lookup"><span data-stu-id="a47a4-124">To connect to an availability group, specify the availability group listener of the availability group as the server in your connection string.</span></span>  
  
-   <span data-ttu-id="a47a4-125">Conectar-se a uma instância do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] configurada com mais de 64 endereços IP causará uma falha de conexão.</span><span class="sxs-lookup"><span data-stu-id="a47a4-125">Connecting to a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance configured with more than 64 IP addresses will cause a connection failure.</span></span>  
  
-   <span data-ttu-id="a47a4-126">O comportamento de um aplicativo que usa a propriedade de conexão `MultiSubnetFailover` não é afetado com base no tipo de autenticação: Autenticação do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], Autenticação Kerberos ou Autenticação do Windows.</span><span class="sxs-lookup"><span data-stu-id="a47a4-126">Behavior of an application that uses the `MultiSubnetFailover` connection property is not affected based on the type of authentication: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication, Kerberos Authentication, or Windows Authentication.</span></span>  
  
-   <span data-ttu-id="a47a4-127">Você pode aumentar o valor de `loginTimeout` para acomodar o tempo de failover e reduzir as tentativas de repetição de conexão do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="a47a4-127">You can increase the value of `loginTimeout` to accommodate for failover time and reduce application connection retry attempts.</span></span>  
  
-   <span data-ttu-id="a47a4-128">Não há suporte para transações distribuídas.</span><span class="sxs-lookup"><span data-stu-id="a47a4-128">Distributed transactions are not supported.</span></span>  
  
 <span data-ttu-id="a47a4-129">Se o roteamento somente leitura não estiver em ação, conectar-se a um local de réplica secundária em um grupo de disponibilidade apresentará falha nas seguintes situações:</span><span class="sxs-lookup"><span data-stu-id="a47a4-129">If read-only routing is not in effect, connecting to a secondary replica location in an availability group will fail in the following situations:</span></span>  
  
1.  <span data-ttu-id="a47a4-130">Se o local de réplica secundário não for configurado para aceitar conexões.</span><span class="sxs-lookup"><span data-stu-id="a47a4-130">If the secondary replica location is not configured to accept connections.</span></span>  
  
2.  <span data-ttu-id="a47a4-131">Se um aplicativo usar `ApplicationIntent=ReadWrite` (abordado abaixo) e o local da réplica secundária estiver configurado para acesso somente leitura.</span><span class="sxs-lookup"><span data-stu-id="a47a4-131">If an application uses `ApplicationIntent=ReadWrite` (discussed below) and the secondary replica location is configured for read-only access.</span></span>  
  
 <span data-ttu-id="a47a4-132">Uma conexão falhará se uma réplica primária estiver configurada para rejeitar cargas de trabalho somente leitura e a cadeia de conexão contiver `ApplicationIntent=ReadOnly`.</span><span class="sxs-lookup"><span data-stu-id="a47a4-132">A connection will fail if a primary replica is configured to reject read-only workloads and the connection string contains `ApplicationIntent=ReadOnly`.</span></span>  
  
## <a name="upgrading-to-use-multi-subnet-clusters-from-database-mirroring"></a><span data-ttu-id="a47a4-133">Atualizando para usar clusters de várias sub-redes a partir do espelhamento de banco de dados</span><span class="sxs-lookup"><span data-stu-id="a47a4-133">Upgrading to Use Multi-Subnet Clusters from Database Mirroring</span></span>  
 <span data-ttu-id="a47a4-134">Um erro de conexão ocorrerá se as palavras-chave de conexão `MultiSubnetFailover` e `Failover_Partner` estiverem presentes na cadeia de conexão.</span><span class="sxs-lookup"><span data-stu-id="a47a4-134">A connection error will occur if the `MultiSubnetFailover` and `Failover_Partner` connection keywords are present in the connection string.</span></span> <span data-ttu-id="a47a4-135">Um erro também ocorrerá se a palavra-chave `MultiSubnetFailover` for usada e o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] retornar uma resposta de parceiro de failover indicando que ela faz parte de um par de espelhamento de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="a47a4-135">An error will also occur if `MultiSubnetFailover` is used and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] returns a failover partner response indicating it is part of a database mirroring pair.</span></span>  
  
 <span data-ttu-id="a47a4-136">Se você atualizar um aplicativo [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client que atualmente usa o espelhamento de banco de dados em um cenário de várias sub-redes, deverá remover a propriedade de conexão `Failover_Partner` e substituí-la por `MultiSubnetFailover` definido como `Yes` e substituir o nome do servidor da cadeia de conexão por um ouvinte de grupo de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="a47a4-136">If you upgrade a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client application that currently uses database mirroring to a multi-subnet scenario, you should remove the `Failover_Partner` connection property and replace it with `MultiSubnetFailover` set to `Yes` and replace the server name in the connection string with an availability group listener.</span></span> <span data-ttu-id="a47a4-137">Se a cadeia de conexão usar `Failover_Partner` e `MultiSubnetFailover=Yes`, o driver gerará um erro.</span><span class="sxs-lookup"><span data-stu-id="a47a4-137">If a connection string uses `Failover_Partner` and `MultiSubnetFailover=Yes`, the driver will generate an error.</span></span> <span data-ttu-id="a47a4-138">No entanto, se uma cadeia de conexão usar `Failover_Partner` e `MultiSubnetFailover=No` (ou `ApplicationIntent=ReadWrite`), o aplicativo usará o espelhamento de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="a47a4-138">However, if a connection string uses `Failover_Partner` and `MultiSubnetFailover=No` (or `ApplicationIntent=ReadWrite`), the application will use database mirroring.</span></span>  
  
 <span data-ttu-id="a47a4-139">O driver retornará um erro se o espelhamento de banco de dados for usado no banco de dados primário no grupo de disponibilidade e se `MultiSubnetFailover=Yes` for usado na cadeia de conexão que se conecta a um banco de dados primário em vez de a um ouvinte de grupo de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="a47a4-139">The driver will return an error if database mirroring is used on the primary database in the availability group, and if `MultiSubnetFailover=Yes` is used in the connection string that connects to a primary database instead of to an availability group listener.</span></span>  
  
## <a name="specifying-application-intent"></a><span data-ttu-id="a47a4-140">Especificando a intenção do aplicativo</span><span class="sxs-lookup"><span data-stu-id="a47a4-140">Specifying Application Intent</span></span>  
 <span data-ttu-id="a47a4-141">Quando `ApplicationIntent=ReadOnly`, o cliente solicita uma carga de trabalho leitura ao se conectar a um banco de dados habilitado para AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="a47a4-141">When `ApplicationIntent=ReadOnly`, the client requests a read workload when connecting to an AlwaysOn enabled database.</span></span> <span data-ttu-id="a47a4-142">O servidor irá impor a intenção no momento da conexão e durante uma instrução USE de banco de dados, mas somente para um banco de dados habilitado para AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="a47a4-142">The server will enforce the intent at connection time and during a USE database statement but only to an Always On enabled database.</span></span>  
  
 <span data-ttu-id="a47a4-143">A palavra-chave `ApplicationIntent` não funciona com bancos de dados somente leitura de versões anteriores.</span><span class="sxs-lookup"><span data-stu-id="a47a4-143">The `ApplicationIntent` keyword does not work with legacy, read-only databases.</span></span>  
  
 <span data-ttu-id="a47a4-144">Um banco de dados pode permitir ou não cargas de trabalho de leitura no banco de dados AlwaysOn de destino.</span><span class="sxs-lookup"><span data-stu-id="a47a4-144">A database can allow or disallow read workloads on the targeted AlwaysOn database.</span></span> <span data-ttu-id="a47a4-145">(Isso é feito com a cláusula `ALLOW_CONNECTIONS` das instruções `PRIMARY_ROLE` e `SECONDARY_ROLE`[!INCLUDE[tsql](../../../includes/tsql-md.md)].)</span><span class="sxs-lookup"><span data-stu-id="a47a4-145">(This is done with the `ALLOW_CONNECTIONS` clause of the `PRIMARY_ROLE` and `SECONDARY_ROLE`[!INCLUDE[tsql](../../../includes/tsql-md.md)] statements.)</span></span>  
  
 <span data-ttu-id="a47a4-146">A palavra-chave `ApplicationIntent` é usada para habilitar o roteamento somente leitura.</span><span class="sxs-lookup"><span data-stu-id="a47a4-146">The `ApplicationIntent` keyword is used to enable read-only routing.</span></span>  
  
## <a name="read-only-routing"></a><span data-ttu-id="a47a4-147">Roteamento somente leitura</span><span class="sxs-lookup"><span data-stu-id="a47a4-147">Read-Only Routing</span></span>  
 <span data-ttu-id="a47a4-148">O roteamento somente leitura é um recurso que pode assegurar a disponibilidade de uma réplica somente leitura de um banco de dados.</span><span class="sxs-lookup"><span data-stu-id="a47a4-148">Read-only routing is a feature that can ensure the availability of a read only replica of a database.</span></span> <span data-ttu-id="a47a4-149">Para habilitar roteamento somente leitura:</span><span class="sxs-lookup"><span data-stu-id="a47a4-149">To enable read-only routing:</span></span>  
  
1.  <span data-ttu-id="a47a4-150">Você deve conectar-se a um ouvinte de grupo de disponibilidade AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="a47a4-150">You must connect to an Always On Availability Group availability group listener.</span></span>  
  
2.  <span data-ttu-id="a47a4-151">A palavra-chave de cadeia de conexão `ApplicationIntent` deve ser definida como `ReadOnly`.</span><span class="sxs-lookup"><span data-stu-id="a47a4-151">The `ApplicationIntent` connection string keyword must be set to `ReadOnly`.</span></span>  
  
3.  <span data-ttu-id="a47a4-152">O grupo de disponibilidade deve ser configurado pelo administrador de banco de dados para permitir o roteamento somente leitura.</span><span class="sxs-lookup"><span data-stu-id="a47a4-152">The Availability Group must be configured by the database administrator to enable read-only routing.</span></span>  
  
 <span data-ttu-id="a47a4-153">É possível que nem todas as várias conexões que usam roteamento somente leitura se conectem à mesma réplica somente leitura.</span><span class="sxs-lookup"><span data-stu-id="a47a4-153">It is possible that multiple connections using read-only routing will not all connect to the same read-only replica.</span></span> <span data-ttu-id="a47a4-154">Alterações na sincronização de banco de dados ou alterações na configuração de roteamento de servidor podem resultar em conexões de cliente com réplicas somente leitura diferentes.</span><span class="sxs-lookup"><span data-stu-id="a47a4-154">Changes in database synchronization or changes in the server's routing configuration can result in client connections to different read-only replicas.</span></span> <span data-ttu-id="a47a4-155">Para garantir que todas as solicitações somente leitura conectem-se à mesma réplica somente leitura, não transmita um ouvinte de grupo de disponibilidade à palavra-chave de cadeia de conexão `Server`.</span><span class="sxs-lookup"><span data-stu-id="a47a4-155">To ensure that all read-only requests connect to the same read-only replica, do not pass an availability group listener to the `Server` connection string keyword.</span></span> <span data-ttu-id="a47a4-156">Em vez disso, especifique o nome da instância somente leitura.</span><span class="sxs-lookup"><span data-stu-id="a47a4-156">Instead, specify the name of the read-only instance.</span></span>  
  
 <span data-ttu-id="a47a4-157">O roteamento somente leitura pode demorar mais tempo do que a conexão ao primário porque o roteamento somente leitura conecta-se primeiramente ao primário e depois procura o melhor secundário legível disponível.</span><span class="sxs-lookup"><span data-stu-id="a47a4-157">Read-only routing may take longer than connecting to the primary because read only routing first connects to the primary and then looks for the best available readable secondary.</span></span> <span data-ttu-id="a47a4-158">Por isso, você deve aumentar seu tempo limite de logon.</span><span class="sxs-lookup"><span data-stu-id="a47a4-158">Because of this, you should increase your login timeout.</span></span>  
  
## <a name="odbc"></a><span data-ttu-id="a47a4-159">ODBCODBC</span><span class="sxs-lookup"><span data-stu-id="a47a4-159">ODBC</span></span>  
 <span data-ttu-id="a47a4-160">Duas palavras-chave de cadeia de conexão ODBC foram adicionadas para oferecer suporte ao [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] no [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client:</span><span class="sxs-lookup"><span data-stu-id="a47a4-160">Two ODBC connection string keywords were added to support [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client:</span></span>  
  
-   `ApplicationIntent`  
  
-   `MultiSubnetFailover`  
  
 <span data-ttu-id="a47a4-161">Para obter mais informações sobre essas palavras-chave de cadeia de conexão do ODBC no [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, consulte [Usando palavras-chave da cadeia de conexão com o SQL Server Native Client](../applications/using-connection-string-keywords-with-sql-server-native-client.md).</span><span class="sxs-lookup"><span data-stu-id="a47a4-161">For more information about ODBC connection string keywords in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, see [Using Connection String Keywords with SQL Server Native Client](../applications/using-connection-string-keywords-with-sql-server-native-client.md).</span></span>  
  
 <span data-ttu-id="a47a4-162">As propriedades de conexão equivalentes são:</span><span class="sxs-lookup"><span data-stu-id="a47a4-162">The equivalent connection properties are:</span></span>  
  
-   `SQL_COPT_SS_APPLICATION_INTENT`  
  
-   `SQL_COPT_SS_MULTISUBNET_FAILOVER`  
  
 <span data-ttu-id="a47a4-163">Para obter mais informações sobre as propriedades de conexão ODBC no [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, consulte [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md).</span><span class="sxs-lookup"><span data-stu-id="a47a4-163">For more information about ODBC connection properties in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, see [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md).</span></span>  
  
 <span data-ttu-id="a47a4-164">A funcionalidade das palavras-chave `ApplicationIntent` e `MultiSubnetFailover` será exposta no Administrador de Fonte de Dados ODBC para DSNs que usam o driver do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, a partir do [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a47a4-164">The functionality of the `ApplicationIntent` and `MultiSubnetFailover` keywords will be exposed in the ODBC Data Source Administrator for DSNs that use the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client driver, beginning in [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)].</span></span>  
  
 <span data-ttu-id="a47a4-165">Um aplicativo ODBC do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client pode usar uma das três funções para estabelecer a conexão:</span><span class="sxs-lookup"><span data-stu-id="a47a4-165">A [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC application can use one of three functions to make the connection:</span></span>  
  
|<span data-ttu-id="a47a4-166">Função</span><span class="sxs-lookup"><span data-stu-id="a47a4-166">Function</span></span>|<span data-ttu-id="a47a4-167">Descrição</span><span class="sxs-lookup"><span data-stu-id="a47a4-167">Description</span></span>|  
|--------------|-----------------|  
|[<span data-ttu-id="a47a4-168">SQLBrowseConnect</span><span class="sxs-lookup"><span data-stu-id="a47a4-168">SQLBrowseConnect</span></span>](../../native-client-odbc-api/sqlbrowseconnect.md)|<span data-ttu-id="a47a4-169">A lista de servidores retornada por `SQLBrowseConnect` não incluirá VNNs.</span><span class="sxs-lookup"><span data-stu-id="a47a4-169">The list of servers returned by `SQLBrowseConnect` will not include VNNs.</span></span> <span data-ttu-id="a47a4-170">Você consultará apenas uma lista de servidores sem nenhuma indicação se o servidor for autônomo, ou um servidor primário ou secundário em um cluster WSFC (Windows Server Failover Clustering) que contenha duas ou mais instâncias do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] habilitadas para [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a47a4-170">You will only see a list of servers without any indication if the server is a standalone server, or a primary or secondary server in a Windows Server Failover Clustering (WSFC) cluster that contains two or more [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instances that have been enabled for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span></span> <span data-ttu-id="a47a4-171">Se você se conectar a um servidor e obtiver uma falha, talvez isso aconteça porque você se conectou a um servidor, e a configuração de `ApplicationIntent` não é compatível com a configuração de servidor.</span><span class="sxs-lookup"><span data-stu-id="a47a4-171">If you connect to a server and get a failure, it may be because you have connected to a server, and the `ApplicationIntent` setting is not compatible with the server configuration.</span></span><br /><br /> <span data-ttu-id="a47a4-172">Como `SQLBrowseConnect` não reconhece servidores em um cluster WSFC (Windows Server Failover Clustering) que contém duas ou mais instâncias do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] habilitadas para [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], `SQLBrowseConnect` ignora a palavra-chave de cadeia de conexão `MultiSubnetFailover`.</span><span class="sxs-lookup"><span data-stu-id="a47a4-172">Because `SQLBrowseConnect` does not recognize servers in a Windows Server Failover Clustering (WSFC) cluster that contains two or more [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instances that have been enabled for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], `SQLBrowseConnect` ignores the `MultiSubnetFailover` connection string keyword.</span></span>|  
|[<span data-ttu-id="a47a4-173">SQLConnect</span><span class="sxs-lookup"><span data-stu-id="a47a4-173">SQLConnect</span></span>](../../native-client-odbc-api/sqlconnect.md)|<span data-ttu-id="a47a4-174">`SQLConnect` oferece suporte a `ApplicationIntent` e `MultiSubnetFailover` através de um DSN (nome de fonte de dados) ou de propriedades de conexão.</span><span class="sxs-lookup"><span data-stu-id="a47a4-174">`SQLConnect` supports both `ApplicationIntent` and `MultiSubnetFailover` via a data source name (DSN) or connection properties.</span></span>|  
|[<span data-ttu-id="a47a4-175">SQLDriverConnect</span><span class="sxs-lookup"><span data-stu-id="a47a4-175">SQLDriverConnect</span></span>](../../native-client-odbc-api/sqldriverconnect.md)|<span data-ttu-id="a47a4-176">`SQLDriverConnect` oferece suporte a `ApplicationIntent` e `MultiSubnetFailover` através de palavras-chave de cadeia de conexão, de propriedades de conexão ou do DSN.</span><span class="sxs-lookup"><span data-stu-id="a47a4-176">`SQLDriverConnect` supports `ApplicationIntent` and `MultiSubnetFailover` via connection string keywords, connection properties, or DSN.</span></span>|  
  
## <a name="ole-db"></a><span data-ttu-id="a47a4-177">OLE DB</span><span class="sxs-lookup"><span data-stu-id="a47a4-177">OLE DB</span></span>  
 <span data-ttu-id="a47a4-178">O OLE DB no [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client não oferece suporte à palavra-chave `MultiSubnetFailover`.</span><span class="sxs-lookup"><span data-stu-id="a47a4-178">OLE DB in the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client does not support the `MultiSubnetFailover` keyword.</span></span>  
  
 <span data-ttu-id="a47a4-179">O OLE DB no [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client oferecerá suporte à tentativa de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="a47a4-179">OLE DB in the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client will support application intent.</span></span> <span data-ttu-id="a47a4-180">A tentativa de aplicativo se comportará da mesma maneira em aplicativos OLE DB e ODBC (consulte acima).</span><span class="sxs-lookup"><span data-stu-id="a47a4-180">Application intent will behave the same for OLE DB applications as ODBC applications (see above).</span></span>  
  
 <span data-ttu-id="a47a4-181">Uma palavras-chave de cadeia de conexão OLE DB foi adicionada para oferecer suporte ao [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] no [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client:</span><span class="sxs-lookup"><span data-stu-id="a47a4-181">One OLE DB connection string keyword added to support [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client:</span></span>  
  
-   `Application Intent`  
  
 <span data-ttu-id="a47a4-182">Para obter mais informações sobre essas palavras-chave de cadeia de conexão no [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, consulte [Usando palavras-chave da cadeia de conexão com o SQL Server Native Client](../applications/using-connection-string-keywords-with-sql-server-native-client.md).</span><span class="sxs-lookup"><span data-stu-id="a47a4-182">For more information about connection string keywords in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, see [Using Connection String Keywords with SQL Server Native Client](../applications/using-connection-string-keywords-with-sql-server-native-client.md).</span></span>  
  
 <span data-ttu-id="a47a4-183">As propriedades de conexão equivalentes são:</span><span class="sxs-lookup"><span data-stu-id="a47a4-183">The equivalent connection properties are:</span></span>  
  
-   `SSPROP_INIT_APPLICATIONINTENT`  
  
-   `DBPROP_INIT_PROVIDERSTRING`  
  
 <span data-ttu-id="a47a4-184">Um aplicativo OLE DB do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client pode usar um dos métodos para especificar uma tentativa de aplicativo:</span><span class="sxs-lookup"><span data-stu-id="a47a4-184">A [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB application can use one of the methods to specify application intent:</span></span>  
  
 `IDBInitialize::Initialize`  
 <span data-ttu-id="a47a4-185">`IDBInitialize::Initialize` usa o conjunto previamente configurado de propriedades para inicializar a fonte de dados e criar o objeto de fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="a47a4-185">`IDBInitialize::Initialize` uses the previously configured set of properties to initialize the data source and create the data source object.</span></span> <span data-ttu-id="a47a4-186">Especifique a tentativa de aplicativo como uma propriedade de provedor ou como parte da cadeia de caracteres de propriedades estendidas.</span><span class="sxs-lookup"><span data-stu-id="a47a4-186">Specify application intent as a provider property or as part of the extended properties string.</span></span>  
  
 `IDataInitialize::GetDataSource`  
 <span data-ttu-id="a47a4-187">`IDataInitialize::GetDataSource` usa uma cadeia de conexão de entrada que pode conter a palavra-chave `Application Intent`.</span><span class="sxs-lookup"><span data-stu-id="a47a4-187">`IDataInitialize::GetDataSource` takes an input connection string that can contain the `Application Intent` keyword.</span></span>  
  
 `IDBProperties::GetProperties`  
 <span data-ttu-id="a47a4-188">`IDBProperties::GetProperties` recupera o valor da propriedade atualmente definida na fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="a47a4-188">`IDBProperties::GetProperties` retrieves the value of the property that is currently set on the data source.</span></span>  <span data-ttu-id="a47a4-189">Você pode recuperar o valor de `Application Intent` através das propriedades DBPROP_INIT_PROVIDERSTRING e SSPROP_INIT_APPLICATIONINTENT.</span><span class="sxs-lookup"><span data-stu-id="a47a4-189">You can retrieve the `Application Intent` value through the DBPROP_INIT_PROVIDERSTRING property and SSPROP_INIT_APPLICATIONINTENT property.</span></span>  
  
 `IDBProperties::SetProperties`  
 <span data-ttu-id="a47a4-190">Para definir o valor de propriedade `ApplicationIntent`, chame `IDBProperties::SetProperties`, que está sendo passada na propriedade `SSPROP_INIT_APPLICATIONINTENT` com o valor "`ReadWrite`" ou "`ReadOnly`", ou na propriedade `DBPROP_INIT_PROVIDERSTRING` com o valor que contém "`ApplicationIntent=ReadOnly`" ou "`ApplicationIntent=ReadWrite`".</span><span class="sxs-lookup"><span data-stu-id="a47a4-190">To set the `ApplicationIntent` property value, call `IDBProperties::SetProperties` passing in the `SSPROP_INIT_APPLICATIONINTENT` property with value "`ReadWrite`" or "`ReadOnly`" or `DBPROP_INIT_PROVIDERSTRING` property with value containing "`ApplicationIntent=ReadOnly`" or "`ApplicationIntent=ReadWrite`".</span></span>  
  
 <span data-ttu-id="a47a4-191">Você pode especificar a tentativa de aplicativo no campo Propriedades de Tentativa de Aplicativo da guia Tudo na caixa de diálogo **Propriedades de Vínculo de Dados**.</span><span class="sxs-lookup"><span data-stu-id="a47a4-191">You can specify application intent in the Application Intent Properties field of the All tab in the **Data Link Properties** dialog box.</span></span>  
  
 <span data-ttu-id="a47a4-192">Quando forem estabelecidas conexões implícitas, a conexão implícita usará a configuração de tentativa de aplicativo da conexão pai.</span><span class="sxs-lookup"><span data-stu-id="a47a4-192">When implicit connections are established, the implicit connection will use the application intent setting of the parent connection.</span></span> <span data-ttu-id="a47a4-193">Da mesma forma, várias sessões criadas a partir da mesma fonte de dados herdarão a configuração de tentativa de aplicativo da fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="a47a4-193">Similarly, multiple sessions created from the same data source will inherit the data source's application intent setting.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a47a4-194">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="a47a4-194">See Also</span></span>  
 <span data-ttu-id="a47a4-195">[Recursos do SQL Server Native Client](sql-server-native-client-features.md) </span><span class="sxs-lookup"><span data-stu-id="a47a4-195">[SQL Server Native Client Features](sql-server-native-client-features.md) </span></span>  
 [<span data-ttu-id="a47a4-196">Usando palavras-chave da cadeia de conexão com o SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="a47a4-196">Using Connection String Keywords with SQL Server Native Client</span></span>](../applications/using-connection-string-keywords-with-sql-server-native-client.md)  
  
  
