---
title: Usar tipos de dados XML | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- IRowsetChange interface
- IRowsetUpdate interface
- data access [SQL Server Native Client], xml data type
- SQL Server Native Client OLE DB schema rowsets
- PROVIDER_TYPES rowset
- IColumnsInfo interface
- IRowsetFind interface
- IColumnsRowset interface
- PROCEDURE_PARAMETERS rowset
- SQLNCLI, XML
- xml data type [SQL Server], SQL Server Native Client
- SQL Server Native Client, XML
- IRowset interface
- ISequentialStream interface
- ISSCommandWithParameters interface
- SS_XMLSCHEMA rowset
- SQL Server Native Client OLE DB interfaces
- XML [SQL Server], SQL Server Native Client
- COLUMNS rowset
ms.assetid: a7af5b72-c5c2-418d-a636-ae4ac6270ee5
author: rothja
ms.author: jroth
ms.openlocfilehash: 3d0dcc8cf7259a24e53281724d8440c6ff2209f1
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87576324"
---
# <a name="using-xml-data-types"></a><span data-ttu-id="606b0-102">Usando tipos de dados XML</span><span class="sxs-lookup"><span data-stu-id="606b0-102">Using XML Data Types</span></span>
  <span data-ttu-id="606b0-103">O [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] introduziu um tipo de dados **xml** que permite armazenar documentos e fragmentos XML em um banco de dados do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="606b0-103">[!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] introduced an **xml** data type that enables you to store XML documents and fragments in a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database.</span></span> <span data-ttu-id="606b0-104">O tipo de dados **xml** é interno no [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] e tem algumas semelhanças com outros tipos internos, como **int** e **varchar**.</span><span class="sxs-lookup"><span data-stu-id="606b0-104">The **xml** data type is a built-in data type in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], and is in some ways similar to other built-in types, such as **int** and **varchar**.</span></span> <span data-ttu-id="606b0-105">Assim como ocorre em outros tipos internos, você pode usar o tipo de dados **xml** como um tipo de coluna ao criar uma tabela; como um tipo de variável, de parâmetro ou de retorno de função; ou em funções CAST e CONVERT.</span><span class="sxs-lookup"><span data-stu-id="606b0-105">As with other built-in types, you can use the **xml** data type as a column type when creating a table; as a variable type, a parameter type, or a function-return type; or in CAST and CONVERT functions.</span></span>  
  
## <a name="programming-considerations"></a><span data-ttu-id="606b0-106">Considerações sobre programação</span><span class="sxs-lookup"><span data-stu-id="606b0-106">Programming Considerations</span></span>  
 <span data-ttu-id="606b0-107">O XML pode ser autodescritivo no sentido de que pode opcionalmente incluir um cabeçalho de XML que especifica a codificação do documento, por exemplo:</span><span class="sxs-lookup"><span data-stu-id="606b0-107">XML can be self-describing in that it can optionally include an XML header that specifies the encoding of the document, for example:</span></span>  
  
 `<?xml version="1.0" encoding="windows-1252"?><doc/>`  
  
 <span data-ttu-id="606b0-108">O padrão XML descreve como um processador XML pode detectar a codificação usada para um documento examinando os primeiros bytes desse documento.</span><span class="sxs-lookup"><span data-stu-id="606b0-108">The XML standard describes how an XML processor can detect the encoding used for a document by examining the first few bytes of the document.</span></span> <span data-ttu-id="606b0-109">Há riscos de a codificação especificada pelo aplicativo entrar em conflito com a especificada pelo documento.</span><span class="sxs-lookup"><span data-stu-id="606b0-109">There are opportunities for the encoding specified by the application to conflict with the encoding specified by the document.</span></span> <span data-ttu-id="606b0-110">No caso de documentos passados como parâmetros associados, o XML é tratado como dados binários pelo [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], por isso nenhuma conversão é feita e o analisador XML pode usar a codificação especificada no documento sem problemas.</span><span class="sxs-lookup"><span data-stu-id="606b0-110">For documents passed as bound parameters, XML is treated as binary data by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], so no conversions are made and the XML parser can use the encoding specified within the document without problems.</span></span> <span data-ttu-id="606b0-111">Entretanto, no caso de dados XML associados como WSTR, o aplicativo precisa garantir que o documento está codificado como Unicode.</span><span class="sxs-lookup"><span data-stu-id="606b0-111">However, for XML data that is bound as WSTR, then the application must ensure that the document is encoded as Unicode.</span></span> <span data-ttu-id="606b0-112">Assim, talvez seja necessário carregar o documento em um DOM, alterar a codificação para Unicode e serializar o documento.</span><span class="sxs-lookup"><span data-stu-id="606b0-112">This may entail loading the document into a DOM, changing the encoding to Unicode and serializing the document.</span></span> <span data-ttu-id="606b0-113">Senão, poderão ocorrer conversões de dados, gerando XML inválido ou corrompido.</span><span class="sxs-lookup"><span data-stu-id="606b0-113">If this is not done, data conversions may occur, resulting in invalid or corrupt XML.</span></span>  
  
 <span data-ttu-id="606b0-114">Também há risco de conflitos quando o XML é especificado em literais.</span><span class="sxs-lookup"><span data-stu-id="606b0-114">There is also potential for conflict when XML is specified in literals.</span></span> <span data-ttu-id="606b0-115">Por exemplo, as expressões a seguir são inválidas:</span><span class="sxs-lookup"><span data-stu-id="606b0-115">For example the following are invalid:</span></span>  
  
 `INSERT INTO xmltable(xmlcol) VALUES('<?xml version="1.0" encoding="UTF-16"?><doc/>')`  
  
 `INSERT INTO xmltable(xmlcol) VALUES(N'<?xml version="1.0" encoding="UTF-8"?><doc/>')`  
  
## <a name="sql-server-native-client-ole-db-provider"></a><span data-ttu-id="606b0-116">Provedor OLE DB do SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="606b0-116">SQL Server Native Client OLE DB Provider</span></span>  
 <span data-ttu-id="606b0-117">DBTYPE_XML é um novo tipo de dados específico ao XML no provedor do OLE DB do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="606b0-117">DBTYPE_XML is a new data type specific to XML in the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider.</span></span> <span data-ttu-id="606b0-118">Além disso, é possível acessar dados XML pelos tipos de OLE DB existentes DBTYPE_BYTES, DBTYPE_WSTR, DBTYPE_BSTR, DBTYPE_XML, DBTYPE_STR, DBTYPE_VARIANT e DBTYPE_IUNKNOWN.</span><span class="sxs-lookup"><span data-stu-id="606b0-118">In addition, XML data can be accessed through the existing OLE DB types of DBTYPE_BYTES, DBTYPE_WSTR, DBTYPE_BSTR, DBTYPE_XML, DBTYPE_STR, DBTYPE_VARIANT, and DBTYPE_IUNKNOWN.</span></span> <span data-ttu-id="606b0-119">Os dados armazenados em colunas de tipo XML podem ser recuperados de uma coluna em um conjunto de linhas do provedor do OLE DB do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client nos formatos a seguir:</span><span class="sxs-lookup"><span data-stu-id="606b0-119">Data stored in columns of type XML can be retrieved from a column in a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider rowset in the following formats:</span></span>  
  
-   <span data-ttu-id="606b0-120">Uma cadeia de caracteres de texto</span><span class="sxs-lookup"><span data-stu-id="606b0-120">A text string</span></span>  
  
-   <span data-ttu-id="606b0-121">Um **ISequentialStream**</span><span class="sxs-lookup"><span data-stu-id="606b0-121">An **ISequentialStream**</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="606b0-122">O [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] provedor de OLE DB de cliente nativo não inclui um leitor SAX, mas o **ISequentialStream** pode ser facilmente passado para objetos sax e dom no MSXML.</span><span class="sxs-lookup"><span data-stu-id="606b0-122">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider does not include a SAX reader, but the **ISequentialStream** can be easily passed to SAX and DOM objects in MSXML.</span></span>  
  
 <span data-ttu-id="606b0-123">**ISequentialStream** deve ser usado para recuperação de documentos XML grandes.</span><span class="sxs-lookup"><span data-stu-id="606b0-123">**ISequentialStream** should be use used for retrieval of large XML documents.</span></span> <span data-ttu-id="606b0-124">As mesmas técnicas usadas para outros tipos de valor extenso também se aplicam ao XML.</span><span class="sxs-lookup"><span data-stu-id="606b0-124">The same techniques used for other large value types also apply to XML.</span></span> <span data-ttu-id="606b0-125">Para obter mais informações, confira [Usar tipos de valor grande](using-large-value-types.md).</span><span class="sxs-lookup"><span data-stu-id="606b0-125">For more information, see [Using Large Value Types](using-large-value-types.md).</span></span>  
  
 <span data-ttu-id="606b0-126">Os dados armazenados em colunas do tipo XML em um conjunto de linhas também podem ser recuperados, inseridos ou atualizados por um aplicativo por meio das interfaces comuns como **IRow::GetColumns**, **IRowChange::SetColumns** e **ICommand::Execute**.</span><span class="sxs-lookup"><span data-stu-id="606b0-126">Data stored in columns of type XML in a rowset can also be retrieved, inserted, or updated by an application via the usual interfaces such as **IRow::GetColumns**, **IRowChange::SetColumns**, and **ICommand::Execute**.</span></span> <span data-ttu-id="606b0-127">Da mesma forma que no caso de recuperação, um programa de aplicativo pode passar uma cadeia de caracteres de texto ou um **ISequentialStream** para o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] provedor de OLE DB de cliente nativo.</span><span class="sxs-lookup"><span data-stu-id="606b0-127">Similarly to the retrieval case, an application program can pass either a text string or an **ISequentialStream** to the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="606b0-128">Para enviar dados XML em formato de cadeia de caracteres pela interface **ISequentialStream**, você precisa obter o **ISequentialStream** especificando DBTYPE_IUNKNOWN e definir seu argumento *pObject* como nulo na associação.</span><span class="sxs-lookup"><span data-stu-id="606b0-128">To send XML data in string format through the **ISequentialStream** interface, you must obtain **ISequentialStream** by specifying DBTYPE_IUNKNOWN and set its *pObject* argument to null in the binding.</span></span>  
  
 <span data-ttu-id="606b0-129">Quando os dados XML recuperados estão truncados porque o buffer de consumidor é muito pequeno, a extensão poderá ser retornada como 0xffffffff, o que significará que ela é desconhecida.</span><span class="sxs-lookup"><span data-stu-id="606b0-129">When retrieved XML data is truncated due to the consumer buffer being too small, the length may be returned as 0xffffffff, which means that the length is unknown.</span></span> <span data-ttu-id="606b0-130">Isso é condizente com sua implementação como tipo de dados transmitidos ao cliente sem enviar as informações de extensão antes dos dados reais.</span><span class="sxs-lookup"><span data-stu-id="606b0-130">This is consistent with its implementation as a data type that is streamed to the client without sending length information ahead of the actual data.</span></span> <span data-ttu-id="606b0-131">Em alguns casos, o comprimento real pode ser retornado quando o provedor armazena em buffer o valor inteiro, como **IRowset:: GetData** e onde a conversão de dados é executada.</span><span class="sxs-lookup"><span data-stu-id="606b0-131">In some cases the actual length may be returned when the provider has buffered the whole value, such as **IRowset::GetData** and where data conversion is performed.</span></span>  
  
 <span data-ttu-id="606b0-132">Os dados XML enviados ao SQL Server são tratados como dados binários pelo servidor.</span><span class="sxs-lookup"><span data-stu-id="606b0-132">XML data sent to SQL Server is treated as binary data by the server.</span></span> <span data-ttu-id="606b0-133">Isso impede a ocorrência de qualquer conversão e permite que o analisador XML autodetecte a codificação de XML.</span><span class="sxs-lookup"><span data-stu-id="606b0-133">This prevents any conversions occurring and allows the XML parser to auto-detect the XML encoding.</span></span> <span data-ttu-id="606b0-134">Além disso, permite que uma variedade mais ampla de documentos XML (por exemplo, aqueles codificados em UTF-8) seja aceita como entrada no [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="606b0-134">This allows a wider range of XML documents (for example those encoded in UTF-8) to be accepted as input to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="606b0-135">Se o XML de entrada estiver associado como DBTYPE_WSTR, o aplicativo deverá garantir que já tem codificação Unicode para evitar qualquer possibilidade de corrompimento por conversões de dados indesejadas.</span><span class="sxs-lookup"><span data-stu-id="606b0-135">If input XML is bound as DBTYPE_WSTR, the application must ensure it is already Unicode encoded to avoid any possibility of corruption by unwanted data conversions.</span></span>  
  
### <a name="data-bindings-and-coercions"></a><span data-ttu-id="606b0-136">Coerções e associações de dados</span><span class="sxs-lookup"><span data-stu-id="606b0-136">Data Bindings and Coercions</span></span>  
 <span data-ttu-id="606b0-137">A tabela a seguir descreve a associação e a coerção que ocorrem ao usar os tipos de dados listados com o tipo de dados  **xml** do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="606b0-137">The following table describes the binding and coercion that occurs when using the listed data types with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] **xml** data type.</span></span>  
  
|<span data-ttu-id="606b0-138">Tipo de dados</span><span class="sxs-lookup"><span data-stu-id="606b0-138">Data type</span></span>|<span data-ttu-id="606b0-139">Para servidor</span><span class="sxs-lookup"><span data-stu-id="606b0-139">To Server</span></span><br /><br /> <span data-ttu-id="606b0-140">**XML**</span><span class="sxs-lookup"><span data-stu-id="606b0-140">**XML**</span></span>|<span data-ttu-id="606b0-141">Para servidor</span><span class="sxs-lookup"><span data-stu-id="606b0-141">To Server</span></span><br /><br /> <span data-ttu-id="606b0-142">**Não XML**</span><span class="sxs-lookup"><span data-stu-id="606b0-142">**Non-XML**</span></span>|<span data-ttu-id="606b0-143">Do servidor</span><span class="sxs-lookup"><span data-stu-id="606b0-143">From Server</span></span><br /><br /> <span data-ttu-id="606b0-144">**XML**</span><span class="sxs-lookup"><span data-stu-id="606b0-144">**XML**</span></span>|<span data-ttu-id="606b0-145">Do servidor</span><span class="sxs-lookup"><span data-stu-id="606b0-145">From Server</span></span><br /><br /> <span data-ttu-id="606b0-146">**Não XML**</span><span class="sxs-lookup"><span data-stu-id="606b0-146">**Non-XML**</span></span>|  
|---------------|---------------------------|--------------------------------|-----------------------------|----------------------------------|  
|<span data-ttu-id="606b0-147">DBTYPE_XML</span><span class="sxs-lookup"><span data-stu-id="606b0-147">DBTYPE_XML</span></span>|<span data-ttu-id="606b0-148">Passagem<sup>6,7</sup></span><span class="sxs-lookup"><span data-stu-id="606b0-148">Pass through<sup>6,7</sup></span></span>|<span data-ttu-id="606b0-149">Erro<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="606b0-149">Error<sup>1</sup></span></span>|<span data-ttu-id="606b0-150">OK<sup>11, 6</sup></span><span class="sxs-lookup"><span data-stu-id="606b0-150">OK<sup>11, 6</sup></span></span>|<span data-ttu-id="606b0-151">Erro<sup>8</sup></span><span class="sxs-lookup"><span data-stu-id="606b0-151">Error<sup>8</sup></span></span>|  
|<span data-ttu-id="606b0-152">DBTYPE_BYTES</span><span class="sxs-lookup"><span data-stu-id="606b0-152">DBTYPE_BYTES</span></span>|<span data-ttu-id="606b0-153">Passagem<sup>6,7</sup></span><span class="sxs-lookup"><span data-stu-id="606b0-153">Pass through<sup>6,7</sup></span></span>|<span data-ttu-id="606b0-154">N/A<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="606b0-154">N/A<sup>2</sup></span></span>|<span data-ttu-id="606b0-155">OK <sup>11, 6</sup></span><span class="sxs-lookup"><span data-stu-id="606b0-155">OK <sup>11, 6</sup></span></span>|<span data-ttu-id="606b0-156">N/D <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="606b0-156">N/A <sup>2</sup></span></span>|  
|<span data-ttu-id="606b0-157">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="606b0-157">DBTYPE_WSTR</span></span>|<span data-ttu-id="606b0-158">Passagem<sup>6,10</sup></span><span class="sxs-lookup"><span data-stu-id="606b0-158">Pass through<sup>6,10</sup></span></span>|<span data-ttu-id="606b0-159">N/D <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="606b0-159">N/A <sup>2</sup></span></span>|<span data-ttu-id="606b0-160">OK<sup>4, 6, 12</sup></span><span class="sxs-lookup"><span data-stu-id="606b0-160">OK<sup>4, 6, 12</sup></span></span>|<span data-ttu-id="606b0-161">N/D <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="606b0-161">N/A <sup>2</sup></span></span>|  
|<span data-ttu-id="606b0-162">DBTYPE_BSTR</span><span class="sxs-lookup"><span data-stu-id="606b0-162">DBTYPE_BSTR</span></span>|<span data-ttu-id="606b0-163">Passagem<sup>6,10</sup></span><span class="sxs-lookup"><span data-stu-id="606b0-163">Pass through<sup>6,10</sup></span></span>|<span data-ttu-id="606b0-164">N/D <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="606b0-164">N/A <sup>2</sup></span></span>|<span data-ttu-id="606b0-165">OK <sup>3</sup></span><span class="sxs-lookup"><span data-stu-id="606b0-165">OK <sup>3</sup></span></span>|<span data-ttu-id="606b0-166">N/D <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="606b0-166">N/A <sup>2</sup></span></span>|  
|<span data-ttu-id="606b0-167">DBTYPE_STR</span><span class="sxs-lookup"><span data-stu-id="606b0-167">DBTYPE_STR</span></span>|<span data-ttu-id="606b0-168">OK<sup>6, 9, 10</sup></span><span class="sxs-lookup"><span data-stu-id="606b0-168">OK<sup>6, 9, 10</sup></span></span>|<span data-ttu-id="606b0-169">N/D <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="606b0-169">N/A <sup>2</sup></span></span>|<span data-ttu-id="606b0-170">OK<sup>5, 6, 12</sup></span><span class="sxs-lookup"><span data-stu-id="606b0-170">OK<sup>5, 6, 12</sup></span></span>|<span data-ttu-id="606b0-171">N/D <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="606b0-171">N/A <sup>2</sup></span></span>|  
|<span data-ttu-id="606b0-172">DBTYPE_IUNKNOWN</span><span class="sxs-lookup"><span data-stu-id="606b0-172">DBTYPE_IUNKNOWN</span></span>|<span data-ttu-id="606b0-173">Fluxo de bytes por meio de **ISequentialStream**<sup>7</sup></span><span class="sxs-lookup"><span data-stu-id="606b0-173">Byte stream via **ISequentialStream**<sup>7</sup></span></span>|<span data-ttu-id="606b0-174">N/D <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="606b0-174">N/A <sup>2</sup></span></span>|<span data-ttu-id="606b0-175">Fluxo de bytes por meio de **ISequentialStream**<sup>11</sup></span><span class="sxs-lookup"><span data-stu-id="606b0-175">Byte stream via **ISequentialStream**<sup>11</sup></span></span>|<span data-ttu-id="606b0-176">N/D <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="606b0-176">N/A <sup>2</sup></span></span>|  
|<span data-ttu-id="606b0-177">DBTYPE_VARIANT (VT_UI1 &#124; VT_ARRAY)</span><span class="sxs-lookup"><span data-stu-id="606b0-177">DBTYPE_VARIANT (VT_UI1 &#124; VT_ARRAY)</span></span>|<span data-ttu-id="606b0-178">Passagem<sup>6,7</sup></span><span class="sxs-lookup"><span data-stu-id="606b0-178">Pass through<sup>6,7</sup></span></span>|<span data-ttu-id="606b0-179">N/D <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="606b0-179">N/A <sup>2</sup></span></span>|<span data-ttu-id="606b0-180">N/D</span><span class="sxs-lookup"><span data-stu-id="606b0-180">N/A</span></span>|<span data-ttu-id="606b0-181">N/D <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="606b0-181">N/A <sup>2</sup></span></span>|  
|<span data-ttu-id="606b0-182">DBTYPE_VARIANT (VT_BSTR)</span><span class="sxs-lookup"><span data-stu-id="606b0-182">DBTYPE_VARIANT (VT_BSTR)</span></span>|<span data-ttu-id="606b0-183">Passagem<sup>6,10</sup></span><span class="sxs-lookup"><span data-stu-id="606b0-183">Pass through<sup>6,10</sup></span></span>|<span data-ttu-id="606b0-184">N/D <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="606b0-184">N/A <sup>2</sup></span></span>|<span data-ttu-id="606b0-185">OK<sup>3</sup></span><span class="sxs-lookup"><span data-stu-id="606b0-185">OK<sup>3</sup></span></span>|<span data-ttu-id="606b0-186">N/D <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="606b0-186">N/A <sup>2</sup></span></span>|  
  
 <span data-ttu-id="606b0-187"><sup>1</sup> Se um tipo de servidor diferente de DBTYPE_XML for especificado com **ICommandWithParameters:: SetParameterInfo** e o tipo de acessador for DBTYPE_XML, ocorrerá um erro quando a instrução for executada (DB_E_ERRORSOCCURRED, o status do parâmetro será DBSTATUS_E_BADACCESSOR); caso contrário, os dados são enviados para o servidor, mas o servidor retorna um erro indicando que não há conversão implícita de XML para o tipo de dados do parâmetro.</span><span class="sxs-lookup"><span data-stu-id="606b0-187"><sup>1</sup>If a server type other than DBTYPE_XML is specified with **ICommandWithParameters::SetParameterInfo** and the accessor type is DBTYPE_XML, an error occurs when the statement is executed (DB_E_ERRORSOCCURRED, the parameter status is DBSTATUS_E_BADACCESSOR); otherwise the data is sent to the server, but the server returns an error indicating that there is no implicit conversion from XML to the parameter's data type.</span></span>  
  
 <span data-ttu-id="606b0-188"><sup>2</sup> Além do escopo deste tópico.</span><span class="sxs-lookup"><span data-stu-id="606b0-188"><sup>2</sup>Beyond the scope of this topic.</span></span>  
  
 <span data-ttu-id="606b0-189"><sup>3</sup>O formato é UTF-16, não há BOM (marca de ordem de byte), não há especificação de codificação, não há terminação nula.</span><span class="sxs-lookup"><span data-stu-id="606b0-189"><sup>3</sup>Format is UTF-16, no bye-order mark (BOM), no encoding specification, no null termination.</span></span>  
  
 <span data-ttu-id="606b0-190"><sup>4</sup>O formato é UTF-16, não há BOM, não há especificação de codificação, há terminação nula.</span><span class="sxs-lookup"><span data-stu-id="606b0-190"><sup>4</sup>Format is UTF-16, no BOM, no encoding specification, null termination.</span></span>  
  
 <span data-ttu-id="606b0-191"><sup>5</sup>O formato consiste em caracteres multibyte codificados em página de código de cliente com terminador nulo.</span><span class="sxs-lookup"><span data-stu-id="606b0-191"><sup>5</sup>Format is multibyte characters encoded in client code page with null terminator.</span></span> <span data-ttu-id="606b0-192">A conversão a partir do Unicode fornecido pelo servidor pode causar corrompimento dos dados, por isso essa associação é altamente desestimulada.</span><span class="sxs-lookup"><span data-stu-id="606b0-192">Conversion from server supplied Unicode may cause data corruption, so this binding is strongly discouraged.</span></span>  
  
 <span data-ttu-id="606b0-193"><sup>6</sup>BY_REF pode ser usado.</span><span class="sxs-lookup"><span data-stu-id="606b0-193"><sup>6</sup>BY_REF may be used.</span></span>  
  
 <span data-ttu-id="606b0-194"><sup>7</sup>Os dados UTF-16 precisam ser iniciados com BOM.</span><span class="sxs-lookup"><span data-stu-id="606b0-194"><sup>7</sup>UTF-16 data must start with a BOM.</span></span> <span data-ttu-id="606b0-195">Senão, a codificação poderá não ser reconhecida corretamente pelo servidor.</span><span class="sxs-lookup"><span data-stu-id="606b0-195">If it does not, the encoding may not be correctly recognized by the server.</span></span>  
  
 <span data-ttu-id="606b0-196"><sup>8</sup>A validação pode ocorrer no momento da criação do acessador ou no momento do fetch.</span><span class="sxs-lookup"><span data-stu-id="606b0-196"><sup>8</sup>Validation can happen at create accessor time, or at fetch time.</span></span> <span data-ttu-id="606b0-197">O erro é DB_E_ERRORSOCCURRED; status da associação definido como DBBINDSTATUS_UNSUPPORTEDCONVERSION.</span><span class="sxs-lookup"><span data-stu-id="606b0-197">The error is DB_E_ERRORSOCCURRED, binding status set to DBBINDSTATUS_UNSUPPORTEDCONVERSION.</span></span>  
  
 <span data-ttu-id="606b0-198"><sup>9</sup>Os dados são convertidos em Unicode usando a página de código de cliente antes de serem enviados para o servidor.</span><span class="sxs-lookup"><span data-stu-id="606b0-198"><sup>9</sup>Data is converted to Unicode using the client codepage before being sent to the server.</span></span> <span data-ttu-id="606b0-199">Se a codificação de documento não corresponder à página de código de cliente, poderá haver corrompimento dos dados, por isso a associação é altamente desestimulada.</span><span class="sxs-lookup"><span data-stu-id="606b0-199">If the document encoding does not match the client codepage, this can result in data corruption, so this binding is strongly discouraged.</span></span>  
  
 <span data-ttu-id="606b0-200"><sup>10</sup>Um BOM sempre é adicionado aos dados enviados para o servidor.</span><span class="sxs-lookup"><span data-stu-id="606b0-200"><sup>10</sup>A BOM is always added to data sent to the server.</span></span> <span data-ttu-id="606b0-201">Se os dados já forem iniciados com um BOM, isso resultará em dois BOMs no início do buffer.</span><span class="sxs-lookup"><span data-stu-id="606b0-201">If the data already started with a BOM, this results in two BOMs at the start of the buffer.</span></span> <span data-ttu-id="606b0-202">O servidor usa o primeiro BOM para reconhecer a codificação como UTF-16 e então o descarta.</span><span class="sxs-lookup"><span data-stu-id="606b0-202">The server uses the first BOM to recognize the encoding as UTF-16 and then discards it.</span></span> <span data-ttu-id="606b0-203">O segundo BOM é interpretado como um caractere de espaço incondicional de largura zero.</span><span class="sxs-lookup"><span data-stu-id="606b0-203">The second BOM is interpreted as a zero-width nonbreaking space character.</span></span>  
  
 <span data-ttu-id="606b0-204"><sup>11</sup>O formato é UTF-16, não há especificação de codificação, um BOM é adicionado aos dados recebidos do servidor.</span><span class="sxs-lookup"><span data-stu-id="606b0-204"><sup>11</sup>Format is UTF-16, no encoding specification, a BOM is added to data received from the server.</span></span> <span data-ttu-id="606b0-205">Se uma cadeia de caracteres vazia for retornada pelo servidor, um BOM ainda será retornado para o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="606b0-205">If an empty string is returned by the server, a BOM is still returned to the application.</span></span> <span data-ttu-id="606b0-206">Se o tamanho do buffer for um número ímpar de bytes, os dados serão truncados corretamente.</span><span class="sxs-lookup"><span data-stu-id="606b0-206">If the buffer length is an odd number of bytes, the data is truncated correctly.</span></span> <span data-ttu-id="606b0-207">Se o valor inteiro for retornado em partes, elas poderão ser concatenadas para reconstituir o valor correto.</span><span class="sxs-lookup"><span data-stu-id="606b0-207">If the whole value is returned in chunks, they can be concatenated to reconstitute the correct value.</span></span>  
  
 <span data-ttu-id="606b0-208"><sup>12</sup> Se o comprimento do buffer for menor que dois caracteres – ou seja, não há espaço suficiente para terminação nula, um erro de estouro será relatado.</span><span class="sxs-lookup"><span data-stu-id="606b0-208"><sup>12</sup>If the buffer length is less than two characters--that is, not enough space for null termination--an overflow error is reported.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="606b0-209">Nenhum dado é retornado para valores de XML NULL.</span><span class="sxs-lookup"><span data-stu-id="606b0-209">No data is returned for NULL XML values.</span></span>  
  
 <span data-ttu-id="606b0-210">O padrão XML exige que o XML codificado em UTF-16 seja iniciado com um código de caractere UTF-16 com BOM 0xFEFF.</span><span class="sxs-lookup"><span data-stu-id="606b0-210">The XML standard requires UTF-16 encoded XML to start with a byte-order mark (BOM), UTF-16 character code 0xFEFF.</span></span> <span data-ttu-id="606b0-211">Ao trabalhar com associações WSTR e BSTR, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] o Native Client não exige ou adiciona uma bom, pois a codificação é implícita pela associação.</span><span class="sxs-lookup"><span data-stu-id="606b0-211">When working with WSTR and BSTR bindings, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client does not require or add a BOM as the encoding is implied by the binding.</span></span> <span data-ttu-id="606b0-212">Ao trabalhar com associações BYTES, XML ou IUNKNOWN, a intenção é proporcionar simplicidade ao lidar com outros processadores XML e sistemas de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="606b0-212">When working with BYTES, XML, or IUNKNOWN bindings, the intent is to provide simplicity in dealing with other XML processors and storage systems.</span></span> <span data-ttu-id="606b0-213">Nesse caso, um BOM deve estar presente com o XML codificado em UTF-16, e o aplicativo não precisa verificar a codificação real, porque a maioria dos processadores XML (incluindo o SQL Server) deduz a codificação inspecionando os primeiros bytes do valor.</span><span class="sxs-lookup"><span data-stu-id="606b0-213">In this case a BOM should be present with UTF-16 encoded XML, and the application need not be concerned with the actual encoding, since the majority of XML processors (including SQL Server) deduces the encoding by inspecting the first few bytes of the value.</span></span> <span data-ttu-id="606b0-214">Os dados XML recebidos do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] cliente nativo usando associações de bytes, XML ou IUnknown são sempre codificados em UTF-16 com uma bom e sem uma declaração de codificação incorporada.</span><span class="sxs-lookup"><span data-stu-id="606b0-214">XML data received from [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client using BYTES, XML, or IUNKNOWN bindings is always encoded in UTF-16 with a BOM and without an embedded encoding declaration.</span></span>  
  
 <span data-ttu-id="606b0-215">As conversões de dados fornecidas por serviços principais do OLE DB (**IDataConvert**) não são aplicáveis a DBTYPE_XML.</span><span class="sxs-lookup"><span data-stu-id="606b0-215">Data conversions supplied by OLE DB core services (**IDataConvert**) are not applicable to DBTYPE_XML.</span></span>  
  
 <span data-ttu-id="606b0-216">A validação ocorre quando os dados são enviados para o servidor.</span><span class="sxs-lookup"><span data-stu-id="606b0-216">Validation is done when data is sent to the server.</span></span> <span data-ttu-id="606b0-217">As alterações de codificação e validação do lado do cliente devem ser manipuladas pelo aplicativo, e é altamente recomendável que você não processe os dados XML diretamente, mas sim use um leitor DOM ou SAX para processá-los.</span><span class="sxs-lookup"><span data-stu-id="606b0-217">Client-side validation and encoding changes should be handled by your application, and it is strongly recommended that you not process the XML data directly, but should instead use a DOM or SAX reader to process it.</span></span>  
  
 <span data-ttu-id="606b0-218">DBTYPE_NULL e DBTYPE_EMPTY podem ser associados a parâmetros de entrada, mas não a parâmetros ou resultados de saída.</span><span class="sxs-lookup"><span data-stu-id="606b0-218">DBTYPE_NULL and DBTYPE_EMPTY can be bound for input parameters but not for output parameters or results.</span></span> <span data-ttu-id="606b0-219">Quando eles são associados para parâmetros de entrada, o status precisa ser definido como DBSTATUS_S_ISNULL ou DBSTATUS_S_DEFAULT.</span><span class="sxs-lookup"><span data-stu-id="606b0-219">When bound for input parameters the status must be set to DBSTATUS_S_ISNULL or DBSTATUS_S_DEFAULT.</span></span>  
  
 <span data-ttu-id="606b0-220">DBTYPE_XML pode ser convertido em DBTYPE_EMPTY e DBTYPE_NULL, sendo que DBTYPE_EMPTY pode ser convertido em DBTYPE_XML, mas DBTYPE_NULL não pode ser convertido em DBTYPE_XML.</span><span class="sxs-lookup"><span data-stu-id="606b0-220">DBTYPE_XML can be converted to DBTYPE_EMPTY and DBTYPE_NULL, DBTYPE_EMPTY can be converted to DBTYPE_XML, but DBTYPE_NULL cannot be converted to DBTYPE_XML.</span></span> <span data-ttu-id="606b0-221">Isso é condizente com DBTYPE_WSTR.</span><span class="sxs-lookup"><span data-stu-id="606b0-221">This is consistent with DBTYPE_WSTR.</span></span>  
  
 <span data-ttu-id="606b0-222">DBTYPE_IUNKNOWN é uma associação com suporte (conforme mostrado na tabela anterior), mas não há nenhuma conversão entre DBTYPE_XML e DBTYPE_IUNKNOWN.</span><span class="sxs-lookup"><span data-stu-id="606b0-222">DBTYPE_IUNKNOWN is a supported binding (as shown in the above table), but there are no conversions between DBTYPE_XML and DBTYPE_IUNKNOWN.</span></span> <span data-ttu-id="606b0-223">DBTYPE_IUNKNOWN não pode ser usado com DBTYPE_BYREF.</span><span class="sxs-lookup"><span data-stu-id="606b0-223">DBTYPE_IUNKNOWN may not be used with DBTYPE_BYREF.</span></span>  
  
### <a name="ole-db-rowset-additions-and-changes"></a><span data-ttu-id="606b0-224">Adições e alterações do conjunto de linhas do OLE DB</span><span class="sxs-lookup"><span data-stu-id="606b0-224">OLE DB Rowset Additions and Changes</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="606b0-225">O Native Client adiciona novos valores ou alterações a muitos dos conjuntos de linhas de esquema de OLE DB principal.</span><span class="sxs-lookup"><span data-stu-id="606b0-225">Native Client adds new values or changes to many of the core OLE DB schema rowsets.</span></span>  
  
#### <a name="the-columns-and-procedure_parameters-schema-rowsets"></a><span data-ttu-id="606b0-226">Os conjuntos de linhas de esquema de COLUMNS e PROCEDURE_PARAMETERS</span><span class="sxs-lookup"><span data-stu-id="606b0-226">The COLUMNS and PROCEDURE_PARAMETERS Schema Rowsets</span></span>  
 <span data-ttu-id="606b0-227">Entre as adições aos conjuntos de linhas de esquema de COLUMNS e PROCEDURE_PARAMETERS estão as colunas a seguir.</span><span class="sxs-lookup"><span data-stu-id="606b0-227">Additions to the COLUMNS and PROCEDURE_PARAMETERS schema rowsets include the following columns.</span></span>  
  
|<span data-ttu-id="606b0-228">Nome da coluna</span><span class="sxs-lookup"><span data-stu-id="606b0-228">Column name</span></span>|<span data-ttu-id="606b0-229">Type</span><span class="sxs-lookup"><span data-stu-id="606b0-229">Type</span></span>|<span data-ttu-id="606b0-230">Descrição</span><span class="sxs-lookup"><span data-stu-id="606b0-230">Description</span></span>|  
|-----------------|----------|-----------------|  
|<span data-ttu-id="606b0-231">SS_XML_SCHEMACOLLECTION_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="606b0-231">SS_XML_SCHEMACOLLECTION_CATALOGNAME</span></span>|<span data-ttu-id="606b0-232">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="606b0-232">DBTYPE_WSTR</span></span>|<span data-ttu-id="606b0-233">O nome de um catálogo no qual uma coleção de esquema XML é definida.</span><span class="sxs-lookup"><span data-stu-id="606b0-233">The name of a catalog in which an XML schema collection is defined.</span></span> <span data-ttu-id="606b0-234">NULL para uma coluna não XML ou coluna de XML não digitada.</span><span class="sxs-lookup"><span data-stu-id="606b0-234">NULL for a non-XML column or un-typed XML column.</span></span>|  
|<span data-ttu-id="606b0-235">SS_XML_SCHEMACOLLECTION_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="606b0-235">SS_XML_SCHEMACOLLECTION_SCHEMANAME</span></span>|<span data-ttu-id="606b0-236">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="606b0-236">DBTYPE_WSTR</span></span>|<span data-ttu-id="606b0-237">O nome de um esquema no qual uma coleção de esquema XML é definida.</span><span class="sxs-lookup"><span data-stu-id="606b0-237">The name of a schema in which an XML schema collection is defined.</span></span> <span data-ttu-id="606b0-238">NULL para uma coluna não XML ou coluna de XML não digitada.</span><span class="sxs-lookup"><span data-stu-id="606b0-238">NULL for a non-XML column or un-typed XML column.</span></span>|  
|<span data-ttu-id="606b0-239">SS_XML_SCHEMACOLLECTIONNAME</span><span class="sxs-lookup"><span data-stu-id="606b0-239">SS_XML_SCHEMACOLLECTIONNAME</span></span>|<span data-ttu-id="606b0-240">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="606b0-240">DBTYPE_WSTR</span></span>|<span data-ttu-id="606b0-241">O nome da coleção de esquemas XML.</span><span class="sxs-lookup"><span data-stu-id="606b0-241">The name of XML schema collection.</span></span> <span data-ttu-id="606b0-242">NULL para uma coluna não XML ou coluna de XML não digitada.</span><span class="sxs-lookup"><span data-stu-id="606b0-242">NULL for a non-XML column or un-typed XML column.</span></span>|  
  
#### <a name="the-provider_types-schema-rowset"></a><span data-ttu-id="606b0-243">O conjunto de linhas de esquema de PROVIDER_TYPES</span><span class="sxs-lookup"><span data-stu-id="606b0-243">The PROVIDER_TYPES Schema Rowset</span></span>  
 <span data-ttu-id="606b0-244">No conjunto de linhas de esquema de PROVIDER_TYPES, o valor de COLUMN_SIZE é 0 para o tipo de dados **xml** e o DATA_TYPE é DBTYPE_XML.</span><span class="sxs-lookup"><span data-stu-id="606b0-244">In the PROVIDER_TYPES schema rowset, the COLUMN_SIZE value is 0 for the **xml** data type, and the DATA_TYPE is DBTYPE_XML.</span></span>  
  
#### <a name="the-ss_xmlschema-schema-rowset"></a><span data-ttu-id="606b0-245">O conjunto de linhas de esquema de SS_XMLSCHEMA</span><span class="sxs-lookup"><span data-stu-id="606b0-245">The SS_XMLSCHEMA Schema Rowset</span></span>  
 <span data-ttu-id="606b0-246">Um novo conjunto de linhas de esquema de SS_XMLSCHEMA é introduzido para que os clientes recuperem as informações de esquema XML.</span><span class="sxs-lookup"><span data-stu-id="606b0-246">A new schema rowset SS_XMLSCHEMA is introduced for clients to retrieve XML schema information.</span></span> <span data-ttu-id="606b0-247">O conjunto de linhas de SS_XMLSCHEMA contém as colunas a seguir.</span><span class="sxs-lookup"><span data-stu-id="606b0-247">The SS_XMLSCHEMA rowset contains the following columns.</span></span>  
  
|<span data-ttu-id="606b0-248">Nome da coluna</span><span class="sxs-lookup"><span data-stu-id="606b0-248">Column name</span></span>|<span data-ttu-id="606b0-249">Type</span><span class="sxs-lookup"><span data-stu-id="606b0-249">Type</span></span>|<span data-ttu-id="606b0-250">Descrição</span><span class="sxs-lookup"><span data-stu-id="606b0-250">Description</span></span>|  
|-----------------|----------|-----------------|  
|<span data-ttu-id="606b0-251">SCHEMACOLLECTION_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="606b0-251">SCHEMACOLLECTION_CATALOGNAME</span></span>|<span data-ttu-id="606b0-252">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="606b0-252">DBTYPE_WSTR</span></span>|<span data-ttu-id="606b0-253">O catálogo ao qual pertence uma coleção XML.</span><span class="sxs-lookup"><span data-stu-id="606b0-253">The catalog an XML collection belongs to.</span></span>|  
|<span data-ttu-id="606b0-254">SCHEMACOLLECTION_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="606b0-254">SCHEMACOLLECTION_SCHEMANAME</span></span>|<span data-ttu-id="606b0-255">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="606b0-255">DBTYPE_WSTR</span></span>|<span data-ttu-id="606b0-256">O esquema ao qual pertence uma coleção XML.</span><span class="sxs-lookup"><span data-stu-id="606b0-256">The schema an XML collection belongs to.</span></span>|  
|<span data-ttu-id="606b0-257">SCHEMACOLLECTIONNAME</span><span class="sxs-lookup"><span data-stu-id="606b0-257">SCHEMACOLLECTIONNAME</span></span>|<span data-ttu-id="606b0-258">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="606b0-258">DBTYPE_WSTR</span></span>|<span data-ttu-id="606b0-259">O nome de uma coleção de esquemas XML para colunas de XML digitadas; ou NULL em caso contrário.</span><span class="sxs-lookup"><span data-stu-id="606b0-259">The name of an XML schema collection for typed XML columns, NULL otherwise.</span></span>|  
|<span data-ttu-id="606b0-260">TARGETNAMESPACEURI</span><span class="sxs-lookup"><span data-stu-id="606b0-260">TARGETNAMESPACEURI</span></span>|<span data-ttu-id="606b0-261">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="606b0-261">DBTYPE_WSTR</span></span>|<span data-ttu-id="606b0-262">O espaço de nome de destino de um esquema XML.</span><span class="sxs-lookup"><span data-stu-id="606b0-262">The target name space of an XML schema.</span></span>|  
|<span data-ttu-id="606b0-263">SCHEMACONTENT</span><span class="sxs-lookup"><span data-stu-id="606b0-263">SCHEMACONTENT</span></span>|<span data-ttu-id="606b0-264">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="606b0-264">DBTYPE_WSTR</span></span>|<span data-ttu-id="606b0-265">O conteúdo de esquema XML.</span><span class="sxs-lookup"><span data-stu-id="606b0-265">The XML schema content.</span></span>|  
  
 <span data-ttu-id="606b0-266">O escopo de cada esquema XML é definido por nome de catálogo, de esquema e de coleção de esquema, além de URI (identificador de recurso uniforme) de espaço de nome de destino.</span><span class="sxs-lookup"><span data-stu-id="606b0-266">Each XML schema is scoped by catalog name, schema name, schema collection name, and target name space Uniform Resource Identifier (URI).</span></span> <span data-ttu-id="606b0-267">Além disso, também é definido um novo GUID com o nome DBSCHEMA_XML_COLLECTIONS.</span><span class="sxs-lookup"><span data-stu-id="606b0-267">In addition, a new GUID with the name DBSCHEMA_XML_COLLECTIONS is also defined.</span></span> <span data-ttu-id="606b0-268">O número de restrições e colunas restringidas para o conjunto de linhas de esquema de SS_XMLSCHEMA é definido da seguinte maneira.</span><span class="sxs-lookup"><span data-stu-id="606b0-268">The number of restrictions and restricted columns for the SS_XMLSCHEMA schema rowset are defined as follows.</span></span>  
  
|<span data-ttu-id="606b0-269">GUID</span><span class="sxs-lookup"><span data-stu-id="606b0-269">GUID</span></span>|<span data-ttu-id="606b0-270">Número de restrições</span><span class="sxs-lookup"><span data-stu-id="606b0-270">Number of restrictions</span></span>|<span data-ttu-id="606b0-271">Colunas restringidas</span><span class="sxs-lookup"><span data-stu-id="606b0-271">Restricted columns</span></span>|  
|----------|----------------------------|------------------------|  
|<span data-ttu-id="606b0-272">DBSCHEMA_XML_COLLECTIONS</span><span class="sxs-lookup"><span data-stu-id="606b0-272">DBSCHEMA_XML_COLLECTIONS</span></span>|<span data-ttu-id="606b0-273">4</span><span class="sxs-lookup"><span data-stu-id="606b0-273">4</span></span>|<span data-ttu-id="606b0-274">SCHEMACOLLECTION_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="606b0-274">SCHEMACOLLECTION_CATALOGNAME</span></span><br /><br /> <span data-ttu-id="606b0-275">SCHEMACOLLECTION_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="606b0-275">SCHEMACOLLECTION_SCHEMANAME</span></span><br /><br /> <span data-ttu-id="606b0-276">SCHEMACOLLECTIONNAME</span><span class="sxs-lookup"><span data-stu-id="606b0-276">SCHEMACOLLECTIONNAME</span></span><br /><br /> <span data-ttu-id="606b0-277">TARGETNAMESPACEURI</span><span class="sxs-lookup"><span data-stu-id="606b0-277">TARGETNAMESPACEURI</span></span>|  
  
### <a name="ole-db-property-set-additions-and-changes"></a><span data-ttu-id="606b0-278">Adições e alterações do conjunto de propriedades do OLE DB</span><span class="sxs-lookup"><span data-stu-id="606b0-278">OLE DB Property Set Additions and Changes</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="606b0-279">O Native Client adiciona novos valores ou alterações a muitos dos principais conjuntos de propriedades de OLE DB.</span><span class="sxs-lookup"><span data-stu-id="606b0-279">Native Client adds new values or changes to many of the core OLE DB property sets.</span></span>  
  
#### <a name="the-dbpropset_sqlserverparameter-property-set"></a><span data-ttu-id="606b0-280">O conjunto de propriedades de DBPROPSET_SQLSERVERPARAMETER</span><span class="sxs-lookup"><span data-stu-id="606b0-280">The DBPROPSET_SQLSERVERPARAMETER Property Set</span></span>  
 <span data-ttu-id="606b0-281">Para oferecer suporte ao tipo de dados **XML** por meio do OLE DB, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] o Native Client implementa o novo conjunto de propriedades DBPROPSET_SQLSERVERPARAMETER, que contém os valores a seguir.</span><span class="sxs-lookup"><span data-stu-id="606b0-281">In order to support the **xml** data type through OLE DB, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client implements the new DBPROPSET_SQLSERVERPARAMETER property set, which contains the following values.</span></span>  
  
|<span data-ttu-id="606b0-282">Nome</span><span class="sxs-lookup"><span data-stu-id="606b0-282">Name</span></span>|<span data-ttu-id="606b0-283">Type</span><span class="sxs-lookup"><span data-stu-id="606b0-283">Type</span></span>|<span data-ttu-id="606b0-284">Descrição</span><span class="sxs-lookup"><span data-stu-id="606b0-284">Description</span></span>|  
|----------|----------|-----------------|  
|<span data-ttu-id="606b0-285">SSPROP_PARAM_XML_SCHEMACOLLECTION_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="606b0-285">SSPROP_PARAM_XML_SCHEMACOLLECTION_CATALOGNAME</span></span>|<span data-ttu-id="606b0-286">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="606b0-286">DBTYPE_WSTR</span></span>|<span data-ttu-id="606b0-287">O nome de um catálogo (banco de dados) no qual é definida uma coleção de esquemas XML.</span><span class="sxs-lookup"><span data-stu-id="606b0-287">The name of a catalog (database) in which an XML schema collection is defined.</span></span> <span data-ttu-id="606b0-288">Uma parte do identificador de nome de três partes SQL.</span><span class="sxs-lookup"><span data-stu-id="606b0-288">A part of the SQL three-part name identifier.</span></span>|  
|<span data-ttu-id="606b0-289">SSPROP_PARAM_XML_SCHEMACOLLECTION_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="606b0-289">SSPROP_PARAM_XML_SCHEMACOLLECTION_SCHEMANAME</span></span>|<span data-ttu-id="606b0-290">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="606b0-290">DBTYPE_WSTR</span></span>|<span data-ttu-id="606b0-291">O nome de um esquema XML em uma coleção de esquemas.</span><span class="sxs-lookup"><span data-stu-id="606b0-291">The name of an XML schema within the schema collection.</span></span> <span data-ttu-id="606b0-292">Uma parte do identificador de nome de três partes SQL.</span><span class="sxs-lookup"><span data-stu-id="606b0-292">A part of the SQL three -part name identifier.</span></span>|  
|<span data-ttu-id="606b0-293">SSPROP_PARAM_XML_SCHEMACOLLECTIONNAME</span><span class="sxs-lookup"><span data-stu-id="606b0-293">SSPROP_PARAM_XML_SCHEMACOLLECTIONNAME</span></span>|<span data-ttu-id="606b0-294">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="606b0-294">DBTYPE_WSTR</span></span>|<span data-ttu-id="606b0-295">O nome da coleção de esquemas XML no catálogo. Uma parte do identificador de nome de três partes SQL.</span><span class="sxs-lookup"><span data-stu-id="606b0-295">The name of the XML schema collection within the catalog A part of the SQL three -part name identifier.</span></span>|  
  
#### <a name="the-dbpropset_sqlservercolumn-property-set"></a><span data-ttu-id="606b0-296">O conjunto de propriedades de DBPROPSET_SQLSERVERCOLUMN</span><span class="sxs-lookup"><span data-stu-id="606b0-296">The DBPROPSET_SQLSERVERCOLUMN Property Set</span></span>  
 <span data-ttu-id="606b0-297">Para dar suporte à criação de tabelas na interface **ITableDefinition** , [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] o Native Client adiciona três novas colunas ao conjunto de propriedades DBPROPSET_SQLSERVERCOLUMN.</span><span class="sxs-lookup"><span data-stu-id="606b0-297">To support the creation of tables in the **ITableDefinition** interface, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client adds three new columns to the DBPROPSET_SQLSERVERCOLUMN property set.</span></span>  
  
|<span data-ttu-id="606b0-298">Nome</span><span class="sxs-lookup"><span data-stu-id="606b0-298">Name</span></span>|<span data-ttu-id="606b0-299">Type</span><span class="sxs-lookup"><span data-stu-id="606b0-299">Type</span></span>|<span data-ttu-id="606b0-300">Descrição</span><span class="sxs-lookup"><span data-stu-id="606b0-300">Description</span></span>|  
|----------|----------|-----------------|  
|<span data-ttu-id="606b0-301">SSPROP_COL_XML_SCHEMACOLLECTION_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="606b0-301">SSPROP_COL_XML_SCHEMACOLLECTION_CATALOGNAME</span></span>|<span data-ttu-id="606b0-302">VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="606b0-302">VT_BSTR</span></span>|<span data-ttu-id="606b0-303">Para colunas de XML digitadas, esta propriedade é uma cadeia de caracteres que especifica o nome do catálogo em que está armazenado o esquema XML.</span><span class="sxs-lookup"><span data-stu-id="606b0-303">For typed XML columns, this property is a string specifying the name of the catalog where the XML schema is stored.</span></span> <span data-ttu-id="606b0-304">Para outros tipos de coluna, esta propriedade retorna uma cadeia de caracteres vazia.</span><span class="sxs-lookup"><span data-stu-id="606b0-304">For other column types this property returns an empty string.</span></span>|  
|<span data-ttu-id="606b0-305">SSPROP_COL_XML_SCHEMACOLLECTION_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="606b0-305">SSPROP_COL_XML_SCHEMACOLLECTION_SCHEMANAME</span></span>|<span data-ttu-id="606b0-306">VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="606b0-306">VT_BSTR</span></span>|<span data-ttu-id="606b0-307">Para colunas de XML digitadas, esta propriedade é uma cadeia de caracteres que especifica o nome do esquema XML que define esta coluna.</span><span class="sxs-lookup"><span data-stu-id="606b0-307">For typed XML columns, this property is a string specifying the name of XML schema that defines this column.</span></span>|  
|<span data-ttu-id="606b0-308">SSPROP_COL_XML_SCHEMACOLLECTIONNAME</span><span class="sxs-lookup"><span data-stu-id="606b0-308">SSPROP_COL_XML_SCHEMACOLLECTIONNAME</span></span>|<span data-ttu-id="606b0-309">VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="606b0-309">VT_BSTR</span></span>|<span data-ttu-id="606b0-310">Para colunas de XML digitadas, esta propriedade é uma cadeia de caracteres que especifica o nome da coleção de esquemas XML do esquema que define o valor.</span><span class="sxs-lookup"><span data-stu-id="606b0-310">For typed XML columns, this property is a string specifying the name of the schema XML schema collection defining the value.</span></span>|  
  
 <span data-ttu-id="606b0-311">Assim como os valores de SSPROP_PARAM, todas essas propriedades são opcionais e o padrão é vazio.</span><span class="sxs-lookup"><span data-stu-id="606b0-311">Like the SSPROP_PARAM values, all of these properties are optional and default to empty.</span></span> <span data-ttu-id="606b0-312">SSPROP_COL_XML_SCHEMACOLLECTION_CATALOGNAME e SSPROP_COL_XML_SCHEMACOLLECTION_SCHEMANAME só poderão ser especificados se SSPROP_COL_XML_SCHEMACOLLECTIONNAME for especificado.</span><span class="sxs-lookup"><span data-stu-id="606b0-312">SSPROP_COL_XML_SCHEMACOLLECTION_CATALOGNAME and SSPROP_COL_XML_SCHEMACOLLECTION_SCHEMANAME may only be specified if SSPROP_COL_XML_SCHEMACOLLECTIONNAME is specified.</span></span> <span data-ttu-id="606b0-313">Na passagem do XML para o servidor, se esses valores forem incluídos, serão verificados quanto à existência (validade) com base no banco de dados atual, e os dados de instância serão verificados com base no esquema.</span><span class="sxs-lookup"><span data-stu-id="606b0-313">When passing XML to the server, if these values are included they are checked for existence (validity) against the current database and the instance data is checked against the schema.</span></span> <span data-ttu-id="606b0-314">Em todos os casos, para que sejam válidos eles ficam todos vazios ou todos preenchidos.</span><span class="sxs-lookup"><span data-stu-id="606b0-314">In all cases, to be valid they are either all empty or all filled in.</span></span>  
  
### <a name="ole-db-interface-additions-and-changes"></a><span data-ttu-id="606b0-315">Adições e alterações de interface do OLE DB</span><span class="sxs-lookup"><span data-stu-id="606b0-315">OLE DB Interface Additions and Changes</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="606b0-316">O Native Client adiciona novos valores ou alterações a muitas das principais interfaces de OLE DB.</span><span class="sxs-lookup"><span data-stu-id="606b0-316">Native Client adds new values or changes to many of the core OLE DB interfaces.</span></span>  
  
#### <a name="the-isscommandwithparameters-interface"></a><span data-ttu-id="606b0-317">A interface ISSCommandWithParameters</span><span class="sxs-lookup"><span data-stu-id="606b0-317">The ISSCommandWithParameters Interface</span></span>  
 <span data-ttu-id="606b0-318">Para oferecer suporte ao tipo de dados **XML** por meio do OLE DB, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] o Native Client implementa várias alterações, incluindo a adição da interface [ISSCommandWithParameters](../../native-client-ole-db-interfaces/isscommandwithparameters-ole-db.md) .</span><span class="sxs-lookup"><span data-stu-id="606b0-318">In order to support the **xml** data type through OLE DB, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client implements a number of changes including the addition of the [ISSCommandWithParameters](../../native-client-ole-db-interfaces/isscommandwithparameters-ole-db.md) interface.</span></span> <span data-ttu-id="606b0-319">Essa nova interface herda as propriedades da interface principal do OLE DB **ICommandWithParameters**.</span><span class="sxs-lookup"><span data-stu-id="606b0-319">This new interface inherits from the core OLE DB interface **ICommandWithParameters**.</span></span> <span data-ttu-id="606b0-320">Além dos três métodos herdados de **ICommandWithParameters**; **GetParameterInfo**, **MapParameterNames**e **SetParameterInfo**; **ISSCommandWithParameters** fornece os métodos [ParameterProperties](../../native-client-ole-db-interfaces/isscommandwithparameters-getparameterproperties-ole-db.md) e [ParameterProperties](../../native-client-ole-db-interfaces/isscommandwithparameters-setparameterproperties-ole-db.md) que são usados para tratar tipos de dados específicos do servidor.</span><span class="sxs-lookup"><span data-stu-id="606b0-320">In addition to the three methods inherited from **ICommandWithParameters**; **GetParameterInfo**, **MapParameterNames**, and **SetParameterInfo**; **ISSCommandWithParameters** provides the [GetParameterProperties](../../native-client-ole-db-interfaces/isscommandwithparameters-getparameterproperties-ole-db.md) and [SetParameterProperties](../../native-client-ole-db-interfaces/isscommandwithparameters-setparameterproperties-ole-db.md) methods that are used to handle server specific data types.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="606b0-321">A interface **ISSCommandWithParameters** também usa a nova estrutura SSPARAMPROPS.</span><span class="sxs-lookup"><span data-stu-id="606b0-321">The **ISSCommandWithParameters** interface also makes use of the new SSPARAMPROPS structure.</span></span>  
  
#### <a name="the-icolumnsrowset-interface"></a><span data-ttu-id="606b0-322">A interface IColumnsRowset</span><span class="sxs-lookup"><span data-stu-id="606b0-322">The IColumnsRowset Interface</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="606b0-323">O Native Client adiciona as seguintes [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] colunas específicas ao conjunto de linhas retornado pelo método **IColumnRowset:: GetColumnsRowset** .</span><span class="sxs-lookup"><span data-stu-id="606b0-323">Native Client adds the following [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]-specific columns to the rowset returned by the **IColumnRowset::GetColumnsRowset** method.</span></span> <span data-ttu-id="606b0-324">Estas colunas contêm o nome de três partes de uma coleção de esquemas XML.</span><span class="sxs-lookup"><span data-stu-id="606b0-324">These columns contain the three-part name of an XML schema collection.</span></span> <span data-ttu-id="606b0-325">Para colunas não XML ou colunas de XML não digitadas, as três colunas assumem o valor padrão de NULL.</span><span class="sxs-lookup"><span data-stu-id="606b0-325">For non-XML columns or untyped XML columns, all three columns take the default value of NULL.</span></span>  
  
|<span data-ttu-id="606b0-326">Nome da coluna</span><span class="sxs-lookup"><span data-stu-id="606b0-326">Column name</span></span>|<span data-ttu-id="606b0-327">Type</span><span class="sxs-lookup"><span data-stu-id="606b0-327">Type</span></span>|<span data-ttu-id="606b0-328">Descrição</span><span class="sxs-lookup"><span data-stu-id="606b0-328">Description</span></span>|  
|-----------------|----------|-----------------|  
|<span data-ttu-id="606b0-329">DBCOLUMN_SS_XML_SCHEMACOLLECTION_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="606b0-329">DBCOLUMN_SS_XML_SCHEMACOLLECTION_CATALOGNAME</span></span>|<span data-ttu-id="606b0-330">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="606b0-330">DBTYPE_WSTR</span></span>|<span data-ttu-id="606b0-331">O catálogo ao qual pertence uma coleção de esquema XML;</span><span class="sxs-lookup"><span data-stu-id="606b0-331">The catalog an XML schema collection belongs to,</span></span><br /><br /> <span data-ttu-id="606b0-332">NULL em caso contrário.</span><span class="sxs-lookup"><span data-stu-id="606b0-332">NULL otherwise.</span></span>|  
|<span data-ttu-id="606b0-333">DBCOLUMN_SS_XML_SCHEMACOLLECTION_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="606b0-333">DBCOLUMN_SS_XML_SCHEMACOLLECTION_SCHEMANAME</span></span>|<span data-ttu-id="606b0-334">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="606b0-334">DBTYPE_WSTR</span></span>|<span data-ttu-id="606b0-335">O esquema ao qual pertence uma coleção de esquemas XML.</span><span class="sxs-lookup"><span data-stu-id="606b0-335">The schema an XML schema collection belongs to.</span></span> <span data-ttu-id="606b0-336">NULL em caso contrário.</span><span class="sxs-lookup"><span data-stu-id="606b0-336">NULL otherwise.</span></span>|  
|<span data-ttu-id="606b0-337">DBCOLUMN_SS_XML_SCHEMACOLLECTIONNAME</span><span class="sxs-lookup"><span data-stu-id="606b0-337">DBCOLUMN_SS_XML_SCHEMACOLLECTIONNAME</span></span>|<span data-ttu-id="606b0-338">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="606b0-338">DBTYPE_WSTR</span></span>|<span data-ttu-id="606b0-339">O nome da coleção de esquemas XML para a coluna de XML digitada; ou NULL em caso contrário.</span><span class="sxs-lookup"><span data-stu-id="606b0-339">The name of XML schema collection for typed XML column, NULL otherwise.</span></span>|  
  
#### <a name="the-irowset-interface"></a><span data-ttu-id="606b0-340">A interface IRowset</span><span class="sxs-lookup"><span data-stu-id="606b0-340">The IRowset Interface</span></span>  
 <span data-ttu-id="606b0-341">Uma instância XML em uma coluna XML é recuperada por meio do método **IRowset::GetData**.</span><span class="sxs-lookup"><span data-stu-id="606b0-341">An XML instance in an XML column is retrieved through the **IRowset::GetData** method.</span></span> <span data-ttu-id="606b0-342">Dependendo da associação especificada pelo cliente, uma instância de XML pode ser recuperada como DBTYPE_BSTR, DBTYPE_WSTR, DBTYPE_VARIANT, DBTYPE_XML, DBTYPE_STR, DBTYPE_BYTES ou como uma interface via DBTYPE_IUNKNOWN.</span><span class="sxs-lookup"><span data-stu-id="606b0-342">Depending on the binding specified by the client, an XML instance can be retrieved as DBTYPE_BSTR, DBTYPE_WSTR, DBTYPE_VARIANT, DBTYPE_XML, DBTYPE_STR, DBTYPE_BYTES, or as an interface via DBTYPE_IUNKNOWN.</span></span> <span data-ttu-id="606b0-343">Se o consumidor especificar DBTYPE_BSTR, DBTYPE_WSTR ou DBTYPE_VARIANT, o provedor converterá a instância de XML para o tipo solicitado pelo usuário e a colocará no local especificado na associação correspondente.</span><span class="sxs-lookup"><span data-stu-id="606b0-343">If the consumer specifies DBTYPE_BSTR, DBTYPE_WSTR, or DBTYPE_VARIANT, the provider converts the XML instance to the user requested type and put it into the location specified in the corresponding binding.</span></span>  
  
 <span data-ttu-id="606b0-344">Se o consumidor especificar DBTYPE_IUNKNOWN e definir o argumento *pObject* como NULL ou definir o argumento *pObject* como IID_ISequentialStream, o provedor retornará uma interface **ISequentialStream** para o consumidor, de modo que ele possa transmitir os dados XML da coluna.</span><span class="sxs-lookup"><span data-stu-id="606b0-344">If the consumer specifies DBTYPE_IUNKNOWN and sets the *pObject* argument to NULL, or sets the *pObject* argument to IID_ISequentialStream, the provider returns an **ISequentialStream** interface to the consumer so that the consumer can stream the XML data out of the column.</span></span> <span data-ttu-id="606b0-345">Em seguida, **ISequentialStream** retornará os dados XML como um fluxo de caracteres Unicode.</span><span class="sxs-lookup"><span data-stu-id="606b0-345">**ISequentialStream** then returns the XML data as a Unicode character stream.</span></span>  
  
 <span data-ttu-id="606b0-346">Ao retornar um valor XML associado a DBTYPE_IUNKNOWN, o provedor informará um valor de tamanho de `sizeof (IUnknown *)`.</span><span class="sxs-lookup"><span data-stu-id="606b0-346">When returning an XML value bound to DBTYPE_IUNKNOWN, the provider reports a size value of `sizeof (IUnknown *)`.</span></span> <span data-ttu-id="606b0-347">Observe que esse procedimento é condizente com a abordagem adotada quando uma coluna é associada como DBTYPE_IUnknown ou DBTYPE_IDISPATCH e por DBTYPE_IUNKNOWN/ISequentialStream quando não é possível determinar o tamanho exato da coluna.</span><span class="sxs-lookup"><span data-stu-id="606b0-347">Note that this is consistent with the approach taken when a column is bound as DBTYPE_IUnknown or DBTYPE_IDISPATCH, and by DBTYPE_IUNKNOWN/ISequentialStream when the exact column size cannot be determined.</span></span>  
  
#### <a name="the-irowsetchange-interface"></a><span data-ttu-id="606b0-348">A interface IRowsetChange</span><span class="sxs-lookup"><span data-stu-id="606b0-348">The IRowsetChange Interface</span></span>  
 <span data-ttu-id="606b0-349">Há duas maneiras de um consumidor atualizar uma instância de XML em uma coluna.</span><span class="sxs-lookup"><span data-stu-id="606b0-349">There are two ways a consumer can update an XML instance in a column.</span></span> <span data-ttu-id="606b0-350">A primeira é pelo objeto de armazenamento **ISequentialStream** criado pelo provedor.</span><span class="sxs-lookup"><span data-stu-id="606b0-350">The first one is through the storage object **ISequentialStream** created by the provider.</span></span> <span data-ttu-id="606b0-351">O consumidor pode chamar o método **ISequentialStream::Write** para atualizar diretamente a instância de XML retornada pelo provedor.</span><span class="sxs-lookup"><span data-stu-id="606b0-351">The consumer can call the **ISequentialStream::Write** method to directly update the XML instance returned by the provider.</span></span>  
  
 <span data-ttu-id="606b0-352">A segunda abordagem é pelos métodos **IRowsetChange::SetData** ou **IRowsetChange::InsertRow**.</span><span class="sxs-lookup"><span data-stu-id="606b0-352">The second approach is through **IRowsetChange::SetData** or **IRowsetChange::InsertRow** methods.</span></span> <span data-ttu-id="606b0-353">Nessa abordagem, uma instância de XML no buffer do consumidor pode ser especificada em uma associação de tipo DBTYPE_BSTR, DBTYPE_WSTR, DBTYPE_VARIANT, DBTYPE_XML ou DBTYPE_IUNKNOWN.</span><span class="sxs-lookup"><span data-stu-id="606b0-353">In this approach, an XML instance in the consumer's buffer can be specified in a binding of type DBTYPE_BSTR, DBTYPE_WSTR, DBTYPE_VARIANT, DBTYPE_XML or DBTYPE_IUNKNOWN.</span></span>  
  
 <span data-ttu-id="606b0-354">No caso de DBTYPE_BSTR, DBTYPE_WSTR ou DBTYPE_VARIANT, o provedor armazena a instância de XML que reside no buffer do consumidor na coluna adequada.</span><span class="sxs-lookup"><span data-stu-id="606b0-354">In case of DBTYPE_BSTR, DBTYPE_WSTR, or DBTYPE_VARIANT, the provider stores the XML instance residing in the consumer buffer into the proper column.</span></span>  
  
 <span data-ttu-id="606b0-355">No caso de DBTYPE_IUNKNOWN/ISequentialStream, se o consumidor não especificar nenhum objeto de armazenamento, o consumidor deverá criar um objeto **ISequentialStream** com antecedência, associar o documento XML ao objeto e, em seguida, passar o objeto para o provedor por meio do método **IRowsetChange:: SetData** .</span><span class="sxs-lookup"><span data-stu-id="606b0-355">In the case of DBTYPE_IUNKNOWN/ISequentialStream, if the consumer does not specify any storage object, the consumer must create an **ISequentialStream** object in advance, bind the XML document with the object, and then pass the object to the provider through the **IRowsetChange::SetData** method.</span></span> <span data-ttu-id="606b0-356">O consumidor também pode criar um objeto de armazenamento, definir o argumento pObject como IID_ISequentialStream, criar um objeto **ISequentialStream** e, em seguida, passar o objeto **ISequentialStream** para o método **IRowsetChange::SetData**.</span><span class="sxs-lookup"><span data-stu-id="606b0-356">The consumer can also create a storage object, set the pObject argument to IID_ISequentialStream, create an **ISequentialStream** object and then pass the **ISequentialStream** object to the **IRowsetChange::SetData** method.</span></span> <span data-ttu-id="606b0-357">Em ambos os casos, o provedor pode recuperar o objeto XML pelo objeto **ISequentialStream** e inseri-lo em uma coluna adequada.</span><span class="sxs-lookup"><span data-stu-id="606b0-357">In both cases, the provider can retrieve the XML object through the **ISequentialStream** object and insert it into a proper column.</span></span>  
  
#### <a name="the-irowsetupdate-interface"></a><span data-ttu-id="606b0-358">A interface IRowsetUpdate</span><span class="sxs-lookup"><span data-stu-id="606b0-358">The IRowsetUpdate Interface</span></span>  
 <span data-ttu-id="606b0-359">A interface **IRowsetUpdate** oferece funcionalidade para atualizações atrasadas.</span><span class="sxs-lookup"><span data-stu-id="606b0-359">**IRowsetUpdate** interface provides functionality for delayed updates.</span></span> <span data-ttu-id="606b0-360">Os dados disponibilizados para os conjuntos de linhas não são disponibilizados para outras transações até que o consumidor chame o método **IRowsetUpdate: Update** .</span><span class="sxs-lookup"><span data-stu-id="606b0-360">The data made available to the rowsets is not made available to other transactions until the consumer calls the **IRowsetUpdate:Update** method.</span></span>  
  
#### <a name="the-irowsetfind-interface"></a><span data-ttu-id="606b0-361">A interface IRowsetFind</span><span class="sxs-lookup"><span data-stu-id="606b0-361">The IRowsetFind Interface</span></span>  
 <span data-ttu-id="606b0-362">O método **IRowsetFind::FindNextRow** não funciona com o tipo de dados **xml**.</span><span class="sxs-lookup"><span data-stu-id="606b0-362">The **IRowsetFind::FindNextRow** method does not work with the **xml** data type.</span></span> <span data-ttu-id="606b0-363">Quando **IRowsetFind::FindNextRow** é chamado e o argumento *hAccessor* especifica uma coluna de DBTYPE_XML, DB_E_BADBINDINFO é retornado.</span><span class="sxs-lookup"><span data-stu-id="606b0-363">When **IRowsetFind::FindNextRow** is called and the *hAccessor* argument specifies a column of DBTYPE_XML, DB_E_BADBINDINFO is returned.</span></span> <span data-ttu-id="606b0-364">Isso ocorre independentemente do tipo de coluna que está sendo pesquisada.</span><span class="sxs-lookup"><span data-stu-id="606b0-364">This occurs regardless of the type of column that is being searched.</span></span> <span data-ttu-id="606b0-365">Para qualquer outro tipo de associação, **FindNextRow** falha com DB_E_BADCOMPAREOP se a coluna a ser pesquisada é do tipo de dados **xml**.</span><span class="sxs-lookup"><span data-stu-id="606b0-365">For any other binding type, the **FindNextRow** fails with DB_E_BADCOMPAREOP if the column to be searched is of the **xml** data type.</span></span>  
  
## <a name="sql-server-native-client-odbc-driver"></a><span data-ttu-id="606b0-366">Driver ODBC do SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="606b0-366">SQL Server Native Client ODBC Driver</span></span>  
 <span data-ttu-id="606b0-367">No [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] driver ODBC do Native Client, várias alterações foram feitas em diversas funções para dar suporte ao tipo de dados **XML** .</span><span class="sxs-lookup"><span data-stu-id="606b0-367">In the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver, a number of changes have been made to various functions to support the **xml** data type.</span></span>  
  
### <a name="sqlcolattribute"></a><span data-ttu-id="606b0-368">SQLColAttribute</span><span class="sxs-lookup"><span data-stu-id="606b0-368">SQLColAttribute</span></span>  
 <span data-ttu-id="606b0-369">A função [SQLColAttribute](../../native-client-odbc-api/sqlcolattribute.md) tem três novos identificadores de campo, incluindo SQL_CA_SS_XML_SCHEMACOLLECTION_CATALOG_NAME, SQL_CA_SS_XML_SCHEMACOLLECTION_SCHEMA_NAME e SQL_CA_SS _XML_SCHEMACOLLECTION_NAME.</span><span class="sxs-lookup"><span data-stu-id="606b0-369">The [SQLColAttribute](../../native-client-odbc-api/sqlcolattribute.md) function has three new field identifiers, including SQL_CA_SS_XML_SCHEMACOLLECTION_CATALOG_NAME, SQL_CA_SS_XML_SCHEMACOLLECTION_SCHEMA_NAME, and SQL_CA_SS _XML_SCHEMACOLLECTION_NAME.</span></span>  
  
 <span data-ttu-id="606b0-370">O [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] driver ODBC do Native Client relata SQL_SS_LENGTH_UNLIMITED para as colunas SQL_DESC_DISPLAY_SIZE e SQL_DESC_LENGTH.</span><span class="sxs-lookup"><span data-stu-id="606b0-370">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver reports SQL_SS_LENGTH_UNLIMITED for the SQL_DESC_DISPLAY_SIZE and SQL_DESC_LENGTH columns.</span></span>  
  
### <a name="sqlcolumns"></a><span data-ttu-id="606b0-371">SQLColumns</span><span class="sxs-lookup"><span data-stu-id="606b0-371">SQLColumns</span></span>  
 <span data-ttu-id="606b0-372">A função [SQLColumns](../../native-client-odbc-api/sqlcolumns.md) tem três novas colunas, incluindo SS_XML_SCHEMACOLLECTION_CATALOG_NAME, SS_XML_SCHEMACOLLECTION_SCHEMA_NAME e SS_XML_SCHEMACOLLECTION_NAME.</span><span class="sxs-lookup"><span data-stu-id="606b0-372">The [SQLColumns](../../native-client-odbc-api/sqlcolumns.md) function has three new columns including SS_XML_SCHEMACOLLECTION_CATALOG_NAME, SS_XML_SCHEMACOLLECTION_SCHEMA_NAME, and SS_XML_SCHEMACOLLECTION_NAME.</span></span> <span data-ttu-id="606b0-373">A coluna TYPE_NAME existente é usada para indicar o nome do tipo de XM, e o DATA_TYPE para um parâmetro ou coluna de tipo de XML é SQL_SS_XML.</span><span class="sxs-lookup"><span data-stu-id="606b0-373">The existing TYPE_NAME column is used to indicate the name of the XML type, and the DATA_TYPE for a XML type column or parameter is SQL_SS_XML.</span></span>  
  
 <span data-ttu-id="606b0-374">O [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] driver ODBC do Native Client relata SQL_SS_LENGTH_UNLIMITED para os valores de COLUMN_SIZE e CHAR_OCTET_LENGTH.</span><span class="sxs-lookup"><span data-stu-id="606b0-374">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver reports SQL_SS_LENGTH_UNLIMITED for the COLUMN_SIZE and CHAR_OCTET_LENGTH values.</span></span>  
  
### <a name="sqldescribecol"></a><span data-ttu-id="606b0-375">SQLDescribeCol</span><span class="sxs-lookup"><span data-stu-id="606b0-375">SQLDescribeCol</span></span>  
 <span data-ttu-id="606b0-376">O [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] driver ODBC do Native Client relata SQL_SS_LENGTH_UNLIMITED quando o tamanho da coluna não pode ser determinado na função [SQLDescribeCol](../../native-client-odbc-api/sqldescribecol.md) .</span><span class="sxs-lookup"><span data-stu-id="606b0-376">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver reports SQL_SS_LENGTH_UNLIMITED when the column size cannot be determined in the [SQLDescribeCol](../../native-client-odbc-api/sqldescribecol.md) function.</span></span>  
  
### <a name="sqlgettypeinfo"></a><span data-ttu-id="606b0-377">SQLGetTypeInfo</span><span class="sxs-lookup"><span data-stu-id="606b0-377">SQLGetTypeInfo</span></span>  
 <span data-ttu-id="606b0-378">O [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] driver ODBC do Native Client relata SQL_SS_LENGTH_UNLIMITED como o COLUMN_SIZE máximo para o tipo de dados **XML** na função [SQLGetTypeInfo](../../native-client-odbc-api/sqlgettypeinfo.md) .</span><span class="sxs-lookup"><span data-stu-id="606b0-378">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver reports SQL_SS_LENGTH_UNLIMITED as the maximum COLUMN_SIZE for the **xml** data type in the [SQLGetTypeInfo](../../native-client-odbc-api/sqlgettypeinfo.md) function.</span></span>  
  
### <a name="sqlprocedurecolumns"></a><span data-ttu-id="606b0-379">SQLProcedureColumns</span><span class="sxs-lookup"><span data-stu-id="606b0-379">SQLProcedureColumns</span></span>  
 <span data-ttu-id="606b0-380">A função [SQLProcedureColumns](../../native-client-odbc-api/sqlprocedurecolumns.md) tem as mesmas inclusões de coluna que a função **SQLColumns** .</span><span class="sxs-lookup"><span data-stu-id="606b0-380">The [SQLProcedureColumns](../../native-client-odbc-api/sqlprocedurecolumns.md) function has the same column additions as the **SQLColumns** function.</span></span>  
  
 <span data-ttu-id="606b0-381">O [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] driver ODBC do Native Client relata SQL_SS_LENGTH_UNLIMITED como o COLUMN_SIZE máximo para o tipo de dados **XML** .</span><span class="sxs-lookup"><span data-stu-id="606b0-381">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver reports SQL_SS_LENGTH_UNLIMITED as the maximum COLUMN_SIZE for the **xml** data type.</span></span>  
  
### <a name="supported-conversions"></a><span data-ttu-id="606b0-382">Conversões com suporte</span><span class="sxs-lookup"><span data-stu-id="606b0-382">Supported Conversions</span></span>  
 <span data-ttu-id="606b0-383">Ao converter de tipos de dados SQL para C, é possível converter SQL_C_WCHAR, SQL_C_BINARY e SQL_C_CHAR em SQL_SS_XML, com as estipulações a seguir:</span><span class="sxs-lookup"><span data-stu-id="606b0-383">When converting from SQL to C data types, SQL_C_WCHAR, SQL_C_BINARY, and SQL_C_CHAR can all be converted to SQL_SS_XML, with the following stipulations:</span></span>  
  
-   <span data-ttu-id="606b0-384">SQL_C_WCHAR: o formato é UTF-16, não há BOM, há terminação nula.</span><span class="sxs-lookup"><span data-stu-id="606b0-384">SQL_C_WCHAR: Format is UTF-16, no byte-order mark (BOM), with null termination.</span></span>  
  
-   <span data-ttu-id="606b0-385">SQL_C_BINARY: o formato é UTF-16, não há terminação nula.</span><span class="sxs-lookup"><span data-stu-id="606b0-385">SQL_C_BINARY: Format is UTF-16, with no null termination.</span></span> <span data-ttu-id="606b0-386">Um BOM é adicionado aos dados recebidos do servidor.</span><span class="sxs-lookup"><span data-stu-id="606b0-386">A BOM is added to data received from the server.</span></span> <span data-ttu-id="606b0-387">Se uma cadeia de caracteres vazia for retornada pelo servidor, um BOM ainda será retornado para o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="606b0-387">If an empty string is returned by the server a BOM is still returned to the application.</span></span> <span data-ttu-id="606b0-388">Se a extensão do buffer for um número ímpar de bytes, os dados serão truncados corretamente.</span><span class="sxs-lookup"><span data-stu-id="606b0-388">If the buffer length is an odd number of bytes the data ise truncated correctly.</span></span> <span data-ttu-id="606b0-389">Se o valor inteiro for retornado em partes, elas poderão ser concatenadas para reconstituir o valor correto.</span><span class="sxs-lookup"><span data-stu-id="606b0-389">If the whole value is returned in chunks they can be concatenated to re-constitute the correct value</span></span>  
  
-   <span data-ttu-id="606b0-390">SQL_C_CHAR: o formato consiste em caracteres multibyte codificados em página de código de cliente com terminação nula.</span><span class="sxs-lookup"><span data-stu-id="606b0-390">SQL_C_CHAR: Format is multibyte characters encoded in client code page with null termination.</span></span> <span data-ttu-id="606b0-391">A conversão a partir do UTF-16 fornecido pelo servidor pode causar corrompimento dos dados, por isso essa associação é altamente desestimulada.</span><span class="sxs-lookup"><span data-stu-id="606b0-391">Conversion from server supplied UTF-16 may cause data corruption, so this binding is strongly discouraged.</span></span>  
  
 <span data-ttu-id="606b0-392">Ao converter de tipos de dados C para SQL, é possível converter SQL_C_WCHAR, SQL_C_BINARY e SQL_C_CHAR em SQL_SS_XML, com as estipulações a seguir:</span><span class="sxs-lookup"><span data-stu-id="606b0-392">When converting from C to SQL data types, SQL_C_WCHAR, SQL_C_BINARY, and SQL_C_CHAR can all be converted to SQL_SS_XML, with the following stipulations:</span></span>  
  
-   <span data-ttu-id="606b0-393">SQL_C_WCHAR: um BOM sempre é adicionado aos dados enviados para o servidor.</span><span class="sxs-lookup"><span data-stu-id="606b0-393">SQL_C_WCHAR: A BOM is always be added to data sent to the server.</span></span> <span data-ttu-id="606b0-394">Se os dados já forem iniciados com um BOM, isso resultará em dois BOMs no início do buffer.</span><span class="sxs-lookup"><span data-stu-id="606b0-394">If the data already started with a BOM, this results in two BOMs at the start of the buffer.</span></span> <span data-ttu-id="606b0-395">O servidor usa o primeiro BOM para reconhecer a codificação como UTF-16 e então o descarta.</span><span class="sxs-lookup"><span data-stu-id="606b0-395">The server uses the first BOM to recognize the encoding as UTF-16 and then discard it.</span></span> <span data-ttu-id="606b0-396">O segundo BOM é interpretado como um caractere de espaço incondicional de largura zero.</span><span class="sxs-lookup"><span data-stu-id="606b0-396">The second BOM is interpreted as a zero-width nonbreaking space character.</span></span>  
  
-   <span data-ttu-id="606b0-397">SQL_C_BINARY: nenhuma conversão é executada e os dados são passados para o servidor "no estado atual".</span><span class="sxs-lookup"><span data-stu-id="606b0-397">SQL_C_BINARY: No conversion is performed, and the data is passed to the server "as is."</span></span> <span data-ttu-id="606b0-398">Os dados UTF-16 precisam ser iniciados com um BOM; senão, a codificação poderá não ser reconhecida corretamente pelo servidor.</span><span class="sxs-lookup"><span data-stu-id="606b0-398">UTF-16 data must start with a BOM; if it does not, the encoding may not be correctly recognized by the server.</span></span>  
  
-   <span data-ttu-id="606b0-399">SQL_C_CHAR: os dados são convertidos em UTF-16 no cliente e enviados para o servidor da mesma maneira que SQL_C_WCHAR (inclusive a adição de um BOM).</span><span class="sxs-lookup"><span data-stu-id="606b0-399">SQL_C_CHAR: The data is converted to UTF-16 on the client and sent to the server just as SQL_C_WCHAR (including the addition of a BOM).</span></span> <span data-ttu-id="606b0-400">Se o XML não for codificado na página de código de cliente, isso poderá causar corrompimento dos dados.</span><span class="sxs-lookup"><span data-stu-id="606b0-400">If the XML is not encoded in the client code page this can cause data corruption.</span></span>  
  
 <span data-ttu-id="606b0-401">O padrão XML exige que o XML codificado em UTF-16 seja iniciado com um código de caractere UTF-16 com BOM 0xFEFF.</span><span class="sxs-lookup"><span data-stu-id="606b0-401">The XML standard requires UTF-16 encoded XML to start with a byte-order mark (BOM), UTF-16 character code 0xFEFF.</span></span> <span data-ttu-id="606b0-402">Ao trabalhar com uma associação de SQL_C_BINARY, o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client não exige ou adiciona uma bom, pois a codificação é implícita pela associação.</span><span class="sxs-lookup"><span data-stu-id="606b0-402">When working with a SQL_C_BINARY binding, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client does not require or add a BOM, as the encoding is implied by the binding.</span></span> <span data-ttu-id="606b0-403">A intenção é proporcionar simplicidade ao lidar com outros processadores XML e sistemas de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="606b0-403">The intent is to provide simplicity in dealing with other XML processors and storage systems.</span></span> <span data-ttu-id="606b0-404">Nesse caso, um BOM deve estar presente com o XML codificado em UTF-16, e o aplicativo não precisa verificar a codificação real, porque a maioria dos processadores XML (incluindo o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]) deduz a codificação inspecionando os primeiros bytes do valor.</span><span class="sxs-lookup"><span data-stu-id="606b0-404">In this case a BOM should be present with UTF-16 encoded XML, and the application need not be concerned with the actual encoding, because the majority of XML processors (including [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]) deduce the encoding by inspecting the first few bytes of the value.</span></span> <span data-ttu-id="606b0-405">Os dados XML recebidos do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] cliente nativo usando associações de SQL_C_BINARY são sempre codificados em UTF-16 com uma bom e sem uma declaração de codificação inserida.</span><span class="sxs-lookup"><span data-stu-id="606b0-405">XML data received from [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client using SQL_C_BINARY bindings are always encoded in UTF-16 with a BOM and without an embedded encoding declaration.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="606b0-406">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="606b0-406">See Also</span></span>  
 <span data-ttu-id="606b0-407">[Recursos do SQL Server Native Client](sql-server-native-client-features.md) </span><span class="sxs-lookup"><span data-stu-id="606b0-407">[SQL Server Native Client Features](sql-server-native-client-features.md) </span></span>  
 [<span data-ttu-id="606b0-408">ISSCommandWithParameters &#40;OLE DB&#41;</span><span class="sxs-lookup"><span data-stu-id="606b0-408">ISSCommandWithParameters &#40;OLE DB&#41;</span></span>](../../native-client-ole-db-interfaces/isscommandwithparameters-ole-db.md)  
  
  
