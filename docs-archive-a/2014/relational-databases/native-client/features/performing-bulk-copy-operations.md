---
title: Executando operações de cópia em massa | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- bulk copy [SQL Server Native Client]
- data access [SQL Server Native Client], bulk copy operations
- SQL Server Native Client, bulk copy operations
- SQLNCLI, bulk copy operations
ms.assetid: 50d8456b-e6a1-4b25-bc7e-56946ed654a7
author: rothja
ms.author: jroth
ms.openlocfilehash: 51a4cd3ebd4cb2e16baa75a268bf307a549a694b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87570672"
---
# <a name="performing-bulk-copy-operations"></a><span data-ttu-id="2ed1d-102">Executando operações de cópia em massa</span><span class="sxs-lookup"><span data-stu-id="2ed1d-102">Performing Bulk Copy Operations</span></span>
  <span data-ttu-id="2ed1d-103">O recurso de cópia em massa do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] suporta a transferência de grandes quantidades de dados de ou para uma tabela ou exibição do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2ed1d-103">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] bulk copy feature supports the transfer of large amounts of data into or out of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] table or view.</span></span> <span data-ttu-id="2ed1d-104">Os dados também podem ser transferidos com a especificação de uma instrução SELECT.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-104">Data can also be transferred out by specifying a SELECT statement.</span></span> <span data-ttu-id="2ed1d-105">É possível mover os dados entre o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] e um arquivo de dados do sistema operacional, como um arquivo ASCII.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-105">The data can be moved between [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] and an operating-system data file, such as an ASCII file.</span></span> <span data-ttu-id="2ed1d-106">O arquivo de dados pode ter diferentes formatos; o formato é definido para que a cópia em massa seja feita em um arquivo de formato.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-106">The data file can have different formats; the format is defined to bulk copy in a format file.</span></span> <span data-ttu-id="2ed1d-107">Como alternativa, os dados podem ser carregados para variáveis de programa e podem ser transferidos para o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] usando funções e métodos de cópia em massa.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-107">Optionally, data can be loaded into program variables and transferred to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] using bulk copy functions and methods.</span></span>  
  
 <span data-ttu-id="2ed1d-108">Para obter um aplicativo de exemplo que demonstra esse recurso, confira [Copiar dados em massa usando IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md).</span><span class="sxs-lookup"><span data-stu-id="2ed1d-108">For a sample application that demonstrates this feature, see [Bulk Copy Data Using IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md).</span></span>  
  
 <span data-ttu-id="2ed1d-109">Normalmente, um aplicativo usa o recurso de cópia em massa de uma destas maneiras:</span><span class="sxs-lookup"><span data-stu-id="2ed1d-109">An application typically uses bulk copy in one of the following ways:</span></span>  
  
-   <span data-ttu-id="2ed1d-110">Faz cópia em massa a partir de uma tabela, exibição ou conjunto de resultados de uma instrução Transact-SQL para um arquivo de dados onde os dados são armazenados no mesmo formato que a tabela ou exibição.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-110">Bulk copy from a table, view, or the result set of a Transact-SQL statement into a data file where the data is stored in the same format as the table or view.</span></span>  
  
     <span data-ttu-id="2ed1d-111">Esse arquivo é chamado de arquivo de dados de modo nativo.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-111">This is called a native-mode data file.</span></span>  
  
-   <span data-ttu-id="2ed1d-112">Faz cópia em massa a partir de uma tabela, exibição ou conjunto de resultados de uma instrução Transact-SQL para um arquivo de dados onde os dados são armazenados em um formato diferente do formato da tabela ou exibição.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-112">Bulk copy from a table, view, or the result set of a Transact-SQL statement into a data file where the data is stored in a format other than the one of the table or view.</span></span>  
  
     <span data-ttu-id="2ed1d-113">Nesse caso, um arquivo de formato separado é criado para definir as características (tipo de dados, posição, comprimento, terminador, e assim por diante) de cada coluna à medida que ela é armazenada no arquivo de dados.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-113">In this case, a separate format file is created that defines the characteristics (data type, position, length, terminator, and so on) of each column as it is stored in the data file.</span></span> <span data-ttu-id="2ed1d-114">Se todas as colunas forem convertidas em um formato de caractere, o arquivo resultante será chamado de arquivo de dados do modo de caractere.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-114">If all columns are converted to character format, the resulting file is called a character-mode data file.</span></span>  
  
-   <span data-ttu-id="2ed1d-115">Faz cópia em massa a partir de um arquivo de dados para uma tabela ou exibição.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-115">Bulk copy from a data file into a table or view.</span></span>  
  
     <span data-ttu-id="2ed1d-116">Se necessário, um arquivo de formato é usado para determinar o layout do arquivo de dados.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-116">If needed, a format file is used to determine the layout of the data file.</span></span>  
  
-   <span data-ttu-id="2ed1d-117">Faz o carregamento de dados para variáveis de programa e importa os dados para uma tabela ou exibição usando as funções de cópia em massa para executar a cópia em massa em uma linha de cada vez.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-117">Load data into program variables, then import the data into a table or view using the bulk copy functions for bulk copying in a row at a time.</span></span>  
  
 <span data-ttu-id="2ed1d-118">Os arquivos de dados usados pelas funções de cópia em massa não precisam ser criados por outro programa de cópia em massa.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-118">Data files used by bulk copy functions do not have to be created by another bulk copy program.</span></span> <span data-ttu-id="2ed1d-119">Qualquer outro sistema pode gerar um arquivo de dados e um arquivo de formato para executar a cópia em massa de definições; esses arquivos podem ser usados com um programa de cópia em massa do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] para importar dados para o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2ed1d-119">Any other system can generate a data file and format file according to bulk copy definitions; these files can then be used with a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] bulk copy program to import data into [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="2ed1d-120">Por exemplo, você poderia exportar dados de uma planilha em um arquivo delimitado por tabulação, criar um arquivo de formato descrevendo o arquivo delimitado por tabulação e usar um programa de cópia em massa para importar rapidamente os dados para o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2ed1d-120">For example, you could export data from a spreadsheet in a tab-delimited file, build a format file describing the tab-delimited file, and then use a bulk copy program to quickly import the data into [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="2ed1d-121">Os arquivos de dados gerados pela cópia em massa também podem ser importados para outros aplicativos.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-121">Data files generated by bulk copy can also be imported into other applications.</span></span> <span data-ttu-id="2ed1d-122">Por exemplo, você poderia usar as funções de cópia em massa para exportar dados de uma tabela ou exibição para um arquivo delimitado por tabulação que poderia, por sua vez, ser carregado para a planilha.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-122">For example, you could use bulk copy functions to export data from a table or view into a tab-delimited file that could then be loaded into a spreadsheet.</span></span>  
  
 <span data-ttu-id="2ed1d-123">Os aplicativos de codificação para programadores que usam funções de cópia em massa deveriam seguir as regras gerais para garantir o bom desempenho dessas funções.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-123">Programmers coding applications to use the bulk copy functions should follow the general rules for good bulk copy performance.</span></span> <span data-ttu-id="2ed1d-124">Para obter mais informações sobre o suporte a operações de carregamento em massa em [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], veja [Importação e exportação de dados em massa &#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="2ed1d-124">For more information about support for bulk copy operations in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], see [Bulk Import and Export of Data &#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md).</span></span>  
  
## <a name="limitations-and-restrictions"></a><span data-ttu-id="2ed1d-125">Limitações e Restrições</span><span class="sxs-lookup"><span data-stu-id="2ed1d-125">Limitations and Restrictions</span></span>  
 <span data-ttu-id="2ed1d-126">Um UDT (tipo definido pelo usuário) CLR deve ser associado como dados binários.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-126">A CLR user-defined type (UDT) must be bound as binary data.</span></span> <span data-ttu-id="2ed1d-127">Mesmo se um arquivo de formato especificar SQLCHAR como o tipo de dados para uma coluna UDT de destino, o utilitário BCP interpretará os dados como binários.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-127">Even if a format file specifies SQLCHAR as the data type for a target UDT column, The BCP utility will treat the data as binary.</span></span>  
  
 <span data-ttu-id="2ed1d-128">Não use SET FMTONLY OFF com operações de cópia em massa.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-128">Do not use SET FMTONLY OFF with bulk copy operations.</span></span> <span data-ttu-id="2ed1d-129">SET FMTONLY OFF pode fazer sua operação de cópia em massa falhar ou gerar resultados inesperados.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-129">SET FMTONLY OFF may cause your bulk copy operation to fail or give unexpected results.</span></span>  
  
## <a name="sql-server-native-client-ole-db-provider"></a><span data-ttu-id="2ed1d-130">Provedor OLE DB do SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="2ed1d-130">SQL Server Native Client OLE DB Provider</span></span>  
 <span data-ttu-id="2ed1d-131">O [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] provedor de OLE DB de cliente nativo implementa dois métodos para executar operações de cópia em massa com um [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] banco de dados.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-131">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider implements two methods for performing bulk copy operations with a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database.</span></span> <span data-ttu-id="2ed1d-132">O primeiro método envolve o uso da interface [IRowsetFastLoad](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) para operações de cópia em massa baseadas em memória; o segundo envolve o uso da interface [IBCPSession](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) para operações de cópia em massa baseadas em arquivo.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-132">The first method involves using the [IRowsetFastLoad](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) interface for memory-based bulk copy operations; and the second involves using the [IBCPSession](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) interface for file-based bulk copy operations.</span></span>  
  
### <a name="using-memory-based-bulk-copy-operations"></a><span data-ttu-id="2ed1d-133">Usando operações de cópia em massa baseadas em memória</span><span class="sxs-lookup"><span data-stu-id="2ed1d-133">Using Memory Based Bulk Copy Operations</span></span>  
 <span data-ttu-id="2ed1d-134">O [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] provedor de OLE DB de cliente nativo implementa a interface **IRowsetFastLoad** para expor o suporte para [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] operações de cópia em massa baseadas em memória.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-134">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider implements the **IRowsetFastLoad** interface to expose support for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] memory-based bulk copy operations.</span></span> <span data-ttu-id="2ed1d-135">A interface **IRowsetFastLoad** implementa os métodos [IRowsetFastLoad::Commit](../../native-client-ole-db-interfaces/irowsetfastload-commit-ole-db.md) e [IRowsetFastLoad::InsertRow](../../native-client-ole-db-interfaces/irowsetfastload-insertrow-ole-db.md).</span><span class="sxs-lookup"><span data-stu-id="2ed1d-135">The **IRowsetFastLoad** interface implements the [IRowsetFastLoad::Commit](../../native-client-ole-db-interfaces/irowsetfastload-commit-ole-db.md) and [IRowsetFastLoad::InsertRow](../../native-client-ole-db-interfaces/irowsetfastload-insertrow-ole-db.md) methods.</span></span>  
  
#### <a name="enabling-a-session-for-irowsetfastload"></a><span data-ttu-id="2ed1d-136">Habilitando uma sessão para IRowsetFastLoad</span><span class="sxs-lookup"><span data-stu-id="2ed1d-136">Enabling a Session for IRowsetFastLoad</span></span>  
 <span data-ttu-id="2ed1d-137">O consumidor notifica o provedor OLE DB do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client sobre sua necessidade de executar uma cópia em massa, definindo a propriedade de fonte de dados específica do provedor OLE DB do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client SSPROP_ENABLEFASTLOAD como VARIANT_TRUE.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-137">The consumer notifies the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider of its need for bulk copy by setting the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider-specific data source property SSPROP_ENABLEFASTLOAD to VARIANT_TRUE.</span></span> <span data-ttu-id="2ed1d-138">Com o conjunto de propriedades na fonte de dados, o consumidor cria uma sessão de provedor OLE DB do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2ed1d-138">With the property set on the data source, the consumer creates a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider session.</span></span> <span data-ttu-id="2ed1d-139">A nova sessão permite que o consumidor acesse a interface **IRowsetFastLoad**.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-139">The new session allows consumer access to the **IRowsetFastLoad** interface.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="2ed1d-140">Se a interface **IDataInitialize** for usada para inicializar a fonte de dados, será necessário definir a propriedade SSPROP_IRowsetFastLoad no parâmetro *rgPropertySets* do método **IOpenRowset::OpenRowset**; caso contrário, a chamada ao método **OpenRowset** retornará E_NOINTERFACE.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-140">If the **IDataInitialize** interface is used for initializing the data source, then it is necessary to set the SSPROP_IRowsetFastLoad property in the *rgPropertySets* parameter of the **IOpenRowset::OpenRowset** method; otherwise, the call to the **OpenRowset** method will return E_NOINTERFACE.</span></span>  
  
 <span data-ttu-id="2ed1d-141">Habilitar uma sessão para a cópia em massa restringe o provedor OLE DB do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client para interfaces na sessão.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-141">Enabling a session for bulk copy constrains the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider support for interfaces on the session.</span></span> <span data-ttu-id="2ed1d-142">Uma sessão habilitada para cópia em massa expõe apenas as seguintes interfaces:</span><span class="sxs-lookup"><span data-stu-id="2ed1d-142">A bulk copy-enabled session exposes only the following interfaces:</span></span>  
  
-   <span data-ttu-id="2ed1d-143">**IDBSchemaRowset**</span><span class="sxs-lookup"><span data-stu-id="2ed1d-143">**IDBSchemaRowset**</span></span>  
  
-   <span data-ttu-id="2ed1d-144">**IGetDataSource**</span><span class="sxs-lookup"><span data-stu-id="2ed1d-144">**IGetDataSource**</span></span>  
  
-   <span data-ttu-id="2ed1d-145">**IOpenRowset**</span><span class="sxs-lookup"><span data-stu-id="2ed1d-145">**IOpenRowset**</span></span>  
  
-   <span data-ttu-id="2ed1d-146">**ISupportErrorInfo**</span><span class="sxs-lookup"><span data-stu-id="2ed1d-146">**ISupportErrorInfo**</span></span>  
  
-   <span data-ttu-id="2ed1d-147">**ITransactionJoin**</span><span class="sxs-lookup"><span data-stu-id="2ed1d-147">**ITransactionJoin**</span></span>  
  
 <span data-ttu-id="2ed1d-148">Para desabilitar a criação de conjuntos de linhas habilitados para cópia em massa e fazer com que a sessão do provedor OLE DB do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client seja revertida para o processamento padrão, redefina SSPROP_ENABLEFASTLOAD como VARIANT_FALSE.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-148">To disable the creation of bulk copy-enabled rowsets and cause the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider session to revert to standard processing, reset SSPROP_ENABLEFASTLOAD to VARIANT_FALSE.</span></span>  
  
#### <a name="irowsetfastload-rowsets"></a><span data-ttu-id="2ed1d-149">Conjuntos de linhas IRowsetFastLoad</span><span class="sxs-lookup"><span data-stu-id="2ed1d-149">IRowsetFastLoad Rowsets</span></span>  
 <span data-ttu-id="2ed1d-150">Os conjuntos de linhas de cópia em massa do provedor OLE DB do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client são somente gravação, mas eles expõe interfaces que permitem que o consumidor determine a estrutura de uma tabela [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2ed1d-150">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider bulk copy rowsets are write-only, but they expose interfaces that allow the consumer to determine the structure of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] table.</span></span> <span data-ttu-id="2ed1d-151">As seguintes interfaces são expostas em um conjunto de linhas do provedor OLE DB do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client habilitado para cópia em massa:</span><span class="sxs-lookup"><span data-stu-id="2ed1d-151">The following interfaces are exposed on a bulk copy-enabled [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider rowset:</span></span>  
  
-   <span data-ttu-id="2ed1d-152">**IAccessor**</span><span class="sxs-lookup"><span data-stu-id="2ed1d-152">**IAccessor**</span></span>  
  
-   <span data-ttu-id="2ed1d-153">**IColumnsInfo**</span><span class="sxs-lookup"><span data-stu-id="2ed1d-153">**IColumnsInfo**</span></span>  
  
-   <span data-ttu-id="2ed1d-154">**IColumnsRowset**</span><span class="sxs-lookup"><span data-stu-id="2ed1d-154">**IColumnsRowset**</span></span>  
  
-   <span data-ttu-id="2ed1d-155">**IConvertType**</span><span class="sxs-lookup"><span data-stu-id="2ed1d-155">**IConvertType**</span></span>  
  
-   <span data-ttu-id="2ed1d-156">**IRowsetFastLoad**</span><span class="sxs-lookup"><span data-stu-id="2ed1d-156">**IRowsetFastLoad**</span></span>  
  
-   <span data-ttu-id="2ed1d-157">**IRowsetInfo**</span><span class="sxs-lookup"><span data-stu-id="2ed1d-157">**IRowsetInfo**</span></span>  
  
-   <span data-ttu-id="2ed1d-158">**ISupportErrorInfo**</span><span class="sxs-lookup"><span data-stu-id="2ed1d-158">**ISupportErrorInfo**</span></span>  
  
 <span data-ttu-id="2ed1d-159">As propriedades específicas de provedor SSPROP_FASTLOADOPTIONS, SSPROP_FASTLOADKEEPNULLS e SSPROP_FASTLOADKEEPIDENTITY controlam o comportamento de um conjunto de linhas de cópia em massa do provedor OLE DB do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-159">The provider-specific properties SSPROP_FASTLOADOPTIONS, SSPROP_FASTLOADKEEPNULLS, and SSPROP_FASTLOADKEEPIDENTITY control behaviors of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider bulk-copy rowset.</span></span> <span data-ttu-id="2ed1d-160">As propriedades são especificadas no membro *rgProperties* de um membro de parâmetro _rgPropertySets_**IOpenRowset**.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-160">The properties are specified in the *rgProperties* member of an _rgPropertySets_**IOpenRowset**parameter member.</span></span>  
  
|<span data-ttu-id="2ed1d-161">ID da propriedade</span><span class="sxs-lookup"><span data-stu-id="2ed1d-161">Property ID</span></span>|<span data-ttu-id="2ed1d-162">Descrição</span><span class="sxs-lookup"><span data-stu-id="2ed1d-162">Description</span></span>|  
|-----------------|-----------------|  
|<span data-ttu-id="2ed1d-163">SSPROP_FASTLOADKEEPIDENTITY</span><span class="sxs-lookup"><span data-stu-id="2ed1d-163">SSPROP_FASTLOADKEEPIDENTITY</span></span>|<span data-ttu-id="2ed1d-164">Coluna: Não</span><span class="sxs-lookup"><span data-stu-id="2ed1d-164">Column: No</span></span><br /><br /> <span data-ttu-id="2ed1d-165">L/G: Leitura/gravação</span><span class="sxs-lookup"><span data-stu-id="2ed1d-165">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="2ed1d-166">Tipo: VT_BOOL</span><span class="sxs-lookup"><span data-stu-id="2ed1d-166">Type: VT_BOOL</span></span><br /><br /> <span data-ttu-id="2ed1d-167">Padrão: VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="2ed1d-167">Default: VARIANT_FALSE</span></span><br /><br /> <span data-ttu-id="2ed1d-168">Descrição: Mantém valores de identidade fornecidos pelo consumidor.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-168">Description: Maintains identity values supplied by the consumer.</span></span><br /><br /> <span data-ttu-id="2ed1d-169">VARIANT_FALSE: Valores para uma coluna de identidade na tabela [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] são gerados pelo [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2ed1d-169">VARIANT_FALSE: Values for an identity column in the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] table are generated by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="2ed1d-170">Qualquer valor associado à coluna é ignorado pelo provedor de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] OLE DB de cliente nativo.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-170">Any value bound for the column is ignored by the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider.</span></span><br /><br /> <span data-ttu-id="2ed1d-171">VARIANT_TRUE: O consumidor associa um acessador fornecendo um valor para uma coluna de identidade [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2ed1d-171">VARIANT_TRUE: The consumer binds an accessor providing a value for a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] identity column.</span></span> <span data-ttu-id="2ed1d-172">A propriedade de identidade não está disponível em colunas que aceitam valores NULL e, portanto, o consumidor fornece um valor exclusivo em cada chamada a **IRowsetFastLoad::Insert**.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-172">The identity property is not available on columns accepting NULL, so the consumer provides a unique value on each **IRowsetFastLoad::Insert** call.</span></span>|  
|<span data-ttu-id="2ed1d-173">SSPROP_FASTLOADKEEPNULLS</span><span class="sxs-lookup"><span data-stu-id="2ed1d-173">SSPROP_FASTLOADKEEPNULLS</span></span>|<span data-ttu-id="2ed1d-174">Coluna: Não</span><span class="sxs-lookup"><span data-stu-id="2ed1d-174">Column: No</span></span><br /><br /> <span data-ttu-id="2ed1d-175">L/G: Leitura/gravação</span><span class="sxs-lookup"><span data-stu-id="2ed1d-175">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="2ed1d-176">Tipo: VT_BOOL</span><span class="sxs-lookup"><span data-stu-id="2ed1d-176">Type: VT_BOOL</span></span><br /><br /> <span data-ttu-id="2ed1d-177">Padrão: VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="2ed1d-177">Default: VARIANT_FALSE</span></span><br /><br /> <span data-ttu-id="2ed1d-178">Descrição: Mantém valores NULL para colunas com uma restrição DEFAULT.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-178">Description: Maintains NULL for columns with a DEFAULT constraint.</span></span> <span data-ttu-id="2ed1d-179">Só afeta colunas [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] que aceitam valores NULL e que têm uma restrição DEFAULT aplicada.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-179">Affects only [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] columns that accept NULL and have a DEFAULT constraint applied.</span></span><br /><br /> <span data-ttu-id="2ed1d-180">VARIANT_FALSE: O [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] insere o valor padrão para a coluna quando o consumidor do provedor OLE DB do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client insere uma linha que contém valores NULL para a coluna.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-180">VARIANT_FALSE: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] inserts the default value for the column when the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider consumer inserts a row containing NULL for the column.</span></span><br /><br /> <span data-ttu-id="2ed1d-181">VARIANT_TRUE: O [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] insere NULL para o valor da coluna quando o consumidor do provedor OLE DB do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client insere uma linha que contém valores NULL para a coluna.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-181">VARIANT_TRUE: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] inserts NULL for the column value when the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider consumer inserts a row containing NULL for the column.</span></span>|  
|<span data-ttu-id="2ed1d-182">SSPROP_FASTLOADOPTIONS</span><span class="sxs-lookup"><span data-stu-id="2ed1d-182">SSPROP_FASTLOADOPTIONS</span></span>|<span data-ttu-id="2ed1d-183">Coluna: Não</span><span class="sxs-lookup"><span data-stu-id="2ed1d-183">Column: No</span></span><br /><br /> <span data-ttu-id="2ed1d-184">L/G: Leitura/gravação</span><span class="sxs-lookup"><span data-stu-id="2ed1d-184">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="2ed1d-185">Tipo: VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="2ed1d-185">Type: VT_BSTR</span></span><br /><br /> <span data-ttu-id="2ed1d-186">Padrão: nenhum</span><span class="sxs-lookup"><span data-stu-id="2ed1d-186">Default: none</span></span><br /><br /> <span data-ttu-id="2ed1d-187">Descrição: Esta propriedade é a mesma que a opção **-h** "*hint*[,...*n*]" do utilitário **bcp**.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-187">Description: This property is the same as the **-h** "*hint*[,...*n*]" option of the **bcp** utility.</span></span> <span data-ttu-id="2ed1d-188">A cadeia de caracteres a seguir pode ser usada como opção na cópia em massa de dados para uma tabela.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-188">The following string(s) can be used as option(s) in the bulk copying of data into a table.</span></span><br /><br /> <span data-ttu-id="2ed1d-189">**ORDER**(*column*[**ASC** &#124; **DESC**][,...*n*]): Ordem de classificação de dados no arquivo de dados.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-189">**ORDER**(*column*[**ASC** &#124; **DESC**][,...*n*]): Sort order of data in the data file.</span></span> <span data-ttu-id="2ed1d-190">O desempenho da operação de cópia em massa é aprimorado se o arquivo de dados que está sendo carregado for classificado de acordo com o índice clusterizado na tabela.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-190">Bulk copy performance is improved if the data file being loaded is sorted according to the clustered index on the table.</span></span><br /><br /> <span data-ttu-id="2ed1d-191">**ROWS_PER_BATCH** = *bb*: Número de linhas de dados por lote (como *bb*).</span><span class="sxs-lookup"><span data-stu-id="2ed1d-191">**ROWS_PER_BATCH** = *bb*: Number of rows of data per batch (as *bb*).</span></span> <span data-ttu-id="2ed1d-192">O servidor otimiza o carregamento em massa de acordo com o valor *bb*.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-192">The server optimizes the bulk load according to the value *bb*.</span></span> <span data-ttu-id="2ed1d-193">Por padrão, **ROWS_PER_BATCH** é desconhecido.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-193">By default, **ROWS_PER_BATCH** is unknown.</span></span><br /><br /> <span data-ttu-id="2ed1d-194">**KILOBYTES_PER_BATCH** = *cc*: Número de kilobytes (KB) de dados por lote (como cc).</span><span class="sxs-lookup"><span data-stu-id="2ed1d-194">**KILOBYTES_PER_BATCH** = *cc*: Number of kilobytes (KB) of data per batch (as cc).</span></span> <span data-ttu-id="2ed1d-195">Por padrão, **KILOBYTES_PER_BATCH** é desconhecido.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-195">By default, **KILOBYTES_PER_BATCH** is unknown.</span></span><br /><br /> <span data-ttu-id="2ed1d-196">**TABLOCK**: Um bloqueio em nível de tabela é obtido enquanto durar a operação de cópia em massa.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-196">**TABLOCK**: A table-level lock is acquired for the duration of the bulk copy operation.</span></span> <span data-ttu-id="2ed1d-197">Essa opção melhora significativamente o desempenho porque manter um bloqueio apenas durante a operação de cópia em massa reduz a contenção de bloqueios na tabela.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-197">This option significantly improves performance because holding a lock only for the duration of the bulk copy operation reduces lock contention on the table.</span></span> <span data-ttu-id="2ed1d-198">Uma tabela pode ser carregada simultaneamente por vários clientes se ela não tem índices e se **TABLOCK** está especificado.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-198">A table can be loaded by multiple clients concurrently if the table has no indexes and **TABLOCK** is specified.</span></span> <span data-ttu-id="2ed1d-199">Por padrão, o comportamento de bloqueio é determinado pela opção de tabela **table lock on bulk load**.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-199">By default, the locking behavior is determined by the table option **table lock on bulk load**.</span></span><br /><br /> <span data-ttu-id="2ed1d-200">**CHECK_CONSTRAINTS**: Todas as restrições em *table_name* são verificadas durante a operação de cópia em massa.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-200">**CHECK_CONSTRAINTS**: Any constraints on *table_name* are checked during the bulk copy operation.</span></span> <span data-ttu-id="2ed1d-201">Por padrão, as restrições são ignoradas.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-201">By default, constraints are ignored.</span></span><br /><br /> <span data-ttu-id="2ed1d-202">**FIRE_TRIGGER**: o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] usa o controle de versão de linha para gatilhos e armazena as versões de linha no repositório de versões em **tempdb**.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-202">**FIRE_TRIGGER**: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] uses row versioning for triggers and stores the row versions in the version store in **tempdb**.</span></span> <span data-ttu-id="2ed1d-203">Portanto, as otimizações de registro em massa estão disponíveis até mesmo quando os gatilhos estão habilitados.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-203">Therefore, bulk logging optimizations are available even when triggers are enabled.</span></span> <span data-ttu-id="2ed1d-204">Antes de iniciar a importação em massa de um lote com um número grande de linhas com gatilhos habilitados, talvez você precise expandir o tamanho do **tempdb**.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-204">Before bulk importing a batch with a large number of rows with triggers enabled, you may need to expand the size of **tempdb**.</span></span>|  
  
### <a name="using-file-based-bulk-copy-operations"></a><span data-ttu-id="2ed1d-205">Usando operações de cópia em massa baseadas em arquivo</span><span class="sxs-lookup"><span data-stu-id="2ed1d-205">Using File Based Bulk Copy Operations</span></span>  
 <span data-ttu-id="2ed1d-206">O [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] provedor de OLE DB de cliente nativo implementa a interface **IBCPSession** para expor o suporte para [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] operações de cópia em massa baseadas em arquivo.</span><span class="sxs-lookup"><span data-stu-id="2ed1d-206">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider implements the **IBCPSession** interface to expose support for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] file-based bulk copy operations.</span></span> <span data-ttu-id="2ed1d-207">A interface **IBCPSession** implementa os métodos [IBCPSession::BCPColFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpcolfmt-ole-db.md), [IBCPSession::BCPColumns](../../native-client-ole-db-interfaces/ibcpsession-bcpcolumns-ole-db.md), [IBCPSession::BCPControl](../../native-client-ole-db-interfaces/ibcpsession-bcpcontrol-ole-db.md), [IBCPSession::BCPDone](../../native-client-ole-db-interfaces/ibcpsession-bcpdone-ole-db.md), [IBCPSession::BCPExec](../../native-client-ole-db-interfaces/ibcpsession-bcpexec-ole-db.md), [IBCPSession::BCPInit](../../native-client-ole-db-interfaces/ibcpsession-bcpinit-ole-db.md), [IBCPSession::BCPReadFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpreadfmt-ole-db.md) e [IBCPSession::BCPWriteFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpwritefmt-ole-db.md).</span><span class="sxs-lookup"><span data-stu-id="2ed1d-207">The **IBCPSession** interface implements the [IBCPSession::BCPColFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpcolfmt-ole-db.md), [IBCPSession::BCPColumns](../../native-client-ole-db-interfaces/ibcpsession-bcpcolumns-ole-db.md), [IBCPSession::BCPControl](../../native-client-ole-db-interfaces/ibcpsession-bcpcontrol-ole-db.md), [IBCPSession::BCPDone](../../native-client-ole-db-interfaces/ibcpsession-bcpdone-ole-db.md), [IBCPSession::BCPExec](../../native-client-ole-db-interfaces/ibcpsession-bcpexec-ole-db.md), [IBCPSession::BCPInit](../../native-client-ole-db-interfaces/ibcpsession-bcpinit-ole-db.md), [IBCPSession::BCPReadFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpreadfmt-ole-db.md), and [IBCPSession::BCPWriteFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpwritefmt-ole-db.md)methods.</span></span>  
  
## <a name="sql-server-native-client-odbc-driver"></a><span data-ttu-id="2ed1d-208">Driver ODBC do SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="2ed1d-208">SQL Server Native Client ODBC Driver</span></span>  
 <span data-ttu-id="2ed1d-209">O driver ODBC do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client mantém o mesmo suporte para operações de cópia em massa que o das versões anteriores do driver ODBC do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2ed1d-209">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver maintains the same support for bulk copy operations that were part of previous versions of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ODBC driver.</span></span> <span data-ttu-id="2ed1d-210">Para obter informações sobre operações de cópia em massa usando o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] driver ODBC do Native Client, consulte [executando operações de cópia em massa &#40;ODBC&#41;](../../native-client-odbc-bulk-copy-operations/performing-bulk-copy-operations-odbc.md).</span><span class="sxs-lookup"><span data-stu-id="2ed1d-210">For information about bulk copy operations using the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver, see [Performing Bulk Copy Operations &#40;ODBC&#41;](../../native-client-odbc-bulk-copy-operations/performing-bulk-copy-operations-odbc.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="2ed1d-211">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="2ed1d-211">See Also</span></span>  
 <span data-ttu-id="2ed1d-212">[Recursos do SQL Server Native Client](sql-server-native-client-features.md) </span><span class="sxs-lookup"><span data-stu-id="2ed1d-212">[SQL Server Native Client Features](sql-server-native-client-features.md) </span></span>  
 <span data-ttu-id="2ed1d-213">[Propriedades de fonte de dados &#40;OLE DB&#41;](../../native-client-ole-db-data-source-objects/data-source-properties-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="2ed1d-213">[Data Source Properties &#40;OLE DB&#41;](../../native-client-ole-db-data-source-objects/data-source-properties-ole-db.md) </span></span>  
 <span data-ttu-id="2ed1d-214">[Importação e exportação em massa de dados &#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="2ed1d-214">[Bulk Import and Export of Data &#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md) </span></span>  
 <span data-ttu-id="2ed1d-215">[IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="2ed1d-215">[IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) </span></span>  
 <span data-ttu-id="2ed1d-216">[IBCPSession &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="2ed1d-216">[IBCPSession &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) </span></span>  
 <span data-ttu-id="2ed1d-217">[Otimizando o desempenho da importação em massa](https://msdn.microsoft.com/library/ms190421\(SQL.105\).aspx)</span><span class="sxs-lookup"><span data-stu-id="2ed1d-217">[Optimizing Bulk Import Performance](https://msdn.microsoft.com/library/ms190421\(SQL.105\).aspx)</span></span>  
  
  
