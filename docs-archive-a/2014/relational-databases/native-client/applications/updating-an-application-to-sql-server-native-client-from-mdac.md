---
title: Atualizando um aplicativo para SQL Server Native Client do MDAC | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- MDAC [SQL Server]
- SQLNCLI, vs. MDAC
- SQL Server Native Client, vs. MDAC
- data access [SQL Server Native Client], vs. MDAC
- SQL Server Native Client, updating applications
ms.assetid: 2860efdd-c59a-4deb-8a0e-5124a8f4e6dd
author: rothja
ms.author: jroth
ms.openlocfilehash: 804f4340f3ca9a381f28507e0516d5f2e7d913a6
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87684165"
---
# <a name="updating-an-application-to-sql-server-native-client-from-mdac"></a><span data-ttu-id="933c1-102">Atualizando um aplicativo do MDAC para o SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="933c1-102">Updating an Application to SQL Server Native Client from MDAC</span></span>
  <span data-ttu-id="933c1-103">Há várias diferenças entre o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client e o MDAC (Microsoft Data Access Components); a partir do Windows Vista, os componentes de acesso aos dados agora são chamados de Windows DAC ou de Windows Data Access Components).</span><span class="sxs-lookup"><span data-stu-id="933c1-103">There are a number of differences between [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client and Microsoft Data Access Components (MDAC; starting with Windows Vista, the data access components are now called Windows Data Access Components, or Windows DAC).</span></span> <span data-ttu-id="933c1-104">Ainda que ambos forneçam acesso a dados em bancos de dados do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client foi especificamente projetado para expor os novos recursos do [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], ao mesmo tempo em que mantém a compatibilidade com versões anteriores.</span><span class="sxs-lookup"><span data-stu-id="933c1-104">Although both provide native data access to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] databases, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client has been specifically designed to expose the new features of [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], while at the same time maintaining backward compatibility with earlier versions.</span></span>  
  
 <span data-ttu-id="933c1-105">As informações deste tópico ajudam a atualizar o aplicativo MDAC (ou Windows DAC) em relação à versão do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client incluída no [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span><span class="sxs-lookup"><span data-stu-id="933c1-105">The information in this topic helps update your MDAC (or Windows DAC) application to be current with the version of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client that was included in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span></span> <span data-ttu-id="933c1-106">Para ajudá-lo a tornar esse aplicativo atualizado com a versão do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client fornecida no [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] , consulte [atualizando um aplicativo do SQL Server 2005 Native Client](updating-an-application-from-sql-server-2005-native-client.md).</span><span class="sxs-lookup"><span data-stu-id="933c1-106">To help you make this application be current with the version of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client that shipped in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)], see [Updating an Application from SQL Server 2005 Native Client](updating-an-application-from-sql-server-2005-native-client.md).</span></span>  
  
 <span data-ttu-id="933c1-107">Além disso, muito embora o MDAC contenha componentes para usar OLE DB, ODBC e ADO (ActiveX Data Objects), o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client implementa apenas OLE DB e ODBC (ainda que o ADO possa acessar a funcionalidade do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client).</span><span class="sxs-lookup"><span data-stu-id="933c1-107">In addition, although MDAC contains components for using OLE DB, ODBC, and ActiveX Data Objects (ADO), [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client only implements OLE DB and ODBC (although ADO can access the functionality of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client).</span></span>  
  
 <span data-ttu-id="933c1-108">O [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client e o MDAC são diferentes nas demais áreas a seguir:</span><span class="sxs-lookup"><span data-stu-id="933c1-108">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client and MDAC differ in the other following areas:</span></span>  
  
-   <span data-ttu-id="933c1-109">Aqueles que usam o ADO para acessar um provedor do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client podem encontrar menos funcionalidade de filtragem do que quando acessam um provedor OLE DB SQL.</span><span class="sxs-lookup"><span data-stu-id="933c1-109">Users who use ADO to access a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client provider may find less filtering functionality than when they accessed a SQL OLE DB provider.</span></span>  
  
-   <span data-ttu-id="933c1-110">Se um aplicativo do ADO usar o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client e tentar atualizar uma coluna computada, será informado um erro.</span><span class="sxs-lookup"><span data-stu-id="933c1-110">If an ADO application uses [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client and attempts to update a computed column, an error will be reported.</span></span> <span data-ttu-id="933c1-111">Com o MDAC, a atualização foi aceita, mas ignorada.</span><span class="sxs-lookup"><span data-stu-id="933c1-111">With MDAC the update was accepted but ignored.</span></span>  
  
-   <span data-ttu-id="933c1-112">O [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client é um único arquivo DLL (biblioteca de vínculo dinâmico) autossuficiente.</span><span class="sxs-lookup"><span data-stu-id="933c1-112">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client is a single self-contained dynamic link library (DLL) file.</span></span> <span data-ttu-id="933c1-113">As interfaces expostas publicamente foram mantidas no mínimo, tanto para facilitar a distribuição quanto para limitar a exposição de segurança.</span><span class="sxs-lookup"><span data-stu-id="933c1-113">The publicly exposed interfaces have been kept to a minimum, both to ease distribution, as well as to limit security exposure.</span></span>  
  
-   <span data-ttu-id="933c1-114">Só há suporte para interfaces OLE DB e ODBC.</span><span class="sxs-lookup"><span data-stu-id="933c1-114">Only OLE DB and ODBC interfaces are supported.</span></span>  
  
-   <span data-ttu-id="933c1-115">O provedor OLE DB do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client e os nomes do driver ODBC são diferentes dos usados com o MDAC.</span><span class="sxs-lookup"><span data-stu-id="933c1-115">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider and ODBC driver names are different from those used with MDAC.</span></span>  
  
-   <span data-ttu-id="933c1-116">A funcionalidade acessível ao usuário fornecida pelos componentes do MDAC está disponível quando o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client é usado.</span><span class="sxs-lookup"><span data-stu-id="933c1-116">User-accessible functionality supplied by MDAC components is available when using [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span></span> <span data-ttu-id="933c1-117">Isso inclui, mas não se limita a, o seguinte: pool de conexões, suporte ao ADO e suporte ao cursor do cliente.</span><span class="sxs-lookup"><span data-stu-id="933c1-117">This includes, but is not limited to, the following: connection pooling, ADO support, and client cursor support.</span></span> <span data-ttu-id="933c1-118">Quando algum desses recursos é usado, o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client fornece apenas conectividade de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="933c1-118">When any of these features are used, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client supplies only database connectivity.</span></span> <span data-ttu-id="933c1-119">O MDAC fornece funcionalidades como, por exemplo, rastreamento, controles de gerenciamento e contadores de desempenho.</span><span class="sxs-lookup"><span data-stu-id="933c1-119">MDAC provides functionality such as tracing, management controls, and performance counters.</span></span>  
  
-   <span data-ttu-id="933c1-120">Os aplicativos podem usar os serviços principais do OLE DB com o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, mas, se usarem o mecanismo de cursor do OLE DB, eles deverão usar a opção de compatibilidade do tipo de dados para evitar problemas potenciais que possam surgir em decorrência do desconhecimento dos novos tipos de dados do [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] pelo mecanismo de cursor.</span><span class="sxs-lookup"><span data-stu-id="933c1-120">Applications can use OLE DB core services with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, but if using the OLE DB cursor engine, they should use the data type compatibility option to avoid any potential problems that might arise because the cursor engine has no knowledge of the new [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] data types.</span></span>  
  
-   <span data-ttu-id="933c1-121">O [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client dá suporte a acesso a bancos de dados anteriores ao [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="933c1-121">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client supports access to previous [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] databases.</span></span>  
  
-   <span data-ttu-id="933c1-122">O [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client não contém integração XML.</span><span class="sxs-lookup"><span data-stu-id="933c1-122">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client does not contain XML integration.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="933c1-123">O Native Client dá suporte a SELECT... Consultas FOR XML, mas não oferecem suporte a nenhuma outra funcionalidade XML.</span><span class="sxs-lookup"><span data-stu-id="933c1-123">Native Client supports SELECT ... FOR XML queries, but does not support any other XML functionality.</span></span> <span data-ttu-id="933c1-124">No entanto, o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client oferece suporte ao tipo de dados `xml` introduzido no [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span><span class="sxs-lookup"><span data-stu-id="933c1-124">However, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client does support the `xml` data type introduced in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span></span>  
  
-   <span data-ttu-id="933c1-125">O [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client oferece suporte à configuração de bibliotecas de rede do lado do cliente que usam apenas atributos da cadeia de conexão.</span><span class="sxs-lookup"><span data-stu-id="933c1-125">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client supports configuring client-side network libraries using only connection string attributes.</span></span> <span data-ttu-id="933c1-126">Caso precise de uma configuração de biblioteca de rede mais completa, você deve usar o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Configuration Manager.</span><span class="sxs-lookup"><span data-stu-id="933c1-126">If you need more complete network library configuration, you must use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Configuration Manager.</span></span>  
  
-   <span data-ttu-id="933c1-127">O [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client não é compatível com odbcbcp.dll.</span><span class="sxs-lookup"><span data-stu-id="933c1-127">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client is not compatible with odbcbcp.dll.</span></span> <span data-ttu-id="933c1-128">Os aplicativos que usam APIs ODBC e **bcp** devem ser recriados para vincular com sqlncli11. lib a fim de usar o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="933c1-128">Applications that use both ODBC and **bcp** APIs must be rebuilt to link with sqlncli11.lib in order to use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span></span>  
  
-   <span data-ttu-id="933c1-129">Não há suporte para o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client no Microsoft OLE DB Provider for ODBC (MSDASQL).</span><span class="sxs-lookup"><span data-stu-id="933c1-129">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client is not supported from the Microsoft OLE DB provider for ODBC (MSDASQL).</span></span> <span data-ttu-id="933c1-130">Se você estiver usando o driver MDAC SQLODBC com MSDASQL ou o driver MDAC SQLODBC com ADO, use OLE DB no [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="933c1-130">If you are using the MDAC SQLODBC driver with MSDASQL or MDAC SQLODBC driver with ADO, use OLE DB in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client..</span></span>  
  
-   <span data-ttu-id="933c1-131">As cadeias de conexão do MDAC permitem um valor booliano ( `true` ) para a palavra-chave **Trusted_Connection** .</span><span class="sxs-lookup"><span data-stu-id="933c1-131">MDAC connection strings allow a Boolean value (`true`) for the **Trusted_Connection** keyword.</span></span> <span data-ttu-id="933c1-132">Uma [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] cadeia de conexão de cliente nativo deve usar `yes` ou **não**.</span><span class="sxs-lookup"><span data-stu-id="933c1-132">A [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client connection string must use `yes` or **no**.</span></span>  
  
-   <span data-ttu-id="933c1-133">As alterações menores ocorreram por conta de avisos e erros.</span><span class="sxs-lookup"><span data-stu-id="933c1-133">Minor changes have occurred to warnings and errors.</span></span> <span data-ttu-id="933c1-134">Avisos e erros retornados pelo servidor agora mantêm a mesma severidade quando passados para o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="933c1-134">Warnings and errors returned by the server now retain the same severity when passed to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span></span> <span data-ttu-id="933c1-135">Você não deve se esquecer de testar integralmente o aplicativo caso dependa da interceptação de avisos e erros específicos.</span><span class="sxs-lookup"><span data-stu-id="933c1-135">You should ensure you have thoroughly tested your application if you depend on trapping particular warnings and errors.</span></span>  
  
-   <span data-ttu-id="933c1-136">O [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client apresenta uma verificação de erro mais rígida do que o MDAC, o que significa que alguns aplicativos que não se adaptam rigidamente às especificações do ODBC e do OLE DB podem se comportar de maneira diferente.</span><span class="sxs-lookup"><span data-stu-id="933c1-136">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client has stricter error checking than MDAC, which means that some applications that do not conform strictly to the ODBC and OLE DB specifications may behave differently.</span></span> <span data-ttu-id="933c1-137">Por exemplo, o provedor SQLOLEDB não importou a regra que os nomes de parâmetros devem começar com ' \@ ' para os parâmetros de resultado, mas o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] provedor de OLE DB de cliente nativo faz.</span><span class="sxs-lookup"><span data-stu-id="933c1-137">For example, the SQLOLEDB provider did not enforce the rule that parameter names must start with '\@' for result parameters, but the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider does.</span></span>  
  
-   <span data-ttu-id="933c1-138">O [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client se comporta de maneira diferente em relação ao MDAC no que diz respeito a falhas de conexão.</span><span class="sxs-lookup"><span data-stu-id="933c1-138">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client behaves differently from MDAC in regards to failed connections.</span></span> <span data-ttu-id="933c1-139">Por exemplo, o MDAC retorna valores de propriedade armazenados em cache para uma falha de conexão, ao passo que o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client informa um erro ao aplicativo de chamada.</span><span class="sxs-lookup"><span data-stu-id="933c1-139">For example, MDAC returns cached property values for a connection that has failed, whereas [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client reports an error to the calling application.</span></span>  
  
-   <span data-ttu-id="933c1-140">O [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client não gera eventos do Analisador do Visual Studio, e sim eventos de rastreamento do Windows.</span><span class="sxs-lookup"><span data-stu-id="933c1-140">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client does not generate Visual Studio Analyzer events, but instead generates Windows tracing events.</span></span>  
  
-   <span data-ttu-id="933c1-141">O [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client não pode ser usado com perfmon.</span><span class="sxs-lookup"><span data-stu-id="933c1-141">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client cannot be used with perfmon.</span></span> <span data-ttu-id="933c1-142">Perfmon é uma ferramenta do Windows que pode ser usada apenas com DSNs que usem o driver SQLODBC do MDAC incluído no Windows.</span><span class="sxs-lookup"><span data-stu-id="933c1-142">Perfmon is a Windows tool that can only be used with DSNs that use the MDAC SQLODBC driver included with Windows.</span></span>  
  
-   <span data-ttu-id="933c1-143">Quando o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client é conectado ao [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] e versões posteriores, o erro de servidor 16947 é retornado como SQL_ERROR.</span><span class="sxs-lookup"><span data-stu-id="933c1-143">When [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client is connected to [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions, server error 16947 is returned as a SQL_ERROR.</span></span> <span data-ttu-id="933c1-144">Esse erro ocorre quando uma atualização ou exclusão posicionada não atualiza ou exclui uma linha.</span><span class="sxs-lookup"><span data-stu-id="933c1-144">This error occurs when a positioned update or delete fails to update or delete a row.</span></span> <span data-ttu-id="933c1-145">Com o MDAC, ao estabelecer conexão com qualquer versão do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], o erro de servidor 16947 é retornado como um aviso (SQL_SUCCESS_WITH_INFO).</span><span class="sxs-lookup"><span data-stu-id="933c1-145">With MDAC when connecting to any version of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], server error 16947 is returned as a warning (SQL_SUCCESS_WITH_INFO).</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="933c1-146">O Native Client implementa a interface **IDBDataSourceAdmin** , que é uma interface opcional OLE DB que não foi implementada anteriormente, mas somente o método **createdataname** dessa interface opcional é implementado.</span><span class="sxs-lookup"><span data-stu-id="933c1-146">Native Client implements the **IDBDataSourceAdmin** interface, which is an optional OLE DB interface that was not previously implemented, but only the **CreateDataSource** method of this optional interface is implemented.</span></span> [!INCLUDE[ssNoteDepFutureAvoid](../../../includes/ssnotedepfutureavoid-md.md)]  
  
-   <span data-ttu-id="933c1-147">O provedor OLE DB do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client retorna sinônimos nos conjuntos de linhas de esquema TABLES e TABLE_INFO, com TABLE_TYPE definido como SYNONYM.</span><span class="sxs-lookup"><span data-stu-id="933c1-147">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns synonyms in the TABLES and TABLE_INFO schema rowsets, with TABLE_TYPE set to SYNONYM.</span></span>  
  
-   <span data-ttu-id="933c1-148">Valores de retorno de tipo de dados,,,, `varchar(max)` `nvarchar(max)` `varbinary(max)` `xml` `udt` ou outros tipos de objeto grandes não podem ser retornados para versões de cliente anteriores a [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="933c1-148">Return values of data type `varchar(max)`, `nvarchar(max)`, `varbinary(max)`, `xml`, `udt`, or other large object types can not be returned to client versions earlier than [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span></span> <span data-ttu-id="933c1-149">Caso queira usar esses tipos como valores de retorno, você deve usar o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="933c1-149">If you wish to use these types as return values, you must use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span></span>  
  
-   <span data-ttu-id="933c1-150">O MDAC permite que as seguintes instruções sejam executadas no início das transações manuais e implícitas, mas o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, não.</span><span class="sxs-lookup"><span data-stu-id="933c1-150">MDAC allows the following statements to be executed at the start of manual and implicit transactions, but [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client does not.</span></span> <span data-ttu-id="933c1-151">Elas devem ser executadas no modo de confirmação automática.</span><span class="sxs-lookup"><span data-stu-id="933c1-151">They must be executed in autocommit mode.</span></span>  
  
    -   <span data-ttu-id="933c1-152">Todas as operações de texto completo (indexar e catalogar DDL)</span><span class="sxs-lookup"><span data-stu-id="933c1-152">All full-text operations (index and catalog DDL)</span></span>  
  
    -   <span data-ttu-id="933c1-153">Todas as operações de banco de dados (criar, alterar, descartar banco de dados)</span><span class="sxs-lookup"><span data-stu-id="933c1-153">All database operations (create database, alter database, drop database)</span></span>  
  
    -   <span data-ttu-id="933c1-154">Reconfigurar</span><span class="sxs-lookup"><span data-stu-id="933c1-154">Reconfigure</span></span>  
  
    -   <span data-ttu-id="933c1-155">Shutdown</span><span class="sxs-lookup"><span data-stu-id="933c1-155">Shutdown</span></span>  
  
    -   <span data-ttu-id="933c1-156">Encerrar</span><span class="sxs-lookup"><span data-stu-id="933c1-156">Kill</span></span>  
  
    -   <span data-ttu-id="933c1-157">Backup</span><span class="sxs-lookup"><span data-stu-id="933c1-157">Backup</span></span>  
  
-   <span data-ttu-id="933c1-158">Quando os aplicativos do MDAC se conectarem ao [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], os tipos de dados introduzidos no [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] serão exibidos como tipos de dados compatíveis com o [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)], como mostrado na seguinte tabela.</span><span class="sxs-lookup"><span data-stu-id="933c1-158">When MDAC applications connect to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], the data types introduced in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] will appear as [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)]-compatible data types as shown in the following table.</span></span>  
  
    |<span data-ttu-id="933c1-159">Tipo SQL Server 2005</span><span class="sxs-lookup"><span data-stu-id="933c1-159">SQL Server 2005 type</span></span>|<span data-ttu-id="933c1-160">Tipo do SQL Server 2000</span><span class="sxs-lookup"><span data-stu-id="933c1-160">SQL Server 2000 type</span></span>|  
    |--------------------------|--------------------------|  
    |`varchar(max)`|`text`|  
    |`nvarchar(max)`|`ntext`|  
    |`varbinary(max)`|`image`|  
    |`udt`|`varbinary`|  
    |`xml`|`ntext`|  
  
     <span data-ttu-id="933c1-161">Esse mapeamento de tipo afeta os valores retornados para metadados da coluna.</span><span class="sxs-lookup"><span data-stu-id="933c1-161">This type mapping affects the values returned for column metadata.</span></span> <span data-ttu-id="933c1-162">Por exemplo, uma `text` coluna tem um tamanho máximo de 2.147.483.647, mas [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] o ODBC de cliente nativo relata o tamanho máximo das `varchar(max)` colunas como SQL_SS_LENGTH_UNLIMITED, e [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] o cliente nativo OLE DB relata o tamanho máximo das `varchar(max)` colunas como 2.147.483.647 ou-1, dependendo da plataforma.</span><span class="sxs-lookup"><span data-stu-id="933c1-162">For example, a `text` column has a maximum size of 2,147,483,647, but [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC reports the maximum size of `varchar(max)` columns as SQL_SS_LENGTH_UNLIMITED, and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB reports the maximum size of `varchar(max)` columns as 2,147,483,647 or -1, depending on platform.</span></span>  
  
-   <span data-ttu-id="933c1-163">O [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client permite ambiguidade em cadeias de conexão (por exemplo, algumas palavras-chave podem ser especificadas mais de uma vez e outras, conflitantes, permitidas tendo a resolução baseada na posição ou na precedência) tendo em vista a compatibilidade com versões anteriores.</span><span class="sxs-lookup"><span data-stu-id="933c1-163">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client allows ambiguity in connection strings (for example, some keywords may be specified more than once, and conflicting keywords may be allowed with resolution based on position or precedence) for reasons of backward compatibility.</span></span> <span data-ttu-id="933c1-164">Futuras versões do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client talvez não permitam ambiguidade em cadeias de conexão.</span><span class="sxs-lookup"><span data-stu-id="933c1-164">Future releases of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client might not allow ambiguity in connection strings.</span></span> <span data-ttu-id="933c1-165">Trata-se de uma boa prática, ao modificar aplicativos, usar o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client para eliminar todas as dependências relacionadas à ambiguidade da cadeia de conexão.</span><span class="sxs-lookup"><span data-stu-id="933c1-165">It is good practice when modifying applications to use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client to eliminate any dependency on connection string ambiguity.</span></span>  
  
-   <span data-ttu-id="933c1-166">Caso você use uma chamada ODBC ou OLE DB para iniciar transações, existe uma diferença de comportamento entre o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client e o MDAC. As transações começarão imediatamente com o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, e só começarão no MDAC depois do primeiro acesso ao banco de dados.</span><span class="sxs-lookup"><span data-stu-id="933c1-166">If you use an ODBC or OLE DB call to start transactions, there is a difference in behavior between [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client and MDAC; transactions will begin immediately with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, but transactions will begin after the first database access using MDAC.</span></span> <span data-ttu-id="933c1-167">Isso pode afetar o comportamento de procedimentos armazenados e lotes porque [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] o requer que \@ \@ TRANCOUNT seja o mesmo depois que um lote ou procedimento armazenado conclui a execução como era quando o lote ou procedimento armazenado foi iniciado.</span><span class="sxs-lookup"><span data-stu-id="933c1-167">This can affect the behavior of stored procedures and batches because [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] requires \@\@TRANCOUNT to be the same after a batch or stored procedure finishes execution as it was when the batch or stored procedure started.</span></span>  
  
-   <span data-ttu-id="933c1-168">Com [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] o Native Client, ITransactionLocal:: BeginTransaction fará com que uma transação seja iniciada imediatamente.</span><span class="sxs-lookup"><span data-stu-id="933c1-168">With [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, ITransactionLocal::BeginTransaction will cause a transaction to be started immediately.</span></span> <span data-ttu-id="933c1-169">Com o MDAC, o início da transação foi atrasado até que o aplicativo executasse uma instrução que exigia uma transação em modo de transação implícita.</span><span class="sxs-lookup"><span data-stu-id="933c1-169">With MDAC the transaction start was delayed until the application executed a statement which required a transaction in implicit transaction mode.</span></span> <span data-ttu-id="933c1-170">Para obter mais informações, consulte [SET IMPLICIT_TRANSACTIONS &#40;Transact-SQL&#41;](/sql/t-sql/statements/set-implicit-transactions-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="933c1-170">For more information, see [SET IMPLICIT_TRANSACTIONS &#40;Transact-SQL&#41;](/sql/t-sql/statements/set-implicit-transactions-transact-sql).</span></span>  
  
-   <span data-ttu-id="933c1-171">Você pode encontrar erros ao usar [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] o driver de cliente nativo com System. Data. ODBC para acessar um [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] computador servidor que expõe novos [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] recursos ou tipos de dados específicos.</span><span class="sxs-lookup"><span data-stu-id="933c1-171">You might encounter errors when using [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client driver with System.Data.Odbc to access a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] server computer that exposes new, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]-specific data types or features.</span></span> <span data-ttu-id="933c1-172">System. Data. ODBC fornece uma implementação ODBC genérica e, subsequentemente, não expõe a funcionalidade ou extensões específicas do fornecedor.</span><span class="sxs-lookup"><span data-stu-id="933c1-172">System.Data.Odbc provides a generic ODBC implementation and subsequently does not expose vendor specific functionality or extensions.</span></span> <span data-ttu-id="933c1-173">(O [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] O driver de cliente nativo é atualizado para dar suporte nativo aos recursos mais recentes [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .) Para solucionar esse problema, você pode reverter para o MDAC ou migrar para System. Data. SqlClient.</span><span class="sxs-lookup"><span data-stu-id="933c1-173">(The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client driver is updated to natively support the latest [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] features.) To workaround this issue, you can either revert to MDAC, or migrate to System.Data.SqlClient.</span></span>  
  
 <span data-ttu-id="933c1-174">Tanto o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client quanto o MDAC oferecem suporte ao isolamento de transação de leitura confirmada usando controle de versão de linha, mas apenas o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client oferece suporte ao isolamento da transação de instantâneo.</span><span class="sxs-lookup"><span data-stu-id="933c1-174">Both [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client and MDAC support read committed transaction isolation using row versioning, but only [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client supports snapshot transaction isolation.</span></span> <span data-ttu-id="933c1-175">(Em termos de programação, o isolamento de transação de leitura confirmada por meio do controle de versão de linha é igual à transação de leitura confirmada.)</span><span class="sxs-lookup"><span data-stu-id="933c1-175">(In programming terms, read committed transaction isolation using row versioning is the same as read-committed transaction.).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="933c1-176">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="933c1-176">See Also</span></span>  
 [<span data-ttu-id="933c1-177">Criando aplicativos com o SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="933c1-177">Building Applications with SQL Server Native Client</span></span>](building-applications-with-sql-server-native-client.md)  
  
  
