---
title: Chamando um procedimento armazenado (OLE DB) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- calling stored procedures
- RPC escape sequence
- OLE DB, stored procedures
- parameters [SQL Server Native Client], OLE DB
- ODBC CALL escape sequence
- stored procedures [OLE DB], calling
- SQL Server Native Client OLE DB provider, stored procedures
ms.assetid: 8e5738e5-4bbe-4f34-bd69-0c0633290bdd
author: rothja
ms.author: jroth
ms.openlocfilehash: 695848c8633d310f5e8ee21e9e738749d1550e4a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87684152"
---
# <a name="calling-a-stored-procedure-ole-db"></a><span data-ttu-id="8dd4c-102">Chamando um procedimento armazenado (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="8dd4c-102">Calling a Stored Procedure (OLE DB)</span></span>
  <span data-ttu-id="8dd4c-103">Um procedimento armazenado pode ter zero ou mais parâmetros.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-103">A stored procedure can have zero or more parameters.</span></span> <span data-ttu-id="8dd4c-104">Também pode retornar um valor.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-104">It can also return a value.</span></span> <span data-ttu-id="8dd4c-105">Ao usar o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] provedor de OLE DB de cliente nativo, os parâmetros para um procedimento armazenado podem ser passados por:</span><span class="sxs-lookup"><span data-stu-id="8dd4c-105">When using the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider, parameters to a stored procedure can be passed by:</span></span>  
  
-   <span data-ttu-id="8dd4c-106">Hard-coding o valor de dados.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-106">Hard-coding the data value.</span></span>  
  
-   <span data-ttu-id="8dd4c-107">Usando um marcador de parâmetro (?) para especificar parâmetros, associar uma variável de programa ao marcador de parâmetro e, em seguida, inserir o valor dos dados na variável de programa.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-107">Using a parameter marker (?) to specify parameters, bind a program variable to the parameter marker, and then place the data value in the program variable.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="8dd4c-108">Ao chamar procedimentos armazenados do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] que usam parâmetros denominados com o OLE DB, os nomes de parâmetros devem começar com o caractere '\@'.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-108">When calling [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] stored procedures using named parameters with OLE DB, the parameter names must start with the '\@' character.</span></span> <span data-ttu-id="8dd4c-109">Esta é uma restrição específica do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="8dd4c-109">This is a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] specific restriction.</span></span> <span data-ttu-id="8dd4c-110">O provedor OLE DB do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client impõe esta restrição mais estritamente que o MDAC.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-110">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider enforces this restriction more strictly than MDAC.</span></span>  
  
 <span data-ttu-id="8dd4c-111">Para dar suporte aos parâmetros, a interface **ICommandWithParameters** é exposta no objeto de comando.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-111">To support parameters, the **ICommandWithParameters** interface is exposed on the command object.</span></span> <span data-ttu-id="8dd4c-112">Para usar parâmetros, o consumidor primeiro descreve os parâmetros para o provedor, chamando o método **ICommandWithParameters::SetParameterInfo** (ou, como opção, prepara uma instrução de chamada que chama o método **GetParameterInfo**).</span><span class="sxs-lookup"><span data-stu-id="8dd4c-112">To use parameters, the consumer first describes the parameters to the provider by calling the **ICommandWithParameters::SetParameterInfo** method (or optionally prepares a calling statement that calls the **GetParameterInfo** method).</span></span> <span data-ttu-id="8dd4c-113">O consumidor cria um acessador que especifica a estrutura de um buffer e coloca os valores dos parâmetros nesse buffer.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-113">The consumer then creates an accessor that specifies the structure of a buffer and places parameter values in this buffer.</span></span> <span data-ttu-id="8dd4c-114">Finalmente, ele transmite o identificador do acessador e um ponteiro ao buffer para **Executar**.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-114">Finally, it passes the handle of the accessor and a pointer to the buffer to **Execute**.</span></span> <span data-ttu-id="8dd4c-115">Em chamadas posteriores para **Executar**, o consumidor coloca novos valores de parâmetros no buffer e chama **Executar** com o identificador do acessador e o ponteiro do buffer.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-115">On later calls to **Execute**, the consumer places new parameter values in the buffer and calls **Execute** with the accessor handle and buffer pointer.</span></span>  
  
 <span data-ttu-id="8dd4c-116">Um comando que chama um procedimento armazenado temporário usando parâmetros deve primeiro chamar **ICommandWithParameters::SetParameterInfo** para definir as informações do parâmetro, para que o comando possa ser preparado com êxito.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-116">A command that calls a temporary stored procedure using parameters must first call **ICommandWithParameters::SetParameterInfo** to define the parameter information, before the command can be successfully prepared.</span></span> <span data-ttu-id="8dd4c-117">Isto ocorre porque o nome interno de um procedimento armazenado temporário difere do nome externo usado por um cliente e SQLOLEDB não pode consultar as tabelas do sistema para determinar as informações dos parâmetros para um procedimento armazenado temporário.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-117">This is because the internal name for a temporary stored procedure differs from the external name used by a client and SQLOLEDB cannot query the system tables to determine the parameter information for a temporary stored procedure.</span></span>  
  
 <span data-ttu-id="8dd4c-118">Estas são as etapas no processo de associação de parâmetros:</span><span class="sxs-lookup"><span data-stu-id="8dd4c-118">These are the steps in the parameter binding process:</span></span>  
  
1.  <span data-ttu-id="8dd4c-119">Preencha as informações dos parâmetros em uma matriz de estruturas DBPARAMBINDINFO; isto é, nome do parâmetro, nome específico do provedor para o tipo de dados do parâmetro ou um nome de tipo de dados padrão, e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-119">Fill in the parameter information in an array of DBPARAMBINDINFO structures; that is, parameter name, provider-specific name for the data type of the parameter or a standard data type name, and so on.</span></span> <span data-ttu-id="8dd4c-120">Cada estrutura na matriz descreve um parâmetro.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-120">Each structure in the array describes one parameter.</span></span> <span data-ttu-id="8dd4c-121">Em seguida, essa matriz é transmitida ao método **SetParameterInfo**.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-121">This array is then passed to the **SetParameterInfo** method.</span></span>  
  
2.  <span data-ttu-id="8dd4c-122">Chame o método **ICommandWithParameters::SetParameterInfo** para descrever parâmetros ao provedor.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-122">Call the **ICommandWithParameters::SetParameterInfo** method to describe parameters to the provider.</span></span> <span data-ttu-id="8dd4c-123">**SetParameterInfo** especifica o tipo de dados nativo de cada parâmetro.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-123">**SetParameterInfo** specifies the native data type of each parameter.</span></span> <span data-ttu-id="8dd4c-124">Os argumentos de **SetParameterInfo** são:</span><span class="sxs-lookup"><span data-stu-id="8dd4c-124">**SetParameterInfo** arguments are:</span></span>  
  
    -   <span data-ttu-id="8dd4c-125">O número de parâmetros para o qual definir informações de tipo.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-125">The number of parameters for which to set type information.</span></span>  
  
    -   <span data-ttu-id="8dd4c-126">Uma matriz de ordinais de parâmetro para a qual definir informações de tipo.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-126">An array of parameter ordinals for which to set type information.</span></span>  
  
    -   <span data-ttu-id="8dd4c-127">Uma matriz de estruturas DBPARAMBINDINFO.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-127">An array of DBPARAMBINDINFO structures.</span></span>  
  
3.  <span data-ttu-id="8dd4c-128">Crie um acessador de parâmetro usando o comando **IAccessor::CreateAccessor**.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-128">Create a parameter accessor by using the **IAccessor::CreateAccessor** command.</span></span> <span data-ttu-id="8dd4c-129">O acessador especifica a estrutura de um buffer e coloca valores dos parâmetros no buffer.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-129">The accessor specifies the structure of a buffer and places parameter values in the buffer.</span></span> <span data-ttu-id="8dd4c-130">O comando **CreateAccessor** cria um acessador de um conjunto de associações.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-130">The **CreateAccessor** command creates an accessor from a set of bindings.</span></span> <span data-ttu-id="8dd4c-131">Essas associações são descritas pelo consumidor usando uma matriz de estruturas DBBINDING.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-131">These bindings are described by the consumer by using an array of DBBINDING structures.</span></span> <span data-ttu-id="8dd4c-132">Cada associação liga um único parâmetro ao buffer do consumidor e contém informações como:</span><span class="sxs-lookup"><span data-stu-id="8dd4c-132">Each binding associates a single parameter to the buffer of the consumer and contains information such as:</span></span>  
  
    -   <span data-ttu-id="8dd4c-133">O ordinal do parâmetro ao qual a associação se aplica.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-133">The ordinal of the parameter to which the binding applies.</span></span>  
  
    -   <span data-ttu-id="8dd4c-134">O que é associado (o valor de dados, seu comprimento e seu status).</span><span class="sxs-lookup"><span data-stu-id="8dd4c-134">What is bound (the data value, its length, and its status).</span></span>  
  
    -   <span data-ttu-id="8dd4c-135">O deslocamento no buffer para cada uma destas partes.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-135">The offset in the buffer to each of these parts.</span></span>  
  
    -   <span data-ttu-id="8dd4c-136">O comprimento e o tipo do valor de dados, como existe no buffer do consumidor.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-136">The length and type of the data value as it exists in the buffer of the consumer.</span></span>  
  
     <span data-ttu-id="8dd4c-137">Um acessador é reconhecido por seu identificador, que é do tipo HACCESSOR.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-137">An accessor is identified by its handle, which is of type HACCESSOR.</span></span> <span data-ttu-id="8dd4c-138">Esse identificador é retornado pelo método **CreateAccessor**.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-138">This handle is returned by the **CreateAccessor** method.</span></span> <span data-ttu-id="8dd4c-139">Sempre que o consumidor termina de usar um acessador, o consumidor deve chamar o método **ReleaseAccessor** para liberar a memória que ele detém.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-139">Whenever the consumer finishes using an accessor, the consumer must call the **ReleaseAccessor** method to release the memory it holds.</span></span>  
  
     <span data-ttu-id="8dd4c-140">Quando o consumidor chama um método, como **ICommand::Execute**, transmite o identificador a um acessador e um ponteiro para um buffer propriamente dito.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-140">When the consumer calls a method, such as **ICommand::Execute**, it passes the handle to an accessor and a pointer to a buffer itself.</span></span> <span data-ttu-id="8dd4c-141">O provedor usa esse acessador para determinar como transferir os dados contidos no buffer.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-141">The provider uses this accessor to determine how to transfer the data contained in the buffer.</span></span>  
  
4.  <span data-ttu-id="8dd4c-142">Preencha a estrutura DBPARAMS.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-142">Fill in the DBPARAMS structure.</span></span> <span data-ttu-id="8dd4c-143">As variáveis do consumidor das quais os valores dos parâmetros são obtidos e nas quais os valores dos parâmetros de saída são gravados são transmitidas em tempo de execução para **ICommand::Execute** na estrutura DBPARAMS.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-143">The consumer variables from which input parameter values are taken and to which output parameter values are written are passed at run time to **ICommand::Execute** in the DBPARAMS structure.</span></span> <span data-ttu-id="8dd4c-144">A estrutura DBPARAMS inclui três elementos:</span><span class="sxs-lookup"><span data-stu-id="8dd4c-144">The DBPARAMS structure includes three elements:</span></span>  
  
    -   <span data-ttu-id="8dd4c-145">Um ponteiro para o buffer do qual o provedor recupera dados de parâmetro de entrada e para o qual o provedor retorna dados de parâmetro de saída, de acordo com as associações especificadas pelo identificador do acessador.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-145">A pointer to the buffer from which the provider retrieves input parameter data and to which the provider returns output parameter data, according to the bindings specified by the accessor handle.</span></span>  
  
    -   <span data-ttu-id="8dd4c-146">O número de conjuntos de parâmetros no buffer.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-146">The number of sets of parameters in the buffer.</span></span>  
  
    -   <span data-ttu-id="8dd4c-147">O identificador do acessador criado na Etapa 3.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-147">The accessor handle created in Step 3.</span></span>  
  
5.  <span data-ttu-id="8dd4c-148">Execute o comando usando **ICommand::Execute**.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-148">Execute the command by using **ICommand::Execute**.</span></span>  
  
## <a name="methods-of-calling-a-stored-procedure"></a><span data-ttu-id="8dd4c-149">Métodos de chamar um procedimento armazenado</span><span class="sxs-lookup"><span data-stu-id="8dd4c-149">Methods of Calling a Stored Procedure</span></span>  
 <span data-ttu-id="8dd4c-150">Ao executar um procedimento armazenado no [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] provedor de OLE DB de cliente nativo dá suporte ao:</span><span class="sxs-lookup"><span data-stu-id="8dd4c-150">When executing a stored procedure in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider supports the:</span></span>  
  
-   <span data-ttu-id="8dd4c-151">Sequência de escape CALL do ODBC.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-151">ODBC CALL escape sequence.</span></span>  
  
-   <span data-ttu-id="8dd4c-152">Sequência de escape RPC (Chamada de Procedimento Remoto).</span><span class="sxs-lookup"><span data-stu-id="8dd4c-152">Remote procedure call (RPC) escape sequence.</span></span>  
  
-   <span data-ttu-id="8dd4c-153">Instrução [!INCLUDE[tsql](../../../includes/tsql-md.md)] EXECUTE.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-153">[!INCLUDE[tsql](../../../includes/tsql-md.md)] EXECUTE statement.</span></span>  
  
### <a name="odbc-call-escape-sequence"></a><span data-ttu-id="8dd4c-154">Sequência de escape ODBC CALL</span><span class="sxs-lookup"><span data-stu-id="8dd4c-154">ODBC CALL Escape Sequence</span></span>  
 <span data-ttu-id="8dd4c-155">Se você souber informações de parâmetro, chame o método **ICommandWithParameters::SetParameterInfo** para descrever os parâmetros ao provedor.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-155">If you know parameter information, call **ICommandWithParameters::SetParameterInfo** method to describe the parameters to the provider.</span></span> <span data-ttu-id="8dd4c-156">Caso contrário, quando a sintaxe ODBC CALL for usada na chamada de um procedimento armazenado, o provedor chamará uma função auxiliar para localizar as informações de parâmetros do procedimento armazenado.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-156">Otherwise, when the ODBC CALL syntax is used in calling a stored procedure, the provider calls a helper function to find the stored procedure parameter information.</span></span>  
  
 <span data-ttu-id="8dd4c-157">Se você não tiver certeza sobre as informações de parâmetro (metadados de parâmetro), a sintaxe do ODBC CALL será recomendada.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-157">If you are not sure about the parameter information (parameter metadata), ODBC CALL syntax is recommended.</span></span>  
  
 <span data-ttu-id="8dd4c-158">A sintaxe geral para chamar um procedimento usando a sequência de escape ODBC CALL é:</span><span class="sxs-lookup"><span data-stu-id="8dd4c-158">The general syntax for calling a procedure by using the ODBC CALL escape sequence is:</span></span>  
  
 <span data-ttu-id="8dd4c-159">{[**? =**]**chamar**_procedure_name_[**(**[*parâmetro*] [**,**[*Parameter*]]... **)**]}</span><span class="sxs-lookup"><span data-stu-id="8dd4c-159">{[**?=**]**call**_procedure_name_[**(**[*parameter*][**,**[*parameter*]]...**)**]}</span></span>  
  
 <span data-ttu-id="8dd4c-160">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="8dd4c-160">For example:</span></span>  
  
```  
{call SalesByCategory('Produce', '1995')}  
```  
  
### <a name="rpc-escape-sequence"></a><span data-ttu-id="8dd4c-161">Sequência de escape RPC</span><span class="sxs-lookup"><span data-stu-id="8dd4c-161">RPC Escape Sequence</span></span>  
 <span data-ttu-id="8dd4c-162">A sequência de escape RPC é semelhante à sintaxe ODBC CALL de chamar um procedimento armazenado.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-162">The RPC escape sequence is similar to the ODBC CALL syntax of calling a stored procedure.</span></span> <span data-ttu-id="8dd4c-163">Se você for chamar o procedimento várias vezes, a sequência de escape RPC proporcionará o melhor desempenho possível entre os três métodos de chamada de um procedimento armazenado.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-163">If you will call the procedure multiple times, the RPC escape sequence provides most optimal performance among the three methods of calling a stored procedure.</span></span>  
  
 <span data-ttu-id="8dd4c-164">Quando a sequência de escape RPC é usada para executar um procedimento armazenado, o provedor não chama nenhuma função auxiliar para determinar as informações dos parâmetros (como ela faz no caso da sintaxe de ODBC CALL).</span><span class="sxs-lookup"><span data-stu-id="8dd4c-164">When the RPC escape sequence is used to execute a stored procedure, the provider does not call any helper function to determine the parameter information (as it does in the case of ODBC CALL syntax).</span></span> <span data-ttu-id="8dd4c-165">A sintaxe de RPC é mais simples que a sintaxe de ODBC CALL, assim o comando é analisado mais rápido, melhorando o desempenho.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-165">The RPC syntax is simpler than the ODBC CALL syntax, so the command is parsed faster, improving performance.</span></span> <span data-ttu-id="8dd4c-166">Neste caso, você precisa fornecer as informações de parâmetro executando **ICommandWithParameters::SetParameterInfo**.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-166">In this case, you need to provide the parameter information by executing **ICommandWithParameters::SetParameterInfo**.</span></span>  
  
 <span data-ttu-id="8dd4c-167">A sequência de escape RPC exige que você tenha um valor de retorno.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-167">The RPC escape sequence requires you to have a return value.</span></span> <span data-ttu-id="8dd4c-168">Se o procedimento armazenado não retornar um valor, o servidor retornará um 0 por padrão.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-168">If the stored procedure does not return a value, the server returns a 0 by default.</span></span> <span data-ttu-id="8dd4c-169">Além disso, você não pode abrir um cursor do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] no procedimento armazenado.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-169">In addition, you cannot open a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] cursor on the stored procedure.</span></span> <span data-ttu-id="8dd4c-170">O procedimento armazenado é implicitamente preparado e a chamada a **ICommandPrepare::Prepare** falhará.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-170">The stored procedure is prepared implicitly and the call to **ICommandPrepare::Prepare** will fail.</span></span> <span data-ttu-id="8dd4c-171">Devido à impossibilidade de preparar uma chamada RPC, você não pode consultar metadados de coluna; IColumnsInfo::GetColumnInfo e IColumnsRowset::GetColumnsRowset retornarão DB_E_NOTPREPARED.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-171">Because of the inability to prepare an RPC call, you can not query column metadata; IColumnsInfo::GetColumnInfo and IColumnsRowset::GetColumnsRowset will return DB_E_NOTPREPARED.</span></span>  
  
 <span data-ttu-id="8dd4c-172">Se você souber todos os metadados de parâmetro, a sequência de escape RPC será o modo recomendado para executar procedimentos armazenados.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-172">If you know all the parameter metadata, RPC escape sequence is the recommended way to execute stored procedures.</span></span>  
  
 <span data-ttu-id="8dd4c-173">Este é um exemplo de sequência de escape RPC para chamar um procedimento armazenado:</span><span class="sxs-lookup"><span data-stu-id="8dd4c-173">This is an example of RPC escape sequence for calling a stored procedure:</span></span>  
  
```  
{rpc SalesByCategory}  
```  
  
 <span data-ttu-id="8dd4c-174">Para um aplicativo de exemplo que demonstra uma sequência de escape RPC, confira [Executar um procedimento armazenado &#40;usando a sintaxe RPC&#41; e processar códigos de retorno e parâmetros de saída &#40;OLE DB&#41;](../../native-client-ole-db-how-to/results/execute-stored-procedure-with-rpc-and-process-output.md).</span><span class="sxs-lookup"><span data-stu-id="8dd4c-174">For a sample application that demonstrates an RPC escape sequence, see [Execute a Stored Procedure &#40;Using RPC Syntax&#41; and Process Return Codes and Output Parameters &#40;OLE DB&#41;](../../native-client-ole-db-how-to/results/execute-stored-procedure-with-rpc-and-process-output.md).</span></span>  
  
### <a name="transact-sql-execute-statement"></a><span data-ttu-id="8dd4c-175">Instrução Transact-SQL EXECUTE</span><span class="sxs-lookup"><span data-stu-id="8dd4c-175">Transact-SQL EXECUTE Statement</span></span>  
 <span data-ttu-id="8dd4c-176">A sequência de escape ODBC CALL e a sequência de escape RPC são os métodos preferidos para chamar um procedimento armazenado no lugar da instrução [EXECUTE](/sql/t-sql/language-elements/execute-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="8dd4c-176">The ODBC CALL escape sequence and the RPC escape sequence are the preferred methods for calling a stored procedure rather than the [EXECUTE](/sql/t-sql/language-elements/execute-transact-sql) statement.</span></span> <span data-ttu-id="8dd4c-177">O [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] provedor de OLE DB de cliente nativo usa o mecanismo RPC do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] para otimizar o processamento de comandos.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-177">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider uses the RPC mechanism of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] to optimize command processing.</span></span> <span data-ttu-id="8dd4c-178">Este protocolo de RPC aumenta o desempenho, eliminando grande parte do processamento de parâmetros e da análise da instrução feita no servidor.</span><span class="sxs-lookup"><span data-stu-id="8dd4c-178">This RPC protocol increases performance by eliminating much of the parameter processing and statement parsing done on the server.</span></span>  
  
 <span data-ttu-id="8dd4c-179">Este é um exemplo da instrução  **EXECUTE** do [!INCLUDE[tsql](../../../includes/tsql-md.md)]:</span><span class="sxs-lookup"><span data-stu-id="8dd4c-179">This is an example of the [!INCLUDE[tsql](../../../includes/tsql-md.md)] **EXECUTE** statement:</span></span>  
  
```  
EXECUTE SalesByCategory 'Produce', '1995'  
```  
  
## <a name="see-also"></a><span data-ttu-id="8dd4c-180">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="8dd4c-180">See Also</span></span>  
 [<span data-ttu-id="8dd4c-181">Procedimentos armazenados</span><span class="sxs-lookup"><span data-stu-id="8dd4c-181">Stored Procedures</span></span>](stored-procedures.md)  
  
  
