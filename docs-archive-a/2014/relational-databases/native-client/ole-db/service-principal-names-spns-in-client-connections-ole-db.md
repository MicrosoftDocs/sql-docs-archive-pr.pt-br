---
title: SPNs (Nomes da Entidade de Serviço) em conexões de cliente (OLE DB) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
ms.assetid: e212010e-a5b6-4ad1-a3c0-575327d3ffd3
author: rothja
ms.author: jroth
ms.openlocfilehash: cd88b11eb7416be869dce3c9ea166787f88d9ee7
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87570651"
---
# <a name="service-principal-names-spns-in-client-connections-ole-db"></a><span data-ttu-id="88b4d-102">SPNs (Nomes da Entidade de Serviço) em conexões de cliente (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="88b4d-102">Service Principal Names (SPNs) in Client Connections (OLE DB)</span></span>
  <span data-ttu-id="88b4d-103">Este tópico descreve as propriedades OLE DB e as funções de membro que dão suporte a SPNs (nomes da entidade de serviço) em aplicativos clientes.</span><span class="sxs-lookup"><span data-stu-id="88b4d-103">This topic describes OLE DB properties and member functions that support service principal names (SPNs) in client applications.</span></span> <span data-ttu-id="88b4d-104">Para obter mais informações sobre SPNs em aplicativos cliente, confira [Nome da entidade de serviço &#40;SPN&#41; Suporte em conexões de cliente](../features/service-principal-name-spn-support-in-client-connections.md).</span><span class="sxs-lookup"><span data-stu-id="88b4d-104">For more information about SPNs in client applications, see [Service Principal Name &#40;SPN&#41; Support in Client Connections](../features/service-principal-name-spn-support-in-client-connections.md).</span></span> <span data-ttu-id="88b4d-105">Para ver um exemplo, confira [Autenticação Kerberos integrada &#40;OLE DB&#41;](../../native-client-ole-db-how-to/integrated-kerberos-authentication-ole-db.md).</span><span class="sxs-lookup"><span data-stu-id="88b4d-105">For a sample, see [Integrated Kerberos Authentication &#40;OLE DB&#41;](../../native-client-ole-db-how-to/integrated-kerberos-authentication-ole-db.md).</span></span>  
  
## <a name="provider-initialization-string-keywords"></a><span data-ttu-id="88b4d-106">Palavras-chave da cadeia de caracteres de inicialização do provedor</span><span class="sxs-lookup"><span data-stu-id="88b4d-106">Provider Initialization String Keywords</span></span>  
 <span data-ttu-id="88b4d-107">As palavras-chave da cadeia de caracteres de inicialização de provedor a seguir dão suporte a SPNs em aplicativos OLE DB.</span><span class="sxs-lookup"><span data-stu-id="88b4d-107">The following provider initialization string keywords support SPNs in OLE DB applications.</span></span> <span data-ttu-id="88b4d-108">Na tabela a seguir, os valores na coluna de palavra-chave são usados para a cadeia de caracteres do provedor de IDBInitialize::Initialize.</span><span class="sxs-lookup"><span data-stu-id="88b4d-108">In the following table, the values in the keyword column are used for the provider string of IDBInitialize::Initialize.</span></span> <span data-ttu-id="88b4d-109">Os valores na coluna de descrição são usados em cadeias de inicialização na conexão usando o ADO ou IDataInitialize::GetDataSource.</span><span class="sxs-lookup"><span data-stu-id="88b4d-109">The values in the description column are used in initialization strings when connecting using ADO or IDataInitialize::GetDataSource.</span></span>  
  
|<span data-ttu-id="88b4d-110">Palavra-chave</span><span class="sxs-lookup"><span data-stu-id="88b4d-110">Keyword</span></span>|<span data-ttu-id="88b4d-111">Descrição</span><span class="sxs-lookup"><span data-stu-id="88b4d-111">Description</span></span>|<span data-ttu-id="88b4d-112">Valor</span><span class="sxs-lookup"><span data-stu-id="88b4d-112">Value</span></span>|  
|-------------|-----------------|-----------|  
|<span data-ttu-id="88b4d-113">ServerSPN</span><span class="sxs-lookup"><span data-stu-id="88b4d-113">ServerSPN</span></span>|<span data-ttu-id="88b4d-114">SPN do servidor</span><span class="sxs-lookup"><span data-stu-id="88b4d-114">Server SPN</span></span>|<span data-ttu-id="88b4d-115">O SPN do servidor.</span><span class="sxs-lookup"><span data-stu-id="88b4d-115">The SPN for the server.</span></span> <span data-ttu-id="88b4d-116">O valor padrão é uma cadeia de caracteres vazia, que faz com que o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client use o SPN padrão gerado pelo provedor.</span><span class="sxs-lookup"><span data-stu-id="88b4d-116">The default value is an empty string, which causes [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client to use the default, provider-generated SPN.</span></span>|  
|<span data-ttu-id="88b4d-117">FailoverPartnerSPN</span><span class="sxs-lookup"><span data-stu-id="88b4d-117">FailoverPartnerSPN</span></span>|<span data-ttu-id="88b4d-118">SPN do parceiro de failover:</span><span class="sxs-lookup"><span data-stu-id="88b4d-118">Failover Partner SPN</span></span>|<span data-ttu-id="88b4d-119">O SPN do parceiro de failover.</span><span class="sxs-lookup"><span data-stu-id="88b4d-119">The SPN for the failover partner.</span></span> <span data-ttu-id="88b4d-120">O valor padrão é uma cadeia de caracteres vazia, que faz com que o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client use o SPN padrão gerado pelo provedor.</span><span class="sxs-lookup"><span data-stu-id="88b4d-120">The default value is an empty string, which causes [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client to use the default, provider-generated SPN.</span></span>|  
  
## <a name="data-source-initialization-properties"></a><span data-ttu-id="88b4d-121">Propriedades de inicialização da fonte de dados</span><span class="sxs-lookup"><span data-stu-id="88b4d-121">Data Source Initialization Properties</span></span>  
 <span data-ttu-id="88b4d-122">As propriedades a seguir do conjunto de propriedades `DBPROPSET_SQLSERVERDBINIT` permitem que os aplicativos especifiquem SPNs.</span><span class="sxs-lookup"><span data-stu-id="88b4d-122">The following properties in the `DBPROPSET_SQLSERVERDBINIT` property set allow applications to specify SPNs.</span></span>  
  
|<span data-ttu-id="88b4d-123">Nome</span><span class="sxs-lookup"><span data-stu-id="88b4d-123">Name</span></span>|<span data-ttu-id="88b4d-124">Tipo</span><span class="sxs-lookup"><span data-stu-id="88b4d-124">Type</span></span>|<span data-ttu-id="88b4d-125">Uso</span><span class="sxs-lookup"><span data-stu-id="88b4d-125">Usage</span></span>|  
|----------|----------|-----------|  
|<span data-ttu-id="88b4d-126">SSPROP_INIT_SERVERSPN</span><span class="sxs-lookup"><span data-stu-id="88b4d-126">SSPROP_INIT_SERVERSPN</span></span>|<span data-ttu-id="88b4d-127">VT_BSTR, leitura/gravação</span><span class="sxs-lookup"><span data-stu-id="88b4d-127">VT_BSTR, read/write</span></span>|<span data-ttu-id="88b4d-128">Especifica o SPN do servidor.</span><span class="sxs-lookup"><span data-stu-id="88b4d-128">Specifies the SPN for the server.</span></span> <span data-ttu-id="88b4d-129">O valor padrão é uma cadeia de caracteres vazia, que faz com que o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client use o SPN padrão gerado pelo provedor.</span><span class="sxs-lookup"><span data-stu-id="88b4d-129">The default value is an empty string, which causes [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client to use the default, provider-generated SPN.</span></span>|  
|<span data-ttu-id="88b4d-130">SSPROP_INIT_FAILOVERPARTNERSPN</span><span class="sxs-lookup"><span data-stu-id="88b4d-130">SSPROP_INIT_FAILOVERPARTNERSPN</span></span>|<span data-ttu-id="88b4d-131">VT_BSTR, leitura/gravação</span><span class="sxs-lookup"><span data-stu-id="88b4d-131">VT_BSTR, read/write</span></span>|<span data-ttu-id="88b4d-132">Especifica o SPN para o parceiro de failover.</span><span class="sxs-lookup"><span data-stu-id="88b4d-132">Specifies the SPN for the failover partner.</span></span> <span data-ttu-id="88b4d-133">O valor padrão é uma cadeia de caracteres vazia, que faz com que o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client use o SPN padrão gerado pelo provedor.</span><span class="sxs-lookup"><span data-stu-id="88b4d-133">The default value is an empty string, which causes [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client to use the default, provider-generated SPN.</span></span>|  
  
## <a name="data-source-properties"></a><span data-ttu-id="88b4d-134">Propriedades de fonte de dados</span><span class="sxs-lookup"><span data-stu-id="88b4d-134">Data Source Properties</span></span>  
 <span data-ttu-id="88b4d-135">As propriedades a seguir do conjunto de propriedades `DBPROPSET_SQLSERVERDATASOURCEINFO` permitem que os aplicativos descubram o método de autenticação.</span><span class="sxs-lookup"><span data-stu-id="88b4d-135">The following properties in the `DBPROPSET_SQLSERVERDATASOURCEINFO` property set allow applications to discover the authentication method.</span></span>  
  
|<span data-ttu-id="88b4d-136">Nome</span><span class="sxs-lookup"><span data-stu-id="88b4d-136">Name</span></span>|<span data-ttu-id="88b4d-137">Tipo</span><span class="sxs-lookup"><span data-stu-id="88b4d-137">Type</span></span>|<span data-ttu-id="88b4d-138">Uso</span><span class="sxs-lookup"><span data-stu-id="88b4d-138">Usage</span></span>|  
|----------|----------|-----------|  
|<span data-ttu-id="88b4d-139">SSPROP_INTEGRATEDAUTHENTICATIONMETHOD</span><span class="sxs-lookup"><span data-stu-id="88b4d-139">SSPROP_INTEGRATEDAUTHENTICATIONMETHOD</span></span>|<span data-ttu-id="88b4d-140">VT_BSTR, somente leitura</span><span class="sxs-lookup"><span data-stu-id="88b4d-140">VT_BSTR, readonly</span></span>|<span data-ttu-id="88b4d-141">Retorna o método de autenticação usado para a conexão.</span><span class="sxs-lookup"><span data-stu-id="88b4d-141">Returns the authentication method used for the connection.</span></span> <span data-ttu-id="88b4d-142">O valor retornado ao aplicativo é o valor que o Windows retorna ao [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="88b4d-142">The value returned to the application is the value that Windows returns to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span></span> <span data-ttu-id="88b4d-143">O valores possíveis são os seguintes:</span><span class="sxs-lookup"><span data-stu-id="88b4d-143">The following are possible values:</span></span><br /><br /> <span data-ttu-id="88b4d-144">-"NTLM", que é retornado quando uma conexão é aberta usando a autenticação NTLM.</span><span class="sxs-lookup"><span data-stu-id="88b4d-144">-   "NTLM", which is returned when a connection is opened using NTLM authentication.</span></span><br /><span data-ttu-id="88b4d-145">-"Kerberos", que é retornado quando uma conexão é aberta usando a autenticação Kerberos.</span><span class="sxs-lookup"><span data-stu-id="88b4d-145">-   "Kerberos", which is returned when a connection is opened using Kerberos authentication.</span></span><br /><br /> <span data-ttu-id="88b4d-146">Se uma conexão foi aberta e não for possível determinar o método de autenticação, VT_EMPTY será retornado.</span><span class="sxs-lookup"><span data-stu-id="88b4d-146">If a connection has been opened and the authentication method cannot be determined, VT_EMPTY is returned.</span></span><br /><br /> <span data-ttu-id="88b4d-147">Essa propriedade só pode ser lida quando uma fonte de dados tiver sido inicializada.</span><span class="sxs-lookup"><span data-stu-id="88b4d-147">This property can only be read when a data source has been initialized.</span></span> <span data-ttu-id="88b4d-148">Se você tentar ler a propriedade antes da inicialização da fonte de dados, IDBProperties::GetProperies retornará DB_S_ERRORSOCCURRED ou DB_E_ERRORSOCCURRED, conforme apropriado, e DBPROPSTATUS_NOTSUPPORTED será definido em DBPROPSET_PROPERTIESINERROR para essa propriedade.</span><span class="sxs-lookup"><span data-stu-id="88b4d-148">If you attempt to read the property before a data source has been initialized, IDBProperties::GetProperies will return DB_S_ERRORSOCCURRED or DB_E_ERRORSOCCURRED, as appropriate, and DBPROPSTATUS_NOTSUPPORTED will be set in DBPROPSET_PROPERTIESINERROR for this property.</span></span> <span data-ttu-id="88b4d-149">Esse comportamento está de acordo com a especificação principal do OLE DB.</span><span class="sxs-lookup"><span data-stu-id="88b4d-149">This behavior is in accordance with the OLE DB core specification.</span></span>|  
|<span data-ttu-id="88b4d-150">SSPROP_MUTUALLYAUTHENICATED</span><span class="sxs-lookup"><span data-stu-id="88b4d-150">SSPROP_MUTUALLYAUTHENICATED</span></span>|<span data-ttu-id="88b4d-151">VT_BOOL, somente leitura</span><span class="sxs-lookup"><span data-stu-id="88b4d-151">VT_BOOL, readonly</span></span>|<span data-ttu-id="88b4d-152">Retorna VARIANT_TRUE se os servidores da conexão forem autenticados mutuamente. Caso contrário, retorna VARIANT_FALSE.</span><span class="sxs-lookup"><span data-stu-id="88b4d-152">Returns VARIANT_TRUE if the servers on the connection were mutually authenticated; otherwise, returns VARIANT_FALSE.</span></span><br /><br /> <span data-ttu-id="88b4d-153">Essa propriedade só pode ser lida quando uma fonte de dados tiver sido inicializada.</span><span class="sxs-lookup"><span data-stu-id="88b4d-153">This property can only be read when a data source has been initialized.</span></span> <span data-ttu-id="88b4d-154">Se houver uma tentativa de ler a propriedade antes da inicialização da fonte de dados, IDBProperties::GetProperies retornará DB_S_ERRORSOCCURRED ou DB_E_ERRORSOCCURRED, conforme apropriado, e DBPROPSTATUS_NOTSUPPORTED será definido em DBPROPSET_PROPERTIESINERROR para essa propriedade.</span><span class="sxs-lookup"><span data-stu-id="88b4d-154">If there is an attempt to read the property before a data source has been initialized, IDBProperties::GetProperies will return DB_S_ERRORSOCCURRED or DB_E_ERRORSOCCURRED, as appropriate, and DBPROPSTATUS_NOTSUPPORTED will be set in DBPROPSET_PROPERTIESINERROR for this property.</span></span> <span data-ttu-id="88b4d-155">Esse comportamento está de acordo com a especificação principal do OLE DB</span><span class="sxs-lookup"><span data-stu-id="88b4d-155">This behavior is in accordance with the OLE DB core specification</span></span><br /><br /> <span data-ttu-id="88b4d-156">Se esse atributo for consultado para uma conexão que não usou a Autenticação do Windows, será retornado VARIANT_FALSE.</span><span class="sxs-lookup"><span data-stu-id="88b4d-156">If this attribute is queried for a connection that did not use Windows Authentication, VARIANT_FALSE is returned.</span></span>|  
  
## <a name="ole-db-api-support-for-spns"></a><span data-ttu-id="88b4d-157">Suporte de API do OLE DB para SPNs</span><span class="sxs-lookup"><span data-stu-id="88b4d-157">OLE DB API Support for SPNs</span></span>  
 <span data-ttu-id="88b4d-158">A tabela a seguir descreve o as funções do membro OLE DB que dá suporte a SPNs em conexões do cliente:</span><span class="sxs-lookup"><span data-stu-id="88b4d-158">The following table describes the OLE DB member functions that support SPNs in client connections:</span></span>  
  
|<span data-ttu-id="88b4d-159">Função de membro</span><span class="sxs-lookup"><span data-stu-id="88b4d-159">Member function</span></span>|<span data-ttu-id="88b4d-160">Descrição</span><span class="sxs-lookup"><span data-stu-id="88b4d-160">Description</span></span>|  
|---------------------|-----------------|  
|<span data-ttu-id="88b4d-161">IDataInitialize::GetDataSource</span><span class="sxs-lookup"><span data-stu-id="88b4d-161">IDataInitialize::GetDataSource</span></span>|<span data-ttu-id="88b4d-162">*pwszInitializationString* pode conter as novas palavras-chave `ServerSPN` e `FailoverPartnerSPN` .</span><span class="sxs-lookup"><span data-stu-id="88b4d-162">*pwszInitializationString* can contain the new keywords `ServerSPN` and `FailoverPartnerSPN`.</span></span>|  
|<span data-ttu-id="88b4d-163">IDataInitialize::GetInitializationString</span><span class="sxs-lookup"><span data-stu-id="88b4d-163">IDataInitialize::GetInitializationString</span></span>|<span data-ttu-id="88b4d-164">Se SSPROP_INIT_SERVERSPN e SSPROP_INIT_FAILOVERPARTNERSPN tiverem valores não padrão, eles serão incluídos na cadeia de inicialização por meio de *ppwszInitString* como valores de palavra-chave para `ServerSPN` e `FailoverPartnerSPN` .</span><span class="sxs-lookup"><span data-stu-id="88b4d-164">If SSPROP_INIT_SERVERSPN and SSPROP_INIT_FAILOVERPARTNERSPN have non-default values, they will be included in the initialization string through *ppwszInitString* as keyword values for `ServerSPN` and `FailoverPartnerSPN`.</span></span> <span data-ttu-id="88b4d-165">Caso contrário, essas palavras-chave não serão incluídas na cadeia de inicialização.</span><span class="sxs-lookup"><span data-stu-id="88b4d-165">Otherwise, these keywords will not be included in the initialization string.</span></span>|  
|<span data-ttu-id="88b4d-166">IDBInitialize::Initialize</span><span class="sxs-lookup"><span data-stu-id="88b4d-166">IDBInitialize::Initialize</span></span>|<span data-ttu-id="88b4d-167">Se o aviso for habilitado pela definição de DBPROP_INIT_PROMPT nas propriedades de inicialização da fonte de dados, a caixa de diálogo Logon no OLE DB será exibida.</span><span class="sxs-lookup"><span data-stu-id="88b4d-167">If prompting is enabled by setting DBPROP_INIT_PROMPT in the data source initialization properties, the OLE DB Login dialog box will be displayed.</span></span> <span data-ttu-id="88b4d-168">Isto permite que os SPNs sejam inseridos no servidor principal e no seu parceiro de failover.</span><span class="sxs-lookup"><span data-stu-id="88b4d-168">This allows SPNs to be entered for both the principal server and its failover partner.</span></span><br /><br /> <span data-ttu-id="88b4d-169">A cadeia de caracteres do provedor em DPPROP_INIT_PROVIDERSTRING, se definido, reconhecerá as novas palavras-chave `ServerSPN` e `FailoverPartnerSPN` usará seus valores, se estiverem presentes, para inicializar SSPROP_INIT_SERVER_SPN e SSPROP_INIT_FAILOVER_PARTNER_SPN.</span><span class="sxs-lookup"><span data-stu-id="88b4d-169">The provider string in DPPROP_INIT_PROVIDERSTRING, if set, will recognize the new keywords `ServerSPN` and `FailoverPartnerSPN` and use their values, if present, to initialize SSPROP_INIT_SERVER_SPN and SSPROP_INIT_FAILOVER_PARTNER_SPN.</span></span><br /><br /> <span data-ttu-id="88b4d-170">IDBProperties::SetProperties pode ser chamada para definir as propriedades SSPROP_INIT_SERVER_SPN e SSPROP_INIT_FAILOVER_PARTNER_SPN antes de IDBInitialize::Initialize ser chamado.</span><span class="sxs-lookup"><span data-stu-id="88b4d-170">IDBProperties::SetProperties can be called to set the properties SSPROP_INIT_SERVER_SPN and SSPROP_INIT_FAILOVER_PARTNER_SPN before IDBInitialize::Initialize is called.</span></span> <span data-ttu-id="88b4d-171">Essa é uma alternativa ao uso de uma cadeia de caracteres de provedor.</span><span class="sxs-lookup"><span data-stu-id="88b4d-171">This is an alternative to using a provider string.</span></span><br /><br /> <span data-ttu-id="88b4d-172">Se uma propriedade for definida em mais de um local, um valor definido programaticamente terá precedência sobre um conjunto de valor na cadeia de caracteres de provedor.</span><span class="sxs-lookup"><span data-stu-id="88b4d-172">If a property is set in more than one place, a value set programmatically takes precedence over a value set in the provider string.</span></span> <span data-ttu-id="88b4d-173">Um valor definido na cadeia de inicialização tem precedência sobre um valor definido em uma caixa de diálogo de login.</span><span class="sxs-lookup"><span data-stu-id="88b4d-173">A value set in an initialization string takes precedence over a value set in a login dialog box.</span></span><br /><br /> <span data-ttu-id="88b4d-174">Se a mesma palavra-chave aparecer mais de uma vez na cadeia de caracteres de provedor, o valor da primeira ocorrência terá precedência.</span><span class="sxs-lookup"><span data-stu-id="88b4d-174">If the same keyword appears more than once in the provider string, the value from first occurrence takes precedence.</span></span>|  
|<span data-ttu-id="88b4d-175">IDBProperties::GetProperties</span><span class="sxs-lookup"><span data-stu-id="88b4d-175">IDBProperties::GetProperties</span></span>|<span data-ttu-id="88b4d-176">IDBProperties::GetProperties pode ser chamado para obter os valores das novas propriedades de inicialização da fonte de dados SSPROP_INIT_SERVERSPN e SSPROP_INIT_FAILOVERPARTNERSPN, e das novas propriedades da fonte de dados SSPROP_AUTHENTICATIONMETHOD e SSPROP_MUTUALLYAUTHENTICATED.</span><span class="sxs-lookup"><span data-stu-id="88b4d-176">IDBProperties::GetProperties can be called to get the values of the new data source initialization properties SSPROP_INIT_SERVERSPN and SSPROP_INIT_FAILOVERPARTNERSPN, and of the new data source properties SSPROP_AUTHENTICATIONMETHOD and SSPROP_MUTUALLYAUTHENTICATED.</span></span>|  
|<span data-ttu-id="88b4d-177">IDBProperties::GetPropertyInfo</span><span class="sxs-lookup"><span data-stu-id="88b4d-177">IDBProperties::GetPropertyInfo</span></span>|<span data-ttu-id="88b4d-178">IdbProperties::GetPropertyInfo incluirá as novas propriedades de inicialização da fonte de dados SSPROP_INIT_SERVERSPN e SSPROP_INIT_FAILOVERPARTNERSPN, ou as novas propriedades da fonte de dados SSPROP_AUTHENTICATION_METHOD e SSPROP_MUTUALLYAUTHENTICATED.</span><span class="sxs-lookup"><span data-stu-id="88b4d-178">IdbProperties::GetPropertyInfo will include the new data source initialization properties SSPROP_INIT_SERVERSPN and SSPROP_INIT_FAILOVERPARTNERSPN, or the new data source properties SSPROP_AUTHENTICATION_METHOD and SSPROP_MUTUALLYAUTHENTICATED.</span></span>|  
|<span data-ttu-id="88b4d-179">IDBProperties::SetProperties</span><span class="sxs-lookup"><span data-stu-id="88b4d-179">IDBProperties::SetProperties</span></span>|<span data-ttu-id="88b4d-180">IDBProperties::SetProperties pode ser chamado para definir os valores das novas propriedades de inicialização da fonte de dados SSPROP_INITSERVERSPN e SSPROP_INIT_FAILOVERPARTNERSPN.</span><span class="sxs-lookup"><span data-stu-id="88b4d-180">IDBProperties::SetProperties can be called to set the values of the new data source initialization properties SSPROP_INITSERVERSPN and SSPROP_INIT_FAILOVERPARTNERSPN.</span></span><br /><br /> <span data-ttu-id="88b4d-181">Essas propriedades podem ser definidas a qualquer momento, mas se a fonte de dados já estiver aberta, o erro a seguir será retornado:DB_E_ERRORSOCCURRED, "Operação de várias etapas do OLE DB gerou erros.</span><span class="sxs-lookup"><span data-stu-id="88b4d-181">These properties can be set at any time, but if the data source is already open, the following error will be returned: DB_E_ERRORSOCCURRED, "Multiple-step OLE DB operation generated errors.</span></span> <span data-ttu-id="88b4d-182">Verifique todos os valores de status do OLE DB, se disponíveis.</span><span class="sxs-lookup"><span data-stu-id="88b4d-182">Check each OLE DB status value, if available.</span></span> <span data-ttu-id="88b4d-183">Não foram executados trabalhos."</span><span class="sxs-lookup"><span data-stu-id="88b4d-183">No work was done."</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="88b4d-184">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="88b4d-184">See Also</span></span>  
 [<span data-ttu-id="88b4d-185">SQL Server Native Client &#40;OLE DB&#41;</span><span class="sxs-lookup"><span data-stu-id="88b4d-185">SQL Server Native Client &#40;OLE DB&#41;</span></span>](sql-server-native-client-ole-db.md)  
  
  
