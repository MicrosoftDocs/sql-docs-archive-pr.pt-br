---
title: Sobre o controle de alterações (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
helpviewer_keywords:
- data changes [SQL Server]
- tracking data changes [SQL Server]
- change tracking [SQL Server], about change tracking
- change tracking [SQL Server]
- data [SQL Server], changing
ms.assetid: 5e0ef05a-8317-4c98-be20-b19d4cd78f12
author: rothja
ms.author: jroth
ms.openlocfilehash: 4e8a817421aeca7906d31e4a70c25a12b6af7c0d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87575697"
---
# <a name="about-change-tracking-sql-server"></a><span data-ttu-id="e42af-102">Sobre o controle de alterações (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="e42af-102">About Change Tracking (SQL Server)</span></span>
  <span data-ttu-id="e42af-103">O controle de alterações é uma solução leve que fornece um mecanismo de controle de alterações eficiente para aplicativos.</span><span class="sxs-lookup"><span data-stu-id="e42af-103">Change tracking is a lightweight solution that provides an efficient change tracking mechanism for applications.</span></span> <span data-ttu-id="e42af-104">Em geral, para permitir que os aplicativos consultassem as alterações nos dados de um banco de dados e acessassem as informações relacionadas às alterações, os desenvolvedores de aplicativos precisavam implementar mecanismos personalizados de controle de alterações.</span><span class="sxs-lookup"><span data-stu-id="e42af-104">Typically, to enable applications to query for changes to data in a database and access information that is related to the changes, application developers had to implement custom change tracking mechanisms.</span></span> <span data-ttu-id="e42af-105">A criação desses mecanismos geralmente envolvia muito trabalho e frequentemente envolvida usando uma combinação de gatilhos, `timestamp` colunas, novas tabelas para armazenar informações de rastreamento e processos de limpeza personalizados.</span><span class="sxs-lookup"><span data-stu-id="e42af-105">Creating these mechanisms usually involved a lot of work and frequently involved using a combination of triggers, `timestamp` columns, new tables to store tracking information, and custom cleanup processes.</span></span>  
  
 <span data-ttu-id="e42af-106">Tipos distintos de aplicativos têm requisitos diferentes quanto à quantidade de informações que precisam sobre as alterações.</span><span class="sxs-lookup"><span data-stu-id="e42af-106">Different types of applications have different requirements for how much information they need about the changes.</span></span> <span data-ttu-id="e42af-107">Os aplicativos podem usar o controle de alterações para responder às seguintes perguntas sobre as alterações feitas na tabela de um usuário:</span><span class="sxs-lookup"><span data-stu-id="e42af-107">Applications can use change tracking to answer the following questions about the changes that have been made to a user table:</span></span>  
  
-   <span data-ttu-id="e42af-108">Que linhas da tabela de um usuário foram alteradas?</span><span class="sxs-lookup"><span data-stu-id="e42af-108">What rows have changed for a user table?</span></span>  
  
    -   <span data-ttu-id="e42af-109">Só é necessário o fato de que uma linha foi alterada, e não quantas vezes ela foi alterada ou os valores das alterações intermediárias.</span><span class="sxs-lookup"><span data-stu-id="e42af-109">Only the fact that a row has changed is required, not how many times the row has changed or the values of any intermediate changes.</span></span>  
  
    -   <span data-ttu-id="e42af-110">Os últimos dados podem ser obtidos diretamente da tabela que está sendo controlada.</span><span class="sxs-lookup"><span data-stu-id="e42af-110">The latest data can be obtained directly from the table that is being tracked.</span></span>  
  
-   <span data-ttu-id="e42af-111">Uma linha foi alterada?</span><span class="sxs-lookup"><span data-stu-id="e42af-111">Has a row changed?</span></span>  
  
    -   <span data-ttu-id="e42af-112">O fato de que uma linha foi alterada e as informações sobre a alteração devem estar disponíveis e serem registrados no momento em que a alteração foi feita na mesma transação.</span><span class="sxs-lookup"><span data-stu-id="e42af-112">The fact that a row has changed and information about the change must be available and recorded at the time that the change was made in the same transaction.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e42af-113">Se um aplicativo precisar de informações sobre todas as alterações feitas e os valores intermediários dos dados alterados, talvez seja adequado usar o Change Data Capture, em vez do controle de alterações.</span><span class="sxs-lookup"><span data-stu-id="e42af-113">If an application requires information about all the changes that were made and the intermediate values of the changed data, using change data capture, instead of change tracking, might be appropriate.</span></span> <span data-ttu-id="e42af-114">Para obter mais informações, veja [Sobre a captura de dados de alterações &#40;SQL Server&#41;](../track-changes/about-change-data-capture-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="e42af-114">For more information, see [About Change Data Capture &#40;SQL Server&#41;](../track-changes/about-change-data-capture-sql-server.md).</span></span>  
  
## <a name="one-way-and-two-way-synchronization-applications"></a><span data-ttu-id="e42af-115">Aplicativos de sincronização unidirecional e bidirecional</span><span class="sxs-lookup"><span data-stu-id="e42af-115">One-Way and Two-Way Synchronization Applications</span></span>  
 <span data-ttu-id="e42af-116">Os aplicativos que precisam sincronizar dados com uma instância do [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] devem poder consultar alterações.</span><span class="sxs-lookup"><span data-stu-id="e42af-116">Applications that have to synchronize data with an instance of the [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] must be able to query for changes.</span></span> <span data-ttu-id="e42af-117">O controle de alterações pode ser usado como uma base para aplicativos de sincronização unidirecional e bidirecional.</span><span class="sxs-lookup"><span data-stu-id="e42af-117">Change tracking can be used as a foundation for both one-way and two-way synchronization applications.</span></span>  
  
### <a name="one-way-synchronization-applications"></a><span data-ttu-id="e42af-118">Aplicativos de sincronização unidirecional</span><span class="sxs-lookup"><span data-stu-id="e42af-118">One-Way Synchronization Applications</span></span>  
 <span data-ttu-id="e42af-119">É possível criar aplicativos de sincronização unidirecional, como um aplicativo cliente ou de cache de camada intermediária, que usem o controle de alterações.</span><span class="sxs-lookup"><span data-stu-id="e42af-119">One-way synchronization applications, such as a client or mid-tier caching application, can be built that use change tracking.</span></span> <span data-ttu-id="e42af-120">Como mostra a ilustração a seguir, um aplicativo em cache exige que os dados sejam armazenados no [!INCLUDE[ssDE](../../includes/ssde-md.md)] e armazenados em cache em outros armazenamentos de dados.</span><span class="sxs-lookup"><span data-stu-id="e42af-120">As shown in the following illustration, a caching application requires data to be stored in the [!INCLUDE[ssDE](../../includes/ssde-md.md)] and to be cached in other data stores.</span></span> <span data-ttu-id="e42af-121">O aplicativo deve ser capaz de manter o cache atualizado com as alterações feitas nas tabelas do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e42af-121">The application must be able to keep the cache up-to-date with any changes that have been made to the database tables.</span></span> <span data-ttu-id="e42af-122">Não há nenhuma alteração para devolver ao [!INCLUDE[ssDE](../../includes/ssde-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e42af-122">There are no changes to pass back to the [!INCLUDE[ssDE](../../includes/ssde-md.md)].</span></span>  
  
 <span data-ttu-id="e42af-123">![Mostra aplicativos de sincronização unidirecional](../../database-engine/media/one-waysync.gif "Mostra aplicativos de sincronização unidirecional")</span><span class="sxs-lookup"><span data-stu-id="e42af-123">![Shows one-way synchronization applications](../../database-engine/media/one-waysync.gif "Shows one-way synchronization applications")</span></span>  
  
### <a name="two-way-synchronization-applications"></a><span data-ttu-id="e42af-124">Aplicativos de sincronização bidirecional</span><span class="sxs-lookup"><span data-stu-id="e42af-124">Two-Way Synchronization Applications</span></span>  
 <span data-ttu-id="e42af-125">Também é possível criar aplicativos de sincronização bidirecional que usem o controle de alterações.</span><span class="sxs-lookup"><span data-stu-id="e42af-125">Two-way synchronization applications can also be built that use change tracking.</span></span> <span data-ttu-id="e42af-126">Neste cenário, os dados em uma instância do [!INCLUDE[ssDE](../../includes/ssde-md.md)] são sincronizados com um ou mais repositórios de dados.</span><span class="sxs-lookup"><span data-stu-id="e42af-126">In this scenario, the data in an instance of the [!INCLUDE[ssDE](../../includes/ssde-md.md)] is synchronized with one or more data stores.</span></span> <span data-ttu-id="e42af-127">Os dados nesses repositórios podem ser atualizados, e as alterações devem ser sincronizadas novamente com o [!INCLUDE[ssDE](../../includes/ssde-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e42af-127">The data in those stores can be updated and the changes must be synchronized back to the [!INCLUDE[ssDE](../../includes/ssde-md.md)].</span></span>  
  
 <span data-ttu-id="e42af-128">![Mostra aplicativos de sincronização bidirecional](../../database-engine/media/two-waysync.gif "Mostra aplicativos de sincronização bidirecional")</span><span class="sxs-lookup"><span data-stu-id="e42af-128">![Shows two-way synchronization applications](../../database-engine/media/two-waysync.gif "Shows two-way synchronization applications")</span></span>  
  
 <span data-ttu-id="e42af-129">Um bom exemplo de aplicativo de sincronização bidirecional é um aplicativo ocasionalmente conectado.</span><span class="sxs-lookup"><span data-stu-id="e42af-129">A good example of two-way synchronization application is an occasionally connected application.</span></span> <span data-ttu-id="e42af-130">Nesse tipo de aplicativo, um aplicativo cliente consulta e atualiza um repositório local.</span><span class="sxs-lookup"><span data-stu-id="e42af-130">In this type of application, a client application queries and updates a local store.</span></span> <span data-ttu-id="e42af-131">Quando houver uma conexão disponível entre um cliente e um servidor, o aplicativo será sincronizado com um servidor, e os fluxos de dados alterados ocorrerão nas duas direções.</span><span class="sxs-lookup"><span data-stu-id="e42af-131">When a connection is available between a client and server, the application will synchronize with a server, and changed data flows in both directions.</span></span>  
  
 <span data-ttu-id="e42af-132">Os aplicativos de sincronização bidirecional devem ser capazes de detectar conflitos.</span><span class="sxs-lookup"><span data-stu-id="e42af-132">The two-way synchronization applications must be able to detect conflicts.</span></span> <span data-ttu-id="e42af-133">Ocorrerá um conflito se os mesmos dados forem alterados em ambos os repositórios de dados em algum momento entre sincronizações.</span><span class="sxs-lookup"><span data-stu-id="e42af-133">A conflict would occur if the same data was changed in both data stores in the time between synchronizations.</span></span> <span data-ttu-id="e42af-134">Com a capacidade de detectar conflitos, um aplicativo pode certificar-se de que as alterações não sejam perdidas.</span><span class="sxs-lookup"><span data-stu-id="e42af-134">With the ability to detect conflicts, an application can make sure that changes are not lost.</span></span>  
  
## <a name="how-change-tracking-works"></a><span data-ttu-id="e42af-135">Como o controle de alterações funciona</span><span class="sxs-lookup"><span data-stu-id="e42af-135">How Change Tracking Works</span></span>  
 <span data-ttu-id="e42af-136">Para configurar o controle de alterações, você pode usar instruções DDL ou [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e42af-136">To configure change tracking, you can use DDL statements or [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span></span> <span data-ttu-id="e42af-137">Para obter mais informações, veja [Habilitar e desabilitar o controle de alterações &#40;SQL Server&#41;](../track-changes/enable-and-disable-change-tracking-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="e42af-137">For more information, see [Enable and Disable Change Tracking &#40;SQL Server&#41;](../track-changes/enable-and-disable-change-tracking-sql-server.md).</span></span> <span data-ttu-id="e42af-138">Para controlar alterações, o controle de alterações deve ser habilitado no banco de dados e, então, nas tabelas que você deseja controlar no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e42af-138">To track changes, change tracking must first be enabled for the database and then enabled for the tables that you want to track within that database.</span></span> <span data-ttu-id="e42af-139">A definição da tabela não precisa sofrer nenhuma alteração, e nenhum gatilho é criado.</span><span class="sxs-lookup"><span data-stu-id="e42af-139">The table definition does not have to be changed in any way, and no triggers are created.</span></span>  
  
 <span data-ttu-id="e42af-140">Após a configuração do controle de alterações para uma tabela, qualquer instrução DML que afete as linhas da tabela fará com que as informações do controle de alterações de cada linha modificada sejam registradas.</span><span class="sxs-lookup"><span data-stu-id="e42af-140">After change tracking is configured for a table, any DML statement that affects rows in the table will cause change tracking information for each modified row to be recorded.</span></span> <span data-ttu-id="e42af-141">Para consultar as linhas que foram alteradas e obter informações sobre as alterações, você pode usar as [funções de controle de alterações](/sql/relational-databases/system-functions/change-tracking-functions-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="e42af-141">To query for the rows that have changed and to obtain information about the changes, you can use [change tracking functions](/sql/relational-databases/system-functions/change-tracking-functions-transact-sql).</span></span>  
  
 <span data-ttu-id="e42af-142">Os valores da coluna de chave primária são as únicas informações da tabela controlada que são registradas com as informações sobre as alterações.</span><span class="sxs-lookup"><span data-stu-id="e42af-142">The values of the primary key column is only information from the tracked table that is recorded with the change information.</span></span> <span data-ttu-id="e42af-143">Esses valores identificam as linhas que foram alteradas.</span><span class="sxs-lookup"><span data-stu-id="e42af-143">These values identify the rows that have been changed.</span></span> <span data-ttu-id="e42af-144">Para obter os últimos dados sobre essas linhas, um aplicativo pode usar os valores da coluna de chave primária para unir a tabela de origem à tabela controlada.</span><span class="sxs-lookup"><span data-stu-id="e42af-144">To obtain the latest data for those rows, an application can use the primary key column values to join the source table with the tracked table.</span></span>  
  
 <span data-ttu-id="e42af-145">As informações sobre a alteração feita em cada linha também podem ser obtidas usando o controle de alterações.</span><span class="sxs-lookup"><span data-stu-id="e42af-145">Information about the change that was made to each row can also be obtained by using change tracking.</span></span> <span data-ttu-id="e42af-146">Por exemplo, o tipo de operação DML que causou a alteração (inserção, atualização ou exclusão) ou as colunas que foram alteradas como parte de uma operação de atualização.</span><span class="sxs-lookup"><span data-stu-id="e42af-146">For example, the type of DML operation that caused the change (insert, update, or delete) or the columns that were changed as part of an update operation.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e42af-147">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="e42af-147">See Also</span></span>  
 <span data-ttu-id="e42af-148">[Habilitar e desabilitar Controle de Alterações &#40;SQL Server&#41;](../track-changes/enable-and-disable-change-tracking-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="e42af-148">[Enable and Disable Change Tracking &#40;SQL Server&#41;](../track-changes/enable-and-disable-change-tracking-sql-server.md) </span></span>  
 <span data-ttu-id="e42af-149">[Trabalhar com Controle de Alterações &#40;SQL Server&#41;](../track-changes/work-with-change-tracking-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="e42af-149">[Work with Change Tracking &#40;SQL Server&#41;](../track-changes/work-with-change-tracking-sql-server.md) </span></span>  
 <span data-ttu-id="e42af-150">[Gerenciar Controle de Alterações &#40;SQL Server&#41;](../track-changes/manage-change-tracking-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="e42af-150">[Manage Change Tracking &#40;SQL Server&#41;](../track-changes/manage-change-tracking-sql-server.md) </span></span>  
 [<span data-ttu-id="e42af-151">Controle de alterações de dados &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="e42af-151">Track Data Changes &#40;SQL Server&#41;</span></span>](../track-changes/track-data-changes-sql-server.md)  
  
  
