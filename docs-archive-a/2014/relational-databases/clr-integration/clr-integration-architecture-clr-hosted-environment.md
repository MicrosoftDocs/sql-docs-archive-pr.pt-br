---
title: Ambiente hospedado do CLR | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: clr
ms.topic: reference
helpviewer_keywords:
- type-safe code [CLR integration]
- UNSAFE permission set
- run-time environments [CLR integration]
- common language runtime [SQL Server], about CLR integration
- application domains [CLR integration]
- host protection attributes [CLR integration]
- managed code [SQL Server], common language runtime
- permission sets [CLR integration]
- reliability [CLR integration]
- SAFE permission set
- code access security [CLR integration]
- EXTERNAL_ACCESS permission set
- verifying type safety
- scalability [CLR integration]
- hosted environments [CLR integration]
- HPAs [CLR integration]
ms.assetid: d280d359-08f0-47b5-a07e-67dd2a58ad73
author: rothja
ms.author: jroth
ms.openlocfilehash: bd04536d1dfb8a4657fbe116cdfd38a6639a6327
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87682279"
---
# <a name="clr-hosted-environment"></a><span data-ttu-id="cbb5d-102">Ambiente hospedado de CLR</span><span class="sxs-lookup"><span data-stu-id="cbb5d-102">CLR Hosted Environment</span></span>
  <span data-ttu-id="cbb5d-103">O CLR (Common Language Runtime) do [!INCLUDE[msCoName](../../../includes/msconame-md.md)] .NET Framework é um ambiente que executa várias linguagens de programação modernas, incluindo [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C#, [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Basic e [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C++.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-103">The [!INCLUDE[msCoName](../../../includes/msconame-md.md)] .NET Framework common language runtime (CLR) is an environment that executes many modern programming languages, including [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C#, [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Basic, and [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C++.</span></span> <span data-ttu-id="cbb5d-104">O CLR tem memória com coleta de lixo, threading preemptivo, serviços de metadados (reflexão de tipo), capacidade de verificação de código e segurança de acesso ao código.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-104">The CLR features garbage-collected memory, pre-emptive threading, metadata services (type reflection), code verifiability, and code access security.</span></span> <span data-ttu-id="cbb5d-105">Ele usa metadados para localizar e carregar classes, distribuir as instâncias na memória, resolver invocações de métodos, gerar código nativo, impor a segurança e definir limites de contexto em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-105">The CLR uses metadata to locate and load classes, lay out instances in memory, resolve method invocations, generate native code, enforce security, and set run-time context boundaries.</span></span>  
  
 <span data-ttu-id="cbb5d-106">O CLR e o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] diferem como ambientes de tempo de execução pela forma como tratam memória, threads e sincronização.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-106">The CLR and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] differ as run-time environments in the way they handle memory, threads, and synchronization.</span></span> <span data-ttu-id="cbb5d-107">Este tópico descreve a forma na qual estes dois tempos de execução são integrados para que todos os recursos do sistema sejam gerenciados uniformemente.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-107">This topic describes the way in which these two run times are integrated so that all system resources are managed uniformly.</span></span> <span data-ttu-id="cbb5d-108">Este tópico também fala sobre a forma na qual a CAS (segurança de acesso do código) do CLR e a segurança do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] são integradas para fornecer um ambiente de execução confiável e seguro para o código do usuário.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-108">This topic also covers the way in which CLR code access security (CAS) and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] security are integrated to provide a reliable and secure execution environment for user code.</span></span>  
  
## <a name="basic-concepts-of-clr-architecture"></a><span data-ttu-id="cbb5d-109">Conceitos básicos da arquitetura do CLR</span><span class="sxs-lookup"><span data-stu-id="cbb5d-109">Basic Concepts of CLR Architecture</span></span>  
 <span data-ttu-id="cbb5d-110">No .NET Framework, um programador escreve o código em uma linguagem de alto nível que implementa uma classe definindo sua estrutura (por exemplo, os campos das propriedades da classe) e seus métodos.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-110">In the .NET Framework, a programmer writes in a high-level language that implements a class defining its structure (for example, the fields or properties of the class) and methods.</span></span> <span data-ttu-id="cbb5d-111">Alguns desses métodos podem ser funções estáticas.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-111">Some of these methods can be static functions.</span></span> <span data-ttu-id="cbb5d-112">A compilação do programa produz um arquivo chamado assembly, que contém o código compilado na MSIL ([!INCLUDE[msCoName](../../../includes/msconame-md.md)] intermediate language) e um manifesto que contém todas as referências para assemblies dependentes.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-112">The compilation of the program produces a file called an assembly that contains the compiled code in the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] intermediate language (MSIL), and a manifest that contains all references to dependent assemblies.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="cbb5d-113">Os assemblies são um elemento vital na arquitetura do CLR.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-113">Assemblies are a vital element in the architecture of the CLR.</span></span> <span data-ttu-id="cbb5d-114">Eles são as unidades de empacotamento, implantação e controle de versão de código de aplicativo no .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-114">They are the units of packaging, deployment, and versioning of application code in the .NET Framework.</span></span> <span data-ttu-id="cbb5d-115">Usando assemblies, você pode implantar código de aplicativo no banco de dados e fornecer um modo uniforme de administrar, fazer backup e restaurar aplicativos de bancos de dados completos.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-115">Using assemblies, you can deploy application code inside the database and provide a uniform way to administer, back up, and restore complete database applications.</span></span>  
  
 <span data-ttu-id="cbb5d-116">O manifesto do assembly contém metadados sobre o assembly, descrevendo todas as estruturas, campos, propriedades, classes, relacionamentos de herança, funções e métodos definidos no programa.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-116">The assembly manifest contains metadata about the assembly, describing all of the structures, fields, properties, classes, inheritance relationships, functions, and methods defined in the program.</span></span> <span data-ttu-id="cbb5d-117">O manifesto estabelece a identidade do assembly, especifica os arquivos que compõem a sua implementação, especifica os tipos e recursos que o compõem, mantém uma lista das dependências de tempo de compilação em outros assemblies e especifica o conjunto de permissões necessárias para que seja executado adequadamente.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-117">The manifest establishes the assembly identity, specifies the files that make up the assembly implementation, specifies the types and resources that make up the assembly, itemizes the compile-time dependencies on other assemblies, and specifies the set of permissions required for the assembly to run properly.</span></span> <span data-ttu-id="cbb5d-118">Estas informações são usadas em tempo de execução para resolver referências, impor a política de ligação da versão e validar a integridade dos assemblies carregados.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-118">This information is used at run time to resolve references, enforce version binding policy, and validate the integrity of loaded assemblies.</span></span>  
  
 <span data-ttu-id="cbb5d-119">O .NET Framework dá suporte a atributos personalizados para anotar classes, propriedades, funções e métodos com informações adicionais que o aplicativo possa capturar em metadados.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-119">The .NET Framework supports custom attributes for annotating classes, properties, functions, and methods with additional information the application may capture in metadata.</span></span> <span data-ttu-id="cbb5d-120">Todos os compiladores .NET Framework consomem essas anotações sem interpretação e as armazenam como metadados de assembly.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-120">All .NET Framework compilers consume these annotations without interpretation and store them as assembly metadata.</span></span> <span data-ttu-id="cbb5d-121">Estas anotações podem ser examinadas da mesma forma que quaisquer outros metadados.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-121">These annotations can be examined in the same way as any other metadata.</span></span>  
  
 <span data-ttu-id="cbb5d-122">O código gerenciado é MSIL executado no CLR, em vez de diretamente pelo sistema operacional.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-122">Managed code is MSIL executed in the CLR, rather than directly by the operating system.</span></span> <span data-ttu-id="cbb5d-123">Aplicativos de código gerenciado adquirem serviços de CLR, como coleta de lixo automática, verificação de tipo de tempo de execução e suporte de segurança.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-123">Managed code applications acquire CLR services, such as automatic garbage collection, run-time type checking, and security support.</span></span> <span data-ttu-id="cbb5d-124">Estes serviços ajudam a fornecer uma plataforma uniforme, bem como comportamento independente de linguagem de aplicativos de código gerenciado.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-124">These services help provide uniform platform- and language-independent behavior of managed code applications.</span></span>  
  
## <a name="design-goals-of-clr-integration"></a><span data-ttu-id="cbb5d-125">Metas de design da integração de CLR</span><span class="sxs-lookup"><span data-stu-id="cbb5d-125">Design Goals of CLR Integration</span></span>  
 <span data-ttu-id="cbb5d-126">Quando o código de usuário é executado dentro do ambiente hospedado pelo CLR no [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] (chamada de integração de CLR), aplicam-se as seguintes as metas de design:</span><span class="sxs-lookup"><span data-stu-id="cbb5d-126">When user code runs inside the CLR-hosted environment in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] (called CLR integration), the following design goals apply:</span></span>  
  
###### <a name="reliability-safety"></a><span data-ttu-id="cbb5d-127">Confiabilidade (segurança)</span><span class="sxs-lookup"><span data-stu-id="cbb5d-127">Reliability (Safety)</span></span>  
 <span data-ttu-id="cbb5d-128">O código do usuário não deve ter permissão para realizar operações que comprometam a integridade do processo do Mecanismo de banco de dados, como exibir uma mensagem em pop-up solicitando resposta do usuário ou sair do processo.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-128">User code should not be allowed to perform operations that compromise the integrity of the Database Engine process, such as popping a message box requesting a user response or exiting the process.</span></span> <span data-ttu-id="cbb5d-129">Também não deve ser capaz substituir os buffers de memória ou as estruturas de dados internas do Mecanismo de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-129">User code should not be able to overwrite Database Engine memory buffers or internal data structures.</span></span>  
  
###### <a name="scalability"></a><span data-ttu-id="cbb5d-130">Escalabilidade</span><span class="sxs-lookup"><span data-stu-id="cbb5d-130">Scalability</span></span>  
 <span data-ttu-id="cbb5d-131">O [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] e o CLR têm modelos internos diferentes para agendamento e gerenciamento de memória.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-131">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] and the CLR have different internal models for scheduling and memory management.</span></span> <span data-ttu-id="cbb5d-132">O [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] oferece suporte a um modelo de threading cooperativo, e não preemptivo, no qual os threads são executados de forma voluntária, periodicamente ou quando estão aguardando bloqueios ou E/S.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-132">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] supports a cooperative, non-preemptive threading model in which the threads voluntarily yield execution periodically, or when they are waiting on locks or I/O.</span></span> <span data-ttu-id="cbb5d-133">O CLR dá suporte um modelo de threading preemptivo.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-133">The CLR supports a preemptive threading model.</span></span> <span data-ttu-id="cbb5d-134">Se o código do usuário que estiver sendo executado no [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] puder chamar diretamente as primitivas de threading do sistema operacional, então ele não se integrará bem ao agendador de tarefas do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] e poderá degradar a escalabilidade do sistema.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-134">If user code running inside [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] can directly call the operating system threading primitives, then it does not integrate well into the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] task scheduler and can degrade the scalability of the system.</span></span> <span data-ttu-id="cbb5d-135">O CLR não faz distinção entre memória física e virtual, mas o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] gerencia diretamente a memória física e deve usar a memória física dentro de um limite configurável.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-135">The CLR does not distinguish between virtual and physical memory, but [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] directly manages physical memory and is required to use physical memory within a configurable limit.</span></span>  
  
 <span data-ttu-id="cbb5d-136">Os diferentes modelos de threading, agendamento e gerenciamento de memória são um desafio de integração para um RDBMS (sistema de gerenciamento de banco de dados relacional) que se dimensiona para dar suporte a milhares de sessões de usuário simultâneas.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-136">The different models for threading, scheduling, and memory management present an integration challenge for a relational database management system (RDBMS) that scales to support thousands of concurrent user sessions.</span></span> <span data-ttu-id="cbb5d-137">A arquitetura deve garantir que a escalabilidade do sistema não seja comprometida pelo código de usuário que chame diretamente APIs (application programming interfaces) para primitivas de threading, memória e sincronização.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-137">The architecture should ensure that the scalability of the system is not compromised by user code calling application programming interfaces (APIs) for threading, memory, and synchronization primitives directly.</span></span>  
  
###### <a name="security"></a><span data-ttu-id="cbb5d-138">Segurança</span><span class="sxs-lookup"><span data-stu-id="cbb5d-138">Security</span></span>  
 <span data-ttu-id="cbb5d-139">Código de usuário em execução no banco de dados deve seguir regras de autenticação e autorização do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ao acessar objetos de banco de dados como tabelas e colunas.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-139">User code running in the database must follow [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] authentication and authorization rules when accessing database objects such as tables and columns.</span></span> <span data-ttu-id="cbb5d-140">Além disso, os administradores de bancos de dados devem ter a capacidade de controlar o acesso aos recursos do sistema operacional, como arquivos e acesso à rede, do código de usuário em execução no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-140">In addition, database administrators should be able to control access to operating system resources, such as files and network access, from user code running in the database.</span></span> <span data-ttu-id="cbb5d-141">Isto se torna importante à medida que as linguagens de programação gerenciadas (ao contrário de linguagens de programação não gerenciadas, como o Transact-SQL) fornecem APIs para acessar tais recursos.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-141">This becomes important as managed programming languages (unlike non-managed languages such as Transact-SQL) provide APIs to access such resources.</span></span> <span data-ttu-id="cbb5d-142">O sistema deve fornecer um modo seguro para que o código de usuário acesse os recursos da máquina fora do processo do [!INCLUDE[ssDE](../../../includes/ssde-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cbb5d-142">The system must provide a secure way for user code to access machine resources outside the [!INCLUDE[ssDE](../../../includes/ssde-md.md)] process.</span></span> <span data-ttu-id="cbb5d-143">Para obter mais informações, consulte [CLR Integration Security](security/clr-integration-security.md).</span><span class="sxs-lookup"><span data-stu-id="cbb5d-143">For more information, see [CLR Integration Security](security/clr-integration-security.md).</span></span>  
  
###### <a name="performance"></a><span data-ttu-id="cbb5d-144">Desempenho</span><span class="sxs-lookup"><span data-stu-id="cbb5d-144">Performance</span></span>  
 <span data-ttu-id="cbb5d-145">Código de usuário gerenciado em execução no [!INCLUDE[ssDE](../../../includes/ssde-md.md)] deve ter desempenho computacional comparável ao mesmo código executado fora do servidor.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-145">Managed user code running in the [!INCLUDE[ssDE](../../../includes/ssde-md.md)] should have computational performance comparable to the same code run outside the server.</span></span> <span data-ttu-id="cbb5d-146">O acesso ao banco de dados a partir de código do usuário gerenciado não é tão rápido quanto [!INCLUDE[tsql](../../../includes/tsql-md.md)] nativo.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-146">Database access from managed user code is not as fast as native [!INCLUDE[tsql](../../../includes/tsql-md.md)].</span></span> <span data-ttu-id="cbb5d-147">Para obter mais informações, consulte [desempenho da integração CLR](clr-integration-architecture-performance.md).</span><span class="sxs-lookup"><span data-stu-id="cbb5d-147">For more information, see [Performance of CLR Integration](clr-integration-architecture-performance.md).</span></span>  
  
## <a name="clr-services"></a><span data-ttu-id="cbb5d-148">Serviços CLR</span><span class="sxs-lookup"><span data-stu-id="cbb5d-148">CLR Services</span></span>  
 <span data-ttu-id="cbb5d-149">O CLR fornece vários serviços para ajudar atingir as metas de design da integração do CLR com o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cbb5d-149">The CLR provides a number of services to help achieve the design goals of CLR integration with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
###### <a name="type-safety-verification"></a><span data-ttu-id="cbb5d-150">Verificação de segurança de tipo</span><span class="sxs-lookup"><span data-stu-id="cbb5d-150">Type safety verification</span></span>  
 <span data-ttu-id="cbb5d-151">Código fortemente tipado é um código que acessa as estruturas de memória somente de modos bem definidos.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-151">Type-safe code is code that accesses memory structures only in well-defined ways.</span></span> <span data-ttu-id="cbb5d-152">Por exemplo, dada uma referência de objeto válida, o código fortemente tipado pode acessar memória em offsets fixos, correspondentes a membros de campo reais.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-152">For example, given a valid object reference, type-safe code can access memory at fixed offsets corresponding to actual field members.</span></span> <span data-ttu-id="cbb5d-153">Entretanto, se o código acessar a memória em offsets arbitrários dentro ou fora do intervalo de memória que pertence ao objeto, então ele não será fortemente tipado.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-153">However, if the code accesses memory at arbitrary offsets inside or outside the range of memory that belongs to the object, then it is not type-safe.</span></span> <span data-ttu-id="cbb5d-154">Quando os assemblies são carregados no CLR, antes de a MSIL ser compilada usando compilação JIT (just-in-time), o runtime executa uma fase de verificação que examina o código antes de determinar sua segurança de tipos.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-154">When assemblies are loaded in the CLR, prior to the MSIL being compiled using just-in-time (JIT) compilation, the runtime performs a verification phase that examines code to determine its type-safety.</span></span> <span data-ttu-id="cbb5d-155">O código aprovado com êxito nesta verificação é chamado de código fortemente tipado verificável.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-155">Code that successfully passes this verification is called verifiably type-safe code.</span></span>  
  
###### <a name="application-domains"></a><span data-ttu-id="cbb5d-156">Domínios de aplicativo</span><span class="sxs-lookup"><span data-stu-id="cbb5d-156">Application domains</span></span>  
 <span data-ttu-id="cbb5d-157">O CLR dá suporte à noção de domínios de aplicativo como zonas de execução dentro de um processo de host, onde assemblies de código gerenciado podem ser carregados e executados.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-157">The CLR supports the notion of application domains as execution zones within a host process where managed code assemblies can be loaded and executed.</span></span> <span data-ttu-id="cbb5d-158">O limite do domínio do aplicativo fornece isolamento entre assemblies.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-158">The application domain boundary provides isolation between assemblies.</span></span> <span data-ttu-id="cbb5d-159">Os assemblies são isolados em termos de visibilidade de variáveis estáticas e membros de dados e de capacidade para chamar código dinamicamente.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-159">The assemblies are isolated in terms of visibility of static variables and data members and the ability to call code dynamically.</span></span> <span data-ttu-id="cbb5d-160">Domínios de aplicativo também são o mecanismo para carregar e descarregar código.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-160">Application domains are also the mechanism for loading and unloading code.</span></span> <span data-ttu-id="cbb5d-161">O código só pode ser descarregado da memória através do descarregamento do domínio de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-161">Code can be unloaded from memory only by unloading the application domain.</span></span> <span data-ttu-id="cbb5d-162">Para obter mais informações, consulte [domínios de aplicativo e segurança de integração CLR](../../database-engine/dev-guide/application-domains-and-clr-integration-security.md).</span><span class="sxs-lookup"><span data-stu-id="cbb5d-162">For more information, see [Application Domains and CLR Integration Security](../../database-engine/dev-guide/application-domains-and-clr-integration-security.md).</span></span>  
  
###### <a name="code-access-security-cas"></a><span data-ttu-id="cbb5d-163">CAS (segurança de acesso ao código)</span><span class="sxs-lookup"><span data-stu-id="cbb5d-163">Code Access Security (CAS)</span></span>  
 <span data-ttu-id="cbb5d-164">O sistema de segurança CLR sistema fornece um modo de controlar quais os tipos de código gerenciado de operações que podem ser executados, atribuindo permissões ao código.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-164">The CLR security system provides a way to control what kinds of operations managed code can perform by assigning permissions to code.</span></span> <span data-ttu-id="cbb5d-165">As permissões de acesso ao código são atribuídas com base na identidade do código (por exemplo, a assinatura do assembly ou a origem do código).</span><span class="sxs-lookup"><span data-stu-id="cbb5d-165">Code access permissions are assigned based on code identity (for example, the signature of the assembly or the origin of the code).</span></span>  
  
 <span data-ttu-id="cbb5d-166">O CLR fornece uma política para todo o computador que pode ser definida pelo administrador do computador.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-166">The CLR provides for a computer-wide policy that can be set by the computer administrator.</span></span> <span data-ttu-id="cbb5d-167">Essa política define as concessões de permissão para qualquer código gerenciado em execução na máquina.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-167">This policy defines the permission grants for any managed code running on the machine.</span></span> <span data-ttu-id="cbb5d-168">Além disso, há uma política de segurança em nível de host que pode ser usada por hosts, como o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], para especificar restrições adicionais em código gerenciado.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-168">In addition, there is a host-level security policy that can be used by hosts such as [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] to specify additional restrictions on managed code.</span></span>  
  
 <span data-ttu-id="cbb5d-169">Se uma API gerenciada no .NET Framework expuser operações sobre recursos que são protegidas por uma permissão de acesso a código, a API solicitará essa permissão antes de acessar o recurso.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-169">If a managed API in the .NET Framework exposes operations on resources that are protected by a code access permission, the API will demand that permission before accessing the resource.</span></span> <span data-ttu-id="cbb5d-170">Essa solicitação faz o sistema de segurança CLR ativar uma verificação abrangente de cada unidade de código (assembly) na pilha de chamadas.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-170">This demand causes the CLR security system to trigger a comprehensive check of every unit of code (assembly) in the call stack.</span></span> <span data-ttu-id="cbb5d-171">Somente se toda a cadeia de chamada tiver permissão, o acesso ao recurso será concedido.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-171">Only if the entire call chain has permission will access to the resource be granted.</span></span>  
  
 <span data-ttu-id="cbb5d-172">Observe que não há suporte à capacidade de gerar código gerenciado dinamicamente, usando a API Reflection.Emit, dentro do ambiente hospedado pelo CLR no [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cbb5d-172">Note that the ability to generate managed code dynamically, using the Reflection.Emit API, is not supported inside the CLR-hosted environment in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="cbb5d-173">Esse código não teria as permissões de execução da CAS e, portanto, falharia em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-173">Such code would not have the CAS permissions to run and would therefore fail at run time.</span></span> <span data-ttu-id="cbb5d-174">Para obter mais informações, consulte [segurança de acesso ao código de integração CLR](security/clr-integration-code-access-security.md).</span><span class="sxs-lookup"><span data-stu-id="cbb5d-174">For more information, see [CLR Integration Code Access Security](security/clr-integration-code-access-security.md).</span></span>  
  
###### <a name="host-protection-attributes-hpas"></a><span data-ttu-id="cbb5d-175">HPAs (atributos de proteção de host)</span><span class="sxs-lookup"><span data-stu-id="cbb5d-175">Host Protection Attributes (HPAs)</span></span>  
 <span data-ttu-id="cbb5d-176">O CLR fornece um mecanismo para anotar APIs gerenciadas que fazem parte do .NET Framework com determinados atributos que podem ser de interesse de um host do CLR.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-176">The CLR provides a mechanism to annotate managed APIs that are part of the .NET Framework with certain attributes that may be of interest to a host of the CLR.</span></span> <span data-ttu-id="cbb5d-177">Exemplos de tais atributos incluem:</span><span class="sxs-lookup"><span data-stu-id="cbb5d-177">Examples of such attributes include:</span></span>  
  
-   <span data-ttu-id="cbb5d-178">SharedState, que indica se a API expõe a capacidade de criar ou gerenciar estado compartilhado (por exemplo, campos de classe estáticos).</span><span class="sxs-lookup"><span data-stu-id="cbb5d-178">SharedState, which indicates whether the API exposes the ability to create or manage shared state (for example, static class fields).</span></span>  
  
-   <span data-ttu-id="cbb5d-179">Synchronization, que indica se a API expõe a capacidade para executar sincronização entre threads.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-179">Synchronization, which indicates whether the API exposes the ability to perform synchronization between threads.</span></span>  
  
-   <span data-ttu-id="cbb5d-180">ExternalProcessMgmt, que indica se a API expõe um modo de controlar o processo de host.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-180">ExternalProcessMgmt, which indicates whether the API exposes a way to control the host process.</span></span>  
  
 <span data-ttu-id="cbb5d-181">Dados esses atributos, o host pode especificar uma lista de HPAs, como o atributo SharedState, que devem ser desabilitados no ambiente hospedado.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-181">Given these attributes, the host can specify a list of HPAs, such as the SharedState attribute, that should be disallowed in the hosted environment.</span></span> <span data-ttu-id="cbb5d-182">Nesse caso, o CLR nega as tentativas do código de usuário de chamar APIs que são anotadas pelo HPAs na lista proibida.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-182">In this case, the CLR denies attempts by user code to call APIs that are annotated by the HPAs in the prohibited list.</span></span> <span data-ttu-id="cbb5d-183">Para obter mais informações, consulte [atributos de proteção do host e programação de integração do CLR](../clr-integration-security-host-protection-attributes/host-protection-attributes-and-clr-integration-programming.md).</span><span class="sxs-lookup"><span data-stu-id="cbb5d-183">For more information, see [Host Protection Attributes and CLR Integration Programming](../clr-integration-security-host-protection-attributes/host-protection-attributes-and-clr-integration-programming.md).</span></span>  
  
## <a name="how-sql-server-and-the-clr-work-together"></a><span data-ttu-id="cbb5d-184">Como o SQL Server e o CLR trabalham juntos</span><span class="sxs-lookup"><span data-stu-id="cbb5d-184">How SQL Server and the CLR Work Together</span></span>  
 <span data-ttu-id="cbb5d-185">Esta seção discute como o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] integra os modelos de threading, agendamento, sincronização e gerenciamento de memória do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] e do CLR.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-185">This section discusses how [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] integrates the threading, scheduling, synchronization, and memory management models of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] and the CLR.</span></span> <span data-ttu-id="cbb5d-186">Em particular, esta seção examina a integração sob o ponto de vista das metas de escalabilidade, confiabilidade e segurança.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-186">In particular, this section examines the integration in light of scalability, reliability, and security goals.</span></span> <span data-ttu-id="cbb5d-187">O [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] atua essencialmente como o sistema operacional para o CLR quando este é hospedado no [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cbb5d-187">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] essentially acts as the operating system for the CLR when it is hosted inside [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="cbb5d-188">O CLR chama rotinas de baixo nível implementadas pelo [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] para threading, agendamento e gerenciamento de memória.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-188">The CLR calls low-level routines implemented by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] for threading, scheduling, synchronization, and memory management.</span></span> <span data-ttu-id="cbb5d-189">Elas são as mesmas primitivas que o restante do mecanismo do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] usa.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-189">These are the same primitives that the rest of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] engine uses.</span></span> <span data-ttu-id="cbb5d-190">Esta abordagem fornece vários benefícios de escalabilidade, confiabilidade e segurança.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-190">This approach provides several scalability, reliability, and security benefits.</span></span>  
  
###### <a name="scalability-common-threading-scheduling-and-synchronization"></a><span data-ttu-id="cbb5d-191">Escalabilidade: Threading, agendamento e sincronização comuns</span><span class="sxs-lookup"><span data-stu-id="cbb5d-191">Scalability: Common threading, scheduling, and synchronization</span></span>  
 <span data-ttu-id="cbb5d-192">O CLR chama as APIs do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] para criar threads, tanto para executar código de usuário quanto para seu próprio uso interno.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-192">CLR calls [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] APIs for creating threads, both for running user code and for its own internal use.</span></span> <span data-ttu-id="cbb5d-193">Para fazer a sincronização de vários threads, o CLR chama objetos de sincronização do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cbb5d-193">In order to synchronize between multiple threads, the CLR calls [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] synchronization objects.</span></span> <span data-ttu-id="cbb5d-194">Isto permite que o agendador [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] para agende outras tarefas quando um thread estiver esperando um objeto de sincronização.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-194">This allows the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] scheduler to schedule other tasks when a thread is waiting on a synchronization object.</span></span> <span data-ttu-id="cbb5d-195">Por exemplo, quando o CLR iniciar a coleta de lixo, todos os seus threads esperam a coleta de lixo terminar.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-195">For example, when the CLR initiates garbage collection, all of its threads wait for garbage collection to finish.</span></span> <span data-ttu-id="cbb5d-196">Como os threads do CLR e os objetos de sincronização pelos quais eles estão esperando são conhecidos para o agendador do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] pode agendar threads que estão executando outras tarefas do banco de dados que não envolvem o CLR.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-196">Because the CLR threads and the synchronization objects they are waiting on are known to the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] scheduler, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] can schedule threads that are running other database tasks not involving the CLR.</span></span> <span data-ttu-id="cbb5d-197">Isto também permite que o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] detecte deadlocks que envolvem bloqueios tomados pelos objetos de sincronização CLR e utilize técnicas tradicionais para remoção de deadlock.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-197">This also enables [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] to detect deadlocks that involve locks taken by CLR synchronization objects and employ traditional techniques for deadlock removal.</span></span>  
  
 <span data-ttu-id="cbb5d-198">O código gerenciado é executado preventivamente no [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cbb5d-198">Managed code runs preemptively in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="cbb5d-199">O agendador do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] tem a capacidade de detectar e parar threads que não tenham sido executados durante um tempo significativo.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-199">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] scheduler has the ability to detect and stop threads that have not yielded for a significant amount of time.</span></span> <span data-ttu-id="cbb5d-200">A capacidade de conectar threads do CLR a threads do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] implica que o agendador do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] pode identificar threads “fugitivos” no CLR e gerenciar sua prioridade.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-200">The ability to hook CLR threads to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] threads implies that the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] scheduler can identify "runaway" threads in the CLR and manage their priority.</span></span> <span data-ttu-id="cbb5d-201">Tais threads fugitivos são suspensos e devolvidos à fila.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-201">Such runaway threads are suspended and put back in the queue.</span></span> <span data-ttu-id="cbb5d-202">Os threads que são identificados repetidamente como fugitivos não recebem permissão de execução por um determinado período de tempo, para que outros trabalhos possam ser executados.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-202">Threads that are repeatedly identified as runaway threads are not allowed to run for a given period of time so that other executing workers can run.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="cbb5d-203">Código gerenciado de execução longa que acessa dados ou aloca memória suficiente para disparar a coleta de lixo será executado automaticamente.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-203">Long-running managed code that accesses data or allocates enough memory to trigger garbage collection will yield automatically.</span></span> <span data-ttu-id="cbb5d-204">Código gerenciado de execução longa que não acessa dados ou nem aloca memória gerenciada suficiente para disparar a coleta de lixo deve ser executado explicitamente, através da chamada da função System.Thread.Sleep() do .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-204">Long-running managed code that does not access data or allocate enough managed memory to trigger garbage collection should explicitly yield by calling the System.Thread.Sleep() function of the .NET Framework.</span></span>  
  
###### <a name="scalability-common-memory-management"></a><span data-ttu-id="cbb5d-205">Escalabilidade: Gerenciamento de memória comum</span><span class="sxs-lookup"><span data-stu-id="cbb5d-205">Scalability: Common memory management</span></span>  
 <span data-ttu-id="cbb5d-206">O CLR chama primitivas do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] para alocar e desalocar sua memória.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-206">The CLR calls [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] primitives for allocating and de-allocating its memory.</span></span> <span data-ttu-id="cbb5d-207">Como a memória usada pelo CLR é contabilizada no uso de memória total do sistema, o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] pode permanecer dentro dos seus limites de memória configurados e garantir que o CLR e o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] não compitam entre si pela memória.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-207">Because the memory used by the CLR is accounted for in the total memory usage of the system, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] can stay within its configured memory limits and ensure the CLR and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] are not competing with each other for memory.</span></span> <span data-ttu-id="cbb5d-208">O [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] também por rejeitar solicitações de memória do CLR quando a memória do sistema for limitada e solicitar ao CLR que reduza seu uso de memória quando outras tarefas precisarem de memória.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-208">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] can also reject CLR memory requests when system memory is constrained, and ask CLR to reduce its memory use when other tasks need memory.</span></span>  
  
###### <a name="reliability-application-domains-and-unrecoverable-exceptions"></a><span data-ttu-id="cbb5d-209">Confiabilidade: Domínios de aplicativo e exceções irrecuperáveis</span><span class="sxs-lookup"><span data-stu-id="cbb5d-209">Reliability: Application domains and unrecoverable exceptions</span></span>  
 <span data-ttu-id="cbb5d-210">Quando o código gerenciado nas APIs do .NET Framework encontra exceções críticas, como memória insuficiente ou estouro da pilha, nem sempre é possível recuperar-se de tais falhas e garantir a semântica consistente e correta para sua implementação.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-210">When managed code in the .NET Framework APIs encounters critical exceptions, such as out-of-memory or stack overflow, it is not always possible to recover from such failures and ensure consistent and correct semantics for their implementation.</span></span> <span data-ttu-id="cbb5d-211">Estas APIs geram uma exceção de anulação de thread em resposta a essas falhas.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-211">These APIs raise a thread abort exception in response to these failures.</span></span>  
  
 <span data-ttu-id="cbb5d-212">Quando é feita hospedagem no [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], essas anulações de thread são manipuladas da seguinte forma: o CLR detecta qualquer estado compartilhado no domínio do aplicativo no qual a anulação de thread ocorre.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-212">When hosted in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], such thread aborts are handled as follows: the CLR detects any shared state in the application domain in which the thread abort occurs.</span></span> <span data-ttu-id="cbb5d-213">Ele faz isto verificando para a presença de objetos de sincronização.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-213">The CLR does this by checking for the presence of synchronization objects.</span></span> <span data-ttu-id="cbb5d-214">Se houver um estado compartilhado no domínio do aplicativo, então o próprio domínio do aplicativo será descarregado.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-214">If there is shared state in the application domain, then the application domain itself is unloaded.</span></span> <span data-ttu-id="cbb5d-215">A descarga do domínio do aplicativo para transações de banco de dados que estão em execução no momento, naquele domínio de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-215">The unloading of the application domain stops database transactions that are currently running in that application domain.</span></span> <span data-ttu-id="cbb5d-216">Como a presença do estado compartilhado pode ampliar o impacto de tais exceções críticas para as sessões de usuário que não são aquela que está disparando a exceção, o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] e o CLR tomaram medidas para reduzir a probabilidade de estado compartilhado.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-216">Because the presence of shared state can widen the impact of such critical exceptions to user sessions other than the one triggering the exception, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] and the CLR have taken steps to reduce the likelihood of shared state.</span></span> <span data-ttu-id="cbb5d-217">Para obter mais informações, consulte a documentação do .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-217">For more information, see the .NET Framework documentation.</span></span>  
  
###### <a name="security-permission-sets"></a><span data-ttu-id="cbb5d-218">Segurança: conjuntos de permissões</span><span class="sxs-lookup"><span data-stu-id="cbb5d-218">Security: Permission sets</span></span>  
 <span data-ttu-id="cbb5d-219">O [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] permite que os usuários especifiquem os requisitos de confiabilidade e segurança para o código implantado no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-219">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] allows users to specify the reliability and security requirements for code deployed into the database.</span></span> <span data-ttu-id="cbb5d-220">Quando os assemblies são carregados no banco de dados, o autor do assembly pode especificar um dos três conjuntos de permissões para esse assembly: SAFE, EXTERNAL_ACCESS e UNSAFE.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-220">When assemblies are uploaded into the database, the author of the assembly can specify one of three permission sets for that assembly: SAFE, EXTERNAL_ACCESS and UNSAFE.</span></span>  
  
|||||  
|-|-|-|-|  
|<span data-ttu-id="cbb5d-221">Conjunto de permissões</span><span class="sxs-lookup"><span data-stu-id="cbb5d-221">Permission set</span></span>|<span data-ttu-id="cbb5d-222">SAFE</span><span class="sxs-lookup"><span data-stu-id="cbb5d-222">SAFE</span></span>|<span data-ttu-id="cbb5d-223">EXTERNAL_ACCESS</span><span class="sxs-lookup"><span data-stu-id="cbb5d-223">EXTERNAL_ACCESS</span></span>|<span data-ttu-id="cbb5d-224">UNSAFE</span><span class="sxs-lookup"><span data-stu-id="cbb5d-224">UNSAFE</span></span>|  
|<span data-ttu-id="cbb5d-225">Segurança de Acesso do Código</span><span class="sxs-lookup"><span data-stu-id="cbb5d-225">Code Access Security</span></span>|<span data-ttu-id="cbb5d-226">Somente execução</span><span class="sxs-lookup"><span data-stu-id="cbb5d-226">Execute only</span></span>|<span data-ttu-id="cbb5d-227">Execução + acesso a recursos externos</span><span class="sxs-lookup"><span data-stu-id="cbb5d-227">Execute + access to external resources</span></span>|<span data-ttu-id="cbb5d-228">Irrestrito</span><span class="sxs-lookup"><span data-stu-id="cbb5d-228">Unrestricted</span></span>|  
|<span data-ttu-id="cbb5d-229">Restrições do modelo de programação</span><span class="sxs-lookup"><span data-stu-id="cbb5d-229">Programming model restrictions</span></span>|<span data-ttu-id="cbb5d-230">Sim</span><span class="sxs-lookup"><span data-stu-id="cbb5d-230">Yes</span></span>|<span data-ttu-id="cbb5d-231">Sim</span><span class="sxs-lookup"><span data-stu-id="cbb5d-231">Yes</span></span>|<span data-ttu-id="cbb5d-232">Sem restrições</span><span class="sxs-lookup"><span data-stu-id="cbb5d-232">No restrictions</span></span>|  
|<span data-ttu-id="cbb5d-233">Requisito de verificabilidade</span><span class="sxs-lookup"><span data-stu-id="cbb5d-233">Verifiability requirement</span></span>|<span data-ttu-id="cbb5d-234">Sim</span><span class="sxs-lookup"><span data-stu-id="cbb5d-234">Yes</span></span>|<span data-ttu-id="cbb5d-235">Sim</span><span class="sxs-lookup"><span data-stu-id="cbb5d-235">Yes</span></span>|<span data-ttu-id="cbb5d-236">Não</span><span class="sxs-lookup"><span data-stu-id="cbb5d-236">No</span></span>|  
|<span data-ttu-id="cbb5d-237">Capacidade de chamar código nativo</span><span class="sxs-lookup"><span data-stu-id="cbb5d-237">Ability to call native code</span></span>|<span data-ttu-id="cbb5d-238">Não</span><span class="sxs-lookup"><span data-stu-id="cbb5d-238">No</span></span>|<span data-ttu-id="cbb5d-239">Não</span><span class="sxs-lookup"><span data-stu-id="cbb5d-239">No</span></span>|<span data-ttu-id="cbb5d-240">Sim</span><span class="sxs-lookup"><span data-stu-id="cbb5d-240">Yes</span></span>|  
  
 <span data-ttu-id="cbb5d-241">SAFE é o modo mais confiável e seguro, com restrições associadas ao modelo de programação permitido.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-241">SAFE is the most reliable and secure mode with associated restrictions in terms of the allowed programming model.</span></span> <span data-ttu-id="cbb5d-242">Assemblies SAFE recebem permissão suficiente para executar, realizar cálculos e ter acesso ao banco de dados local.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-242">SAFE assemblies are given enough permission to run, perform computations, and have access to the local database.</span></span> <span data-ttu-id="cbb5d-243">Assemblies SAFE precisam ser seguros do tipo verificável e não têm permissão para chamar código não gerenciado.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-243">SAFE assemblies need to be verifiably type safe and are not allowed to call unmanaged code.</span></span>  
  
 <span data-ttu-id="cbb5d-244">UNSAFE é para código altamente confiável que pode ser criado somente por administradores de bancos de dados.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-244">UNSAFE is for highly trusted code that can only be created by database administrators.</span></span> <span data-ttu-id="cbb5d-245">Este código confiável não tem nenhuma restrição de segurança de acesso a código e pode chamar código não gerenciado (nativo).</span><span class="sxs-lookup"><span data-stu-id="cbb5d-245">This trusted code has no code access security restrictions, and it can call unmanaged (native) code.</span></span>  
  
 <span data-ttu-id="cbb5d-246">EXTERNAL_ACCESS fornece uma opção de segurança intermediária, permitindo que o código acesse recursos externos ao banco de dados, mas ainda tenha as garantias de confiabilidade de SAFE.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-246">EXTERNAL_ACCESS provides an intermediate security option, allowing code to access resources external to the database but still having the reliability guarantees of SAFE.</span></span>  
  
 <span data-ttu-id="cbb5d-247">O [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] usa a camada de políticas do CAS no nível de host para configurar uma política de host que conceda um dos três conjuntos de permissões com base no conjunto de permissões armazenado nos catálogos do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cbb5d-247">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] uses the host-level CAS policy layer to set up a host policy that grants one of the three sets of permissions based on the permission set stored in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] catalogs.</span></span> <span data-ttu-id="cbb5d-248">Código gerenciado em execução dentro do banco de dados sempre obtém um desses conjuntos de permissão de acesso de código.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-248">Managed code running inside the database always gets one of these code access permission sets.</span></span>  
  
### <a name="programming-model-restrictions"></a><span data-ttu-id="cbb5d-249">Restrições do Modelo de Programação</span><span class="sxs-lookup"><span data-stu-id="cbb5d-249">Programming Model Restrictions</span></span>  
 <span data-ttu-id="cbb5d-250">O modelo de programação para código gerenciado no [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] envolve a codificação de funções, procedimentos e tipos que normalmente não exigem o uso do estado mantido entre várias invocações nem o compartilhamento do estado entre várias sessões de usuário.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-250">The programming model for managed code in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] involves writing functions, procedures, and types which typically do not require the use of state held across multiple invocations or the sharing of state across multiple user sessions.</span></span> <span data-ttu-id="cbb5d-251">Além disso, conforme descrito anteriormente, a presença do estado compartilhado pode causar exceções críticas que afetam a escalabilidade e a confiabilidade do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-251">Further, as described earlier, the presence of shared state can cause critical exceptions that impact the scalability and the reliability of the application.</span></span>  
  
 <span data-ttu-id="cbb5d-252">Dadas essas considerações, desencorajamos o uso de variáveis estáticas e membros de dados estáticos de classes usado no [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cbb5d-252">Given these considerations, we discourage the use of static variables and static data members of classes used in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="cbb5d-253">Para assemblies SAFE e EXTERNAL_ACCESS, o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] examina os metadados do assembly na ocasião CREATE ASSEMBLY e gerará uma falha na criação desses assemblies se encontrar o uso de membros e variáveis de dados estáticos.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-253">For SAFE and EXTERNAL_ACCESS assemblies, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] examines the metadata of the assembly at CREATE ASSEMBLY time and fails the creation of such assemblies if it finds the use of static data members and variables.</span></span>  
  
 <span data-ttu-id="cbb5d-254">O [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] também desabilita as chamadas às APIs do .NET Framework que são anotadas com os atributos de proteção do host `SharedState`, `Synchronization` e `ExternalProcessMgmt`.</span><span class="sxs-lookup"><span data-stu-id="cbb5d-254">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] also disallows calls to .NET Framework APIs that are annotated with the `SharedState`, `Synchronization` and `ExternalProcessMgmt` host protection attributes.</span></span> <span data-ttu-id="cbb5d-255">Isso impede que os assemblies SAFE e EXTERNAL_ACCESS chamem APIs que permitam compartilhar o estado, fazer sincronização e afetar a integridade do processo do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cbb5d-255">This prevents SAFE and EXTERNAL_ACCESS assemblies from calling any APIs that enable sharing state, performing synchronization, and affecting the integrity of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] process.</span></span> <span data-ttu-id="cbb5d-256">Para obter mais informações, consulte [restrições do modelo de programação de integração CLR](database-objects/clr-integration-programming-model-restrictions.md).</span><span class="sxs-lookup"><span data-stu-id="cbb5d-256">For more information, see [CLR Integration Programming Model Restrictions](database-objects/clr-integration-programming-model-restrictions.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="cbb5d-257">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="cbb5d-257">See Also</span></span>  
 <span data-ttu-id="cbb5d-258">[Segurança de integração CLR](security/clr-integration-security.md) </span><span class="sxs-lookup"><span data-stu-id="cbb5d-258">[CLR Integration Security](security/clr-integration-security.md) </span></span>  
 [<span data-ttu-id="cbb5d-259">Desempenho da integração CLR</span><span class="sxs-lookup"><span data-stu-id="cbb5d-259">Performance of CLR Integration</span></span>](clr-integration-architecture-performance.md)  
  
  
