---
title: Conversões de SQL para C | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- conversions [ODBC], SQL to C
ms.assetid: 059431e2-a65c-4587-ba4a-9929a1611e96
author: rothja
ms.author: jroth
ms.openlocfilehash: 0cc1fe6049824217a12a291b7006599a4a3a7319
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87576334"
---
# <a name="conversions-from-sql-to-c"></a><span data-ttu-id="6a697-102">Conversões de SQL em C</span><span class="sxs-lookup"><span data-stu-id="6a697-102">Conversions from SQL to C</span></span>
  <span data-ttu-id="6a697-103">A seguinte tabela lista aspectos a serem considerados quando você converte tipos de data/hora do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] em tipos do C.</span><span class="sxs-lookup"><span data-stu-id="6a697-103">The following table lists issues to consider when you convert from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] date/time types to C types.</span></span>  
  
## <a name="conversions"></a><span data-ttu-id="6a697-104">Conversões</span><span class="sxs-lookup"><span data-stu-id="6a697-104">Conversions</span></span>  
  
||||||||||  
|-|-|-|-|-|-|-|-|-|  
||<span data-ttu-id="6a697-105">SQL_C_DATE</span><span class="sxs-lookup"><span data-stu-id="6a697-105">SQL_C_DATE</span></span>|<span data-ttu-id="6a697-106">SQL_C_TIME</span><span class="sxs-lookup"><span data-stu-id="6a697-106">SQL_C_TIME</span></span>|<span data-ttu-id="6a697-107">SQL_C_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="6a697-107">SQL_C_TIMESTAMP</span></span>|<span data-ttu-id="6a697-108">SQL_C_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="6a697-108">SQL_C_SS_TIME2</span></span>|<span data-ttu-id="6a697-109">SQL_C_SS_TIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="6a697-109">SQL_C_SS_TIMESTAMPOFFSET</span></span>|<span data-ttu-id="6a697-110">SQL_C_BINARY</span><span class="sxs-lookup"><span data-stu-id="6a697-110">SQL_C_BINARY</span></span>|<span data-ttu-id="6a697-111">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="6a697-111">SQL_C_CHAR</span></span>|<span data-ttu-id="6a697-112">SQL_C_WCHAR</span><span class="sxs-lookup"><span data-stu-id="6a697-112">SQL_C_WCHAR</span></span>|  
|<span data-ttu-id="6a697-113">SQL_CHAR</span><span class="sxs-lookup"><span data-stu-id="6a697-113">SQL_CHAR</span></span>|<span data-ttu-id="6a697-114">2, 3, 4, 5</span><span class="sxs-lookup"><span data-stu-id="6a697-114">2,3,4,5</span></span>|<span data-ttu-id="6a697-115">2, 3, 6, 7, 8</span><span class="sxs-lookup"><span data-stu-id="6a697-115">2,3,6,7,8</span></span>|<span data-ttu-id="6a697-116">2, 3, 9, 10, 11</span><span class="sxs-lookup"><span data-stu-id="6a697-116">2,3,9,10,11</span></span>|<span data-ttu-id="6a697-117">2, 3, 6, 7</span><span class="sxs-lookup"><span data-stu-id="6a697-117">2,3,6,7</span></span>|<span data-ttu-id="6a697-118">2, 3, 9, 10, 11</span><span class="sxs-lookup"><span data-stu-id="6a697-118">2,3,9,10,11</span></span>|<span data-ttu-id="6a697-119">1</span><span class="sxs-lookup"><span data-stu-id="6a697-119">1</span></span>|<span data-ttu-id="6a697-120">1</span><span class="sxs-lookup"><span data-stu-id="6a697-120">1</span></span>|<span data-ttu-id="6a697-121">1</span><span class="sxs-lookup"><span data-stu-id="6a697-121">1</span></span>|  
|<span data-ttu-id="6a697-122">SQL_WCHAR</span><span class="sxs-lookup"><span data-stu-id="6a697-122">SQL_WCHAR</span></span>|<span data-ttu-id="6a697-123">2, 3, 4, 5</span><span class="sxs-lookup"><span data-stu-id="6a697-123">2,3,4,5</span></span>|<span data-ttu-id="6a697-124">2, 3, 6, 7, 8</span><span class="sxs-lookup"><span data-stu-id="6a697-124">2,3,6,7,8</span></span>|<span data-ttu-id="6a697-125">2, 3, 9, 10, 11</span><span class="sxs-lookup"><span data-stu-id="6a697-125">2,3,9,10,11</span></span>|<span data-ttu-id="6a697-126">2, 3, 6, 7</span><span class="sxs-lookup"><span data-stu-id="6a697-126">2,3,6,7</span></span>|<span data-ttu-id="6a697-127">2, 3, 9, 10, 11</span><span class="sxs-lookup"><span data-stu-id="6a697-127">2,3,9,10,11</span></span>|<span data-ttu-id="6a697-128">1</span><span class="sxs-lookup"><span data-stu-id="6a697-128">1</span></span>|<span data-ttu-id="6a697-129">1</span><span class="sxs-lookup"><span data-stu-id="6a697-129">1</span></span>|<span data-ttu-id="6a697-130">1</span><span class="sxs-lookup"><span data-stu-id="6a697-130">1</span></span>|  
|<span data-ttu-id="6a697-131">SQL_TYPE_DATE</span><span class="sxs-lookup"><span data-stu-id="6a697-131">SQL_TYPE_DATE</span></span>|<span data-ttu-id="6a697-132">OK</span><span class="sxs-lookup"><span data-stu-id="6a697-132">OK</span></span>|<span data-ttu-id="6a697-133">12</span><span class="sxs-lookup"><span data-stu-id="6a697-133">12</span></span>|<span data-ttu-id="6a697-134">13</span><span class="sxs-lookup"><span data-stu-id="6a697-134">13</span></span>|<span data-ttu-id="6a697-135">12</span><span class="sxs-lookup"><span data-stu-id="6a697-135">12</span></span>|<span data-ttu-id="6a697-136">13, 23</span><span class="sxs-lookup"><span data-stu-id="6a697-136">13,23</span></span>|<span data-ttu-id="6a697-137">14</span><span class="sxs-lookup"><span data-stu-id="6a697-137">14</span></span>|<span data-ttu-id="6a697-138">16</span><span class="sxs-lookup"><span data-stu-id="6a697-138">16</span></span>|<span data-ttu-id="6a697-139">16</span><span class="sxs-lookup"><span data-stu-id="6a697-139">16</span></span>|  
|<span data-ttu-id="6a697-140">SQL_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="6a697-140">SQL_SS_TIME2</span></span>|<span data-ttu-id="6a697-141">12</span><span class="sxs-lookup"><span data-stu-id="6a697-141">12</span></span>|<span data-ttu-id="6a697-142">8</span><span class="sxs-lookup"><span data-stu-id="6a697-142">8</span></span>|<span data-ttu-id="6a697-143">15</span><span class="sxs-lookup"><span data-stu-id="6a697-143">15</span></span>|<span data-ttu-id="6a697-144">OK</span><span class="sxs-lookup"><span data-stu-id="6a697-144">OK</span></span>|<span data-ttu-id="6a697-145">10, 23</span><span class="sxs-lookup"><span data-stu-id="6a697-145">10,23</span></span>|<span data-ttu-id="6a697-146">17</span><span class="sxs-lookup"><span data-stu-id="6a697-146">17</span></span>|<span data-ttu-id="6a697-147">16</span><span class="sxs-lookup"><span data-stu-id="6a697-147">16</span></span>|<span data-ttu-id="6a697-148">16</span><span class="sxs-lookup"><span data-stu-id="6a697-148">16</span></span>|  
|<span data-ttu-id="6a697-149">SQL_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="6a697-149">SQL_TYPE_TIMESTAMP</span></span>|<span data-ttu-id="6a697-150">18</span><span class="sxs-lookup"><span data-stu-id="6a697-150">18</span></span>|<span data-ttu-id="6a697-151">7, 8</span><span class="sxs-lookup"><span data-stu-id="6a697-151">7,8</span></span>|<span data-ttu-id="6a697-152">OK</span><span class="sxs-lookup"><span data-stu-id="6a697-152">OK</span></span>|<span data-ttu-id="6a697-153">7</span><span class="sxs-lookup"><span data-stu-id="6a697-153">7</span></span>|<span data-ttu-id="6a697-154">23</span><span class="sxs-lookup"><span data-stu-id="6a697-154">23</span></span>|<span data-ttu-id="6a697-155">19</span><span class="sxs-lookup"><span data-stu-id="6a697-155">19</span></span>|<span data-ttu-id="6a697-156">16</span><span class="sxs-lookup"><span data-stu-id="6a697-156">16</span></span>|<span data-ttu-id="6a697-157">16</span><span class="sxs-lookup"><span data-stu-id="6a697-157">16</span></span>|  
|<span data-ttu-id="6a697-158">SQL_SS_TIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="6a697-158">SQL_SS_TIMESTAMPOFFSET</span></span>|<span data-ttu-id="6a697-159">18, 22</span><span class="sxs-lookup"><span data-stu-id="6a697-159">18,22</span></span>|<span data-ttu-id="6a697-160">7, 8, 20</span><span class="sxs-lookup"><span data-stu-id="6a697-160">7,8,20</span></span>|<span data-ttu-id="6a697-161">20</span><span class="sxs-lookup"><span data-stu-id="6a697-161">20</span></span>|<span data-ttu-id="6a697-162">7, 20</span><span class="sxs-lookup"><span data-stu-id="6a697-162">7,20</span></span>|<span data-ttu-id="6a697-163">OK</span><span class="sxs-lookup"><span data-stu-id="6a697-163">OK</span></span>|<span data-ttu-id="6a697-164">21</span><span class="sxs-lookup"><span data-stu-id="6a697-164">21</span></span>|<span data-ttu-id="6a697-165">16</span><span class="sxs-lookup"><span data-stu-id="6a697-165">16</span></span>|<span data-ttu-id="6a697-166">16</span><span class="sxs-lookup"><span data-stu-id="6a697-166">16</span></span>|  
  
## <a name="key-to-symbols"></a><span data-ttu-id="6a697-167">Legenda dos símbolos</span><span class="sxs-lookup"><span data-stu-id="6a697-167">Key to Symbols</span></span>  
  
|<span data-ttu-id="6a697-168">Símbolo</span><span class="sxs-lookup"><span data-stu-id="6a697-168">Symbol</span></span>|<span data-ttu-id="6a697-169">Significado</span><span class="sxs-lookup"><span data-stu-id="6a697-169">Meaning</span></span>|  
|------------|-------------|  
|<span data-ttu-id="6a697-170">OK</span><span class="sxs-lookup"><span data-stu-id="6a697-170">OK</span></span>|<span data-ttu-id="6a697-171">Nenhum problema na conversão.</span><span class="sxs-lookup"><span data-stu-id="6a697-171">No conversion issues.</span></span>|  
|<span data-ttu-id="6a697-172">1</span><span class="sxs-lookup"><span data-stu-id="6a697-172">1</span></span>|<span data-ttu-id="6a697-173">Regras anteriores ao [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] se aplicam.</span><span class="sxs-lookup"><span data-stu-id="6a697-173">Rules prior to [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] apply.</span></span>|  
|<span data-ttu-id="6a697-174">2</span><span class="sxs-lookup"><span data-stu-id="6a697-174">2</span></span>|<span data-ttu-id="6a697-175">Os espaços à esquerda e à direita são ignorados.</span><span class="sxs-lookup"><span data-stu-id="6a697-175">Leading and trailing spaces are ignored.</span></span>|  
|<span data-ttu-id="6a697-176">3</span><span class="sxs-lookup"><span data-stu-id="6a697-176">3</span></span>|<span data-ttu-id="6a697-177">A cadeia de caracteres é analisada em date, time, timezone ou timezoneoffset e permite até nove dígitos para segundos fracionários.</span><span class="sxs-lookup"><span data-stu-id="6a697-177">The string is parsed into a date, time, timezone, or timezoneoffset, and allows up to 9 digits for fractional seconds.</span></span> <span data-ttu-id="6a697-178">Caso timezoneoffset seja analisado, a hora é convertida no fuso horário do cliente.</span><span class="sxs-lookup"><span data-stu-id="6a697-178">If a timezoneoffset is parsed, the time is converted to the client timezone.</span></span> <span data-ttu-id="6a697-179">Se ocorrer um erro durante essa conversão, um registro de diagnóstico será gerado com SQLSTATE 22018 e a mensagem "estouro de campo de data/hora".</span><span class="sxs-lookup"><span data-stu-id="6a697-179">If an error occurs during this conversion, a diagnostic record is generated with SQLSTATE 22018 and the message "Datetime field overflow".</span></span>|  
|<span data-ttu-id="6a697-180">4</span><span class="sxs-lookup"><span data-stu-id="6a697-180">4</span></span>|<span data-ttu-id="6a697-181">Caso o valor não seja date, timestamp ou timestampoffset válido, um registro de diagnóstico é gerado com SQLSTATE 22018 e a mensagem "Valor de caractere inválido para a especificação de difusão".</span><span class="sxs-lookup"><span data-stu-id="6a697-181">If the value is not a valid date, timestamp, or timestampoffset value, a diagnostic record is generated with SQLSTATE 22018 and the message "Invalid character value for cast specification".</span></span>|  
|<span data-ttu-id="6a697-182">5</span><span class="sxs-lookup"><span data-stu-id="6a697-182">5</span></span>|<span data-ttu-id="6a697-183">Caso a hora seja diferente de zero, um registro de diagnóstico é gerado com SQLSTATE 01S07 e a mensagem "Truncamento fracionário".</span><span class="sxs-lookup"><span data-stu-id="6a697-183">If the time is non-zero, a diagnostic record is generated with SQLSTATE 01S07 and the message "Fractional truncation".</span></span>|  
|<span data-ttu-id="6a697-184">6</span><span class="sxs-lookup"><span data-stu-id="6a697-184">6</span></span>|<span data-ttu-id="6a697-185">Caso o valor não seja time, timestamp ou timestampoffset válido, um registro de diagnóstico é gerado com SQLSTATE 22018 e a mensagem "Valor de caractere inválido para a especificação de difusão".</span><span class="sxs-lookup"><span data-stu-id="6a697-185">If the value is not a valid time, timestamp, or timestampoffset value, a diagnostic record is generated with SQLSTATE 22018 and the message "Invalid character value for cast specification".</span></span>|  
|<span data-ttu-id="6a697-186">7</span><span class="sxs-lookup"><span data-stu-id="6a697-186">7</span></span>|<span data-ttu-id="6a697-187">O componente de data é ignorado.</span><span class="sxs-lookup"><span data-stu-id="6a697-187">The date component is ignored.</span></span>|  
|<span data-ttu-id="6a697-188">8</span><span class="sxs-lookup"><span data-stu-id="6a697-188">8</span></span>|<span data-ttu-id="6a697-189">Caso os segundos fracionários sejam diferentes de zero, um registro de diagnóstico é gerado com SQLSTATE 01S07 e a mensagem "Truncamento fracionário".</span><span class="sxs-lookup"><span data-stu-id="6a697-189">If the fractional seconds are non-zero, a diagnostic record is generated with SQLSTATE 01S07 and the message "Fractional truncation".</span></span>|  
|<span data-ttu-id="6a697-190">9</span><span class="sxs-lookup"><span data-stu-id="6a697-190">9</span></span>|<span data-ttu-id="6a697-191">Caso o valor não seja date, time, timestamp ou timestampoffset válido, um registro de diagnóstico é gerado com SQLSTATE 22018 e a mensagem "Valor de caractere inválido para a especificação de difusão".</span><span class="sxs-lookup"><span data-stu-id="6a697-191">If the value is not a valid date, time, timestamp, or timestampoffset value, a diagnostic record is generated with SQLSTATE 22018 and the message "Invalid character value for cast specification".</span></span>|  
|<span data-ttu-id="6a697-192">10</span><span class="sxs-lookup"><span data-stu-id="6a697-192">10</span></span>|<span data-ttu-id="6a697-193">Caso o valor não seja uma hora válida, o componente de data é definido como a data do cliente atual.</span><span class="sxs-lookup"><span data-stu-id="6a697-193">If the value is a valid time, the date component is set to current client date.</span></span>|  
|<span data-ttu-id="6a697-194">11</span><span class="sxs-lookup"><span data-stu-id="6a697-194">11</span></span>|<span data-ttu-id="6a697-195">Caso o valor seja uma data válida, a hora é definida como zero.</span><span class="sxs-lookup"><span data-stu-id="6a697-195">If the value is a valid date, the time is set to zero.</span></span>|  
|<span data-ttu-id="6a697-196">12</span><span class="sxs-lookup"><span data-stu-id="6a697-196">12</span></span>|<span data-ttu-id="6a697-197">Será gerado um registro de diagnóstico com SQLSTATE 07006 e a mensagem "Violação do atributo de tipo de dados restrito".</span><span class="sxs-lookup"><span data-stu-id="6a697-197">A diagnostic record is generated with SQLSTATE 07006 and the message "Restricted data type attribute violation".</span></span>|  
|<span data-ttu-id="6a697-198">13</span><span class="sxs-lookup"><span data-stu-id="6a697-198">13</span></span>|<span data-ttu-id="6a697-199">A hora é definida como zero.</span><span class="sxs-lookup"><span data-stu-id="6a697-199">The time is set to zero.</span></span>|  
|<span data-ttu-id="6a697-200">14</span><span class="sxs-lookup"><span data-stu-id="6a697-200">14</span></span>|<span data-ttu-id="6a697-201">Caso o buffer não seja grande o suficiente para acomodar SQL_DATE_STRUCT, um registro de diagnóstico é gerado com SQLSTATE 22003 e a mensagem "Valor numérico fora do intervalo".</span><span class="sxs-lookup"><span data-stu-id="6a697-201">If the buffer is not large enough to accommodate a SQL_DATE_STRUCT, a diagnostic record is generated with SQLSTATE 22003 and the message "Numeric value out of range".</span></span>|  
|<span data-ttu-id="6a697-202">15</span><span class="sxs-lookup"><span data-stu-id="6a697-202">15</span></span>|<span data-ttu-id="6a697-203">A data é definida como a data atual do cliente.</span><span class="sxs-lookup"><span data-stu-id="6a697-203">The date is set to the current client date.</span></span>|  
|<span data-ttu-id="6a697-204">16</span><span class="sxs-lookup"><span data-stu-id="6a697-204">16</span></span>|<span data-ttu-id="6a697-205">Caso o buffer não seja grande o suficiente para acomodar o valor da cadeia de caracteres convertida, e sim apenas segundos fracionários, ocorre o truncamento, e um registro de diagnóstico é gerado com SQLSTATE 01004 e a mensagem "Dados de cadeia de caracteres truncados à direita".</span><span class="sxs-lookup"><span data-stu-id="6a697-205">If the buffer is not large enough to accommodate the converted string value but only fractional seconds, truncation occurs and a diagnostic record is generated with SQLSTATE 01004 and the message "String data, right truncated".</span></span> <span data-ttu-id="6a697-206">Caso o buffer não seja grande o suficiente para acomodar o valor da cadeia de caracteres sem truncamento dos componentes de data, hora ou deslocamento, um registro de diagnóstico é gerado com SQLSTATE 22003 e a mensagem "Valor numérico fora do intervalo".</span><span class="sxs-lookup"><span data-stu-id="6a697-206">If the buffer is not large enough to accommodate the string value without truncation of date, time, or offset components, a diagnostic record is generated with SQLSTATE 22003 and the message "Numeric value out of range".</span></span> <span data-ttu-id="6a697-207">Observe que para date e timestampoffset, SQLSTATE 01004 não é possível porque a parte mais à direita da cadeia de caracteres convertida não contém segundos fracionários.</span><span class="sxs-lookup"><span data-stu-id="6a697-207">Note that for date and timestampoffset, SQLSTATE 01004 is not possible because the rightmost part of the converted string does not contain fractional seconds.</span></span> <span data-ttu-id="6a697-208">Dessa forma, qualquer truncamento causa a perda de dados.</span><span class="sxs-lookup"><span data-stu-id="6a697-208">Therefore, any truncation causes data loss.</span></span>|  
|<span data-ttu-id="6a697-209">17</span><span class="sxs-lookup"><span data-stu-id="6a697-209">17</span></span>|<span data-ttu-id="6a697-210">Caso buffer não seja grande o suficiente para acomodar um SQL_SS_TIME2_STRUCT, um registro de diagnóstico é gerado com SQLSTATE 22003 e a mensagem "Valor numérico fora do intervalo".</span><span class="sxs-lookup"><span data-stu-id="6a697-210">If the buffer is not large enough to accommodate a SQL_SS_TIME2_STRUCT, a diagnostic record is generated with SQLSTATE 22003 and the message "Numeric value out of range".</span></span>|  
|<span data-ttu-id="6a697-211">18</span><span class="sxs-lookup"><span data-stu-id="6a697-211">18</span></span>|<span data-ttu-id="6a697-212">Caso a hora seja diferente de zero, um registro de diagnóstico é gerado com SQLSTATE 01S07 e a mensagem "Truncamento fracionário".</span><span class="sxs-lookup"><span data-stu-id="6a697-212">If the time is non-zero, a diagnostic record is generated with SQLSTATE 01S07 and the message "Fractional truncation".</span></span>|  
|<span data-ttu-id="6a697-213">19</span><span class="sxs-lookup"><span data-stu-id="6a697-213">19</span></span>|<span data-ttu-id="6a697-214">Se o tipo de servidor for datetime ou smalldatetime, o valor corresponderá ao formato com fio TDS e será um valor de quatro bytes para smalldatetime e de oito para datetime.</span><span class="sxs-lookup"><span data-stu-id="6a697-214">If the server type is datetime or smalldatetime, the value corresponds to the TDS wire format and will be a 4-byte value for smalldatetime and an 8-byte value for datetime.</span></span><br /><br /> <span data-ttu-id="6a697-215">Caso o tipo de servidor seja datetime2, o valor é retornado como SQL_TIMESTAMP_STRUCT.</span><span class="sxs-lookup"><span data-stu-id="6a697-215">If the server type is datetime2, the value is returned as a SQL_TIMESTAMP_STRUCT.</span></span> <span data-ttu-id="6a697-216">Caso o buffer não seja grande o suficiente para acomodar o valor retornado, um registro de diagnóstico é gerado com SQLSTATE 22003 e a mensagem "Valor numérico fora do intervalo".</span><span class="sxs-lookup"><span data-stu-id="6a697-216">If the buffer is not large enough to accommodate the returned value, a diagnostic record is generated with SQLSTATE 22003 and the message "Numeric value out of range".</span></span>|  
|<span data-ttu-id="6a697-217">20</span><span class="sxs-lookup"><span data-stu-id="6a697-217">20</span></span>|<span data-ttu-id="6a697-218">A hora é convertida para o fuso horário do cliente.</span><span class="sxs-lookup"><span data-stu-id="6a697-218">The time is converted to the client timezone.</span></span> <span data-ttu-id="6a697-219">Se ocorrer um erro durante esta conversão, um registro de diagnóstico será gerado com SQLSTATE 22008 e a mensagem "Estouro do campo datetime".</span><span class="sxs-lookup"><span data-stu-id="6a697-219">If an error occurs during this conversion, a diagnostic record is generated with SQLSTATE 22008 and the message "Datetime field overflow".</span></span>|  
|<span data-ttu-id="6a697-220">21</span><span class="sxs-lookup"><span data-stu-id="6a697-220">21</span></span>|<span data-ttu-id="6a697-221">Caso o buffer seja grande o suficiente para acomodar um SQL_SS_TIMESTAMPOFFSET_STRUCT, o valor é retornado como SQL_SS_TIMESTAMPOFFSET_STRUCT.</span><span class="sxs-lookup"><span data-stu-id="6a697-221">If the buffer is large enough to accommodate a SQL_SS_TIMESTAMPOFFSET_STRUCT, the value is returned as a SQL_SS_TIMESTAMPOFFSET_STRUCT.</span></span> <span data-ttu-id="6a697-222">Caso contrário, um registro de diagnóstico é gerado com SQLSTATE 22003 e a mensagem "Valor numérico fora do intervalo".</span><span class="sxs-lookup"><span data-stu-id="6a697-222">Otherwise, a diagnostic record is generated with SQLSTATE 22003 and the message "Numeric value out of range".</span></span>|  
|<span data-ttu-id="6a697-223">22</span><span class="sxs-lookup"><span data-stu-id="6a697-223">22</span></span>|<span data-ttu-id="6a697-224">O valor é convertido no fuso horário do cliente antes da extração da data.</span><span class="sxs-lookup"><span data-stu-id="6a697-224">The value is converted to the client timezone before the date is extracted.</span></span> <span data-ttu-id="6a697-225">Isso proporciona consistência em relação às demais conversões com tipos timestampoffset.</span><span class="sxs-lookup"><span data-stu-id="6a697-225">This provides consistency with other conversions with timestampoffset types.</span></span> <span data-ttu-id="6a697-226">Se ocorrer um erro durante esta conversão, um registro de diagnóstico será gerado com SQLSTATE 22008 e a mensagem "Estouro do campo datetime".</span><span class="sxs-lookup"><span data-stu-id="6a697-226">If an error occurs during this conversion, a diagnostic record is generated with SQLSTATE 22008 and the message "Datetime field overflow".</span></span> <span data-ttu-id="6a697-227">Isso pode resultar em uma data diferente do valor obtido pelo truncamento simples.</span><span class="sxs-lookup"><span data-stu-id="6a697-227">This might result in a date that differs from the value obtained by simple truncation.</span></span>|  
  
 <span data-ttu-id="6a697-228">A tabela neste tópico descreve conversões entre o tipo retornado para o cliente e o tipo na associação.</span><span class="sxs-lookup"><span data-stu-id="6a697-228">The table in this topic describes conversions between the type returned to the client and the type in the binding.</span></span> <span data-ttu-id="6a697-229">Para parâmetros de saída, se o tipo de servidor especificado em SQLBindParameter não corresponder ao tipo real no servidor, uma conversão implícita será executada pelo servidor e o tipo retornado para o cliente corresponderá ao tipo especificado por meio de SQLBindParameter.</span><span class="sxs-lookup"><span data-stu-id="6a697-229">For output parameters, if the server type specified in SQLBindParameter does not match the actual type on the server, an implicit conversion will be performed by the server and the type returned to the client will match the type specified through SQLBindParameter.</span></span> <span data-ttu-id="6a697-230">Isso pode levar a resultados de conversão inesperados quando as regras de conversão do servidor são diferentes daquelas listadas na tabela anterior.</span><span class="sxs-lookup"><span data-stu-id="6a697-230">This can lead to unexpected conversion results when the server's conversion rules are different from those listed in the preceding table.</span></span> <span data-ttu-id="6a697-231">Por exemplo, quando uma data padrão precisar ser fornecida, o [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] usa 1900-1-1, e não a data atual.</span><span class="sxs-lookup"><span data-stu-id="6a697-231">For example, when a default date must be provided, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] uses 1900-1-1, rather than the current date.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6a697-232">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="6a697-232">See Also</span></span>  
 [<span data-ttu-id="6a697-233">Melhorias de data e hora &#40;&#41;ODBC</span><span class="sxs-lookup"><span data-stu-id="6a697-233">Date and Time Improvements &#40;ODBC&#41;</span></span>](date-and-time-improvements-odbc.md)  
  
  
