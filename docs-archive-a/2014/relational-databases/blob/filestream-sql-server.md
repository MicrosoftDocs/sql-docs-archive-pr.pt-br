---
title: FILESTREAM (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 06/14/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: filestream
ms.topic: conceptual
helpviewer_keywords:
- FILESTREAM [SQL Server]
- FILESTREAM [SQL Server], about
- FILESTREAM [SQL Server], overview
ms.assetid: 9a5a8166-bcbe-4680-916c-26276253eafa
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 971f45fd69f381a8997bb2f8f08444f4d9c107c4
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87684777"
---
# <a name="filestream-sql-server"></a><span data-ttu-id="5a0fe-102">FILESTREAM (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="5a0fe-102">FILESTREAM (SQL Server)</span></span>
  <span data-ttu-id="5a0fe-103">O FILESTREAM permite que aplicativos baseados no [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] armazenem dados não estruturados, como documentos e imagens, no sistema de arquivos.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-103">FILESTREAM enables [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-based applications to store unstructured data, such as documents and images, on the file system.</span></span> <span data-ttu-id="5a0fe-104">Os aplicativos podem utilizar as APIs de streaming avançado e o desempenho do sistema de arquivos e, ao mesmo tempo, manter consistência transacional entre os dados não estruturados e os dados estruturados correspondentes.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-104">Applications can leverage the rich streaming APIs and performance of the file system and at the same time maintain transactional consistency between the unstructured data and corresponding structured data.</span></span>  
  
 <span data-ttu-id="5a0fe-105">O FILESTREAM integra o [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] com um sistema de arquivos NTFS armazenando `varbinary(max)` dados BLOB (objeto binário grande) como arquivos no sistema de arquivos.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-105">FILESTREAM integrates the [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] with an NTFS file system by storing `varbinary(max)` binary large object (BLOB) data as files on the file system.</span></span> [!INCLUDE[tsql](../../includes/tsql-md.md)] <span data-ttu-id="5a0fe-106">podem inserir, atualizar, consultar, pesquisar e fazer backup de dados FILESTREAM.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-106">statements can insert, update, query, search, and back up FILESTREAM data.</span></span> <span data-ttu-id="5a0fe-107">As interfaces do sistema de arquivos do Win32 fornecem acesso de streaming aos dados.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-107">Win32 file system interfaces provide streaming access to the data.</span></span>  
  
 <span data-ttu-id="5a0fe-108">O FILESTREAM usa o cache do sistema NT para armazenar dados de arquivos.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-108">FILESTREAM uses the NT system cache for caching file data.</span></span> <span data-ttu-id="5a0fe-109">Isso ajuda a reduzir qualquer efeito que os dados FILESTREAM possam ter no desempenho do [!INCLUDE[ssDE](../../includes/ssde-md.md)].</span><span class="sxs-lookup"><span data-stu-id="5a0fe-109">This helps reduce any effect that FILESTREAM data might have on [!INCLUDE[ssDE](../../includes/ssde-md.md)] performance.</span></span> <span data-ttu-id="5a0fe-110">O pool de buffers do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] não é usado. Portanto essa memória está disponível para processamento de consulta.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-110">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] buffer pool is not used; therefore, this memory is available for query processing.</span></span>  
  
 <span data-ttu-id="5a0fe-111">FILESTREAM não é habilitado automaticamente quando você instalar ou atualiza o [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="5a0fe-111">FILESTREAM is not automatically enabled when you install or upgrade [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="5a0fe-112">Você deve habilitar o FILESTREAM usando o SQL Server Configuration Manager e o [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="5a0fe-112">You must enable FILESTREAM by using SQL Server Configuration Manager and [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span></span> <span data-ttu-id="5a0fe-113">Para usar o FILESTREAM, você deve criar ou modificar um banco de dados para conter um tipo especial de grupo de arquivos.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-113">To use FILESTREAM, you must create or modify a database to contain a special type of filegroup.</span></span> <span data-ttu-id="5a0fe-114">Então, crie ou modifique uma tabela de forma que ela contenha uma coluna `varbinary(max)` com o atributo FILESTREAM.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-114">Then, create or modify a table so that it contains a `varbinary(max)` column with the FILESTREAM attribute.</span></span> <span data-ttu-id="5a0fe-115">Depois que você concluir essas tarefas, poderá usar [!INCLUDE[tsql](../../includes/tsql-md.md)] e Win32 para gerenciar os dados de FILESTREAM.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-115">After you complete these tasks, you can use [!INCLUDE[tsql](../../includes/tsql-md.md)] and Win32 to manage the FILESTREAM data.</span></span>  
  
 <span data-ttu-id="5a0fe-116">Para obter mais informações sobre como instalar e usar FILESTREAM, consulte a lista de [Tarefas relacionadas](#reltasks).</span><span class="sxs-lookup"><span data-stu-id="5a0fe-116">For more information about installing and using FILESTREAM, see the list of [Related Tasks](#reltasks).</span></span>  
  
##  <a name="when-to-use-filestream"></a><a name="whentouse"></a><span data-ttu-id="5a0fe-117">Quando usar FILESTREAM</span><span class="sxs-lookup"><span data-stu-id="5a0fe-117">When to Use FILESTREAM</span></span>  
 <span data-ttu-id="5a0fe-118">No [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], os BLOBs podem ser dados `varbinary(max)` padrão que armazenam os dados em tabelas ou objetos `varbinary(max)` FILESTREAM que armazenam os dados no sistema de arquivos.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-118">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], BLOBs can be standard `varbinary(max)` data that stores the data in tables, or FILESTREAM `varbinary(max)` objects that store the data in the file system.</span></span> <span data-ttu-id="5a0fe-119">O tamanho e o uso dos dados determinam se você deve usar armazenamento de banco de dados ou armazenamento de sistema de arquivos.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-119">The size and use of the data determines whether you should use database storage or file system storage.</span></span> <span data-ttu-id="5a0fe-120">Se as condições a seguir forem verdadeiras, você deve considerar o uso de FILESTREAM:</span><span class="sxs-lookup"><span data-stu-id="5a0fe-120">If the following conditions are true, you should consider using FILESTREAM:</span></span>  
  
-   <span data-ttu-id="5a0fe-121">Os objetos que estão sendo armazenados têm, em média, mais de 1 MB.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-121">Objects that are being stored are, on average, larger than 1 MB.</span></span>  
  
-   <span data-ttu-id="5a0fe-122">O acesso rápido para leitura é importante.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-122">Fast read access is important.</span></span>  
  
-   <span data-ttu-id="5a0fe-123">Você está desenvolvendo aplicativos que usam uma camada intermediária para lógica de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-123">You are developing applications that use a middle tier for application logic.</span></span>  
  
 <span data-ttu-id="5a0fe-124">Para objetos menores, o armazenamento de BLOBs `varbinary(max)` no banco de dados normalmente fornece melhor desempenho de streaming.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-124">For smaller objects, storing `varbinary(max)` BLOBs in the database often provides better streaming performance.</span></span>  
  
  
##  <a name="filestream-storage"></a><a name="storage"></a><span data-ttu-id="5a0fe-125">Armazenamento de FILESTREAM</span><span class="sxs-lookup"><span data-stu-id="5a0fe-125">FILESTREAM Storage</span></span>  
 <span data-ttu-id="5a0fe-126">O armazenamento de FILESTREAM é implementado como uma coluna `varbinary(max)` na qual os dados são armazenados como BLOBs no sistema de arquivos.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-126">FILESTREAM storage is implemented as a `varbinary(max)` column in which the data is stored as BLOBs in the file system.</span></span> <span data-ttu-id="5a0fe-127">Os tamanhos dos BLOBs são limitados apenas pelo tamanho do volume do sistema de arquivos.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-127">The sizes of the BLOBs are limited only by the volume size of the file system.</span></span> <span data-ttu-id="5a0fe-128">A limitação padrão de `varbinary(max)` tamanhos de arquivos de 2 GB não se aplica a BLOBs que são armazenados no sistema de arquivos.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-128">The standard `varbinary(max)` limitation of 2-GB file sizes does not apply to BLOBs that are stored in the file system.</span></span>  
  
 <span data-ttu-id="5a0fe-129">Para determinar que uma coluna deve armazenar dados no sistema de arquivos, especifique o atributo FILESTREAM em uma coluna `varbinary(max)`.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-129">To specify that a column should store data on the file system, specify the FILESTREAM attribute on a `varbinary(max)` column.</span></span> <span data-ttu-id="5a0fe-130">Isso faz com que o [!INCLUDE[ssDE](../../includes/ssde-md.md)] armazene todos os dados dessa coluna no sistema de arquivos, mas não no arquivo do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-130">This causes the [!INCLUDE[ssDE](../../includes/ssde-md.md)] to store all data for that column on the file system, but not in the database file.</span></span>  
  
 <span data-ttu-id="5a0fe-131">Os dados FILESTREAM devem ser armazenados em grupos de arquivos FILESTREAM.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-131">FILESTREAM data must be stored in FILESTREAM filegroups.</span></span> <span data-ttu-id="5a0fe-132">Um grupo de arquivos FILESTREAM é um grupo de arquivos especial que contém diretórios do sistema de arquivos em vez dos próprios arquivos.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-132">A FILESTREAM filegroup is a special filegroup that contains file system directories instead of the files themselves.</span></span> <span data-ttu-id="5a0fe-133">Esses diretórios do sistema de arquivos são chamados de *contêineres de dados*.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-133">These file system directories are called *data containers*.</span></span> <span data-ttu-id="5a0fe-134">Os contêineres de dados são a interface entre armazenamento [!INCLUDE[ssDE](../../includes/ssde-md.md)] e armazenamento de sistema de arquivos.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-134">Data containers are the interface between [!INCLUDE[ssDE](../../includes/ssde-md.md)] storage and file system storage.</span></span>  
  
 <span data-ttu-id="5a0fe-135">Ao usar armazenamento de FILESTREAM, considere o seguinte:</span><span class="sxs-lookup"><span data-stu-id="5a0fe-135">When you use FILESTREAM storage, consider the following:</span></span>  
  
-   <span data-ttu-id="5a0fe-136">Quando uma tabela contém uma coluna FILESTREAM, cada linha deve ter uma ID de linha exclusiva não nula.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-136">When a table contains a FILESTREAM column, each row must have a nonnull unique row ID.</span></span>  
  
-   <span data-ttu-id="5a0fe-137">Vários contêineres de dados podem ser adicionados a um grupo de arquivos FILESTREAM.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-137">Multiple data containers can be added to a FILESTREAM filegroup.</span></span>  
  
-   <span data-ttu-id="5a0fe-138">Os contêineres de dados FILESTREAM não podem ser aninhados.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-138">FILESTREAM data containers cannot be nested.</span></span>  
  
-   <span data-ttu-id="5a0fe-139">Quando você usa clustering de failover, os grupos de arquivos FILESTREAM devem estar em recursos de disco compartilhados.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-139">When you are using failover clustering, the FILESTREAM filegroups must be on shared disk resources.</span></span>  
  
-   <span data-ttu-id="5a0fe-140">Grupos de arquivos FILESTREAM podem estar em volumes compactados.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-140">FILESTREAM filegroups can be on compressed volumes.</span></span>  
  
### <a name="integrated-management"></a><span data-ttu-id="5a0fe-141">Gerenciamento integrado</span><span class="sxs-lookup"><span data-stu-id="5a0fe-141">Integrated Management</span></span>  
 <span data-ttu-id="5a0fe-142">Como o FILESTREAM é implementado como uma coluna `varbinary(max)` e integrado diretamente ao [!INCLUDE[ssDE](../../includes/ssde-md.md)], a maioria das funções e ferramentas de gerenciamento do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] funcionam sem nenhuma modificação para dados FILESTREAM.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-142">Because FILESTREAM is implemented as a `varbinary(max)` column and integrated directly into the [!INCLUDE[ssDE](../../includes/ssde-md.md)], most [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] management tools and functions work without modification for FILESTREAM data.</span></span> <span data-ttu-id="5a0fe-143">Por exemplo, é possível usar todos os modelos de backup e recuperação com dados FILESTREAM e o backup dos dados FILESTREAM pode ser feito com os dados estruturados no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-143">For example, you can use all backup and recovery models with FILESTREAM data, and the FILESTREAM data is backed up with the structured data in the database.</span></span> <span data-ttu-id="5a0fe-144">Se você não desejar fazer backup de dados FILESTREAM com dados relacionais, poderá usar um backup parcial para excluir grupos de arquivos FILESTREAM.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-144">If you do not want to back up FILESTREAM data with relational data, you can use a partial backup to exclude FILESTREAM filegroups.</span></span>  

  
### <a name="integrated-security"></a><span data-ttu-id="5a0fe-145">Segurança Integrada</span><span class="sxs-lookup"><span data-stu-id="5a0fe-145">Integrated Security</span></span>  
 <span data-ttu-id="5a0fe-146">No [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], os dados FILESTREAM são protegidos exatamente como outros dados, com a concessão de permissões em níveis de tabela ou coluna.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-146">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], FILESTREAM data is secured just like other data is secured: by granting permissions at the table or column levels.</span></span> <span data-ttu-id="5a0fe-147">Se um usuário tiver permissão para a coluna FILESTREAM em uma tabela, ele poderá abrir os arquivos associados.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-147">If a user has permission to the FILESTREAM column in a table, the user can open the associated files.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="5a0fe-148">Não há suporte para criptografia em dados FILESTREAM.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-148">Encryption is not supported on FILESTREAM data.</span></span>  
  
 <span data-ttu-id="5a0fe-149">Apenas a conta sob a qual a conta de serviço do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] é executada recebe permissões NTFS para o contêiner FILESTREAM.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-149">Only the account under which the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] service account runs is granted NTFS permissions to the FILESTREAM container.</span></span> <span data-ttu-id="5a0fe-150">É recomendável que nenhuma outra conta receba permissões no contêiner de dados.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-150">We recommend that no other account be granted permissions on the data container.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="5a0fe-151">Os logons do SQL não funcionarão com contêineres FILESTREAM.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-151">SQL logins will not work with FILESTREAM containers.</span></span> <span data-ttu-id="5a0fe-152">Somente a autenticação NTFS funcionará com contêineres FILESTREAM.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-152">Only NTFS authentication will work with FILESTREAM containers.</span></span>  
  
##  <a name="accessing-blob-data-with-transact-sql-and-file-system-streaming-access"></a><a name="dual"></a> <span data-ttu-id="5a0fe-153">Acessando dados BLOB com o Transact-SQL e o acesso a streaming do sistema de arquivos</span><span class="sxs-lookup"><span data-stu-id="5a0fe-153">Accessing BLOB Data with Transact-SQL and File System Streaming Access</span></span>  
 <span data-ttu-id="5a0fe-154">Depois de armazenar dados em uma coluna FILESTREAM, você pode acessar os arquivos usando transações [!INCLUDE[tsql](../../includes/tsql-md.md)] ou usando APIs do Win32.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-154">After you store data in a FILESTREAM column, you can access the files by using [!INCLUDE[tsql](../../includes/tsql-md.md)] transactions or by using Win32 APIs.</span></span>  
  
### <a name="transact-sql-access"></a><span data-ttu-id="5a0fe-155">Acesso ao Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="5a0fe-155">Transact-SQL Access</span></span>  
 <span data-ttu-id="5a0fe-156">Usando [!INCLUDE[tsql](../../includes/tsql-md.md)], é possível inserir, atualizar e excluir dados FILESTREAM:</span><span class="sxs-lookup"><span data-stu-id="5a0fe-156">By using [!INCLUDE[tsql](../../includes/tsql-md.md)], you can insert, update, and delete FILESTREAM data:</span></span>  
  
-   <span data-ttu-id="5a0fe-157">Você pode usar uma operação de inserção para pré-popular um campo FILESTREAM com um valor nulo, vazio ou com dados embutidos relativamente curtos.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-157">You can use an insert operation to prepopulate a FILESTREAM field with a null value, empty value, or relatively short inline data.</span></span> <span data-ttu-id="5a0fe-158">No entanto uma quantidade grande de dados é transmitida de maneira mais eficiente em um arquivo que usa interfaces Win32.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-158">However, a large amount of data is more efficiently streamed into a file that uses Win32 interfaces.</span></span>  
  
-   <span data-ttu-id="5a0fe-159">Ao atualizar um campo FILESTREAM, você modifica os dados BLOB subjacentes no sistema de arquivos.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-159">When you update a FILESTREAM field, you modify the underlying BLOB data in the file system.</span></span> <span data-ttu-id="5a0fe-160">Quando um campo FILESTREAM é definido como NULL, os dados BLOB associados ao campo são excluídos.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-160">When a FILESTREAM field is set to NULL, the BLOB data associated with the field is deleted.</span></span> <span data-ttu-id="5a0fe-161">Não é possível usar uma atualização de [!INCLUDE[tsql](../../includes/tsql-md.md)] em bloco, implementada como UPDATE **.** Write(), para executar atualizações parciais nos dados.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-161">You cannot use a [!INCLUDE[tsql](../../includes/tsql-md.md)] chunked update, implemented as UPDATE **.** Write(), to perform partial updates to the data.</span></span>  
  
-   <span data-ttu-id="5a0fe-162">Ao excluir uma linha ou ao excluir ou truncar uma tabela que contém dados FILESTREAM, você também exclui os dados BLOB subjacentes do sistema de arquivos.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-162">When you delete a row or delete or truncate a table that contains FILESTREAM data, you delete the underlying BLOB data in the file system.</span></span>  
  
### <a name="file-system-streaming-access"></a><span data-ttu-id="5a0fe-163">Acesso a streaming do sistema de arquivos</span><span class="sxs-lookup"><span data-stu-id="5a0fe-163">File System Streaming Access</span></span>  
 <span data-ttu-id="5a0fe-164">O suporte a streaming do Win32 funciona no contexto de uma transação do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="5a0fe-164">The Win32 streaming support works in the context of a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] transaction.</span></span> <span data-ttu-id="5a0fe-165">Dentro de uma transação, é possível usar funções FILESTREAM para obter um caminho do sistema de arquivos UNC lógico de um arquivo.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-165">Within a transaction, you can use FILESTREAM functions to obtain a logical UNC file system path of a file.</span></span> <span data-ttu-id="5a0fe-166">Em seguida, use a API OpenSqlFilestream para obter um identificador de arquivo.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-166">You then use the OpenSqlFilestream API to obtain a file handle.</span></span> <span data-ttu-id="5a0fe-167">Esse identificador pode então ser usado por interfaces de streaming de arquivo do Win32, como ReadFile() e WriteFile(), para acessar e atualizar o arquivo por meio do sistema de arquivos.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-167">This handle can then be used by Win32 file streaming interfaces, such as ReadFile() and WriteFile(), to access and update the file by way of the file system.</span></span>  
  
 <span data-ttu-id="5a0fe-168">Como as operações de arquivo são transacionais, não é possível excluir ou renomear arquivos FILESTREAM por meio do sistema de arquivos.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-168">Because file operations are transactional, you cannot delete or rename FILESTREAM files through the file system.</span></span>  
  
 <span data-ttu-id="5a0fe-169">**Modelo de instrução**</span><span class="sxs-lookup"><span data-stu-id="5a0fe-169">**Statement Model**</span></span>  
  
 <span data-ttu-id="5a0fe-170">O acesso ao sistema de arquivos FILESTREAM modela uma instrução [!INCLUDE[tsql](../../includes/tsql-md.md)] usando abertura e fechamento de arquivo.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-170">The FILESTREAM file system access models a [!INCLUDE[tsql](../../includes/tsql-md.md)] statement by using file open and close.</span></span> <span data-ttu-id="5a0fe-171">A instrução inicia quando um identificador de arquivo é aberto e termina quando o identificador é fechado.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-171">The statement starts when a file handle is opened and ends when the handle is closed.</span></span> <span data-ttu-id="5a0fe-172">Por exemplo, quando um identificador de gravação é fechado, qualquer gatilho AFTER que esteja registrado na tabela será acionado como se uma instrução UPDATE fosse concluída.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-172">For example, when a write handle is closed, any possible AFTER trigger that is registered on the table fires as if an UPDATE statement is completed.</span></span>  
  
 <span data-ttu-id="5a0fe-173">**Namespace de armazenamento**</span><span class="sxs-lookup"><span data-stu-id="5a0fe-173">**Storage Namespace**</span></span>  
  
 <span data-ttu-id="5a0fe-174">No FILESTREAM, o [!INCLUDE[ssDE](../../includes/ssde-md.md)] controla o namespace do sistema de arquivos físico do BLOB.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-174">In FILESTREAM, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] controls the BLOB physical file system namespace.</span></span> <span data-ttu-id="5a0fe-175">Uma nova função intrínseca, [PathName](/sql/relational-databases/system-functions/pathname-transact-sql), fornece o caminho UNC lógico do BLOB que corresponde a cada célula FILESTREAM na tabela.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-175">A new intrinsic function, [PathName](/sql/relational-databases/system-functions/pathname-transact-sql), provides the logical UNC path of the BLOB that corresponds to each FILESTREAM cell in the table.</span></span> <span data-ttu-id="5a0fe-176">O aplicativo usa esse caminho lógico para obter o identificador do Win32 e operar nos dados BLOB usando interfaces normais de sistema de arquivos do Win32.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-176">The application uses this logical path to obtain the Win32 handle and operate on the BLOB data by using regular Win32 file system interfaces.</span></span> <span data-ttu-id="5a0fe-177">A função retornará NULL se o valor da coluna FILESTREAM for NULL.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-177">The function returns NULL if the value of the FILESTREAM column is NULL.</span></span>  
  
 <span data-ttu-id="5a0fe-178">**Acesso a sistema de arquivos transacionado**</span><span class="sxs-lookup"><span data-stu-id="5a0fe-178">**Transacted File System Access**</span></span>  
  
 <span data-ttu-id="5a0fe-179">Uma nova função intrínseca, [GET_FILESTREAM_TRANSACTION_CONTEXT()](/sql/t-sql/functions/get-filestream-transaction-context-transact-sql), fornece o token que representa a transação atual à qual a sessão está associada.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-179">A new intrinsic function, [GET_FILESTREAM_TRANSACTION_CONTEXT()](/sql/t-sql/functions/get-filestream-transaction-context-transact-sql), provides the token that represents the current transaction that the session is associated with.</span></span> <span data-ttu-id="5a0fe-180">A transação deve ter sido iniciada e ainda não anulada ou confirmada.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-180">The transaction must have been started and not yet aborted or committed.</span></span> <span data-ttu-id="5a0fe-181">Obtendo um token, o aplicativo associa as operações de streaming do sistema de arquivos FILESTREAM a uma transação iniciada.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-181">By obtaining a token, the application binds the FILESTREAM file system streaming operations with a started transaction.</span></span> <span data-ttu-id="5a0fe-182">A função retorna NULL no caso de nenhuma transação explicitamente iniciada.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-182">The function returns NULL in case of no explicitly started transaction.</span></span>  
  
 <span data-ttu-id="5a0fe-183">Todos os identificadores de arquivo devem ser fechados antes de a transação ser confirmada ou anulada.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-183">All file handles must be closed before the transaction commits or aborts.</span></span> <span data-ttu-id="5a0fe-184">Se um identificador for deixado aberto além do escopo da transação, leituras adicionais em relação ao identificador provocarão uma falha. Gravações adicionais em relação ao identificador serão bem-sucedidas, mas os dados reais não serão gravados em disco.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-184">If a handle is left open beyond the transaction scope, additional reads against the handle will cause a failure; additional writes against the handle will succeed, but the actual data will not be written to disk.</span></span> <span data-ttu-id="5a0fe-185">De maneira semelhante, se o banco de dados ou a instância do [!INCLUDE[ssDE](../../includes/ssde-md.md)] for desligado, todos os identificadores abertos serão invalidados.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-185">Similarly, if the database or instance of the [!INCLUDE[ssDE](../../includes/ssde-md.md)] shuts down, all open handles are invalidated.</span></span>  
  
 <span data-ttu-id="5a0fe-186">**Durabilidade transacional**</span><span class="sxs-lookup"><span data-stu-id="5a0fe-186">**Transactional Durability**</span></span>  
  
 <span data-ttu-id="5a0fe-187">Com FILESTREAM, na confirmação da transação, o [!INCLUDE[ssDE](../../includes/ssde-md.md)] verifica a durabilidade da transação de dados BLOB FILESTREAM que são modificados no acesso de streaming ao sistema de arquivos.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-187">With FILESTREAM, upon transaction commit, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] ensures transaction durability for FILESTREAM BLOB data that is modified from the file system streaming access.</span></span>  
  
 <span data-ttu-id="5a0fe-188">**Semântica de isolamento**</span><span class="sxs-lookup"><span data-stu-id="5a0fe-188">**Isolation Semantics**</span></span>  
  
 <span data-ttu-id="5a0fe-189">A semântica de isolamento é governada pelos níveis de isolamento da transação do [!INCLUDE[ssDE](../../includes/ssde-md.md)].</span><span class="sxs-lookup"><span data-stu-id="5a0fe-189">The isolation semantics are governed by [!INCLUDE[ssDE](../../includes/ssde-md.md)] transaction isolation levels.</span></span> <span data-ttu-id="5a0fe-190">O nível de isolamento confirmado por leitura tem suporte para [!INCLUDE[tsql](../../includes/tsql-md.md)] e acesso ao sistema de arquivos.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-190">Read-committed isolation level is supported for [!INCLUDE[tsql](../../includes/tsql-md.md)] and file system access.</span></span> <span data-ttu-id="5a0fe-191">As operações de leitura repetidas, assim como os isolamentos de instantâneo e serializáveis, têm suporte.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-191">Repeatable read operations, and also serializable and snapshot isolations, are supported.</span></span> <span data-ttu-id="5a0fe-192">Não há suporte para leitura suja.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-192">Dirty read is not supported.</span></span>  
  
 <span data-ttu-id="5a0fe-193">As operações de abertura de acesso ao sistema de arquivos não aguardam nenhum bloqueio.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-193">The file system access open operations do not wait for any locks.</span></span> <span data-ttu-id="5a0fe-194">Em vez disso, as operações de abertura falham imediatamente caso não possam acessar os dados por causa do isolamento da transação.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-194">Instead, the open operations fail immediately if they cannot access the data because of transaction isolation.</span></span> <span data-ttu-id="5a0fe-195">As chamadas da API de streaming falharão com ERROR_SHARING_VIOLATION se a operação de abertura não puder continuar por causa de violação de isolamento.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-195">The streaming API calls fail with ERROR_SHARING_VIOLATION if the open operation cannot continue because of isolation violation.</span></span>  
  
 <span data-ttu-id="5a0fe-196">Para permitir a realização de atualizações parciais, o aplicativo pode emitir um controle de FS de dispositivo (FSCTL_SQL_FILESTREAM_FETCH_OLD_CONTENT) para buscar o conteúdo antigo no arquivo ao qual o identificador aberto faz referência.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-196">To allow for partial updates to be made, the application can issue a device FS control (FSCTL_SQL_FILESTREAM_FETCH_OLD_CONTENT) to fetch the old content into the file that the opened handle references.</span></span> <span data-ttu-id="5a0fe-197">Isso acionará uma cópia de conteúdo antigo no lado do servidor.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-197">This will trigger a server-side old content copy.</span></span> <span data-ttu-id="5a0fe-198">Para obter melhor desempenho do aplicativo e evitar a ocorrência de tempos limites potenciais ao trabalhar com arquivos muito grandes, recomendamos usar E/S assíncrona.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-198">For better application performance and to avoid running into potential time-outs when you are working with very large files, we recommend that you use asynchronous I/O.</span></span>  
  
 <span data-ttu-id="5a0fe-199">Se o FSCTL for emitido após o identificador ter sido gravado, a última operação de gravação persistirá e as gravações anteriores feitas no identificador serão perdidas.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-199">If the FSCTL is issued after the handle has been written to, the last write operation will persist, and prior writes that were made to the handle are lost.</span></span>  
  
 <span data-ttu-id="5a0fe-200">**APIs do sistema de arquivos e níveis de isolamento com suporte**</span><span class="sxs-lookup"><span data-stu-id="5a0fe-200">**File System APIs and Supported Isolation Levels**</span></span>  
  
 <span data-ttu-id="5a0fe-201">Quando uma API do sistema de arquivos não pode abrir um arquivo devido a uma violação de isolamento, uma exceção ERROR_SHARING_VIOLATION é retornada.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-201">When a file system API cannot open a file because of an isolation violation, an ERROR_SHARING_VIOLATION exception is returned.</span></span> <span data-ttu-id="5a0fe-202">Essa violação de isolamento ocorre quando duas transações tentam acessar o mesmo arquivo.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-202">This isolation violation occurs when two transactions try to access the same file.</span></span> <span data-ttu-id="5a0fe-203">O resultado da operação de acesso depende do modo no qual o arquivo foi aberto e da versão do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] na qual a transação está sendo executada.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-203">The outcome of the access operation depends on the mode the file was opened in and the version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] that the transaction is running on.</span></span> <span data-ttu-id="5a0fe-204">A tabela a seguir descreve os possíveis resultados para duas transações que estão acessando o mesmo arquivo.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-204">The following table outlines the possibly outcomes for two transactions that are accessing the same file.</span></span>  
  
|<span data-ttu-id="5a0fe-205">Transação 1</span><span class="sxs-lookup"><span data-stu-id="5a0fe-205">Transaction 1</span></span>|<span data-ttu-id="5a0fe-206">Transação 2</span><span class="sxs-lookup"><span data-stu-id="5a0fe-206">Transaction 2</span></span>|<span data-ttu-id="5a0fe-207">Resultado no SQL Server 2008</span><span class="sxs-lookup"><span data-stu-id="5a0fe-207">Outcome on SQL Server 2008</span></span>|<span data-ttu-id="5a0fe-208">Resultado no SQL Server 2008 R2 e em versões posteriores</span><span class="sxs-lookup"><span data-stu-id="5a0fe-208">Outcome on SQL Server 2008 R2 and later versions</span></span>|  
|-------------------|-------------------|--------------------------------|------------------------------------------------------|  
|<span data-ttu-id="5a0fe-209">Abrir para leitura.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-209">Open for read.</span></span>|<span data-ttu-id="5a0fe-210">Abrir para leitura.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-210">Open for read.</span></span>|<span data-ttu-id="5a0fe-211">Ambas realizadas com êxito.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-211">Both succeed.</span></span>|<span data-ttu-id="5a0fe-212">Ambas realizadas com êxito.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-212">Both succeed.</span></span>|  
|<span data-ttu-id="5a0fe-213">Abrir para leitura.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-213">Open for read.</span></span>|<span data-ttu-id="5a0fe-214">Abrir para gravação.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-214">Open for write.</span></span>|<span data-ttu-id="5a0fe-215">Ambas realizadas com êxito.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-215">Both succeed.</span></span> <span data-ttu-id="5a0fe-216">As operações de gravação na transação 2 não afetam as operações de leitura executadas na transação 1.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-216">Write operations under transaction 2 do not affect read operations performed in transaction 1.</span></span>|<span data-ttu-id="5a0fe-217">Ambas realizadas com êxito.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-217">Both succeed.</span></span> <span data-ttu-id="5a0fe-218">As operações de gravação na transação 2 não afetam as operações de leitura executadas na transação 1.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-218">Write operations under transaction 2 do not affect read operations performed in transaction 1.</span></span>|  
|<span data-ttu-id="5a0fe-219">Abrir para gravação.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-219">Open for write.</span></span>|<span data-ttu-id="5a0fe-220">Abrir para leitura.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-220">Open for read.</span></span>|<span data-ttu-id="5a0fe-221">A abertura da transação 2 falhará com uma exceção ERROR_SHARING_VIOLATION.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-221">Open for transaction 2 fails with an ERROR_SHARING_VIOLATION exception.</span></span>|<span data-ttu-id="5a0fe-222">Ambas realizadas com êxito.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-222">Both succeed.</span></span>|  
|<span data-ttu-id="5a0fe-223">Abrir para gravação.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-223">Open for write.</span></span>|<span data-ttu-id="5a0fe-224">Abrir para gravação.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-224">Open for write.</span></span>|<span data-ttu-id="5a0fe-225">A abertura da transação 2 falhará com uma exceção ERROR_SHARING_VIOLATION.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-225">Open for transaction 2 fails with an ERROR_SHARING_VIOLATION exception.</span></span>|<span data-ttu-id="5a0fe-226">A abertura da transação 2 falhará com uma exceção ERROR_SHARING_VIOLATION.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-226">Open for transaction 2 fails with an ERROR_SHARING_VIOLATION exception.</span></span>|  
|<span data-ttu-id="5a0fe-227">Abrir para leitura.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-227">Open for read.</span></span>|<span data-ttu-id="5a0fe-228">Abrir para SELECT.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-228">Open for SELECT.</span></span>|<span data-ttu-id="5a0fe-229">Ambas realizadas com êxito.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-229">Both succeed.</span></span>|<span data-ttu-id="5a0fe-230">Ambas realizadas com êxito.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-230">Both succeed.</span></span>|  
|<span data-ttu-id="5a0fe-231">Abrir para leitura.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-231">Open for read.</span></span>|<span data-ttu-id="5a0fe-232">Abrir para UPDATE ou DELETE.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-232">Open for UPDATE or DELETE.</span></span>|<span data-ttu-id="5a0fe-233">Ambas realizadas com êxito.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-233">Both succeed.</span></span> <span data-ttu-id="5a0fe-234">As operações de gravação na transação 2 não afetam as operações de leitura executadas na transação 1.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-234">Write operations under transaction 2 do not affect read operations performed in transaction 1.</span></span>|<span data-ttu-id="5a0fe-235">Ambas realizadas com êxito.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-235">Both succeed.</span></span> <span data-ttu-id="5a0fe-236">As operações de gravação na transação 2 não afetam as operações de leitura executadas na transação 1.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-236">Write operations under transaction 2 do not affect read operations performed in transaction 1.</span></span>|  
|<span data-ttu-id="5a0fe-237">Abrir para gravação.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-237">Open for write.</span></span>|<span data-ttu-id="5a0fe-238">Abrir para SELECT.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-238">open for SELECT.</span></span>|<span data-ttu-id="5a0fe-239">A transação 2 é bloqueada até a transação 1 confirmar ou finalizar a transação, ou o bloqueio da transação atingir o tempo limite.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-239">Transaction 2 blocks until transaction 1 commits or ends the transaction, or the transaction lock times out.</span></span>|<span data-ttu-id="5a0fe-240">Ambas realizadas com êxito.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-240">Both succeed.</span></span>|  
|<span data-ttu-id="5a0fe-241">Abrir para gravação.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-241">Open for write.</span></span>|<span data-ttu-id="5a0fe-242">Abrir para UPDATE ou DELETE.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-242">Open for UPDATE or DELETE.</span></span>|<span data-ttu-id="5a0fe-243">A transação 2 é bloqueada até a transação 1 confirmar ou finalizar a transação, ou o bloqueio da transação atingir o tempo limite.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-243">Transaction 2 blocks until transaction 1 commits or ends the transaction, or the transaction lock times out.</span></span>|<span data-ttu-id="5a0fe-244">A transação 2 é bloqueada até a transação 1 confirmar ou finalizar a transação, ou o bloqueio da transação atingir o tempo limite.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-244">Transaction 2 blocks until transaction 1 commits or ends the transaction, or the transaction lock times out.</span></span>|  
|<span data-ttu-id="5a0fe-245">Abrir para SELECT.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-245">Open for SELECT.</span></span>|<span data-ttu-id="5a0fe-246">Abrir para leitura.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-246">Open for read.</span></span>|<span data-ttu-id="5a0fe-247">Ambas realizadas com êxito.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-247">Both succeed.</span></span>|<span data-ttu-id="5a0fe-248">Ambas realizadas com êxito.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-248">Both succeed.</span></span>|  
|<span data-ttu-id="5a0fe-249">Abrir para SELECT.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-249">Open for SELECT.</span></span>|<span data-ttu-id="5a0fe-250">Abrir para gravação.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-250">Open for write.</span></span>|<span data-ttu-id="5a0fe-251">Ambas realizadas com êxito.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-251">Both succeed.</span></span> <span data-ttu-id="5a0fe-252">As operações de gravação na transação 2 não afetam a transação 1.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-252">Write operations under transaction 2 do not affect transaction 1.</span></span>|<span data-ttu-id="5a0fe-253">Ambas realizadas com êxito.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-253">Both succeed.</span></span> <span data-ttu-id="5a0fe-254">As operações de gravação na transação 2 não afetam a transação 1.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-254">Write operations under transaction 2 do not affect transaction 1.</span></span>|  
|<span data-ttu-id="5a0fe-255">Abrir para UPDATE ou DELETE.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-255">Open for UPDATE or DELETE.</span></span>|<span data-ttu-id="5a0fe-256">Abrir para leitura.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-256">Open for read.</span></span>|<span data-ttu-id="5a0fe-257">A operação de abertura da transação 2 falhará com uma exceção ERROR_SHARING_VIOLATION.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-257">The open operation on transaction 2 fails with an ERROR_SHARING_VIOLATION exception.</span></span>|<span data-ttu-id="5a0fe-258">Ambas realizadas com êxito.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-258">Both succeed.</span></span>|  
|<span data-ttu-id="5a0fe-259">Abrir para UPDATE ou DELETE.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-259">Open for UPDATE or DELETE.</span></span>|<span data-ttu-id="5a0fe-260">Abrir para gravação.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-260">Open for write.</span></span>|<span data-ttu-id="5a0fe-261">A operação de abertura da transação 2 falhará com uma exceção ERROR_SHARING_VIOLATION.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-261">The open operation on transaction 2 fails with an ERROR_SHARING_VIOLATION exception.</span></span>|<span data-ttu-id="5a0fe-262">A operação de abertura da transação 2 falhará com uma exceção ERROR_SHARING_VIOLATION.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-262">The open operation on transaction 2 fails with an ERROR_SHARING_VIOLATION exception.</span></span>|  
|<span data-ttu-id="5a0fe-263">Abra para SELECT com leitura repetida.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-263">Open for SELECT with repeatable read.</span></span>|<span data-ttu-id="5a0fe-264">Abrir para leitura.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-264">Open for read.</span></span>|<span data-ttu-id="5a0fe-265">Ambas realizadas com êxito.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-265">Both succeed.</span></span>|<span data-ttu-id="5a0fe-266">Ambas realizadas com êxito.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-266">Both succeed.</span></span>|  
|<span data-ttu-id="5a0fe-267">Abra para SELECT com leitura repetida.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-267">Open for SELECT with repeatable read.</span></span>|<span data-ttu-id="5a0fe-268">Abrir para gravação.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-268">Open for write.</span></span>|<span data-ttu-id="5a0fe-269">A operação de abertura da transação 2 falhará com uma exceção ERROR_SHARING_VIOLATION.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-269">The open operation on transaction 2 fails with an ERROR_SHARING_VIOLATION exception.</span></span>|<span data-ttu-id="5a0fe-270">A operação de abertura da transação 2 falhará com uma exceção ERROR_SHARING_VIOLATION.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-270">The open operation on transaction 2 fails with an ERROR_SHARING_VIOLATION exception.</span></span>|  
  
 <span data-ttu-id="5a0fe-271">**Gravação de clientes remotos**</span><span class="sxs-lookup"><span data-stu-id="5a0fe-271">**Write-Through from Remote Clients**</span></span>  
  
 <span data-ttu-id="5a0fe-272">O acesso do sistema de arquivos remoto a dados FILESTREAM é habilitado pelo protocolo SMB.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-272">Remote file system access to FILESTREAM data is enabled over the Server Message Block (SMB) protocol.</span></span> <span data-ttu-id="5a0fe-273">Se o cliente for remoto, nenhuma operação de gravação será armazenada em cache pelo lado do cliente.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-273">If the client is remote, no write operations are cached by the client side.</span></span> <span data-ttu-id="5a0fe-274">Os operações de gravação sempre serão enviados ao servidor.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-274">The write operations will always be sent to the server.</span></span> <span data-ttu-id="5a0fe-275">Os dados podem ser armazenados em cache no lado de servidor.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-275">The data can be cached on the server side.</span></span> <span data-ttu-id="5a0fe-276">Recomendamos que aplicativos que estão em execução em clientes remotos consolidem operações de gravação pequenas para fazer menos operações de gravação usando um tamanho maior de dados.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-276">We recommend that applications that are running on remote clients consolidate small write operations to make fewer write operations using larger data size.</span></span>  
  
 <span data-ttu-id="5a0fe-277">Não há suporte para a criação de exibições mapeadas de memória (E/S mapeada de memória) usando um identificador de FILESTREAM.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-277">Creating memory mapped views (memory mapped I/O) by using a FILESTREAM handle is not supported.</span></span> <span data-ttu-id="5a0fe-278">Se o mapeamento de memória for usado para dados FILESTREAM, o [!INCLUDE[ssDE](../../includes/ssde-md.md)] não poderá garantir consistência e durabilidade dos dados ou integridade do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5a0fe-278">If memory mapping is used for FILESTREAM data, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] cannot guarantee consistency and durability of the data or the integrity of the database.</span></span>  
  
##  <a name="related-tasks"></a><a name="reltasks"></a> <span data-ttu-id="5a0fe-279">Tarefas relacionadas</span><span class="sxs-lookup"><span data-stu-id="5a0fe-279">Related Tasks</span></span>  
 [<span data-ttu-id="5a0fe-280">Habilitar e configurar o FILESTREAM</span><span class="sxs-lookup"><span data-stu-id="5a0fe-280">Enable and Configure FILESTREAM</span></span>](enable-and-configure-filestream.md)  
  [<span data-ttu-id="5a0fe-281">Criar um banco de dados habilitado para FILESTREAM</span><span class="sxs-lookup"><span data-stu-id="5a0fe-281">Create a FILESTREAM-Enabled Database</span></span>](create-a-filestream-enabled-database.md)  
  [<span data-ttu-id="5a0fe-282">Criar uma tabela para armazenar dados FILESTREAM</span><span class="sxs-lookup"><span data-stu-id="5a0fe-282">Create a Table for Storing FILESTREAM Data</span></span>](create-a-table-for-storing-filestream-data.md)  
  [<span data-ttu-id="5a0fe-283">Acessar dados FILESTREAM com Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="5a0fe-283">Access FILESTREAM Data with Transact-SQL</span></span>](access-filestream-data-with-transact-sql.md)  
  [<span data-ttu-id="5a0fe-284">Criar aplicativos clientes para dados FILESTREAM</span><span class="sxs-lookup"><span data-stu-id="5a0fe-284">Create Client Applications for FILESTREAM Data</span></span>](create-client-applications-for-filestream-data.md)  
  [<span data-ttu-id="5a0fe-285">Acessar dados do FILESTREAM com OpenSqlFilestream</span><span class="sxs-lookup"><span data-stu-id="5a0fe-285">Access FILESTREAM Data with OpenSqlFilestream</span></span>](access-filestream-data-with-opensqlfilestream.md)  
  [<span data-ttu-id="5a0fe-286">Fazer atualizações parciais em dados do FILESTREAM</span><span class="sxs-lookup"><span data-stu-id="5a0fe-286">Make Partial Updates to FILESTREAM Data</span></span>](make-partial-updates-to-filestream-data.md)  
  [<span data-ttu-id="5a0fe-287">Evitar conflitos com operações de banco de dados em aplicativos de FILESTREAM</span><span class="sxs-lookup"><span data-stu-id="5a0fe-287">Avoid Conflicts with Database Operations in FILESTREAM Applications</span></span>](avoid-conflicts-with-database-operations-in-filestream-applications.md)  
  [<span data-ttu-id="5a0fe-288">Mover um banco de dados habilitado para FILESTREAM</span><span class="sxs-lookup"><span data-stu-id="5a0fe-288">Move a FILESTREAM-Enabled Database</span></span>](move-a-filestream-enabled-database.md)  
  [<span data-ttu-id="5a0fe-289">Configurar FILESTREAM em um cluster de failover</span><span class="sxs-lookup"><span data-stu-id="5a0fe-289">Set Up FILESTREAM on a Failover Cluster</span></span>](set-up-filestream-on-a-failover-cluster.md)  
  [<span data-ttu-id="5a0fe-290">Configurar um firewall para acesso ao FILESTREAM</span><span class="sxs-lookup"><span data-stu-id="5a0fe-290">Configure a Firewall for FILESTREAM Access</span></span>](configure-a-firewall-for-filestream-access.md)  
  
##  <a name="related-content"></a><a name="relcontent"></a> <span data-ttu-id="5a0fe-291">Conteúdo relacionado</span><span class="sxs-lookup"><span data-stu-id="5a0fe-291">Related Content</span></span>  
 [<span data-ttu-id="5a0fe-292">Compatibilidade do FILESTREAM com outros recursos do SQL Server</span><span class="sxs-lookup"><span data-stu-id="5a0fe-292">FILESTREAM Compatibility with Other SQL Server Features</span></span>](filestream-compatibility-with-other-sql-server-features.md)  
  
