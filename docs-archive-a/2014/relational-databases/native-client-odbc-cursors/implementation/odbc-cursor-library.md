---
title: Biblioteca de cursores ODBC | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- cursors [ODBC], library
- SQL_CUR_USE_DRIVER option
- ODBC applications, cursors
- ODBC cursors, library
- SQL_CUR_USE_IF_NEEDED option
- SQLSetConnectAttr function
- SQL_CUR_USE_ODBC option
ms.assetid: 3c610d3d-6e06-49cf-9a40-05b6a1c83a32
author: rothja
ms.author: jroth
ms.openlocfilehash: b0f0ad049c6b9e77f9888d582ab0cda2f5a5e0f7
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87572071"
---
# <a name="odbc-cursor-library"></a><span data-ttu-id="93787-102">Biblioteca de cursores ODBC</span><span class="sxs-lookup"><span data-stu-id="93787-102">ODBC Cursor Library</span></span>
  <span data-ttu-id="93787-103">Alguns drivers ODBC dão suporte apenas às configurações de cursor padrão; esses drivers também não dão suporte a operações de cursor posicionadas, como **SQLSetPos**.</span><span class="sxs-lookup"><span data-stu-id="93787-103">Some ODBC drivers only support the default cursor settings; these drivers also do not support positioned cursor operations, such as **SQLSetPos**.</span></span> <span data-ttu-id="93787-104">A biblioteca de cursores ODBC é um componente do MDAC (Microsoft Data Access Components) usado para implementar cursores estáticos ou em bloco em um driver que, normalmente, não dá suporte a eles.</span><span class="sxs-lookup"><span data-stu-id="93787-104">The ODBC cursor library is a component of the Microsoft Data Access Components (MDAC) used to implement block or static cursors on a driver that normally does not support them.</span></span> <span data-ttu-id="93787-105">A biblioteca de cursores também implementa instruções UPDATE e DELETE posicionadas e **SQLSetPos** para os cursores que ele cria.</span><span class="sxs-lookup"><span data-stu-id="93787-105">The cursor library also implements positioned UPDATE and DELETE statements and **SQLSetPos** for the cursors it creates.</span></span>  
  
 <span data-ttu-id="93787-106">A biblioteca de cursores ODBC é implementada como uma camada entre o Gerenciador de Driver ODBC e um driver ODBC.</span><span class="sxs-lookup"><span data-stu-id="93787-106">The ODBC cursor library is implemented as a layer between the ODBC Driver Manager and an ODBC driver.</span></span> <span data-ttu-id="93787-107">Se a biblioteca de cursores ODBC for carregada, o Gerenciador de Driver ODBC roteará todos os comandos relacionados com o cursor à biblioteca em vez do driver.</span><span class="sxs-lookup"><span data-stu-id="93787-107">If the ODBC cursor library is loaded, the ODBC Driver Manager routes all cursor-related commands to the cursor library instead of the driver.</span></span> <span data-ttu-id="93787-108">A biblioteca de cursores implementa um cursor buscando o conjunto de resultados inteiro do driver subjacente e armazenando em cache o conjunto de resultados no cliente.</span><span class="sxs-lookup"><span data-stu-id="93787-108">The cursor library implements a cursor by fetching the entire result set from the underlying driver and caching the result set on the client.</span></span> <span data-ttu-id="93787-109">Ao usar a biblioteca de cursores ODBC, o aplicativo fica limitado à funcionalidade da biblioteca; qualquer suporte adicional a outras funcionalidades de cursor no driver subjacente não estará disponível para o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="93787-109">When using the ODBC cursor library, the application is limited to the cursor functionality of the cursor library; any support for additional cursor functionality in the underlying driver is not available to the application.</span></span>  
  
 <span data-ttu-id="93787-110">Não há muita necessidade de usar a biblioteca de cursores ODBC com o driver ODBC do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client porque o próprio driver dá suporte a mais funcionalidades de cursor do que a biblioteca.</span><span class="sxs-lookup"><span data-stu-id="93787-110">There is little need to use the ODBC cursor library with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver because the driver itself supports more cursor functionality than the ODBC cursor library.</span></span> <span data-ttu-id="93787-111">O único motivo para usar a biblioteca de cursores ODBC com o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] driver ODBC do Native Client é porque o Driver implementa seu suporte ao cursor por meio de cursores do servidor, e os cursores do servidor não dão suporte a todas as instruções SQL.</span><span class="sxs-lookup"><span data-stu-id="93787-111">The only reason to use the ODBC cursor library with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver is because the driver implements its cursor support through server cursors, and server cursors do not support all SQL statements.</span></span> <span data-ttu-id="93787-112">Sempre que houver necessidade de ter um cursor estático com procedimentos armazenados, lotes ou instruções SQL que contêm COMPUTE, COMPUTE BY, FOR BROWSE ou INTO, é recomendável usar a biblioteca de cursores ODBC.</span><span class="sxs-lookup"><span data-stu-id="93787-112">Any time there is a need to have a static cursor with stored procedures, batches, or SQL statements containing COMPUTE, COMPUTE BY, FOR BROWSE, or INTO, consider using the ODBC cursor library.</span></span> <span data-ttu-id="93787-113">No entanto, é preciso ter cuidado ao usar a biblioteca de cursores porque ela armazena no cache do cliente o conjunto de resultados inteiro, o que pode alocar muita memória e prejudicar o desempenho.</span><span class="sxs-lookup"><span data-stu-id="93787-113">However, care must be used with the cursor library because it caches the entire result set on the client, which can use large amounts of memory and slow performance.</span></span>  
  
 <span data-ttu-id="93787-114">Um aplicativo invoca a biblioteca de cursores em uma base de conexão por conexão usando [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) para definir o atributo de conexão SQL_ATTR_ODBC_CURSORS antes de se conectar a uma fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="93787-114">An application invokes the cursor library on a connection-by-connection basis by using [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) to set the SQL_ATTR_ODBC_CURSORS connection attribute before connecting to a data source.</span></span> <span data-ttu-id="93787-115">SQL_ATTR_ODBC_CURSORS é definido como um destes três valores:</span><span class="sxs-lookup"><span data-stu-id="93787-115">SQL_ATTR_ODBC_CURSORS is set to one of three values:</span></span>  
  
 <span data-ttu-id="93787-116">SQL_CUR_USE_ODBC</span><span class="sxs-lookup"><span data-stu-id="93787-116">SQL_CUR_USE_ODBC</span></span>  
 <span data-ttu-id="93787-117">Quando essa opção é definida com o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] driver ODBC do Native Client, a biblioteca de cursores ODBC substitui o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] suporte ao cursor nativo do driver ODBC do Native Client.</span><span class="sxs-lookup"><span data-stu-id="93787-117">When this option is set with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver, the ODBC cursor library overrides the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver's native cursor support.</span></span> <span data-ttu-id="93787-118">Somente os tipos de cursor suportados pela biblioteca de cursores podem ser usados para a conexão; cursores de servidor não podem ser usados.</span><span class="sxs-lookup"><span data-stu-id="93787-118">Only the cursor types supported by the cursor library can be used for the connection; server cursors cannot be used.</span></span>  
  
 <span data-ttu-id="93787-119">SQL_CUR_USE_DRIVER</span><span class="sxs-lookup"><span data-stu-id="93787-119">SQL_CUR_USE_DRIVER</span></span>  
 <span data-ttu-id="93787-120">Quando essa opção é definida, todo o suporte a cursor nativo para o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] driver ODBC do Native Client pode ser usado para a conexão.</span><span class="sxs-lookup"><span data-stu-id="93787-120">When this option is set, all of the cursor support native to the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver can be used for the connection.</span></span> <span data-ttu-id="93787-121">A biblioteca de cursores ODBC não pode ser usada.</span><span class="sxs-lookup"><span data-stu-id="93787-121">The ODBC cursor library cannot be used.</span></span> <span data-ttu-id="93787-122">Todos os cursores são implementados como cursores de servidor.</span><span class="sxs-lookup"><span data-stu-id="93787-122">All cursors are implemented as server cursors.</span></span>  
  
 <span data-ttu-id="93787-123">SQL_CUR_USE_IF_NEEDED</span><span class="sxs-lookup"><span data-stu-id="93787-123">SQL_CUR_USE_IF_NEEDED</span></span>  
 <span data-ttu-id="93787-124">Quando essa opção é definida, o efeito é o mesmo que SQL_CUR_USE_DRIVER quando usado com o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] driver ODBC do Native Client.</span><span class="sxs-lookup"><span data-stu-id="93787-124">When this option is set, the effect is the same as SQL_CUR_USE_DRIVER when used with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver.</span></span> <span data-ttu-id="93787-125">No momento do Connect, o Gerenciador de driver ODBC testa para ver se o driver ODBC que está sendo conectado oferece suporte à opção SQL_FETCH_PRIOR de [SQLFetchScroll](../../native-client-odbc-api/sqlfetchscroll.md).</span><span class="sxs-lookup"><span data-stu-id="93787-125">At connect time, the ODBC Driver Manager tests to see if the ODBC driver being connected to supports the SQL_FETCH_PRIOR option of [SQLFetchScroll](../../native-client-odbc-api/sqlfetchscroll.md).</span></span> <span data-ttu-id="93787-126">Se o driver não der suporte à opção, o Gerenciador de Driver ODBC carregará a biblioteca de cursores ODBC.</span><span class="sxs-lookup"><span data-stu-id="93787-126">If the driver does not support the option, the ODBC Driver Manager loads the ODBC cursor library.</span></span> <span data-ttu-id="93787-127">Se o driver der suporte à opção, o Gerenciador não carregará a biblioteca de cursores ODBC e o aplicativo usará o suporte nativo do driver.</span><span class="sxs-lookup"><span data-stu-id="93787-127">If the driver does support the option, the ODBC Driver Manager does not load the ODBC cursor library and the application uses the native support of the driver.</span></span> <span data-ttu-id="93787-128">Como o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] driver ODBC do Native Client dá suporte a SQL_FETCH_PRIOR, o Gerenciador de driver ODBC não carrega a biblioteca de cursores ODBC.</span><span class="sxs-lookup"><span data-stu-id="93787-128">Because the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver supports SQL_FETCH_PRIOR, the ODBC Driver Manager does not load the ODBC cursor library.</span></span>  
  
 <span data-ttu-id="93787-129">A biblioteca de cursores permite que os aplicativos usem várias instruções ativas em uma conexão, assim como cursores roláveis e atualizáveis.</span><span class="sxs-lookup"><span data-stu-id="93787-129">The cursor library allows applications to use multiple active statements on a connection, as well as scrollable, updatable cursors.</span></span> <span data-ttu-id="93787-130">A biblioteca de cursores deve ser carregada para dar suporte a essa funcionalidade.</span><span class="sxs-lookup"><span data-stu-id="93787-130">The cursor library must be loaded to support this functionality.</span></span> <span data-ttu-id="93787-131">Use [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) para especificar como a biblioteca de cursores deve ser usada e [SQLSetStmtAttr](../../native-client-odbc-api/sqlsetstmtattr.md) para especificar o tipo de cursor, a simultaneidade e o tamanho do conjunto de linhas.</span><span class="sxs-lookup"><span data-stu-id="93787-131">Use [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) to specify how the cursor library should be used and [SQLSetStmtAttr](../../native-client-odbc-api/sqlsetstmtattr.md) to specify the cursor type, concurrency, and rowset size.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="93787-132">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="93787-132">See Also</span></span>  
 [<span data-ttu-id="93787-133">Como os cursores são implementados</span><span class="sxs-lookup"><span data-stu-id="93787-133">How Cursors Are Implemented</span></span>](how-cursors-are-implemented.md)  
  
  
