---
title: Servidores vinculados (Mecanismo de Banco de Dados) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
helpviewer_keywords:
- OLE DB, linked servers
- OLE DB provider, linked servers
- server management [SQL Server], linked servers
- linked servers [SQL Server]
- distributed queries [SQL Server], linked servers
- servers [SQL Server], linked
- remote servers [SQL Server], linked servers
- linked servers [SQL Server], about linked servers
ms.assetid: 6ef578bf-8da7-46e0-88b5-e310fc908bb0
author: stevestein
ms.author: sstein
ms.openlocfilehash: 4a1de70882cdeb87ccc0ae42aa23a9b6c8b3248e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87569440"
---
# <a name="linked-servers-database-engine"></a><span data-ttu-id="939ec-102">Servidores vinculados (Mecanismo de Banco de Dados)</span><span class="sxs-lookup"><span data-stu-id="939ec-102">Linked Servers (Database Engine)</span></span>
  <span data-ttu-id="939ec-103">Configure um servidor vinculado para permitir que o [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] execute comandos em fontes de dados do OLE DB fora da instância do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="939ec-103">Configure a linked server to enable the [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] to execute commands against OLE DB data sources outside of the instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="939ec-104">Normalmente, servidores vinculados são configurados para habilitar o [!INCLUDE[ssDE](../../includes/ssde-md.md)] a executar uma instrução [!INCLUDE[tsql](../../includes/tsql-md.md)] que inclui tabelas em outra instância do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]ou outro produto de banco de dados como Oracle.</span><span class="sxs-lookup"><span data-stu-id="939ec-104">Typically linked servers are configured to enable the [!INCLUDE[ssDE](../../includes/ssde-md.md)] to execute a [!INCLUDE[tsql](../../includes/tsql-md.md)] statement that includes tables in another instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], or another database product such as Oracle.</span></span> <span data-ttu-id="939ec-105">Muitos tipos de fontes de dados do OLE DB podem ser configurados, como servidores vinculados, inclusive o Access e o Excel do [!INCLUDE[msCoName](../../../includes/msconame-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="939ec-105">Many types OLE DB data sources can be configured as linked servers, including [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Access and Excel.</span></span> <span data-ttu-id="939ec-106">Servidores vinculados têm as seguintes vantagens:</span><span class="sxs-lookup"><span data-stu-id="939ec-106">Linked servers offer the following advantages:</span></span>

-   <span data-ttu-id="939ec-107">A capacidade de acessar dados de fora do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="939ec-107">The ability to access data from outside of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>

-   <span data-ttu-id="939ec-108">A capacidade de emitir consultas distribuídas, atualizações, comandos e transações em fontes de dados heterogêneos em toda a empresa.</span><span class="sxs-lookup"><span data-stu-id="939ec-108">The ability to issue distributed queries, updates, commands, and transactions on heterogeneous data sources across the enterprise.</span></span>

-   <span data-ttu-id="939ec-109">A capacidade de endereçar de forma semelhante diversas fontes de dados.</span><span class="sxs-lookup"><span data-stu-id="939ec-109">The ability to address diverse data sources similarly.</span></span>

 <span data-ttu-id="939ec-110">É possível configurar um servidor vinculado usando [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] ou a instrução [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="939ec-110">You can configure a linked server by using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] or by using the [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql) statement.</span></span> <span data-ttu-id="939ec-111">Provedores do OLE DB variam muito no tipo e número de parâmetros requeridos.</span><span class="sxs-lookup"><span data-stu-id="939ec-111">OLE DB providers vary greatly in the type and number of parameters required.</span></span> <span data-ttu-id="939ec-112">Por exemplo, alguns provedores exigem que você forneça um contexto de segurança para a conexão usando [sp_addlinkedsrvlogin &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedsrvlogin-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="939ec-112">For example some providers require you to provide a security context for the connection using [sp_addlinkedsrvlogin &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedsrvlogin-transact-sql).</span></span> <span data-ttu-id="939ec-113">Alguns provedores OLE DB permitem que o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] atualize dados na origem de OLE DB.</span><span class="sxs-lookup"><span data-stu-id="939ec-113">Some OLE DB providers allow [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] to update data on the OLE DB source.</span></span> <span data-ttu-id="939ec-114">Outros fornecem apenas o acesso a dados somente leitura.</span><span class="sxs-lookup"><span data-stu-id="939ec-114">Others provide only read-only data access.</span></span> <span data-ttu-id="939ec-115">Para obter informações sobre cada provedor do OLE DB, consulte a documentação desse provedor do OLE DB.</span><span class="sxs-lookup"><span data-stu-id="939ec-115">For information about each OLE DB provider, consult documentation for that OLE DB provider.</span></span>

## <a name="linked-server-components"></a><span data-ttu-id="939ec-116">Componentes de servidores vinculados</span><span class="sxs-lookup"><span data-stu-id="939ec-116">Linked Server Components</span></span>
 <span data-ttu-id="939ec-117">Uma definição de servidor vinculado especifica os seguintes objetos:</span><span class="sxs-lookup"><span data-stu-id="939ec-117">A linked server definition specifies the following objects:</span></span>

-   <span data-ttu-id="939ec-118">Um provedor de OLE DB</span><span class="sxs-lookup"><span data-stu-id="939ec-118">An OLE DB provider</span></span>

-   <span data-ttu-id="939ec-119">Uma fonte de dados de OLE DB</span><span class="sxs-lookup"><span data-stu-id="939ec-119">An OLE DB data source</span></span>

 <span data-ttu-id="939ec-120">Um *provedor de OLE DB* é uma DLL que gerencia e interage com uma fonte de dados específica.</span><span class="sxs-lookup"><span data-stu-id="939ec-120">An *OLE DB provider* is a DLL that manages and interacts with a specific data source.</span></span> <span data-ttu-id="939ec-121">Uma *fonte de dados de OLE DB* identifica o banco de dados específico que pode ser acessado por meio de OLE DB.</span><span class="sxs-lookup"><span data-stu-id="939ec-121">An *OLE DB data source* identifies the specific database that can be accessed through OLE DB.</span></span> <span data-ttu-id="939ec-122">Embora fontes de dados consultadas através de definições de servidores vinculados sejam, ordinariamente, bancos de dados, existem provedores de OLE DB para uma variedade de arquivos e formatos de arquivo.</span><span class="sxs-lookup"><span data-stu-id="939ec-122">Although data sources queried through linked server definitions are ordinarily databases, OLE DB providers exist for a variety of files and file formats.</span></span> <span data-ttu-id="939ec-123">Eles compreendem arquivos de texto, dados de planilha e resultados de pesquisas de conteúdo de texto completo.</span><span class="sxs-lookup"><span data-stu-id="939ec-123">These include text files, spreadsheet data, and the results of full-text content searches.</span></span>

 <span data-ttu-id="939ec-124">O [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] provedor de OLE DB de cliente nativo (ProgID: SQLNCLI11) é o provedor de OLE DB oficial do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="939ec-124">The [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB Provider (PROGID: SQLNCLI11) is the official OLE DB provider for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>

> [!NOTE]
>  [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="939ec-125">foram criadas de modo a funcionar com qualquer provedor de OLE DB que implemente as interfaces de OLE DB exigidas.</span><span class="sxs-lookup"><span data-stu-id="939ec-125">distributed queries are designed to work with any OLE DB provider that implements the required OLE DB interfaces.</span></span> <span data-ttu-id="939ec-126">Porém, o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] foi testado apenas no provedor OLE DB do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client e em alguns outros provedores.</span><span class="sxs-lookup"><span data-stu-id="939ec-126">However, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] has been tested against only the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB Provider and certain other providers.</span></span>

## <a name="linked-server-details"></a><span data-ttu-id="939ec-127">Detalhes sobre servidores vinculados</span><span class="sxs-lookup"><span data-stu-id="939ec-127">Linked Server Details</span></span>
 <span data-ttu-id="939ec-128">A ilustração a seguir mostra os fundamentos básicos de uma configuração de servidores vinculados.</span><span class="sxs-lookup"><span data-stu-id="939ec-128">The following illustration shows the basics of a linked server configuration.</span></span>

 <span data-ttu-id="939ec-129">![Camadas de cliente, de servidor e de servidor de banco de dados](../../database-engine/media/lsvr.gif "Camadas de cliente, de servidor e de servidor de banco de dados")</span><span class="sxs-lookup"><span data-stu-id="939ec-129">![Client tier, server tier, and database server tier](../../database-engine/media/lsvr.gif "Client tier, server tier, and database server tier")</span></span>

 <span data-ttu-id="939ec-130">Normalmente, servidores vinculados são usados para manipular consultas distribuídas.</span><span class="sxs-lookup"><span data-stu-id="939ec-130">Typically, linked servers are used to handle distributed queries.</span></span> <span data-ttu-id="939ec-131">Quando um aplicativo cliente executa uma consulta distribuída através de um servidor vinculado, o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] analisa o comando e envia solicitações ao OLE DB.</span><span class="sxs-lookup"><span data-stu-id="939ec-131">When a client application executes a distributed query through a linked server, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] parses the command and sends requests to OLE DB.</span></span> <span data-ttu-id="939ec-132">Essa solicitação de conjunto de linhas pode ser a execução de uma consulta em relação ao provedor ou a abertura de uma tabela base do provedor.</span><span class="sxs-lookup"><span data-stu-id="939ec-132">The rowset request may be in the form of executing a query against the provider or opening a base table from the provider.</span></span>

 <span data-ttu-id="939ec-133">Para que uma fonte de dados retorne dados através de um servidor vinculado, seu provedor de OLE DB (DLL) deve estar presente no mesmo servidor da instância do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="939ec-133">For a data source to return data through a linked server, the OLE DB provider (DLL) for that data source must be present on the same server as the instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>

 <span data-ttu-id="939ec-134">Quando é usado um provedor de OLE DB de terceiros, a conta sob a qual o serviço do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] é executado deve ter permissões de leitura e execução no diretório e em todos os subdiretórios no qual o provedor está instalado.</span><span class="sxs-lookup"><span data-stu-id="939ec-134">When a third-party OLE DB provider is used, the account under which the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] service runs must have read and execute permissions for the directory, and all subdirectories, in which the provider is installed.</span></span>

## <a name="managing-providers"></a><span data-ttu-id="939ec-135">Gerenciando provedores</span><span class="sxs-lookup"><span data-stu-id="939ec-135">Managing Providers</span></span>
 <span data-ttu-id="939ec-136">Há uma série de opções que controlam como o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] carrega e usa os provedores de OLE DB especificados no registro.</span><span class="sxs-lookup"><span data-stu-id="939ec-136">There is a set of options that control how [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] loads and uses OLE DB providers that are specified in the registry.</span></span>

## <a name="managing-linked-server-definitions"></a><span data-ttu-id="939ec-137">Gerenciando definições de servidores vinculados</span><span class="sxs-lookup"><span data-stu-id="939ec-137">Managing Linked Server Definitions</span></span>
 <span data-ttu-id="939ec-138">Ao configurar um servidor vinculado, registre as informações de conexão e de fonte de dados com o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="939ec-138">When you are setting up a linked server, register the connection information and data source information with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="939ec-139">Depois de registrada, a fonte de dados pode ser chamada por um único nome lógico.</span><span class="sxs-lookup"><span data-stu-id="939ec-139">After registered, that data source can be referred to with a single logical name.</span></span>

 <span data-ttu-id="939ec-140">É possível usar procedimentos armazenados e exibições do catálogo para gerenciar definições de servidores vinculados:</span><span class="sxs-lookup"><span data-stu-id="939ec-140">You can use stored procedures and catalog views to manage linked server definitions:</span></span>

-   <span data-ttu-id="939ec-141">Crie uma definição de servidor vinculado, executando **sp_addlinkedserver**.</span><span class="sxs-lookup"><span data-stu-id="939ec-141">Create a linked server definition by running **sp_addlinkedserver**.</span></span>

-   <span data-ttu-id="939ec-142">Exiba informações sobre os servidores vinculados definidos em uma instância específica do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , executando uma consulta em relação às exibições do catálogo do sistema **sys.servers** .</span><span class="sxs-lookup"><span data-stu-id="939ec-142">View information about the linked servers defined in a specific instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] by running a query against the **sys.servers** system catalog views.</span></span>

-   <span data-ttu-id="939ec-143">Exclua uma definição de servidor vinculado, executando **sp_dropserver**.</span><span class="sxs-lookup"><span data-stu-id="939ec-143">Delete a linked server definition by running **sp_dropserver**.</span></span> <span data-ttu-id="939ec-144">Você também pode usar esse procedimento armazenado para remover um servidor remoto.</span><span class="sxs-lookup"><span data-stu-id="939ec-144">You can also use this stored procedure to remove a remote server.</span></span>

 <span data-ttu-id="939ec-145">Também é possível definir servidores vinculados por meio do [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="939ec-145">You can also define linked servers by using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)].</span></span> <span data-ttu-id="939ec-146">No Pesquisador de Objetos, clique com o botão direito do mouse em **Objetos de Servidor**, selecione **Novo**e **Servidor Vinculado**.</span><span class="sxs-lookup"><span data-stu-id="939ec-146">In the Object Explorer, right-click **Server Objects**, select **New**, and select **Linked Server**.</span></span> <span data-ttu-id="939ec-147">Você pode excluir uma definição de servidor vinculado clicando com o botão direito do mouse no nome do servidor vinculado e selecionando **Excluir**.</span><span class="sxs-lookup"><span data-stu-id="939ec-147">You can delete a linked server definition by right-clicking the linked server name and selecting **Delete**.</span></span>

 <span data-ttu-id="939ec-148">Ao executar uma consulta distribuída em relação a um servidor vinculado, inclua um nome de tabela de quatro partes totalmente qualificado para cada fonte de dados a consultar.</span><span class="sxs-lookup"><span data-stu-id="939ec-148">When you execute a distributed query against a linked server, include a fully qualified, four-part table name for each data source to query.</span></span> <span data-ttu-id="939ec-149">Esse nome de quatro partes deve estar no formato _linked_server_name. Catalog_**. _`schema`_ .** _object_name_.</span><span class="sxs-lookup"><span data-stu-id="939ec-149">This four-part name should be in the form _linked_server_name.catalog_**._`schema`_.**_object_name_.</span></span>

> [!NOTE]
>  <span data-ttu-id="939ec-150">Servidores vinculados podem ser definidos para apontar novamente (loopback) para o servidor no qual eles são definidos.</span><span class="sxs-lookup"><span data-stu-id="939ec-150">Linked servers can be defined to point back (loop back) to the server on which they are defined.</span></span> <span data-ttu-id="939ec-151">Servidores de loopback são mais úteis ao testar um aplicativo que usa consultas distribuídas em uma única rede de servidores.</span><span class="sxs-lookup"><span data-stu-id="939ec-151">Loopback servers are most useful when testing an application that uses distributed queries on a single server network.</span></span> <span data-ttu-id="939ec-152">Os servidores de loopback vinculados devem ser usados em testes e não têm suporte para várias operações, como transações distribuídas.</span><span class="sxs-lookup"><span data-stu-id="939ec-152">Loopback linked servers are intended for testing and are not supported for many operations, such as distributed transactions.</span></span>

## <a name="related-tasks"></a><span data-ttu-id="939ec-153">Related Tasks</span><span class="sxs-lookup"><span data-stu-id="939ec-153">Related Tasks</span></span>
 [<span data-ttu-id="939ec-154">Criar servidores vinculados &#40;Mecanismo de Banco de Dados do SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="939ec-154">Create Linked Servers &#40;SQL Server Database Engine&#41;</span></span>](create-linked-servers-sql-server-database-engine.md)

 [<span data-ttu-id="939ec-155">sp_addlinkedserver &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="939ec-155">sp_addlinkedserver &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql)

 [<span data-ttu-id="939ec-156">sp_addlinkedsrvlogin &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="939ec-156">sp_addlinkedsrvlogin &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-addlinkedsrvlogin-transact-sql)

 [<span data-ttu-id="939ec-157">sp_dropserver &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="939ec-157">sp_dropserver &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-dropserver-transact-sql)

## <a name="related-content"></a><span data-ttu-id="939ec-158">Conteúdo relacionado</span><span class="sxs-lookup"><span data-stu-id="939ec-158">Related Content</span></span>
 [<span data-ttu-id="939ec-159">sys.servers &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="939ec-159">sys.servers &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-catalog-views/sys-servers-transact-sql)

 [<span data-ttu-id="939ec-160">sp_linkedservers &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="939ec-160">sp_linkedservers &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-linkedservers-transact-sql)


