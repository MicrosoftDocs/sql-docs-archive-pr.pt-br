---
title: Criar servidores vinculados (Mecanismo de Banco de Dados do SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 11/20/2015
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
f1_keywords:
- sql12.swb.linkedserver.properties.general.f1
- sql12.swb.linkedserver.properties.security.f1
- sql12.swb.linkedserver.properties.provider.f1
- sql12.swb.linkedserver.properties.options.f1
helpviewer_keywords:
- linked servers [SQL Server], creating
ms.assetid: 3228065d-de8f-4ece-a9b1-e06d3dca9310
author: stevestein
ms.author: sstein
ms.openlocfilehash: 6b28468db1024a9789364e5b6e5c115cba71fa9f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87679953"
---
# <a name="create-linked-servers-sql-server-database-engine"></a><span data-ttu-id="b38fb-102">Criar servidores vinculados (Mecanismo de Banco de Dados do SQL Server)</span><span class="sxs-lookup"><span data-stu-id="b38fb-102">Create Linked Servers (SQL Server Database Engine)</span></span>
  <span data-ttu-id="b38fb-103">Este tópico mostra como criar um servidor vinculado e acessar dados de outro [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] usando o [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] ou o [!INCLUDE[tsql](../../includes/tsql-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b38fb-103">This topic shows how to create a linked server and access data from another [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] by using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] or [!INCLUDE[tsql](../../includes/tsql-md.md)].</span></span> <span data-ttu-id="b38fb-104">Criar um servidor vinculado permite trabalhar com dados de várias origens.</span><span class="sxs-lookup"><span data-stu-id="b38fb-104">By creating a linked server,  you can work with data from multiple sources.</span></span> <span data-ttu-id="b38fb-105">O servidor vinculado não precisa ser outra instância do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], mas esse é um cenário comum.</span><span class="sxs-lookup"><span data-stu-id="b38fb-105">The linked server does not have to be another instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], but that is a common scenario.</span></span>  
  
##  <a name="background"></a><a name="Background"></a> <span data-ttu-id="b38fb-106">Plano de fundo</span><span class="sxs-lookup"><span data-stu-id="b38fb-106">Background</span></span>  
 <span data-ttu-id="b38fb-107">Um servidor vinculado permite acesso a consultas distribuídas e heterogêneas em fontes de dados OLE DB.</span><span class="sxs-lookup"><span data-stu-id="b38fb-107">A linked server allows for access to distributed, heterogeneous queries against OLE DB data sources.</span></span> <span data-ttu-id="b38fb-108">Depois que um servidor vinculado é criado, as consultas distribuídas podem ser executadas nesse servidor, e as consultas podem unir tabelas de mais de uma fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="b38fb-108">After a linked server is created, distributed queries can be run against this server, and queries can join tables from more than one data source.</span></span> <span data-ttu-id="b38fb-109">Se o servidor vinculado estiver definido como uma instância do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], poderão ser executados procedimentos armazenados remotos.</span><span class="sxs-lookup"><span data-stu-id="b38fb-109">If the linked server is defined as an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], remote stored procedures can be executed.</span></span>  
  
 <span data-ttu-id="b38fb-110">Os recursos e argumentos necessários do servidor vinculado podem variar significativamente.</span><span class="sxs-lookup"><span data-stu-id="b38fb-110">The capabilities and required arguments of the linked server can vary significantly.</span></span> <span data-ttu-id="b38fb-111">Os exemplos neste tópico fornecem um exemplo típico, mas nem todas as opções são descritas.</span><span class="sxs-lookup"><span data-stu-id="b38fb-111">The examples in this topic provide a typical example but all options are not described.</span></span> <span data-ttu-id="b38fb-112">Para obter mais informações, consulte [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="b38fb-112">For more information, see [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql).</span></span>  
  
##  <a name="security"></a><a name="Security"></a> <span data-ttu-id="b38fb-113">Segurança</span><span class="sxs-lookup"><span data-stu-id="b38fb-113">Security</span></span>  
  
### <a name="permissions"></a><span data-ttu-id="b38fb-114">Permissões</span><span class="sxs-lookup"><span data-stu-id="b38fb-114">Permissions</span></span>  
 <span data-ttu-id="b38fb-115">Ao usar [!INCLUDE[tsql](../../includes/tsql-md.md)] instruções, é necessária `ALTER ANY LINKED SERVER` a permissão no servidor ou associação na função de servidor fixa **setupadmin** .</span><span class="sxs-lookup"><span data-stu-id="b38fb-115">When using [!INCLUDE[tsql](../../includes/tsql-md.md)] statements, requires `ALTER ANY LINKED SERVER` permission on the server or membership in the **setupadmin** fixed server role.</span></span> <span data-ttu-id="b38fb-116">Ao usar [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)] `CONTROL SERVER` o requer permissão ou associação na função de servidor fixa **sysadmin** .</span><span class="sxs-lookup"><span data-stu-id="b38fb-116">When using [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)] requires `CONTROL SERVER` permission or membership in the **sysadmin** fixed server role.</span></span>  
  
##  <a name="how-to-create-a-linked-server"></a><a name="Procedures"></a> <span data-ttu-id="b38fb-117">Como criar um servidor vinculado</span><span class="sxs-lookup"><span data-stu-id="b38fb-117">How to Create a Linked Server</span></span>  
 <span data-ttu-id="b38fb-118">Você pode usar qualquer um dos itens a seguir:</span><span class="sxs-lookup"><span data-stu-id="b38fb-118">You can use any of the following:</span></span>  
  
-   [<span data-ttu-id="b38fb-119">SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="b38fb-119">SQL Server Management Studio</span></span>](#SSMSProcedure)  
  
-   [<span data-ttu-id="b38fb-120">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="b38fb-120">Transact-SQL</span></span>](#TsqlProcedure)  
  
###  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="b38fb-121">Usando o SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="b38fb-121">Using SQL Server Management Studio</span></span>  
  
##### <a name="to-create-a-linked-server-to-another-instance-of-sql-server-using-sql-server-management-studio"></a><span data-ttu-id="b38fb-122">Para criar um servidor vinculado para outra instância do SQL Server usando o SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="b38fb-122">To create a linked server to another instance of SQL Server Using SQL Server Management Studio</span></span>  
  
1.  <span data-ttu-id="b38fb-123">No [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], abra o Pesquisador de Objetos, expanda **Objetos de Servidor**, clique com o botão direito do mouse em **Servidores Vinculados**e clique em **Novo Servidor Vinculado**.</span><span class="sxs-lookup"><span data-stu-id="b38fb-123">In [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], open Object Explorer, expand **Server Objects**, right-click **Linked Servers**, and then click **New Linked Server**.</span></span>  
  
2.  <span data-ttu-id="b38fb-124">Na página **Geral** , na caixa **Servidor vinculado** , digite o nome da instância do **SQL Server** à qual você está se vinculando.</span><span class="sxs-lookup"><span data-stu-id="b38fb-124">On the **General** page, in the **Linked server** box, type the name of the instance of **SQL Server** that you area linking to.</span></span>  
  
     <span data-ttu-id="b38fb-125">**SQL Server**</span><span class="sxs-lookup"><span data-stu-id="b38fb-125">**SQL Server**</span></span>  
     <span data-ttu-id="b38fb-126">Identifique o servidor vinculado como uma instância do [!INCLUDE[msCoName](../../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b38fb-126">Identify the linked server as an instance of [!INCLUDE[msCoName](../../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="b38fb-127">Se você usar esse método de definição de um servidor vinculado [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , o nome especificado em **Servidor vinculado** deverá ser o nome de rede do servidor.</span><span class="sxs-lookup"><span data-stu-id="b38fb-127">If you use this method of defining a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] linked server, the name specified in **Linked server** must be the network name of the server.</span></span> <span data-ttu-id="b38fb-128">Da mesma forma, todas as tabelas recuperadas do servidor provêm do banco de dados padrão definido para logon no servidor vinculado.</span><span class="sxs-lookup"><span data-stu-id="b38fb-128">Also, any tables retrieved from the server are from the default database defined for the login on the linked server.</span></span>  
  
     <span data-ttu-id="b38fb-129">**Outra fonte de dados**</span><span class="sxs-lookup"><span data-stu-id="b38fb-129">**Other data source**</span></span>  
     <span data-ttu-id="b38fb-130">Especifique um tipo de servidor OLE DB diferente de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b38fb-130">Specify an OLE DB server type other than [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="b38fb-131">Clicar nessa opção ativa as opções abaixo dela.</span><span class="sxs-lookup"><span data-stu-id="b38fb-131">Clicking this option activates the options below it.</span></span>  
  
     <span data-ttu-id="b38fb-132">**Provedor**</span><span class="sxs-lookup"><span data-stu-id="b38fb-132">**Provider**</span></span>  
     <span data-ttu-id="b38fb-133">Selecione uma fonte de dados OLE DB na caixa de listagem.</span><span class="sxs-lookup"><span data-stu-id="b38fb-133">Select an OLE DB data source from the list box.</span></span> <span data-ttu-id="b38fb-134">O provedor OLE DB é registrado com o PROGID fornecido no registro.</span><span class="sxs-lookup"><span data-stu-id="b38fb-134">The OLE DB provider is registered with the given PROGID in the registry.</span></span>  
  
     <span data-ttu-id="b38fb-135">**Nome do produto**</span><span class="sxs-lookup"><span data-stu-id="b38fb-135">**Product name**</span></span>  
     <span data-ttu-id="b38fb-136">Digite o nome do produto da fonte de dados OLE DB para adicionar como servidor vinculado.</span><span class="sxs-lookup"><span data-stu-id="b38fb-136">Type the product name of the OLE DB data source to add as a linked server.</span></span>  
  
     <span data-ttu-id="b38fb-137">**Fonte de dados**</span><span class="sxs-lookup"><span data-stu-id="b38fb-137">**Data source**</span></span>  
     <span data-ttu-id="b38fb-138">Digite o nome da fonte de dados conforme interpretada pelo provedor OLE DB.</span><span class="sxs-lookup"><span data-stu-id="b38fb-138">Type the name of the data source as interpreted by the OLE DB provider.</span></span> <span data-ttu-id="b38fb-139">Se estiver se conectando a uma instância do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], forneça o nome da instância.</span><span class="sxs-lookup"><span data-stu-id="b38fb-139">If you are connecting to an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], provide the instance name.</span></span>  
  
     <span data-ttu-id="b38fb-140">**Cadeia de caracteres do provedor**</span><span class="sxs-lookup"><span data-stu-id="b38fb-140">**Provider string**</span></span>  
     <span data-ttu-id="b38fb-141">Digite o identificador programático exclusivo (PROGID) do provedor OLE DB que corresponde à fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="b38fb-141">Type the unique programmatic identifier (PROGID) of the OLE DB provider that corresponds to the data source.</span></span> <span data-ttu-id="b38fb-142">Para obter exemplos de cadeias de caracteres de provedor válidas, consulte [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="b38fb-142">For examples of valid provider strings, see [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql).</span></span>  
  
     <span data-ttu-id="b38fb-143">**Localidade**</span><span class="sxs-lookup"><span data-stu-id="b38fb-143">**Location**</span></span>  
     <span data-ttu-id="b38fb-144">Digite o nome do local do banco de dados conforme interpretado pelo provedor OLE DB.</span><span class="sxs-lookup"><span data-stu-id="b38fb-144">Type the location of the database as interpreted by the OLE DB provider.</span></span>  
  
     <span data-ttu-id="b38fb-145">**Catálogo**</span><span class="sxs-lookup"><span data-stu-id="b38fb-145">**Catalog**</span></span>  
     <span data-ttu-id="b38fb-146">Digite o nome do catálogo para usar ao fazer conexão com o provedor OLE DB.</span><span class="sxs-lookup"><span data-stu-id="b38fb-146">Type the name of the catalog to use when making a connection to the OLE DB provider.</span></span>  
  
     <span data-ttu-id="b38fb-147">Para testar a capacidade de conexão com um servidor vinculado, no Pesquisador de Objetos, clique com o botão direito do mouse no servidor vinculado e, em seguida, clique em **Testar Conexão**.</span><span class="sxs-lookup"><span data-stu-id="b38fb-147">To test the ability to connect to a linked server, in Object Explorer, right-click the linked server and then click **Test Connection**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="b38fb-148">Se a instância do **SQL Server** for a instância padrão, digite o nome do computador que hospeda a instância do **SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="b38fb-148">If the instance of **SQL Server** is the default instance, enter the name of the computer that hosts the instance of **SQL Server**.</span></span> <span data-ttu-id="b38fb-149">Se o **SQL Server** for uma instância nomeada, digite o nome do computador e o nome da instância, como **Accounting\SQLExpress**.</span><span class="sxs-lookup"><span data-stu-id="b38fb-149">If the **SQL Server** is a named instance, enter the name of the computer and the name of the instance, such as **Accounting\SQLExpress**.</span></span>  
  
3.  <span data-ttu-id="b38fb-150">Na área **Tipo de servidor**, selecione **SQL Server** para indicar que o servidor vinculado é outra instância do **SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="b38fb-150">In the **Server type** area, select **SQL Server** to indicate that the linked server is another instance of **SQL Server**.</span></span>  
  
4.  <span data-ttu-id="b38fb-151">Na página **Segurança** , especifique o contexto de segurança que será usado quando o [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] original se conectar ao servidor vinculado.</span><span class="sxs-lookup"><span data-stu-id="b38fb-151">On the **Security** page, specify the security context that will be used when the original [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] connects to the linked server.</span></span> <span data-ttu-id="b38fb-152">Em um ambiente de domínio em que os usuários se conectam usando seus logons de domínio, a melhor opção é geralmente selecionar **Serão feitas usando o contexto de segurança atual do logon**.</span><span class="sxs-lookup"><span data-stu-id="b38fb-152">In a domain environment where users are connecting by using their domain logins, selecting **Be made using the login's current security context** is often the best choice.</span></span> <span data-ttu-id="b38fb-153">Quando os usuários se conectam ao **SQL Server** original com um logon do **SQL Server** , a melhor opção geralmente é selecionar **Usando este contexto de segurança**e fornecer as credenciais necessárias para autenticação no servidor vinculado.</span><span class="sxs-lookup"><span data-stu-id="b38fb-153">When users connect to the original **SQL Server** by using a **SQL Server** login, the best choice is often to select **By using this security context**, and then providing the necessary credentials to authenticate at the linked server.</span></span>  
  
     <span data-ttu-id="b38fb-154">**Logon local**</span><span class="sxs-lookup"><span data-stu-id="b38fb-154">**Local login**</span></span>  
     <span data-ttu-id="b38fb-155">Especifique o logon local que pode se conectar ao servidor vinculado.</span><span class="sxs-lookup"><span data-stu-id="b38fb-155">Specify the local login that can connect to the linked server.</span></span> <span data-ttu-id="b38fb-156">O logon local pode ser um logon que usa a Autenticação do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ou um logon de Autenticação do Windows.</span><span class="sxs-lookup"><span data-stu-id="b38fb-156">The local login can be either a login using [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication or a Windows Authentication login.</span></span> <span data-ttu-id="b38fb-157">Use essa lista para restringir a conexão a logons específicos ou permitir alguns logons para serem conectados como um logon diferente.</span><span class="sxs-lookup"><span data-stu-id="b38fb-157">Use this list to restrict the connection to specific logins, or to allow some logins to connect as a different login.</span></span>  
  
     <span data-ttu-id="b38fb-158">**Impersonate**</span><span class="sxs-lookup"><span data-stu-id="b38fb-158">**Impersonate**</span></span>  
     <span data-ttu-id="b38fb-159">Passe o nome de usuário e senha do logon local para o servidor vinculado.</span><span class="sxs-lookup"><span data-stu-id="b38fb-159">Pass the username and password from the local login to the linked server.</span></span> <span data-ttu-id="b38fb-160">Para a Autenticação do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , um logon com exatamente o mesmo nome e senha deve existir no servidor remoto.</span><span class="sxs-lookup"><span data-stu-id="b38fb-160">For [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication, a login with the exact same name and password must exist on the remote server.</span></span> <span data-ttu-id="b38fb-161">Para logons de Windows, o logon deve ser um logon válido no servidor vinculado.</span><span class="sxs-lookup"><span data-stu-id="b38fb-161">For Windows logins, the login must be a valid login on the linked server.</span></span>  
  
     <span data-ttu-id="b38fb-162">Para usar representação, a configuração deve satisfazer o requisito para delegação.</span><span class="sxs-lookup"><span data-stu-id="b38fb-162">To use impersonation, the configuration must meet the requirement for delegation.</span></span>  
  
     <span data-ttu-id="b38fb-163">**Usuário Remoto**</span><span class="sxs-lookup"><span data-stu-id="b38fb-163">**Remote User**</span></span>  
     <span data-ttu-id="b38fb-164">Use o usuário remoto para mapear usuários não definidos em **Logon local**.</span><span class="sxs-lookup"><span data-stu-id="b38fb-164">Use the remote user to map users not defined in **Local login**.</span></span> <span data-ttu-id="b38fb-165">O **Usuário Remoto** deve ser um logon de Autenticação do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] no servidor remoto.</span><span class="sxs-lookup"><span data-stu-id="b38fb-165">The **Remote User** must be a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication login on the remote server.</span></span>  
  
     <span data-ttu-id="b38fb-166">**Senha Remota**</span><span class="sxs-lookup"><span data-stu-id="b38fb-166">**Remote Password**</span></span>  
     <span data-ttu-id="b38fb-167">Especifique a senha do Usuário Remoto.</span><span class="sxs-lookup"><span data-stu-id="b38fb-167">Specify the password of the Remote User.</span></span>  
  
     <span data-ttu-id="b38fb-168">**Adicionar**</span><span class="sxs-lookup"><span data-stu-id="b38fb-168">**Add**</span></span>  
     <span data-ttu-id="b38fb-169">Adicione um novo logon local.</span><span class="sxs-lookup"><span data-stu-id="b38fb-169">Add a new local login.</span></span>  
  
     <span data-ttu-id="b38fb-170">**Remover**</span><span class="sxs-lookup"><span data-stu-id="b38fb-170">**Remove**</span></span>  
     <span data-ttu-id="b38fb-171">Remova um logon local existente.</span><span class="sxs-lookup"><span data-stu-id="b38fb-171">Remove an existing local login.</span></span>  
  
     <span data-ttu-id="b38fb-172">**Não serão feitas**</span><span class="sxs-lookup"><span data-stu-id="b38fb-172">**Not be made**</span></span>  
     <span data-ttu-id="b38fb-173">Especifique que uma conexão não será feita para logons não definidos na lista.</span><span class="sxs-lookup"><span data-stu-id="b38fb-173">Specify that a connection will not be made for logins not defined in the list.</span></span>  
  
     <span data-ttu-id="b38fb-174">**Serão feitas sem usar um contexto de segurança**</span><span class="sxs-lookup"><span data-stu-id="b38fb-174">**Be made without using a security context**</span></span>  
     <span data-ttu-id="b38fb-175">Especifique que uma conexão será feita sem usar um contexto de segurança para logons não definidos na lista.</span><span class="sxs-lookup"><span data-stu-id="b38fb-175">Specify that a connection will be made without using a security context for logins not defined in the list.</span></span>  
  
     <span data-ttu-id="b38fb-176">**Serão feitas usando um contexto de segurança atual do logon**</span><span class="sxs-lookup"><span data-stu-id="b38fb-176">**Be made using the login's current security context**</span></span>  
     <span data-ttu-id="b38fb-177">Especifique que uma conexão será feita usando o contexto de segurança atual do logon para logons não definidos na lista.</span><span class="sxs-lookup"><span data-stu-id="b38fb-177">Specify that a connection will be made using the current security context of the login for logins not defined in the list.</span></span> <span data-ttu-id="b38fb-178">Se conectado ao servidor local que usa Autenticação do Windows, suas credenciais do Windows serão usadas para conectar-se ao servidor remoto.</span><span class="sxs-lookup"><span data-stu-id="b38fb-178">If connected to the local server using Windows Authentication, your windows credentials will be used to connect to the remote server.</span></span> <span data-ttu-id="b38fb-179">Se conectado ao servidor local que usa a Autenticação [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , nome de logon e senha serão usados para conectar-se ao servidor remoto.</span><span class="sxs-lookup"><span data-stu-id="b38fb-179">If connected to the local server using [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication, login name and password will be used to connect to the remote server.</span></span> <span data-ttu-id="b38fb-180">Nesse caso um logon com exatamente o mesmo nome e senha deve existir no servidor remoto.</span><span class="sxs-lookup"><span data-stu-id="b38fb-180">In this case a login with the exact same name and password must exist on the remote server.</span></span>  
  
     <span data-ttu-id="b38fb-181">**Serão feitas usando este contexto de segurança**</span><span class="sxs-lookup"><span data-stu-id="b38fb-181">**Be made using this security context**</span></span>  
     <span data-ttu-id="b38fb-182">Especifique que uma conexão será feita usando o logon e senha especificados nas caixas **Logon Remoto** e **Com senha** para logons não definidos na lista.</span><span class="sxs-lookup"><span data-stu-id="b38fb-182">Specify that a connection will be made using the login and password specified in the **Remote login** and **With password** boxes for logins not defined in the list.</span></span> <span data-ttu-id="b38fb-183">O usuário remoto deve ser um logon de Autenticação do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] no servidor remoto.</span><span class="sxs-lookup"><span data-stu-id="b38fb-183">The remote login must be a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication login on the remote server.</span></span>  
  
5.  <span data-ttu-id="b38fb-184">Opcionalmente, para exibir ou especificar opções de servidor, clique na página **Opções de Servidor**  .</span><span class="sxs-lookup"><span data-stu-id="b38fb-184">Optionally, to view or specify server options, click the **Server Options**  page.</span></span>  
  
     <span data-ttu-id="b38fb-185">**Compatível com Ordenação**</span><span class="sxs-lookup"><span data-stu-id="b38fb-185">**Collation Compatible**</span></span>  
     <span data-ttu-id="b38fb-186">Afeta a execução da Consulta Distribuída nos servidores vinculados.</span><span class="sxs-lookup"><span data-stu-id="b38fb-186">Affects Distributed Query execution against linked servers.</span></span> <span data-ttu-id="b38fb-187">Se essa opção estiver definida como true, o [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] presumirá que todos os caracteres no servidor vinculado são compatíveis com o servidor local, no que diz respeito ao conjunto de caracteres e à sequência da ordenação (ou ordem de classificação).</span><span class="sxs-lookup"><span data-stu-id="b38fb-187">If this option is set to true, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] assumes that all characters in the linked server are compatible with the local server, with regard to character set and collation sequence (or sort order).</span></span> <span data-ttu-id="b38fb-188">Isso permite que o [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] envie comparações sobre colunas de caracteres ao provedor.</span><span class="sxs-lookup"><span data-stu-id="b38fb-188">This enables [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to send comparisons on character columns to the provider.</span></span> <span data-ttu-id="b38fb-189">Se essa opção não estiver definida, o [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] sempre avaliará comparações sobre colunas de caracteres localmente.</span><span class="sxs-lookup"><span data-stu-id="b38fb-189">If this option is not set, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] always evaluates comparisons on character columns locally.</span></span>  
  
     <span data-ttu-id="b38fb-190">Essa opção deve ser definida somente se você tiver certeza de que a fonte de dados correspondente ao servidor vinculado tem o mesmo conjunto de caracteres e ordem de classificação do servidor local.</span><span class="sxs-lookup"><span data-stu-id="b38fb-190">This option should be set only if it is certain that the data source corresponding to the linked server has the same character set and sort order as the local server.</span></span>  
  
     <span data-ttu-id="b38fb-191">**Acesso a dados**</span><span class="sxs-lookup"><span data-stu-id="b38fb-191">**Data Access**</span></span>  
     <span data-ttu-id="b38fb-192">Habilita e desabilita um servidor vinculado para o acesso às consultas distribuídas.</span><span class="sxs-lookup"><span data-stu-id="b38fb-192">Enables and disables a linked server for distributed query access.</span></span>  
  
     <span data-ttu-id="b38fb-193">**RPC**</span><span class="sxs-lookup"><span data-stu-id="b38fb-193">**RPC**</span></span>  
     <span data-ttu-id="b38fb-194">Habilita o RPC a partir do servidor especificado.</span><span class="sxs-lookup"><span data-stu-id="b38fb-194">Enables RPC from the specified server.</span></span>  
  
     <span data-ttu-id="b38fb-195">**RPC Out**</span><span class="sxs-lookup"><span data-stu-id="b38fb-195">**RPC Out**</span></span>  
     <span data-ttu-id="b38fb-196">Habilita o RPC para o servidor especificado.</span><span class="sxs-lookup"><span data-stu-id="b38fb-196">Enables RPC to the specified server.</span></span>  
  
     <span data-ttu-id="b38fb-197">**Usar Ordenação Remota**</span><span class="sxs-lookup"><span data-stu-id="b38fb-197">**Use Remote Collation**</span></span>  
     <span data-ttu-id="b38fb-198">Determina se a ordenação de uma coluna remota ou de um servidor local será usada.</span><span class="sxs-lookup"><span data-stu-id="b38fb-198">Determines whether the collation of a remote column or of a local server will be used.</span></span>  
  
     <span data-ttu-id="b38fb-199">Se true, a ordenação de colunas remotas será usada para as fontes de dados do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] e a ordenação especificada no nome da ordenação será usada para fontes de dados não [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b38fb-199">If true, the collation of remote columns is used for [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data sources, and the collation specified in collation name is used for non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data sources.</span></span>  
  
     <span data-ttu-id="b38fb-200">Se false, as consultas distribuídas sempre usarão a ordenação padrão do servidor local, enquanto que o nome da ordenação e a ordenação de colunas remotas serão ignorados.</span><span class="sxs-lookup"><span data-stu-id="b38fb-200">If false, distributed queries will always use the default collation of the local server, while collation name and the collation of remote columns are ignored.</span></span> <span data-ttu-id="b38fb-201">O padrão é falso.</span><span class="sxs-lookup"><span data-stu-id="b38fb-201">The default is false.</span></span>  
  
     <span data-ttu-id="b38fb-202">**Nome da Ordenação**</span><span class="sxs-lookup"><span data-stu-id="b38fb-202">**Collation Name**</span></span>  
     <span data-ttu-id="b38fb-203">Especifica o nome da ordenação usado pela fonte de dados remota se o uso da ordenação remota for true e a fonte de dados não for uma fonte de dados do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b38fb-203">Specifies the name of the collation used by the remote data source if use remote collation is true and the data source is not a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data source.</span></span> <span data-ttu-id="b38fb-204">O nome deve ser uma das ordenações que têm suporte do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b38fb-204">The name must be one of the collations supported by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
     <span data-ttu-id="b38fb-205">Use essa opção ao acessar uma origem de dados OLE DB diferente do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], mas cuja ordenação coincide com uma das ordenações do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b38fb-205">Use this option when accessing an OLE DB data source other than [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], but whose collation matches one of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] collations.</span></span>  
  
     <span data-ttu-id="b38fb-206">O servidor vinculado deve fornecer suporte a uma única ordenação a ser usada para todas as colunas naquele servidor.</span><span class="sxs-lookup"><span data-stu-id="b38fb-206">The linked server must support a single collation to be used for all columns in that server.</span></span> <span data-ttu-id="b38fb-207">Não defina essa opção se o servidor vinculado fornecer suporte a várias ordenações dentro de uma única fonte de dados ou se a ordenação do servidor vinculado não puder ser determinada para corresponder a uma das ordenações do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b38fb-207">Do not set this option if the linked server supports multiple collations within a single data source, or if the linked server's collation cannot be determined to match one of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] collations.</span></span>  
  
     <span data-ttu-id="b38fb-208">**Tempo limite da conexão**</span><span class="sxs-lookup"><span data-stu-id="b38fb-208">**Connection Timeout**</span></span>  
     <span data-ttu-id="b38fb-209">O valor do tempo limite em segundos para conexão a um servidor vinculado.</span><span class="sxs-lookup"><span data-stu-id="b38fb-209">Time-out value in seconds for connecting to a linked server.</span></span>  
  
     <span data-ttu-id="b38fb-210">Se 0, use o valor **sp_configure** padrão da opção [remote login timeout](../../database-engine/configure-windows/configure-the-remote-login-timeout-server-configuration-option.md) .</span><span class="sxs-lookup"><span data-stu-id="b38fb-210">If 0, use the **sp_configure** default [remote login timeout](../../database-engine/configure-windows/configure-the-remote-login-timeout-server-configuration-option.md) option value.</span></span>  
  
     <span data-ttu-id="b38fb-211">**Tempo Limite da Consulta**</span><span class="sxs-lookup"><span data-stu-id="b38fb-211">**Query Timeout**</span></span>  
     <span data-ttu-id="b38fb-212">O valor do tempo limite em segundos para as consultas em um servidor vinculado.</span><span class="sxs-lookup"><span data-stu-id="b38fb-212">Time-out value in seconds for queries against a linked server.</span></span>  
  
     <span data-ttu-id="b38fb-213">Se 0, use o valor **sp_configure** padrão da opção [remote query timeout](../../database-engine/configure-windows/configure-the-remote-query-timeout-server-configuration-option.md) .</span><span class="sxs-lookup"><span data-stu-id="b38fb-213">If 0, use the **sp_configure** default [remote query timeout](../../database-engine/configure-windows/configure-the-remote-query-timeout-server-configuration-option.md) option value.</span></span>  
  
     <span data-ttu-id="b38fb-214">**Habilitar Promoção de Transações Distribuídas**</span><span class="sxs-lookup"><span data-stu-id="b38fb-214">**Enable Promotion of Distributed Transactions**</span></span>  
     <span data-ttu-id="b38fb-215">Use esta opção para proteger as ações de um procedimento servidor a servidor por meio de uma transação do MS DTC (Coordenador de Transações Distribuídas da [!INCLUDE[msCoName](../../../includes/msconame-md.md)] ).</span><span class="sxs-lookup"><span data-stu-id="b38fb-215">Use this option to protect the actions of a server-to-server procedure through a [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Distributed Transaction Coordinator (MS DTC) transaction.</span></span> <span data-ttu-id="b38fb-216">Quando esta opção for TRUE, chamar um procedimento remoto armazenado irá iniciar uma transação distribuída e inscrever a transação com o MS DTC.</span><span class="sxs-lookup"><span data-stu-id="b38fb-216">When this option is TRUE, calling a remote stored procedure starts a distributed transaction and enlists the transaction with MS DTC.</span></span> <span data-ttu-id="b38fb-217">Para obter mais informações, consulte [sp_serveroption &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-serveroption-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="b38fb-217">For more information, see [sp_serveroption &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-serveroption-transact-sql).</span></span>  
  
6.  <span data-ttu-id="b38fb-218">Clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="b38fb-218">Click **OK**.</span></span>  
  
##### <a name="to-view-the-provider-options"></a><span data-ttu-id="b38fb-219">Para exibir as opções de provedor</span><span class="sxs-lookup"><span data-stu-id="b38fb-219">To view the provider options</span></span>  
  
-   <span data-ttu-id="b38fb-220">Para exibir as opções que o provedor torna disponível, clique na página **Opções de Provedores** .</span><span class="sxs-lookup"><span data-stu-id="b38fb-220">To view the options that the provider makes available, click the **Providers Options** page.</span></span>  
  
     <span data-ttu-id="b38fb-221">Todos os provedores não têm as mesmas opções disponíveis.</span><span class="sxs-lookup"><span data-stu-id="b38fb-221">All providers do not have the same options available.</span></span> <span data-ttu-id="b38fb-222">Por exemplo, alguns tipos de dados têm índices disponíveis e outros talvez não tenham.</span><span class="sxs-lookup"><span data-stu-id="b38fb-222">For example, some types of data have indexes available and some might not.</span></span> <span data-ttu-id="b38fb-223">Use essa caixa de diálogo para ajudar o [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] a entender os recursos do provedor.</span><span class="sxs-lookup"><span data-stu-id="b38fb-223">Use this dialog box to help [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] understand the capabilities of the provider.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="b38fb-224">instala alguns provedores de dados comuns; porém, quando o produto que fornece os dados muda, o provedor instalado pelo [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] pode não oferecer suporte a todos os recursos mais novos.</span><span class="sxs-lookup"><span data-stu-id="b38fb-224">installs some common data providers, however when the product providing the data changes, the provider installed by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] might not support all the newest features.</span></span> <span data-ttu-id="b38fb-225">A melhor fonte de informações sobre os recursos do produto que fornece os dados é a documentação desse produto:</span><span class="sxs-lookup"><span data-stu-id="b38fb-225">The best source of information about the capabilities of the product providing the data is the documentation for that product.</span></span>  
  
     <span data-ttu-id="b38fb-226">**Parâmetro dinâmico**</span><span class="sxs-lookup"><span data-stu-id="b38fb-226">**Dynamic parameter**</span></span>  
     <span data-ttu-id="b38fb-227">Indica que o provedor permite a sintaxe de marcador de parâmetro '?' para consultas parametrizadas.</span><span class="sxs-lookup"><span data-stu-id="b38fb-227">Indicates that the provider allows '?' parameter marker syntax for parameterized queries.</span></span> <span data-ttu-id="b38fb-228">Defina essa opção apenas se o provedor der suporte à interface **ICommandWithParameters** e a um '?' como o marcador de parâmetro.</span><span class="sxs-lookup"><span data-stu-id="b38fb-228">Set this option only if the provider supports the **ICommandWithParameters** interface and supports a '?' as the parameter marker.</span></span> <span data-ttu-id="b38fb-229">Definir essa opção permite que o [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] execute consultas com parâmetros em relação ao provedor.</span><span class="sxs-lookup"><span data-stu-id="b38fb-229">Setting this option allows [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to execute parameterized queries against the provider.</span></span> <span data-ttu-id="b38fb-230">A capacidade de executar consultas parametrizadas em relação ao provedor pode resultar em um melhor desempenho para determinadas consultas.</span><span class="sxs-lookup"><span data-stu-id="b38fb-230">The ability to execute parameterized queries against the provider can result in better performance for certain queries.</span></span>  
  
     <span data-ttu-id="b38fb-231">**Consultas aninhadas**</span><span class="sxs-lookup"><span data-stu-id="b38fb-231">**Nested queries**</span></span>  
     <span data-ttu-id="b38fb-232">Indica que o provedor permite instruções aninhadas  `SELECT` na cláusula FROM.</span><span class="sxs-lookup"><span data-stu-id="b38fb-232">Indicates that the provider allows nested  `SELECT` statements in the FROM clause.</span></span> <span data-ttu-id="b38fb-233">Definir essa opção permite ao [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] delegar determinadas consultas ao provedor que requer instruções aninhadas SELECT na cláusula FROM.</span><span class="sxs-lookup"><span data-stu-id="b38fb-233">Setting this option allows [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to delegate certain queries to the provider that require nesting SELECT statements in the FROM clause.</span></span>  
  
     <span data-ttu-id="b38fb-234">**Somente nível zero**</span><span class="sxs-lookup"><span data-stu-id="b38fb-234">**Level zero only**</span></span>  
     <span data-ttu-id="b38fb-235">Somente as interfaces OLE DB de nível 0 são invocadas em relação ao provedor.</span><span class="sxs-lookup"><span data-stu-id="b38fb-235">Only level 0 OLE DB interfaces are invoked against the provider.</span></span>  
  
     <span data-ttu-id="b38fb-236">**Permitir inprocess**</span><span class="sxs-lookup"><span data-stu-id="b38fb-236">**Allow inprocess**</span></span>  
     [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="b38fb-237">permite que seja criada uma instância do servidor como um servidor em processo.</span><span class="sxs-lookup"><span data-stu-id="b38fb-237">allows the provider to be instantiated as an in-process server.</span></span> <span data-ttu-id="b38fb-238">Quando essa opção não é definida, o comportamento padrão é criar uma instância no provedor fora do processo do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="b38fb-238">When this option is not set, the default behavior is to instantiate the provider outside the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] process.</span></span> <span data-ttu-id="b38fb-239">Criando uma instância no provedor fora do processo do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] protege o processo do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] de erros no provedor.</span><span class="sxs-lookup"><span data-stu-id="b38fb-239">Instantiating the provider outside the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] process protects the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] process from errors in the provider.</span></span> <span data-ttu-id="b38fb-240">Quando uma instância é criada no provedor fora do processo do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], ela atualiza ou insere colunas longas de referência (`text`, `ntext`ou `image`) que não são permitidas.</span><span class="sxs-lookup"><span data-stu-id="b38fb-240">When the provider is instantiated outside the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] process, updates or inserts referencing long columns (`text`, `ntext`, or `image`) are not allowed.</span></span>  
  
     <span data-ttu-id="b38fb-241">**Atualizações não transacionadas**</span><span class="sxs-lookup"><span data-stu-id="b38fb-241">**Non transacted updates**</span></span>  
     [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="b38fb-242">permite atualizações, até mesmo se a **ITransactionLocal** não estiver disponível.</span><span class="sxs-lookup"><span data-stu-id="b38fb-242">allows updates, even if **ITransactionLocal** is not available.</span></span> <span data-ttu-id="b38fb-243">Se essa opção estiver habilitada, atualizações em relação ao provedor não serão recuperáveis porque o provedor não possui suporte para transações.</span><span class="sxs-lookup"><span data-stu-id="b38fb-243">If this option is enabled, updates against the provider are not recoverable, because the provider does not support transactions.</span></span>  
  
     <span data-ttu-id="b38fb-244">**Índice como caminho de acesso**</span><span class="sxs-lookup"><span data-stu-id="b38fb-244">**Index as access path**</span></span>  
     [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="b38fb-245">tenta usar índices do provedor para buscar dados.</span><span class="sxs-lookup"><span data-stu-id="b38fb-245">attempts to use indexes of the provider to fetch data.</span></span> <span data-ttu-id="b38fb-246">Por padrão, os índices são usados apenas para metadados e não são abertos</span><span class="sxs-lookup"><span data-stu-id="b38fb-246">By default, indexes are used only for metadata and are never opened</span></span>  
  
     <span data-ttu-id="b38fb-247">**Proibir acesso ad hoc**</span><span class="sxs-lookup"><span data-stu-id="b38fb-247">**Disallow ad hoc access**</span></span>  
     [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="b38fb-248">não permite acesso ad hoc pelas funções OPENROWSET e OPENDATASOURCE ao provedor OLE DB.</span><span class="sxs-lookup"><span data-stu-id="b38fb-248">does not allow ad hoc access through the OPENROWSET and OPENDATASOURCE functions against the OLE DB provider.</span></span> <span data-ttu-id="b38fb-249">Quando essa opção não é definida, o [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] também não permite acesso ad hoc.</span><span class="sxs-lookup"><span data-stu-id="b38fb-249">When this option is not set, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] also does not allow ad hoc access.</span></span>  
  
     <span data-ttu-id="b38fb-250">**Oferece suporte ao operador 'Like'**</span><span class="sxs-lookup"><span data-stu-id="b38fb-250">**Supports 'Like' operator**</span></span>  
     <span data-ttu-id="b38fb-251">Indica que o provedor oferece suporte a consultas que usam a palavra-chave LIKE.</span><span class="sxs-lookup"><span data-stu-id="b38fb-251">Indicates that the provider supports queries using the LIKE key word.</span></span>  
  
###  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="b38fb-252">Usando o Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="b38fb-252">Using Transact-SQL</span></span>  
 <span data-ttu-id="b38fb-253">Para criar um servidor vinculado usando [!INCLUDE[tsql](../../includes/tsql-md.md)], use as instruções [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql)[CREATE LOGIN &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-login-transact-sql) e [sp_addlinkedsrvlogin &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedsrvlogin-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="b38fb-253">To create a linked server by using [!INCLUDE[tsql](../../includes/tsql-md.md)], use the [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql)[CREATE LOGIN &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-login-transact-sql) and [sp_addlinkedsrvlogin &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedsrvlogin-transact-sql) statements.</span></span>  
  
##### <a name="to-create-a-linked-server-to-another-instance-of-sql-server-using-transact-sql"></a><span data-ttu-id="b38fb-254">Para criar um servidor vinculado para outra instância do SQL Server usando Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="b38fb-254">To create a linked server to another instance of SQL Server using Transact-SQL</span></span>  
  
1.  <span data-ttu-id="b38fb-255">No Editor de Consultas, digite o comando [!INCLUDE[tsql](../../includes/tsql-md.md)] a seguir para vincular a uma instância do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] denominada `SRVR002\ACCTG`:</span><span class="sxs-lookup"><span data-stu-id="b38fb-255">In Query Editor, enter the following [!INCLUDE[tsql](../../includes/tsql-md.md)] command to link to an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] named `SRVR002\ACCTG`:</span></span>  
  
    ```sql  
    USE [master]  
    GO  
    EXEC master.dbo.sp_addlinkedserver   
        @server = N'SRVR002\ACCTG',   
        @srvproduct=N'SQL Server' ;  
    GO  
  
    ```  
  
2.  <span data-ttu-id="b38fb-256">Execute o código a seguir para configurar o servidor vinculado para usar as credenciais de domínio do logon que está usando o servidor vinculado.</span><span class="sxs-lookup"><span data-stu-id="b38fb-256">Execute the following code to configure the linked server to use the domain credentials of the login that is using the linked server.</span></span>  
  
    ```sql  
    EXEC master.dbo.sp_addlinkedsrvlogin   
        @rmtsrvname = N'SRVR002\ACCTG',   
        @locallogin = NULL ,   
        @useself = N'True' ;  
    GO  
  
    ```  
  
##  <a name="follow-up-steps-to-take-after-you-create-a-linked-server"></a><a name="FollowUp"></a><span data-ttu-id="b38fb-257">Acompanhamento: etapas a serem executadas após a criação de um servidor vinculado</span><span class="sxs-lookup"><span data-stu-id="b38fb-257">Follow Up: Steps to take after you create a linked server</span></span>  
  
#### <a name="to-test-the-linked-server"></a><span data-ttu-id="b38fb-258">Para testar o servidor vinculado</span><span class="sxs-lookup"><span data-stu-id="b38fb-258">To test the linked server</span></span>  
  
-   <span data-ttu-id="b38fb-259">Execute o código a seguir para testar a conexão com o servidor vinculado.</span><span class="sxs-lookup"><span data-stu-id="b38fb-259">Execute the following code to test the connection to the linked server.</span></span> <span data-ttu-id="b38fb-260">Este exemplo retorna os nomes dos bancos de dados no servidor vinculado.</span><span class="sxs-lookup"><span data-stu-id="b38fb-260">This example the returns the names of the databases on the linked server.</span></span>  
  
    ```sql  
    SELECT name FROM [SRVR002\ACCTG].master.sys.databases ;  
    GO  
  
    ```  
  
#### <a name="writing-a-query-that-joins-tables-from-a-linked-server"></a><span data-ttu-id="b38fb-261">Gravando uma consulta que une tabelas de um servidor vinculado</span><span class="sxs-lookup"><span data-stu-id="b38fb-261">Writing a query that joins tables from a linked server</span></span>  
  
-   <span data-ttu-id="b38fb-262">Use nomes de quatro partes para referir-se a um objeto em um servidor vinculado.</span><span class="sxs-lookup"><span data-stu-id="b38fb-262">Use four-part names to refer to an object on a linked server.</span></span> <span data-ttu-id="b38fb-263">Execute o código a seguir para retornar uma lista de todos os logons no servidor local e seus logons correspondentes no servidor vinculado.</span><span class="sxs-lookup"><span data-stu-id="b38fb-263">Execute the following code to return a list of all logins on the local server and their matching logins on the linked server.</span></span>  
  
    ```sql  
    SELECT local.name AS LocalLogins, linked.name AS LinkedLogins  
    FROM master.sys.server_principals AS local  
    LEFT JOIN [SRVR002\ACCTG].master.sys.server_principals AS linked  
        ON local.name = linked.name ;  
    GO  
    ```  
  
     <span data-ttu-id="b38fb-264">Quando NULL é retornado para o logon do servidor vinculado, ele indica que o logon não existe no servidor vinculado.</span><span class="sxs-lookup"><span data-stu-id="b38fb-264">When NULL is returned for the linked server login it indicates that the login does not exist on the linked server.</span></span> <span data-ttu-id="b38fb-265">Esses logons não poderão usar o servidor vinculado, a menos que o servidor vinculado seja configurado para passar um contexto de segurança diferente ou o servidor vinculado aceite conexões anônimas.</span><span class="sxs-lookup"><span data-stu-id="b38fb-265">These logins will not be able to use the linked server unless the linked server is configured to pass a different security context or the linked server accepts anonymous connections.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b38fb-266">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="b38fb-266">See Also</span></span>  
 <span data-ttu-id="b38fb-267">[Servidores vinculados &#40;Mecanismo de Banco de Dados&#41;](linked-servers-database-engine.md) </span><span class="sxs-lookup"><span data-stu-id="b38fb-267">[Linked Servers &#40;Database Engine&#41;](linked-servers-database-engine.md) </span></span>  
 <span data-ttu-id="b38fb-268">[sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="b38fb-268">[sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql) </span></span>  
 [<span data-ttu-id="b38fb-269">sp_serveroption &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="b38fb-269">sp_serveroption &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-serveroption-transact-sql)  
  
  
