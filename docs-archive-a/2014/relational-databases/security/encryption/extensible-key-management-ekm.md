---
title: EKM (Gerenciamento extensível de chaves) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: security
ms.topic: conceptual
helpviewer_keywords:
- Key Management
- Extensible Key Management
- EKM, described
ms.assetid: 9bfaf500-2d1e-4c02-b041-b8761a9e695b
author: jaszymas
ms.author: jaszymas
ms.openlocfilehash: 4fc9b002b57f8118494709f8fe27a8b19ce28d8e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87680865"
---
# <a name="extensible-key-management-ekm"></a><span data-ttu-id="8acb7-102">Gerenciamento extensível de chaves (EKM)</span><span class="sxs-lookup"><span data-stu-id="8acb7-102">Extensible Key Management (EKM)</span></span>
  [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="8acb7-103">oferece funcionalidades de criptografia de dados com o *EKM* (Gerenciador Extensível de Chaves), usando o provedor *Microsoft Cryptographic API* (MSCAPI) para criptografia e geração de chave.</span><span class="sxs-lookup"><span data-stu-id="8acb7-103">provides data encryption capabilities together with *Extensible Key Management* (EKM), using the *Microsoft Cryptographic API* (MSCAPI) provider for encryption and key generation.</span></span> <span data-ttu-id="8acb7-104">As chaves de criptografia de dados e a criptografia da chave são criadas em contêineres chaves e devem ser exportadas por um provedor antes de serem armazenadas no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="8acb7-104">Encryption keys for data and key encryption are created in transient key containers, and they must be exported from a provider before they are stored in the database.</span></span> <span data-ttu-id="8acb7-105">Essa abordagem habilita o gerenciamento de chave, que inclui uma hierarquia de chave de criptografia e backup da chave, para ser tratado pelo [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="8acb7-105">This approach enables key management that includes an encryption key hierarchy and key backup, to be handled by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="8acb7-106">Com a crescente demanda de conformidade reguladora e referente à privacidade dos dados, as organizações estão tirando vantagem da criptografia como meio de oferecer uma solução de "defesa aprofundada".</span><span class="sxs-lookup"><span data-stu-id="8acb7-106">With the growing demand for regulatory compliance and concern for data privacy, organizations are taking advantage of encryption as a way to provide a "defense in depth" solution.</span></span> <span data-ttu-id="8acb7-107">Essa abordagem geralmente não é muito prática se usar só as ferramentas de gerenciamento de criptografia do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="8acb7-107">This approach is often impractical using only database encryption management tools.</span></span> <span data-ttu-id="8acb7-108">Os fornecedores de hardware fornecem produtos que corrigem o gerenciamento de chave empresarial, usando o *HSM* (módulos de segurança do hardware).</span><span class="sxs-lookup"><span data-stu-id="8acb7-108">Hardware vendors provide products that address enterprise key management by using *Hardware Security Modules* (HSM).</span></span> <span data-ttu-id="8acb7-109">Os dispositivos HSM armazenam chaves de criptografia em módulos de software ou hardware.</span><span class="sxs-lookup"><span data-stu-id="8acb7-109">HSM devices store encryption keys on hardware or software modules.</span></span> <span data-ttu-id="8acb7-110">É uma solução mais segura porque as chaves de criptografia não estão com dados de criptografia.</span><span class="sxs-lookup"><span data-stu-id="8acb7-110">This is a more secure solution because the encryption keys do not reside with encryption data.</span></span>  
  
 <span data-ttu-id="8acb7-111">Vários fornecedores oferecem HSM para gerenciamento de chave e aceleração de criptografia.</span><span class="sxs-lookup"><span data-stu-id="8acb7-111">A number of vendors offer HSM for both key management and encryption acceleration.</span></span> <span data-ttu-id="8acb7-112">Os dispositivos de HSM usam interfaces de hardware com um processo de servidor como um intermediário entre um aplicativo e um HSM.</span><span class="sxs-lookup"><span data-stu-id="8acb7-112">HSM devices use hardware interfaces with a server process as an intermediary between an application and an HSM.</span></span> <span data-ttu-id="8acb7-113">Os fornecedores também implementam provedores de MSCAPI nos seus módulos, que podem ser hardware ou software.</span><span class="sxs-lookup"><span data-stu-id="8acb7-113">Vendors also implement MSCAPI providers over their modules, which might be hardware or software.</span></span> <span data-ttu-id="8acb7-114">O MSCAPI oferece frequentemente só um subconjunto da funcionalidade que é oferecida por um HSM.</span><span class="sxs-lookup"><span data-stu-id="8acb7-114">MSCAPI often offers only a subset of the functionality that is offered by an HSM.</span></span> <span data-ttu-id="8acb7-115">Os fornecedores também podem prover software de gerenciamento para HSM, configuração fundamental e acesso fundamental.</span><span class="sxs-lookup"><span data-stu-id="8acb7-115">Vendors can also provide management software for HSM, key configuration, and key access.</span></span>  
  
 <span data-ttu-id="8acb7-116">As implementações HSM variam conforme o fornecedor e usá-los com o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] requer uma interface comum.</span><span class="sxs-lookup"><span data-stu-id="8acb7-116">HSM implementations vary from vendor to vendor, and to use them with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] requires a common interface.</span></span> <span data-ttu-id="8acb7-117">Embora o MSCAPI ofereça esta interface, ele dá suporte apenas a um subconjunto das características do HSM.</span><span class="sxs-lookup"><span data-stu-id="8acb7-117">Although the MSCAPI provides this interface, it supports only a subset of the HSM features.</span></span> <span data-ttu-id="8acb7-118">Também existem outras limitações, como incapacidade de persistir chaves simétricas, e uma falta de suporte orientado por sessão.</span><span class="sxs-lookup"><span data-stu-id="8acb7-118">It also has other limitations, such as the inability to natively persist symmetric keys, and a lack of session-oriented support.</span></span>  
  
 <span data-ttu-id="8acb7-119">O Gerenciador Extensível de Chaves [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] permite que os fornecedores do EKM/HSM de terceiros registrem os seus módulos no [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="8acb7-119">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Extensible Key Management enables third-party EKM/HSM vendors to register their modules in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="8acb7-120">Quando registrado, os usuários [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] podem usar as chaves de criptografia armazenadas em módulos EKM.</span><span class="sxs-lookup"><span data-stu-id="8acb7-120">When registered, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] users can use the encryption keys stored on EKM modules.</span></span> <span data-ttu-id="8acb7-121">Isso permite o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] acessar os recursos avançados de criptografia, esses módulos oferecem suporte à criptografia em massa e à descriptografia e, às funções de gerenciamento de chave, como envelhecimento de chave e rotação de chave.</span><span class="sxs-lookup"><span data-stu-id="8acb7-121">This enables [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] to access the advanced encryption features these modules support such as bulk encryption and decryption, and key management functions such as key aging and key rotation.</span></span>  
  
 <span data-ttu-id="8acb7-122">Ao executar o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] em uma VM do Azure, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] pode usar chaves armazenadas no [Cofre da Chave do Azure](https://go.microsoft.com/fwlink/?LinkId=521401).</span><span class="sxs-lookup"><span data-stu-id="8acb7-122">When running [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] in an Azure VM, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] can use keys stored in the [Azure Key Vault](https://go.microsoft.com/fwlink/?LinkId=521401).</span></span> <span data-ttu-id="8acb7-123">Para obter mais informações, veja [Gerenciamento extensível de chaves usando o Cofre de Chaves do Azure &#40;SQL Server&#41;](extensible-key-management-using-azure-key-vault-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="8acb7-123">For more information, see [Extensible Key Management Using Azure Key Vault &#40;SQL Server&#41;](extensible-key-management-using-azure-key-vault-sql-server.md).</span></span>  
  
## <a name="ekm-configuration"></a><span data-ttu-id="8acb7-124">Configuração de EKM</span><span class="sxs-lookup"><span data-stu-id="8acb7-124">EKM Configuration</span></span>  
 <span data-ttu-id="8acb7-125">O gerenciamento extensível de chaves não está disponível em todas as edições do [!INCLUDE[msCoName](../../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="8acb7-125">Extensible Key Management is not available in every edition of [!INCLUDE[msCoName](../../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="8acb7-126">Para obter uma lista de recursos com suporte nas edições do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], consulte [Features Supported by the Editions of SQL Server 2014](../../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md).</span><span class="sxs-lookup"><span data-stu-id="8acb7-126">For a list of features that are supported by the editions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], see [Features Supported by the Editions of SQL Server 2014](../../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md).</span></span>  
  
 <span data-ttu-id="8acb7-127">Por padrão, o Gerenciador Extensível de Chaves está desativado.</span><span class="sxs-lookup"><span data-stu-id="8acb7-127">By default, Extensible Key Management is off.</span></span> <span data-ttu-id="8acb7-128">Para habilitar esse recurso, use o comando sp_configure que tem a seguinte opção e valor, conforme o exemplo a seguir:</span><span class="sxs-lookup"><span data-stu-id="8acb7-128">To enable this feature, use the sp_configure command that has the following option and value, as in the following example:</span></span>  
  
```  
sp_configure 'show advanced', 1  
GO  
RECONFIGURE  
GO  
sp_configure 'EKM provider enabled', 1  
GO  
RECONFIGURE  
GO  
```  
  
> [!NOTE]  
>  <span data-ttu-id="8acb7-129">Se você usar o comando sp_configure para esta opção em edições do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] que não dão suporte a EKM, receberá um erro.</span><span class="sxs-lookup"><span data-stu-id="8acb7-129">If you use the sp_configure command for this option on editions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] that do not support EKM, you will receive an error.</span></span>  
  
 <span data-ttu-id="8acb7-130">Para desabilitar o recurso, defina o valor para **0**.</span><span class="sxs-lookup"><span data-stu-id="8acb7-130">To disable the feature, set the value to **0**.</span></span> <span data-ttu-id="8acb7-131">Para mais informações sobre como definir opções de servidor, veja [sp_configure &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-configure-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="8acb7-131">For more information about how to set server options, see [sp_configure &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-configure-transact-sql).</span></span>  
  
## <a name="how-to-use-ekm"></a><span data-ttu-id="8acb7-132">Como usar EKM</span><span class="sxs-lookup"><span data-stu-id="8acb7-132">How to Use EKM</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="8acb7-133">O Gerenciamento Extensível de Chaves permite que as chaves de criptografia protejam os arquivos de banco de dados a serem armazenados em um dispositivo pronto para uso, como um smartcard, dispositivo USB ou o módulo EKM/HSM.</span><span class="sxs-lookup"><span data-stu-id="8acb7-133">Extensible Key Management enables the encryption keys that protect the database files to be stored in an off-box device such as a smartcard, USB device, or EKM/HSM module.</span></span> <span data-ttu-id="8acb7-134">Isso também permite proteger os dados dos administradores de banco de dados (exceto dos membros do grupo sysadmin).</span><span class="sxs-lookup"><span data-stu-id="8acb7-134">This also enables data protection from database administrators (except members of the sysadmin group).</span></span> <span data-ttu-id="8acb7-135">Com o uso de chaves de criptografia, é possível criptografar dados aos quais somente o usuário do banco de dados tem acesso no módulo externo de EKM/HSM.</span><span class="sxs-lookup"><span data-stu-id="8acb7-135">Data can be encrypted by using encryption keys that only the database user has access to on the external EKM/HSM module.</span></span>  
  
 <span data-ttu-id="8acb7-136">O Gerenciador Extensível de Chaves também oferece os seguintes benefícios:</span><span class="sxs-lookup"><span data-stu-id="8acb7-136">Extensible Key Management also provides the following benefits:</span></span>  
  
-   <span data-ttu-id="8acb7-137">Verificação de autorização adicional (habilitando a separação de tarefas).</span><span class="sxs-lookup"><span data-stu-id="8acb7-137">Additional authorization check (enabling separation of duties).</span></span>  
  
-   <span data-ttu-id="8acb7-138">Alto desempenho de criptografia/descriptografia com base em hardware.</span><span class="sxs-lookup"><span data-stu-id="8acb7-138">Higher performance for hardware-based encryption/decryption.</span></span>  
  
-   <span data-ttu-id="8acb7-139">Geração de chave de criptografia externa.</span><span class="sxs-lookup"><span data-stu-id="8acb7-139">External encryption key generation.</span></span>  
  
-   <span data-ttu-id="8acb7-140">Armazenamento de chave de criptografia externa (separação física de dados e chaves).</span><span class="sxs-lookup"><span data-stu-id="8acb7-140">External encryption key storage (physical separation of data and keys).</span></span>  
  
-   <span data-ttu-id="8acb7-141">Recuperação de chave de criptografia.</span><span class="sxs-lookup"><span data-stu-id="8acb7-141">Encryption key retrieval.</span></span>  
  
-   <span data-ttu-id="8acb7-142">Retenção de chave de criptografia externa (habilita a rotação de chave de criptografia).</span><span class="sxs-lookup"><span data-stu-id="8acb7-142">External encryption key retention (enables encryption key rotation).</span></span>  
  
-   <span data-ttu-id="8acb7-143">Recuperação mais fácil da chave de criptografia.</span><span class="sxs-lookup"><span data-stu-id="8acb7-143">Easier encryption key recovery.</span></span>  
  
-   <span data-ttu-id="8acb7-144">Distribuição de chave de criptografia manejável.</span><span class="sxs-lookup"><span data-stu-id="8acb7-144">Manageable encryption key distribution.</span></span>  
  
-   <span data-ttu-id="8acb7-145">Disposição segura de chave de criptografia.</span><span class="sxs-lookup"><span data-stu-id="8acb7-145">Secure encryption key disposal.</span></span>  
  
 <span data-ttu-id="8acb7-146">Você pode usar o Gerenciamento Extensível de Chaves para uma combinação de nome de usuário e senha ou outros métodos definidos pelo driver de EKM.</span><span class="sxs-lookup"><span data-stu-id="8acb7-146">You can use Extensible Key Management for a username and password combination or other methods defined by the EKM driver.</span></span>  
  
> [!CAUTION]  
>  <span data-ttu-id="8acb7-147">Para solução de problemas, o suporte técnico do [!INCLUDE[msCoName](../../../includes/msconame-md.md)] poderá solicitar a chave de criptografia do provedor EKM.</span><span class="sxs-lookup"><span data-stu-id="8acb7-147">For troubleshooting, [!INCLUDE[msCoName](../../../includes/msconame-md.md)] technical support might require the encryption key from the EKM provider.</span></span> <span data-ttu-id="8acb7-148">Talvez seja necessário acessar os processos ou as ferramentas do fornecedor para ajudar a resolver um problema.</span><span class="sxs-lookup"><span data-stu-id="8acb7-148">You might also need to access vendor tools or processes to help resolve an issue.</span></span>  
  
### <a name="authentication-with-an-ekm-device"></a><span data-ttu-id="8acb7-149">Autenticação com um dispositivo EKM</span><span class="sxs-lookup"><span data-stu-id="8acb7-149">Authentication with an EKM Device</span></span>  
 <span data-ttu-id="8acb7-150">Um módulo EKM pode oferecer suporte para mais de um tipo de autenticação.</span><span class="sxs-lookup"><span data-stu-id="8acb7-150">An EKM module can support more than one type of authentication.</span></span> <span data-ttu-id="8acb7-151">Cada provedor mostra apenas um tipo de autenticação para o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], isto é, se o módulo oferecer suporte aos tipos de autenticação Básica ou a outros, ele mostrará um ou outro, mas não os dois.</span><span class="sxs-lookup"><span data-stu-id="8acb7-151">Each provider exposes only one type of authentication to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], that is if the module supports Basic or Other authentication types, it exposes one or the other, but not both.</span></span>  
  
#### <a name="ekm-device-specific-basic-authentication-using-usernamepassword"></a><span data-ttu-id="8acb7-152">Nome do usuário/senha de Autenticação Básica Específica do Dispositivo EKM</span><span class="sxs-lookup"><span data-stu-id="8acb7-152">EKM Device-Specific Basic Authentication Using username/password</span></span>  
 <span data-ttu-id="8acb7-153">Para esses módulos EKM que dão suporte à autenticação Básica usando um par *nome de usuário/senha* , o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] fornece autenticação transparente que usa credenciais.</span><span class="sxs-lookup"><span data-stu-id="8acb7-153">For those EKM modules that support Basic authentication using a *username/password* pair, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] provides transparent authentication using credentials.</span></span> <span data-ttu-id="8acb7-154">Para mais informações sobre credenciais, consulte [Credenciais &#40;Mecanismo de Banco de Dados&#41;](../authentication-access/credentials-database-engine.md).</span><span class="sxs-lookup"><span data-stu-id="8acb7-154">For more information about credentials, see [Credentials &#40;Database Engine&#41;](../authentication-access/credentials-database-engine.md).</span></span>  
  
 <span data-ttu-id="8acb7-155">É possível criar uma credencial para um provedor EKM e mapear (ambas as contas do Windows e do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ) para acessar um módulo EKM por logon.</span><span class="sxs-lookup"><span data-stu-id="8acb7-155">A credential can be created for an EKM provider and mapped to a login (both Windows and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] accounts) to access an EKM module on per-login basis.</span></span> <span data-ttu-id="8acb7-156">O campo da credencial *Identify* contém o nome do usuário; o campo *secret* contém uma senha para conectar a um módulo de EKM.</span><span class="sxs-lookup"><span data-stu-id="8acb7-156">The *Identify* field of the credential contains the username; the *secret* field contains a password to connect to an EKM module.</span></span>  
  
 <span data-ttu-id="8acb7-157">Se não houver nenhuma credencial mapeada de logon para o provedor EKM, a credencial mapeada para conta de serviço [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] será usada.</span><span class="sxs-lookup"><span data-stu-id="8acb7-157">If there is no login mapped credential for the EKM provider, the credential mapped to the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] service account is used.</span></span>  
  
 <span data-ttu-id="8acb7-158">Um logon pode ter várias credenciais mapeadas para isto, contanto que elas sejam usadas para provedores de EKM diferentes.</span><span class="sxs-lookup"><span data-stu-id="8acb7-158">A login can have multiple credentials mapped to it, as long as they are used for distinctive EKM providers.</span></span> <span data-ttu-id="8acb7-159">Deve haver só uma credencial mapeada por provedor de EKM por logon.</span><span class="sxs-lookup"><span data-stu-id="8acb7-159">There must be only one mapped credential per EKM provider per login.</span></span> <span data-ttu-id="8acb7-160">A mesma credencial pode ser mapeada para outros logons.</span><span class="sxs-lookup"><span data-stu-id="8acb7-160">The same credential can be mapped to other logins.</span></span>  
  
#### <a name="other-types-of-ekm-device-specific-authentication"></a><span data-ttu-id="8acb7-161">Outros tipos de autenticação de dispositivo específico EKM</span><span class="sxs-lookup"><span data-stu-id="8acb7-161">Other Types of EKM Device-Specific Authentication</span></span>  
 <span data-ttu-id="8acb7-162">Para os módulos EKM que tenham autenticação diferente do Windows ou combinações de *usuário/senha* , a autenticação deve ser executada independentemente do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="8acb7-162">For EKM modules that have authentication other than Windows or *user/password* combinations, authentication must be performed independently from [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
### <a name="encryption-and-decryption-by-an-ekm-device"></a><span data-ttu-id="8acb7-163">Criptografia e decodificação por um dispositivo EKM</span><span class="sxs-lookup"><span data-stu-id="8acb7-163">Encryption and Decryption by an EKM Device</span></span>  
 <span data-ttu-id="8acb7-164">É possível usar as seguintes funções e características para criptografar e descriptografar dados, usando chaves simétricas e assimétricas:</span><span class="sxs-lookup"><span data-stu-id="8acb7-164">You can use the following functions and features to encrypt and decrypt data by using symmetric and asymmetric keys:</span></span>  
  
|<span data-ttu-id="8acb7-165">Função ou recurso</span><span class="sxs-lookup"><span data-stu-id="8acb7-165">Function or feature</span></span>|<span data-ttu-id="8acb7-166">Referência</span><span class="sxs-lookup"><span data-stu-id="8acb7-166">Reference</span></span>|  
|-------------------------|---------------|  
|<span data-ttu-id="8acb7-167">Criptografia de chave simétrica</span><span class="sxs-lookup"><span data-stu-id="8acb7-167">Symmetric key encryption</span></span>|[<span data-ttu-id="8acb7-168">CREATE SYMMETRIC KEY &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="8acb7-168">CREATE SYMMETRIC KEY &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/create-symmetric-key-transact-sql)|  
|<span data-ttu-id="8acb7-169">Criptografia de chave assimétrica</span><span class="sxs-lookup"><span data-stu-id="8acb7-169">Asymmetric Key encryption</span></span>|[<span data-ttu-id="8acb7-170">CREATE ASYMMETRIC KEY &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="8acb7-170">CREATE ASYMMETRIC KEY &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/create-asymmetric-key-transact-sql)|  
|<span data-ttu-id="8acb7-171">EncryptByKey(key_guid, 'cleartext', ...)</span><span class="sxs-lookup"><span data-stu-id="8acb7-171">EncryptByKey(key_guid, 'cleartext', ...)</span></span>|[<span data-ttu-id="8acb7-172">ENCRYPTBYKEY &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="8acb7-172">ENCRYPTBYKEY &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/functions/encryptbykey-transact-sql)|  
|<span data-ttu-id="8acb7-173">DecryptByKey(ciphertext, ...)</span><span class="sxs-lookup"><span data-stu-id="8acb7-173">DecryptByKey(ciphertext, ...)</span></span>|[<span data-ttu-id="8acb7-174">DECRYPTBYKEY &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="8acb7-174">DECRYPTBYKEY &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/functions/decryptbykey-transact-sql)|  
|<span data-ttu-id="8acb7-175">EncryptByAsmKey(key_guid, 'cleartext')</span><span class="sxs-lookup"><span data-stu-id="8acb7-175">EncryptByAsmKey(key_guid, 'cleartext')</span></span>|[<span data-ttu-id="8acb7-176">ENCRYPTBYASYMKEY &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="8acb7-176">ENCRYPTBYASYMKEY &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/functions/encryptbyasymkey-transact-sql)|  
|<span data-ttu-id="8acb7-177">DecryptByAsmKey(ciphertext)</span><span class="sxs-lookup"><span data-stu-id="8acb7-177">DecryptByAsmKey(ciphertext)</span></span>|[<span data-ttu-id="8acb7-178">DECRYPTBYASYMKEY &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="8acb7-178">DECRYPTBYASYMKEY &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/functions/decryptbyasymkey-transact-sql)|  
  
#### <a name="database-keys-encryption-by-ekm-keys"></a><span data-ttu-id="8acb7-179">Criptografia das chaves do banco de dados pelas chaves EKM</span><span class="sxs-lookup"><span data-stu-id="8acb7-179">Database Keys Encryption by EKM Keys</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="8acb7-180">pode usar as chaves EKM para criptografar outras chaves em um banco de dados.</span><span class="sxs-lookup"><span data-stu-id="8acb7-180">can use EKM keys to encrypt other keys in a database.</span></span> <span data-ttu-id="8acb7-181">É possível criar e usar chaves simétricas e assimétricas em um dispositivo de EKM.</span><span class="sxs-lookup"><span data-stu-id="8acb7-181">You can create and use both symmetric and asymmetric keys on an EKM device.</span></span> <span data-ttu-id="8acb7-182">Você pode criptografar chaves simétricas nativas (diferente de EKM) com chaves assimétricas do EKM.</span><span class="sxs-lookup"><span data-stu-id="8acb7-182">You can encrypt native (non-EKM) symmetric keys with EKM asymmetric keys.</span></span>  
  
 <span data-ttu-id="8acb7-183">O exemplo a seguir cria uma chave simétrica de banco de dados e criptografa a chave, usando uma chave em um módulo EKM.</span><span class="sxs-lookup"><span data-stu-id="8acb7-183">The following example creates a database symmetric key and encrypts it using a key on an EKM module.</span></span>  
  
```  
CREATE SYMMETRIC KEY Key1  
WITH ALGORITHM = AES_256  
ENCRYPTION BY EKM_AKey1;  
GO  
--Open database key  
OPEN SYMMETRIC KEY Key1  
DECRYPTION BY EKM_AKey1  
```  
  
 <span data-ttu-id="8acb7-184">Para mais informações sobre o Banco de Dados e as Chaves de Servidor no [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], consulte [Chaves de criptografia do SQL Server e banco de dados &#40;Mecanismo de Banco de Dados&#41;](sql-server-and-database-encryption-keys-database-engine.md).</span><span class="sxs-lookup"><span data-stu-id="8acb7-184">For more information about Database and Server Keys in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], see [SQL Server and Database Encryption Keys &#40;Database Engine&#41;](sql-server-and-database-encryption-keys-database-engine.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="8acb7-185">Não é possível criptografar uma chave EKM com outra chave EKM.</span><span class="sxs-lookup"><span data-stu-id="8acb7-185">You cannot encrypt one EKM key with another EKM key.</span></span>  
>   
>  [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="8acb7-186">não dá suporte para assinar módulos com chaves assimétricas geradas a partir do provedor EKM.</span><span class="sxs-lookup"><span data-stu-id="8acb7-186">does not support signing modules with asymmetric keys generated from EKM provider.</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="8acb7-187">Related Tasks</span><span class="sxs-lookup"><span data-stu-id="8acb7-187">Related Tasks</span></span>  
 [<span data-ttu-id="8acb7-188">Opção de configuração de servidor EKM provider enabled</span><span class="sxs-lookup"><span data-stu-id="8acb7-188">EKM provider enabled Server Configuration Option</span></span>](../../../database-engine/configure-windows/ekm-provider-enabled-server-configuration-option.md)  
  
 [<span data-ttu-id="8acb7-189">Habilitar TDE usando EKM</span><span class="sxs-lookup"><span data-stu-id="8acb7-189">Enable TDE Using EKM</span></span>](enable-tde-on-sql-server-using-ekm.md)  
  
 [<span data-ttu-id="8acb7-190">Gerenciamento extensível de chaves usando o Cofre de Chaves do Azure &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="8acb7-190">Extensible Key Management Using Azure Key Vault &#40;SQL Server&#41;</span></span>](extensible-key-management-using-azure-key-vault-sql-server.md)  
  
## <a name="see-also"></a><span data-ttu-id="8acb7-191">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="8acb7-191">See Also</span></span>  
 <span data-ttu-id="8acb7-192">[CREATE CRYPTOGRAPHIC PROVIDER &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-cryptographic-provider-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="8acb7-192">[CREATE CRYPTOGRAPHIC PROVIDER &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-cryptographic-provider-transact-sql) </span></span>  
 <span data-ttu-id="8acb7-193">[DROP CRYPTOGRAPHIC PROVIDER &#40;Transact-SQL&#41;](/sql/t-sql/statements/drop-cryptographic-provider-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="8acb7-193">[DROP CRYPTOGRAPHIC PROVIDER &#40;Transact-SQL&#41;](/sql/t-sql/statements/drop-cryptographic-provider-transact-sql) </span></span>  
 <span data-ttu-id="8acb7-194">[ALTER CRYPTOGRAPHIC PROVIDER &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-cryptographic-provider-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="8acb7-194">[ALTER CRYPTOGRAPHIC PROVIDER &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-cryptographic-provider-transact-sql) </span></span>  
 <span data-ttu-id="8acb7-195">[sys.cryptographic_providers &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/sys-cryptographic-providers-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="8acb7-195">[sys.cryptographic_providers &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/sys-cryptographic-providers-transact-sql) </span></span>  
 <span data-ttu-id="8acb7-196">[sys.dm_cryptographic_provider_sessions &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-cryptographic-provider-sessions-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="8acb7-196">[sys.dm_cryptographic_provider_sessions &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-cryptographic-provider-sessions-transact-sql) </span></span>  
 <span data-ttu-id="8acb7-197">[sys.dm_cryptographic_provider_properties &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-cryptographic-provider-properties-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="8acb7-197">[sys.dm_cryptographic_provider_properties &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-cryptographic-provider-properties-transact-sql) </span></span>  
 <span data-ttu-id="8acb7-198">[sys.dm_cryptographic_provider_algorithms &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-cryptographic-provider-algorithms-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="8acb7-198">[sys.dm_cryptographic_provider_algorithms &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-cryptographic-provider-algorithms-transact-sql) </span></span>  
 <span data-ttu-id="8acb7-199">[sys.dm_cryptographic_provider_keys &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-cryptographic-provider-keys-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="8acb7-199">[sys.dm_cryptographic_provider_keys &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-cryptographic-provider-keys-transact-sql) </span></span>  
 <span data-ttu-id="8acb7-200">[sys.credentials &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/sys-credentials-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="8acb7-200">[sys.credentials &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/sys-credentials-transact-sql) </span></span>  
 <span data-ttu-id="8acb7-201">[CREATE CREDENTIAL &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-credential-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="8acb7-201">[CREATE CREDENTIAL &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-credential-transact-sql) </span></span>  
 <span data-ttu-id="8acb7-202">[ALTER LOGIN &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-login-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="8acb7-202">[ALTER LOGIN &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-login-transact-sql) </span></span>  
 <span data-ttu-id="8acb7-203">[CREATE ASYMMETRIC KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-asymmetric-key-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="8acb7-203">[CREATE ASYMMETRIC KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-asymmetric-key-transact-sql) </span></span>  
 <span data-ttu-id="8acb7-204">[ALTER ASYMMETRIC KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-asymmetric-key-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="8acb7-204">[ALTER ASYMMETRIC KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-asymmetric-key-transact-sql) </span></span>  
 <span data-ttu-id="8acb7-205">[DROP ASYMMETRIC KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/drop-asymmetric-key-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="8acb7-205">[DROP ASYMMETRIC KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/drop-asymmetric-key-transact-sql) </span></span>  
 <span data-ttu-id="8acb7-206">[CREATE SYMMETRIC KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-symmetric-key-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="8acb7-206">[CREATE SYMMETRIC KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-symmetric-key-transact-sql) </span></span>  
 <span data-ttu-id="8acb7-207">[ALTER SYMMETRIC KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-symmetric-key-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="8acb7-207">[ALTER SYMMETRIC KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-symmetric-key-transact-sql) </span></span>  
 <span data-ttu-id="8acb7-208">[DROP SYMMETRIC KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/drop-symmetric-key-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="8acb7-208">[DROP SYMMETRIC KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/drop-symmetric-key-transact-sql) </span></span>  
 <span data-ttu-id="8acb7-209">[OPEN SYMMETRIC KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/open-symmetric-key-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="8acb7-209">[OPEN SYMMETRIC KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/open-symmetric-key-transact-sql) </span></span>  
 <span data-ttu-id="8acb7-210">[Fazer backup e restaurar as chave de criptografia do Reporting Services](../../../reporting-services/install-windows/ssrs-encryption-keys-back-up-and-restore-encryption-keys.md) </span><span class="sxs-lookup"><span data-stu-id="8acb7-210">[Back Up and Restore Reporting Services Encryption Keys](../../../reporting-services/install-windows/ssrs-encryption-keys-back-up-and-restore-encryption-keys.md) </span></span>  
 <span data-ttu-id="8acb7-211">[Excluir e recriar chaves de criptografia &#40;SSRS Configuration Manager&#41;](../../../reporting-services/install-windows/ssrs-encryption-keys-delete-and-re-create-encryption-keys.md) </span><span class="sxs-lookup"><span data-stu-id="8acb7-211">[Delete and Re-create Encryption Keys  &#40;SSRS Configuration Manager&#41;](../../../reporting-services/install-windows/ssrs-encryption-keys-delete-and-re-create-encryption-keys.md) </span></span>  
 <span data-ttu-id="8acb7-212">[Adicionar e remover chaves de criptografia para implantação escalável &#40;Gerenciador de Configurações do SSRS&#41;](../../../reporting-services/install-windows/add-and-remove-encryption-keys-for-scale-out-deployment.md) </span><span class="sxs-lookup"><span data-stu-id="8acb7-212">[Add and Remove Encryption Keys for Scale-Out Deployment &#40;SSRS Configuration Manager&#41;](../../../reporting-services/install-windows/add-and-remove-encryption-keys-for-scale-out-deployment.md) </span></span>  
 <span data-ttu-id="8acb7-213">[Fazer backup da chave mestra de serviço](service-master-key.md) </span><span class="sxs-lookup"><span data-stu-id="8acb7-213">[Back Up the Service Master Key](service-master-key.md) </span></span>  
 <span data-ttu-id="8acb7-214">[Restaurar a chave mestra de serviço](restore-the-service-master-key.md) </span><span class="sxs-lookup"><span data-stu-id="8acb7-214">[Restore the Service Master Key](restore-the-service-master-key.md) </span></span>  
 <span data-ttu-id="8acb7-215">[Criar uma chave mestra de banco de dados](create-a-database-master-key.md) </span><span class="sxs-lookup"><span data-stu-id="8acb7-215">[Create a Database Master Key](create-a-database-master-key.md) </span></span>  
 <span data-ttu-id="8acb7-216">[Fazer backup da chave mestra de um banco de dados](back-up-a-database-master-key.md) </span><span class="sxs-lookup"><span data-stu-id="8acb7-216">[Back Up a Database Master Key](back-up-a-database-master-key.md) </span></span>  
 <span data-ttu-id="8acb7-217">[Restaurar uma chave mestra de banco de dados](restore-a-database-master-key.md) </span><span class="sxs-lookup"><span data-stu-id="8acb7-217">[Restore a Database Master Key](restore-a-database-master-key.md) </span></span>  
 [<span data-ttu-id="8acb7-218">Criar chaves simétricas idênticas em dois servidores</span><span class="sxs-lookup"><span data-stu-id="8acb7-218">Create Identical Symmetric Keys on Two Servers</span></span>](create-identical-symmetric-keys-on-two-servers.md)  
  
  
