---
title: Auditoria do SQL Server (Mecanismo de Banco de Dados) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: security
ms.topic: conceptual
f1_keywords:
- audit
helpviewer_keywords:
- SQL Server Audit
- audits [SQL Server], SQL Server Audit
ms.assetid: 0c1fca2e-f22b-4fe8-806f-c87806664f00
author: VanMSFT
ms.author: vanto
ms.openlocfilehash: 2f4f291e5dc4aaa8a240757713cc65bd2a6a8230
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87570576"
---
# <a name="sql-server-audit-database-engine"></a><span data-ttu-id="6c4ac-102">Auditoria do SQL Server (Mecanismo de Banco de Dados)</span><span class="sxs-lookup"><span data-stu-id="6c4ac-102">SQL Server Audit (Database Engine)</span></span>
  <span data-ttu-id="6c4ac-103">A*auditoria* de uma instância do [!INCLUDE[ssDEnoversion](../../../includes/ssdenoversion-md.md)] ou de um banco de dados individual envolve o controle e o registro em log dos eventos que ocorrem no [!INCLUDE[ssDE](../../../includes/ssde-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6c4ac-103">*Auditing* an instance of the [!INCLUDE[ssDEnoversion](../../../includes/ssdenoversion-md.md)] or an individual database involves tracking and logging events that occur on the [!INCLUDE[ssDE](../../../includes/ssde-md.md)].</span></span> <span data-ttu-id="6c4ac-104">A auditoria do[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] permite criar auditorias de servidor, que podem conter especificações de auditoria de servidor para eventos no nível de servidor, além de especificações de auditoria de banco de dados para eventos no nível de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-104">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit lets you create server audits, which can contain server audit specifications for server level events, and database audit specifications for database level events.</span></span> <span data-ttu-id="6c4ac-105">Os eventos auditados podem ser gravados nos logs de eventos ou nos arquivos de auditoria.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-105">Audited events can be written to the event logs or to audit files.</span></span>  
  
 <span data-ttu-id="6c4ac-106">Dependendo dos requisitos ou padrões governamentais de sua instalação, ha vários níveis de auditoria no [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6c4ac-106">There are several levels of auditing for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], depending on government or standards requirements for your installation.</span></span> <span data-ttu-id="6c4ac-107">A auditoria do[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] fornece as ferramentas e os processos necessários para habilitar, armazenar e exibir auditorias em vários objetos de servidor e de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-107">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Audit provides the tools and processes you must have to enable, store, and view audits on various server and database objects.</span></span>  
  
 <span data-ttu-id="6c4ac-108">É possível gravar grupos de ação de auditoria de servidor por instância, e grupos de ação de auditoria de banco de dados ou ações de auditoria de banco de dados por banco de dados.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-108">You can record server audit action groups per-instance, and either database audit action groups or database audit actions per database.</span></span> <span data-ttu-id="6c4ac-109">O evento de auditoria ocorrerá sempre que a ação auditável for encontrada.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-109">The audit event will occur every time that the auditable action is encountered.</span></span>  
  
 <span data-ttu-id="6c4ac-110">Todas as edições do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] oferecem suporte a auditorias no nível do servidor.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-110">All editions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] support server level audits.</span></span> <span data-ttu-id="6c4ac-111">As auditorias no nível de banco de dados são limitadas às edições Enterprise, Developer e Evaluation.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-111">Database level auditing is limited to Enterprise, Developer, and Evaluation editions.</span></span> <span data-ttu-id="6c4ac-112">Para obter mais informações, consulte [recursos com suporte nas edições do SQL Server 2014](../../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md).</span><span class="sxs-lookup"><span data-stu-id="6c4ac-112">For more information, see [Features Supported by the Editions of SQL Server 2014](../../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md).</span></span>  
  
## <a name="sql-server-audit-components"></a><span data-ttu-id="6c4ac-113">Componentes de auditoria do SQL Server</span><span class="sxs-lookup"><span data-stu-id="6c4ac-113">SQL Server Audit Components</span></span>  
 <span data-ttu-id="6c4ac-114">*Auditoria* é a combinação de vários elementos em um único pacote de um grupo específico de ações de servidor ou de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-114">An *audit* is the combination of several elements into a single package for a specific group of server actions or database actions.</span></span> <span data-ttu-id="6c4ac-115">Os componentes de auditoria do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] são combinados para produzir uma saída conhecida como auditoria, da mesma forma como uma definição de relatório combinada com elementos gráficos e de dados produz um relatório.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-115">The components of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit combine to produce an output that is called an audit, just as a report definition combined with graphics and data elements produces a report.</span></span>  
  
 <span data-ttu-id="6c4ac-116">A auditoria do[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] usa *Eventos Estendidos* para ajudar a criar uma auditoria.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-116">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit uses *Extended Events* to help create an audit.</span></span> <span data-ttu-id="6c4ac-117">Para obter mais informações sobre Eventos Estendidos, consulte [Eventos Estendidos](../../extended-events/extended-events.md).</span><span class="sxs-lookup"><span data-stu-id="6c4ac-117">For more information about Extended Events, see [Extended Events](../../extended-events/extended-events.md).</span></span>  
  
### <a name="sql-server-audit"></a><span data-ttu-id="6c4ac-118">Auditoria do SQL Server</span><span class="sxs-lookup"><span data-stu-id="6c4ac-118">SQL Server Audit</span></span>  
 <span data-ttu-id="6c4ac-119">O objeto *Auditoria do SQL Server* coleta uma instância única de ações no nível do servidor e/ou do banco de dados e grupos de ações a serem monitoradas.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-119">The *SQL Server Audit* object collects a single instance of server or database-level actions and groups of actions to monitor.</span></span> <span data-ttu-id="6c4ac-120">A auditoria está no nível de instância do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="6c4ac-120">The audit is at the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance level.</span></span> <span data-ttu-id="6c4ac-121">Você pode ter várias auditorias por instância do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="6c4ac-121">You can have multiple audits per [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance.</span></span>  
  
 <span data-ttu-id="6c4ac-122">Ao definir uma auditoria, especifique o local de saída dos resultados.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-122">When you define an audit, you specify the location for the output of the results.</span></span> <span data-ttu-id="6c4ac-123">Esse é o destino da auditoria.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-123">This is the audit destination.</span></span> <span data-ttu-id="6c4ac-124">A auditoria é criada em um estado *desabilitado* e não audita automaticamente nenhuma ação.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-124">The audit is created in a *disabled* state, and does not automatically audit any actions.</span></span> <span data-ttu-id="6c4ac-125">Após a habilitação da auditoria, o destino da auditoria recebe dados da auditoria.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-125">After the audit is enabled, the audit destination receives data from the audit.</span></span>  
  
### <a name="server-audit-specification"></a><span data-ttu-id="6c4ac-126">Especificação da Auditoria do Servidor</span><span class="sxs-lookup"><span data-stu-id="6c4ac-126">Server Audit Specification</span></span>  
 <span data-ttu-id="6c4ac-127">O objeto *Especificação da Auditoria do Servidor* pertence a uma auditoria.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-127">The *Server Audit Specification* object belongs to an audit.</span></span> <span data-ttu-id="6c4ac-128">É possível criar uma especificação de auditoria de servidor por auditoria, já que ambas são criadas no escopo da instância do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="6c4ac-128">You can create one server audit specification per audit, because both are created at the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance scope.</span></span>  
  
 <span data-ttu-id="6c4ac-129">A especificação da auditoria do servidor coleta muitos grupos de ação no nível do servidor gerados pelo recurso Eventos Estendidos.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-129">The server audit specification collects many server-level action groups raised by the Extended Events feature.</span></span> <span data-ttu-id="6c4ac-130">É possível incluir *grupos de ação de auditoria* em uma especificação da auditoria do servidor.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-130">You can include *audit action groups* in a server audit specification.</span></span> <span data-ttu-id="6c4ac-131">Os grupos de ação de auditoria são grupos de ações predefinidos, que são eventos atômicos que ocorrem no [!INCLUDE[ssDE](../../../includes/ssde-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6c4ac-131">Audit action groups are predefined groups of actions, which are atomic events occurring in the [!INCLUDE[ssDE](../../../includes/ssde-md.md)].</span></span> <span data-ttu-id="6c4ac-132">Essas ações são enviadas à auditoria, que por sua vez os registra no destino.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-132">These actions are sent to the audit, which records them in the target.</span></span>  
  
 <span data-ttu-id="6c4ac-133">Grupos de ação de auditoria no nível do servidor são descritos no tópico [Ações e grupos de ações de auditoria do SQL Server](sql-server-audit-action-groups-and-actions.md).</span><span class="sxs-lookup"><span data-stu-id="6c4ac-133">Server-level audit action groups are described in the topic [SQL Server Audit Action Groups and Actions](sql-server-audit-action-groups-and-actions.md).</span></span>  
  
### <a name="database-audit-specification"></a><span data-ttu-id="6c4ac-134">Especificação da Auditoria do Banco de Dados</span><span class="sxs-lookup"><span data-stu-id="6c4ac-134">Database Audit Specification</span></span>  
 <span data-ttu-id="6c4ac-135">O objeto *Especificação da Auditoria do Banco de Dados* também pertence à auditoria do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="6c4ac-135">The *Database Audit Specification* object also belongs to a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit.</span></span> <span data-ttu-id="6c4ac-136">É possível criar uma especificação da auditoria do banco de Dados por banco de dados do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] por auditoria.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-136">You can create one database audit specification per [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database per audit.</span></span>  
  
 <span data-ttu-id="6c4ac-137">Uma especificação da auditoria do banco de dados coleciona ações de auditoria no nível do banco de dados geradas pelo recurso Eventos Estendidos.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-137">The database audit specification collects database-level audit actions raised by the Extended Events feature.</span></span> <span data-ttu-id="6c4ac-138">É possível adicionar grupos de ações de auditoria ou de eventos de auditoria a uma especificação da auditoria do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-138">You can add either audit action groups or audit events to a database audit specification.</span></span> <span data-ttu-id="6c4ac-139">*Eventos de auditoria* são ações atômicas que podem ser examinadas pelo mecanismo do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="6c4ac-139">*Audit events* are the atomic actions that can be audited by the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] engine.</span></span> <span data-ttu-id="6c4ac-140">*Grupos de ação de auditoria* são grupos de ações predefinidos.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-140">*Audit action groups* are predefined groups of actions.</span></span> <span data-ttu-id="6c4ac-141">Ambos estão no escopo do banco de dados do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="6c4ac-141">Both are at the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database scope.</span></span> <span data-ttu-id="6c4ac-142">Essas ações são enviadas à auditoria, que por sua vez os registra no destino.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-142">These actions are sent to the audit, which records them in the target.</span></span> <span data-ttu-id="6c4ac-143">Não inclua objetos do escopo de servidor, como as exibições do sistema, em uma especificação de auditoria de banco de dados do usuário.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-143">Do not include server-scoped objects, such as the system views, in a user database audit specification.</span></span>  
  
 <span data-ttu-id="6c4ac-144">Grupos de ação de auditoria no nível do banco de dados e ações de auditoria são descritos no tópico [Ações e grupos de ações de auditoria do SQL Server](sql-server-audit-action-groups-and-actions.md).</span><span class="sxs-lookup"><span data-stu-id="6c4ac-144">Database-level audit action groups and audit actions are described in the topic [SQL Server Audit Action Groups and Actions](sql-server-audit-action-groups-and-actions.md).</span></span>  
  
### <a name="target"></a><span data-ttu-id="6c4ac-145">Destino</span><span class="sxs-lookup"><span data-stu-id="6c4ac-145">Target</span></span>  
 <span data-ttu-id="6c4ac-146">Os resultados de uma auditoria são enviados a um destino que pode ser um arquivo, o log de eventos de Segurança do Windows ou o log de eventos de Aplicativo do Windows.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-146">The results of an audit are sent to a target, which can be a file, the Windows Security event log, or the Windows Application event log.</span></span> <span data-ttu-id="6c4ac-147">É necessário verificar e arquivar os logs periodicamente para certificar-se de que o destino tenha espaço suficiente para gravar mais registros.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-147">Logs must be reviewed and archived periodically to make sure that the target has sufficient space to write additional records.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="6c4ac-148">Qualquer usuário autenticado pode fazer a leitura ou gravação no log de eventos de Aplicativo do Windows.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-148">Any authenticated user can read and write to the Windows Application event log.</span></span> <span data-ttu-id="6c4ac-149">O log de eventos de Aplicativo requer menos permissões que o log de eventos de Segurança do Windows e é menos seguro.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-149">The Application event log requires lower permissions than the Windows Security event log and is less secure than the Windows Security event log.</span></span>  
  
 <span data-ttu-id="6c4ac-150">Gravar no log de Segurança do Windows exige que a conta de serviço do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] seja adicionada à política **Gerar auditorias de segurança** .</span><span class="sxs-lookup"><span data-stu-id="6c4ac-150">Writing to the Windows Security log requires the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] service account to be added to the **Generate security audits** policy.</span></span> <span data-ttu-id="6c4ac-151">Por padrão, Sistema Local, Serviço Local e Serviço de Rede fazem parte dessa política.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-151">By default, the Local System, Local Service, and Network Service are part of this policy.</span></span> <span data-ttu-id="6c4ac-152">Esta configuração pode ser definida com o uso do snap-in de política de segurança (secpol.msc).</span><span class="sxs-lookup"><span data-stu-id="6c4ac-152">This setting can be configured by using the security policy snap-in (secpol.msc).</span></span> <span data-ttu-id="6c4ac-153">Além disso, é necessário habilitar a política de segurança **Auditar acesso ao objeto** para **Êxito** e **Falha**.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-153">Additionally, the **Audit object access** security policy must be enabled for both **Success** and **Failure**.</span></span> <span data-ttu-id="6c4ac-154">Esta configuração pode ser definida com o uso do snap-in de política de segurança (secpol.msc).</span><span class="sxs-lookup"><span data-stu-id="6c4ac-154">This setting can be configured by using the security policy snap-in (secpol.msc).</span></span> <span data-ttu-id="6c4ac-155">No [!INCLUDE[wiprlhext](../../../includes/wiprlhext-md.md)] ou no Windows Server 2008, você pode definir a política **gerada** mais detalhada do aplicativo na linha de comando usando o programa de política de auditoria ( `AuditPol.exe)` .</span><span class="sxs-lookup"><span data-stu-id="6c4ac-155">In [!INCLUDE[wiprlhext](../../../includes/wiprlhext-md.md)] or Windows Server 2008, you can set the more granular **application generated** policy from the command line by using the audit policy program (`AuditPol.exe)`.</span></span> <span data-ttu-id="6c4ac-156">Para obter mais informações sobre as etapas para habilitar a gravação no log de Segurança do Windows, consulte [Gravar eventos de auditoria do SQL Server no log de segurança](write-sql-server-audit-events-to-the-security-log.md).</span><span class="sxs-lookup"><span data-stu-id="6c4ac-156">For more information about the steps to enable writing to the Windows Security log, see [Write SQL Server Audit Events to the Security Log](write-sql-server-audit-events-to-the-security-log.md).</span></span> <span data-ttu-id="6c4ac-157">Para obter mais informações sobre o programa Auditpol.exe, consulte o artigo 921469 [How to use Group Policy to configure detailed security auditing](https://support.microsoft.com/kb/921469/)da Base de Dados de Conhecimento.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-157">For more information about the Auditpol.exe program, see Knowledge Base article 921469, [How to use Group Policy to configure detailed security auditing](https://support.microsoft.com/kb/921469/).</span></span> <span data-ttu-id="6c4ac-158">Os logs de eventos do Windows são globais ao sistema operacional Windows.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-158">The Windows event logs are global to the Windows operating system.</span></span> <span data-ttu-id="6c4ac-159">Para obter mais informações sobre os logs de eventos do Windows, consulte [Event Viewer Overview](https://go.microsoft.com/fwlink/?LinkId=101455).</span><span class="sxs-lookup"><span data-stu-id="6c4ac-159">For more information about the Windows event logs, see [Event Viewer Overview](https://go.microsoft.com/fwlink/?LinkId=101455).</span></span> <span data-ttu-id="6c4ac-160">Se você precisar de permissões mais exatas na auditoria, use o destino de arquivo binário.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-160">If you need more precise permissions on the audit, use the binary file target.</span></span>  
  
 <span data-ttu-id="6c4ac-161">Quando você está salvando informações de auditoria em um arquivo, para ajudar a impedir falsificação, você pode restringir o acesso ao local do arquivo das seguintes maneiras:</span><span class="sxs-lookup"><span data-stu-id="6c4ac-161">When you are saving audit information to a file, to help prevent tampering, you can restrict access to the file location in the following ways:</span></span>  
  
-   <span data-ttu-id="6c4ac-162">A Conta de Serviço [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] deve ter permissão de Leitura e Gravação.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-162">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Service Account must have both Read and Write permission.</span></span>  
  
-   <span data-ttu-id="6c4ac-163">Os Administradores de Auditoria geralmente requerem permissão de Leitura e Gravação.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-163">Audit Administrators typically require Read and Write permission.</span></span> <span data-ttu-id="6c4ac-164">Isso pressupõe que os Administradores de Auditoria sejam contas do Windows para a administração de arquivos de auditoria, por exemplo, copiando-os em compartilhamentos diferentes, armazenando-os em backup e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-164">This assumes that the Audit Administrators are Windows accounts for administration of audit files, such as: copying them to different shares, backing them up, and so on.</span></span>  
  
-   <span data-ttu-id="6c4ac-165">Os Leitores de Auditoria que são autorizados a ler os arquivos de auditoria precisam ter permissão de Leitura.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-165">Audit Readers that are authorized to read audit files must have Read permission.</span></span>  
  
 <span data-ttu-id="6c4ac-166">Mesmo quando o [!INCLUDE[ssDE](../../../includes/ssde-md.md)] estiver gravando em um arquivo, outros usuários do Windows poderão ler o arquivo de auditoria se tiverem permissão.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-166">Even when the [!INCLUDE[ssDE](../../../includes/ssde-md.md)] is writing to a file, other Windows users can read the audit file if they have permission.</span></span> <span data-ttu-id="6c4ac-167">O [!INCLUDE[ssDE](../../../includes/ssde-md.md)] não possui um bloqueio exclusivo que impeça operações de leitura.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-167">The [!INCLUDE[ssDE](../../../includes/ssde-md.md)] does not take an exclusive lock that prevents read operations.</span></span>  
  
 <span data-ttu-id="6c4ac-168">Como o [!INCLUDE[ssDE](../../../includes/ssde-md.md)] pode acessar o arquivo, os logons do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] que tiverem a permissão do CONTROL SERVER poderão usar o [!INCLUDE[ssDE](../../../includes/ssde-md.md)] para acessar os arquivos de auditoria.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-168">Because the [!INCLUDE[ssDE](../../../includes/ssde-md.md)] can access the file, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] logins that have CONTROL SERVER permission can use the [!INCLUDE[ssDE](../../../includes/ssde-md.md)] to access the audit files.</span></span> <span data-ttu-id="6c4ac-169">Para registrar qualquer usuário que esteja lendo o arquivo de auditoria, defina uma auditoria em master.sys.fn_get_audit_file.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-169">To record any user that is reading the audit file, define an audit on master.sys.fn_get_audit_file.</span></span> <span data-ttu-id="6c4ac-170">Isso registra os logons com permissão CONTROL SERVER que acessaram o arquivo de auditoria por meio do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6c4ac-170">This records the logins with CONTROL SERVER permission that have accessed the audit file through [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="6c4ac-171">Se um Administrador de Auditoria copiar o arquivo em um local diferente (para fins de arquivamento, entre outros), as ACLs no novo local deverão ter apenas as seguintes permissões:</span><span class="sxs-lookup"><span data-stu-id="6c4ac-171">If an Audit Administrator copies the file to a different location (for archive purposes, and so on), the ACLs on the new location should be reduced to the following permissions:</span></span>  
  
-   <span data-ttu-id="6c4ac-172">Administrador de Auditoria – Leitura/Gravação</span><span class="sxs-lookup"><span data-stu-id="6c4ac-172">Audit Administrator - Read / Write</span></span>  
  
-   <span data-ttu-id="6c4ac-173">Leitor de Auditoria – Leitura</span><span class="sxs-lookup"><span data-stu-id="6c4ac-173">Audit Reader - Read</span></span>  
  
 <span data-ttu-id="6c4ac-174">É recomendável gerar relatórios de auditoria de uma instância separada do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], como uma instância do [!INCLUDE[ssExpress](../../../includes/ssexpress-md.md)], a qual apenas Administradores de Auditoria ou Leitores de Auditoria tenham acesso.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-174">We recommend that you generate audit reports from a separate instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], such as an instance of [!INCLUDE[ssExpress](../../../includes/ssexpress-md.md)], to which only Audit Administrators or Audit Readers have access.</span></span> <span data-ttu-id="6c4ac-175">Ao usar uma instância separada do [!INCLUDE[ssDE](../../../includes/ssde-md.md)] para relatório, você pode ajudar a impedir que usuários não autorizados obtenham acesso ao registro de auditoria.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-175">By using a separate instance of the [!INCLUDE[ssDE](../../../includes/ssde-md.md)] for reporting, you can help prevent unauthorized users from obtaining access to the audit record.</span></span>  
  
 <span data-ttu-id="6c4ac-176">Você pode oferecer proteção adicional contra acesso não autorizado criptografando a pasta na qual o arquivo de auditoria é armazenado usando Criptografia de Unidade de Windows BitLocker ou Sistema de Arquivo do Windows Encrypting.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-176">You can offer additional protection against unauthorized access by encrypting the folder in which the audit file is stored by using Windows BitLocker Drive Encryption or Windows Encrypting File System.</span></span>  
  
 <span data-ttu-id="6c4ac-177">Para obter mais informações sobre os registros de auditoria gravados no destino, consulte [SQL Server Audit Records](sql-server-audit-records.md).</span><span class="sxs-lookup"><span data-stu-id="6c4ac-177">For more information about the audit records that are written to the target, see [SQL Server Audit Records](sql-server-audit-records.md).</span></span>  
  
## <a name="overview-of-using-sql-server-audit"></a><span data-ttu-id="6c4ac-178">Visão geral do uso de auditoria do SQL Server</span><span class="sxs-lookup"><span data-stu-id="6c4ac-178">Overview of Using SQL Server Audit</span></span>  
 <span data-ttu-id="6c4ac-179">É possível usar o [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] ou o [!INCLUDE[tsql](../../../includes/tsql-md.md)] para definir uma auditoria.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-179">You can use [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] or [!INCLUDE[tsql](../../../includes/tsql-md.md)] to define an audit.</span></span> <span data-ttu-id="6c4ac-180">Após a criação e habilitação da auditoria, o destino receberá entradas.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-180">After the audit is created and enabled, the target will receive entries.</span></span>  
  
 <span data-ttu-id="6c4ac-181">É possível ler os logs de eventos do Windows usando o utilitário **Visualizador de Eventos** do Windows.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-181">You can read the Windows event logs by using the **Event Viewer** utility in Windows.</span></span> <span data-ttu-id="6c4ac-182">Para destinos de arquivo, é possível usar o **Visualizador do Arquivo de Log** no [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] ou a função [fn_get_audit_file](/sql/relational-databases/system-functions/sys-fn-get-audit-file-transact-sql) para ler o arquivo de destino.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-182">For file targets, you can use either the **Log File Viewer** in [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] or the [fn_get_audit_file](/sql/relational-databases/system-functions/sys-fn-get-audit-file-transact-sql) function to read the target file.</span></span>  
  
 <span data-ttu-id="6c4ac-183">O processo geral para criar e usar uma auditoria do é o seguinte.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-183">The general process for creating and using an audit is as follows.</span></span>  
  
1.  <span data-ttu-id="6c4ac-184">Crie uma auditoria e defina o destino.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-184">Create an audit and define the target.</span></span>  
  
2.  <span data-ttu-id="6c4ac-185">Crie uma especificação da auditoria do servidor ou especificação da auditoria do banco de dados que mapeie para a auditoria.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-185">Create either a server audit specification or database audit specification that maps to the audit.</span></span> <span data-ttu-id="6c4ac-186">Habilite a especificação de auditoria.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-186">Enable the audit specification.</span></span>  
  
3.  <span data-ttu-id="6c4ac-187">Habilite a auditoria.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-187">Enable the audit.</span></span>  
  
4.  <span data-ttu-id="6c4ac-188">Leia os eventos de auditoria usando o recurso **Visualizador de Eventos**do Windows, o **Visualizador do Arquivo de Log**ou a função fn_get_audit_file.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-188">Read the audit events by using the Windows **Event Viewer**, **Log File Viewe**r, or the fn_get_audit_file function.</span></span>  
  
 <span data-ttu-id="6c4ac-189">Para obter mais informações, consulte [Criar uma auditoria de servidor e uma especificação de auditoria de servidor](create-a-server-audit-and-server-audit-specification.md) e [Criar uma especificação de auditoria de banco de dados e de servidor](create-a-server-audit-and-database-audit-specification.md).</span><span class="sxs-lookup"><span data-stu-id="6c4ac-189">For more information, see [Create a Server Audit and Server Audit Specification](create-a-server-audit-and-server-audit-specification.md) and [Create a Server Audit and Database Audit Specification](create-a-server-audit-and-database-audit-specification.md).</span></span>  
  
## <a name="considerations"></a><span data-ttu-id="6c4ac-190">Considerações</span><span class="sxs-lookup"><span data-stu-id="6c4ac-190">Considerations</span></span>  
 <span data-ttu-id="6c4ac-191">No caso de falha durante o início da auditoria, o servidor não será iniciado.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-191">In the case of a failure during audit initiation, the server will not start.</span></span> <span data-ttu-id="6c4ac-192">Nesse caso, é possível iniciar o servidor usando a opção **-f** na linha de comando.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-192">In this case, the server can be started by using the **-f** option at the command line.</span></span>  
  
 <span data-ttu-id="6c4ac-193">Quando uma falha na auditoria faz com que o servidor seja desligado ou não seja iniciado devido à especificação de ON_FAILURE=SHUTDOWN para a auditoria, o evento MSG_AUDIT_FORCED_SHUTDOWN é gravado no log.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-193">When an audit failure causes the server to shut down or not to start because ON_FAILURE=SHUTDOWN is specified for the audit, the MSG_AUDIT_FORCED_SHUTDOWN event will be written to the log.</span></span> <span data-ttu-id="6c4ac-194">Como o desligamento ocorrerá quando configuração for encontrada pela primeira vez, o evento será gravado uma vez.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-194">Because the shutdown will occur on the first encounter of this setting, the event will be written one time.</span></span> <span data-ttu-id="6c4ac-195">Esse evento será gravado após a mensagem de falha da auditoria provocar o desligamento.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-195">This event is written after the failure message for the audit causing the shutdown.</span></span> <span data-ttu-id="6c4ac-196">Um administrador pode ignorar os desligamentos induzidos por auditoria iniciando o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] no modo de usuário único usando o sinalizador **-m**.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-196">An administrator can bypass audit-induced shutdowns by starting [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] in Single User mode using the **-m** flag.</span></span> <span data-ttu-id="6c4ac-197">Se você iniciar no modo de Usuário Único, desatualizará qualquer auditoria em que ON_FAILURE=SHUTDOWN estiver especificado para execução naquela sessão como ON_FAILURE=CONTINUE.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-197">If you start in Single User mode, you will downgrade any audit where ON_FAILURE=SHUTDOWN is specified to run in that session as ON_FAILURE=CONTINUE.</span></span> <span data-ttu-id="6c4ac-198">Quando o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] for iniciado pelo sinalizador **-m**, a mensagem MSG_AUDIT_SHUTDOWN_BYPASSED será gravada no log de erros.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-198">When [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] is started by using the **-m** flag, the MSG_AUDIT_SHUTDOWN_BYPASSED message will be written to the error log.</span></span>  
  
 <span data-ttu-id="6c4ac-199">Para obter mais informações sobre as opções de inicialização do serviço, consulte [Opções de inicialização do serviço Mecanismo de Banco de Dados](../../../database-engine/configure-windows/database-engine-service-startup-options.md).</span><span class="sxs-lookup"><span data-stu-id="6c4ac-199">For more information about service startup options, see [Database Engine Service Startup Options](../../../database-engine/configure-windows/database-engine-service-startup-options.md).</span></span>  
  
### <a name="attaching-a-database-with-an-audit-defined"></a><span data-ttu-id="6c4ac-200">Anexando um banco de dados a uma auditoria definida</span><span class="sxs-lookup"><span data-stu-id="6c4ac-200">Attaching a Database with an Audit Defined</span></span>  
 <span data-ttu-id="6c4ac-201">Anexar um banco de dados que tenha uma especificação de auditoria e especifica um GUID inexistente ao servidor gerará uma especificação de auditoria *órfã* .</span><span class="sxs-lookup"><span data-stu-id="6c4ac-201">Attaching a database that has an audit specification and specifies a GUID that does not exist on the server will cause an *orphaned* audit specification.</span></span> <span data-ttu-id="6c4ac-202">Como não existe uma auditoria com um GUID correspondente na instância do servidor, nenhum evento de auditoria será gravado.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-202">Because an audit with a matching GUID does not exist on the server instance, no audit events will be recorded.</span></span> <span data-ttu-id="6c4ac-203">Para corrigir isso, use o comando ALTER DATABASE AUDIT SPECIFICATION para conectar a especificação de auditoria órfã a uma auditoria de servidor existente.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-203">To correct this situation, use the ALTER DATABASE AUDIT SPECIFICATION command to connect the orphaned audit specification to an existing server audit.</span></span> <span data-ttu-id="6c4ac-204">Ou use o comando CREATE SERVER AUDIT para criar uma nova auditoria de servidor com o GUID especificado.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-204">Or, use the CREATE SERVER AUDIT command to create a new server audit with the specified GUID.</span></span>  
  
 <span data-ttu-id="6c4ac-205">É possível anexar um banco de dados que tenha uma especificação de auditoria definida a outra edição do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] que não dê suporte à auditoria do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , como o [!INCLUDE[ssExpress](../../../includes/ssexpress-md.md)] , mas os eventos de auditoria não serão gravados.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-205">You can attach a database that has an audit specification defined on it to another edition of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] that does not support [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit, such as [!INCLUDE[ssExpress](../../../includes/ssexpress-md.md)] but it will not record audit events.</span></span>  
  
### <a name="database-mirroring-and-sql-server-audit"></a><span data-ttu-id="6c4ac-206">Espelhamento de Banco de Dados e o SQL Server Audit</span><span class="sxs-lookup"><span data-stu-id="6c4ac-206">Database Mirroring and SQL Server Audit</span></span>  
 <span data-ttu-id="6c4ac-207">Um banco de dados com uma especificação de auditoria de banco de dados definida e que usa espelhamento de banco de dados incluirá a especificação de auditoria de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-207">A database that has a database audit specification defined and that uses database mirroring will include the database audit specification.</span></span> <span data-ttu-id="6c4ac-208">Para funcionar corretamente na instância de SQL espelhada, é necessário configurar os seguintes itens:</span><span class="sxs-lookup"><span data-stu-id="6c4ac-208">To work correctly on the mirrored SQL instance, the following items must be configured:</span></span>  
  
-   <span data-ttu-id="6c4ac-209">É necessário que o servidor espelho tenha uma auditoria com o mesmo GUID para habilitar a especificação de auditoria de banco de dados para gravar registros de auditoria.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-209">The mirror server must have an audit with the same GUID to enable the database audit specification to write audit records.</span></span> <span data-ttu-id="6c4ac-210">Isso pode ser configurado usando o comando criar auditoria com GUID `=` \* \<GUID from source Server Audit*> .</span><span class="sxs-lookup"><span data-stu-id="6c4ac-210">This can be configured by using the command CREATE AUDIT WITH GUID`=`\*\<GUID from source Server Audit*>.</span></span>  
  
-   <span data-ttu-id="6c4ac-211">Para destinos de arquivos binários, é necessário que a conta do serviço de servidor espelho tenha as permissões apropriadas onde a trilha de auditoria começou a ser gravada.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-211">For binary file targets, the mirror server service account must have appropriate permissions to the location where the audit trail is being written.</span></span>  
  
-   <span data-ttu-id="6c4ac-212">Para destinos de log de eventos do Windows, a política de segurança no computador em que se encontra o servidor espelho deve permitir o acesso de conta de serviço ao log de eventos de aplicativo ou de segurança.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-212">For Windows event log targets, the security policy on the computer where the mirror server is located must allow for service account access to the security or application event log.</span></span>  
  
### <a name="auditing-administrators"></a><span data-ttu-id="6c4ac-213">Administradores de auditoria</span><span class="sxs-lookup"><span data-stu-id="6c4ac-213">Auditing Administrators</span></span>  
 <span data-ttu-id="6c4ac-214">Os membros da `sysadmin` função de servidor fixa são identificados como o usuário **dbo** em cada banco de dados.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-214">Members of the `sysadmin` fixed server role are identified as the **dbo** user in each database.</span></span> <span data-ttu-id="6c4ac-215">Para auditar as ações dos administradores, audite as ações do usuário **dbo** .</span><span class="sxs-lookup"><span data-stu-id="6c4ac-215">To audit actions of the administrators, audit the actions of the **dbo** user.</span></span>  
  
## <a name="creating-and-managing-audits-with-transact-sql"></a><span data-ttu-id="6c4ac-216">Criando e gerenciando auditorias com o Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="6c4ac-216">Creating and Managing Audits with Transact-SQL</span></span>  
 <span data-ttu-id="6c4ac-217">É possível usar instruções DDL, funções e exibições de gerenciamento dinâmico e exibições do catálogo para implementar todos os aspectos da Auditoria do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="6c4ac-217">You can use DDL statements, dynamic management views and functions, and catalog views to implement all aspects of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Audit.</span></span>  
  
### <a name="data-definition-language-statements"></a><span data-ttu-id="6c4ac-218">Instruções de linguagem de definição de dados</span><span class="sxs-lookup"><span data-stu-id="6c4ac-218">Data Definition Language Statements</span></span>  
 <span data-ttu-id="6c4ac-219">É possível usar as seguintes instruções DDL para criar, alterar e remover especificações de auditoria:</span><span class="sxs-lookup"><span data-stu-id="6c4ac-219">You can use the following DDL statements to create, alter, and drop audit specifications:</span></span>  
  
|||  
|-|-|  
|[<span data-ttu-id="6c4ac-220">ALTER AUTHORIZATION</span><span class="sxs-lookup"><span data-stu-id="6c4ac-220">ALTER AUTHORIZATION</span></span>](/sql/t-sql/statements/alter-authorization-transact-sql)|[<span data-ttu-id="6c4ac-221">CRIAR AUDITORIA DE SERVIDOR</span><span class="sxs-lookup"><span data-stu-id="6c4ac-221">CREATE SERVER AUDIT</span></span>](/sql/t-sql/statements/create-server-audit-transact-sql)|  
|[<span data-ttu-id="6c4ac-222">ALTER DATABASE AUDIT SPECIFICATION</span><span class="sxs-lookup"><span data-stu-id="6c4ac-222">ALTER DATABASE AUDIT SPECIFICATION</span></span>](/sql/t-sql/statements/alter-database-audit-specification-transact-sql)|[<span data-ttu-id="6c4ac-223">CREATE SERVER AUDIT SPECIFICATION</span><span class="sxs-lookup"><span data-stu-id="6c4ac-223">CREATE SERVER AUDIT SPECIFICATION</span></span>](/sql/t-sql/statements/create-server-audit-specification-transact-sql)|  
|[<span data-ttu-id="6c4ac-224">ALTERAR AUDITORIA DE SERVIDOR</span><span class="sxs-lookup"><span data-stu-id="6c4ac-224">ALTER SERVER AUDIT</span></span>](/sql/t-sql/statements/alter-server-audit-specification-transact-sql)|[<span data-ttu-id="6c4ac-225">DROP DATABASE AUDIT SPECIFICATION</span><span class="sxs-lookup"><span data-stu-id="6c4ac-225">DROP DATABASE AUDIT SPECIFICATION</span></span>](/sql/t-sql/statements/drop-database-encryption-key-transact-sql)|  
|[<span data-ttu-id="6c4ac-226">ALTER SERVER AUDIT SPECIFICATION</span><span class="sxs-lookup"><span data-stu-id="6c4ac-226">ALTER SERVER AUDIT SPECIFICATION</span></span>](/sql/t-sql/statements/alter-server-audit-transact-sql)|[<span data-ttu-id="6c4ac-227">DROP SERVER AUDIT</span><span class="sxs-lookup"><span data-stu-id="6c4ac-227">DROP SERVER AUDIT</span></span>](/sql/t-sql/statements/drop-server-audit-transact-sql)|  
|[<span data-ttu-id="6c4ac-228">CREATE DATABASE AUDIT SPECIFICATION</span><span class="sxs-lookup"><span data-stu-id="6c4ac-228">CREATE DATABASE AUDIT SPECIFICATION</span></span>](/sql/t-sql/statements/create-database-audit-specification-transact-sql)|[<span data-ttu-id="6c4ac-229">DROP SERVER AUDIT SPECIFICATION</span><span class="sxs-lookup"><span data-stu-id="6c4ac-229">DROP SERVER AUDIT SPECIFICATION</span></span>](/sql/t-sql/statements/drop-server-audit-specification-transact-sql)|  
  
### <a name="dynamic-views-and-functions"></a><span data-ttu-id="6c4ac-230">Exibições e funções dinâmicas</span><span class="sxs-lookup"><span data-stu-id="6c4ac-230">Dynamic Views and Functions</span></span>  
 <span data-ttu-id="6c4ac-231">A tabela a seguir lista as exibições e funções dinâmicas que podem ser usadas na auditoria do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="6c4ac-231">The following table lists the dynamic views and function that you can use for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Auditing.</span></span>  
  
|<span data-ttu-id="6c4ac-232">Exibições e funções dinâmicas</span><span class="sxs-lookup"><span data-stu-id="6c4ac-232">Dynamic views and functions</span></span>|<span data-ttu-id="6c4ac-233">Descrição</span><span class="sxs-lookup"><span data-stu-id="6c4ac-233">Description</span></span>|  
|---------------------------------|-----------------|  
|[<span data-ttu-id="6c4ac-234">sys.dm_audit_actions</span><span class="sxs-lookup"><span data-stu-id="6c4ac-234">sys.dm_audit_actions</span></span>](/sql/relational-databases/system-dynamic-management-views/sys-dm-audit-actions-transact-sql)|<span data-ttu-id="6c4ac-235">Retorna uma linha para cada ação de auditoria que pode ser reportada no log de auditoria e para cada grupo de ação de auditoria que pode ser configurado como parte do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Audit.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-235">Returns a row for every audit action that can be reported in the audit log and every audit action group that can be configured as part of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Audit.</span></span>|  
|[<span data-ttu-id="6c4ac-236">sys.dm_server_audit_status</span><span class="sxs-lookup"><span data-stu-id="6c4ac-236">sys.dm_server_audit_status</span></span>](/sql/relational-databases/system-dynamic-management-views/sys-dm-server-audit-status-transact-sql)|<span data-ttu-id="6c4ac-237">Fornece informações sobre o estado atual da auditoria.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-237">Provides information about the current state of the audit.</span></span>|  
|[<span data-ttu-id="6c4ac-238">sys.dm_audit_class_type_map</span><span class="sxs-lookup"><span data-stu-id="6c4ac-238">sys.dm_audit_class_type_map</span></span>](/sql/relational-databases/system-dynamic-management-views/sys-dm-audit-class-type-map-transact-sql)|<span data-ttu-id="6c4ac-239">Retorna uma tabela que mapeia o campo class_type do log de auditoria para o campo class_desc em sys.dm_audit_actions.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-239">Returns a table that maps the class_type field in the audit log to the class_desc field in sys.dm_audit_actions.</span></span>|  
|[<span data-ttu-id="6c4ac-240">fn_get_audit_file</span><span class="sxs-lookup"><span data-stu-id="6c4ac-240">fn_get_audit_file</span></span>](/sql/relational-databases/system-functions/sys-fn-get-audit-file-transact-sql)|<span data-ttu-id="6c4ac-241">Retorna informações de um arquivo de auditoria criado por uma auditoria de servidor.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-241">Returns information from an audit file created by a server audit.</span></span>|  
  
### <a name="catalog-views"></a><span data-ttu-id="6c4ac-242">Exibições do catálogo</span><span class="sxs-lookup"><span data-stu-id="6c4ac-242">Catalog Views</span></span>  
 <span data-ttu-id="6c4ac-243">A tabela a seguir lista as exibições do catálogo que podem ser usadas para auditoria do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="6c4ac-243">The following table lists the catalog views that you can use for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] auditing.</span></span>  
  
|<span data-ttu-id="6c4ac-244">Exibições do catálogo</span><span class="sxs-lookup"><span data-stu-id="6c4ac-244">Catalog views</span></span>|<span data-ttu-id="6c4ac-245">Descrição</span><span class="sxs-lookup"><span data-stu-id="6c4ac-245">Description</span></span>|  
|-------------------|-----------------|  
|[<span data-ttu-id="6c4ac-246">sys.database_ audit_specifications</span><span class="sxs-lookup"><span data-stu-id="6c4ac-246">sys.database_ audit_specifications</span></span>](/sql/relational-databases/system-catalog-views/sys-database-audit-specifications-transact-sql)|<span data-ttu-id="6c4ac-247">Contém informações sobre as especificações de auditoria do banco de dados de uma auditoria do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] em uma instância de servidor.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-247">Contains information about the database audit specifications in a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit on a server instance.</span></span>|  
|[<span data-ttu-id="6c4ac-248">sys.database_audit_specification_details</span><span class="sxs-lookup"><span data-stu-id="6c4ac-248">sys.database_audit_specification_details</span></span>](/sql/relational-databases/system-catalog-views/sys-database-audit-specification-details-transact-sql)|<span data-ttu-id="6c4ac-249">Contém informações sobre as especificações de auditoria de banco de dados em uma auditoria do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] em uma instância de servidor para todos os bancos de dados.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-249">Contains information about the database audit specifications in a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit on a server instance for all databases.</span></span>|  
|[<span data-ttu-id="6c4ac-250">sys.server_audits</span><span class="sxs-lookup"><span data-stu-id="6c4ac-250">sys.server_audits</span></span>](/sql/relational-databases/system-catalog-views/sys-server-audits-transact-sql)|<span data-ttu-id="6c4ac-251">Contém uma linha para cada auditoria do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] em uma instância de servidor.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-251">Contains one row for each [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit in a server instance.</span></span>|  
|[<span data-ttu-id="6c4ac-252">sys.server_audit_specifications</span><span class="sxs-lookup"><span data-stu-id="6c4ac-252">sys.server_audit_specifications</span></span>](/sql/relational-databases/system-catalog-views/sys-server-audit-specifications-transact-sql)|<span data-ttu-id="6c4ac-253">Contém informações sobre as especificações de auditoria do servidor em uma auditoria do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] em uma instância do servidor.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-253">Contains information about the server audit specifications in a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit on a server instance.</span></span>|  
|[<span data-ttu-id="6c4ac-254">sys.server_audit_specifications_details</span><span class="sxs-lookup"><span data-stu-id="6c4ac-254">sys.server_audit_specifications_details</span></span>](/sql/relational-databases/system-catalog-views/sys-server-audit-specification-details-transact-sql)|<span data-ttu-id="6c4ac-255">Contém informações sobre os detalhes (ações) de especificação de auditoria de servidor em uma auditoria do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] em uma instância de servidor.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-255">Contains information about the server audit specification details (actions) in a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit on a server instance.</span></span>|  
|[<span data-ttu-id="6c4ac-256">sys.server_file_audits</span><span class="sxs-lookup"><span data-stu-id="6c4ac-256">sys.server_file_audits</span></span>](/sql/relational-databases/system-catalog-views/sys-server-file-audits-transact-sql)|<span data-ttu-id="6c4ac-257">Contém informações estendidas de repositórios sobre o tipo de auditoria de arquivo em uma auditoria do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , em uma instância do servidor.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-257">Contains stores extended information about the file audit type in a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit on a server instance.</span></span>|  
  
## <a name="permissions"></a><span data-ttu-id="6c4ac-258">Permissões</span><span class="sxs-lookup"><span data-stu-id="6c4ac-258">Permissions</span></span>  
 <span data-ttu-id="6c4ac-259">Cada recurso e comando de Auditoria do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] tem requisitos de permissão individuais.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-259">Each feature and command for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Audit has individual permission requirements.</span></span>  
  
 <span data-ttu-id="6c4ac-260">Para criar, alterar ou descartar uma Auditoria de Servidor ou uma Especificação de Auditoria de Servidor, as entidades de segurança exigem a permissão ALTER ANY SERVER AUDIT ou a permissão CONTROL SERVER.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-260">To create, alter, or drop a Server Audit or Server Audit Specification, server principals require the ALTER ANY SERVER AUDIT or the CONTROL SERVER permission.</span></span> <span data-ttu-id="6c4ac-261">Para criar, alterar ou descartar uma Especificação de Auditoria de Banco de Dados, as entidades de segurança de banco de dados exigem a permissão DATABASE AUDIT ou ALTER ou CONTROL no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-261">To create, alter, or drop a Database Audit Specification, database principals require the ALTER ANY DATABASE AUDIT permission or the ALTER or CONTROL permission on the database.</span></span> <span data-ttu-id="6c4ac-262">Além disso, as entidades de segurança devem ter permissão para se conectar ao banco de dados ou à permissão ALTER ANY SERVER AUDIT ou CONTROL SERVER.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-262">In addition, principals must have permission to connect to the database, or ALTER ANY SERVER AUDIT or CONTROL SERVER permissions.</span></span>  
  
 <span data-ttu-id="6c4ac-263">Salvo quando especificado de outro modo, a visualização de exibições do catálogo exige que uma entidade de segurança tenha um dos seguintes itens:</span><span class="sxs-lookup"><span data-stu-id="6c4ac-263">Unless otherwise specified, viewing catalog views requires a principal to have one of the following:</span></span>  
  
-   <span data-ttu-id="6c4ac-264">Associação na função de servidor fixa sysadmin.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-264">Membership in the sysadmin fixed server role.</span></span>  
  
-   <span data-ttu-id="6c4ac-265">A permissão CONTROL SERVER.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-265">The CONTROL SERVER permission.</span></span>  
  
-   <span data-ttu-id="6c4ac-266">A permissão VIEW SERVER STATE.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-266">The VIEW SERVER STATE permission.</span></span>  
  
-   <span data-ttu-id="6c4ac-267">A permissão ALTER ANY AUDIT.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-267">The ALTER ANY AUDIT permission.</span></span>  
  
-   <span data-ttu-id="6c4ac-268">A permissão VIEW AUDIT STATE (fornece somente acesso à entidade de segurança à exibição do catálogo sys.server_audits).</span><span class="sxs-lookup"><span data-stu-id="6c4ac-268">The VIEW AUDIT STATE permission (gives only the principal access to the sys.server_audits catalog view).</span></span>  
  
 <span data-ttu-id="6c4ac-269">Uma entidade de segurança deve ter a permissão VIEW SERVER STATE ou ALTER ANY AUDIT para usar as Exibições de Gerenciamento Dinâmico.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-269">A principal must have the VIEW SERVER STATE or ALTER ANY AUDIT permission to use the Dynamic Management Views.</span></span>  
  
 <span data-ttu-id="6c4ac-270">Para obter mais informações sobre como conceder direitos e permissões, consulte [GRANT &#40;Transact-SQL&#41;](/sql/t-sql/statements/grant-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="6c4ac-270">For more information about how to grant rights and permissions, see [GRANT &#40;Transact-SQL&#41;](/sql/t-sql/statements/grant-transact-sql).</span></span>  
  
> [!CAUTION]  
>  <span data-ttu-id="6c4ac-271">Entidades na função sysadmin podem violar qualquer componente de auditoria e aqueles na função db_owner podem violar quaisquer especificações em um banco de dados.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-271">Principals in the sysadmin role can tamper with any audit component and those in the db_owner role can tamper with audit specifications in a database.</span></span> <span data-ttu-id="6c4ac-272">A auditoria do[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] valida esse logon que cria ou altera uma especificação de auditoria que tenha pelo menos a permissão ALTER ANY DATABASE AUDIT.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-272">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Audit will validate that a logon that creates or alters an audit specification has at least the ALTER ANY DATABASE AUDIT permission.</span></span> <span data-ttu-id="6c4ac-273">No entanto, ela não faz nenhuma validação quando você anexa um banco de dados.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-273">However, it does no validation when you attach a database.</span></span> <span data-ttu-id="6c4ac-274">Você deve considerar que todas as Especificações de Auditoria de Banco de Dados são seguras somente para as entidades nas funções sysadmin ou db_owner.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-274">You should assume all Database Audit Specifications are only as trustworthy as those principals in the sysadmin or db_owner role.</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="6c4ac-275">Related Tasks</span><span class="sxs-lookup"><span data-stu-id="6c4ac-275">Related Tasks</span></span>  
 [<span data-ttu-id="6c4ac-276">Criar uma auditoria de servidor e uma especificação de auditoria de servidor</span><span class="sxs-lookup"><span data-stu-id="6c4ac-276">Create a Server Audit and Server Audit Specification</span></span>](create-a-server-audit-and-server-audit-specification.md)  
  
 [<span data-ttu-id="6c4ac-277">Criar uma especificação de auditoria de banco de dados e de servidor</span><span class="sxs-lookup"><span data-stu-id="6c4ac-277">Create a Server Audit and Database Audit Specification</span></span>](create-a-server-audit-and-database-audit-specification.md)  
  
 [<span data-ttu-id="6c4ac-278">Exibir um log auditoria do SQL Server</span><span class="sxs-lookup"><span data-stu-id="6c4ac-278">View a SQL Server Audit Log</span></span>](view-a-sql-server-audit-log.md)  
  
 [<span data-ttu-id="6c4ac-279">Gravar eventos de auditoria do SQL Server no log de segurança</span><span class="sxs-lookup"><span data-stu-id="6c4ac-279">Write SQL Server Audit Events to the Security Log</span></span>](write-sql-server-audit-events-to-the-security-log.md)  
  
## <a name="topics-closely-related-to-auditing"></a><span data-ttu-id="6c4ac-280">Tópicos estreitamente relacionados à auditoria</span><span class="sxs-lookup"><span data-stu-id="6c4ac-280">Topics Closely Related to Auditing</span></span>  
 [<span data-ttu-id="6c4ac-281">Propriedades do Servidor &#40;Página Segurança&#41;</span><span class="sxs-lookup"><span data-stu-id="6c4ac-281">Server Properties &#40;Security Page&#41;</span></span>](../../../database-engine/configure-windows/server-properties-security-page.md)  
 <span data-ttu-id="6c4ac-282">Explica como ativar a auditoria de logon para o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6c4ac-282">Explains how to turn on login auditing for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="6c4ac-283">Os registros de auditoria são armazenados no log do aplicativo do Windows.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-283">The audit records are stored in the Windows application log.</span></span>  
  
 [<span data-ttu-id="6c4ac-284">Opção de configuração do servidor do modo de auditoria de c2</span><span class="sxs-lookup"><span data-stu-id="6c4ac-284">c2 audit mode Server Configuration Option</span></span>](../../../database-engine/configure-windows/c2-audit-mode-server-configuration-option.md)  
 <span data-ttu-id="6c4ac-285">Explica o modo de auditoria de conformidade de segurança de C2 no [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6c4ac-285">Explains the C2 security compliance auditing mode in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
 [<span data-ttu-id="6c4ac-286">Categoria de evento de Auditoria de Segurança &#40;SQL Server Profiler&#41;</span><span class="sxs-lookup"><span data-stu-id="6c4ac-286">Security Audit Event Category &#40;SQL Server Profiler&#41;</span></span>](../../../relational-databases/event-classes/security-audit-event-category-sql-server-profiler.md)  
 <span data-ttu-id="6c4ac-287">Explica os eventos de auditoria que podem ser usados no [!INCLUDE[ssSqlProfiler](../../../includes/sssqlprofiler-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6c4ac-287">Explains the audit events you can use in [!INCLUDE[ssSqlProfiler](../../../includes/sssqlprofiler-md.md)].</span></span> <span data-ttu-id="6c4ac-288">Para saber mais, confira [SQL Server Profiler](../../../tools/sql-server-profiler/sql-server-profiler.md).</span><span class="sxs-lookup"><span data-stu-id="6c4ac-288">For more information, see [SQL Server Profiler](../../../tools/sql-server-profiler/sql-server-profiler.md).</span></span>  
  
 [<span data-ttu-id="6c4ac-289">Rastreamento do SQL</span><span class="sxs-lookup"><span data-stu-id="6c4ac-289">SQL Trace</span></span>](../../sql-trace/sql-trace.md)  
 <span data-ttu-id="6c4ac-290">Explica como o Rastreamento do SQL pode ser usado nos seus próprios aplicativos para criar rastreamentos manualmente em vez de usar o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Profiler.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-290">Explains how SQL Trace can be used from within your own applications to create traces manually, instead of using [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Profiler.</span></span>  
  
 [<span data-ttu-id="6c4ac-291">Gatilhos DDL</span><span class="sxs-lookup"><span data-stu-id="6c4ac-291">DDL Triggers</span></span>](../../triggers/ddl-triggers.md)  
 <span data-ttu-id="6c4ac-292">Explica como os gatilhos DDL (linguagem de definição de dados) podem ser usados para controlar alterações nos bancos de dados.</span><span class="sxs-lookup"><span data-stu-id="6c4ac-292">Explains how you can use Data Definition Language (DDL) triggers to track changes to your databases.</span></span>  
  
 [<span data-ttu-id="6c4ac-293">Microsoft TechNet: SQL Server TechCenter: Proteção e Segurança do SQL Server 2005</span><span class="sxs-lookup"><span data-stu-id="6c4ac-293">Microsoft TechNet: SQL Server TechCenter: SQL Server 2005 Security and Protection</span></span>](https://go.microsoft.com/fwlink/?LinkId=101152)  
 <span data-ttu-id="6c4ac-294">Fornece informações atualizadas sobre a segurança do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="6c4ac-294">Provides up-to-date information about [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] security.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6c4ac-295">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="6c4ac-295">See Also</span></span>  
 <span data-ttu-id="6c4ac-296">[Ações e grupos de ações de auditoria do SQL Server](sql-server-audit-action-groups-and-actions.md) </span><span class="sxs-lookup"><span data-stu-id="6c4ac-296">[SQL Server Audit Action Groups and Actions](sql-server-audit-action-groups-and-actions.md) </span></span>  
 [<span data-ttu-id="6c4ac-297">Registros de auditoria do SQL Server</span><span class="sxs-lookup"><span data-stu-id="6c4ac-297">SQL Server Audit Records</span></span>](sql-server-audit-records.md)  
  
  
