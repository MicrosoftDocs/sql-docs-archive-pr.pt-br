---
title: Cálculos | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: reference
helpviewer_keywords:
- calculations [Analysis Services]
- OLAP objects [Analysis Services], calculations
- MDX [Analysis Services], calculations
- calculations [Analysis Services], about calculations
- cubes [Analysis Services], calculations
ms.assetid: 6be84916-fd05-4efc-ab98-6adbbad80154
author: minewiskan
ms.author: owend
ms.openlocfilehash: 4457a5fa434be3865edf770f7ca69a676c051893
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87684413"
---
# <a name="calculations"></a><span data-ttu-id="2afda-102">Cálculos</span><span class="sxs-lookup"><span data-stu-id="2afda-102">Calculations</span></span>
  <span data-ttu-id="2afda-103">Um cálculo é uma expressão MDX ou um script que é usado para definir um membro calculado, um conjunto nomeado ou uma atribuição com escopo definido em um cubo no [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="2afda-103">A calculation is a Multidimensional Expressions (MDX) expression or script that is used to define a calculated member, a named set, or a scoped assignment in a cube in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span> <span data-ttu-id="2afda-104">Os cálculos permitem a adição de objetos que são definidos não pelos dados do cubo, mas pelas expressões que fazem referência a outras partes do cubo, a outros cubos, ou mesmo a informações fora do banco de dados [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2afda-104">Calculations let you add objects that are defined not by the data of the cube, but by expressions that can reference other parts of the cube, other cubes, or even information outside the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] database.</span></span> <span data-ttu-id="2afda-105">Os cálculos permitem a extensão das capacidades de um cubo, adicionando flexibilidade e poder a aplicativos de inteligência comercial.</span><span class="sxs-lookup"><span data-stu-id="2afda-105">Calculations let you extend the capabilities of a cube, adding flexibility and power to business intelligence applications.</span></span> <span data-ttu-id="2afda-106">Para obter mais informações sobre cálculos de script, consulte [introdução ao script MDX no Microsoft SQL Server 2005](https://go.microsoft.com/fwlink/?LinkId=81892).</span><span class="sxs-lookup"><span data-stu-id="2afda-106">For more information about scripting calculations, see [Introduction to MDX Scripting in Microsoft SQL Server 2005](https://go.microsoft.com/fwlink/?LinkId=81892).</span></span> <span data-ttu-id="2afda-107">Para obter mais informações sobre problemas de desempenho relacionados a cálculos e consultas MDX, consulte o [Guia de desempenho do SQL Server 2005 Analysis Services](https://docsbay.net/Microsoft-SQL-Server-2005-Analysis-Services-Performance-Guide).</span><span class="sxs-lookup"><span data-stu-id="2afda-107">For more information about performance issues related to MDX queries and calculations, see the [SQL Server 2005 Analysis Services Performance Guide](https://docsbay.net/Microsoft-SQL-Server-2005-Analysis-Services-Performance-Guide).</span></span>  
  
## <a name="calculated-members"></a><span data-ttu-id="2afda-108">Membros calculados</span><span class="sxs-lookup"><span data-stu-id="2afda-108">Calculated Members</span></span>  
 <span data-ttu-id="2afda-109">Um membro calculado é um membro cujo valor é calculado no tempo de execução usando uma linguagem MDX que você especificou ao definir o membro calculado.</span><span class="sxs-lookup"><span data-stu-id="2afda-109">A calculated member is a member whose value is calculated at run time using a Multidimensional Expressions (MDX) expression that you specify when you define the calculated member.</span></span> <span data-ttu-id="2afda-110">Um membro calculado está disponível para aplicativos de inteligência comercial assim como qualquer outro membro.</span><span class="sxs-lookup"><span data-stu-id="2afda-110">A calculated member is available to business intelligence applications just like any other member.</span></span> <span data-ttu-id="2afda-111">Membros calculados não aumentam o tamanho do cubo porque somente as definições são armazenadas no cubo; os valores são calculados na memória conforme necessário para responder a uma consulta.</span><span class="sxs-lookup"><span data-stu-id="2afda-111">Calculated members do not increase the size of the cube because only the definitions are stored in the cube; values are calculated in memory as required to answer a query.</span></span>  
  
 <span data-ttu-id="2afda-112">Os membros calculados podem ser definidos para qualquer dimensão, inclusive a dimensão de medidas.</span><span class="sxs-lookup"><span data-stu-id="2afda-112">Calculated members can be defined for any dimension, including the measures dimension.</span></span> <span data-ttu-id="2afda-113">Os membros calculados criados na dimensão de medidas são chamados medidas calculadas.</span><span class="sxs-lookup"><span data-stu-id="2afda-113">Calculated members created on the Measures dimension are called calculated measures.</span></span>  
  
 <span data-ttu-id="2afda-114">Embora membros calculados estejam geralmente baseados em dados já existentes no cubo, você pode criar expressões complexas combinando dados com operadores, números e funções aritméticas.</span><span class="sxs-lookup"><span data-stu-id="2afda-114">Although calculated members are typically based on data that already exists in the cube, you can create complex expressions by combining data with arithmetic operators, numbers, and functions.</span></span> <span data-ttu-id="2afda-115">Você também pode usar funções MDX, como LookupCube, para acessar dados em outros cubos no banco de dados [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2afda-115">You can also use MDX functions, such as LookupCube, to access data in other cubes in the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] database.</span></span> <span data-ttu-id="2afda-116">O [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] inclui as bibliotecas de funções padronizadas do Visual Studio, e usar procedimentos armazenados para recuperar dados de fontes diferentes do banco de dados [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] atual.</span><span class="sxs-lookup"><span data-stu-id="2afda-116">[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] includes standardized Visual Studio function libraries, and you can use stored procedures to retrieve data from sources other than the current [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] database.</span></span> <span data-ttu-id="2afda-117">Para obter mais informações sobre procedimentos armazenados, consulte [definindo procedimentos armazenados](../multidimensional-models-extending-olap-stored-procedures/defining-stored-procedures.md).</span><span class="sxs-lookup"><span data-stu-id="2afda-117">For more information about stored procedures, see [Defining Stored Procedures](../multidimensional-models-extending-olap-stored-procedures/defining-stored-procedures.md).</span></span>  
  
 <span data-ttu-id="2afda-118">Por exemplo, suponha que os executivos em uma empresa transportadora queiram determinar quais tipos de carga são mais lucrativos, com base no lucro por unidade de volume.</span><span class="sxs-lookup"><span data-stu-id="2afda-118">For example, suppose executives in a shipping company want to determine which types of cargo are more profitable to carry, based on profit per unit of volume.</span></span> <span data-ttu-id="2afda-119">Eles usam um cubo Shipments que contém as dimensões Cargo, Fleet e Time e as medidas Price_to_Ship, Cost_to_Ship e Volume_in_Cubic_Meters; contudo, o cubo não contém uma medida para rentabilidade.</span><span class="sxs-lookup"><span data-stu-id="2afda-119">They use a Shipments cube that contains the dimensions Cargo, Fleet, and Time and the measures Price_to_Ship, Cost_to_Ship, and Volume_in_Cubic_Meters; however, the cube does not contain a measure for profitability.</span></span> <span data-ttu-id="2afda-120">Você pode criar um membro calculado como uma medida chamada Profit_per_Cubic_Meter no cubo combinando as medidas existentes na seguinte expressão:</span><span class="sxs-lookup"><span data-stu-id="2afda-120">You can create a calculated member as a measure named Profit_per_Cubic_Meter in the cube by combining the existing measures in the following expression:</span></span>  
  
```  
([Measures].[Price_to_Ship] - [Measures].[Cost_to_Ship]) /  
[Measures].[Volume_in_Cubic_Meters]  
```  
  
 <span data-ttu-id="2afda-121">Depois de criar o membro calculado, o Profit_per_Cubic_Meter aparecerá juntamente com as outras medidas na próxima vez que o cubo Shipments for acessado.</span><span class="sxs-lookup"><span data-stu-id="2afda-121">After you create the calculated member, the Profit_per_Cubic_Meter appears together with the other measures the next time that the Shipments cube is browsed.</span></span>  
  
 <span data-ttu-id="2afda-122">Para criar membros calculados, use a guia s de **cálculo**no designer de cubo.</span><span class="sxs-lookup"><span data-stu-id="2afda-122">To create calculated members, use the **Calculation**s tab in Cube Designer.</span></span> <span data-ttu-id="2afda-123">Para obter mais informações, consulte [criar membros calculados](../multidimensional-models/create-calculated-members.md)</span><span class="sxs-lookup"><span data-stu-id="2afda-123">For more information, see [Create Calculated Members](../multidimensional-models/create-calculated-members.md)</span></span>  
  
## <a name="named-sets"></a><span data-ttu-id="2afda-124">Conjuntos nomeados</span><span class="sxs-lookup"><span data-stu-id="2afda-124">Named Sets</span></span>  
 <span data-ttu-id="2afda-125">Um conjunto nomeado é uma expressão de instrução CREAT SET MDX que retorna um conjunto.</span><span class="sxs-lookup"><span data-stu-id="2afda-125">A named set is a CREATE SET MDX statement expression that returns a set.</span></span> <span data-ttu-id="2afda-126">A expressão MDX é salva como parte da definição de um cubo no [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="2afda-126">The MDX expression is saved as part of the definition of a cube in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span> <span data-ttu-id="2afda-127">Um conjunto nomeado é criado para reutilização nas consultas MDX.</span><span class="sxs-lookup"><span data-stu-id="2afda-127">A named set is created for reuse in Multidimensional Expressions (MDX) queries.</span></span> <span data-ttu-id="2afda-128">Um conjunto nomeado permite que os usuários empresariais simplifiquem consultas e utilizem um nome de conjunto em vez de uma expressão de conjunto para expressões de conjunto complexas usadas com mais frequência.</span><span class="sxs-lookup"><span data-stu-id="2afda-128">A named set enables business users to simplify queries, and use a set name instead of a set expression for complex, frequently used set expressions.</span></span> <span data-ttu-id="2afda-129">**Tópico relacionado:** [criar conjuntos nomeados](../multidimensional-models/create-named-sets.md)</span><span class="sxs-lookup"><span data-stu-id="2afda-129">**Related topic:** [Create Named Sets](../multidimensional-models/create-named-sets.md)</span></span>  
  
## <a name="script-commands"></a><span data-ttu-id="2afda-130">Comandos de script</span><span class="sxs-lookup"><span data-stu-id="2afda-130">Script Commands</span></span>  
 <span data-ttu-id="2afda-131">Um comando de script é um script MDX, incluído como parte da definição do cubo.</span><span class="sxs-lookup"><span data-stu-id="2afda-131">A script command is an MDX script, included as part of the definition of the cube.</span></span> <span data-ttu-id="2afda-132">Os comandos de script permitem a execução de praticamente qualquer ação com suporte suporte pelo MDX em um cubo, como incluir no escopo um cálculo a ser aplicado a apenas parte do cubo.</span><span class="sxs-lookup"><span data-stu-id="2afda-132">Script commands let you perform almost any action that is supported by MDX on a cube, such as scoping a calculation to apply to only part of the cube.</span></span> <span data-ttu-id="2afda-133">No [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , os scripts MDX podem se aplicar a um cubo inteiro ou a seções específicas do cubo, em pontos específicos durante a execução do script.</span><span class="sxs-lookup"><span data-stu-id="2afda-133">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], MDX scripts can apply either to the whole cube or to specific sections of the cube, at specific points throughout the execution of the script.</span></span> <span data-ttu-id="2afda-134">O comando de script padrão, que é a instrução CALCULATE, popula as células no cubo com dados agregados com base no escopo padrão.</span><span class="sxs-lookup"><span data-stu-id="2afda-134">The default script command, which is the CALCULATE statement, populates cells in the cube with aggregated data based on the default scope.</span></span>  
  
 <span data-ttu-id="2afda-135">O escopo padrão é o cubo inteiro, mas você pode definir um escopo mais limitado, conhecido como subcubo, e então aplicar um script MDX a apenas aquele espaço específico do cubo.</span><span class="sxs-lookup"><span data-stu-id="2afda-135">The default scope is the whole cube, but you can define a more limited scope, known as a subcube, and then apply an MDX script to only that particular cube space.</span></span> <span data-ttu-id="2afda-136">A instrução SCOPE define o escopo de todas as expressões MDX subsequentes e instruções no script de cálculo até que o escopo seja finalizado ou redefinido.</span><span class="sxs-lookup"><span data-stu-id="2afda-136">The SCOPE statement defines the scope of all subsequent MDX expressions and statements in the calculation script until the scope is terminated or redefined.</span></span> <span data-ttu-id="2afda-137">A instrução THIS é então usada para aplicar uma expressão MDX ao escopo atual.</span><span class="sxs-lookup"><span data-stu-id="2afda-137">The THIS statement is then used to apply an MDX expression to the current scope.</span></span> <span data-ttu-id="2afda-138">Você pode usar a instrução BACK_COLOR para especificar uma cor de fundo para as células no escopo atual, para ajudá-lo durante a depuração.</span><span class="sxs-lookup"><span data-stu-id="2afda-138">You can use the BACK_COLOR statement to specify a background cell color for the cells in the current scope, to help you during debugging.</span></span>  
  
 <span data-ttu-id="2afda-139">Por exemplo, você pode usar um comando de script para alocar cotas de vendas a funcionários ao longo do tempo e a território de vendas com base nos valores ponderados de um período de tempo anterior.</span><span class="sxs-lookup"><span data-stu-id="2afda-139">For example, you can use a script command to allocate sales quotas to employees across time and sales territory based on the weighted values of sales for a prior time period.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="2afda-140">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="2afda-140">See Also</span></span>  
 [<span data-ttu-id="2afda-141">Cálculos em modelos multidimensionais</span><span class="sxs-lookup"><span data-stu-id="2afda-141">Calculations in Multidimensional Models</span></span>](../multidimensional-models/calculations-in-multidimensional-models.md)  
  
  
