---
title: Rastreamento (cliente de mineração de dados para Excel) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- tracer
- connections
ms.assetid: 4aea3e17-cd0f-48dd-8f22-b54a6c716426
author: minewiskan
ms.author: owend
ms.openlocfilehash: 74e1a5be21aa6981ccefa76f7bb1892d8d517be5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87684345"
---
# <a name="trace-data-mining-client-for-excel"></a><span data-ttu-id="32e38-102">Rastrear (Cliente de Mineração de Dados para Excel)</span><span class="sxs-lookup"><span data-stu-id="32e38-102">Trace (Data Mining Client for Excel)</span></span>
  <span data-ttu-id="32e38-103">![Botão Rastrear](media/misc-trace.gif "Botão Rastrear")</span><span class="sxs-lookup"><span data-stu-id="32e38-103">![Trace button](media/misc-trace.gif "Trace button")</span></span>

 <span data-ttu-id="32e38-104">A caixa de diálogo **Rastreamento** ajuda a monitorar as instruções enviadas à instância do [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] que você está usando para mineração de dados.</span><span class="sxs-lookup"><span data-stu-id="32e38-104">The **Tracer** dialog box helps you monitor the statements that are sent to the instance of [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] that you are using for data mining.</span></span> <span data-ttu-id="32e38-105">Depois que você criar uma conexão com uma instância do [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)], todas as interações entre o cliente e o servidor serão registradas no painel **Rastreamento** , incluindo instruções que criam estruturas, adicionam modelos de mineração e fazem previsões, além de algumas mensagens retornadas do servidor.</span><span class="sxs-lookup"><span data-stu-id="32e38-105">After you have created a connection to an instance of [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)], all interactions between the client and the server are logged in the **Tracer** pane, including statements that create structures, add mining models, and make predictions, as well as some messages returning from the server.</span></span>

 <span data-ttu-id="32e38-106">Dependendo da ação solicitada, a instrução talvez seja uma consulta de definição de dados DMX ou uma consulta de manipulação de dados, um pacote ASSL do Analysis Services ou uma chamada a um procedimento armazenado do Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="32e38-106">Depending on the action that is requested, the statement might be a Data Mining Extensions (DMX) data definition query or data manipulation query, an Analysis Services Scripting Language (ASSL) packet, or a call to an Analysis Services stored procedure.</span></span> <span data-ttu-id="32e38-107">No entanto, os resultados numéricos e os valores de dados reais não são mostrados.</span><span class="sxs-lookup"><span data-stu-id="32e38-107">Actual numerical results and data values are not shown, however.</span></span>

 <span data-ttu-id="32e38-108">**Rastrear** monitora apenas a conexão atual. O conteúdo da caixa de diálogo **Rastreamento** não é armazenado.</span><span class="sxs-lookup"><span data-stu-id="32e38-108">**Trace** monitors only the current connection, and the contents of the **Tracer** dialog box are not stored.</span></span>

## <a name="options"></a><span data-ttu-id="32e38-109">Opções</span><span class="sxs-lookup"><span data-stu-id="32e38-109">Options</span></span>
 <span data-ttu-id="32e38-110">Painel rastreador lista todas as instruções enviadas do cliente do Excel para o servidor.</span><span class="sxs-lookup"><span data-stu-id="32e38-110">Tracer pane Lists all statements sent from the Excel client to the server.</span></span>

 <span data-ttu-id="32e38-111">Dependendo da ação solicitada, talvez a instrução seja uma manipulação de dados DMX ou uma instrução de definição de dados, uma chamada a um procedimento armazenado do Analysis Services ou um pacote XML/A.</span><span class="sxs-lookup"><span data-stu-id="32e38-111">Depending on the action that is being requested, the statement might be a DMX data manipulation or data definition statement, a call to an Analysis Services stored procedure, or an XML/A packet.</span></span>

 <span data-ttu-id="32e38-112">**Conexão Atual** Clique para exibir a definição da conexão atual.</span><span class="sxs-lookup"><span data-stu-id="32e38-112">**Current Connection** Click to display the definition of the current connection.</span></span> <span data-ttu-id="32e38-113">A definição inclui o nome da conexão, o provedor, a fonte de dados e o catálogo, a hora do último uso da conexão para uma transação e o estado atual (Aberta, Inativa).</span><span class="sxs-lookup"><span data-stu-id="32e38-113">The definition includes the name of the connection, the provider, data source, and catalog, the time the connection was last used for a transaction, and the current state (Open, Inactive).</span></span>

 <span data-ttu-id="32e38-114">**Usar modelos de sessão** Marque esta caixa de seleção para armazenar modelos e estruturas de mineração de dados como objetos temporários no servidor.</span><span class="sxs-lookup"><span data-stu-id="32e38-114">**Use session models** Select this check box to store data mining models and structures as temporary objects on the server.</span></span> <span data-ttu-id="32e38-115">As estruturas e os modelos criados ficarão disponíveis apenas durante a sessão atual.</span><span class="sxs-lookup"><span data-stu-id="32e38-115">The models and structures that you create will be available only for the duration of the current session.</span></span>

 <span data-ttu-id="32e38-116">Desmarque esta opção para salvar as estruturas ou os modelos armazenando-os no servidor Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="32e38-116">Deselect this option to save your models or structures by storing them on an Analysis Services server.</span></span>

 <span data-ttu-id="32e38-117">**Observação** A capacidade de usar objetos temporários está disponível somente quando você está utilizando as Ferramentas de Análise de Tabela para Excel.</span><span class="sxs-lookup"><span data-stu-id="32e38-117">**Note** The ability to use temporary objects is available only when you are using the Table Analysis Tools for Excel.</span></span> <span data-ttu-id="32e38-118">Os modelos de Mineração de Dados do Visio e o Cliente de Mineração de Dados para Excel requerem o armazenamento de estruturas e modelos no servidor.</span><span class="sxs-lookup"><span data-stu-id="32e38-118">The Visio Data Mining templates and the Data Mining Client for Excel require structures and models to be stored on the server.</span></span>

## <a name="tracing-temporary-structures-and-models"></a><span data-ttu-id="32e38-119">Rastreando estruturas e modelos temporários</span><span class="sxs-lookup"><span data-stu-id="32e38-119">Tracing Temporary Structures and Models</span></span>
 <span data-ttu-id="32e38-120">Se você estiver usando as Ferramentas de Análise de Tabela, que por padrão criam estruturas e modelos temporários, a atividade entre o servidor e o cliente será monitorada, mas as estruturas ou os modelos criados não serão salvos permanentemente no servidor.</span><span class="sxs-lookup"><span data-stu-id="32e38-120">If you are using the Table Analysis Tools, which by default create temporary structures and models, the activity between the server and the client is monitored, but the models or structures that you create are not saved permanently to the server.</span></span>

 <span data-ttu-id="32e38-121">Para preservar seu trabalho ao usar uma das Ferramentas de Análise de Tabela, desmarque a opção **Usar modelos de sessão**, para fazer com que os modelos sejam salvos permanentemente no servidor.</span><span class="sxs-lookup"><span data-stu-id="32e38-121">If you want to preserve your work when using one of the Table Analysis Tools, you can deselect the option, **Use session models**, to cause your models to be permanently saved on the server.</span></span> <span data-ttu-id="32e38-122">Também é possível copiar as instruções no painel **Rastreamento** em um arquivo, para que você possa recriar seu trabalho depois.</span><span class="sxs-lookup"><span data-stu-id="32e38-122">You can also copy the statements in the **Tracer** pane to a file so that you can re-create your work later.</span></span>

## <a name="understanding-sessions"></a><span data-ttu-id="32e38-123">Entendendo sessões</span><span class="sxs-lookup"><span data-stu-id="32e38-123">Understanding Sessions</span></span>
 <span data-ttu-id="32e38-124">Quando você se conecta a uma instância do [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)], o suplemento de mineração de dados inicia uma sessão.</span><span class="sxs-lookup"><span data-stu-id="32e38-124">When you connect to an instance of [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)], the data mining add-in initiates a session.</span></span> <span data-ttu-id="32e38-125">Cada sessão recebe um identificador que identifica uma sessão existente na instância do [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="32e38-125">Each session receives a session identifier that identifies an existing session on the [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] instance.</span></span> <span data-ttu-id="32e38-126">No entanto, um identificador de sessão não garante que uma sessão permaneça válida.</span><span class="sxs-lookup"><span data-stu-id="32e38-126">However, a session identifier does not guarantee that a session remains valid.</span></span> <span data-ttu-id="32e38-127">A sessão poderá expirar se seu tempo limite for alcançado ou se a conexão associada a ela for interrompida.</span><span class="sxs-lookup"><span data-stu-id="32e38-127">The session can expire if the session times out or the connection associated with the session is disconnected.</span></span> <span data-ttu-id="32e38-128">Se a sessão expirar e não for mais válida, o [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] finalizará a sessão e reverterá as transações que estiverem sendo processadas.</span><span class="sxs-lookup"><span data-stu-id="32e38-128">If the session expires and is no longer valid, [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] ends the session and rolls back any transactions that are in process.</span></span> <span data-ttu-id="32e38-129">Se uma mensagem for enviada com um identificador de sessão que não for mais válido, ocorrerá falha na mensagem com um erro indicando que não é possível encontrar a sessão especificada.</span><span class="sxs-lookup"><span data-stu-id="32e38-129">If a message is sent with a session identifier that is no longer valid, the message fails with an error indicating that the specified session cannot be found.</span></span>

 <span data-ttu-id="32e38-130">Embora alguns modelos de mineração de dados sejam armazenados explicitamente no servidor, isso não acontece com os modelos e as estruturas de mineração de sessão; além disso, nenhum registro persiste da atividade de mineração de dados de sessão.</span><span class="sxs-lookup"><span data-stu-id="32e38-130">Although some data mining models are explicitly stored on the server, session mining models and structures are not, and no record is persisted of session data mining activity.</span></span> <span data-ttu-id="32e38-131">Como as estruturas e os modelos temporários de mineração são excluídos assim que você encerra a sessão, evite fechar a pasta de trabalho do Excel antes de salvar qualquer trabalho que você queira manter.</span><span class="sxs-lookup"><span data-stu-id="32e38-131">Because temporary mining models and structures are deleted as soon as you end the session, you should avoid closing your Excel workbook until after you have saved any work that you want to keep.</span></span>

## <a name="changing-connections"></a><span data-ttu-id="32e38-132">Alterando conexões</span><span class="sxs-lookup"><span data-stu-id="32e38-132">Changing Connections</span></span>
 <span data-ttu-id="32e38-133">A alteração de conexões não exclui rastreamentos de conexões anteriores.</span><span class="sxs-lookup"><span data-stu-id="32e38-133">Changing connections does not delete traces from previous connections.</span></span> <span data-ttu-id="32e38-134">Somente o fechamento da pasta de trabalho apaga a sessão.</span><span class="sxs-lookup"><span data-stu-id="32e38-134">Only closing the workbook erases the session.</span></span>

 <span data-ttu-id="32e38-135">Se você alterar conexões ao trabalhar em uma pasta de trabalho do Excel, a alteração de conexões não será registrada no painel **Rastreamento** .</span><span class="sxs-lookup"><span data-stu-id="32e38-135">If you change connections while working in an Excel workbook, the change of connections is not recorded in the **Tracer** pane.</span></span> <span data-ttu-id="32e38-136">Para exibir explicitamente o nome e o status da conexão atual, você deve clicar em **Conexão Atual**.</span><span class="sxs-lookup"><span data-stu-id="32e38-136">To explicitly display the name and status of the current connection, you must click **Current Connection**.</span></span>

## <a name="understanding-statements-in-the-tracer"></a><span data-ttu-id="32e38-137">Compreendendo as instruções no rastreamento</span><span class="sxs-lookup"><span data-stu-id="32e38-137">Understanding Statements in the Tracer</span></span>
 <span data-ttu-id="32e38-138">DMX é uma linguagem que você pode usar para criar e trabalhar com modelos de mineração de dados no [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="32e38-138">DMX is a language that you can use to create and work with data mining models in [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)].</span></span> <span data-ttu-id="32e38-139">É possível usar DMX para criar a estrutura de novos modelos de mineração de dados, treinar esses modelos e pesquisar, gerenciar e fazer previsões sobre eles.</span><span class="sxs-lookup"><span data-stu-id="32e38-139">You can use DMX to create the structure of new data mining models, train these models, and to browse, manage, and predict against them.</span></span> <span data-ttu-id="32e38-140">A extensão DMX é composta de instruções DLL (linguagem de definição de dados), instruções DML (linguagem de manipulação de dados), funções e operadores.</span><span class="sxs-lookup"><span data-stu-id="32e38-140">DMX is composed of data definition language (DDL) statements, data manipulation language (DML) statements, and functions and operators.</span></span>

 <span data-ttu-id="32e38-141">Uma análise completa das instruções DMX e sua sintaxe está além do escopo deste tópico.</span><span class="sxs-lookup"><span data-stu-id="32e38-141">A complete discussion of DMX statements and their syntax is beyond the scope of this topic.</span></span> <span data-ttu-id="32e38-142">No entanto, você pode usar as informações no painel **Rastreamento** para obter detalhes sobre o comportamento de uma instrução DMX.</span><span class="sxs-lookup"><span data-stu-id="32e38-142">However, you can use the information in the **Tracer** pane to find detailed information about the behavior of a DMX statement.</span></span> <span data-ttu-id="32e38-143">Os Suplementos de Mineração de Dados para Excel também podem ajudá-lo a criar instruções DMX complexas e a interagir com um servidor [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="32e38-143">The Data Mining Add-ins for Excel can also help you build complex DMX statements and interact with an [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] server.</span></span> <span data-ttu-id="32e38-144">Para obter mais informações, consulte [consultas &#40;SQL Server suplementos de mineração de dados&#41;](query-sql-server-data-mining-add-ins.md).</span><span class="sxs-lookup"><span data-stu-id="32e38-144">For more information, see [Query &#40;SQL Server Data Mining Add-ins&#41;](query-sql-server-data-mining-add-ins.md).</span></span>

> [!NOTE]
>  <span data-ttu-id="32e38-145">Muitas instruções DMX são parametrizadas.</span><span class="sxs-lookup"><span data-stu-id="32e38-145">Many DMX statements are parameterized.</span></span> <span data-ttu-id="32e38-146">Para tipos simples, os valores dos parâmetros são listados na instrução.</span><span class="sxs-lookup"><span data-stu-id="32e38-146">For simple types, the values of the parameters are listed under the statement.</span></span> <span data-ttu-id="32e38-147">Entretanto, para tipos complexos, apenas o tipo do parâmetro é listado.</span><span class="sxs-lookup"><span data-stu-id="32e38-147">However, for complex types, only the type of the parameter is listed.</span></span>

 <span data-ttu-id="32e38-148">O SQL Server Analysis Services também usa o protocolo XMLA (XML for Analysis) para manipular todas as comunicações entre aplicativos cliente, inclusive o Cliente de Mineração de Dados para Excel e uma instância do [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="32e38-148">SQL Server Analysis Services also uses the XML for Analysis (XMLA) protocol to handle all communications between client applications, including the Data Mining Client for Excel and an instance of [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)].</span></span>

 <span data-ttu-id="32e38-149">Para obter mais informações sobre a sintaxe DMX e os comandos e elementos no XMLA, consulte os Manuais Online do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="32e38-149">For more information about DMX syntax, and about the commands and elements in XMLA, see [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Books Online.</span></span>

 <span data-ttu-id="32e38-150">Algumas das instruções enviadas ao servidor podem incluir consultas que chamam procedimentos armazenados do sistema do Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="32e38-150">Some of the statements sent to the server may include queries that call Analysis Services system stored procedures.</span></span> <span data-ttu-id="32e38-151">Para obter mais informações, consulte os Manuais Online do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="32e38-151">For more information, see SQL Server Books Online.</span></span>


