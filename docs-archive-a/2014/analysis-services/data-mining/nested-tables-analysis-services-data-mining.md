---
title: Tabelas aninhadas (Analysis Services-Mineração de dados) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- data mining [Analysis Services], nested tables
- tables [Analysis Services], nested
- nested tables
ms.assetid: cb192aa2-597e-4d4f-ac34-3556d037fed4
author: minewiskan
ms.author: owend
ms.openlocfilehash: 78b1022751ae6d381b86512f45f7232bebe7fcd0
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87679097"
---
# <a name="nested-tables-analysis-services---data-mining"></a><span data-ttu-id="2780e-102">Tabelas aninhadas (Analysis Services - Mineração de Dados)</span><span class="sxs-lookup"><span data-stu-id="2780e-102">Nested Tables (Analysis Services - Data Mining)</span></span>
  <span data-ttu-id="2780e-103">No [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , os dados devem ser alimentados para um algoritmo de Data Mining como uma série de casos contidos em uma tabela de casos.</span><span class="sxs-lookup"><span data-stu-id="2780e-103">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], data must be fed to a data mining algorithm as a series of cases that are contained within a case table.</span></span> <span data-ttu-id="2780e-104">No entanto, nem todos os casos podem ser descritos por uma única linha de dados.</span><span class="sxs-lookup"><span data-stu-id="2780e-104">However, not all cases can be described by a single row of data.</span></span> <span data-ttu-id="2780e-105">Por exemplo, um caso pode ser derivado de duas tabelas: uma contendo informações sobre o cliente e outra as compras do cliente.</span><span class="sxs-lookup"><span data-stu-id="2780e-105">For example, a case might be derived from two tables: one table that contains customer information, and another table that contains customer purchases.</span></span> <span data-ttu-id="2780e-106">Um único cliente na tabela de informações de clientes pode ter vários itens na tabela de compras do cliente, o que dificulta a descrição dos dados em uma única linha.</span><span class="sxs-lookup"><span data-stu-id="2780e-106">A single customer in the customer information table might have multiple items in the customer purchases table, which makes it difficult to describe the data by using a single row.</span></span> [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="2780e-107">fornece um método exclusivo para tratar desses casos, com o uso de *tabelas aninhadas*.</span><span class="sxs-lookup"><span data-stu-id="2780e-107">provides a unique method for handling these cases, by using *nested tables*.</span></span> <span data-ttu-id="2780e-108">O conceito de uma tabela aninhada é demonstrado na ilustração a seguir.</span><span class="sxs-lookup"><span data-stu-id="2780e-108">The concept of a nested table is demonstrated in the following illustration.</span></span>  
  
 <span data-ttu-id="2780e-109">![Duas tabelas combinadas com uma tabela aninhada](../media/nested-tables.gif "Duas tabelas combinadas com uma tabela aninhada")</span><span class="sxs-lookup"><span data-stu-id="2780e-109">![Two tables combined by using a nested table](../media/nested-tables.gif "Two tables combined by using a nested table")</span></span>  
  
 <span data-ttu-id="2780e-110">Neste diagrama, a primeira tabela, que é a tabela pai, contém informações sobre clientes e associa um identificador exclusivo para cada cliente.</span><span class="sxs-lookup"><span data-stu-id="2780e-110">In this diagram, the first table, which is the parent table, contains information about customers, and associates a unique identifier for each customer.</span></span> <span data-ttu-id="2780e-111">A segunda tabela, a tabela filho, contém as compras para cada cliente.</span><span class="sxs-lookup"><span data-stu-id="2780e-111">The second table, the child table, contains the purchases for each customer.</span></span> <span data-ttu-id="2780e-112">As compras na tabela filho são relacionadas à tabela pai pelo identificador exclusivo, a coluna **CustomerKey** .</span><span class="sxs-lookup"><span data-stu-id="2780e-112">The purchases in the child table are related to the parent table by the unique identifier, the **CustomerKey** column.</span></span> <span data-ttu-id="2780e-113">A terceira tabela no diagrama mostra as duas tabelas combinadas.</span><span class="sxs-lookup"><span data-stu-id="2780e-113">The third table in the diagram shows the two tables combined.</span></span>  
  
 <span data-ttu-id="2780e-114">Uma tabela aninhada é representada na tabela de casos como uma coluna especial com o tipo de dados **TABLE**.</span><span class="sxs-lookup"><span data-stu-id="2780e-114">A nested table is represented in the case table as a special column that has a data type of **TABLE**.</span></span> <span data-ttu-id="2780e-115">Para uma linha de casos específica, esse tipo de coluna contém linhas selecionadas da tabela filho que pertencem à tabela pai.</span><span class="sxs-lookup"><span data-stu-id="2780e-115">For any particular case row, this kind of column contains selected rows from the child table that pertain to the parent table.</span></span>  
  
 <span data-ttu-id="2780e-116">Os dados em uma tabela aninhada podem ser usados para previsão ou entrada ou para ambas.</span><span class="sxs-lookup"><span data-stu-id="2780e-116">The data in a nested table can be used for prediction or for input, or for both.</span></span> <span data-ttu-id="2780e-117">Por exemplo, você pode ter duas colunas da tabela aninhadas em um modelo: uma coluna da tabela aninhada pode conter uma lista dos produtos que um cliente comprou, enquanto a outra contém informações sobre os hobbies e interesses do cliente, possivelmente obtidos de uma pesquisa.</span><span class="sxs-lookup"><span data-stu-id="2780e-117">For example, you might have two nested table columns in a model: one nested table column might contain a list of the products that a customer has purchased, while the other nested table column contains information about the customer's hobbies and interests, possibly obtained from a survey.</span></span> <span data-ttu-id="2780e-118">Neste cenário, você pode usar os hobbies e interesses do cliente como uma entrada para analisar o comportamento de compra e prever prováveis compras.</span><span class="sxs-lookup"><span data-stu-id="2780e-118">In this scenario, you could use the customer's hobbies and interests as an input for analyzing purchasing behavior, and predicting likely purchases.</span></span>  
  
## <a name="joining-case-tables-and-nested-tables"></a><span data-ttu-id="2780e-119">Unindo tabelas de casos e tabelas aninhadas</span><span class="sxs-lookup"><span data-stu-id="2780e-119">Joining Case Tables and Nested Tables</span></span>  
 <span data-ttu-id="2780e-120">Para criar uma tabela aninhada, as duas tabelas de origem devem conter uma relação definida de forma que os itens em uma das tabelas possam ser relacionados ao da outra.</span><span class="sxs-lookup"><span data-stu-id="2780e-120">In order to create a nested table, the two source tables must contain a defined relationship so that the items in one table can be related to the other table.</span></span> <span data-ttu-id="2780e-121">No [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)], é possível definir essa relação na exibição da fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="2780e-121">In [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)], you can define this relationship in the data source view.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="2780e-122">O campo **CustomerKey** é a chave relacional usada para vincular a tabela de casos e a tabela aninhada na definição da exibição da fonte de dados e para estabelecer a relação das colunas na estrutura de mineração.</span><span class="sxs-lookup"><span data-stu-id="2780e-122">The **CustomerKey** field is the relational key that is used to link the case table and the nested table within the data source view definition, and to establish the relationship of the columns within the mining structure.</span></span> <span data-ttu-id="2780e-123">Porém, normalmente você não deveria usar essa chave relacional em modelos de mineração construídos nessa estrutura.</span><span class="sxs-lookup"><span data-stu-id="2780e-123">However, typically you should not use this relational key in mining models built on that structure.</span></span> <span data-ttu-id="2780e-124">Em geral, o melhor é omitir a coluna da chave relacional do modelo de mineração se ela servir apenas para unir as tabelas e não fornecer informações que sejam interessantes para análise.</span><span class="sxs-lookup"><span data-stu-id="2780e-124">Usually it is best to omit the relational key column from the mining model if it serves only to join the tables and does not provide information that is interesting for analysis.</span></span>  
  
 <span data-ttu-id="2780e-125">É possível criar tabelas aninhadas programaticamente usando extensões DMX ou Objetos de Gerenciamento de Análise (AMO) ou o Assistente de Mineração de Dados e o Designer de Mineração de Dados no [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2780e-125">You can create nested tables programmatically by either using Data Mining Extensions (DMX) or Analysis Management Objects (AMO), or you can use the Data Mining Wizard and Data Mining Designer in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].</span></span>  
  
## <a name="using-nested-table-columns-in-a-mining-model"></a><span data-ttu-id="2780e-126">Usando colunas da tabela aninhada em um modelo de mineração</span><span class="sxs-lookup"><span data-stu-id="2780e-126">Using Nested Table Columns in a Mining Model</span></span>  
 <span data-ttu-id="2780e-127">Na tabela de casos, com frequência, a chave é uma ID de cliente, um nome de produto ou uma data em uma série: dados que identificam de forma exclusiva uma linha da tabela.</span><span class="sxs-lookup"><span data-stu-id="2780e-127">In the case table, the key is often a customer ID, a product name, or date in a series: data that uniquely identifies a row in the table.</span></span> <span data-ttu-id="2780e-128">.</span><span class="sxs-lookup"><span data-stu-id="2780e-128">.</span></span> <span data-ttu-id="2780e-129">No entanto, em tabelas aninhadas, geralmente a chave não é a chave relacional (ou chave estrangeira), mas sim a coluna que representa o atributo que você está modelando.</span><span class="sxs-lookup"><span data-stu-id="2780e-129">However, in nested tables, the key is typically not the relational key (or foreign key) but rather the column that represents the attribute that you are modeling.</span></span>  
  
 <span data-ttu-id="2780e-130">Por exemplo, se a tabela de casos contiver pedidos e a tabela aninhada os itens do pedido, seria interessante modelar a relação entre os itens armazenados nas tabelas aninhadas de vários pedidos, que são armazenados na tabela de casos.</span><span class="sxs-lookup"><span data-stu-id="2780e-130">For example, if the case table contains orders, and the nested table contains items in the order, you would be interested in modeling the relationship between items stored in the nested table across multiple orders, which are stored in the case table.</span></span> <span data-ttu-id="2780e-131">Sendo assim, embora a tabela aninhada **Items** esteja unida à tabela de casos **Orders** pela chave relacional **OrderID**, você não deve usar **OrderID** como chave da tabela aninhada.</span><span class="sxs-lookup"><span data-stu-id="2780e-131">Therefore, although the **Items** nested table is joined to the **Orders** case table by the relational key **OrderID**, you should not use **OrderID** as the nested table key.</span></span> <span data-ttu-id="2780e-132">Em vez disso, selecione a coluna **Items** como chave da tabela aninhada, pois ela contém os dados que você deseja modelar.</span><span class="sxs-lookup"><span data-stu-id="2780e-132">Instead, you would select the **Items** column as the nested table key, because that column contains the data that you want to model.</span></span> <span data-ttu-id="2780e-133">Na maioria das vezes, é possível ignorar com segurança **OrderID** no modelo de mineração porque a relação entre a tabela de casos e a tabela aninhada já foi estabelecida pela definição da exibição da fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="2780e-133">In most cases, you can safely ignore **OrderID** in the mining model, because the relationship between the case table and the nested table has already been established by the data source view definition.</span></span>  
  
 <span data-ttu-id="2780e-134">Ao escolher uma coluna para usar como chave da tabela aninhada, certifique-se de que os valores dessa coluna sejam exclusivos em cada caso.</span><span class="sxs-lookup"><span data-stu-id="2780e-134">When you choose a column to use as the nested table key, you must ensure that the values in that column are unique for each case.</span></span> <span data-ttu-id="2780e-135">Por exemplo, se a tabela de casos representar clientes e a tabela aninhada representar itens comprados pelo cliente, certifique-se de que nenhum item aparece mais de uma vez por cliente.</span><span class="sxs-lookup"><span data-stu-id="2780e-135">For example, if the case table represents customers and the nested table represents items purchased by the customer, you must ensure that no item is listed more than one time per customer.</span></span> <span data-ttu-id="2780e-136">Se um cliente comprou o mesmo item mais de uma vez, convém criar uma outra exibição com a coluna que agrega a contagem de compras de um mesmo produto.</span><span class="sxs-lookup"><span data-stu-id="2780e-136">If a customer has purchased the same item more than one time, you might want to create a different view that has a column that aggregates the count of purchases for each unique product.</span></span>  
  
 <span data-ttu-id="2780e-137">O modo escolhido para lidar com valores duplicados em tabelas aninhadas depende do modelo de mineração que você está criando e do problema empresarial que está resolvendo.</span><span class="sxs-lookup"><span data-stu-id="2780e-137">How you decide to handle duplicate values in a nested table depends on the mining model that you are creating and the business problem that you are solving.</span></span> <span data-ttu-id="2780e-138">Em alguns cenários você pode não se preocupar com o número de vezes que um cliente comprou um determinado produto, mas desejar verificar se existe pelo menos uma compra.</span><span class="sxs-lookup"><span data-stu-id="2780e-138">In some scenarios you might not care how many times a customer has purchased a particular product, but want to check for the existence of at least one purchase.</span></span> <span data-ttu-id="2780e-139">Em outros cenários, a quantidade e a sequência de compras pode ser muito importante.</span><span class="sxs-lookup"><span data-stu-id="2780e-139">In other scenarios, the quantity and sequence of purchases might be very important.</span></span>  
  
 <span data-ttu-id="2780e-140">Se a ordem dos itens for importante, pode ser necessária uma coluna adicional que indica a sequência.</span><span class="sxs-lookup"><span data-stu-id="2780e-140">If the order of items is important, you might need an additional column that indicates the sequence.</span></span> <span data-ttu-id="2780e-141">Ao usar o algoritmo de agrupamento de sequência para criar um modelo, escolha uma coluna *key sequence* adicional para representar a ordem dos itens.</span><span class="sxs-lookup"><span data-stu-id="2780e-141">When you use the sequence clustering algorithm to create a model, you must choose an additional *key sequence* column to represent the order of the items.</span></span> <span data-ttu-id="2780e-142">A coluna key sequence é um tipo especial de chave aninhada usada somente em modelos de agrupamento de sequência e requer um tipo de dados numérico exclusivo.</span><span class="sxs-lookup"><span data-stu-id="2780e-142">The key sequence column is a special kind of nested key that is used only in sequence clustering models, and requires a unique numeric data type.</span></span> <span data-ttu-id="2780e-143">Por exemplo, inteiros e datas podem ser usados como uma coluna key sequence, mas todos os valores da sequência devem ser exclusivos.</span><span class="sxs-lookup"><span data-stu-id="2780e-143">For example, integers and dates can both be used as a key sequence column, but all sequence values must be unique.</span></span> <span data-ttu-id="2780e-144">Além da coluna key sequence, um modelo de agrupamento de sequência também possui uma chave de tabela aninhada que representa o atributo que está sendo modelado, como os produtos que foram comprados.</span><span class="sxs-lookup"><span data-stu-id="2780e-144">In addition to the key sequence column, a sequence clustering model also has a nested table key that represents the attribute that is being modeled, such as the products that have been purchased.</span></span>  
  
### <a name="using-non-key-nested-columns-from-a-nested-table"></a><span data-ttu-id="2780e-145">Usando colunas aninhadas não chave de uma tabela aninhada</span><span class="sxs-lookup"><span data-stu-id="2780e-145">Using Non-Key Nested Columns from a Nested Table</span></span>  
 <span data-ttu-id="2780e-146">Depois de definir a junção entre a tabela de casos e a tabela aninhada e de ter escolhido uma coluna que contém atributos de interesse e exclusivos para ser usada como chave da tabela aninhada, você pode incluir no modelo outras colunas da tabela aninhada para usar como entrada.</span><span class="sxs-lookup"><span data-stu-id="2780e-146">After you have defined the join between the case table and the nested table, and you have chosen a column that contains interesting and unique attributes to use as the nested table key, you can include other columns from the nested table to use as input to the model.</span></span> <span data-ttu-id="2780e-147">Todas as colunas da tabela aninhada podem ser usadas para entrada, previsão e entrada ou somente para previsão.</span><span class="sxs-lookup"><span data-stu-id="2780e-147">All columns from the nested table can be used for input, prediction and input, or for prediction only.</span></span>  
  
 <span data-ttu-id="2780e-148">Por exemplo, se a tabela aninhada contiver as colunas **Product**, **ProductQuantity**e **ProductPrice**, você poderá escolher **Product** como chave da tabela aninhada, mas adicione **ProductQuantity** à estrutura de mineração para usar como entrada.</span><span class="sxs-lookup"><span data-stu-id="2780e-148">For example, if the nested table contains the columns **Product**, **ProductQuantity**, and **ProductPrice**, you might choose **Product** as the nested table key, but add **ProductQuantity** to the mining structure to use as input.</span></span>  
  
## <a name="filtering-nested-table-data"></a><span data-ttu-id="2780e-149">Filtrando os dados da tabela aninhada</span><span class="sxs-lookup"><span data-stu-id="2780e-149">Filtering Nested Table Data</span></span>  
 <span data-ttu-id="2780e-150">No [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], é possível criar filtros para os dados que são usados para treinar ou testar um modelo de mineração de dados.</span><span class="sxs-lookup"><span data-stu-id="2780e-150">In [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], you can create filters on the data that is used to train or test a data mining model.</span></span> <span data-ttu-id="2780e-151">É possível usar um filtro para afetar a composição do modelo ou testar o modelo em um subconjunto de casos.</span><span class="sxs-lookup"><span data-stu-id="2780e-151">A filer can be used to affect the composition of the model, or to test the model on a subset of cases.</span></span> <span data-ttu-id="2780e-152">Filtros também podem ser se aplicados a tabelas aninhadas.</span><span class="sxs-lookup"><span data-stu-id="2780e-152">Filters can also be applied to nested tables.</span></span> <span data-ttu-id="2780e-153">Porém, há limitações na sintaxe que pode ser usada com tabelas aninhadas.</span><span class="sxs-lookup"><span data-stu-id="2780e-153">However, there are limitations on the syntax that can be used with nested tables.</span></span>  
  
 <span data-ttu-id="2780e-154">Frequentemente, ao aplicar um filtro a uma tabela aninhada, você está testando a existência ou não de um atributo.</span><span class="sxs-lookup"><span data-stu-id="2780e-154">Often when you apply a filter to a nested table you are testing for the existence or nonexistence of an attribute.</span></span> <span data-ttu-id="2780e-155">Por exemplo, você pode aplicar um filtro que restringe os casos usados no modelo somente aos casos que têm um valor especificado na tabela aninhada.</span><span class="sxs-lookup"><span data-stu-id="2780e-155">For example, you can apply a filter that restricts the cases used in the model to only those cases that have a specified value in the nested table.</span></span> <span data-ttu-id="2780e-156">Ou poderia restringir os casos usados no modelo a clientes que não compraram um determinado item.</span><span class="sxs-lookup"><span data-stu-id="2780e-156">Or, you could restrict the cases used in the model to customers who have not purchased a particular item.</span></span>  
  
 <span data-ttu-id="2780e-157">Ao criar filtros em tabelas aninhadas, você também pode usar operadores, como maior ou menor que.</span><span class="sxs-lookup"><span data-stu-id="2780e-157">When you create filters on a nested table, you can also use operators such as greater than or less than.</span></span> <span data-ttu-id="2780e-158">Por exemplo, você poderia restringir os casos usados no modelo a clientes que compraram pelo menos n unidades do produto de destino.</span><span class="sxs-lookup"><span data-stu-id="2780e-158">For example, you could restrict the cases used in the model to customers who had purchased at least n units of the target product.</span></span> <span data-ttu-id="2780e-159">A habilidade de aplicar filtros a atributos da tabela aninhada proporciona grande flexibilidade para personalizar modelos.</span><span class="sxs-lookup"><span data-stu-id="2780e-159">The ability to filter on nested table attributes provides great flexibility for customizing models.</span></span>  
  
 <span data-ttu-id="2780e-160">Para obter mais informações sobre como criar e usar filtros de modelo, consulte [Filtros para modelos de mineração &#40;Analysis Services – Data Mining&#41;](mining-models-analysis-services-data-mining.md).</span><span class="sxs-lookup"><span data-stu-id="2780e-160">For more information about how to create and use model filters, see [Filters for Mining Models &#40;Analysis Services - Data Mining&#41;](mining-models-analysis-services-data-mining.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="2780e-161">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="2780e-161">See Also</span></span>  
 <span data-ttu-id="2780e-162">[Algoritmos de mineração de dados &#40;mineração de dados Analysis Services&#41;](data-mining-algorithms-analysis-services-data-mining.md) </span><span class="sxs-lookup"><span data-stu-id="2780e-162">[Data Mining Algorithms &#40;Analysis Services - Data Mining&#41;](data-mining-algorithms-analysis-services-data-mining.md) </span></span>  
 [<span data-ttu-id="2780e-163">Estruturas de Mineração &#40;Analysis Services – Data Mining&#41;</span><span class="sxs-lookup"><span data-stu-id="2780e-163">Mining Structures &#40;Analysis Services - Data Mining&#41;</span></span>](mining-structures-analysis-services-data-mining.md)  
  
  
