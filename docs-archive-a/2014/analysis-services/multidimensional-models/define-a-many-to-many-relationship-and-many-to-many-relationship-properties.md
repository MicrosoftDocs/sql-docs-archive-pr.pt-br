---
title: Definir uma relação muitos-para-muitos e propriedades de relação muitos-para-muitos | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- many-to-many relationships [Analysis Services]
ms.assetid: edb5f61a-a581-467a-a367-134b7f9b849f
author: minewiskan
ms.author: owend
ms.openlocfilehash: 1cd5d46ce07ff8eb6a3893c0dac261797c6ef19e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87582647"
---
# <a name="define-a-many-to-many-relationship-and-many-to-many-relationship-properties"></a><span data-ttu-id="6c5f2-102">Definir uma relação muitos-para-muitos e as propriedades da relação muitos-para-muitos</span><span class="sxs-lookup"><span data-stu-id="6c5f2-102">Define a Many-to-Many Relationship and Many-to-Many Relationship Properties</span></span>
  <span data-ttu-id="6c5f2-103">Este tópico explica as dimensões muitos-para-muitos no Analysis Services, incluindo quando usá-las e como criá-las.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-103">This topic explains many-to-many dimensions in Analysis Services, including when to use them and how to create them.</span></span>  
  
## <a name="introduction"></a><span data-ttu-id="6c5f2-104">Introdução</span><span class="sxs-lookup"><span data-stu-id="6c5f2-104">Introduction</span></span>  
 <span data-ttu-id="6c5f2-105">O Analysis Services dá suporte a dimensões muitos-para-muitos, permitindo uma análise mais complexa do que pode ser descrito em um esquema em estrela clássico.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-105">Analysis Services supports many-to-many dimensions, allowing for more complex analytics than what can be described in a classic star schema.</span></span> <span data-ttu-id="6c5f2-106">Em um esquema em estrela clássico, todas as dimensões têm uma relação um para muitos com uma tabela de fatos.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-106">In a classic star schema, all dimensions have a one-to-many relationship with a fact table.</span></span> <span data-ttu-id="6c5f2-107">Cada fato é associado a um membro de dimensão e um simples membro de dimensão é associado a muitos fatos.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-107">Each fact joins to one dimension member; a single dimension member is associated with many facts.</span></span>  
  
 <span data-ttu-id="6c5f2-108">Muitos-para-muitos remove essa restrição de modelagem habilitando um fato (como um saldo de contas) para ser associado a vários membros da mesma dimensão (o saldo de uma conta conjunta pode ser atribuído a dois ou mais titulares de uma conta conjunta).</span><span class="sxs-lookup"><span data-stu-id="6c5f2-108">Many-to-many removes this modeling restriction by enabling a fact (such as an account balance) to be associated with multiple members of the same dimension (the balance of a joint account can be attributed to two or more owners of a joint account).</span></span>  
  
 <span data-ttu-id="6c5f2-109">Conceitualmente, uma relação dimensional de muitos-para-muitos no Analysis Services é equivalente a relações muitos-para-muitos em um modelo relacional, que dá suporte aos mesmos tipos de cenários.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-109">Conceptually, a many-to-many dimensional relationship in Analysis Services is equivalent to many-to-many relationships in a relational model, supporting the same kinds of scenarios.</span></span> <span data-ttu-id="6c5f2-110">Exemplos comuns de muitos-para-muitos incluem:</span><span class="sxs-lookup"><span data-stu-id="6c5f2-110">Common examples of many-to-many include:</span></span>  
  
-   <span data-ttu-id="6c5f2-111">Alunos inscritos em vários cursos: cada curso tem vários alunos.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-111">Students are enrolled in many courses; each course has many students.</span></span>  
  
-   <span data-ttu-id="6c5f2-112">Médicos têm muitos pacientes; pacientes têm muitos médicos.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-112">Doctors have many patients; patients have many doctors.</span></span>  
  
-   <span data-ttu-id="6c5f2-113">Clientes têm muitas contas bancárias; contas bancárias podem pertencer a mais de um cliente.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-113">Customers have many bank accounts; bank accounts might belong to more than one customer.</span></span>  
  
-   <span data-ttu-id="6c5f2-114">No Adventure Works, muitos clientes têm muitos motivos para pedir um produto, e um motivo de vendas pode ser associado a vários pedidos.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-114">In Adventure Works, many customers have many reasons for ordering a product, and a sales reason can be associated with many orders.</span></span>  
  
 <span data-ttu-id="6c5f2-115">Analiticamente, o problema que uma relação muitos-para-muitos resolve é a representação precisa de uma conta ou soma relativa à relação dimensional (geralmente eliminando contas duplicadas ao realizar cálculos para um membro de dimensão específico).</span><span class="sxs-lookup"><span data-stu-id="6c5f2-115">Analytically, the problem that a many-to-many relationship solves is accurate representation of a count or sum relative to the dimensional relationship (usually by eliminating double-counts when performing calculations for a specific dimension member).</span></span> <span data-ttu-id="6c5f2-116">Um exemplo é necessário para esclarecer esse ponto.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-116">An example is necessary to clarify this point.</span></span> <span data-ttu-id="6c5f2-117">Considere um produto ou serviço que pertence a mais de uma categoria.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-117">Consider a product or service that belongs to more than one category.</span></span> <span data-ttu-id="6c5f2-118">Se você estiver contando o número de serviços por categoria, deverá querer que um serviço que pertence a ambas as categorias seja incluído em cada uma.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-118">If you were counting the number of services by category, you would want a service belonging to both categories to be included in each one.</span></span> <span data-ttu-id="6c5f2-119">Ao mesmo tempo, você não quer superestimar o número de serviços que fornece.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-119">At the same time, you would not want to overstate the number of services that you provide.</span></span> <span data-ttu-id="6c5f2-120">Ao especificar a relação dimensional muitos-para-muitos, você tem mais probabilidade de obter os resultados corretos ao consultar por categoria ou serviço.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-120">By specifying the many-to-many dimensional relationship, you are more likely to get the correct results back when querying by category or by service.</span></span> <span data-ttu-id="6c5f2-121">No entanto, um teste completo é sempre necessário para garantir que esse é o caso.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-121">However, thorough testing is always necessary to ensure that this is the case.</span></span>  
  
 <span data-ttu-id="6c5f2-122">Estruturalmente, criar uma relação dimensional de muitos-para-muitos é semelhante a como você pode criar uma relação muitos-para-muitos em um modelo de dados relacional.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-122">Structurally, creating a many-to-many dimensional relationship is similar to how you might create many-to-many in a relational data model.</span></span> <span data-ttu-id="6c5f2-123">Enquanto um modelo relacional usa uma *tabela de junção* para armazenar associações de linha, um modelo multidimensional usa um *grupo de medidas intermediário*.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-123">Whereas a relational model uses a *junction table* to store row associations, a multidimensional model uses an *intermediate measure group*.</span></span> <span data-ttu-id="6c5f2-124">Um grupo de medidas intermediário é o termo que usamos para nos referir a uma tabela que mapeia membros de diferentes dimensões.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-124">Intermediate measure group is the term we use to refer to a table that maps members from different dimensions.</span></span>  
  
 <span data-ttu-id="6c5f2-125">Visualmente, uma relação dimensional muitos-para-muitos não é indicada em um diagrama de cubo.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-125">Visually, a many-to-many dimensional relationship is not indicated in a cube diagram.</span></span> <span data-ttu-id="6c5f2-126">Em vez disso, use a guia Uso da Dimensão para identificar rapidamente qualquer relação muitos-para-muitos em um modelo.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-126">Instead, use the Dimension Usage tab to quickly identify any many-to-many relationships in a model.</span></span> <span data-ttu-id="6c5f2-127">Uma relação muitos-para-muitos é indicada pelo seguinte ícone.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-127">A many-to-many relationship is indicated by the following icon.</span></span>  
  
 <span data-ttu-id="6c5f2-128">![Ícone de muitos para muitos no uso da dimensão](../media/ssas-m2m-icondimusage.png "Ícone de muitos para muitos no uso da dimensão")</span><span class="sxs-lookup"><span data-stu-id="6c5f2-128">![Many-to-many icon in dimension usage](../media/ssas-m2m-icondimusage.png "Many-to-many icon in dimension usage")</span></span>  
  
 <span data-ttu-id="6c5f2-129">Clique no botão para abrir a caixa de diálogo Definir Relação para verificar se o tipo de relação é muitos-para-muitos, e para visualizar qual grupo de medidas intermediário é usado na relação.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-129">Click the button to open the Define Relationship dialog box to verify the relationship type is many-to-many, and to view which intermediate measure group is used in the relationship.</span></span>  
  
 <span data-ttu-id="6c5f2-130">![Definir o botão de relação no uso da dimensão](../media/ssas-m2m-btndimusage.png "Definir o botão de relação no uso da dimensão")</span><span class="sxs-lookup"><span data-stu-id="6c5f2-130">![Define Relationship button  in dimension usage](../media/ssas-m2m-btndimusage.png "Define Relationship button  in dimension usage")</span></span>  
  
 <span data-ttu-id="6c5f2-131">Em seções subsequentes, você aprenderá a configurar uma dimensão muitos-para-muitos e testar comportamentos modelo.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-131">In subsequent sections, you will learn how to set up a many-to-many dimension and test model behaviors.</span></span> <span data-ttu-id="6c5f2-132">Se você preferir analisar informações adicionais ou tentar tutoriais primeiro, consulte **Saiba mais** no final deste artigo.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-132">If you would rather review additional information or try tutorials first, see **Learn More** at the end of this article.</span></span>  
  
## <a name="create-a-many-to-many-dimension"></a><span data-ttu-id="6c5f2-133">Criar uma dimensão muitos-para-muitos</span><span class="sxs-lookup"><span data-stu-id="6c5f2-133">Create a many-to-many dimension</span></span>  
 <span data-ttu-id="6c5f2-134">Uma relação muitos-para-muitos inclui duas dimensões que têm uma cardinalidade muitos-para-muitos, um grupo de medidas intermediário para armazenar associações de membro, e um grupo de medidas de fato contendo dados mensuráveis, como um total de vendas ou o saldo de uma conta bancária.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-134">A simple many-to-many relationship includes two dimensions having a many-to-many cardinality, an intermediate measure group for storing member associations, and a fact measure group containing measurable data, such as sum of total sales or the balance of a bank account.</span></span>  
  
 <span data-ttu-id="6c5f2-135">As dimensões em uma relação muitos-para-muitos pode ter tabelas correspondentes na DSV, onde cada dimensão no modelo é baseada em uma tabela existente em uma fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-135">Dimensions in a many-to-many relationship might have correspondent tables in the DSV, where each dimension in the model is based on an existing table in a data source.</span></span> <span data-ttu-id="6c5f2-136">Por outro lado, as dimensões em seu modelo podem derivar de menos tabelas físicas ou tabelas físicas diferentes na DSV.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-136">Conversely, the dimensions in your model might derive from fewer or different physical tables in the DSV.</span></span> <span data-ttu-id="6c5f2-137">Usando Motivos de Vendas e Pedidos de Vendas como um caso no ponto, o cubo de exemplo do Adventure Works demonstra uma relação muitos-para-muitos usando dimensões que existem como estruturas de dados de apenas modelos, sem contrapartes físicas na DSV.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-137">Using Sales Reasons and Sales Orders as a case in point, the Adventure Works sample cube demonstrates a many-to-many relationship using dimensions that exist as model-only data structures, without physical counterparts in the DSV.</span></span> <span data-ttu-id="6c5f2-138">A dimensão Pedido de Vendas tem como base uma tabela de fatos, em vez de uma tabela de dimensão, na fonte de dados subjacente.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-138">The Sales Order dimension is based on a fact table, rather than a dimension table, in the underlying data source.</span></span>  
  
 <span data-ttu-id="6c5f2-139">O próximo procedimento supõe que você já saiba quais entidades participam na relação muitos-para-muitos.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-139">The next procedure assumes that you already know which entities participate in the many-to-many relationship.</span></span> <span data-ttu-id="6c5f2-140">Consulte **Saiba mais** para estudar em mais detalhes.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-140">See **Learn More** for further study.</span></span>  
  
 <span data-ttu-id="6c5f2-141">Para ilustrar as etapas usadas para criar uma relação muitos par muitos, esse procedimento recria uma das relações muitos-para-muitos no cubo de exemplo Adventure Works.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-141">To illustrate the steps used to create a many-to-many relationship, this procedure re-creates one of the many-to-many relationships in the Adventure Works sample cube.</span></span> <span data-ttu-id="6c5f2-142">Se você tiver os dados de origem (ou seja, o data warehouse de exemplo Adventure Works) instalado em uma instância do mecanismo de banco de dados relacional, você poderá seguir essas etapas.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-142">If you have the source data (that is, the Adventure Works sample data warehouse) installed on a relational database engine instance, you can follow these steps.</span></span>  
  
#### <a name="step-1-verify-dsv-relationships"></a><span data-ttu-id="6c5f2-143">Etapa 1: Verificar as relações DSV</span><span class="sxs-lookup"><span data-stu-id="6c5f2-143">Step 1: Verify DSV relationships</span></span>  
  
1.  <span data-ttu-id="6c5f2-144">No SQL Server Data Tools, em um projeto multidimensional, crie uma fonte de dados para o data warehouse relacional Adventure Works DW 2012, hospedado em uma instância do Mecanismo de Banco de Dados do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-144">In SQL Server Data Tools, in a multidimensional project, create a data source to the Adventure Works DW 2012 relational data warehouse, hosted on a SQL Server Database Engine instance.</span></span>  
  
2.  <span data-ttu-id="6c5f2-145">Criar uma exibição de fonte de dados usando as tabelas existentes a seguir:</span><span class="sxs-lookup"><span data-stu-id="6c5f2-145">Create a Data Source View using the following existing tables:</span></span>  
  
    -   <span data-ttu-id="6c5f2-146">FactInternetSales</span><span class="sxs-lookup"><span data-stu-id="6c5f2-146">FactInternetSales</span></span>  
  
    -   <span data-ttu-id="6c5f2-147">FactInternetSalesReason</span><span class="sxs-lookup"><span data-stu-id="6c5f2-147">FactInternetSalesReason</span></span>  
  
    -   <span data-ttu-id="6c5f2-148">DimSalesReason</span><span class="sxs-lookup"><span data-stu-id="6c5f2-148">DimSalesReason</span></span>  
  
3.  <span data-ttu-id="6c5f2-149">Verifique se todas as tabelas que você planeja usar nas relações muitos-para-muitos estão relacionadas na DSV por meio de relações de chave primária.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-149">Verify that all of the tables you plan to use in the many-to-many relationships are related in the DSV through primary key relationships.</span></span> <span data-ttu-id="6c5f2-150">Esse é um requisito para estabelecer um link para o grupo de medidas intermediário em uma etapa subsequente.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-150">This is a requirement for establishing a link to the intermediate measure group in a subsequent step.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="6c5f2-151">Se a fonte de dados subjacente não fornecer relações de chave primária e estrangeira, você poderá criar as relações manualmente na DSV.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-151">If the underlying data source does not provide primary and foreign key relationships, you can create the relationships manually in the DSV.</span></span> <span data-ttu-id="6c5f2-152">Para obter mais informações, consulte [Definir relações lógicas em uma exibição da fonte de dados &#40;Analysis Services&#41;](define-logical-relationships-in-a-data-source-view-analysis-services.md).</span><span class="sxs-lookup"><span data-stu-id="6c5f2-152">For more information, see [Define Logical Relationships in a Data Source View &#40;Analysis Services&#41;](define-logical-relationships-in-a-data-source-view-analysis-services.md).</span></span>  
  
     <span data-ttu-id="6c5f2-153">O exemplo a seguir confirma que as tabelas usadas nesse procedimento estão vinculadas usando as chaves primárias.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-153">The following example confirms that the tables used in this procedure are linked using primary keys.</span></span>  
  
     <span data-ttu-id="6c5f2-154">![DSV que mostra as tabelas relacionadas](../media/ssas-m2m-dsvpkeys.PNG "DSV que mostra as tabelas relacionadas")</span><span class="sxs-lookup"><span data-stu-id="6c5f2-154">![DSV showing related tables](../media/ssas-m2m-dsvpkeys.PNG "DSV showing related tables")</span></span>  
  
#### <a name="step-2-create-dimensions-and-measure-groups"></a><span data-ttu-id="6c5f2-155">Etapa 2: Criar dimensões e grupos de medidas</span><span class="sxs-lookup"><span data-stu-id="6c5f2-155">Step 2: Create dimensions and measure groups</span></span>  
  
1.  <span data-ttu-id="6c5f2-156">No SQL Server Data Tools, em um projeto multidimensional, clique com o botão direito do mouse em **Dimensões** e selecione **Nova Dimensão**.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-156">In SQL Server Data Tools, in a multidimensional project, right-click **Dimensions** and select **New Dimension**.</span></span>  
  
2.  <span data-ttu-id="6c5f2-157">Crie uma nova dimensão com base em uma tabela existente, **DimSalesReason**.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-157">Create a new dimension based on existing table, **DimSalesReason**.</span></span> <span data-ttu-id="6c5f2-158">Aceite todos os valores padrão ao especificar a origem.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-158">Accept all of the default values when specifying the source.</span></span>  
  
     <span data-ttu-id="6c5f2-159">Para atributos, selecione tudo.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-159">For attributes, select all.</span></span>  
  
     <span data-ttu-id="6c5f2-160">![Lista de atributos em uma nova dimensão](../media/ssas-m2m-dimsalesreason.PNG "Lista de atributos em uma nova dimensão")</span><span class="sxs-lookup"><span data-stu-id="6c5f2-160">![Attributes list in new dimension](../media/ssas-m2m-dimsalesreason.PNG "Attributes list in new dimension")</span></span>  
  
3.  <span data-ttu-id="6c5f2-161">Crie uma segunda dimensão com base em uma tabela existente, Fact Internet Sales.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-161">Create a second dimension based on existing table, Fact Internet Sales.</span></span> <span data-ttu-id="6c5f2-162">Embora essa seja uma tabela de fatos, ela contém informações de Pedido de Vendas.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-162">Although this is a fact table, it contains Sales Order information.</span></span> <span data-ttu-id="6c5f2-163">Usaremos isso para criar uma dimensão de Pedido de Vendas.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-163">We'll use it to build a Sales Order dimension.</span></span>  
  
4.  <span data-ttu-id="6c5f2-164">Em Especificar Informações sobre a Origem, você verá um aviso que indica que uma coluna Nome deve ser especificada.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-164">In Specify Source Information, you will see a warning that indicates a Name column must be specified.</span></span> <span data-ttu-id="6c5f2-165">Escolha **SalesOrderNumber** como o Nome.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-165">Choose **SalesOrderNumber** as the Name.</span></span>  
  
     <span data-ttu-id="6c5f2-166">![Dimensão de pedidos de vendas que exibe a coluna de nomes](../media/ssas-m2m-dimsalesordersource.PNG "Dimensão de pedidos de vendas que exibe a coluna de nomes")</span><span class="sxs-lookup"><span data-stu-id="6c5f2-166">![Sales Order dimension showing the name column](../media/ssas-m2m-dimsalesordersource.PNG "Sales Order dimension showing the name column")</span></span>  
  
5.  <span data-ttu-id="6c5f2-167">Na próxima página do assistente, escolha os atributos.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-167">On the next page of the wizard, choose the attributes.</span></span> <span data-ttu-id="6c5f2-168">Nesse exemplo, você pode selecionar apenas **SalesOrderNumber**.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-168">In this example, you can select just **SalesOrderNumber**.</span></span>  
  
     <span data-ttu-id="6c5f2-169">![Dimensão de pedidos de vendas que exibe a lista de atributos](../media/ssas-m2m-dimsalesorderattrib.PNG "Dimensão de pedidos de vendas que exibe a lista de atributos")</span><span class="sxs-lookup"><span data-stu-id="6c5f2-169">![Sales order dimension showing attribute list](../media/ssas-m2m-dimsalesorderattrib.PNG "Sales order dimension showing attribute list")</span></span>  
  
6.  <span data-ttu-id="6c5f2-170">Renomeie a dimensão como **Dim Sales Orders**para que você tenha uma convenção de nomenclatura consistente para as dimensões.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-170">Rename the dimension to **Dim Sales Orders**, so that you have a consistent naming convention for the dimensions.</span></span>  
  
     <span data-ttu-id="6c5f2-171">![Página do assistente que mostra a renomeação da dimensão](../media/ssas-m2m-dimsalesorders.PNG "Página do assistente que mostra a renomeação da dimensão")</span><span class="sxs-lookup"><span data-stu-id="6c5f2-171">![Wizard page showing dimension rename](../media/ssas-m2m-dimsalesorders.PNG "Wizard page showing dimension rename")</span></span>  
  
7.  <span data-ttu-id="6c5f2-172">Clique com o botão direito do mouse em **Cubos** e selecione **Novo Cubo**.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-172">Right-click **Cubes** and select **New Cube**.</span></span>  
  
8.  <span data-ttu-id="6c5f2-173">Nas tabelas do grupo de medidas, escolha **FactInternetSales** e **FactInternetSalesReason**.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-173">In measure group tables, choose **FactInternetSales** and **FactInternetSalesReason**.</span></span>  
  
     <span data-ttu-id="6c5f2-174">Você está escolhendo **FactInternetSales** porque contém as medidas que deseja usar no cubo.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-174">You are choosing **FactInternetSales** because it contains the measures you want to use in the cube.</span></span> <span data-ttu-id="6c5f2-175">Você está escolhendo **FactInternetSalesReason** porque é o grupo de medidas intermediário, fornecendo dados da associação de membros que relaciona os pedidos de vendas aos motivos da venda.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-175">You are choosing **FactInternetSalesReason** because it is the intermediate measure group, providing member association data that relates sales orders to sales reasons.</span></span>  
  
9. <span data-ttu-id="6c5f2-176">Escolha as medidas para cada tabela de fatos.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-176">Choose measures for each fact table.</span></span>  
  
     <span data-ttu-id="6c5f2-177">Para simplificar seu modelo, limpe todas as medidas, em seguida, selecione apenas **Sales Amount** e **Fact Internet Sales Count** na parte inferior da lista.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-177">To simplify your model, clear all the measures, and then select just **Sales Amount** and **Fact Internet Sales Count** at the bottom of the list.</span></span> <span data-ttu-id="6c5f2-178">**FactInternetSalesReason** tem apenas uma medida, portanto, é selecionada automaticamente.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-178">The **FactInternetSalesReason** only has one measure, so it is selected for you automatically.</span></span>  
  
10. <span data-ttu-id="6c5f2-179">Na lista de dimensões, você deverá ver **Dim Sales Reason** e **Dim Sales Orders**.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-179">In the dimension list, you should see **Dim Sales Reason** and **Dim Sales Orders**.</span></span>  
  
     <span data-ttu-id="6c5f2-180">Na página Selecionar Novas Dimensões, o assistente solicita que você crie uma nova dimensão para **Fact Internet Sales Dimension**.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-180">In the Select New Dimensions page, the wizard prompts you to create a new dimension for **Fact Internet Sales Dimension**.</span></span> <span data-ttu-id="6c5f2-181">Você não precisa dessa dimensão; portanto, pode limpá-la da lista.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-181">You do not need this dimension, so you can clear it from the list.</span></span>  
  
11. <span data-ttu-id="6c5f2-182">Nomeie o cubo e clique em **Concluir**.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-182">Name the cube and click **Finish**.</span></span>  
  
#### <a name="step-3-define-many-to-many-relationship"></a><span data-ttu-id="6c5f2-183">Etapa 3: Definir a relação muitos-para-muitos</span><span class="sxs-lookup"><span data-stu-id="6c5f2-183">Step 3: Define Many-to-Many relationship</span></span>  
  
1.  <span data-ttu-id="6c5f2-184">No designer de cubo, clique na guia uso da dimensão. Observe que já existe uma relação muitos para muitos entre **Dim Sales Reason** e **Fact Internet Sales**.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-184">In cube designer, click Dimension Usage tab. Notice that there is already a many-to-many relationship between **Dim Sales Reason** and **Fact Internet Sales**.</span></span> <span data-ttu-id="6c5f2-185">Lembre-se de que o ícone a seguir indica uma relação muitos-para-muitos.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-185">Recall that the following icon indicates a many-to-many relationship.</span></span>  
  
     <span data-ttu-id="6c5f2-186">![Ícone de muitos para muitos no uso da dimensão](../media/ssas-m2m-icondimusage.png "Ícone de muitos para muitos no uso da dimensão")</span><span class="sxs-lookup"><span data-stu-id="6c5f2-186">![Many-to-many icon in dimension usage](../media/ssas-m2m-icondimusage.png "Many-to-many icon in dimension usage")</span></span>  
  
2.  <span data-ttu-id="6c5f2-187">Clique na célula de interseção entre **Dim Sales Reason** e **Fact Internet Sales**, em seguida, clique no botão para abrir a caixa de diálogo Definir Relação.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-187">Click on the intersection cell between **Dim Sales Reason** and **Fact Internet Sales**, and then click the button to open the Define Relationship dialog box.</span></span>  
  
     <span data-ttu-id="6c5f2-188">Você pode ver que essa caixa de diálogo é usada para especificar uma relação muitos-para-muitos.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-188">You can see that this dialog box is used to specify a many-to-many relationship.</span></span> <span data-ttu-id="6c5f2-189">Se você estivesse adicionando dimensões que têm uma relação regular, deveria usar essa caixa de diálogo para alterá-la para muitos-para-muitos.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-189">If you were adding dimensions that had a regular relationship instead, you would use this dialog box to change it to many-to-many.</span></span>  
  
     <span data-ttu-id="6c5f2-190">![Definir o botão de relação no uso da dimensão](../media/ssas-m2m-btndimusage.png "Definir o botão de relação no uso da dimensão")</span><span class="sxs-lookup"><span data-stu-id="6c5f2-190">![Define Relationship button  in dimension usage](../media/ssas-m2m-btndimusage.png "Define Relationship button  in dimension usage")</span></span>  
  
3.  <span data-ttu-id="6c5f2-191">Implante o projeto a uma instância multidimensional do Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-191">Deploy the project to an Analysis Services multidimensional instance.</span></span> <span data-ttu-id="6c5f2-192">Na próxima etapa, você procurará o cubo no Excel para verificar seus comportamentos.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-192">In the next step, you will browse the cube in Excel to verify its behaviors.</span></span>  
  
## <a name="testing-many-to-many"></a><span data-ttu-id="6c5f2-193">Teste de muitos-para-muitos</span><span class="sxs-lookup"><span data-stu-id="6c5f2-193">Testing Many-to-Many</span></span>  
 <span data-ttu-id="6c5f2-194">Quando você define uma relação muitos-para-muitos em um cubo, o teste é fundamental para garantir que as consultas retornem os resultados esperados.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-194">When you define a many-to-many relationship in a cube, testing is imperative to ensure queries return expected results.</span></span> <span data-ttu-id="6c5f2-195">Você deve testar o cubo usando a ferramenta de aplicativo cliente que será usada pelos usuários finais.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-195">You should test the cube using the client application tool that will be used by end-users.</span></span> <span data-ttu-id="6c5f2-196">Nesse próximo procedimento, você usará o Excel para se conectar ao cubo e verificar os resultados da consulta.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-196">In this next procedure, you will use Excel to connect to the cube and verify query results.</span></span>  
  
#### <a name="browse-the-cube-in-excel"></a><span data-ttu-id="6c5f2-197">Procurar o cubo no Excel</span><span class="sxs-lookup"><span data-stu-id="6c5f2-197">Browse the cube in Excel</span></span>  
  
1.  <span data-ttu-id="6c5f2-198">Implante o projeto e procure o cubo para confirmar se as agregações são válidas.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-198">Deploy the project and then browse the cube to confirm the aggregations are valid.</span></span>  
  
2.  <span data-ttu-id="6c5f2-199">No Excel, clique em **dados**  |  **de outras fontes**  |  **de Analysis Services**.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-199">In Excel, click **Data** | **From Other Sources** | **From Analysis Services**.</span></span> <span data-ttu-id="6c5f2-200">Insira o nome do servidor, escolha o banco de dados e o cubo.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-200">Enter the name of the server, choose the database and cube.</span></span>  
  
3.  <span data-ttu-id="6c5f2-201">Crie uma Tabela Dinâmica que use o seguinte:</span><span class="sxs-lookup"><span data-stu-id="6c5f2-201">Create a PivotTable that uses the following:</span></span>  
  
    -   <span data-ttu-id="6c5f2-202">**Sales Amount** como o Valor</span><span class="sxs-lookup"><span data-stu-id="6c5f2-202">**Sales Amount** as the Value</span></span>  
  
    -   <span data-ttu-id="6c5f2-203">**Sales Reason Name** nas Colunas</span><span class="sxs-lookup"><span data-stu-id="6c5f2-203">**Sales Reason Name** on Columns</span></span>  
  
    -   <span data-ttu-id="6c5f2-204">**Sales Order Number** nas Linhas</span><span class="sxs-lookup"><span data-stu-id="6c5f2-204">**Sales Order Number** on Rows</span></span>  
  
4.  <span data-ttu-id="6c5f2-205">Analise os resultados.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-205">Analyze the results.</span></span> <span data-ttu-id="6c5f2-206">Como estamos usando dados de exemplo, a impressão inicial é que todos os pedidos de vendas têm valores idênticos.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-206">Because we are using sample data, the initial impression is that all sales orders have identical values.</span></span> <span data-ttu-id="6c5f2-207">No entanto, se você rolar para baixo, começará a ver variação de dados.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-207">However, if you scroll down, you begin to see data variation.</span></span>  
  
     <span data-ttu-id="6c5f2-208">Do meio para baixo, você localizará os valores das vendas e os motivos das vendas para o número de pedido **SO5382**.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-208">Part way down, you can find the sales amount and sales reasons for order number **SO5382**.</span></span> <span data-ttu-id="6c5f2-209">O total geral desse pedido específico é **539,99**e os motivos da compra atribuídos a ele incluem a Promoção, Outros e Preço.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-209">Grand total of this particular order is **539.99**, and the purchase reasons attributed to this order include Promotion, Other and Price.</span></span>  
  
     <span data-ttu-id="6c5f2-210">![Planilha de Excel que mostra agregações muitos para muitos](../media/ssas-m2m-excel.png "Planilha de Excel que mostra agregações muitos para muitos")</span><span class="sxs-lookup"><span data-stu-id="6c5f2-210">![Excel worksheet showing many-to-many aggregations](../media/ssas-m2m-excel.png "Excel worksheet showing many-to-many aggregations")</span></span>  
  
     <span data-ttu-id="6c5f2-211">Observe que Sales Amount está calculado corretamente para o pedido; é **539,99** para o pedido inteiro.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-211">Notice that the Sales Amount is correctly calculated for the order; it is **539.99** for the entire order.</span></span> <span data-ttu-id="6c5f2-212">Embora **539,99** esteja indicado para cada motivo, esse valor não é somado para todos os três motivos, inflacionando erroneamente nosso total geral.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-212">Although **539.99** is indicated for each reason, that value is not summed for all three reasons, erroneously inflating our grand total.</span></span>  
  
     <span data-ttu-id="6c5f2-213">Por que motivo se deve colocar um valor de vendas sob cada motivo de vendas?</span><span class="sxs-lookup"><span data-stu-id="6c5f2-213">Why put a sales amount under each sales reason in the first place?</span></span> <span data-ttu-id="6c5f2-214">A resposta é que isso permite que nós identifiquemos o valor de vendas que podemos atribuir a cada motivo.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-214">The answer is that it allows us to identify the amount of sales we can attribute to each reason.</span></span>  
  
5.  <span data-ttu-id="6c5f2-215">Role até a parte inferior da planilha.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-215">Scroll to the bottom of the worksheet.</span></span> <span data-ttu-id="6c5f2-216">Agora é fácil ver que o Preço é o motivo mais importante para as compras dos clientes, em comparação com outros motivos assim como o total geral.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-216">It is now easy to see that Price is the most important reason for customer purchases, relative to other reasons as well as the grand total.</span></span>  
  
     <span data-ttu-id="6c5f2-217">![Pasta de trabalho do Excel que mostra totais em muitos para muitos](../media/ssas-m2m-excelgrandtotal.png "Pasta de trabalho do Excel que mostra totais em muitos para muitos")</span><span class="sxs-lookup"><span data-stu-id="6c5f2-217">![Excel workbook showing totals in many-to-many](../media/ssas-m2m-excelgrandtotal.png "Excel workbook showing totals in many-to-many")</span></span>  
  
#### <a name="tips-for-handling-unexpected-query-results"></a><span data-ttu-id="6c5f2-218">Dicas para lidar com resultados de consulta inesperados</span><span class="sxs-lookup"><span data-stu-id="6c5f2-218">Tips for handling unexpected query results</span></span>  
  
1.  <span data-ttu-id="6c5f2-219">Oculte as medidas no grupo de medidas intermediário, como a contagem, que não retornam resultados significativos em uma consulta.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-219">Hide measures in the intermediate measure group, such as the count, that do not return meaningful results in a query.</span></span> <span data-ttu-id="6c5f2-220">Isso impede que as pessoas tentem usar agregações que produzem dados insignificantes.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-220">This prevents people from trying to use aggregations producing meaningless data.</span></span> <span data-ttu-id="6c5f2-221">Para ocultar uma medida, defina **Visibilidade** como **Falso** no atributo no designer de dimensão.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-221">To hide a measure, set **Visibility** to **False** on the attribute in dimension designer.</span></span>  
  
2.  <span data-ttu-id="6c5f2-222">Crie perspectivas para usar um subconjunto de medidas e dimensões que dão suporte à experiência analítica que você quer fornecer.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-222">Create perspectives to use a subset of measures and dimensions that support the analytical experience you want to provide.</span></span> <span data-ttu-id="6c5f2-223">Possivelmente, um cubo que contém muitos grupos de medidas e dimensões não funciona bem junto em todos os casos.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-223">Possibly, a cube that contains many measure groups and dimensions do not work well together in all cases.</span></span> <span data-ttu-id="6c5f2-224">Ao isolar a dimensão e os grupos de medidas que você pretende que sejam usados juntos, você garante um resultado mais previsível.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-224">By isolating the dimensions and measure groups that you intend to be used together, you ensure a more predictable outcome.</span></span>  
  
3.  <span data-ttu-id="6c5f2-225">Sempre lembre-se de implantar e reconectar depois de alterar um modelo.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-225">Always remember to deploy and reconnect after changing a model.</span></span> <span data-ttu-id="6c5f2-226">No Excel, use o botão Atualizar na faixa de opções Analisar da Tabela Dinâmica.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-226">In Excel, use the Refresh button on the PivotTable Analyze ribbon.</span></span>  
  
4.  <span data-ttu-id="6c5f2-227">Evite usar grupos de medidas vinculados em vários relacionamentos muitos para muitos, especialmente quando esses relacionamentos estiverem em cubos diferentes.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-227">Avoid using linked measure groups in multiple many-to-many relationships, especially when those relationships are in different cubes.</span></span> <span data-ttu-id="6c5f2-228">Fazer isso poderá resultar em agregações ambíguas.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-228">Doing so can result in ambiguous aggregations.</span></span> <span data-ttu-id="6c5f2-229">Para obter mais informações, consulte [Incorrect Amounts for Linked Measures in Cubes containing Many-to-Many Relationships](https://social.technet.microsoft.com/wiki/contents/articles/22911.incorrect-amounts-for-linked-measures-in-cubes-containing-many-to-many-relationships-ssas-troubleshooting.aspx)(Quantidades incorretas de medidas vinculadas em cubos com relacionamentos muitos para muitos).</span><span class="sxs-lookup"><span data-stu-id="6c5f2-229">For more information, see [Incorrect Amounts for Linked Measures in Cubes containing Many-to-Many Relationships](https://social.technet.microsoft.com/wiki/contents/articles/22911.incorrect-amounts-for-linked-measures-in-cubes-containing-many-to-many-relationships-ssas-troubleshooting.aspx).</span></span>  
  
##  <a name="learn-more"></a><a name="bkmk_Learn"></a><span data-ttu-id="6c5f2-230">Saiba Mais</span><span class="sxs-lookup"><span data-stu-id="6c5f2-230">Learn more</span></span>  
 <span data-ttu-id="6c5f2-231">Use os links a seguir para obter informações adicionais que ajudam a dominar os conceitos.</span><span class="sxs-lookup"><span data-stu-id="6c5f2-231">Use the following links to get additional information that helps you master the concepts.</span></span>  
  
 [<span data-ttu-id="6c5f2-232">Como posso definir uma dimensão muitos-para-muitos no Analysis Services</span><span class="sxs-lookup"><span data-stu-id="6c5f2-232">How do I define a many-to-many dimension in Analysis Services</span></span>](../lesson-5-3-defining-a-many-to-many-relationship.md)  
  
 [<span data-ttu-id="6c5f2-233">A revolução muitos-para-muitos 2.0</span><span class="sxs-lookup"><span data-stu-id="6c5f2-233">The many-to-many Revolution 2.0</span></span>](https://go.microsoft.com/fwlink/?LinkId=324760)  
  
 [<span data-ttu-id="6c5f2-234">Tutorial: Exemplo de dimensão muitos-para-muitos para o SQL Server Analysis Services</span><span class="sxs-lookup"><span data-stu-id="6c5f2-234">Tutorial: Many-to-many dimension example for SQL Server Analysis Services</span></span>](https://go.microsoft.com/fwlink/?LinkId=324761)  
  
## <a name="see-also"></a><span data-ttu-id="6c5f2-235">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="6c5f2-235">See Also</span></span>  
 <span data-ttu-id="6c5f2-236">[Relações de dimensão](../multidimensional-models-olap-logical-cube-objects/dimension-relationships.md) </span><span class="sxs-lookup"><span data-stu-id="6c5f2-236">[Dimension Relationships](../multidimensional-models-olap-logical-cube-objects/dimension-relationships.md) </span></span>  
 <span data-ttu-id="6c5f2-237">[Instalar dados de exemplo e projetos para o tutorial de modelagem multidimensional Analysis Services](../install-sample-data-and-projects.md) </span><span class="sxs-lookup"><span data-stu-id="6c5f2-237">[Install Sample Data and Projects for the Analysis Services Multidimensional Modeling Tutorial](../install-sample-data-and-projects.md) </span></span>  
 <span data-ttu-id="6c5f2-238">[Implantar projetos de Analysis Services &#40;SSDT&#41;](deploy-analysis-services-projects-ssdt.md) </span><span class="sxs-lookup"><span data-stu-id="6c5f2-238">[Deploy Analysis Services Projects &#40;SSDT&#41;](deploy-analysis-services-projects-ssdt.md) </span></span>  
 [<span data-ttu-id="6c5f2-239">Perspectivas em modelos multidimensionais</span><span class="sxs-lookup"><span data-stu-id="6c5f2-239">Perspectives in Multidimensional Models</span></span>](perspectives-in-multidimensional-models.md)  
  
  
