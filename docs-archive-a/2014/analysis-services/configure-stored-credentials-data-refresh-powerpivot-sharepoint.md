---
title: Configurar credenciais armazenadas para a atualização de dados do PowerPivot (PowerPivot para SharePoint) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 987eff0f-bcfe-4bbd-81e0-9aca993a2a75
author: minewiskan
ms.author: owend
ms.openlocfilehash: 5a1350c5d776891397401e9d3127b7849281b106
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87571041"
---
# <a name="configure-stored-credentials-for-powerpivot-data-refresh-powerpivot-for-sharepoint"></a><span data-ttu-id="8cdf6-102">Configurar credenciais armazenadas para a atualização de dados PowerPivot (PowerPivot para SharePoint)</span><span class="sxs-lookup"><span data-stu-id="8cdf6-102">Configure Stored Credentials for PowerPivot Data Refresh (PowerPivot for SharePoint)</span></span>
  <span data-ttu-id="8cdf6-103">Os trabalhos de atualização de dados PowerPivot podem ser executados em qualquer conta de usuário do Windows, desde que você crie um aplicativo de destino no Serviço de Repositório Seguro para armazenar as credenciais que deseja usar.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-103">PowerPivot data refresh jobs can run under any Windows user account as long as you create a target application in Secure Store Service to store the credentials you want to use.</span></span> <span data-ttu-id="8cdf6-104">Da mesma forma, se você desejar fornecer um logon de banco de dados que varie do um usado para importar os dados originalmente no PowerPivot para Excel, poderá mapear essas credenciais para um aplicativo de destino do Serviço de Repositório Seguro e, depois, especificar esse aplicativo de destino em uma agenda de atualização de dados.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-104">Similarly, if you want to provide a database login that varies from the one used to originally import the data in PowerPivot for Excel, you can map those credentials to a Secure Store Service target application, and then specify that target application in a data refresh schedule.</span></span>  
  
 <span data-ttu-id="8cdf6-105">**[!INCLUDE[applies](../includes/applies-md.md)]** SharePoint 2010</span><span class="sxs-lookup"><span data-stu-id="8cdf6-105">**[!INCLUDE[applies](../includes/applies-md.md)]**  SharePoint 2010</span></span>  
  
 <span data-ttu-id="8cdf6-106">Após seguir as instruções deste tópico, você poderá usar a seguinte opção de credenciais na página agenda de atualização de dados PowerPivot:</span><span class="sxs-lookup"><span data-stu-id="8cdf6-106">After you follow the instructions in this topic, you will be able to use the following credentials option in the PowerPivot data refresh schedule page:</span></span>  
  
 <span data-ttu-id="8cdf6-107">![SSAS_PowerPivotDataRefreshCreds_Stored](media/ssas-powerpivotdatarefreshcreds-stored.gif "SSAS_PowerPivotDataRefreshCreds_Stored")</span><span class="sxs-lookup"><span data-stu-id="8cdf6-107">![SSAS_PowerPivotDataRefreshCreds_Stored](media/ssas-powerpivotdatarefreshcreds-stored.gif "SSAS_PowerPivotDataRefreshCreds_Stored")</span></span>  
  
 <span data-ttu-id="8cdf6-108">Este tópico explica como configurar os nomes de usuários e as senhas que são usados para atualização de dados PowerPivot em um farm do SharePoint 2010.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-108">This topic explains how to set up the user names and passwords that are used for PowerPivot data refresh in a SharePoint 2010 farm.</span></span> <span data-ttu-id="8cdf6-109">Antes de usar estas etapas, você deve ter habilitado o Serviço de Repositório Seguro e deve ter gerado uma chave mestra.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-109">Before you can use these steps, you must have enabled Secure Store Service and generated a master key.</span></span> <span data-ttu-id="8cdf6-110">Para obter mais informações, consulte [PowerPivot data Refresh com o SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md)</span><span class="sxs-lookup"><span data-stu-id="8cdf6-110">For more information, see [PowerPivot Data Refresh with SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md)</span></span>  
  
 <span data-ttu-id="8cdf6-111">Este tópico contém as seguintes seções:</span><span class="sxs-lookup"><span data-stu-id="8cdf6-111">This topic contains the following sections:</span></span>  
  
 [<span data-ttu-id="8cdf6-112">Configurar qualquer conta do Windows para atualização de dados</span><span class="sxs-lookup"><span data-stu-id="8cdf6-112">Configure any Windows account for data refresh</span></span>](#configAny)  
  
 [<span data-ttu-id="8cdf6-113">Configurar uma conta predefinida para acessar fontes de dados externas ou de terceiros</span><span class="sxs-lookup"><span data-stu-id="8cdf6-113">Configure a predefined account for accessing external or third-party data sources</span></span>](#config3rd)  
  
 <span data-ttu-id="8cdf6-114">Se você tiver problemas ao configurar ou usar a atualização de dados, consulte a página [solução de problemas de atualização de dados PowerPivot](https://go.microsoft.com/fwlink/?LinkID=223279) no wiki do TechNet para obter possíveis soluções.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-114">If you have problems configuring or using data refresh, refer to the [Troubleshooting PowerPivot Data Refresh](https://go.microsoft.com/fwlink/?LinkID=223279) page on the TechNet wiki for possible solutions.</span></span>  
  
##  <a name="configure-any-windows-account-for-data-refresh"></a><a name="configAny"></a><span data-ttu-id="8cdf6-115">Configurar qualquer conta do Windows para atualização de dados</span><span class="sxs-lookup"><span data-stu-id="8cdf6-115">Configure any Windows account for data refresh</span></span>  
 <span data-ttu-id="8cdf6-116">Quando um usuário do SharePoint define uma agenda de atualização de dados, ele deve especificar a identidade do usuário com a qual a atualização de dados é executada.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-116">When a SharePoint user defines a data refresh schedule, he or she must specify the user identity under which data refresh is performed.</span></span> <span data-ttu-id="8cdf6-117">Entre as opções estão a seleção da conta autônoma de atualização de dados PowerPivot, a inserção de sua conta de usuário de domínio Windows ou a inserção de alguma outra conta de usuário do Windows que seja válida para fins de atualização de dados.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-117">Options include selecting the PowerPivot unattended data refresh account, entering his or her Windows domain user account, or entering some other Windows user account that is valid for data refresh purposes.</span></span> <span data-ttu-id="8cdf6-118">As etapas desta seção destinam-se à última opção: especificar alguma outra conta do Windows.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-118">The steps in this section are for the last option: specifying some other Windows account.</span></span>  
  
 <span data-ttu-id="8cdf6-119">Você pode escolher essa abordagem se desejar uma alternativa ao uso da conta autônoma de atualização de dados do PowerPivot (disponível para todos os usuários do PowerPivot no SharePoint) ou as credenciais do proprietário da pasta de trabalho.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-119">You might choose this approach if you want an alternative to using the PowerPivot unattended data refresh account (available to all PowerPivot users on SharePoint) or the credentials of the workbook owner.</span></span> <span data-ttu-id="8cdf6-120">Por exemplo, você pode querer disponibilizar uma série de contas de atualização de dados para diferentes grupos de trabalho, com o objetivo de ajudar a acompanhar e gerenciar a atividade de atualização de dados no nível organizacional.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-120">For example, you might want to make a series of data refresh accounts available to different workgroups to help you track and manage data refresh activity at the organizational level.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="8cdf6-121">As pessoas e os aplicativos que usam esse aplicativo de destino (e as credenciais que ele armazena) devem ser listados como membros do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-121">People and applications that use this target application (and the credentials that it stores) must be listed as members of the application.</span></span> <span data-ttu-id="8cdf6-122">Você deve adicionar a identidade de cada aplicativo de serviço PowerPivot que usará o aplicativo de destino, a sua conta do Windows e as contas de grupo ou usuário das pessoas que especificarão esse aplicativo de destino em suas agendas de atualização de dados.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-122">You must add the identity of each PowerPivot service application that will use the target application, your Windows account, and the group or user accounts of people who will be specifying this target application in their data refresh schedules.</span></span> <span data-ttu-id="8cdf6-123">É possível especificar todas essas contas ao criar o aplicativo de destino.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-123">You can specify all of these accounts when you create the target application.</span></span> <span data-ttu-id="8cdf6-124">Se você não conhecer todas as contas de usuário e grupo que necessitarão de acesso a esse aplicativo, poderá adicioná-los posteriormente depois que o aplicativo de destino for criado.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-124">If you do not know all of the user and group accounts that will require access to this application, you can add them later after the target application is created.</span></span>  
  
 <span data-ttu-id="8cdf6-125">Há 4 partes na configuração de credenciais armazenadas para a atualização de dados:</span><span class="sxs-lookup"><span data-stu-id="8cdf6-125">There are 4 parts to configuring stored credentials for data refresh:</span></span>  
  
-   <span data-ttu-id="8cdf6-126">Criar o aplicativo de destino que armazena as credenciais.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-126">Create the target application that stores the credentials.</span></span>  
  
-   <span data-ttu-id="8cdf6-127">Conceder permissões de colaboração à conta.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-127">Grant Contribute permissions to the account.</span></span>  
  
-   <span data-ttu-id="8cdf6-128">Conceder as permissões de leitura da conta para acessar fontes de dados externas durante atualização de dados.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-128">Grant the account read permissions to access external data sources during data refresh.</span></span>  
  
-   <span data-ttu-id="8cdf6-129">Verifique se a atualização de dados funciona ao especificar este aplicativo de destino em uma agenda de atualização de dados.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-129">Verify that data refresh works when you specify this target application in a data refresh schedule.</span></span>  
  
### <a name="step-1-create-a-target-application"></a><span data-ttu-id="8cdf6-130">Etapa 1: criar um aplicativo de destino</span><span class="sxs-lookup"><span data-stu-id="8cdf6-130">Step 1: Create a target application</span></span>  
  
1.  <span data-ttu-id="8cdf6-131">Na Administração Central, em Gerenciamento de Aplicativo, clique em **Gerenciar aplicativos de serviço**.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-131">In Central Administration, in Application Management, click **Manage service applications**.</span></span>  
  
2.  <span data-ttu-id="8cdf6-132">Clique em **serviço de repositório seguro**.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-132">Click **Secure Store Service**.</span></span>  
  
3.  <span data-ttu-id="8cdf6-133">Em gerenciar aplicativos de destino, clique em **novo**.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-133">In Manage Target Applications, click **New**.</span></span>  
  
4.  <span data-ttu-id="8cdf6-134">Em ID do aplicativo de destino, digite uma cadeia de texto.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-134">In Target application ID, type a text string.</span></span> <span data-ttu-id="8cdf6-135">Ela deve ser exclusiva, mas também fácil de lembrar.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-135">The string must be unique, but it should also be easy to remember.</span></span> <span data-ttu-id="8cdf6-136">Os usuários digitarão essa cadeia de caracteres nas páginas da agenda de atualização de dados sempre que desejarem usar as credenciais armazenadas nesse aplicativo.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-136">Users will type this string in data refresh schedule pages whenever they want to use the credentials that are stored in this application.</span></span>  
  
5.  <span data-ttu-id="8cdf6-137">Em Nome para Exibição, digite um nome descritivo.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-137">In Display Name, enter a descriptive name.</span></span> <span data-ttu-id="8cdf6-138">Esse nome é usado somente para fins de exibição.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-138">This name is used for display purposes only.</span></span> <span data-ttu-id="8cdf6-139">Ele não é usado para especificar o aplicativo de destino em uma agenda de atualização de dados.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-139">It is not used to specify the target application in a data refresh schedule.</span></span>  
  
6.  <span data-ttu-id="8cdf6-140">Em Email de Contato, digite seu endereço de email.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-140">In Contact Email, type your e-mail address.</span></span>  
  
7.  <span data-ttu-id="8cdf6-141">Em tipo de aplicativo de destino, selecione **grupo**.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-141">In Target Application Type, select **Group**.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="8cdf6-142">A escolha de um tipo de conta de Grupo é necessária porque ela permite especificar todas as contas de usuário e serviço que solicitam acesso às credenciais.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-142">Choosing a Group account type is necessary because it allows you to specify all of the user and service accounts requesting access to the credentials.</span></span> <span data-ttu-id="8cdf6-143">Para cada solicitação, o Serviço do Sistema PowerPivot verifica se o solicitante é membro do aplicativo de destino.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-143">For each request, PowerPivot System Service verifies whether the requestor is a member of the target application.</span></span>  
  
8.  <span data-ttu-id="8cdf6-144">Ignore a URL da página do aplicativo de destino.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-144">Skip Target Application Page URL.</span></span> <span data-ttu-id="8cdf6-145">A atualização de dados PowerPivot não usa essa URL.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-145">PowerPivot data refresh does not use it.</span></span>  
  
9. <span data-ttu-id="8cdf6-146">Clique em **Avançar**.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-146">Click **Next**.</span></span>  
  
10. <span data-ttu-id="8cdf6-147">Na página **especificar os campos de credenciais para seu aplicativo de destino de repositório seguro** , aceite os valores padrão.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-147">In the **Specify the credentials fields for your Secure Store Target application** page, accept the default values.</span></span> <span data-ttu-id="8cdf6-148">Os nomes e tipos de campo devem ser Nome de Usuário do Windows e Senha do Windows.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-148">Field names and types should be Windows User Name and Windows Password.</span></span>  
  
11. <span data-ttu-id="8cdf6-149">Clique em Avançar.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-149">Click Next.</span></span>  
  
12. <span data-ttu-id="8cdf6-150">Em Administradores de Aplicativo de Destino, especifique as contas de usuário de domínio do Windows de usuários do SharePoint que devem ter acesso administrativo às configurações de aplicativo de destino (por exemplo, a possibilidade de adicionar ou remover contas da lista Membros).</span><span class="sxs-lookup"><span data-stu-id="8cdf6-150">In Target Application Administrators, specify the Windows domain user accounts of SharePoint users who should have administrative access to target application settings (for example, the ability to add or remove accounts from the Members list).</span></span>  
  
13. <span data-ttu-id="8cdf6-151">Em Membros, adicione as contas de usuário e grupo a seguir:</span><span class="sxs-lookup"><span data-stu-id="8cdf6-151">In Members, add the following user and group accounts:</span></span>  
  
    1.  <span data-ttu-id="8cdf6-152">Como você está criando o aplicativo, acrescente sua conta de usuário do Windows à lista de Membros.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-152">As the person creating the application, add your Windows user account to the Members list.</span></span>  
  
    2.  <span data-ttu-id="8cdf6-153">Adicione a identidade do pool de aplicativos do aplicativo de serviço PowerPivot para permitir que ele recupere as credenciais quando a atualização de dados estiver agendada para ser executada.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-153">Add the application pool identity of the PowerPivot service application so that it can retrieve the credentials when data refresh is scheduled to run.</span></span> <span data-ttu-id="8cdf6-154">Para exibir a identidade do pool de aplicativos, vá para **gerenciar aplicativos de serviço**, selecione o aplicativo de serviço PowerPivot clicando no espaço vazio ao lado do nome (isso seleciona a linha) e, em seguida, clique em **Propriedades**.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-154">To view the application pool identity, go to **Manage service applications**, select the PowerPivot service application by clicking the empty space next to the name (this selects the row), and then click **Properties**.</span></span> <span data-ttu-id="8cdf6-155">A conta de segurança que aparece nessa página é aquela que deve ser adicionada como um membro do aplicativo de destino.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-155">The security account that appears on this page is the account to add as a member of the target application.</span></span>  
  
    3.  <span data-ttu-id="8cdf6-156">Adicione as contas de usuário e grupo do Windows que irão inserir esse aplicativo de destino em agendas de atualização de dados.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-156">Add Windows user and group accounts that will be entering this target application in data refresh schedules.</span></span>  
  
14. <span data-ttu-id="8cdf6-157">Clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-157">Click **OK**.</span></span>  
  
15. <span data-ttu-id="8cdf6-158">Selecione o aplicativo de destino que você acabou de criar, clique na seta para baixo e selecione **definir credenciais.**</span><span class="sxs-lookup"><span data-stu-id="8cdf6-158">Select the target application you just created, click the down arrow and select **Set Credentials.**</span></span>  
  
16. <span data-ttu-id="8cdf6-159">Em Proprietário da Credencial, note que a lista de proprietários de credenciais é somente leitura.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-159">In Credential Owner, notice that the list of credential owners is read-only.</span></span> <span data-ttu-id="8cdf6-160">As contas com propriedade sobre as credenciais são os membros do aplicativo de destino.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-160">The accounts who have ownership over the credentials are the members of the target application.</span></span> <span data-ttu-id="8cdf6-161">Para adicionar ou remover um proprietário de credencial, adicione ou remova contas da lista de membros do aplicativo de destino.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-161">To add or remove a credential owner, you must add or remove accounts from the target application members list.</span></span>  
  
     <span data-ttu-id="8cdf6-162">Em Nome do Usuário do Windows e Senha do Windows, digite as credenciais da conta de usuário Windows que será usada para executar a atualização de dados.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-162">In Windows User Name and Windows Password, type credentials of Windows user account that will be used to run data refresh.</span></span>  
  
17. <span data-ttu-id="8cdf6-163">Clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-163">Click **OK**.</span></span>  
  
###  <a name="step-2-grant-contribute-permissions-to-the-account"></a><a name="bkmk_grant"></a><span data-ttu-id="8cdf6-164">Etapa 2: conceder permissões de colaboração para a conta</span><span class="sxs-lookup"><span data-stu-id="8cdf6-164">Step 2: Grant Contribute permissions to the account</span></span>  
 <span data-ttu-id="8cdf6-165">Para que você possa usar as credenciais armazenadas, a conta deve ter permissões de colaboração em qualquer pasta de trabalho PowerPivot para a qual seja usada.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-165">Before you can use the stored credentials, the account must be assigned Contribute permissions on any PowerPivot workbook for which it is used.</span></span> <span data-ttu-id="8cdf6-166">Esse nível de permissão é necessário para abrir a pasta de trabalho de uma biblioteca e, em seguida, salvá-la novamente na biblioteca após os dados serem atualizados.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-166">This permission level is necessary to open the workbook from a library and then save it back to the library after the data is refreshed.</span></span>  
  
 <span data-ttu-id="8cdf6-167">Atribuir permissões é uma etapa executada pelo administrador da coleção de sites.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-167">Assigning permissions is a step that is performed by the site collection administrator.</span></span> <span data-ttu-id="8cdf6-168">Podem ser atribuídas permissões do SharePoint na coleção de sites raiz ou em qualquer nível abaixo desse, inclusive em documentos e itens individuais.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-168">SharePoint permissions can be assigned at the root site collection or at any level below that, including on individual documents and items.</span></span> <span data-ttu-id="8cdf6-169">A forma como você define permissões irá variar dependendo do quanto elas precisam ser granulares.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-169">How you set permissions will vary depending on how granular you need them to be.</span></span> <span data-ttu-id="8cdf6-170">As etapas a seguir mostram uma abordagem para conceder permissões.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-170">The following steps show you one approach for granting permissions.</span></span>  
  
1.  <span data-ttu-id="8cdf6-171">Em um site do SharePoint, em ações do site, clique em **permissões do site**.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-171">On a SharePoint site, in Site Actions, click **Site Permissions**.</span></span>  
  
2.  <span data-ttu-id="8cdf6-172">Clique em **Conceder Permissões**.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-172">Click **Grant Permissions**.</span></span>  
  
3.  <span data-ttu-id="8cdf6-173">Em Selecionar usuários, digite o nome da conta de usuário do domínio Windows que você especificou no aplicativo de destino.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-173">In Select users, type the name of the Windows domain user account that you specified in the target application.</span></span>  
  
4.  <span data-ttu-id="8cdf6-174">Em conceder permissões, selecione **conceder aos usuários a permissão diretamente**.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-174">In Grant Permissions, select **Grant users permission directly**.</span></span>  
  
5.  <span data-ttu-id="8cdf6-175">Selecione **Contribute**e clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-175">Select **Contribute**, and then click **OK**.</span></span>  
  
###  <a name="step-3-grant-read-permissions-to-access-external-data-sources-used-in-data-refresh"></a><a name="bkmk_dbread"></a><span data-ttu-id="8cdf6-176">Etapa 3: conceder permissões de leitura para acessar fontes de dados externas usadas na atualização de dados</span><span class="sxs-lookup"><span data-stu-id="8cdf6-176">Step 3: Grant read permissions to access external data sources used in data refresh</span></span>  
 <span data-ttu-id="8cdf6-177">Ao importar dados para uma pasta de trabalho PowerPivot, as conexões com dados externos são frequentemente baseadas em conexões confiáveis ou em conexões representadas que usam a identidade do usuário atual para conectar-se à fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-177">When importing data into a PowerPivot workbook, connections to external data are often based on trusted connections or impersonated connections that use the identity of the current user to connect to the data source.</span></span> <span data-ttu-id="8cdf6-178">Estes tipos de conexões funcionam apenas quando o usuário atual tem permissão para ler os dados que está importando.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-178">These types of connections work only when the current user has permission to read the data that he or she is importing.</span></span>  
  
 <span data-ttu-id="8cdf6-179">Em um cenário de atualização de dados, a mesma cadeia de conexão que foi usada para importar os dados é agora reutilizada para atualizar os dados.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-179">In a data refresh scenario, the same connection string that was used to import data is now reused to refresh the data.</span></span> <span data-ttu-id="8cdf6-180">Se a cadeia de conexão assumir o usuário atual (por exemplo, uma cadeia de caracteres que inclua Integrated_Security=SSPI), o Serviço do Sistema PowerPivot passará a identidade do usuário especificada no aplicativo de destino como o usuário atual.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-180">If the connection string assumes the current user (for example, a string that includes Integrated_Security=SSPI), then the PowerPivot System Service will pass the user identity specified in the target application as the current user.</span></span> <span data-ttu-id="8cdf6-181">Essa conexão terá êxito apenas se a conta tiver permissões de leitura na fonte de dados externa.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-181">This connection will only succeed if the account has read permissions on the external data source.</span></span>  
  
 <span data-ttu-id="8cdf6-182">Por isso, conceda permissões somente leitura à conta em todas as fontes de dados externas usadas durante a atualização de dados.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-182">For this reason, you must grant the account read-only permissions on all of the external data sources that are used during data refresh.</span></span>  
  
 <span data-ttu-id="8cdf6-183">Se você for administrador das fontes de dados usadas em sua organização, poderá criar um logon e atribuir as permissões necessárias.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-183">If you are an administrator of the data sources used in your organization, you can create a login and assign the necessary permissions.</span></span> <span data-ttu-id="8cdf6-184">Caso contrário, você deverá entrar em contato com os proprietários dos dados e fornecer as informações da conta.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-184">Otherwise, you must contact the data owners and provide the account information.</span></span> <span data-ttu-id="8cdf6-185">Especifique a conta de usuário do domínio Windows que é mapeada para o aplicativo de destino.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-185">Be sure to specify the Windows domain user account that maps to the target application.</span></span> <span data-ttu-id="8cdf6-186">Esta é a conta que você especificou em "etapa 1: criar um aplicativo de destino" neste tópico.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-186">This is the account you specified in "Step 1: Create a target application" in this topic.</span></span>  
  
###  <a name="step-4-verify-account-availability-in-data-refresh-configuration-pages"></a><a name="bkmk_verify"></a><span data-ttu-id="8cdf6-187">Etapa 4: verificar a disponibilidade da conta nas páginas de configuração de atualização de dados</span><span class="sxs-lookup"><span data-stu-id="8cdf6-187">Step 4: Verify account availability in data refresh configuration pages</span></span>  
  
1.  <span data-ttu-id="8cdf6-188">Abra uma página de configuração de atualização de dados para uma pasta de trabalho publicada que contém dados do PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-188">Open a data refresh configuration page for a published workbook that contains PowerPivot data.</span></span> <span data-ttu-id="8cdf6-189">Para obter instruções sobre como abrir a página, consulte [agendar uma atualização de dados &#40;PowerPivot para SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="8cdf6-189">For instructions on how to open the page, see [Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md).</span></span>  
  
2.  <span data-ttu-id="8cdf6-190">Verifique se a opção **conectar usando as credenciais salvas em serviço de repositório seguro (SSS) para fazer logon na fonte de dados** está habilitada na página configuração de atualização de dados e, em seguida, digite o nome do aplicativo de destino.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-190">Verify that the **Connect using the credentials saved in Secure Store Service (SSS) to log on to the data source** option is enabled in the data refresh configuration page, and then enter the name of the target application.</span></span>  
  
3.  <span data-ttu-id="8cdf6-191">Marque a caixa de seleção **também atualizar assim que possível** e clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-191">Select the **Also refresh as soon as possible** checkbox, and then click **OK**.</span></span>  
  
4.  <span data-ttu-id="8cdf6-192">Na biblioteca que contém a pasta de trabalho, selecione a pasta de trabalho, clique na seta para baixo que aparece à direita e selecione **gerenciar atualização de dados PowerPivot**.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-192">In the library that contains the workbook, select the workbook, click the down arrow that appears to right, and then select **Manage PowerPivot Data Refresh**.</span></span> <span data-ttu-id="8cdf6-193">Talvez seja necessário aguardar alguns minutos se o trabalho de atualização de dados estiver retornando um grande volume de dados.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-193">You might need to wait several minutes if the data refresh job is returning a large amount of data.</span></span>  
  
 <span data-ttu-id="8cdf6-194">Se ocorrer um erro, você poderá clicar em **Configurar agendamento** na página Histórico de atualização de dados para experimentar credenciais diferentes.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-194">If an error occurs, you can click **Configure schedule** in the data refresh history page to try different credentials.</span></span> <span data-ttu-id="8cdf6-195">Talvez você também precise inspecionar as informações de conexão de fonte de dados na pasta de trabalho original para exibir a cadeia de conexão que é usada durante a atualização de dados.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-195">You might also need to inspect the data source connection information in the original workbook to view the connection string that is used during data refresh.</span></span> <span data-ttu-id="8cdf6-196">A cadeia de conexão oferecerá informações sobre o local do servidor e o banco de dados que pode ser usado para solucionar o problema.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-196">The connection string will provide information about the server location and database that you can use to troubleshoot the problem.</span></span>  
  
 <span data-ttu-id="8cdf6-197">Para obter mais informações sobre solução de problemas, consulte [solução de problemas de atualização de dados PowerPivot](https://go.microsoft.com/fwlink/p/?LinkID=223279) no wiki do TechNet.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-197">For more information about troubleshooting, see [Troubleshooting PowerPivot Data Refresh](https://go.microsoft.com/fwlink/p/?LinkID=223279) on the TechNet Wiki.</span></span>  
  
##  <a name="configure-a-predefined-account-for-accessing-external-or-third-party-data-sources"></a><a name="config3rd"></a><span data-ttu-id="8cdf6-198">Configurar uma conta predefinida para acessar fontes de dados externas ou de terceiros</span><span class="sxs-lookup"><span data-stu-id="8cdf6-198">Configure a predefined account for accessing external or third-party data sources</span></span>  
 <span data-ttu-id="8cdf6-199">Servidores de banco de dados costumam conter os próprios métodos de autenticação.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-199">Database servers often come with their own authentication methods.</span></span> <span data-ttu-id="8cdf6-200">Se você tiver uma pasta de trabalho do PowerPivot que exige credenciais de banco de dados para acessar uma fonte de dados externa durante a atualização de dados, poderá criar uma ID de aplicativo de destino para as credenciais e, depois, especificar o aplicativo de destino na seção Fontes de dados da página de atualização de dados programada.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-200">If you have a PowerPivot workbook that requires database credentials to access an external data source during data refresh, you can create a target application ID for the credentials, and then specify the target application in the Data Sources section of the schedule data refresh page.</span></span>  
  
 <span data-ttu-id="8cdf6-201">Esta etapa somente será necessária se você quiser proporcionar aos usuários uma opção de substituir as credenciais de banco de dados que já estão inseridas na pasta de trabalho PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-201">This step is only necessary if you want to provide users with an option of overriding the database credentials that are already embedded in the PowerPivot workbook.</span></span>  
  
 <span data-ttu-id="8cdf6-202">Esta etapa só funciona quando a cadeia de conexão já inclui um nome de usuário e uma senha.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-202">This step only works if the connection string already includes a user name and password.</span></span> <span data-ttu-id="8cdf6-203">Note que a existência de credenciais na cadeia de conexão é relativamente incomum; portanto, sua capacidade de fazer uso desta opção é limitada.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-203">Note that having credentials in the connection string is relatively uncommon, so your ability to make use of this option is somewhat limited.</span></span> <span data-ttu-id="8cdf6-204">Na maioria dos casos, você terá apenas uma ID de usuário e uma senha na cadeia de conexão se estiver usando a autenticação de banco de dados para se conectar à fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-204">In most cases, you will only have a user ID and password in the connection string if you are using database authentication to connect to the data source.</span></span> <span data-ttu-id="8cdf6-205">Para obter mais informações sobre como verificar a cadeia de conexão para ver se ela inclui uma ID de usuário e uma senha, consulte a seção "conceder permissões para criar agendas e acessar dados externos" na [atualização de dados PowerPivot com o SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md).</span><span class="sxs-lookup"><span data-stu-id="8cdf6-205">For more information about how to check the connection string to see if it includes a User ID and password, see the "Grant permissions to create schedules and access external data" section in [PowerPivot Data Refresh with SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md).</span></span>  
  
1.  <span data-ttu-id="8cdf6-206">Na Administração Central, em Gerenciamento de Aplicativo, clique em **Gerenciar aplicativos de serviço**.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-206">In Central Administration, in Application Management, click **Manage service applications**.</span></span>  
  
2.  <span data-ttu-id="8cdf6-207">Clique em **serviço de repositório seguro**.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-207">Click **Secure Store Service**.</span></span>  
  
3.  <span data-ttu-id="8cdf6-208">Em gerenciar aplicativos de destino, clique em **novo**.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-208">In Manage Target Applications, click **New**.</span></span>  
  
4.  <span data-ttu-id="8cdf6-209">Em ID do aplicativo de destino, digite uma cadeia de texto.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-209">In Target application ID, type a text string.</span></span> <span data-ttu-id="8cdf6-210">Ela deve ser exclusiva, mas também fácil de lembrar.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-210">The string must be unique, but it should also be easy to remember.</span></span> <span data-ttu-id="8cdf6-211">Os usuários digitarão essa cadeia de caracteres nas páginas da agenda de atualização de dados sempre que desejarem usar as credenciais armazenadas nesse aplicativo.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-211">Users will type this string in data refresh schedule pages whenever they want to use the credentials that are stored in this application.</span></span>  
  
5.  <span data-ttu-id="8cdf6-212">Em Nome para Exibição, digite um nome descritivo.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-212">In Display Name, enter a descriptive name.</span></span> <span data-ttu-id="8cdf6-213">Esse nome é usado somente para fins de exibição.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-213">This name is used for display purposes only.</span></span> <span data-ttu-id="8cdf6-214">Ele não é usado para especificar o aplicativo de destino em uma agenda de atualização de dados.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-214">It is not used to specify the target application in a data refresh schedule.</span></span>  
  
6.  <span data-ttu-id="8cdf6-215">Em Email de Contato, digite seu endereço de email.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-215">In Contact Email, type your e-mail address.</span></span>  
  
7.  <span data-ttu-id="8cdf6-216">Em tipo de aplicativo de destino, selecione **grupo**.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-216">In Target Application Type, select **Group**.</span></span>  
  
8.  <span data-ttu-id="8cdf6-217">Ignore a URL da página do aplicativo de destino.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-217">Skip Target Application Page URL.</span></span> <span data-ttu-id="8cdf6-218">A atualização de dados PowerPivot não usa essa URL.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-218">PowerPivot data refresh does not use it.</span></span>  
  
9. <span data-ttu-id="8cdf6-219">Clique em **Avançar**.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-219">Click **Next**.</span></span>  
  
10. <span data-ttu-id="8cdf6-220">Na página **especificar os campos de credenciais para seu aplicativo de destino de repositório seguro** , aceite os valores padrão somente se a fonte de dados usar a autenticação do Windows.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-220">In the **Specify the credentials fields for your Secure Store Target application** page, accept the default values only if the data source uses Windows authentication.</span></span> <span data-ttu-id="8cdf6-221">Caso contrário, escolha os tipos de campo que são válidos para a sua fonte de dados e edite os nomes de campo para corresponder ao tipo.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-221">Otherwise, choose the field types that are valid for your data source, and then edit the field names to match the type.</span></span>  
  
     <span data-ttu-id="8cdf6-222">Por exemplo, você pode especificar Nome de Usuário SQL Server e Senha de Usuário SQL Server para nomes de campos e, depois, escolher Nome de Usuário e Senha para tipos de campos.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-222">For example, you might specify SQL Server User Name and SQL Server User Password for field names, and then choose User Name and Password for field types.</span></span>  
  
11. <span data-ttu-id="8cdf6-223">Clique em Avançar.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-223">Click Next.</span></span>  
  
12. <span data-ttu-id="8cdf6-224">Em Administradores de Aplicativo de Destino, especifique as contas de usuário de domínio do Windows de usuários do SharePoint que devem ter acesso administrativo às configurações de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-224">In Target Application Administrators, specify the Windows domain user accounts of SharePoint users who should have administrative access to the application settings.</span></span>  
  
13. <span data-ttu-id="8cdf6-225">Em Membros, adicione as contas de usuário e grupo a seguir:</span><span class="sxs-lookup"><span data-stu-id="8cdf6-225">In Members, add the following user and group accounts:</span></span>  
  
    1.  <span data-ttu-id="8cdf6-226">Como você está criando o aplicativo, acrescente sua conta de usuário do Windows à lista de Membros.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-226">As the person creating the application, add your Windows user account to the Members list.</span></span>  
  
    2.  <span data-ttu-id="8cdf6-227">Adicione a identidade de pool de aplicativos de cada aplicativo de serviço PowerPivot que estará usando o aplicativo de destino para acessar suas credenciais armazenadas.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-227">Add the application pool identity of each PowerPivot service application that will be using the target application to access its stored credentials.</span></span> <span data-ttu-id="8cdf6-228">Para exibir a identidade, vá para **gerenciar aplicativos de serviço**, selecione o aplicativo de serviço PowerPivot clicando no espaço vazio ao lado do nome (isso seleciona a linha) e, em seguida, clique em **Propriedades**.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-228">To view the identity, go to **Manage service applications**, select the PowerPivot service application by clicking the empty space next to the name (this selects the row), and then click **Properties**.</span></span> <span data-ttu-id="8cdf6-229">A conta de segurança que aparece nesta página é a conta que você deseja adicionar como um membro do aplicativo de destino.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-229">The security account that appears on this page is the account that you want to add as a member of the target application.</span></span>  
  
    3.  <span data-ttu-id="8cdf6-230">Adicione as contas de usuário e grupo do Windows que irão inserir esse aplicativo de destino na seção de fontes de dados de uma página de agenda de atualização de dados.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-230">Add Windows user and group accounts that will be entering this target application in the data sources section of a data refresh schedule page.</span></span>  
  
14. <span data-ttu-id="8cdf6-231">Clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-231">Click **OK**.</span></span>  
  
15. <span data-ttu-id="8cdf6-232">Selecione o aplicativo de destino que você acabou de criar, clique na seta para baixo e selecione **definir credenciais.**</span><span class="sxs-lookup"><span data-stu-id="8cdf6-232">Select the target application you just created, click the down arrow and select **Set Credentials.**</span></span>  
  
16. <span data-ttu-id="8cdf6-233">Digite as credenciais que serão usadas para se conectar à fonte de dados (por exemplo, o nome de usuário e a senha de um logon do SQL Server).</span><span class="sxs-lookup"><span data-stu-id="8cdf6-233">Enter the credentials that will be used to connect to the data source (for example, the user name and password of a SQL Server login).</span></span>  
  
17. <span data-ttu-id="8cdf6-234">Clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="8cdf6-234">Click **OK**.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8cdf6-235">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="8cdf6-235">See Also</span></span>  
 <span data-ttu-id="8cdf6-236">[Agendar uma atualização de dados &#40;PowerPivot para SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md) </span><span class="sxs-lookup"><span data-stu-id="8cdf6-236">[Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md) </span></span>  
 [<span data-ttu-id="8cdf6-237">Atualização de dados PowerPivot com SharePoint 2010</span><span class="sxs-lookup"><span data-stu-id="8cdf6-237">PowerPivot Data Refresh with SharePoint 2010</span></span>](powerpivot-data-refresh-with-sharepoint-2010.md)  
  
  
