---
title: Armazenamento de cadeia de caracteres e agrupamento em modelos de tabela | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 8516f0ad-32ee-4688-a304-e705143642ca
author: minewiskan
ms.author: owend
ms.openlocfilehash: 3aad4cf16c39897bc0796f4fb161eaf39abdb5fd
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87684360"
---
# <a name="string-storage-and-collation-in-tabular-models"></a><span data-ttu-id="d5b6c-102">Ordenação e armazenamento de cadeia de caracteres em modelos tabulares</span><span class="sxs-lookup"><span data-stu-id="d5b6c-102">String Storage and Collation in Tabular Models</span></span>
  <span data-ttu-id="d5b6c-103">Cadeias de caracteres (valores de texto) são armazenadas em um formato altamente compactado em modelos de tabela; por causa desta compactação, você pode obter resultados inesperados ao recuperar cadeias de caracteres inteiras ou parciais.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-103">Strings (text values) are stored in a highly compressed format in tabular models; because of this compression, you can get unexpected results when you retrieve entire or partial strings.</span></span> <span data-ttu-id="d5b6c-104">Além disso, como a localidade e a ordenação são herdadas hierarquicamente do objeto pai mais próximo, se o idioma da cadeia de caracteres não for definido explicitamente, a localidade e a ordenação do pai poderão afetar como cada cadeia de caracteres é armazenada e se ela é exclusiva ou combinada com cadeias de caracteres semelhantes, conforme definido pela ordenação pai.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-104">Also, because string locale and collations are inherited hierarchically from the closest parent object, if the string language is not explicitly defined, the locale and collation of the parent can affect how each string is stored and whether the string is unique or conflated with similar strings as defined by the parent collation.</span></span>  
  
 <span data-ttu-id="d5b6c-105">Este tópico descreve o mecanismo pelo qual cadeias de caracteres são compactadas e armazenados e também fornece exemplos de como a ordenação e o idioma afetam os resultados de fórmulas de texto em modelos de tabela.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-105">This topic describes the mechanism by which strings are compressed and stored, and provides examples of how collation and language affect the results of text formulas in tabular models.</span></span>  
  
## <a name="storage"></a><span data-ttu-id="d5b6c-106">Armazenamento</span><span class="sxs-lookup"><span data-stu-id="d5b6c-106">Storage</span></span>  
 <span data-ttu-id="d5b6c-107">Em modelos de tabela, todos os dados são compactados para melhor ajuste na memória.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-107">In tabular models all data is highly compressed to better fit in memory.</span></span> <span data-ttu-id="d5b6c-108">Como consequência, todas as cadeias de caracteres consideradas lexicalmente equivalentes são armazenadas apenas uma vez.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-108">As a consequence, all strings that can be considered lexically equivalent are stored only once.</span></span> <span data-ttu-id="d5b6c-109">A primeira instância da cadeia de caracteres é usada como a representação canônica e, a partir daí, cada cadeia de caracteres equivalente é indexada com o mesmo valor compactado que a primeira ocorrência.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-109">The first instance of the string is used as the canonical representation and thereafter each equivalent string is indexed to the same compressed value as the first occurrence.</span></span>  
  
 <span data-ttu-id="d5b6c-110">A pergunta-chave é: o que constitui uma cadeia de caracteres lexicalmente equivalente?</span><span class="sxs-lookup"><span data-stu-id="d5b6c-110">The key question is: what constitutes a lexically equivalent string?</span></span> <span data-ttu-id="d5b6c-111">Duas cadeias de caracteres serão consideradas lexicalmente equivalentes quando podem ser consideradas como a mesma palavra.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-111">Two strings are considered lexically equivalent if they can be considered as the same word.</span></span> <span data-ttu-id="d5b6c-112">Por exemplo, em inglês, quando você procura a palavra **violin** em um dicionário, pode encontrar a entrada **Violin** ou **violin**, dependendo da política editorial do dicionário, mas geralmente considera as duas palavras equivalentes e desconsidera a diferença de capitalização.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-112">For example, in English when you search for the word **violin** in a dictionary, you might find the entry **Violin** or **violin**, depending on the editorial policy of the dictionary, but generally you consider both words equivalent, and disregard the difference in capitalization.</span></span> <span data-ttu-id="d5b6c-113">Em um modelo de tabela, o fator que determina se duas cadeias de caracteres são lexicalmente equivalentes não é a política editorial e nem a preferência do usuário, mas sim a localidade e a ordem de ordenação atribuídos à coluna.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-113">In a tabular model, the factor that determines whether two strings are lexically equivalent is not editorial policy or even user preference, but the locale and collation order assigned to the column.</span></span>  
  
 <span data-ttu-id="d5b6c-114">Portanto, a ordenação e a localidade determinam se letras maiúsculas e minúsculas devem ser tratadas como iguais ou diferentes.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-114">Therefore, the decision of whether uppercase and lowercase letters should be handled as the same or different depends on the collation and locale.</span></span> <span data-ttu-id="d5b6c-115">Para qualquer palavra específica dentro dessa localidade, a primeira ocorrência da palavra encontrada dentro de uma coluna específica serve como a representação canônica dessa palavra e essa cadeia de caracteres é armazenada em formato descompactado.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-115">For any particular word within that locale, the first occurrence of the word that is found within a particular column therefore serves as the canonical representation of that word and that string is stored in uncompressed format.</span></span>  <span data-ttu-id="d5b6c-116">Todas as demais cadeias de caracteres são testadas na primeira ocorrência e, se elas corresponderem ao teste de equivalência, serão atribuídas ao valor compactado da primeira ocorrência.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-116">All other strings are tested against the first occurrence, and if they match the equivalence test, they are assigned to the compressed value of the first occurrence.</span></span> <span data-ttu-id="d5b6c-117">Posteriormente, quando os valores compactados são recuperados, eles são representados usando o valor descompactado da primeira ocorrência da cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-117">Later, when the compressed values are retrieved they are represented using the uncompressed value of the first occurrence of the string.</span></span>  
  
 <span data-ttu-id="d5b6c-118">Um exemplo o ajudará a esclarecer como isso funciona.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-118">An example will help to clarify how this works.</span></span> <span data-ttu-id="d5b6c-119">A coluna a seguir "Classificação - em inglês" foi extraída de uma tabela que contém informações sobre plantas e árvores.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-119">The following column "Classification - English" was extracted from a table that contains information about plants and trees.</span></span> <span data-ttu-id="d5b6c-120">Para cada planta (os nomes das plantas não são mostrados aqui), a coluna de classificação mostra a categoria geral de planta.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-120">For each plant (the names of the plants are not shown here) the classification column shows the general category of plant.</span></span>  
  
|<span data-ttu-id="d5b6c-121">Classificação - em inglês</span><span class="sxs-lookup"><span data-stu-id="d5b6c-121">Classification - English</span></span>|  
|-------------------------------|  
|<span data-ttu-id="d5b6c-122">trEE</span><span class="sxs-lookup"><span data-stu-id="d5b6c-122">trEE</span></span>|  
|<span data-ttu-id="d5b6c-123">PlAnT</span><span class="sxs-lookup"><span data-stu-id="d5b6c-123">PlAnT</span></span>|  
|<span data-ttu-id="d5b6c-124">trEE</span><span class="sxs-lookup"><span data-stu-id="d5b6c-124">TREE</span></span>|  
|<span data-ttu-id="d5b6c-125">PlAnT</span><span class="sxs-lookup"><span data-stu-id="d5b6c-125">PLANT</span></span>|  
|<span data-ttu-id="d5b6c-126">PlAnT</span><span class="sxs-lookup"><span data-stu-id="d5b6c-126">Plant</span></span>|  
|<span data-ttu-id="d5b6c-127">Árvore</span><span class="sxs-lookup"><span data-stu-id="d5b6c-127">Tree</span></span>|  
|<span data-ttu-id="d5b6c-128">PlAnT</span><span class="sxs-lookup"><span data-stu-id="d5b6c-128">plant</span></span>|  
|<span data-ttu-id="d5b6c-129">trEE</span><span class="sxs-lookup"><span data-stu-id="d5b6c-129">tReE</span></span>|  
|<span data-ttu-id="d5b6c-130">tree</span><span class="sxs-lookup"><span data-stu-id="d5b6c-130">tree</span></span>|  
|<span data-ttu-id="d5b6c-131">PlAnT</span><span class="sxs-lookup"><span data-stu-id="d5b6c-131">pLaNt</span></span>|  
|<span data-ttu-id="d5b6c-132">trEE</span><span class="sxs-lookup"><span data-stu-id="d5b6c-132">tREE</span></span>|  
  
 <span data-ttu-id="d5b6c-133">Talvez os dados sejam de origens diferentes e, portanto, o uso de maiúsculas/minúsculas e acentos era inconsistente, e o banco de dados relacional armazenou essas diferenças como tal.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-133">Perhaps the data came from many different sources, and so the casing and use of accents was inconsistent, and the relational database stored those differences as is.</span></span> <span data-ttu-id="d5b6c-134">Mas, em geral, os valores são **Plant** ou **Tree**, apenas com diferença em maiúsculas/minúsculas.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-134">But in general the values are either **Plant** or **Tree**, just with different casing.</span></span>  
  
 <span data-ttu-id="d5b6c-135">Quando esses valores são carregados em um modelo tabular que usa o agrupamento padrão e a ordem de classificação para inglês (Estados Unidos), Case não é importante, portanto, apenas dois valores seriam armazenados para toda a coluna:</span><span class="sxs-lookup"><span data-stu-id="d5b6c-135">When these values are loaded into a tabular model that uses the default collation and sorting order for English (United States), case is not important, so only two values would be stored for the entire column:</span></span>  
  
|<span data-ttu-id="d5b6c-136">Classificação - em inglês</span><span class="sxs-lookup"><span data-stu-id="d5b6c-136">Classification - English</span></span>|  
|-------------------------------|  
|<span data-ttu-id="d5b6c-137">trEE</span><span class="sxs-lookup"><span data-stu-id="d5b6c-137">trEE</span></span>|  
|<span data-ttu-id="d5b6c-138">PlAnT</span><span class="sxs-lookup"><span data-stu-id="d5b6c-138">PlAnT</span></span>|  
  
 <span data-ttu-id="d5b6c-139">Se você usar a coluna, **classificação-inglês**, em seu modelo, onde quer que você exiba a classificação de planta, você verá não os valores originais, com seus vários usos de maiúsculas e minúsculas, mas apenas a primeira instância.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-139">If you use the column, **Classification - English**, in your model, wherever you display plant classification you will see not the original values, with their various uses of upper and lower case, but only the first instance.</span></span> <span data-ttu-id="d5b6c-140">A razão é que todas as variantes de maiúsculas e minúsculas de **tree** são consideradas equivalentes nesta ordenação e localidade; portanto, apenas uma cadeia de caracteres foi preservada e a primeira instância dessa cadeia de caracteres que é encontrada pelo sistema é salva.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-140">The reason is that all the uppercase and lowercase variants of **tree** are considered equivalent in this collation and locale; therefore, only one string was preserved and the first instance of that string that is encountered by the system is the one that is saved.</span></span>  
  
> [!WARNING]  
>  <span data-ttu-id="d5b6c-141">Você pode optar por definir a cadeia de caracteres que será a primeira a armazenar, de acordo com o que considere correto, mas isso pode ser difícil.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-141">You might decide that you want to define which string will be the first to store, according to what you consider correct, but this could be very hard to so.</span></span> <span data-ttu-id="d5b6c-142">Não existe uma maneira simples de determinar previamente a linha que deve ser processada primeiro pelo mecanismo, pois todos os valores são considerados equivalentes.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-142">There is no simple way to determine in advance which row should be processed first by the engine, given that all values are considered to be the same.</span></span> <span data-ttu-id="d5b6c-143">Se você precisar definir o valor padrão, limpe todas as cadeias de caracteres antes de carregar o modelo.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-143">Instead, if you need to set the standard value, you should cleanse all your strings before loading the model.</span></span>  
  
## <a name="locale-and-collation-order"></a><span data-ttu-id="d5b6c-144">Localidade e ordem de ordenação</span><span class="sxs-lookup"><span data-stu-id="d5b6c-144">Locale and Collation Order</span></span>  
 <span data-ttu-id="d5b6c-145">Ao comparar cadeias de caracteres (valores de texto), o que define a equivalência costuma ser o aspecto cultural de como cadeias de caracteres são interpretadas.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-145">When comparing strings (text values), what defines equivalence is normally the cultural aspect of how such strings are interpreted.</span></span> <span data-ttu-id="d5b6c-146">Em algumas culturas, um acento ou a capitalização de um caractere pode alterar totalmente o significado da cadeia de caracteres; portanto, tais diferenças em geral são consideradas ao determinar a equivalência de qualquer idioma ou região específica.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-146">In some cultures an accent or the capitalization of a character can completely change the meaning of the string; therefore, typically such differences are considered when determining equivalency for any particular language or region.</span></span>  
  
 <span data-ttu-id="d5b6c-147">Normalmente, quando você usa seu computador, ele já está configurado para coincidir suas próprias expectativas culturais e o comportamento linguístico; operações de cadeia de caracteres como classificar e comparar valores de texto se comportam da forma esperada.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-147">Usually, when you use your computer it is already configured to match your own cultural expectations and linguistic behavior, and string operations such as sorting and comparing text values behaves as you would expect.</span></span> <span data-ttu-id="d5b6c-148">São definidas as configurações que controlam o comportamento específico a um idioma através das configurações **Localidade e Regional** no Windows.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-148">The settings that control language-specific behavior are defined through the **Locale and Regional** settings in Windows.</span></span> <span data-ttu-id="d5b6c-149">Os aplicativos leem essas configurações e alteram o comportamento de forma correspondente.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-149">Applications read those settings and change their behavior accordingly.</span></span> <span data-ttu-id="d5b6c-150">Em alguns casos, um aplicativo pode ter um recurso que lhe permite alterar o comportamento cultural do aplicativo ou o modo no qual as cadeias de caracteres são comparadas.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-150">In some cases, an application might have a feature that allows you to change the cultural behavior of the application or the way in which strings are compared.</span></span>  
  
 <span data-ttu-id="d5b6c-151">Quando você estiver criando um banco de dados modelo de tabela, por padrão o banco de dados herdará estas configurações culturais e linguísticas na forma de um identificador de idioma e ordenação.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-151">When you are creating a tabular model database, by default the database inherits these cultural and linguistic settings in the form of a language identifier and collation.</span></span>  
  
-   <span data-ttu-id="d5b6c-152">O identificador de idioma define o conjunto de caracteres que você deseja usar para suas cadeias de caracteres de acordo com sua cultura.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-152">The language identifier defines the character set you want to use for your strings according to your culture.</span></span>  
  
-   <span data-ttu-id="d5b6c-153">A ordenação define a ordenação dos caracteres e sua equivalência.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-153">The collation defines the ordering of the characters and their equivalence.</span></span>  
  
 <span data-ttu-id="d5b6c-154">É importante observar que um identificador de idioma não só identifica um idioma, mas também o país ou região onde o idioma é usado.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-154">It is important to note that a language identifier not only identifies a language but, also the country or region where the language is used.</span></span> <span data-ttu-id="d5b6c-155">Cada identificador de idioma também tem uma especificação de ordenação padrão.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-155">Each language identifier also has a default collation specification.</span></span> <span data-ttu-id="d5b6c-156">Para obter mais informações sobre identificadores de idioma, consulte [IDs de localidade atribuídas pela Microsoft](https://msdn.microsoft.com/goglobal/bb964664.aspx).</span><span class="sxs-lookup"><span data-stu-id="d5b6c-156">For more information about language identifiers, see [Locale IDs Assigned by Microsoft](https://msdn.microsoft.com/goglobal/bb964664.aspx).</span></span> <span data-ttu-id="d5b6c-157">Você pode usar a coluna LCID Dec para obter a ID correta ao inserir um valor manualmente.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-157">You can use the LCID Dec column to get the correct ID when manually inserting a value.</span></span> <span data-ttu-id="d5b6c-158">Para obter mais informações sobre o conceito SQL de ordenações, consulte [COLLATE &#40;Transact-SQL&#41;](/sql/t-sql/statements/collations).</span><span class="sxs-lookup"><span data-stu-id="d5b6c-158">For more information about the SQL concept of collations, see [COLLATE &#40;Transact-SQL&#41;](/sql/t-sql/statements/collations).</span></span> <span data-ttu-id="d5b6c-159">Para obter mais informações sobre os designadores de ordenação e os estilos de comparação para nomes de ordenações do Windows, consulte [Nome de ordenação do Windows &#40;Transact-SQL&#41;](/sql/t-sql/statements/windows-collation-name-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="d5b6c-159">For information about the collation designators and the comparison styles for Windows collation names, see [Windows Collation Name &#40;Transact-SQL&#41;](/sql/t-sql/statements/windows-collation-name-transact-sql).</span></span> <span data-ttu-id="d5b6c-160">O tópico [Nome de ordenação do SQL Server &#40;Transact-SQL&#41;](/sql/t-sql/statements/sql-server-collation-name-transact-sql), mapeia os nomes de ordenação do Windows para os nomes usados para SQL.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-160">The topic, [SQL Server Collation Name &#40;Transact-SQL&#41;](/sql/t-sql/statements/sql-server-collation-name-transact-sql), maps the Windows collation names to the names used for SQL.</span></span>  
  
 <span data-ttu-id="d5b6c-161">Quando seu banco de dados modelo de tabela for criado, todos os novos objetos no modelo herdarão os atributos de idioma e ordenação do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-161">Once your tabular model database has been created, all new objects in the model will inherit the language and collation attributes from the database attributes.</span></span> <span data-ttu-id="d5b6c-162">Isto vale para todos os objetos.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-162">This is true for all objects.</span></span> <span data-ttu-id="d5b6c-163">O caminho de herança começa no objeto, observa o pai de quaisquer atributos de idioma e ordenação a serem herdados e, se nenhum é localizado, continua na parte superior e localiza os atributos de idioma e ordenação em nível de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-163">The inheritance path begins at the object, looks at the parent for any language and collation attributes to inherit, and if none are found, continues to the top and finds the language and collation attributes at the database level.</span></span> <span data-ttu-id="d5b6c-164">Em outras palavras, se você não especificar os atributos de idioma e ordenação para um objeto, por padrão, o objeto herdará os atributos de seu pai mais próximo.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-164">In other words, if you do not specify the language and collation attributes for an object, by default, the object inherits the attributes of its closest parent.</span></span>  
  
 <span data-ttu-id="d5b6c-165">Para colunas, os atributos de idioma e ordenação são herdados na criação, de acordo com as seguintes regras:</span><span class="sxs-lookup"><span data-stu-id="d5b6c-165">For columns, the language and collation attributes are inherited at creation, according to the following rules:</span></span>  
  
1.  <span data-ttu-id="d5b6c-166">O objeto de dimensão pai é pesquisado para os atributos de idioma e ordenação.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-166">The parent dimension object is searched for language and collation attributes.</span></span> <span data-ttu-id="d5b6c-167">Se ambos os valores existirem, eles serão copiados nos atributos da coluna; se existir apenas um, o outro será inferido a partir de um existente e ambos serão atribuídos; se nenhum existir, passe para a próxima etapa.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-167">If both values exist, they are copied to the column attributes; if only one exists, the other is inferred from the existing one and both are assigned; if none exist, move to next step.</span></span>  
  
2.  <span data-ttu-id="d5b6c-168">O objeto de banco de dados que usa o mesmo processo descrito em Etapa 1 para dimensões é pesquisado; se nenhum atributo for localizado, mova à próxima etapa.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-168">The database object is searched using the same process described in Step 1 for dimensions; if no attributes are found, move to the next step.</span></span>  
  
3.  <span data-ttu-id="d5b6c-169">O objeto de servidor é pesquisado usando o mesmo processo descrito na Etapa 1 para dimensões; se nenhum atributo for localizado, a coluna usará o identificador de idioma do Windows e inferirá o atributo de ordenação desse valor.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-169">The server object is searched using the same process described in Step 1 for dimensions; if no attributes are found, the column uses the Windows language identifier and infers the collation attribute from that value.</span></span>  
  
 <span data-ttu-id="d5b6c-170">É importante observar que normalmente o identificador de idioma e a ordem de ordenação no banco de dados de origem têm pouco ou nenhum efeito sobre a forma como valores são armazenados na coluna de modelo de tabela.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-170">It is important to note that typically the language identifier and collation order in the source database has little to no effect on how values are stored in the tabular model column.</span></span> <span data-ttu-id="d5b6c-171">A exceção será se o banco de dados de origem transformar ou filtrar os valores solicitados.</span><span class="sxs-lookup"><span data-stu-id="d5b6c-171">The exception is if the source database transforms or filters the requested values.</span></span>  
  
  
