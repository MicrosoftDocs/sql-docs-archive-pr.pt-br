---
title: Autenticação e autorização do PowerPivot | Microsoft Docs
ms.custom: ''
ms.date: 03/09/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 48230cc0-4037-4f99-8360-dadf4bc169bd
author: minewiskan
ms.author: owend
ms.openlocfilehash: 1cf777960b24d9c65c7e7f7d9651eeb48e0fe42b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87679051"
---
# <a name="powerpivot-authentication-and-authorization"></a><span data-ttu-id="ba8ff-102">Autenticação e autorização PowerPivot</span><span class="sxs-lookup"><span data-stu-id="ba8ff-102">PowerPivot Authentication and Authorization</span></span>
  <span data-ttu-id="ba8ff-103">Uma implantação do PowerPivot para SharePoint, executada dentro de um farm do SharePoint 2010, usa o subsistema de autenticação e o modelo de autorização fornecidos pelos servidores do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-103">A PowerPivot for SharePoint deployment that runs within a SharePoint 2010 farm uses the authentication subsystem and authorization model provided by SharePoint servers.</span></span> <span data-ttu-id="ba8ff-104">A infraestrutura de segurança do SharePoint se estende ao conteúdo e operações do PowerPivot porque todo o conteúdo relacionado ao PowerPivot é armazenado nos bancos de dados de conteúdo do SharePoint, e todas as operações relacionadas ao PowerPivot é executado pelos serviços compartilhados PowerPivot no farm.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-104">SharePoint security infrastructure extends to PowerPivot content and operations because all PowerPivot-related content is stored in SharePoint content databases and all PowerPivot-related operations are performed by PowerPivot shared services in the farm.</span></span> <span data-ttu-id="ba8ff-105">Os usuários que solicitam uma pasta de trabalho que contém dados PowerPivot são autenticados, usando uma identidade de usuário do SharePoint que é baseada na respectiva identidade de usuário do Windows.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-105">Users who request a workbook that contains PowerPivot data are authenticated using a SharePoint user identity that is based on their Windows user identity.</span></span> <span data-ttu-id="ba8ff-106">As permissões de exibição na pasta de trabalho determinam se a solicitação é concedida ou negada.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-106">View permissions on the workbook determine whether the request is granted or denied.</span></span>  
  
 <span data-ttu-id="ba8ff-107">Como a integração com os Serviços do Excel é necessária para análises de dados de autoatendimento, a proteção de um servidor do PowerPivot exige que você também compreenda a segurança dos Serviços do Excel.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-107">Because integration with Excel Services is required for self-service data analytics, securing a PowerPivot server requires that you also understand Excel Services security.</span></span> <span data-ttu-id="ba8ff-108">Quando um usuário consulta um Tabela Dinâmica que tem uma conexão de dados a dados PowerPivot, os Serviços do Excel encaminham uma solicitação de conexão de dados a um servidor do PowerPivot no farm para carregar os dados.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-108">When a user queries a PivotTable that has a data connection to PowerPivot data, Excel Services forwards a data connection request to a PowerPivot server in the farm to load the data.</span></span> <span data-ttu-id="ba8ff-109">Essa interação entre os servidores exige que você compreenda como configurar parâmetros de segurança para ambos os servidores.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-109">This interaction between the servers requires that you understand how to configure security settings for both servers.</span></span>  
  
 <span data-ttu-id="ba8ff-110">Clique nos links a seguir para ler seções específicas deste tópico:</span><span class="sxs-lookup"><span data-stu-id="ba8ff-110">Click the following links to read specific sections in this topic:</span></span>  
  
 [<span data-ttu-id="ba8ff-111">Autenticação do Windows usando o requisito de logon do modo clássico</span><span class="sxs-lookup"><span data-stu-id="ba8ff-111">Windows Authentication Using Classic Mode Sign-in Requirement</span></span>](power-pivot-authentication-and-authorization.md#bkmk_auth)  
  
 [<span data-ttu-id="ba8ff-112">Operações do PowerPivot que exigem autorização do usuário</span><span class="sxs-lookup"><span data-stu-id="ba8ff-112">PowerPivot Operations Requiring User Authorization</span></span>](#UserConnections)  
  
 [<span data-ttu-id="ba8ff-113">Permissões do SharePoint para acesso a dados PowerPivot</span><span class="sxs-lookup"><span data-stu-id="ba8ff-113">SharePoint Permissions for PowerPivot Data Access</span></span>](#Permissions)  
  
 [<span data-ttu-id="ba8ff-114">Considerações de segurança dos serviços do Excel para pastas de trabalho PowerPivot</span><span class="sxs-lookup"><span data-stu-id="ba8ff-114">Excel Services security considerations for PowerPivot workbooks</span></span>](#excel)  
  
##  <a name="windows-authentication-using-classic-mode-sign-in-requirement"></a><a name="bkmk_auth"></a><span data-ttu-id="ba8ff-115">Autenticação do Windows usando o requisito de logon no modo clássico</span><span class="sxs-lookup"><span data-stu-id="ba8ff-115">Windows Authentication Using Classic Mode Sign-in Requirement</span></span>  
 <span data-ttu-id="ba8ff-116">O PowerPivot para SharePoint dá suporte a um conjunto reduzido das opções de autenticação que estão disponíveis no SharePoint.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-116">PowerPivot for SharePoint supports a reduced set of the authentication options that are available in SharePoint.</span></span> <span data-ttu-id="ba8ff-117">Das opções de autenticação disponíveis, somente autenticação do Windows tem suporte para uma implantação do PowerPivot para SharePoint.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-117">Of the available authentication options, only Windows authentication is supported for a PowerPivot for SharePoint deployment.</span></span> <span data-ttu-id="ba8ff-118">Além disso, o aplicativo Web pelo qual o logon ocorre deve ser configurado para o modo clássico.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-118">In addition, the web application through which sign-in occurs must be configured for classic mode.</span></span>  
  
 <span data-ttu-id="ba8ff-119">A autenticação do Windows é exigida porque o mecanismo de dados do Analysis Services em uma implantação do PowerPivot para SharePoint só dá suporte à autenticação do Windows.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-119">Windows authentication is required because the Analysis Services data engine in a PowerPivot for SharePoint deployment supports only Windows authentication.</span></span> <span data-ttu-id="ba8ff-120">Os serviços do Excel estabelecem conexões com o Analysis Services pelo provedor do OLE DB de MSOLAP usando uma identidade de usuário do Windows que foi autenticada por NTLM ou o protocolo Kerberos.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-120">Excel Services establishes connections to Analysis Services via the MSOLAP OLE DB provider using a Windows user identity that was authenticated via NTLM or the Kerberos protocol.</span></span>  
  
 <span data-ttu-id="ba8ff-121">O segundo requisito, a autenticação de modo clássica no aplicativo Web, é exigido para assegurar o operabilidade do serviço Web PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-121">The second requirement, classic mode authentication on the web application, is required to ensure the operability of the PowerPivot web service.</span></span> <span data-ttu-id="ba8ff-122">O serviço Web é um componente executado em um front-end da Web e fornece redirecionamento HTTP para o servidor do PowerPivot para SharePoint no farm.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-122">The web service is a component that runs on a Web front-end and provides HTTP redirection to a PowerPivot for SharePoint server in the farm.</span></span> <span data-ttu-id="ba8ff-123">Enquanto o serviço Web tem reconhecimento de declaração para comunicações entre serviços, não tem reconhecimento de declaração para as solicitações de conexão de dados que ele roteia para um serviço compartilhado do PowerPivot no farm.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-123">While the web service is claims aware for service-to-service communications, it is not claims aware for the data connection requests that it routes to a PowerPivot shared service in the farm.</span></span> <span data-ttu-id="ba8ff-124">As solicitações para carregar dados PowerPivot têm suporte somente para conexões autenticadas que vêm do IIS usando uma identidade do Windows.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-124">Requests to load PowerPivot data are only supported for authenticated connections that come from IIS using a Windows identity.</span></span> <span data-ttu-id="ba8ff-125">O logon em modo clássico no aplicativo Web é o que habilita uma conexão bem-sucedida do serviço Web PowerPivot para os serviços compartilhados PowerPivot no farm.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-125">Classic mode sign-in on the web application is what enables a successful connection from the PowerPivot web service to PowerPivot shared services in the farm.</span></span>  
  
 <span data-ttu-id="ba8ff-126">Embora o logon em modo clássico não seja necessário para o cenário mais comum de acesso a dados (onde os dados PowerPivot são extraídos da mesma pasta de trabalho do Excel que os renderiza), não tente usar o PowerPivot para SharePoint com aplicativos Web do SharePoint configurados para usar outros provedores de autenticação.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-126">Although classic mode sign-in is not required for the more common data access scenario (where PowerPivot data is extracted from the same Excel workbook that renders it) do not attempt to use PowerPivot for SharePoint with SharePoint web applications that are configured to use other authentication providers.</span></span> <span data-ttu-id="ba8ff-127">Se isso for feito, o resultado será uma falha na conexão sempre que os usuários tentarem conectar pastas de trabalho PowerPivot como uma fonte de dados externa.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-127">Doing so will result in a connection failure whenever users try to connect to PowerPivot workbooks as an external data source.</span></span>  
  
 <span data-ttu-id="ba8ff-128">Sem o logon do modo clássico, os seguintes tipos de solicitações que são tratados pelo serviço Web PowerPivot falharão:</span><span class="sxs-lookup"><span data-stu-id="ba8ff-128">Without classic mode sign-in, the following types of requests that are handled by PowerPivot Web service will fail:</span></span>  
  
-   <span data-ttu-id="ba8ff-129">Qualquer solicitação de dados PowerPivot originada fora do farm (por exemplo, criação de um relatório no Designer de Relatórios ou no Construtor de Relatórios, em que a fonte de dados é uma URL do SharePoint URL para uma pasta de trabalho PowerPivot)</span><span class="sxs-lookup"><span data-stu-id="ba8ff-129">Any request for PowerPivot data that originates from outside the farm (for example, creating a report in Report Designer or Report Builder, where the data source is a SharePoint URL to a PowerPivot workbook)</span></span>  
  
-   <span data-ttu-id="ba8ff-130">Solicitações no farm de um aplicativo cliente ou relatório que use a pasta de trabalho PowerPivot como uma fonte de dados externa (por exemplo, criação de uma pasta de trabalho no aplicativo desktop Excel, usando como fonte de dados uma segunda pasta de trabalho Excel publicada que contém dados PowerPivot)</span><span class="sxs-lookup"><span data-stu-id="ba8ff-130">In-farm requests from a client application or report that uses the PowerPivot workbook as an external data source (for example, creating a workbook in the Excel desktop application, using as your data source a second published Excel workbook containing PowerPivot data)</span></span>  
  
### <a name="how-to-check-the-authentication-provider-for-your-application"></a><span data-ttu-id="ba8ff-131">Como verificar o provedor de autenticação do seu aplicativo</span><span class="sxs-lookup"><span data-stu-id="ba8ff-131">How to check the authentication provider for your application</span></span>  
 <span data-ttu-id="ba8ff-132">Ao criar novos aplicativos Web, selecione a opção **Autenticação de modo clássico** na página Criar Novo Aplicativo Web.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-132">When creating new web applications, be sure to select the **Classic mode authentication** option in the Create New Web Application page.</span></span>  
  
 <span data-ttu-id="ba8ff-133">Para aplicativos Web existentes, use as instruções a seguir para verificar se o aplicativo Web está configurado para usar autenticação do Windows.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-133">For existing web applications, use the following instructions to verify the web application is configured to use Windows authentication.</span></span>  
  
1.  <span data-ttu-id="ba8ff-134">Na administração central, em gerenciamento de aplicativos, clique em **gerenciar aplicativos Web**.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-134">In Central Administration, in Application Management, click **Manage web applications**.</span></span>  
  
2.  <span data-ttu-id="ba8ff-135">Selecione o aplicativo Web.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-135">Select the web application.</span></span>  
  
3.  <span data-ttu-id="ba8ff-136">Clique em **Provedores de autenticação**.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-136">Click **Authentication Providers**.</span></span>  
  
4.  <span data-ttu-id="ba8ff-137">Verifique se você tem um provedor para cada zona, e se a zona Padrão é definida como Windows.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-137">Verify that you have one provider for each zone, and the Default zone is set to Windows.</span></span>  
  
##  <a name="powerpivot-operations-requiring-user-authorization"></a><a name="UserConnections"></a><span data-ttu-id="ba8ff-138">Operações do PowerPivot que exigem autorização do usuário</span><span class="sxs-lookup"><span data-stu-id="ba8ff-138">PowerPivot Operations Requiring User Authorization</span></span>  
 <span data-ttu-id="ba8ff-139">A autorização do SharePoint é usada exclusivamente para todos os níveis de acesso à consulta do PowerPivot e ao processamento de dados.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-139">SharePoint authorization is used exclusively for all levels of access to PowerPivot query and data processing.</span></span>  
  
 <span data-ttu-id="ba8ff-140">O modelo de autorização baseado em funções do Analysis Services não tem suporte.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-140">The Analysis Services role-based authorization model is not supported.</span></span> <span data-ttu-id="ba8ff-141">Não há nenhuma autorização baseada em função para os dados PowerPivot no nível de célula, linha ou tabela.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-141">There is no role-based authorization for PowerPivot data at the cell, row, or table level.</span></span> <span data-ttu-id="ba8ff-142">Você não pode proteger partes diferentes da pasta de trabalho para conceder ou negar acesso a dados confidenciais dentro delas para usuários específicos.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-142">You cannot secure different parts of the workbook to grant or deny access to sensitive data within it for specific users.</span></span> <span data-ttu-id="ba8ff-143">Os dados PowerPivot inseridos estão totalmente disponíveis para os usuários que têm permissões de Exibição na pasta de trabalho do Excel em uma biblioteca do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-143">Embedded PowerPivot data is wholly available to users who have View permissions on the Excel workbook in a SharePoint library.</span></span>  
  
 <span data-ttu-id="ba8ff-144">O PowerPivot para SharePoint representará um usuário do SharePoint nos seguintes casos:</span><span class="sxs-lookup"><span data-stu-id="ba8ff-144">PowerPivot for SharePoint will impersonate a SharePoint user in the following cases:</span></span>  
  
-   <span data-ttu-id="ba8ff-145">Consultas a Tabelas Dinâmicas ou Gráficos Dinâmicos que têm conexões de dados com um banco de dados PowerPivot, onde um aplicativo do serviço PowerPivot estabelece conexões em nome de um usuário com uma instância do serviço compartilhado PowerPivot específica que processa os dados.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-145">Queries to PivotTables or PivotCharts that have data connections to a PowerPivot database, where a PowerPivot service application establishes connections on behalf of a user to a specific PowerPivot shared service instance that processes the data.</span></span>  
  
-   <span data-ttu-id="ba8ff-146">Carregando dados PowerPivot do cache ou de uma biblioteca se os dados não estiverem disponíveis de outra maneira.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-146">Loading PowerPivot data from cache or a library if the data is not otherwise available.</span></span> <span data-ttu-id="ba8ff-147">Se uma solicitação de conexão de dados for feita para dados PowerPivot que ainda não estão carregados no sistema, a instância do [!INCLUDE[ssGeminiSrv](../../includes/ssgeminisrv-md.md)] usará a identidade do usuário do SharePoint para recuperar a fonte de dados de uma biblioteca de conteúdo e carregá-la na memória.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-147">If a data connection request is made for PowerPivot data that is not already loaded in the system, the [!INCLUDE[ssGeminiSrv](../../includes/ssgeminisrv-md.md)] instance will use the identity of the SharePoint user to retrieve the data source from a content library and load it into memory.</span></span>  
  
-   <span data-ttu-id="ba8ff-148">Operações de atualização de dados que salvam uma cópia atualizada da fonte de dados na pasta de trabalho em uma biblioteca de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-148">Data refresh operations that save an updated copy of the data source to the workbook in a content library.</span></span> <span data-ttu-id="ba8ff-149">Neste caso, um log real em operação é executado usando o nome de usuário e a senha que são recuperados de um aplicativo de destino no Serviço de Repositório Seguro.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-149">In this case, an actual log on operation is performed using the user name and password that is retrieved from a target application in Secure Store Service.</span></span> <span data-ttu-id="ba8ff-150">As credenciais podem ser a conta autônoma de atualização de dados PowerPivot ou credenciais que foram armazenadas com a agenda de atualização de dados quando ela foi criada.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-150">Credentials can be the PowerPivot unattended data refresh account, or credentials that were stored with the data refresh schedule when it was created.</span></span> <span data-ttu-id="ba8ff-151">Para obter mais informações, consulte [configurar credenciais armazenadas para a atualização de dados PowerPivot &#40;PowerPivot para SharePoint&#41;](../configure-stored-credentials-data-refresh-powerpivot-sharepoint.md) e [Configurar a conta de atualização de dados autônoma do PowerPivot &#40;PowerPivot para SharePoint ](../configure-unattended-data-refresh-account-powerpivot-sharepoint.md)&#41;.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-151">For more information, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](../configure-stored-credentials-data-refresh-powerpivot-sharepoint.md) and [Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](../configure-unattended-data-refresh-account-powerpivot-sharepoint.md).</span></span>  
  
##  <a name="sharepoint-permissions-for-powerpivot-data-access"></a><a name="Permissions"></a><span data-ttu-id="ba8ff-152">Permissões do SharePoint para acesso a dados PowerPivot</span><span class="sxs-lookup"><span data-stu-id="ba8ff-152">SharePoint Permissions for PowerPivot Data Access</span></span>  
 <span data-ttu-id="ba8ff-153">A publicação, gerenciamento e proteção de uma pasta de trabalho PowerPivot têm suporte apenas por meio da integração do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-153">Publishing, managing, and securing a PowerPivot workbook is supported solely through SharePoint integration.</span></span> <span data-ttu-id="ba8ff-154">Os servidores do SharePoint fornecem subsistemas de autenticação e autorização que garantem acesso legítimo aos dados.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-154">SharePoint servers provide authentication and authorization subsystems that ensure legitimate access to data.</span></span> <span data-ttu-id="ba8ff-155">Não há nenhum cenário com suporte para implantar uma pasta de trabalho PowerPivot de maneira segura fora de um farm do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-155">There are no supported scenarios for securely deploying a PowerPivot workbook outside of a SharePoint farm.</span></span>  
  
 <span data-ttu-id="ba8ff-156">O acesso do usuário a dados PowerPivot é somente leitura no servidor por meio de permissões de Exibição ou mais altas.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-156">User access to PowerPivot data is read-only on the server through View permissions or higher.</span></span> <span data-ttu-id="ba8ff-157">Permissões de colaboração permitem adicionar e editar o arquivo.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-157">Contribute permissions allow for adding and editing the file.</span></span> <span data-ttu-id="ba8ff-158">As alterações aos dados PowerPivot exigem que você baixe a pasta de trabalho para um aplicativo de área de trabalho do Excel que tenha o PowerPivot para Excel instalado.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-158">Changes to PowerPivot data require that you download the workbook to an Excel desktop application that has PowerPivot for Excel installed.</span></span> <span data-ttu-id="ba8ff-159">As permissões de colaboração no arquivo determinarão se o usuário pode baixar o arquivo localmente e, em seguida, salvar as alterações novamente no SharePoint.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-159">Contribute permissions on the file will determine whether the user can download the file locally and then save changes back to SharePoint.</span></span>  
  
 <span data-ttu-id="ba8ff-160">Dessa forma, níveis de permissão de Colaboração e Somente Exibição definem o conjunto efetivo de permissões para acesso de usuário aos dados PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-160">As such, Contribute and View Only levels of permission define the effective set of permissions for user access to PowerPivot data.</span></span> <span data-ttu-id="ba8ff-161">Outros níveis de permissão funcionam na medida em que têm as mesmas permissões que Colaboração e Somente Exibição (por exemplo, como Leitura inclui permissões Somente Exibição, um usuário que receba a permissão de Leitura terá o mesmo nível de acesso que Somente Leitura).</span><span class="sxs-lookup"><span data-stu-id="ba8ff-161">Other permission levels work to the extent that they have the same permissions as Contribute and View Only (For example, because Read includes View Only permissions, a user who is assigned to Read will have same level of access as View Only).</span></span>  
  
 <span data-ttu-id="ba8ff-162">A tabela a seguir resume os níveis de permissão que determinam acesso a dados PowerPivot e as operações de servidor:</span><span class="sxs-lookup"><span data-stu-id="ba8ff-162">The following table summarizes the permission levels that determine access to PowerPivot data and server operations:</span></span>  
  
|<span data-ttu-id="ba8ff-163">Nível de permissão</span><span class="sxs-lookup"><span data-stu-id="ba8ff-163">Permission level</span></span>|<span data-ttu-id="ba8ff-164">Permite as seguintes tarefas</span><span class="sxs-lookup"><span data-stu-id="ba8ff-164">Allows these tasks</span></span>|  
|----------------------|------------------------|  
|<span data-ttu-id="ba8ff-165">Administrador de farm ou serviço</span><span class="sxs-lookup"><span data-stu-id="ba8ff-165">Farm or service administrator</span></span>|<span data-ttu-id="ba8ff-166">Instalar, habilitar e configurar serviços e aplicativos.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-166">Install, enable, and configure services and applications.</span></span><br /><br /> <span data-ttu-id="ba8ff-167">usar o Painel de Gerenciamento do PowerPivot e exibir relatórios administrativos.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-167">Use PowerPivot Management Dashboard and view administrative reports.</span></span>|  
|<span data-ttu-id="ba8ff-168">Controle total</span><span class="sxs-lookup"><span data-stu-id="ba8ff-168">Full control</span></span>|<span data-ttu-id="ba8ff-169">Ativar a integração de recursos do PowerPivot em nível de conjunto de sites.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-169">Activate PowerPivot feature integration at the site collection level.</span></span><br /><br /> <span data-ttu-id="ba8ff-170">Criar uma biblioteca da Galeria do PowerPivot</span><span class="sxs-lookup"><span data-stu-id="ba8ff-170">Create a PowerPivot Gallery library.</span></span><br /><br /> <span data-ttu-id="ba8ff-171">Criar uma biblioteca de feeds de dados.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-171">Create a data feed library.</span></span>|  
|<span data-ttu-id="ba8ff-172">Contribuir</span><span class="sxs-lookup"><span data-stu-id="ba8ff-172">Contribute</span></span>|<span data-ttu-id="ba8ff-173">Adicionar, editar, excluir e baixar pastas de trabalho PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-173">Add, edit, delete, and download PowerPivot workbooks.</span></span><br /><br /> <span data-ttu-id="ba8ff-174">Configurar a atualização de dados</span><span class="sxs-lookup"><span data-stu-id="ba8ff-174">Configure data refresh.</span></span><br /><br /> <span data-ttu-id="ba8ff-175">Criar novas pastas de trabalho e novos relatórios com base em pastas de trabalho PowerPivot em um site do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-175">Create new workbooks and reports based on PowerPivot workbooks on a SharePoint site.</span></span><br /><br /> <span data-ttu-id="ba8ff-176">Criar documentos de serviço de dados em uma biblioteca de feed de dados</span><span class="sxs-lookup"><span data-stu-id="ba8ff-176">Create data service documents in a data feed library</span></span>|  
|<span data-ttu-id="ba8ff-177">Ler</span><span class="sxs-lookup"><span data-stu-id="ba8ff-177">Read</span></span>|<span data-ttu-id="ba8ff-178">Acesse pastas de trabalho PowerPivot como uma fonte de dados externa, em que a URL da pasta de trabalho é inserida explicitamente em uma caixa de diálogo de conexão (por exemplo, no assistente de conexão de dados do Excel).</span><span class="sxs-lookup"><span data-stu-id="ba8ff-178">Access PowerPivot workbooks as an external data source, where the workbook URL is explicitly entered in a connection dialog box (for example, in Excel's Data Connection Wizard).</span></span>|  
|<span data-ttu-id="ba8ff-179">Exibir Apenas</span><span class="sxs-lookup"><span data-stu-id="ba8ff-179">View Only</span></span>|<span data-ttu-id="ba8ff-180">Exibir pastas de trabalho PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-180">View PowerPivot workbooks.</span></span><br /><br /> <span data-ttu-id="ba8ff-181">Exibir o histórico de atualizações de dados.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-181">View data refresh history.</span></span><br /><br /> <span data-ttu-id="ba8ff-182">Conectar uma pasta de trabalho local a uma pasta de trabalho PowerPivot em um site do SharePoint, para adaptar seus dados de outros modos.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-182">Connect a local workbook to a PowerPivot workbook on a SharePoint site, to repurpose its data in other ways.</span></span><br /><br /> <span data-ttu-id="ba8ff-183">Baixar um instantâneo da pasta de trabalho.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-183">Download a snapshot of the workbook.</span></span> <span data-ttu-id="ba8ff-184">O instantâneo é uma cópia estática dos dados, sem segmentações de dados, fórmulas ou conexões de dados.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-184">The snapshot is a static copy of the data, without slicers, filters, formulas, or data connections.</span></span> <span data-ttu-id="ba8ff-185">O conteúdo do instantâneo é semelhante à cópia de valores de células da janela do navegador.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-185">The contents of the snapshot are similar to copying cell values from the browser window.</span></span>|  
  
##  <a name="excel-services-security-considerations-for-powerpivot-workbooks"></a><a name="excel"></a><span data-ttu-id="ba8ff-186">Considerações de segurança dos serviços do Excel para pastas de trabalho PowerPivot</span><span class="sxs-lookup"><span data-stu-id="ba8ff-186">Excel Services security considerations for PowerPivot workbooks</span></span>  
 <span data-ttu-id="ba8ff-187">O processamento de consulta do PowerPivot no servidor é estreitamente ligado aos serviços do Excel.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-187">PowerPivot server-side query processing is tightly coupled with Excel services.</span></span> <span data-ttu-id="ba8ff-188">A integração de produto começa no nível do documento, em que pastas de trabalho PowerPivot são arquivos de pasta de trabalho do Excel (.xlsx) que contêm ou referenciam dados PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-188">Product integration begins at the document level, in that PowerPivot workbooks are Excel workbook (.xlsx) files that either contain or reference PowerPivot data.</span></span> <span data-ttu-id="ba8ff-189">Não há nenhuma extensão de arquivo separada para uma pasta de trabalho PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-189">There is no separate file extension for a PowerPivot workbook.</span></span>  
  
 <span data-ttu-id="ba8ff-190">Quando uma pasta de trabalho PowerPivot é aberta em um site do SharePoint, os Serviços do Excel leem a cadeia de conexão de dados PowerPivot inserida e encaminham a solicitação ao provedor local de OLE DB do SQL Server Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-190">When a PowerPivot workbook is opened on a SharePoint site, Excel Services reads the embedded PowerPivot data connection string and forwards the request to the local SQL Server Analysis Services OLE DB provider.</span></span> <span data-ttu-id="ba8ff-191">Então, o provedor transmite as informações de conexão a um servidor do PowerPivot no farm.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-191">The provider then passes the connection information to a PowerPivot server in the farm.</span></span> <span data-ttu-id="ba8ff-192">Para que as solicitações fluam diretamente entre os dois servidores, os Serviços do Excel devem ser configurados para usar configurações requeridas pelo PowerPivot para SharePoint.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-192">In order for requests to flow seamlessly between the two servers, Excel Services must be configured to use settings that are required by PowerPivot for SharePoint.</span></span>  
  
 <span data-ttu-id="ba8ff-193">Nos Serviços do Excel, as configurações relacionadas à segurança são especificadas em locais confiáveis, provedores de dados confiáveis e bibliotecas de conexão de dados confiáveis.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-193">In Excel Services, security-related configuration settings are specified on trusted locations, trusted data providers, and trusted data connection libraries.</span></span> <span data-ttu-id="ba8ff-194">A tabela a seguir descreve as configurações que permitem ou aprimoram o acesso a dados PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-194">The following table describes the settings that enable or enhance PowerPivot data access.</span></span> <span data-ttu-id="ba8ff-195">Se uma configuração não estiver listada aqui, ela não terá nenhum efeito nas conexões com o servidor do PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-195">If a setting is not listed here, it has no effect on PowerPivot server connections.</span></span> <span data-ttu-id="ba8ff-196">Para obter instruções sobre como especificar essas configurações passo a passo, consulte a seção "habilitar serviços do Excel" em [configuração inicial &#40;PowerPivot para SharePoint&#41;](../../sql-server/install/initial-configuration-powerpivot-for-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="ba8ff-196">For instructions on how to specify these settings step by step, see the section "Enable Excel Services" in [Initial Configuration &#40;PowerPivot for SharePoint&#41;](../../sql-server/install/initial-configuration-powerpivot-for-sharepoint.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ba8ff-197">A maioria das configurações relacionadas à segurança se aplicam a locais confiáveis.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-197">Most security-related settings apply to trusted locations.</span></span> <span data-ttu-id="ba8ff-198">Se quiser preservar valores padrão ou usar valores diferentes para sites diferentes, você poderá criar mais um local confiável para sites que contenham dados PowerPivot e, então, configurar os seguintes parâmetros apenas para esse site.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-198">If you want to preserve default values or use different values for different sites, you can create an additional trusted location for sites that contain PowerPivot data, and then configure the following settings for just that site.</span></span> <span data-ttu-id="ba8ff-199">Para obter mais informações, consulte [Create a trusted location for PowerPivot sites in Central Administration](create-a-trusted-location-for-power-pivot-sites-in-central-administration.md).</span><span class="sxs-lookup"><span data-stu-id="ba8ff-199">For more information, see [Create a trusted location for PowerPivot sites in Central Administration](create-a-trusted-location-for-power-pivot-sites-in-central-administration.md).</span></span>  
  
|<span data-ttu-id="ba8ff-200">Área</span><span class="sxs-lookup"><span data-stu-id="ba8ff-200">Area</span></span>|<span data-ttu-id="ba8ff-201">Configuração</span><span class="sxs-lookup"><span data-stu-id="ba8ff-201">Setting</span></span>|<span data-ttu-id="ba8ff-202">Descrição</span><span class="sxs-lookup"><span data-stu-id="ba8ff-202">Description</span></span>|  
|----------|-------------|-----------------|  
|<span data-ttu-id="ba8ff-203">Aplicativo Web</span><span class="sxs-lookup"><span data-stu-id="ba8ff-203">Web application</span></span>|<span data-ttu-id="ba8ff-204">Provedor de autenticação do Windows</span><span class="sxs-lookup"><span data-stu-id="ba8ff-204">Windows authentication provider</span></span>|<span data-ttu-id="ba8ff-205">O PowerPivot converte um token de declaração obtido dos Serviços do Excel em uma identidade de usuário do Windows.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-205">PowerPivot converts a claims token that it gets from Excel Services to a Windows user identity.</span></span> <span data-ttu-id="ba8ff-206">Qualquer aplicativo Web que utilize os Serviços do Excel como um recurso deve ser configurado para usar o provedor de autenticação do Windows.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-206">Any web application that uses Excel Services as a resource must be configured to use the Windows authentication provider.</span></span>|  
|<span data-ttu-id="ba8ff-207">Local confiável</span><span class="sxs-lookup"><span data-stu-id="ba8ff-207">Trusted location</span></span>|<span data-ttu-id="ba8ff-208">Tipo de local</span><span class="sxs-lookup"><span data-stu-id="ba8ff-208">Location Type</span></span>|<span data-ttu-id="ba8ff-209">Este valor deve ser definido como **Microsoft SharePoint Foundation**.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-209">This value must be set to **Microsoft SharePoint Foundation**.</span></span> <span data-ttu-id="ba8ff-210">Os servidores do PowerPivot recuperam uma cópia do arquivo .xlsx e o carregam em um servidor de Serviços de Análise no farm.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-210">PowerPivot servers retrieve a copy of the .xlsx file and load it on an Analysis Services server in the farm.</span></span> <span data-ttu-id="ba8ff-211">O servidor só pode recuperar arquivos .xlsx de uma biblioteca de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-211">The server can only retrieve .xlsx files from a content library.</span></span>|  
||<span data-ttu-id="ba8ff-212">Permitir dados externos</span><span class="sxs-lookup"><span data-stu-id="ba8ff-212">Allow External Data</span></span>|<span data-ttu-id="ba8ff-213">Esse valor deve ser definido como **Bibliotecas confiáveis e incorporadas de conexão de dados**.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-213">This value must be set to **Trusted data connection libraries and embedded**.</span></span> <span data-ttu-id="ba8ff-214">As conexões de dados PowerPivot são inseridas na pasta de trabalho.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-214">PowerPivot data connections are embedded in the workbook.</span></span> <span data-ttu-id="ba8ff-215">Se você não permitir conexões inseridas, os usuários poderão exibir o cache de Tabela Dinâmica, mas não poderão interagir com o dados PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-215">If you disallow embedded connections, users can view the PivotTable cache, but they will not be able to interact with the PowerPivot data.</span></span>|  
||<span data-ttu-id="ba8ff-216">Aviso de Atualização</span><span class="sxs-lookup"><span data-stu-id="ba8ff-216">Warn on Refresh</span></span>|<span data-ttu-id="ba8ff-217">Este valor deverá ser desabilitado se você estiver usando a Galeria do PowerPivot para armazenar pastas de trabalho e relatórios.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-217">This value should be disabled if you are using PowerPivot Gallery to store workbooks and reports.</span></span> <span data-ttu-id="ba8ff-218">A Galeria do PowerPivot inclui um recurso de visualização de documentos que funciona melhor se a atualização na abertura e a Advertência na Atualização estiverem desabilitados.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-218">PowerPivot Gallery includes a document preview feature that works best if both refresh on open and Warn on Refresh are turned off.</span></span>|  
|<span data-ttu-id="ba8ff-219">Provedores de dados confiáveis</span><span class="sxs-lookup"><span data-stu-id="ba8ff-219">Trusted data providers</span></span>|<span data-ttu-id="ba8ff-220">MSOLAP.4</span><span class="sxs-lookup"><span data-stu-id="ba8ff-220">MSOLAP.4</span></span><br /><br /> <span data-ttu-id="ba8ff-221">MSOLAP.5</span><span class="sxs-lookup"><span data-stu-id="ba8ff-221">MSOLAP.5</span></span>|<span data-ttu-id="ba8ff-222">O MSOLAP.4 está incluído por padrão, mas o acesso a dados PowerPivot exige que o provedor de MSOLAP.4 seja a versão SQL Server 2008 R2.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-222">MSOLAP.4 is included by default, but PowerPivot data access requires that the MSOLAP.4 provider be the SQL Server 2008 R2 version.</span></span><br /><br /> <span data-ttu-id="ba8ff-223">O MSOLAP.5 está instalado com a versão do [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] do PowerPivot para SharePoint.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-223">MSOLAP.5 is installed with the [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] version of PowerPivot for SharePoint.</span></span><br /><br /> <span data-ttu-id="ba8ff-224">Não remova esses provedores da lista de provedores de dados confiáveis.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-224">Do not remove these providers from the trusted data provider list.</span></span> <span data-ttu-id="ba8ff-225">Em alguns casos, você pode precisar instalar cópias adicionais deste provedor em outros servidores do SharePoint em seu farm.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-225">In some cases, you might need to install additional copies of this provider on other SharePoint servers in your farm.</span></span> <span data-ttu-id="ba8ff-226">Para obter mais informações, consulte [Instalar o Provedor OLE DB do Analysis Services nos Servidores SharePoint](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md).</span><span class="sxs-lookup"><span data-stu-id="ba8ff-226">For more information, see [Install the Analysis Services OLE DB Provider on SharePoint Servers](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md).</span></span>|  
|<span data-ttu-id="ba8ff-227">Bibliotecas de conexão de dados confiáveis</span><span class="sxs-lookup"><span data-stu-id="ba8ff-227">Trusted data connection libraries</span></span>|<span data-ttu-id="ba8ff-228">Opcional.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-228">Optional.</span></span>|<span data-ttu-id="ba8ff-229">Você pode usar arquivos .odc em pastas de trabalho PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-229">You can use Office Data Connection (.odc) files in PowerPivot workbooks.</span></span> <span data-ttu-id="ba8ff-230">Se você usar arquivos .odc para fornecer informações de conexão a pastas de trabalho PowerPivot locais, poderá adicionar os mesmos arquivos .odc a essa biblioteca.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-230">If you use .odc files to provide connection information to local PowerPivot workbooks, you can add the same .odc files to this library.</span></span>|  
|<span data-ttu-id="ba8ff-231">Assembly de função definida pelo usuário</span><span class="sxs-lookup"><span data-stu-id="ba8ff-231">User defined function assembly</span></span>|<span data-ttu-id="ba8ff-232">Não aplicável.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-232">Not applicable.</span></span>|<span data-ttu-id="ba8ff-233">O PowerPivot para SharePoint ignora os assemblies de funções definidas pelo usuário que você cria para os Serviços do Excel.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-233">PowerPivot for SharePoint ignores user-defined function assemblies that you build deploy for Excel Services.</span></span> <span data-ttu-id="ba8ff-234">Se você confiar em assemblies definidos pelo usuário para um comportamento específico, saiba que o processamento de consultas do PowerPivot não usará as funções definidas pelo usuário que você criou.</span><span class="sxs-lookup"><span data-stu-id="ba8ff-234">If you rely on user-defined assemblies for a specific behavior, be aware that PowerPivot query processing will not use the user-defined functions you created.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="ba8ff-235">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="ba8ff-235">See Also</span></span>  
 <span data-ttu-id="ba8ff-236">[Configurar contas de serviço PowerPivot](configure-power-pivot-service-accounts.md) </span><span class="sxs-lookup"><span data-stu-id="ba8ff-236">[Configure PowerPivot Service Accounts](configure-power-pivot-service-accounts.md) </span></span>  
 <span data-ttu-id="ba8ff-237">[Configurar a conta de atualização de dados autônoma do PowerPivot &#40;PowerPivot para SharePoint&#41;](../configure-unattended-data-refresh-account-powerpivot-sharepoint.md) </span><span class="sxs-lookup"><span data-stu-id="ba8ff-237">[Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](../configure-unattended-data-refresh-account-powerpivot-sharepoint.md) </span></span>  
 <span data-ttu-id="ba8ff-238">[Criar um local confiável para sites do PowerPivot na administração central](create-a-trusted-location-for-power-pivot-sites-in-central-administration.md) </span><span class="sxs-lookup"><span data-stu-id="ba8ff-238">[Create a trusted location for PowerPivot sites in Central Administration](create-a-trusted-location-for-power-pivot-sites-in-central-administration.md) </span></span>  
 [<span data-ttu-id="ba8ff-239">Arquitetura de segurança do PowerPivot</span><span class="sxs-lookup"><span data-stu-id="ba8ff-239">PowerPivot Security Architecture</span></span>](https://go.microsoft.com/fwlink/?linkID=220970)  
  
  
