---
title: Conexão de modelo semântico de BI do PowerPivot (. BISM) | Microsoft Docs
ms.custom: ''
ms.date: 04/19/2015
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 08828eec-4f8c-4f34-a145-e442f7b7031d
author: minewiskan
ms.author: owend
ms.openlocfilehash: 14a30128986a5ba23cb093be771c036c94fa25ce
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87582158"
---
# <a name="powerpivot-bi-semantic-model-connection-bism"></a><span data-ttu-id="c71b3-102">Conexão de modelo semântico de BI (.bism) do PowerPivot</span><span class="sxs-lookup"><span data-stu-id="c71b3-102">PowerPivot BI Semantic Model Connection (.bism)</span></span>
  <span data-ttu-id="c71b3-103">Uma conexão de modelo semântico de BI (.bism) é uma conexão portátil que conecta o Excel ou [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] reporta a um [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] banco de dados modelo de tabela ou uma instância [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] no modo multidimensional.</span><span class="sxs-lookup"><span data-stu-id="c71b3-103">A BI semantic model connection (.bism) is a portable connection that connects Excel or [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] reports to an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] tabular model database or an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance in multidimensional mode.</span></span> <span data-ttu-id="c71b3-104">Se você estiver familiarizado com arquivos de conexão de dados (.odc) do Office, observará uma semelhança em como um arquivo de conexão .bism é definido e usado.</span><span class="sxs-lookup"><span data-stu-id="c71b3-104">If you are familiar with office data connection (.odc) files, you will notice a similarity in how a .bism connection file is defined and used.</span></span>  
  
 <span data-ttu-id="c71b3-105">Uma conexão de modelo semântico de BI é criada e acessada pelo SharePoint.</span><span class="sxs-lookup"><span data-stu-id="c71b3-105">A BI semantic model connection is created and accessed via SharePoint.</span></span> <span data-ttu-id="c71b3-106">A criação de conexões de modelo semântico de BI habilita comandos de início rápido em uma conexão de modelo semântico de BI em uma biblioteca.</span><span class="sxs-lookup"><span data-stu-id="c71b3-106">Creating BI semantic model connections enables quick launch commands on a BI semantic model connection in a library.</span></span> <span data-ttu-id="c71b3-107">Os comandos de início rápido abrem uma nova pasta de trabalho do Excel ou opções para editar o arquivo de conexão.</span><span class="sxs-lookup"><span data-stu-id="c71b3-107">Quick launch commands open a new Excel workbook or options for editing the connection file.</span></span> <span data-ttu-id="c71b3-108">Se [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] estiver instalado, você também verá um comando para criar um relatório [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="c71b3-108">If [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] is installed, you will also see a command to create a [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] report.</span></span>  
  
 <span data-ttu-id="c71b3-109">![Captura de tela do comando de início rápido BISM](../media/ssas-bism-quicklaunch.gif "Captura de tela do comando de início rápido BISM")</span><span class="sxs-lookup"><span data-stu-id="c71b3-109">![Screenshot of BISM quick launch command](../media/ssas-bism-quicklaunch.gif "Screenshot of BISM quick launch command")</span></span>  
  
##  <a name="supported-databases"></a><a name="bkmk_prereq"></a><span data-ttu-id="c71b3-110">Bancos de dados com suporte</span><span class="sxs-lookup"><span data-stu-id="c71b3-110">Supported databases</span></span>  
 <span data-ttu-id="c71b3-111">Um modelo de conexão semântica de BI aponta para dados de modelo de tabela.</span><span class="sxs-lookup"><span data-stu-id="c71b3-111">A BI semantic model connection points to tabular model data.</span></span> <span data-ttu-id="c71b3-112">Há duas fontes para estes dados:</span><span class="sxs-lookup"><span data-stu-id="c71b3-112">There are three sources for this data:</span></span>  
  
-   <span data-ttu-id="c71b3-113">Um banco de dados de modelo de tabela que é executado em uma instância do Analysis Services autônoma em modo de servidor de tabela.</span><span class="sxs-lookup"><span data-stu-id="c71b3-113">A tabular model database running on a standalone Analysis Services instance in tabular server mode.</span></span> <span data-ttu-id="c71b3-114">Uma implantação de uma instância autônoma do Analysis Services é externa ao farm.</span><span class="sxs-lookup"><span data-stu-id="c71b3-114">A deployment of a standalone Analysis Services instance is external to the farm.</span></span> <span data-ttu-id="c71b3-115">O acesso a fontes de dados fora do farm requer permissões adicionais, sobre as quais você pode ler neste tópico: [Create a BI Semantic Model Connection to a Tabular Model Database](create-a-bi-semantic-model-connection-to-a-tabular-model-database.md).</span><span class="sxs-lookup"><span data-stu-id="c71b3-115">Accessing data sources off the farm requires additional permissions, which you can read about in this topic: [Create a BI Semantic Model Connection to a Tabular Model Database](create-a-bi-semantic-model-connection-to-a-tabular-model-database.md).</span></span>  
  
-   <span data-ttu-id="c71b3-116">Pastas de trabalho PowerPivot salvas no SharePoint.</span><span class="sxs-lookup"><span data-stu-id="c71b3-116">PowerPivot workbooks saved to SharePoint.</span></span> <span data-ttu-id="c71b3-117">Bancos de dados PowerPivot inseridos em pastas de trabalho do Excel são equivalentes a bancos de dados de modelo de tabela que são executados em um servidor autônomo de modo de tabela do Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="c71b3-117">Embedded PowerPivot databases inside Excel workbooks are equivalent to tabular model databases that run on a standalone Analysis Services tabular mode server.</span></span> <span data-ttu-id="c71b3-118">Se você já usa o PowerPivot para Excel e o PowerPivot para SharePoint, poderá definir uma conexão de modelo semântico de BI que aponte para pastas de trabalho PowerPivot em uma biblioteca do SharePoint e compilar relatórios do [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] usando dados PowerPivot existentes.</span><span class="sxs-lookup"><span data-stu-id="c71b3-118">If you already use PowerPivot for Excel and PowerPivot for SharePoint, you can define a BI semantic model connection that points to PowerPivot workbooks in a SharePoint library and build [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] reports using existing PowerPivot data.</span></span>  <span data-ttu-id="c71b3-119">Você pode usar pastas de trabalho criadas na versão SQL Server 2008 R2 ou [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] do PowerPivot para Excel.</span><span class="sxs-lookup"><span data-stu-id="c71b3-119">You can use workbooks created in either SQL Server 2008 R2 or [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] versions of PowerPivot for Excel.</span></span>  
  
-   <span data-ttu-id="c71b3-120">Um modelo de dados multidimensionais em uma instância [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="c71b3-120">A multidimensional data model on an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance.</span></span>  
  
 <span data-ttu-id="c71b3-121">Para obter uma comparação das fontes de dados, consulte o conteúdo da Comunidade [entendendo o modelo semântico de BI SQL Server 2012 (BISM)](http://www.mssqltips.com/sqlservertip/2818/understanding-the-sql-server-2012-bi-semantic-model-bism/).</span><span class="sxs-lookup"><span data-stu-id="c71b3-121">For a comparison of the data sources, see the community  content [Understanding the SQL Server 2012 BI Semantic Model (BISM)](http://www.mssqltips.com/sqlservertip/2818/understanding-the-sql-server-2012-bi-semantic-model-bism/).</span></span>  
  
## <a name="understanding-the-connection-sequence-for-bi-semantic-connections"></a><span data-ttu-id="c71b3-122">Entendendo a sequência de conexão para conexões semânticas de BI</span><span class="sxs-lookup"><span data-stu-id="c71b3-122">Understanding the Connection Sequence for BI Semantic Connections</span></span>  
 <span data-ttu-id="c71b3-123">Esta seção explica o comportamento da conexão entre vários aplicativos cliente, como o aplicativo de área de trabalho do Excel ou o cliente de relatório do Power View no SharePoint e um banco de dados modelo de tabela dentro ou fora do farm do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="c71b3-123">This section explains the connection behavior between various client applications, such as the Excel desktop application or the Power View reporting client on SharePoint, and a tabular model database inside or outside the SharePoint farm.</span></span>  
  
 <span data-ttu-id="c71b3-124">Todas as conexões com um banco de dados modelo de tabela são estabelecidas com o uso de credenciais do usuário que está solicitando os dados.</span><span class="sxs-lookup"><span data-stu-id="c71b3-124">All connections to a tabular model database are made using the credentials of the user who is requesting the data.</span></span> <span data-ttu-id="c71b3-125">No entanto, a mecânica dessas conexões variará dependendo se a conexão está dentro do farm, se é do tipo de salto único ou duplo e se o Kerberos está habilitado.</span><span class="sxs-lookup"><span data-stu-id="c71b3-125">However, the mechanics of that connection will vary depending on whether the connection is an in-farm connection, a single or double-hop connection, and whether Kerberos is enabled.</span></span> <span data-ttu-id="c71b3-126">Para obter mais informações sobre conexões autenticadas entre o SharePoint e fontes de dados de back-end, consulte [Autenticação de salto duplo: por que o NTLM falha e o Kerberos funciona](https://go.microsoft.com/fwlink/?LinkId=237137).</span><span class="sxs-lookup"><span data-stu-id="c71b3-126">For more information about authenticated connections between SharePoint and backend data sources, see [Double-hop authentication: Why NTLM fails and Kerberos works](https://go.microsoft.com/fwlink/?LinkId=237137).</span></span>  
  
 <span data-ttu-id="c71b3-127">**Conectando do Excel a dados de tabela em uma rede**</span><span class="sxs-lookup"><span data-stu-id="c71b3-127">**Connecting from Excel to tabular data on a network**</span></span>  
  
 <span data-ttu-id="c71b3-128">Quando um usuário do Excel especifica uma conexão de modelo de semântica de BI como a fonte de dados, as informações de conexão dentro do arquivo .bism são baixadas para o aplicativo de cliente, que, em seguida, emite sua própria solicitação direta para o banco de dados modelo de tabela no Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="c71b3-128">When an Excel user specifies a BI semantic model connection as a data source, the connection information inside the .bism file is downloaded to the client application, which then issues its own direct request to the tabular model database on Analysis Services.</span></span> <span data-ttu-id="c71b3-129">Para acessar a conexão .bism, o usuário do Excel deve ser um usuário do SharePoint com permissões de leitura no arquivo de conexão .bism.</span><span class="sxs-lookup"><span data-stu-id="c71b3-129">To access the .bism connection, the Excel user must be a SharePoint user with read permissions on the .bism connection file.</span></span> <span data-ttu-id="c71b3-130">Quando as informações de conexão são baixadas, todas as conexões subsequentes ignoram o SharePoint, fluindo diretamente do Excel para o banco de dados modelo de tabela de back-end.</span><span class="sxs-lookup"><span data-stu-id="c71b3-130">Once the connection information is downloaded, all subsequent connections bypass SharePoint, flowing directly from Excel to the backend tabular model database.</span></span>  
  
 <span data-ttu-id="c71b3-131">A ilustração a seguir mostra esta sequência de conexão.</span><span class="sxs-lookup"><span data-stu-id="c71b3-131">The following illustration shows this connection sequence.</span></span> <span data-ttu-id="c71b3-132">Ela começa com uma solicitação para a conexão .bism, seguida pelo download das informações de conexão com o cliente e, finalmente, a conexão de salto único com o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="c71b3-132">It starts with a request for the .bism connection, followed by the download of connection information to the client, and finally the single-hop connection to the database.</span></span> <span data-ttu-id="c71b3-133">A conexão é estabelecida usando-se as credenciais do Windows do usuário do Excel que tem permissões de leitura no banco de dados do Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="c71b3-133">The connection is made using the Windows credentials of the Excel user, who has read permissions on the Analysis Services database.</span></span> <span data-ttu-id="c71b3-134">Trata-se de um salto único, portanto, mesmo que o Kerberos esteja habilitado, ele não é necessário para esse cenário.</span><span class="sxs-lookup"><span data-stu-id="c71b3-134">It is a single hop, so even if Kerberos is enabled, it is not required for this scenario.</span></span>  
  
 <span data-ttu-id="c71b3-135">![Conexões do Excel a um banco de dados modelo em tabelas](../media/ssas-powerpivotbismconnection-1.gif "Conexões do Excel a um banco de dados modelo em tabelas")</span><span class="sxs-lookup"><span data-stu-id="c71b3-135">![Connections from Excel to tabular model database](../media/ssas-powerpivotbismconnection-1.gif "Connections from Excel to tabular model database")</span></span>  
  
 <span data-ttu-id="c71b3-136">**Conectando do Power View a dados de tabela em uma rede**</span><span class="sxs-lookup"><span data-stu-id="c71b3-136">**Connecting from Power View to tabular data on a network**</span></span>  
  
 <span data-ttu-id="c71b3-137">Quando um usuário do SharePoint clica em uma conexão semântica de BI em uma biblioteca de documentos, o Power View (se estiver instalado) é iniciado automaticamente e estabelece uma conexão com o banco de dados modelo de tabela.</span><span class="sxs-lookup"><span data-stu-id="c71b3-137">When a SharePoint user clicks on a BI semantic connection in a document library, Power View (if it is installed), starts immediately and opens a connection to the tabular model database.</span></span>  
  
 <span data-ttu-id="c71b3-138">Conexões entre o Power View e um banco de dados modelo de tabela seguem uma sequência de autenticação de salto duplo na qual a identidade do usuário flui do cliente para o SharePoint e depois do SharePoint para um banco de dados modelo de tabela de back-end do Analysis Services que é executado fora do farm.</span><span class="sxs-lookup"><span data-stu-id="c71b3-138">Connections between Power View and a tabular model database follow a double-hop authentication sequence where the user identity is flowed from the client to SharePoint, and then from SharePoint to a back-end Analysis Services tabular model database that runs outside of the farm.</span></span> <span data-ttu-id="c71b3-139">A biblioteca cliente ADOMD.NET que manipula a solicitação de conexão sempre tenta o Kerberos primeiro.</span><span class="sxs-lookup"><span data-stu-id="c71b3-139">The ADOMD.NET client library that handles the connection request always tries Kerberos on the first attempt.</span></span> <span data-ttu-id="c71b3-140">Se o Kerberos estiver configurado, a identidade do usuário será representada na conexão com o banco de dados modelo de tabela e a conexão será bem-sucedida.</span><span class="sxs-lookup"><span data-stu-id="c71b3-140">If Kerberos is configured, the user identity is impersonated on the connection to the tabular model database, and the connection succeeds.</span></span>  
  
 <span data-ttu-id="c71b3-141">Se o Kerberos não estiver configurado e a solicitação falhar, o Reporting Services fará uma segunda tentativa.</span><span class="sxs-lookup"><span data-stu-id="c71b3-141">If Kerberos is not configured and the request fails, Reporting Services makes a second attempt.</span></span> <span data-ttu-id="c71b3-142">Neste cenário, a biblioteca cliente se conectará ao Analysis Services usando a identidade de serviço do Reporting Services e a autenticação NTLM.</span><span class="sxs-lookup"><span data-stu-id="c71b3-142">Under this scenario, the client library connects to Analysis Services using the Reporting Services service identity and NTLM authentication.</span></span> <span data-ttu-id="c71b3-143">A identidade do Power View é passada na cadeia de conexão usando o parâmetro `effectiveusername`.</span><span class="sxs-lookup"><span data-stu-id="c71b3-143">The identity of the Power View user is passed on the connection string using the `effectiveusername` parameter.</span></span>  
  
 <span data-ttu-id="c71b3-144">Somente um membro da função de administrador do sistema na instância do Analysis Services tem permissão para estabelecer uma conexão usando o parâmetro `effectiveusername` e representar outro usuário na instância do servidor.</span><span class="sxs-lookup"><span data-stu-id="c71b3-144">Only a member of the system administrator role on the Analysis Services instance has permission to make a connection using the `effectiveusername` parameter and impersonate another user on the server instance.</span></span> <span data-ttu-id="c71b3-145">Por isso, a conta de execução do serviço compartilhado do Reporting Services deve ter direitos administrativos na instância do Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="c71b3-145">For this reason, the execution account of the Reporting Services shared service must have administrative rights on the Analysis Services instance.</span></span>  <span data-ttu-id="c71b3-146">Instruções sobre como conceder permissões administrativas à conta de serviço são fornecidas neste tópico [Criar uma conexão de modelo semântico de BI com um banco de dados de modelo de tabela](create-a-bi-semantic-model-connection-to-a-tabular-model-database.md).</span><span class="sxs-lookup"><span data-stu-id="c71b3-146">Instructions for granting administrative permissions to the service account is provided in this topic, [Create a BI Semantic Model Connection to a Tabular Model Database](create-a-bi-semantic-model-connection-to-a-tabular-model-database.md).</span></span>  
  
 <span data-ttu-id="c71b3-147">A ilustração a seguir mostra uma sequência de conexão que usa a mesma identidade de usuário do Windows para cada conexão.</span><span class="sxs-lookup"><span data-stu-id="c71b3-147">The following illustration shows a connection sequence that uses the same Windows user identity for each connection.</span></span> <span data-ttu-id="c71b3-148">Na última conexão com o Analysis Services, ela é estabelecida pela identidade do aplicativo de serviço do Reporting Services, passando a identidade de usuário do Windows usando `effectiveusername`.</span><span class="sxs-lookup"><span data-stu-id="c71b3-148">On the last connection to Analysis Services, the connection is made by the Reporting Services service application identity, passing the Windows user identity using `effectiveusername`.</span></span>  
  
 <span data-ttu-id="c71b3-149">![Conexão representada para bd tabular](../media/ssas-powerpivotbismconnection-2.gif "Conexão representada para bd tabular")</span><span class="sxs-lookup"><span data-stu-id="c71b3-149">![Imersonated connection to tabular db](../media/ssas-powerpivotbismconnection-2.gif "Imersonated connection to tabular db")</span></span>  
  
 <span data-ttu-id="c71b3-150">**Conectando do Power View para dados PowerPivot no SharePoint**</span><span class="sxs-lookup"><span data-stu-id="c71b3-150">**Connecting from Power View to PowerPivot data in SharePoint**</span></span>  
  
 <span data-ttu-id="c71b3-151">Quando um usuário do SharePoint clica em uma conexão semântica de BI que se resolve para uma pasta de trabalho PowerPivot no mesmo farm, as conexões ocorrem no contexto do ambiente do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="c71b3-151">When a SharePoint user clicks on a BI semantic connection that resolves to a PowerPivot workbook in the same farm, the connections occur within the context of the SharePoint environment.</span></span> <span data-ttu-id="c71b3-152">Um aplicativo de serviço PowerPivot manipula a solicitação de conexão, que encaminha à instância do Analysis Services no mesmo computador.</span><span class="sxs-lookup"><span data-stu-id="c71b3-152">A PowerPivot service application handles the connection request, which it forwards to the Analysis Services instance on the same computer.</span></span> <span data-ttu-id="c71b3-153">A instância do Analysis Services extrai os dados PowerPivot da pasta de trabalho e carrega-os.</span><span class="sxs-lookup"><span data-stu-id="c71b3-153">The Analysis Services instance extracts the PowerPivot data from the workbook and loads it.</span></span> <span data-ttu-id="c71b3-154">Todas as conexões subsequentes são gerenciadas por aplicativos de serviço PowerPivot no farm.</span><span class="sxs-lookup"><span data-stu-id="c71b3-154">All subsequent connections are managed by PowerPivot service applications in the farm.</span></span>  
  
 <span data-ttu-id="c71b3-155">Neste cenário, todas as conexões ocorrem dentro do mesmo farm, assim não há nenhum requisito para Kerberos ou delegação restrita.</span><span class="sxs-lookup"><span data-stu-id="c71b3-155">In this scenario, all connections occur within the same farm, so there is no requirement for Kerberos or constrained delegation.</span></span>  
  
##  <a name="related-tasks"></a><a name="bkmk_rel"></a> <span data-ttu-id="c71b3-156">Tarefas relacionadas</span><span class="sxs-lookup"><span data-stu-id="c71b3-156">Related Tasks</span></span>  
 [<span data-ttu-id="c71b3-157">Adicione um tipo de conteúdo de conexão de modelo semântico de BI a uma biblioteca &#40;PowerPivot para SharePoint&#41;</span><span class="sxs-lookup"><span data-stu-id="c71b3-157">Add a BI Semantic Model Connection Content Type to a Library &#40;PowerPivot for SharePoint&#41;</span></span>](add-bi-semantic-model-connection-content-type-to-library.md)  
  
 [<span data-ttu-id="c71b3-158">Criar uma conexão de modelo semântico de BI para uma pastas de trabalho PowerPivot</span><span class="sxs-lookup"><span data-stu-id="c71b3-158">Create a BI Semantic Model Connection to a PowerPivot Workbook</span></span>](create-a-bi-semantic-model-connection-to-a-power-pivot-workbook.md)  
  
 [<span data-ttu-id="c71b3-159">Create a BI Semantic Model Connection to a Tabular Model Database</span><span class="sxs-lookup"><span data-stu-id="c71b3-159">Create a BI Semantic Model Connection to a Tabular Model Database</span></span>](create-a-bi-semantic-model-connection-to-a-tabular-model-database.md)  
  
 [<span data-ttu-id="c71b3-160">Usar uma conexão de modelo semântico de BI no Excel ou Reporting Services</span><span class="sxs-lookup"><span data-stu-id="c71b3-160">Use a BI Semantic Model Connection in Excel or Reporting Services</span></span>](use-a-bi-semantic-model-connection-in-excel-or-reporting-services.md)  
  
## <a name="see-also"></a><span data-ttu-id="c71b3-161">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="c71b3-161">See Also</span></span>  
 <span data-ttu-id="c71b3-162">[Determinar o modo de servidor de uma instância de Analysis Services](../instances/determine-the-server-mode-of-an-analysis-services-instance.md) </span><span class="sxs-lookup"><span data-stu-id="c71b3-162">[Determine the Server Mode of an Analysis Services Instance](../instances/determine-the-server-mode-of-an-analysis-services-instance.md) </span></span>  
 [<span data-ttu-id="c71b3-163">Conectar ao Analysis Services</span><span class="sxs-lookup"><span data-stu-id="c71b3-163">Connect to Analysis Services</span></span>](../instances/connect-to-analysis-services.md)  
  
  
