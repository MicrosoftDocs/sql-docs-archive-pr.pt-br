---
title: Configurar o Firewall do Windows para permitir acesso ao Analysis Services | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- ports [Analysis Services]
- Windows Firewall [Analysis Services]
- firewall systems [Analysis Services]
ms.assetid: 7673acc5-75f0-4703-9ce2-87425ea39d49
author: minewiskan
ms.author: owend
ms.openlocfilehash: f7d63b392148bf10a6b121dd4d201b7a7c61e0c4
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87680171"
---
# <a name="configure-the-windows-firewall-to-allow-analysis-services-access"></a><span data-ttu-id="4429f-102">Configurar o Firewall do Windows para permitir o acesso ao Analysis Services</span><span class="sxs-lookup"><span data-stu-id="4429f-102">Configure the Windows Firewall to Allow Analysis Services Access</span></span>
  <span data-ttu-id="4429f-103">Uma primeira etapa essencial para tornar [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] ou [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] disponível na rede é determinar se você precisa desbloquear portas em um firewall</span><span class="sxs-lookup"><span data-stu-id="4429f-103">An essential first step in making [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] or [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] available on the network is to determine whether you need to unblock ports in a firewall.</span></span> <span data-ttu-id="4429f-104">A maioria das instalações exigirão que você crie, pelo menos, uma regra de firewall de entrada que permita conexões com o [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4429f-104">Most installations will require that you create at least one in-bound firewall rule that allows connections to [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="4429f-105">Os requisitos de configuração de firewall variam de acordo com a maneira como você instalou o [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4429f-105">Firewall configuration requirements vary depending on how you installed [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]:</span></span>  
  
-   <span data-ttu-id="4429f-106">Abra a porta TCP 2383 ao instalar uma instância padrão ou criar um cluster de failover do [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="4429f-106">Open TCP port 2383 when installing a default instance or creating an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] failover cluster.</span></span>  
  
-   <span data-ttu-id="4429f-107">Abra a porta TCP 2382 ao instalar uma instância nomeada.</span><span class="sxs-lookup"><span data-stu-id="4429f-107">Open TCP port 2382 when installing a named instance.</span></span> <span data-ttu-id="4429f-108">Instâncias nomeadas usam atribuições de porta dinâmica.</span><span class="sxs-lookup"><span data-stu-id="4429f-108">Named instances use dynamic port assignments.</span></span> <span data-ttu-id="4429f-109">Da mesma maneira que o serviço de descoberta para o Analysis Services, o serviço SQL Server Browser escuta na porta TCP 2382 e redireciona a solicitação de conexão para a porta usada no momento pelo [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4429f-109">As the discovery service for Analysis Services, SQL Server Browser service listens on TCP port 2382 and redirects the connection request to the port currently used by [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span>  
  
-   <span data-ttu-id="4429f-110">Abra a porta TCP 2382 ao instalar o [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] no modo do SharePoint para oferecer suporte ao [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2013.</span><span class="sxs-lookup"><span data-stu-id="4429f-110">Open TCP port 2382 when installing [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] in SharePoint mode to support [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2013.</span></span> <span data-ttu-id="4429f-111">No [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2013, a instância do [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] é externa ao SharePoint.</span><span class="sxs-lookup"><span data-stu-id="4429f-111">In [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2013, the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance is external to SharePoint.</span></span> <span data-ttu-id="4429f-112">As solicitações de entrada para a instância 'PowerPivot' nomeada originam-se de aplicativos Web do SharePoint em uma conexão de rede, exigindo uma porta aberta.</span><span class="sxs-lookup"><span data-stu-id="4429f-112">Inbound requests to the named 'PowerPivot' instance originate from SharePoint web applications over a network connection, requiring an open port.</span></span> <span data-ttu-id="4429f-113">Da mesma maneira que ocorre com outras instâncias nomeadas do [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , crie uma regra de entrada para o serviço SQL Server Browser na porta TCP 2382 para permitir o acesso ao [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4429f-113">As with other [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] named instances, create an inbound rule for SQL Server Browser service on TCP 2382 to allow access to [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)].</span></span>  
  
-   <span data-ttu-id="4429f-114">Para o [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2010, não abra portas no Firewall do Windows.</span><span class="sxs-lookup"><span data-stu-id="4429f-114">For [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2010, do not open ports in Windows Firewall.</span></span> <span data-ttu-id="4429f-115">Da mesma maneira que ocorre com um suplemento do SharePoint, o serviço usa as portas configuradas para SharePoint e faz apenas conexões locais à instância do [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] que carrega e consulta os modelos de dados do [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="4429f-115">As an add-in to SharePoint, the service uses ports configured for SharePoint and makes only local connections to the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance that loads and queries [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] data models.</span></span>  
  
-   <span data-ttu-id="4429f-116">Para [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instâncias em execução em máquinas virtuais do Azure, use instruções alternativas para configurar o acesso ao servidor.</span><span class="sxs-lookup"><span data-stu-id="4429f-116">For [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instances running on Azure Virtual Machines, use alternate instructions for configuring server access.</span></span> <span data-ttu-id="4429f-117">Consulte [SQL Server Business Intelligence em máquinas virtuais do Azure](https://msdn.microsoft.com/library/windowsazure/jj992719.aspx).</span><span class="sxs-lookup"><span data-stu-id="4429f-117">See [SQL Server Business Intelligence in Azure Virtual Machines](https://msdn.microsoft.com/library/windowsazure/jj992719.aspx).</span></span>  
  
 <span data-ttu-id="4429f-118">Embora a instância padrão do [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] escute na porta TCP 2383, você pode configurar o servidor para escutar em uma porta fixa diferente, conectando-se ao servidor neste formato: \<servername> : \<portnumber> .</span><span class="sxs-lookup"><span data-stu-id="4429f-118">Although the default instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] listens on TCP port 2383, you can configure the server to listen on a different fixed port, connecting to the server in this format: \<servername>:\<portnumber>.</span></span>  
  
 <span data-ttu-id="4429f-119">Somente uma porta TCP pode ser usada por uma instância do [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="4429f-119">Only one TCP port can be used by an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance.</span></span> <span data-ttu-id="4429f-120">Em computadores com várias placas de rede ou vários endereços IP, o [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] escuta em uma porta TCP para todos os endereços IP atribuídos ou com alias para o computador.</span><span class="sxs-lookup"><span data-stu-id="4429f-120">On computers having multiple network cards or multiple IP addresses, [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] listens on one TCP port for all IP addresses assigned or aliased to the computer.</span></span> <span data-ttu-id="4429f-121">Se você tiver requisitos de várias portas específicas, é recomendável configurar o [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] para acesso HTTP.</span><span class="sxs-lookup"><span data-stu-id="4429f-121">If you have specific multi-port requirements, consider configuring [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] for HTTP access.</span></span> <span data-ttu-id="4429f-122">Em seguida, você poderá configurar vários pontos de extremidade HTTP em qualquer porta escolhida.</span><span class="sxs-lookup"><span data-stu-id="4429f-122">You can then set up multiple HTTP endpoints on whatever ports you choose.</span></span> <span data-ttu-id="4429f-123">Consulte [Configurar o acesso HTTP ao Analysis Services no Serviços de Informações da Internet &#40;IIS&#41; 8.0](configure-http-access-to-analysis-services-on-iis-8-0.md).</span><span class="sxs-lookup"><span data-stu-id="4429f-123">See [Configure HTTP Access to Analysis Services on Internet Information Services &#40;IIS&#41; 8.0](configure-http-access-to-analysis-services-on-iis-8-0.md).</span></span>  
  
 <span data-ttu-id="4429f-124">Este tópico contém as seguintes seções:</span><span class="sxs-lookup"><span data-stu-id="4429f-124">This topic contains the following sections:</span></span>  
  
-   [<span data-ttu-id="4429f-125">Verificar as configurações de porta e de firewall do Analysis Services</span><span class="sxs-lookup"><span data-stu-id="4429f-125">Check port and firewall settings for Analysis Services</span></span>](#bkmk_checkport)  
  
-   [<span data-ttu-id="4429f-126">Configurar o Firewall do Windows para uma instância padrão do Analysis Services</span><span class="sxs-lookup"><span data-stu-id="4429f-126">Configure Windows Firewall for a default instance of Analysis Services</span></span>](#bkmk_default)  
  
-   [<span data-ttu-id="4429f-127">Configurar o acesso ao Firewall do Windows para uma instância nomeada do Analysis Services</span><span class="sxs-lookup"><span data-stu-id="4429f-127">Configure Windows Firewall access for a named instance of Analysis Services</span></span>](#bkmk_named)  
  
-   [<span data-ttu-id="4429f-128">Configuração de porta para um cluster do Analysis Services</span><span class="sxs-lookup"><span data-stu-id="4429f-128">Port configuration for an Analysis Services cluster</span></span>](#bkmk_cluster)  
  
-   [<span data-ttu-id="4429f-129">Configuração de porta do PowerPivot para SharePoint</span><span class="sxs-lookup"><span data-stu-id="4429f-129">Port configuration for PowerPivot for SharePoint</span></span>](#bkmk_powerpivot)  
  
-   [<span data-ttu-id="4429f-130">Usar uma porta fixa para uma instância padrão ou nomeada do Analysis Services</span><span class="sxs-lookup"><span data-stu-id="4429f-130">Use a fixed port for a default or named instance of Analysis Services</span></span>](#bkmk_fixed)  
  
 <span data-ttu-id="4429f-131">Para obter mais informações sobre as configurações padrão do Firewall do Windows e uma descrição das portas TCP que afetam o Mecanismo de Banco de Dados, o Analysis Services, o Reporting Services e o Integration Services, veja [Configurar o Firewall do Windows para permitir acesso ao SQL Server](../../sql-server/install/configure-the-windows-firewall-to-allow-sql-server-access.md).</span><span class="sxs-lookup"><span data-stu-id="4429f-131">For more information about the default Windows firewall settings, and a description of the TCP ports that affect the Database Engine, Analysis Services, Reporting Services, and Integration Services, see [Configure the Windows Firewall to Allow SQL Server Access](../../sql-server/install/configure-the-windows-firewall-to-allow-sql-server-access.md).</span></span>  
  
##  <a name="check-port-and-firewall-settings-for-analysis-services"></a><a name="bkmk_checkport"></a><span data-ttu-id="4429f-132">Verificar as configurações de porta e firewall para Analysis Services</span><span class="sxs-lookup"><span data-stu-id="4429f-132">Check port and firewall settings for Analysis Services</span></span>  
 <span data-ttu-id="4429f-133">Nos sistemas operacionais Microsoft Windows com suporte pelo [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], o Windows Firewall fica ativo por padrão e bloqueia conexões remotas.</span><span class="sxs-lookup"><span data-stu-id="4429f-133">On the Microsoft Windows operating systems that are supported by [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], Windows Firewall is on by default and is blocking remote connections.</span></span> <span data-ttu-id="4429f-134">Abra uma porta manualmente no firewall para permitir solicitações de entrada para o Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="4429f-134">You must manually open a port in the firewall to allow inbound requests to Analysis Services.</span></span> <span data-ttu-id="4429f-135">A instalação do SQL Server não executa essa etapa para você.</span><span class="sxs-lookup"><span data-stu-id="4429f-135">SQL Server Setup does not perform this step for you.</span></span>  
  
 <span data-ttu-id="4429f-136">As configurações de porta são especificadas no arquivo msmdsrv.ini e na página de propriedades Geral de uma instância do Analysis Services no SQL Server Management Studio.</span><span class="sxs-lookup"><span data-stu-id="4429f-136">Port settings are specified in the msmdsrv.ini file and in the General properties page of an Analysis Services instance in SQL Server Management Studio.</span></span> <span data-ttu-id="4429f-137">Se `Port` for definido como um inteiro positivo, o serviço estará escutando em uma porta fixa.</span><span class="sxs-lookup"><span data-stu-id="4429f-137">If `Port` is set to a positive integer, the service is listening on a fixed port.</span></span> <span data-ttu-id="4429f-138">Se `Port` for definido como 0, o serviço estará escutando na porta 2383 se for a instância padrão, ou em uma porta atribuída dinamicamente se for uma instância nomeada.</span><span class="sxs-lookup"><span data-stu-id="4429f-138">If `Port` is set to 0, the service is listening on port 2383 if it is the default instance or on a dynamically assigned port if it is a named instance.</span></span>  
  
 <span data-ttu-id="4429f-139">Atribuições de porta dinâmica só são usadas por instâncias nomeadas.</span><span class="sxs-lookup"><span data-stu-id="4429f-139">Dynamic port assignments are only used by named instances.</span></span> <span data-ttu-id="4429f-140">O serviço `MSOLAP$InstanceName` determina a porta a ser usada quando inicia.</span><span class="sxs-lookup"><span data-stu-id="4429f-140">The `MSOLAP$InstanceName` service determines which port to use when it starts up.</span></span> <span data-ttu-id="4429f-141">Você pode determinar o número de porta real em uso por uma instância nomeada da seguinte forma:</span><span class="sxs-lookup"><span data-stu-id="4429f-141">You can determine the actual port number in use by a named instance by doing the following:</span></span>  
  
-   <span data-ttu-id="4429f-142">Inicie o Gerenciador de tarefas e clique em **Serviços** para obter o PID do `MSOLAP$InstanceName` .</span><span class="sxs-lookup"><span data-stu-id="4429f-142">Start Task Manager and then click **Services** to get the PID of the `MSOLAP$InstanceName`.</span></span>  
  
-   <span data-ttu-id="4429f-143">Execute `netstat -ao -p TCP` da linha de comando para exibir as informações de porta TCP para esse PID.</span><span class="sxs-lookup"><span data-stu-id="4429f-143">Run `netstat -ao -p TCP` from the command line to view the TCP port information for that PID.</span></span>  
  
-   <span data-ttu-id="4429f-144">Verifique a porta usando SQL Server Management Studio e conecte-se a um servidor Analysis Services neste formato: \<IPAddress> : \<portnumber> .</span><span class="sxs-lookup"><span data-stu-id="4429f-144">Verify the port by using SQL Server Management Studio and connect to an Analysis Services server in this format: \<IPAddress>:\<portnumber>.</span></span>  
  
 <span data-ttu-id="4429f-145">Embora um aplicativo possa escutar em uma porta específica, as conexões não terão êxito se um firewall estiver bloqueando o acesso.</span><span class="sxs-lookup"><span data-stu-id="4429f-145">Although an application might be listening on a specific port, connections will not succeed if a firewall is blocking access.</span></span> <span data-ttu-id="4429f-146">Para que conexões alcancem uma instância nomeada do Analysis Services, desbloqueie o acesso ao msmdsrv.exe ou à porta fixa na qual ele está escutando no firewall.</span><span class="sxs-lookup"><span data-stu-id="4429f-146">In order for connections to reach a named Analysis Services instance, you must unblock access to either msmdsrv.exe or the fixed port on which it is listening in the firewall.</span></span> <span data-ttu-id="4429f-147">As seções restantes neste tópico fornecem instruções para fazer isso.</span><span class="sxs-lookup"><span data-stu-id="4429f-147">The remaining sections in this topic provide instructions for doing so.</span></span>  
  
 <span data-ttu-id="4429f-148">Para verificar se as configurações de firewall já estão definidas para o Analysis Services, use o Firewall do Windows com a Segurança Avançada no Painel de controle.</span><span class="sxs-lookup"><span data-stu-id="4429f-148">To check whether firewall settings are already defined for Analysis Services, use Windows Firewall with Advanced Security in Control Panel.</span></span> <span data-ttu-id="4429f-149">A página Firewall na pasta Monitoramento mostra uma lista completa das regras definidas para o servidor local.</span><span class="sxs-lookup"><span data-stu-id="4429f-149">The Firewall page in the Monitoring folder shows a complete list of the rules defined for the local server.</span></span>  
  
 <span data-ttu-id="4429f-150">Observe que para o [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], todas as regras de firewall devem ser definidas manualmente.</span><span class="sxs-lookup"><span data-stu-id="4429f-150">Note that for [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], all firewall rules must be manually defined.</span></span> <span data-ttu-id="4429f-151">Embora o [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] and SQL Server Browser reservem as portas 2382 e 2383, o programa de instalação do SQL Server e as ferramentas de configuração não definem regras de firewall que permitam o acesso às portas ou aos arquivos executáveis de programa.</span><span class="sxs-lookup"><span data-stu-id="4429f-151">Although [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] and SQL Server Browser reserve ports 2382 and 2383, neither the SQL Server setup program nor any of the configuration tools define firewall rules that allow access to either the ports or the program executable files.</span></span>  
  
##  <a name="configure-windows-firewall-for-a-default-instance-of-analysis-services"></a><a name="bkmk_default"></a><span data-ttu-id="4429f-152">Configurar o Firewall do Windows para uma instância padrão do Analysis Services</span><span class="sxs-lookup"><span data-stu-id="4429f-152">Configure Windows Firewall for a default instance of Analysis Services</span></span>  
 <span data-ttu-id="4429f-153">A instância padrão do [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] escuta na porta TCP 2383.</span><span class="sxs-lookup"><span data-stu-id="4429f-153">The default instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] listens on TCP port 2383.</span></span> <span data-ttu-id="4429f-154">Se você instalou a instância padrão e deseja usar esta porta, basta desbloquear o acesso de entrada à porta TCP 2383 no Firewall do Windows para habilitar o acesso remoto à instância padrão do [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4429f-154">If you installed the default instance and want to use this port, you only need to unblock inbound access to TCP port 2383 in Windows Firewall to enable remote access to the default instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span> <span data-ttu-id="4429f-155">Se você instalou a instância padrão mas deseja configurar o serviço para escutar em uma porta fixa, consulte [Usar uma porta fixa para uma instância padrão ou nomeada do Analysis Services](#bkmk_fixed) neste tópico.</span><span class="sxs-lookup"><span data-stu-id="4429f-155">If you installed the default instance but want to configure the service to listen on a fixed port, see [Use a fixed port for a default or named instance of Analysis Services](#bkmk_fixed) in this topic.</span></span>  
  
 <span data-ttu-id="4429f-156">Para verificar se o serviço está sendo executado como a instância padrão (MSSQLServerOLAPService), verifique o nome do serviço no Gerenciador de Configuração do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="4429f-156">To verify whether the service is running as the default instance (MSSQLServerOLAPService), check the service name in SQL Server Configuration Manager.</span></span> <span data-ttu-id="4429f-157">Uma instância padrão do Analysis Services sempre é listada como o **SQL Server Analysis Services (MSSQLSERVER)**.</span><span class="sxs-lookup"><span data-stu-id="4429f-157">A default instance of Analysis Services is always listed as **SQL Server Analysis Services (MSSQLSERVER)**.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="4429f-158">Diferentes sistemas operacionais Windows oferecem ferramentas alternativas para configurar o Firewall do Windows.</span><span class="sxs-lookup"><span data-stu-id="4429f-158">Different Windows operating systems provide alternative tools for configuring Windows Firewall.</span></span> <span data-ttu-id="4429f-159">A maioria dessas ferramentas permitem optar entre abrir uma porta específica ou o programa executável.</span><span class="sxs-lookup"><span data-stu-id="4429f-159">Most of these tools let you choose between opening a specific port or program executable.</span></span> <span data-ttu-id="4429f-160">A menos que você tenha um motivo para especificar o programa executável, recomendamos que especifique a porta.</span><span class="sxs-lookup"><span data-stu-id="4429f-160">Unless you have a reason for specifying the program executable, we recommend that you specify the port.</span></span>  
  
 <span data-ttu-id="4429f-161">Ao especificar uma regra de entrada, procure adotar uma convenção de nomenclatura que lhe permita localizar facilmente as regras posteriormente (por exemplo, **SQL Server Analysis Services (TCP-in) 2383**).</span><span class="sxs-lookup"><span data-stu-id="4429f-161">When specifying an inbound rule, be sure to adopt a naming convention that allows you to easily find the rules later (for example, **SQL Server Analysis Services (TCP-in) 2383**).</span></span>  
  
#### <a name="windows-firewall-with-advanced-security"></a><span data-ttu-id="4429f-162">Firewall do Windows com Advanced Security</span><span class="sxs-lookup"><span data-stu-id="4429f-162">Windows Firewall with Advanced Security</span></span>  
  
1.  <span data-ttu-id="4429f-163">No Windows 7 ou Windows Vista, no Painel de Controle, clique em **Sistema e Segurança**, selecione **Firewall do Windows**e clique em **Configurações avançadas**.</span><span class="sxs-lookup"><span data-stu-id="4429f-163">On Windows 7 or Windows Vista, in Control Panel, click **System and Security**, select **Windows Firewall**, and then click **Advanced settings**.</span></span> <span data-ttu-id="4429f-164">No Windows Server 2008 ou 2008 R2, abra Ferramentas do Administrador e clique em **Firewall do Windows com Segurança Avançada**.</span><span class="sxs-lookup"><span data-stu-id="4429f-164">On Windows Server 2008 or 2008 R2, open Administrator Tools and click **Windows Firewall with Advanced Security**.</span></span> <span data-ttu-id="4429f-165">No Windows Server 2012, abra a página de aplicativos e digite **Windows Firewall**.</span><span class="sxs-lookup"><span data-stu-id="4429f-165">On Windows Server 2012, open the Applications page and type **Windows Firewall**.</span></span>  
  
2.  <span data-ttu-id="4429f-166">Clique com o botão direito do mouse em **Regras de Entrada** e selecione **Nova Regra**.</span><span class="sxs-lookup"><span data-stu-id="4429f-166">Right-click **Inbound Rules** and select **New Rule**.</span></span>  
  
3.  <span data-ttu-id="4429f-167">Em tipo de regra, clique em `Port` e em **Avançar**.</span><span class="sxs-lookup"><span data-stu-id="4429f-167">In Rule Type, click `Port` and then click **Next**.</span></span>  
  
4.  <span data-ttu-id="4429f-168">Em protocolo e portas, selecione **TCP** e digite `2383` **portas locais específicas**.</span><span class="sxs-lookup"><span data-stu-id="4429f-168">In Protocol and Ports, select **TCP** and then type `2383` in **Specific local ports**.</span></span>  
  
5.  <span data-ttu-id="4429f-169">Em Ação, clique em **Permitir a conexão** e em **Avançar**.</span><span class="sxs-lookup"><span data-stu-id="4429f-169">In Action, click **Allow the connection** and then click **Next**.</span></span>  
  
6.  <span data-ttu-id="4429f-170">Em Perfil, desmarque os locais de rede que não se apliquem e clique em **Avançar**.</span><span class="sxs-lookup"><span data-stu-id="4429f-170">In Profile, clear any network locations that do not apply and then click **Next**.</span></span>  
  
7.  <span data-ttu-id="4429f-171">Em nome, digite um nome descritivo para essa regra (por exemplo, `SQL Server Analysis Services (tcp-in) 2383` ) e clique em **concluir**.</span><span class="sxs-lookup"><span data-stu-id="4429f-171">In Name, type a descriptive name for this rule (for example, `SQL Server Analysis Services (tcp-in) 2383`), and then click **Finish**.</span></span>  
  
8.  <span data-ttu-id="4429f-172">Para verificar que conexões remotas são habilitadas, abra o SQL Server Management Studio ou o Excel em outro computador e conecte-se ao [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , especificando o nome de rede do servidor em **Nome do servidor**.</span><span class="sxs-lookup"><span data-stu-id="4429f-172">To verify that remote connections are enabled, open SQL Server Management Studio or Excel on a different computer and connect to [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] by specifying the network name of the server in **Server name**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="4429f-173">Outros usuários não terão acesso a esse servidor até você conceder as devidas permissões.</span><span class="sxs-lookup"><span data-stu-id="4429f-173">Other users will not have access to this server until you grant permissions.</span></span> <span data-ttu-id="4429f-174">Para saber mais, veja [Autorizar o acesso a objetos e operações &#40;Analysis Services 41](../multidimensional-models/authorizing-access-to-objects-and-operations-analysis-services.md).</span><span class="sxs-lookup"><span data-stu-id="4429f-174">For more information, see [Authorizing access to objects and operations &#40;Analysis Services&#41;](../multidimensional-models/authorizing-access-to-objects-and-operations-analysis-services.md).</span></span>  
  
#### <a name="netsh-advfirewall-syntax"></a><span data-ttu-id="4429f-175">Sintaxe de Netsh AdvFirewall</span><span class="sxs-lookup"><span data-stu-id="4429f-175">Netsh AdvFirewall Syntax</span></span>  
  
-   <span data-ttu-id="4429f-176">O comando a seguir cria uma regra de entrada que permite solicitações de entrada na porta TCP 2383.</span><span class="sxs-lookup"><span data-stu-id="4429f-176">The following command creates an inbound rule that allows incoming requests on TCP port 2383.</span></span>  
  
    ```  
    netsh advfirewall firewall add rule name="SQL Server Analysis Services inbound on TCP 2383" dir=in action=allow protocol=TCP localport=2383 profile=domain  
    ```  
  
##  <a name="configure-windows-firewall-access-for-a-named-instance-of-analysis-services"></a><a name="bkmk_named"></a><span data-ttu-id="4429f-177">Configurar o acesso ao firewall do Windows para uma instância nomeada do Analysis Services</span><span class="sxs-lookup"><span data-stu-id="4429f-177">Configure Windows Firewall access for a named instance of Analysis Services</span></span>  
 <span data-ttu-id="4429f-178">As instâncias nomeadas do [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] podem escutar em uma porta fixa ou em uma porta dinamicamente atribuída, onde o serviço SQL Server Browser fornece as informações atuais de conexão ao serviço no momento da conexão.</span><span class="sxs-lookup"><span data-stu-id="4429f-178">Named instances of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] can either listen on a fixed port or on a dynamically assigned port, where SQL Server Browser service provides the connection information that is current for the service at the time of the connection.</span></span>  
  
 <span data-ttu-id="4429f-179">O serviço SQL Server Browser escuta na porta TCP 2382.</span><span class="sxs-lookup"><span data-stu-id="4429f-179">SQL Server Browser service listens on TCP port 2382.</span></span> <span data-ttu-id="4429f-180">O UDP não é usado.</span><span class="sxs-lookup"><span data-stu-id="4429f-180">UDP is not used.</span></span> <span data-ttu-id="4429f-181">O TCP é o único protocolo de transmissão usado pelo [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4429f-181">TCP is the only transmission protocol used by [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="4429f-182">Escolha uma das seguintes abordagens para habilitar o acesso remoto a uma instância nomeada do Analysis Services:</span><span class="sxs-lookup"><span data-stu-id="4429f-182">Choose one of the following approaches to enable remote access to a named instance of Analysis Services:</span></span>  
  
-   <span data-ttu-id="4429f-183">Use as atribuições de porta dinâmica e o serviço SQL Server Browser.</span><span class="sxs-lookup"><span data-stu-id="4429f-183">Use dynamic port assignments and SQL Server Browser service.</span></span> <span data-ttu-id="4429f-184">Desbloqueie a porta usada pelo serviço SQL Server Browser no Firewall do Windows.</span><span class="sxs-lookup"><span data-stu-id="4429f-184">Unblock the port used by SQL Server Browser service in Windows Firewall.</span></span> <span data-ttu-id="4429f-185">Conecte-se ao servidor neste formato: \<servername> \\<InstanceName \> .</span><span class="sxs-lookup"><span data-stu-id="4429f-185">Connect to the server in this format: \<servername>\\<instancename\>.</span></span>  
  
-   <span data-ttu-id="4429f-186">Use uma porta fixa e o serviço SQL Server Browser juntos.</span><span class="sxs-lookup"><span data-stu-id="4429f-186">Use a fixed port and SQL Server Browser service together.</span></span> <span data-ttu-id="4429f-187">Essa abordagem permite que você se conecte usando este formato: \<servername> \\<InstanceName \> , idêntico à abordagem de atribuição de porta dinâmica, exceto que, nesse caso, o servidor escuta em uma porta fixa.</span><span class="sxs-lookup"><span data-stu-id="4429f-187">This approach lets you connect using this format: \<servername>\\<instancename\>, identical to the dynamic port assignment approach, except that in this case the server listens on a fixed port.</span></span> <span data-ttu-id="4429f-188">Neste cenário, o serviço SQL Server Browser fornece a resolução de nome à instância do Analysis Services que escuta na porta fixa.</span><span class="sxs-lookup"><span data-stu-id="4429f-188">In this scenario, SQL Server Browser Service provides name resolution to the Analysis Services instance listening on the fixed port.</span></span> <span data-ttu-id="4429f-189">Para usar esta abordagem, configure o servidor para escutar em uma porta fixa, desbloqueie o acesso a essa porta e desbloqueie o acesso à porta usada pelo serviço SQL Server Browser.</span><span class="sxs-lookup"><span data-stu-id="4429f-189">To use this approach, configure the server to listen on a fixed port, unblock access to that port, and unblock access to the port used by SQL Server Browser service.</span></span>  
  
 <span data-ttu-id="4429f-190">O serviço SQL Server Browser só é usado com instâncias nomeadas, nunca com a instância padrão.</span><span class="sxs-lookup"><span data-stu-id="4429f-190">SQL Server Browser service is only used with named instances, never with the default instance.</span></span> <span data-ttu-id="4429f-191">O serviço é instalado e habilitado automaticamente sempre que você instala qualquer recurso do SQL Server como uma instância nomeada.</span><span class="sxs-lookup"><span data-stu-id="4429f-191">The service is automatically installed and enabled whenever you install any SQL Server feature as a named instance.</span></span> <span data-ttu-id="4429f-192">Se você optar por uma abordagem que exija o serviço SQL Server Browser, mantenha-o habilitado e iniciado no seu servidor.</span><span class="sxs-lookup"><span data-stu-id="4429f-192">If you choose an approach that requires SQL Server Browser service, be sure it remains enabled and started on your server.</span></span>  
  
 <span data-ttu-id="4429f-193">Se você não puder usar o serviço SQL Server Browser, deverá atribuir uma porta fixa na cadeia de conexão, ignorando a resolução do nome de domínio.</span><span class="sxs-lookup"><span data-stu-id="4429f-193">If you cannot use SQL Server Browser service, you must assign a fixed port in the connection string, bypassing domain name resolution.</span></span> <span data-ttu-id="4429f-194">Sem o serviço SQL Server Browser, todas as conexões de cliente devem incluir o número da porta na cadeia de conexão (por exemplo, AW-SRV01: 54321).</span><span class="sxs-lookup"><span data-stu-id="4429f-194">Without SQL Server Browser service, all client connections must include the port number on the connection string (for example, AW-SRV01:54321).</span></span>  
  
 <span data-ttu-id="4429f-195">**Opção 1: Use as atribuições de porta dinâmica e desbloqueie o acesso ao serviço SQL Server Browser**</span><span class="sxs-lookup"><span data-stu-id="4429f-195">**Option 1: Use dynamic port assignments and unblock access to SQL Server Browser service**</span></span>  
  
 <span data-ttu-id="4429f-196">As atribuições de porta dinâmica para instâncias nomeadas do Analysis Services são estabelecidas pelo `MSOLAP$InstanceName` quando o serviço inicia.</span><span class="sxs-lookup"><span data-stu-id="4429f-196">Dynamic port assignments for named instances of Analysis Services are established by the `MSOLAP$InstanceName` when the service starts.</span></span> <span data-ttu-id="4429f-197">Por padrão, o serviço reivindica o primeiro número de porta disponível encontrado, usando um número de porta diferente cada vez que o serviço é reiniciado.</span><span class="sxs-lookup"><span data-stu-id="4429f-197">By default, the service claims the first available port number that it finds, using a different port number each time the service is restarted.</span></span>  
  
 <span data-ttu-id="4429f-198">A resolução de nome de instância é tratada pelo serviço de SQL Server Browser.</span><span class="sxs-lookup"><span data-stu-id="4429f-198">Instance name resolution is handled by the SQL Server browser service.</span></span> <span data-ttu-id="4429f-199">O desbloqueio da porta TCP 2382 para o serviço SQL Server Browser é sempre necessário quando você usa atribuições de porta dinâmica com uma instância nomeada.</span><span class="sxs-lookup"><span data-stu-id="4429f-199">Unblocking TCP port 2382 for SQL Server Browser service is always required if you are using dynamic port assignments with a named instance.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="4429f-200">O serviço SQL Server Browser escuta na porta UDP 1434 e na porta TCP 2382 para o Mecanismo de Banco de Dados e o Analysis Services, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="4429f-200">SQL Server Browser service listens on both UDP port 1434 and TCP port 2382 for the Database Engine and Analysis Services, respectively.</span></span> <span data-ttu-id="4429f-201">Mesmo que você já tenha desbloqueado a porta UDP 1434 para o serviço SQL Server Browser, ainda precisará desbloquear a porta TCP 2382 para o Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="4429f-201">Even if you already unblocked UDP port 1434 for the SQL Server Browser service, you must still unblock TCP port 2382 for Analysis Services.</span></span>  
  
#### <a name="windows-firewall-with-advanced-security"></a><span data-ttu-id="4429f-202">Firewall do Windows com Advanced Security</span><span class="sxs-lookup"><span data-stu-id="4429f-202">Windows Firewall with Advanced Security</span></span>  
  
1.  <span data-ttu-id="4429f-203">No Windows 7 ou Windows Vista, no Painel de Controle, clique em **Sistema e Segurança**, selecione **Firewall do Windows**e clique em **Configurações avançadas**.</span><span class="sxs-lookup"><span data-stu-id="4429f-203">On Windows 7 or Windows Vista, in Control Panel, click **System and Security**, select **Windows Firewall**, and then click **Advanced settings**.</span></span> <span data-ttu-id="4429f-204">No Windows Server 2008 ou 2008 R2, abra Ferramentas do Administrador e clique em **Firewall do Windows com Segurança Avançada**.</span><span class="sxs-lookup"><span data-stu-id="4429f-204">On Windows Server 2008 or 2008 R2, open Administrator Tools and click **Windows Firewall with Advanced Security**.</span></span> <span data-ttu-id="4429f-205">No Windows Server 2012, abra a página de aplicativos e digite **Windows Firewall**.</span><span class="sxs-lookup"><span data-stu-id="4429f-205">On Windows Server 2012, open the Applications page and type **Windows Firewall**.</span></span>  
  
2.  <span data-ttu-id="4429f-206">Para desbloquear o acesso ao serviço SQL Server Browser, clique com o botão direito do mouse em **Regras de Entrada** e selecione **Nova Regra**.</span><span class="sxs-lookup"><span data-stu-id="4429f-206">To unblock access to SQL Server Browser service, right-click **Inbound Rules** and select **New Rule**.</span></span>  
  
3.  <span data-ttu-id="4429f-207">Em tipo de regra, clique em `Port` e em **Avançar**.</span><span class="sxs-lookup"><span data-stu-id="4429f-207">In Rule Type, click `Port` and then click **Next**.</span></span>  
  
4.  <span data-ttu-id="4429f-208">Em protocolo e portas, selecione **TCP** e digite `2382` **portas locais específicas**.</span><span class="sxs-lookup"><span data-stu-id="4429f-208">In Protocol and Ports, select **TCP** and then type `2382` in **Specific local ports**.</span></span>  
  
5.  <span data-ttu-id="4429f-209">Em Ação, clique em **Permitir a conexão** e em **Avançar**.</span><span class="sxs-lookup"><span data-stu-id="4429f-209">In Action, click **Allow the connection** and then click **Next**.</span></span>  
  
6.  <span data-ttu-id="4429f-210">Em Perfil, desmarque os locais de rede que não se apliquem e clique em **Avançar**.</span><span class="sxs-lookup"><span data-stu-id="4429f-210">In Profile, clear any network locations that do not apply and then click **Next**.</span></span>  
  
7.  <span data-ttu-id="4429f-211">Em nome, digite um nome descritivo para essa regra (por exemplo, `SQL Server Browser Service (tcp-in) 2382` ) e clique em **concluir**.</span><span class="sxs-lookup"><span data-stu-id="4429f-211">In Name, type a descriptive name for this rule (for example, `SQL Server Browser Service (tcp-in) 2382`), and then click **Finish**.</span></span>  
  
8.  <span data-ttu-id="4429f-212">Para verificar se as conexões remotas estão habilitadas, abra SQL Server Management Studio ou Excel em um computador diferente e conecte-se ao Analysis Services especificando o nome de rede do servidor e o nome da instância neste formato: \<servername> \\<InstanceName \> .</span><span class="sxs-lookup"><span data-stu-id="4429f-212">To verify that remote connections are enabled, open SQL Server Management Studio or Excel on a different computer and connect to the Analysis Services by specifying the network name of the server and the instance name in this format: \<servername>\\<instancename\>.</span></span> <span data-ttu-id="4429f-213">Por exemplo, em um servidor nomeado **AW-SRV01** com uma instância nomeada de **Finanças**, o nome do servidor é **AW-SRV01\Finance**.</span><span class="sxs-lookup"><span data-stu-id="4429f-213">For example, on a server named **AW-SRV01** with a named instance of **Finance**, the server name is **AW-SRV01\Finance**.</span></span>  
  
 <span data-ttu-id="4429f-214">**Opção 2: Usar uma porta fixa para uma instância nomeada**</span><span class="sxs-lookup"><span data-stu-id="4429f-214">**Option 2: Use a fixed port for a named instance**</span></span>  
  
 <span data-ttu-id="4429f-215">Outra alternativa é atribuir uma porta fixa e desbloquear o acesso a essa porta.</span><span class="sxs-lookup"><span data-stu-id="4429f-215">Alternatively, you can assign a fixed port, and then unblock access to that port.</span></span> <span data-ttu-id="4429f-216">Esta abordagem oferece um recurso melhor de auditoria quando você permite o acesso ao executável do programa.</span><span class="sxs-lookup"><span data-stu-id="4429f-216">This approach offers better auditing capability than if you allowed access to the program executable.</span></span> <span data-ttu-id="4429f-217">Por isso, o uso de uma porta fixa é a abordagem recomendada para acessar qualquer instância do Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="4429f-217">For this reason, using a fixed port is the recommended approach for accessing any Analysis Services instance.</span></span>  
  
 <span data-ttu-id="4429f-218">Para atribuir uma porta fixa, siga as instruções em [Usar uma porta fixa para uma instância padrão ou nomeada do Analysis Services](#bkmk_fixed) neste tópico e, depois, volte a esta seção para desbloquear a porta.</span><span class="sxs-lookup"><span data-stu-id="4429f-218">To assign a fixed port, follow the instructions in [Use a fixed port for a default or named instance of Analysis Services](#bkmk_fixed) in this topic, then return to this section to unblock the port.</span></span>  
  
#### <a name="windows-firewall-with-advanced-security"></a><span data-ttu-id="4429f-219">Firewall do Windows com Advanced Security</span><span class="sxs-lookup"><span data-stu-id="4429f-219">Windows Firewall with Advanced Security</span></span>  
  
1.  <span data-ttu-id="4429f-220">No Windows 7 ou Windows Vista, no Painel de Controle, clique em **Sistema e Segurança**, selecione **Firewall do Windows**e clique em **Configurações avançadas**.</span><span class="sxs-lookup"><span data-stu-id="4429f-220">On Windows 7 or Windows Vista, in Control Panel, click **System and Security**, select **Windows Firewall**, and then click **Advanced settings**.</span></span> <span data-ttu-id="4429f-221">No Windows Server 2008 ou 2008 R2, abra Ferramentas do Administrador e clique em **Firewall do Windows com Segurança Avançada**.</span><span class="sxs-lookup"><span data-stu-id="4429f-221">On Windows Server 2008 or 2008 R2, open Administrator Tools and click **Windows Firewall with Advanced Security**.</span></span> <span data-ttu-id="4429f-222">No Windows Server 2012, abra a página de aplicativos e digite **Windows Firewall**.</span><span class="sxs-lookup"><span data-stu-id="4429f-222">On Windows Server 2012, open the Applications page and type **Windows Firewall**.</span></span>  
  
2.  <span data-ttu-id="4429f-223">Para desbloquear o acesso ao Analysis Services, clique com o botão direito do mouse em **Regras de Entrada** e selecione **Nova Regra**.</span><span class="sxs-lookup"><span data-stu-id="4429f-223">To unblock access to Analysis Services, right-click **Inbound Rules** and select **New Rule**.</span></span>  
  
3.  <span data-ttu-id="4429f-224">Em tipo de regra, clique em `Port` e em **Avançar**.</span><span class="sxs-lookup"><span data-stu-id="4429f-224">In Rule Type, click `Port` and then click **Next**.</span></span>  
  
4.  <span data-ttu-id="4429f-225">Em Protocolo e Portas, selecione **TCP** e digite a porta fixa em **Portas locais específicas**.</span><span class="sxs-lookup"><span data-stu-id="4429f-225">In Protocol and Ports, select **TCP** and then type the fixed port in **Specific local ports**.</span></span>  
  
5.  <span data-ttu-id="4429f-226">Em Ação, clique em **Permitir a conexão** e em **Avançar**.</span><span class="sxs-lookup"><span data-stu-id="4429f-226">In Action, click **Allow the connection** and then click **Next**.</span></span>  
  
6.  <span data-ttu-id="4429f-227">Em Perfil, desmarque os locais de rede que não se apliquem e clique em **Avançar**.</span><span class="sxs-lookup"><span data-stu-id="4429f-227">In Profile, clear any network locations that do not apply and then click **Next**.</span></span>  
  
7.  <span data-ttu-id="4429f-228">Em nome, digite um nome descritivo para essa regra (por exemplo, `SQL Server Analysis Services on port 54321` ) e clique em **concluir**.</span><span class="sxs-lookup"><span data-stu-id="4429f-228">In Name, type a descriptive name for this rule (for example, `SQL Server Analysis Services on port 54321`), and then click **Finish**.</span></span>  
  
8.  <span data-ttu-id="4429f-229">Para verificar se as conexões remotas estão habilitadas, abra SQL Server Management Studio ou Excel em um computador diferente e conecte-se ao Analysis Services especificando o nome de rede do servidor e o número da porta neste formato: \<servername> : \<portnumber> .</span><span class="sxs-lookup"><span data-stu-id="4429f-229">To verify that remote connections are enabled, open SQL Server Management Studio or Excel on a different computer and connect to the Analysis Services by specifying the network name of the server and the port number in this format: \<servername>:\<portnumber>.</span></span>  
  
#### <a name="netsh-advfirewall-syntax"></a><span data-ttu-id="4429f-230">Sintaxe de Netsh AdvFirewall</span><span class="sxs-lookup"><span data-stu-id="4429f-230">Netsh AdvFirewall Syntax</span></span>  
  
-   <span data-ttu-id="4429f-231">Os comandos a seguir criam as regras de entrada que desbloqueiam o TCP 2382 para o serviço SQL Server Browser e desbloqueiam a porta fixa especificada para a instância do Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="4429f-231">The following commands create inbound rules that unblock TCP 2382 for SQL Server Browser service and unblock the fixed port that you specified for the Analysis Services instance.</span></span> <span data-ttu-id="4429f-232">Você pode executar qualquer um dos dois para permitir o acesso a uma instância do Analysis Services nomeada.</span><span class="sxs-lookup"><span data-stu-id="4429f-232">You can run either one to allow access to a named Analysis Services instance.</span></span>  
  
     <span data-ttu-id="4429f-233">Neste comando de exemplo, a porta 54321 é a porta fixa.</span><span class="sxs-lookup"><span data-stu-id="4429f-233">In this sample command, port 54321 is the fixed port.</span></span> <span data-ttu-id="4429f-234">Substitua-a pela porta real em uso no seu sistema.</span><span class="sxs-lookup"><span data-stu-id="4429f-234">Be sure to replace it with the actual port in use on your system.</span></span>  
  
    ```  
    netsh advfirewall firewall add rule name="SQL Server Analysis Services (tcp-in) on 54321" dir=in action=allow protocol=TCP localport=54321 profile=domain  
    ```  
  
    ```  
    netsh advfirewall firewall add rule name="SQL Server Browser Services inbound on TCP 2382" dir=in action=allow protocol=TCP localport=2382 profile=domain  
    ```  
  
##  <a name="use-a-fixed-port-for-a-default-or-named-instance-of-analysis-services"></a><a name="bkmk_fixed"></a><span data-ttu-id="4429f-235">Use uma porta fixa para uma instância padrão ou nomeada do Analysis Services</span><span class="sxs-lookup"><span data-stu-id="4429f-235">Use a fixed port for a default or named instance of Analysis Services</span></span>  
 <span data-ttu-id="4429f-236">Esta seção explica como configurar o Analysis Services para escutar em uma porta fixa.</span><span class="sxs-lookup"><span data-stu-id="4429f-236">This section explains how to configure Analysis Services to listen on a fixed port.</span></span> <span data-ttu-id="4429f-237">O uso de uma porta fixa é comum quando você instala o Analysis Services como uma instância nomeada, mas você também pode usar esta abordagem quando os requisitos de negócios ou de segurança especificam o uso de atribuições de porta não padrão.</span><span class="sxs-lookup"><span data-stu-id="4429f-237">Using a fixed port is common if you installed Analysis Services as a named instance, but you can also use this approach if business or security requirements specify that you use non-default port assignments.</span></span>  
  
 <span data-ttu-id="4429f-238">Observe que o uso de uma porta fixa alterará a sintaxe de conexão para a instância padrão, exigindo o acréscimo do número de porta ao nome de servidor.</span><span class="sxs-lookup"><span data-stu-id="4429f-238">Note that using a fixed port will alter the connection syntax for the default instance by requiring you to append the port number to the server name.</span></span> <span data-ttu-id="4429f-239">Por exemplo, a conexão a uma instância padrão local do Analysis Services que escuta na porta 54321 no SQL Server Management Studio exigiria que você digitasse localhost:54321 como o nome de servidor na caixa de diálogo Conectar ao Servidor no Management Studio.</span><span class="sxs-lookup"><span data-stu-id="4429f-239">For example, connecting to a local, default Analysis Services instance listening on port 54321 in SQL Server Management Studio would require that you type localhost:54321 as the server name in the Connect to Server dialog box in Management Studio.</span></span>  
  
 <span data-ttu-id="4429f-240">Se você estiver usando uma instância nomeada, poderá atribuir uma porta fixa sem alterações na forma como especifica o nome do servidor (especificamente, você pode usar o \<servername\instancename> para se conectar a uma instância nomeada escutando em uma porta fixa).</span><span class="sxs-lookup"><span data-stu-id="4429f-240">If you are using a named instance, you can assign a fixed port with no changes to how you specify the server name (specifically, you can use \<servername\instancename> to connect to a named instance listening on a fixed port).</span></span> <span data-ttu-id="4429f-241">Isso só funcionará se o serviço SQL Server Browser estiver em execução e você tiver desbloqueado a porta na qual ele esteja escutando.</span><span class="sxs-lookup"><span data-stu-id="4429f-241">This works only if SQL Server Browser service is running and you unblocked the port on which it is listening.</span></span> <span data-ttu-id="4429f-242">SQL Server Browser serviço fornecerá redirecionamento para a porta fixa com base em \<servername\instancename> .</span><span class="sxs-lookup"><span data-stu-id="4429f-242">SQL Server Browser service will provide redirection to the fixed port based on \<servername\instancename>.</span></span> <span data-ttu-id="4429f-243">Contanto que você abra portas para o serviço SQL Server Browser e a instância nomeada do Analysis Services que escuta na porta fixa, o serviço SQL Server Browser resolverá a conexão a uma instância nomeada.</span><span class="sxs-lookup"><span data-stu-id="4429f-243">As long as you open ports for both SQL Server Browser service and the named instance of Analysis Services listening on the fixed port, SQL Server Browser service will resolve the connection to a named instance.</span></span>  
  
1.  <span data-ttu-id="4429f-244">Determine uma porta TCP/IP disponível a ser usada.</span><span class="sxs-lookup"><span data-stu-id="4429f-244">Determine an available TCP/IP port to use.</span></span>  
  
     <span data-ttu-id="4429f-245">Para exibir uma lista de portas reservadas e registradas que você deve evitar usar, consulte [Port Numbers (IANA)](https://go.microsoft.com/fwlink/?LinkID=198469)(página em inglês).</span><span class="sxs-lookup"><span data-stu-id="4429f-245">To view a list of reserved and registered ports that you should avoid using, see [Port Numbers (IANA)](https://go.microsoft.com/fwlink/?LinkID=198469).</span></span> <span data-ttu-id="4429f-246">Para exibir uma lista de portas que já estão em uso em seu sistema, abra uma janela de prompt de comando e digite `netstat -a -p TCP` para exibir uma lista de portas TCP que estão abertas no sistema.</span><span class="sxs-lookup"><span data-stu-id="4429f-246">To view a list of ports that are already in use on your system, open a command prompt window and type `netstat -a -p TCP` to display a list of the TCP ports that are open on the system.</span></span>  
  
2.  <span data-ttu-id="4429f-247">Após determinar a porta a ser usada, especifique a porta editando a configuração de `Port` no arquivo msmdsrv.ini ou na página de propriedades Geral de uma instância do Analysis Services no SQL Server Management Studio.</span><span class="sxs-lookup"><span data-stu-id="4429f-247">After you determine which port to use, specify the port by either editing the `Port` configuration setting in the msmdsrv.ini file or in the General properties page of an Analysis Services instance in SQL Server Management Studio.</span></span>  
  
3.  <span data-ttu-id="4429f-248">Reinicie o serviço.</span><span class="sxs-lookup"><span data-stu-id="4429f-248">Restart the service.</span></span>  
  
4.  <span data-ttu-id="4429f-249">Configure o Firewall do Windows para desbloquear a porta TCP especificada.</span><span class="sxs-lookup"><span data-stu-id="4429f-249">Configure Windows Firewall to unblock the TCP port you specified.</span></span> <span data-ttu-id="4429f-250">Ou, se você estiver usando uma porta fixa para uma instância nomeada, desbloqueie a porta TCP especificada para essa instância e a porta TCP 2382 para o serviço SQL Server Browser.</span><span class="sxs-lookup"><span data-stu-id="4429f-250">Or, if you are using a fixed port for a named instance, unblock both the TCP port you specified for that instance and TCP port 2382 for SQL Server Browser service.</span></span>  
  
5.  <span data-ttu-id="4429f-251">Verifique isso conectando-se localmente (no Management Studio) e, em seguida, remotamente, de um aplicativo cliente em outro computador.</span><span class="sxs-lookup"><span data-stu-id="4429f-251">Verify by connecting locally (in Management Studio) and then remotely from a client application on another computer.</span></span> <span data-ttu-id="4429f-252">Para usar Management Studio, conecte-se a uma instância de Analysis Services padrão, especificando um nome de servidor neste formato: \<servername> : \<portnumber> .</span><span class="sxs-lookup"><span data-stu-id="4429f-252">To use Management Studio, connect to an Analysis Services default instance by specifying a server name in this format: \<servername>:\<portnumber>.</span></span> <span data-ttu-id="4429f-253">Para uma instância nomeada, especifique o nome do servidor como \<servername> \\<InstanceName \> .</span><span class="sxs-lookup"><span data-stu-id="4429f-253">For a named instance, specify the server name as \<servername>\\<instancename\>.</span></span>  
  
##  <a name="port-configuration-for-an-analysis-services-cluster"></a><a name="bkmk_cluster"></a><span data-ttu-id="4429f-254">Configuração de porta para um cluster Analysis Services</span><span class="sxs-lookup"><span data-stu-id="4429f-254">Port configuration for an Analysis Services cluster</span></span>  
 <span data-ttu-id="4429f-255">Um cluster de failover do [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] sempre realiza a escuta na porta TCP 2383, independentemente de você ter feito a instalação como uma instância padrão ou nomeada.</span><span class="sxs-lookup"><span data-stu-id="4429f-255">An [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] failover cluster always listens on TCP port 2383, regardless of whether you installed it as a default instance or named instance.</span></span> <span data-ttu-id="4429f-256">As atribuições de porta dinâmica não são usadas pelo [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] quando ele é instalado em um cluster de failover do Windows.</span><span class="sxs-lookup"><span data-stu-id="4429f-256">Dynamic port assignments are not used by [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] when it is installed on a Windows failover cluster.</span></span> <span data-ttu-id="4429f-257">Abra a TCP 2383 em todos os nós que estão executando o [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] no cluster.</span><span class="sxs-lookup"><span data-stu-id="4429f-257">Be sure to open TCP 2383 on every node running [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] in the cluster.</span></span> <span data-ttu-id="4429f-258">Para obter mais informações sobre o clustering do [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], consulte [Como clusterizar o SQL Server Analysis Services](https://go.microsoft.com/fwlink/p/?LinkId=396548).</span><span class="sxs-lookup"><span data-stu-id="4429f-258">For more information about clustering [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], see [How to Cluster SQL Server Analysis Services](https://go.microsoft.com/fwlink/p/?LinkId=396548).</span></span>  
  
##  <a name="port-configuration-for-powerpivot-for-sharepoint"></a><a name="bkmk_powerpivot"></a><span data-ttu-id="4429f-259">Configuração de porta para PowerPivot para SharePoint</span><span class="sxs-lookup"><span data-stu-id="4429f-259">Port configuration for PowerPivot for SharePoint</span></span>  
 <span data-ttu-id="4429f-260">A arquitetura de servidor para o [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] é bem diferente dependendo da versão do SharePoint que você está usando.</span><span class="sxs-lookup"><span data-stu-id="4429f-260">Server architecture for [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] is fundamentally different depending on which version of SharePoint you are using.</span></span>  
  
 <span data-ttu-id="4429f-261">**SharePoint 2013**</span><span class="sxs-lookup"><span data-stu-id="4429f-261">**SharePoint 2013**</span></span>  
  
 <span data-ttu-id="4429f-262">No SharePoint 2013, os Serviços do Excel redirecionam solicitações para modelos de dados do PowerPivot, que são carregados subsequentemente em uma instância do [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] fora do ambiente do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="4429f-262">In SharePoint 2013, Excel Services redirects requests for Power Pivot data models, which are subsequently loaded on an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance outside of the SharePoint environment.</span></span> <span data-ttu-id="4429f-263">As conexões seguem o padrão comum, onde uma biblioteca de cliente do Analysis Services em um computador local envia uma solicitação de conexão a uma instância remota do [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] na mesma rede.</span><span class="sxs-lookup"><span data-stu-id="4429f-263">Connections follow the typical pattern, where an Analysis Services client library on a local computer sends a connection request to a remote [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance in the same network.</span></span>  
  
 <span data-ttu-id="4429f-264">Como o [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] sempre instala o [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] como uma instância nomeada, você deverá supor o serviço SQL Server Browser e as atribuições de porta dinâmica.</span><span class="sxs-lookup"><span data-stu-id="4429f-264">Because [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] always installs [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] as a named instance, you should assume SQL Server Browser service and dynamic port assignments.</span></span> <span data-ttu-id="4429f-265">Como observado anteriormente, o serviço SQL Server Browser escuta na porta TCP 2382 para as solicitações de conexão enviadas às instâncias nomeadas do [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , redirecionando a solicitação para a porta atual.</span><span class="sxs-lookup"><span data-stu-id="4429f-265">As noted earlier, SQL Server Browser service listens on TCP port 2382 for connection requests sent to [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] named instances, redirecting the request to the current port.</span></span>  
  
 <span data-ttu-id="4429f-266">Observe que os Serviços do Excel no SharePoint 2013 não oferecem suporte à sintaxe de conexão de porta fixa, portanto, verifique se o serviço SQL Server Browser está acessível.</span><span class="sxs-lookup"><span data-stu-id="4429f-266">Note that Excel Services in SharePoint 2013 does not support the fixed port connection syntax, so make sure SQL Server Browser service is accessible.</span></span>  
  
 <span data-ttu-id="4429f-267">**SharePoint 2010**</span><span class="sxs-lookup"><span data-stu-id="4429f-267">**SharePoint 2010**</span></span>  
  
 <span data-ttu-id="4429f-268">Se você estiver usando o SharePoint 2010, não precisa abrir portas no Firewall do Windows.</span><span class="sxs-lookup"><span data-stu-id="4429f-268">If you are using SharePoint 2010, you do not need to open ports in Windows Firewall.</span></span> <span data-ttu-id="4429f-269">O SharePoint abre as portas necessárias e os suplementos como o PowerPivot para SharePoint funcionam no ambiente do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="4429f-269">SharePoint opens the ports that it requires, and add-ins such as PowerPivot for SharePoint operate within the SharePoint environment.</span></span> <span data-ttu-id="4429f-270">Em uma instalação do PowerPivot para SharePoint 2010, o Serviço de Sistema PowerPivot tem uso exclusivo da instância de serviço local do SQL Server Analysis Services (PowerPivot) que é instalada com ele no mesmo computador.</span><span class="sxs-lookup"><span data-stu-id="4429f-270">In a PowerPivot for SharePoint 2010 installation, the PowerPivot System Service has exclusive use of the local SQL Server Analysis Services (PowerPivot) service instance that is installed with it on the same computer.</span></span> <span data-ttu-id="4429f-271">Ele usa conexões locais, e não de rede, para acessar o serviço de mecanismo local Analysis Services que carrega, consulta e processa dados PowerPivot no servidor do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="4429f-271">It uses local connections, not network connections, to access the local Analysis Services engine service that loads, queries, and processes PowerPivot data on the SharePoint server.</span></span> <span data-ttu-id="4429f-272">Para solicitar dados PowerPivot de aplicativos cliente, as solicitações são roteadas por meio de portas que são abertas pela instalação do SharePoint (especificamente, as regras de entrada são definidas para permitir o acesso ao SharePoint-80, à administração central do SharePoint v4, aos serviços Web do SharePoint e ao SPUserCodeV4).</span><span class="sxs-lookup"><span data-stu-id="4429f-272">To request PowerPivot data from client applications, requests are routed through ports that are opened by SharePoint Setup (specifically, inbound rules are defined to allow access to SharePoint - 80, SharePoint Central Administration v4, SharePoint Web Services, and SPUserCodeV4).</span></span> <span data-ttu-id="4429f-273">Como os serviços Web PowerPivot são executados em um farm do SharePoint, as regras de firewall do SharePoint são suficientes para o acesso remoto a dados PowerPivot em um farm do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="4429f-273">Because PowerPivot web services run within a SharePoint farm, the SharePoint firewall rules are sufficient for remote access to PowerPivot data in a SharePoint farm.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="4429f-274">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="4429f-274">See Also</span></span>  
 <span data-ttu-id="4429f-275">[&#41;&#40;Mecanismo de Banco de Dados e SSAS do SQL Server Browser Service](../../database-engine/configure-windows/sql-server-browser-service-database-engine-and-ssas.md) </span><span class="sxs-lookup"><span data-stu-id="4429f-275">[SQL Server Browser Service &#40;Database Engine and SSAS&#41;](../../database-engine/configure-windows/sql-server-browser-service-database-engine-and-ssas.md) </span></span>  
 <span data-ttu-id="4429f-276">[Iniciar, parar, pausar, retomar, reiniciar o mecanismo de banco de dados, o SQL Server Agent ou o serviço SQL Server Browser](../../database-engine/configure-windows/start-stop-pause-resume-restart-sql-server-services.md) </span><span class="sxs-lookup"><span data-stu-id="4429f-276">[Start, Stop, Pause, Resume, Restart the Database Engine, SQL Server Agent, or SQL Server Browser Service](../../database-engine/configure-windows/start-stop-pause-resume-restart-sql-server-services.md) </span></span>  
 [<span data-ttu-id="4429f-277">Configurar um Firewall do Windows para acesso ao Mecanismo de Banco de Dados</span><span class="sxs-lookup"><span data-stu-id="4429f-277">Configure a Windows Firewall for Database Engine Access</span></span>](../../database-engine/configure-windows/configure-a-windows-firewall-for-database-engine-access.md)  
  
  
