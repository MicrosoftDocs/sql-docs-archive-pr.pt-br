---
title: Atualização de dados PowerPivot com o SharePoint 2010 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- unattended data refresh [Analysis Services with SharePoint]
- scheduled data refresh [Analysis Services with SharePoint]
- data refresh [Analysis Services with SharePoint]
ms.assetid: 01b54e6f-66e5-485c-acaa-3f9aa53119c9
author: minewiskan
ms.author: owend
ms.openlocfilehash: 01874bf521055d1441b695a238d09440021d2718
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87683158"
---
# <a name="powerpivot-data-refresh-with-sharepoint-2010"></a><span data-ttu-id="004dd-102">Atualização de dados PowerPivot com SharePoint 2010</span><span class="sxs-lookup"><span data-stu-id="004dd-102">PowerPivot Data Refresh with SharePoint 2010</span></span>
  <span data-ttu-id="004dd-103">A atualização de dados [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] é uma operação agendada no servidor que consulta fontes de dados externas para atualizar dados [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] inseridos em uma pasta de trabalho do Excel 2010 que é armazenada em uma biblioteca de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="004dd-103">[!INCLUDE[ssGemini](../includes/ssgemini-md.md)]t data refresh is a scheduled server-side operation that queries external data sources to update embedded [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] data in an Excel 2010 workbook that is stored in a content library.</span></span>

 <span data-ttu-id="004dd-104">A atualização de dados é um recurso interno do [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] para SharePoint, mas usá-lo exige que você execute serviços específicos e trabalhos de timer no farm do SharePoint 2010.</span><span class="sxs-lookup"><span data-stu-id="004dd-104">Data refresh is a built-in feature of [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] for SharePoint, but using it requires that you run specific services and timer jobs in your SharePoint 2010 farm.</span></span> <span data-ttu-id="004dd-105">Etapas administrativas adicionais, como a instalação de provedores de dados e a verificação de permissões de banco de dados, costumam ser necessárias para o êxito na atualização de dados.</span><span class="sxs-lookup"><span data-stu-id="004dd-105">Additional administrative steps, such as installing data providers and checking database permissions, are often required for data refresh to succeed.</span></span>

 <span data-ttu-id="004dd-106">**[!INCLUDE[applies](../includes/applies-md.md)]** SharePoint 2010</span><span class="sxs-lookup"><span data-stu-id="004dd-106">**[!INCLUDE[applies](../includes/applies-md.md)]**  SharePoint 2010</span></span>

> [!NOTE]
>  [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] <span data-ttu-id="004dd-107">e os Serviços do Excel do SharePoint Server 2013 usam uma arquitetura diferente para a atualização de dados dos modelos de dados [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="004dd-107">and SharePoint Server 2013 Excel Services use a different architecture for data refresh of [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] data models.</span></span> <span data-ttu-id="004dd-108">A nova arquitetura utiliza os Serviços do Excel como componente primário para carregar modelos de dados PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="004dd-108">The new architecture utilizes Excel Services as the primary component to load PowerPivot data models.</span></span> <span data-ttu-id="004dd-109">A arquitetura de atualização de dados anterior utilizada baseava-se em um servidor que executava o Serviço do Sistema PowerPivot e o [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] no modo do SharePoint para carregar modelos de dados.</span><span class="sxs-lookup"><span data-stu-id="004dd-109">The previous data refresh architecture used relied on a server running PowerPivot System Service and [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] in SharePoint mode to load data models.</span></span> <span data-ttu-id="004dd-110">Para obter mais informações, consulte [PowerPivot data Refresh com o SharePoint 2013](power-pivot-sharepoint/power-pivot-data-refresh-with-sharepoint-2013.md).</span><span class="sxs-lookup"><span data-stu-id="004dd-110">For more information, see [PowerPivot Data Refresh with SharePoint 2013](power-pivot-sharepoint/power-pivot-data-refresh-with-sharepoint-2013.md).</span></span>

 <span data-ttu-id="004dd-111">**Neste tópico:**</span><span class="sxs-lookup"><span data-stu-id="004dd-111">**In this topic:**</span></span>

 [<span data-ttu-id="004dd-112">Etapa 1: Habilitar o Serviço de Repositório Seguro e gerar uma chave mestra</span><span class="sxs-lookup"><span data-stu-id="004dd-112">Step 1: Enable Secure Store Service and Generate a Master Key</span></span>](#bkmk_services)

 [<span data-ttu-id="004dd-113">Etapa 2: Desativar as opções de credenciais para as quais não deseja oferecer suporte</span><span class="sxs-lookup"><span data-stu-id="004dd-113">Step 2: Turn off credential options that you do not want to support</span></span>](#bkmk_creds)

 [<span data-ttu-id="004dd-114">Etapa 3: Criar aplicativos de destino para armazenar credenciais usadas na atualização de dados</span><span class="sxs-lookup"><span data-stu-id="004dd-114">Step 3: Create target applications to store credentials used in data refresh</span></span>](#bkmk_stored)

 [<span data-ttu-id="004dd-115">Etapa 4: Configurar o servidor para atualização de dados evolutiva</span><span class="sxs-lookup"><span data-stu-id="004dd-115">Step 4: Configure the server for scalable data refresh</span></span>](#bkmk_scale)

 [<span data-ttu-id="004dd-116">Etapa 5: Instalar os provedores de dados usados para importar dados PowerPivot</span><span class="sxs-lookup"><span data-stu-id="004dd-116">Step 5: Install Data Providers Used to Import PowerPivot Data</span></span>](#bkmk_installdp)

 [<span data-ttu-id="004dd-117">Etapa 6: Conceder permissões para criar agendas e acessar fontes de dados externas</span><span class="sxs-lookup"><span data-stu-id="004dd-117">Step 6: Grant permissions to create schedules and access external data sources</span></span>](#bkmk_accounts)

 [<span data-ttu-id="004dd-118">Etapa 7: Habilitar a atualização de pasta de trabalho para atualização de dados</span><span class="sxs-lookup"><span data-stu-id="004dd-118">Step 7: Enable workbook upgrade for data refresh</span></span>](#bkmk_upgradewrkbk)

 [<span data-ttu-id="004dd-119">Etapa 8: Verificar a configuração de atualização de dados</span><span class="sxs-lookup"><span data-stu-id="004dd-119">Step 8: Verify data refresh configuration</span></span>](#bkmk_verify)

 [<span data-ttu-id="004dd-120">Modificar definições de configuração para a atualização de dados</span><span class="sxs-lookup"><span data-stu-id="004dd-120">Modify Configuration Settings for Data Refresh</span></span>](#bkmk_config)

 [<span data-ttu-id="004dd-121">Reagendar o trabalho de timer da Atualização de Dados PowerPivot</span><span class="sxs-lookup"><span data-stu-id="004dd-121">Reschedule the PowerPivot Data Refresh timer job</span></span>](#configTimerJob)

 [<span data-ttu-id="004dd-122">Desabilitar o trabalho de timer da atualização de dados</span><span class="sxs-lookup"><span data-stu-id="004dd-122">Disable the Data Refresh Timer Job</span></span>](#bkmk_disableDR)

 <span data-ttu-id="004dd-123">Após a verificação de que o ambiente de servidor e as permissões estão configurados, a atualização de dados estará pronta para uso.</span><span class="sxs-lookup"><span data-stu-id="004dd-123">After you ensure that the server environment and permissions are configured, data refresh is ready to use.</span></span> <span data-ttu-id="004dd-124">Para usar a atualização de dados, um usuário SharePoint cria uma agenda em uma pasta de trabalho PowerPivot que especifica a frequência da atualização de dados.</span><span class="sxs-lookup"><span data-stu-id="004dd-124">To use data refresh, a SharePoint user creates a schedule on a PowerPivot workbook that specifies how often data refresh occurs.</span></span> <span data-ttu-id="004dd-125">A criação da agenda costuma ser feita pelo proprietário da pasta de trabalho ou pelo autor que publicou o arquivo no SharePoint.</span><span class="sxs-lookup"><span data-stu-id="004dd-125">Creating the schedule is typically done by the workbook owner or author who published the file to SharePoint.</span></span> <span data-ttu-id="004dd-126">Essa pessoa cria e gerencia as agendas de atualização de dados para as pastas de trabalho de sua propriedade.</span><span class="sxs-lookup"><span data-stu-id="004dd-126">This person creates and manages the data refresh schedules for the workbooks that he or she owns.</span></span> <span data-ttu-id="004dd-127">Para obter mais informações, consulte [agendar uma atualização de dados &#40;PowerPivot para SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="004dd-127">For more information, see [Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md).</span></span>

##  <a name="step-1-enable-secure-store-service-and-generate-a-master-key"></a><a name="bkmk_services"></a><span data-ttu-id="004dd-128">Etapa 1: habilitar Serviço de Repositório Seguro e gerar uma chave mestra</span><span class="sxs-lookup"><span data-stu-id="004dd-128">Step 1: Enable Secure Store Service and Generate a Master Key</span></span>
 <span data-ttu-id="004dd-129">A atualização de dados PowerPivot depende do Serviço de Repositório Seguro para fornecer as credenciais usadas para executar trabalhos de atualização de dados e conectar-se a fontes de dados externas que usam credenciais armazenadas.</span><span class="sxs-lookup"><span data-stu-id="004dd-129">PowerPivot data refresh depends on Secure Store Service to provide credentials used to run data refresh jobs and to connect to external data sources that use stored credentials.</span></span>

 <span data-ttu-id="004dd-130">Se você instalou o PowerPivot para SharePoint usando a opção Novo Servidor, o Serviço de Repositório Seguro foi configurado para você.</span><span class="sxs-lookup"><span data-stu-id="004dd-130">If you installed PowerPivot for SharePoint using the New Server option, the Secure Store Service is configured for you.</span></span> <span data-ttu-id="004dd-131">Para outros cenários de instalação, crie e configure um aplicativo de serviço e gere uma chave de criptografia mestra para o Serviço de Repositório Seguro.</span><span class="sxs-lookup"><span data-stu-id="004dd-131">For all other installation scenarios, you must create and configure a service application and generate a master encryption key for Secure Store Service.</span></span>

> [!NOTE]
>  <span data-ttu-id="004dd-132">Você deve ser um administrador de farm para configurar o Serviço de Repositório Seguro ou delegar a administração do Serviço de Repositório Seguro a outro usuário.</span><span class="sxs-lookup"><span data-stu-id="004dd-132">You must be a farm administrator to configure Secure Store Service or delegate Secure Store Service administration to another user.</span></span> <span data-ttu-id="004dd-133">Você precisa ser um administrador de aplicativo de serviço para definir ou modificar configurações habilitadas.</span><span class="sxs-lookup"><span data-stu-id="004dd-133">You must be a service application administrator to configure or modify settings after it is enabled.</span></span>

1.  <span data-ttu-id="004dd-134">Na Administração Central, em Gerenciamento de Aplicativo, clique em **Gerenciar aplicativos de serviço**.</span><span class="sxs-lookup"><span data-stu-id="004dd-134">In Central Administration, in Application Management, click **Manage service applications**.</span></span>

2.  <span data-ttu-id="004dd-135">Na faixa de opções Aplicativos de Serviço, em Criar, clique em **Novo**.</span><span class="sxs-lookup"><span data-stu-id="004dd-135">In the Service Applications ribbon, in Create, click **New**.</span></span>

3.  <span data-ttu-id="004dd-136">Selecione **Serviço de Repositório Seguro**.</span><span class="sxs-lookup"><span data-stu-id="004dd-136">Select **Secure Store Service**.</span></span>

4.  <span data-ttu-id="004dd-137">Na página **Criar Aplicativo de Repositório Seguro** , insira um nome para o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="004dd-137">In the **Create Secure Store Application** page, enter a name for the application.</span></span>

5.  <span data-ttu-id="004dd-138">Em **Banco de Dados**, especifique a instância do SQL Server que hospedará o banco de dados para este aplicativo de serviço.</span><span class="sxs-lookup"><span data-stu-id="004dd-138">In **Database**, specify the SQL Server instance that will host the database for this service application.</span></span> <span data-ttu-id="004dd-139">O valor padrão é a instância de Mecanismo de Banco de Dados do SQL Server que hospeda os bancos de dados de configuração de farm.</span><span class="sxs-lookup"><span data-stu-id="004dd-139">The default value is the SQL Server Database Engine instance that hosts the farm configuration databases.</span></span>

6.  <span data-ttu-id="004dd-140">Em **Nome do Banco de Dados**, insira o nome do banco de dados de aplicativo de serviço.</span><span class="sxs-lookup"><span data-stu-id="004dd-140">In **Database Name**, enter the name of the service application database.</span></span> <span data-ttu-id="004dd-141">O valor padrão é Secure_Store_Service_DB_ \<guid> .</span><span class="sxs-lookup"><span data-stu-id="004dd-141">The default value is Secure_Store_Service_DB_\<guid>.</span></span> <span data-ttu-id="004dd-142">O nome padrão corresponde ao nome padrão do aplicativo de serviço.</span><span class="sxs-lookup"><span data-stu-id="004dd-142">The default name corresponds to the default name of the service application.</span></span> <span data-ttu-id="004dd-143">Se você inseriu um nome de aplicativo de serviço exclusivo, siga uma convenção de nomenclatura semelhante para seu nome de banco de dados de forma que você possa gerenciá-los em conjunto.</span><span class="sxs-lookup"><span data-stu-id="004dd-143">If you entered a unique service application name, follow a similar naming convention for your database name so that you can manage them together.</span></span>

7.  <span data-ttu-id="004dd-144">Em **Autenticação de Banco de dados**, o padrão é Autenticação do Windows.</span><span class="sxs-lookup"><span data-stu-id="004dd-144">In **Database Authentication**, the default is Windows Authentication.</span></span> <span data-ttu-id="004dd-145">Se você escolher Autenticação SQL, consulte o guia do administrador do SharePoint para saber como usar o tipo de autenticação no farm.</span><span class="sxs-lookup"><span data-stu-id="004dd-145">If you choose SQL Authentication, refer to the SharePoint administrator guide for guidance on how to use the authentication type in your farm.</span></span>

8.  <span data-ttu-id="004dd-146">No Pool de Aplicativos, selecione **Criar novo pool de aplicativos**</span><span class="sxs-lookup"><span data-stu-id="004dd-146">In Application Pool, select **Create new application pool.**</span></span> <span data-ttu-id="004dd-147">. Especifique um nome descritivo que ajudará outros administradores do servidor a identificar como o pool de aplicativos é usado.</span><span class="sxs-lookup"><span data-stu-id="004dd-147">Specify a descriptive name that will help other server administrators identify how the application pool is used.</span></span>

9. <span data-ttu-id="004dd-148">Selecione uma conta de segurança para o pool de aplicativos.</span><span class="sxs-lookup"><span data-stu-id="004dd-148">Select a security account for the application pool.</span></span> <span data-ttu-id="004dd-149">Especifique uma conta gerenciada para usar uma conta de usuário de domínio.</span><span class="sxs-lookup"><span data-stu-id="004dd-149">Specify a managed account to use a domain user account.</span></span>

10. <span data-ttu-id="004dd-150">Aceite os valores padrão restantes e clique em **OK.**</span><span class="sxs-lookup"><span data-stu-id="004dd-150">Accept the remaining default values, and then click **OK.**</span></span> <span data-ttu-id="004dd-151">O aplicativo de serviço aparecerá ao lado de outros serviços gerenciados na lista de aplicativos de serviço do farm.</span><span class="sxs-lookup"><span data-stu-id="004dd-151">The service application will appear alongside other managed services in the farm's service application list.</span></span>

11. <span data-ttu-id="004dd-152">Clique no aplicativo de Serviço de Repositório Seguro na lista.</span><span class="sxs-lookup"><span data-stu-id="004dd-152">Click the Secure Store Service application from the list.</span></span>

12. <span data-ttu-id="004dd-153">Na faixa de opções Aplicativos de Serviço, clique em **Gerenciar**.</span><span class="sxs-lookup"><span data-stu-id="004dd-153">In the Service Applications ribbon, click **Manage**.</span></span>

13. <span data-ttu-id="004dd-154">Em Gerenciamento de Chaves, clique em **Gerar Nova Chave**.</span><span class="sxs-lookup"><span data-stu-id="004dd-154">In Key Management, click **Generate New Key**.</span></span>

14. <span data-ttu-id="004dd-155">Digite e confirme uma frase secreta.</span><span class="sxs-lookup"><span data-stu-id="004dd-155">Enter and then confirm a pass phrase.</span></span> <span data-ttu-id="004dd-156">A frase de senha será usada para adicionar aplicativos de serviço compartilhado do repositório seguro.</span><span class="sxs-lookup"><span data-stu-id="004dd-156">The pass phrase will be used to add additional secure store shared service applications.</span></span>

15. <span data-ttu-id="004dd-157">Clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="004dd-157">Click **OK**.</span></span>

 <span data-ttu-id="004dd-158">O log de auditoria das operações do Serviço de Repositório, que é útil para a solução de problemas, deve ser habilitado antes de estar disponível.</span><span class="sxs-lookup"><span data-stu-id="004dd-158">Audit logging of Store Service operations, which is useful for troubleshooting purposes, must be enabled before it is available.</span></span> <span data-ttu-id="004dd-159">Para obter mais informações sobre como habilitar o log, consulte [Configurar o Serviço de Repositório Seguro (SharePoint 2010)](https://go.microsoft.com/fwlink/p/?LinkID=223294).</span><span class="sxs-lookup"><span data-stu-id="004dd-159">For more information about how to enable logging, see [Configure Secure Store Service (SharePoint 2010)](https://go.microsoft.com/fwlink/p/?LinkID=223294).</span></span>

##  <a name="step-2-turn-off-credential-options-that-you-do-not-want-to-support"></a><a name="bkmk_creds"></a><span data-ttu-id="004dd-160">Etapa 2: desativar as opções de credenciais que você não deseja dar suporte</span><span class="sxs-lookup"><span data-stu-id="004dd-160">Step 2: Turn off credential options that you do not want to support</span></span>
 <span data-ttu-id="004dd-161">A atualização de dados PowerPivot fornece três opções de credenciais em uma agenda de atualização de dados.</span><span class="sxs-lookup"><span data-stu-id="004dd-161">PowerPivot data refresh provides three credential options in a data refresh schedule.</span></span> <span data-ttu-id="004dd-162">Quando o proprietário de uma pasta de trabalho agenda a atualização de dados, ele escolhe uma dessas opções, determinando, assim, a conta em que o trabalho de atualização de dados será executado.</span><span class="sxs-lookup"><span data-stu-id="004dd-162">When a workbook owner schedules data refresh, he or she chooses one of these options, thereby determining the account under which the data refresh job runs.</span></span> <span data-ttu-id="004dd-163">Como administrador, você pode determinar que opções de credenciais estão disponíveis para proprietários de agendas.</span><span class="sxs-lookup"><span data-stu-id="004dd-163">As an administrator, you can determine which credential options are available to schedule owners.</span></span>

 <span data-ttu-id="004dd-164">Você deve ter no mínimo uma opção disponível para que a atualização de dados funcione.</span><span class="sxs-lookup"><span data-stu-id="004dd-164">You must have at least one option that is available in order for data refresh to work.</span></span>

 <span data-ttu-id="004dd-165">![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")</span><span class="sxs-lookup"><span data-stu-id="004dd-165">![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")</span></span>

 <span data-ttu-id="004dd-166">A opção 1, **Usar a conta de atualização de dados configurada pelo administrador**, sempre aparece na página de definição de agenda, mas funciona somente se você configurar a conta de atualização de dados autônoma.</span><span class="sxs-lookup"><span data-stu-id="004dd-166">Option 1, **Use the data refresh account configured by the administrator**, always appears on the schedule definition page, but only works if you configure the unattended data refresh account.</span></span> <span data-ttu-id="004dd-167">Para obter mais informações sobre como criar a conta, consulte [Configurar a conta autônoma de atualização de dados PowerPivot &#40;PowerPivot para SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="004dd-167">For more information on how to create the account, see [Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md).</span></span>

 <span data-ttu-id="004dd-168">A opção 2, **Conectar usando as seguintes credenciais de usuário do Windows**, sempre aparece na página, mas só funciona quando você habilita a opção **Permitir que os usuários insiram credenciais personalizadas do Windows** na página de configuração de aplicativos de serviço.</span><span class="sxs-lookup"><span data-stu-id="004dd-168">Option 2, **Connect using the following windows credentials**, always appears on the page, but only works when you enable the **Allow users to enter custom Windows credentials** option in the service application configuration page.</span></span> <span data-ttu-id="004dd-169">Essa opção é habilitada por padrão, mas você pode desabilitá-la se as desvantagens de usá-la superarem as vantagens (veja abaixo).</span><span class="sxs-lookup"><span data-stu-id="004dd-169">This option is enabled by default, but you can disable it if the disadvantages of using it outweigh the advantages (see below).</span></span>

 <span data-ttu-id="004dd-170">A opção 3, **Conecte-se usando as credenciais salvas no SSS**, sempre aparece na página, mas funciona somente quando o proprietário de uma agenda fornece um aplicativo de destino válido.</span><span class="sxs-lookup"><span data-stu-id="004dd-170">Option 3, **Connect using the credentials saved in Secure Store Service**, always appears on the page, but only works when a schedule owner provides a valid target application.</span></span> <span data-ttu-id="004dd-171">Um administrador deve criar esses aplicativos de destino antecipadamente e fornecer o nome do aplicativo para aqueles que criarem agendas de atualização de dados.</span><span class="sxs-lookup"><span data-stu-id="004dd-171">An administrator must create these target applications in advance and then provide the application name to those who create the data refresh schedules.</span></span> <span data-ttu-id="004dd-172">Para obter mais informações sobre como criar um aplicativo de destino para operações de atualização de dados, consulte [configurar credenciais armazenadas para a atualização de dados PowerPivot &#40;PowerPivot para SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="004dd-172">For more information on how to create a target application for data refresh operations, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span></span>

 <span data-ttu-id="004dd-173">**Configurando a opção de credencial 2, "conectar usando as seguintes credenciais de usuário do Windows"**</span><span class="sxs-lookup"><span data-stu-id="004dd-173">**Configuring credential option 2, "Connect using the following Windows user credentials"**</span></span>

 <span data-ttu-id="004dd-174">Um aplicativo de serviço PowerPivot inclui uma opção de credencial que permite a proprietários de agendas especificar um nome de usuário e senha arbitrários do Windows para executar um trabalho de atualização de dados.</span><span class="sxs-lookup"><span data-stu-id="004dd-174">PowerPivot service application includes a credential option that allows schedule owners to enter an arbitrary Windows user name and password for running a data refresh job.</span></span> <span data-ttu-id="004dd-175">Esta é a segunda opção de credencial na página de definição de agenda:</span><span class="sxs-lookup"><span data-stu-id="004dd-175">This is the second credential option in the schedule definition page:</span></span>

 <span data-ttu-id="004dd-176">![SSAS_PPS_ScheduleDataRefreshCreds](media/ssas-pps-scheduledatarefreshcreds.gif "SSAS_PPS_ScheduleDataRefreshCreds")</span><span class="sxs-lookup"><span data-stu-id="004dd-176">![SSAS_PPS_ScheduleDataRefreshCreds](media/ssas-pps-scheduledatarefreshcreds.gif "SSAS_PPS_ScheduleDataRefreshCreds")</span></span>

 <span data-ttu-id="004dd-177">Esta opção de credencial está habilitada por padrão.</span><span class="sxs-lookup"><span data-stu-id="004dd-177">This credential option is enabled by default.</span></span> <span data-ttu-id="004dd-178">Quando essa opção de credencial está habilitada, o Serviço do Sistema PowerPivot gera um aplicativo de destino no Serviço de Repositório Seguro para armazenar o nome de usuário e a senha especificados pelo proprietário da agenda.</span><span class="sxs-lookup"><span data-stu-id="004dd-178">When this credential option is enabled, PowerPivot System Service will generate a target application in Secure Store Service to store the user name and password entered by the schedule owner.</span></span> <span data-ttu-id="004dd-179">Um aplicativo de destino gerado é criado usando esta Convenção de nomenclatura: PowerPivotDataRefresh_ \<guid> .</span><span class="sxs-lookup"><span data-stu-id="004dd-179">A generated target application is created using this naming convention: PowerPivotDataRefresh_\<guid>.</span></span> <span data-ttu-id="004dd-180">Um aplicativo de destino é criado para cada conjunto de credenciais do Windows.</span><span class="sxs-lookup"><span data-stu-id="004dd-180">One target application is created for each set of Windows credentials.</span></span> <span data-ttu-id="004dd-181">Se já houver um aplicativo de destino pertencente ao Serviço do Sistema PowerPivot e ele armazenar o nome de usuário e a senha especificados pela pessoa que definiu a agenda, o Serviço do Sistema PowerPivot usará o aplicativo de destino em vez de criar um novo.</span><span class="sxs-lookup"><span data-stu-id="004dd-181">If a target application already exists that is owned by the PowerPivot System Service and stores the username and password entered by the person defining the schedule, PowerPivot System Service will use that target application rather than create a new one.</span></span>

 <span data-ttu-id="004dd-182">A principal vantagem de usar essa opção de credencial é a facilidade de uso e simplicidade.</span><span class="sxs-lookup"><span data-stu-id="004dd-182">The primary advantage of using this credential option is ease of use and simplicity.</span></span> <span data-ttu-id="004dd-183">O trabalho antecipado é mínimo porque os aplicativos de destino são criados por você.</span><span class="sxs-lookup"><span data-stu-id="004dd-183">Advance work is minimal because target applications are created for you.</span></span> <span data-ttu-id="004dd-184">Além disso, a execução da atualização de dados com as credenciais do proprietário da agenda (que muito provavelmente é a pessoa que criou a pasta de trabalho) simplifica o downstream dos requisitos de permissão.</span><span class="sxs-lookup"><span data-stu-id="004dd-184">Also, running data refresh under the credentials of the schedule owner (who is most likely the person who created the workbook) simplifies permission requirements downstream.</span></span> <span data-ttu-id="004dd-185">Muito provavelmente, esse usuário já tem permissões no banco de dados de destino.</span><span class="sxs-lookup"><span data-stu-id="004dd-185">Most likely, this user already has permissions on the target database.</span></span> <span data-ttu-id="004dd-186">Quando a atualização de dados é executada sob a identidade de usuário do Windows dessa pessoa, todas as conexões de dados que especificam ' usuário atual ' funcionarão automaticamente.</span><span class="sxs-lookup"><span data-stu-id="004dd-186">When data refresh runs under this person's Windows user identity, any data connections that specify 'current user' will work automatically.</span></span>

 <span data-ttu-id="004dd-187">A desvantagem é a capacidade limitada de gerenciamento.</span><span class="sxs-lookup"><span data-stu-id="004dd-187">The disadvantage is limited management capability.</span></span> <span data-ttu-id="004dd-188">Embora os aplicativos de destino sejam criados automaticamente, eles não são excluídos automaticamente nem atualizados conforme a mudança das informações de conta.</span><span class="sxs-lookup"><span data-stu-id="004dd-188">Although target applications are created automatically, they are not deleted automatically or updated as account information changes.</span></span> <span data-ttu-id="004dd-189">As políticas de expiração de senha podem fazer com que esses aplicativos de destino se tornem desatualizados.</span><span class="sxs-lookup"><span data-stu-id="004dd-189">Password expiration policies might cause these target applications to become out of date.</span></span> <span data-ttu-id="004dd-190">Os trabalhos de atualização de dados que usam credenciais expiradas começarão a falhar.</span><span class="sxs-lookup"><span data-stu-id="004dd-190">Data refresh jobs that use expired credentials will start to fail.</span></span> <span data-ttu-id="004dd-191">Quando isso ocorrer, os proprietários da agenda deverão atualizar suas credenciais fornecendo os valores atuais de nome de usuário e senha em uma agenda de atualização de dados.</span><span class="sxs-lookup"><span data-stu-id="004dd-191">When this occurs, schedule owners will need to update their credentials by providing current user name and password values in a data refresh schedule.</span></span> <span data-ttu-id="004dd-192">Um novo aplicativo de destino será criado nesse momento.</span><span class="sxs-lookup"><span data-stu-id="004dd-192">A new target application will be created at that point.</span></span> <span data-ttu-id="004dd-193">Com o passar do tempo, conforme os usuários adicionarem e revisarem as informações de credenciais em suas agendas de atualização de dados, você poderá achar que tem um grande número de aplicativos de destino gerados automaticamente em seu sistema.</span><span class="sxs-lookup"><span data-stu-id="004dd-193">Over time, as users add and revise credential information in their data refresh schedules, you might find that you have a large number of auto-generated target applications on your system.</span></span>

 <span data-ttu-id="004dd-194">No momento, não há como determinar qual desses aplicativos de destino estão ativos ou inativos, nem há como rastrear um aplicativo de destino específico para as agendas de atualização de dados que o usam.</span><span class="sxs-lookup"><span data-stu-id="004dd-194">Currently, there is no way to determine which of these target applications are active or inactive, nor is there a way to trace a specific target application back to the data refresh schedules that use it.</span></span> <span data-ttu-id="004dd-195">Em geral, você deve deixar os aplicativos de destino de lado, pois excluí-los pode corromper as agendas de atualização de dados existentes.</span><span class="sxs-lookup"><span data-stu-id="004dd-195">In general, you should leave the target applications alone, as deleting them might break existing data refresh schedules.</span></span> <span data-ttu-id="004dd-196">A exclusão de um aplicativo de destino que ainda está em uso fará com que a atualização de dados falhe com a mensagem "o aplicativo de destino não foi encontrado", aparecendo na página Histórico de atualização de dados da pasta de trabalho.</span><span class="sxs-lookup"><span data-stu-id="004dd-196">Deleting a target application that is still in use will cause data refresh to fail with the message, "Target application not found", appearing in the data refresh history page of the workbook.</span></span>

 <span data-ttu-id="004dd-197">Se você optar por desabilitar essa opção de credencial, poderá excluir com segurança todos os aplicativos de destino gerados para a atualização de dados PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="004dd-197">Should you choose to disable this credential option, you can safely delete all of the target applications that were generated for PowerPivot data refresh.</span></span>

 <span data-ttu-id="004dd-198">**Desabilitando o uso de credenciais arbitrárias do Windows em agendas de atualização de dados**</span><span class="sxs-lookup"><span data-stu-id="004dd-198">**Disabling the use of arbitrary Windows credentials in data refresh schedules**</span></span>

1.  <span data-ttu-id="004dd-199">Na administração central, em gerenciamento de aplicativos, clique em **gerenciar aplicativos de serviço**.</span><span class="sxs-lookup"><span data-stu-id="004dd-199">In Central Administration, in Application Management, click **Manage Service Applications**.</span></span>

2.  <span data-ttu-id="004dd-200">Clique no nome do aplicativo de serviço PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="004dd-200">Click the PowerPivot service application name.</span></span> <span data-ttu-id="004dd-201">O Painel de Gerenciamento do PowerPivot é exibido.</span><span class="sxs-lookup"><span data-stu-id="004dd-201">The PowerPivot Management Dashboard appears.</span></span>

3.  <span data-ttu-id="004dd-202">Em Ações, clique em **Configurar parâmetros do aplicativo de serviço** para abrir a página Configurações do Aplicativo de Serviço PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="004dd-202">In Actions, click **Configure service application settings** to open the PowerPivot Service Application Settings page</span></span>

4.  <span data-ttu-id="004dd-203">Na seção Atualização de Dados, desmarque a caixa de seleção **Permitir que os usuários insiram credenciais personalizadas do Windows** .</span><span class="sxs-lookup"><span data-stu-id="004dd-203">In the Data Refresh section, clear the **Allow users to enter custom Windows credentials** checkbox.</span></span>

     <span data-ttu-id="004dd-204">![SSAS_PowerPivotDatarefreshOptions_AllowUser](media/ssas-powerpivotdatarefreshoptions-allowuser.gif "SSAS_PowerPivotDatarefreshOptions_AllowUser")</span><span class="sxs-lookup"><span data-stu-id="004dd-204">![SSAS_PowerPivotDatarefreshOptions_AllowUser](media/ssas-powerpivotdatarefreshoptions-allowuser.gif "SSAS_PowerPivotDatarefreshOptions_AllowUser")</span></span>

##  <a name="step-3-create-target-applications-to-store-credentials-used-in-data-refresh"></a><a name="bkmk_stored"></a><span data-ttu-id="004dd-205">Etapa 3: criar aplicativos de destino para armazenar credenciais usadas na atualização de dados</span><span class="sxs-lookup"><span data-stu-id="004dd-205">Step 3: Create target applications to store credentials used in data refresh</span></span>
 <span data-ttu-id="004dd-206">Depois da configuração do Serviço de Repositório Seguro, os administradores do SharePoint podem criar aplicativos de destino para disponibilizar as credenciais armazenadas para fins de atualização de dados, inclusive a conta de atualização de dados autônoma do PowerPivot ou qualquer outra conta usada para executar o trabalho ou para conectar-se a fontes de dados externas.</span><span class="sxs-lookup"><span data-stu-id="004dd-206">Once Secure Store Service is configured, SharePoint administrators can create target applications to make stored credentials available for data refresh purposes, including the PowerPivot unattended data refresh account or any other account that is used to either run the job or connect to external data sources.</span></span>

 <span data-ttu-id="004dd-207">Conforme dito na seção anterior, é necessário criar aplicativos de destino para poder usar certas opções de credenciais.</span><span class="sxs-lookup"><span data-stu-id="004dd-207">Recall from the previous section that you need to create target applications in order for certain credential options to be usable.</span></span> <span data-ttu-id="004dd-208">Especificamente, é necessário criar aplicativos de destino para a conta de atualização de dados autônoma do PowerPivot, além de credenciais armazenadas adicionais que se espera usar em operações de atualização de dados.</span><span class="sxs-lookup"><span data-stu-id="004dd-208">Specifically, you must create target applications for the PowerPivot unattended data refresh account, plus any additional stored credentials that you expect would be used in data refresh operations.</span></span>

 <span data-ttu-id="004dd-209">Para obter mais informações sobre como criar aplicativos de destino que contêm credenciais armazenadas, consulte [Configurar a conta de atualização de dados autônoma do powerpivot &#40;PowerPivot para SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md) e [configurar credenciais armazenadas para a atualização de dados do PowerPivot &#40;PowerPivot para SharePoint ](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)&#41;.</span><span class="sxs-lookup"><span data-stu-id="004dd-209">For more information about how to create target applications that contain stored credentials, see [Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md) and [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span></span>

##  <a name="step-4-configure-the-server-for-scalable-data-refresh"></a><a name="bkmk_scale"></a><span data-ttu-id="004dd-210">Etapa 4: configurar o servidor para atualização de dados escalonável</span><span class="sxs-lookup"><span data-stu-id="004dd-210">Step 4: Configure the server for scalable data refresh</span></span>
 <span data-ttu-id="004dd-211">Por padrão, cada instalação do PowerPivot para SharePoint oferece suporte a consultas sob demanda e atualizações de dados agendadas.</span><span class="sxs-lookup"><span data-stu-id="004dd-211">By default, each PowerPivot for SharePoint installation supports both on-demand queries and scheduled data refresh.</span></span>

 <span data-ttu-id="004dd-212">Para cada instalação, é possível especificar se a instância de servidor do Analysis Services oferece suporte a consultas e atualizações de dados agendadas, ou se é dedicada a um tipo de operação específico.</span><span class="sxs-lookup"><span data-stu-id="004dd-212">For each installation, you can specify whether the Analysis Services server instance supports both query and scheduled data refresh, or is dedicated to a specific type of operation.</span></span> <span data-ttu-id="004dd-213">Se houver várias instalações do PowerPivot para SharePoint em seu farm, você poderá tornar um servidor dedicado apenas às operações de atualização de dados se achar que os trabalhos estão atrasados ou falhando.</span><span class="sxs-lookup"><span data-stu-id="004dd-213">If you have multiple installations of PowerPivot for SharePoint in your farm, you might consider dedicating a server for just data refresh operations if you find that jobs are delayed or failing.</span></span>

 <span data-ttu-id="004dd-214">Além disso, se o hardware subjacente permitir, é possível aumentar o número de trabalhos de atualização de dados que podem ser executados em paralelo.</span><span class="sxs-lookup"><span data-stu-id="004dd-214">Additionally, if the underlying hardware supports it, you can increase the number of data refresh jobs that run in parallel.</span></span> <span data-ttu-id="004dd-215">Por padrão, o número de trabalhos que podem ser executados em paralelo é calculado com base na memória do sistema, mas você pode aumentar esse número se tiver capacidade de CPU adicional para suportar a carga de trabalho.</span><span class="sxs-lookup"><span data-stu-id="004dd-215">By default, the number of jobs that can run in parallel is calculated based on system memory, but you can increase that number if you have additional CPU capacity to support the workload.</span></span>

 <span data-ttu-id="004dd-216">Para obter mais informações, consulte [Configurar a atualização de dados dedicada ou processamento somente de consulta &#40;PowerPivot para SharePoint&#41;](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="004dd-216">For more information, see [Configure Dedicated Data Refresh or Query-Only Processing &#40;PowerPivot for SharePoint&#41;](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md).</span></span>

##  <a name="step-5-install-data-providers-used-to-import-powerpivot-data"></a><a name="bkmk_installdp"></a><span data-ttu-id="004dd-217">Etapa 5: instalar provedores de dados usados para importar dados PowerPivot</span><span class="sxs-lookup"><span data-stu-id="004dd-217">Step 5: Install Data Providers Used to Import PowerPivot Data</span></span>
 <span data-ttu-id="004dd-218">Uma operação de atualização de dados é essencialmente uma repetição de uma operação de importação que recuperou os dados originais.</span><span class="sxs-lookup"><span data-stu-id="004dd-218">A data refresh operation is essentially a repeat of an import operation that retrieved the original data.</span></span> <span data-ttu-id="004dd-219">Isso significa que os mesmos provedores de dados usados para importar os dados no aplicativo cliente PowerPivot também devem ser instalados no servidor PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="004dd-219">This means that the same data providers used to import the data in the PowerPivot client application must also be installed on the PowerPivot server.</span></span>

 <span data-ttu-id="004dd-220">Você deve ser um administrador local para instalar provedores de dados em um servidor do Windows.</span><span class="sxs-lookup"><span data-stu-id="004dd-220">You must be a local administrator to install data providers on a Windows server.</span></span> <span data-ttu-id="004dd-221">Se você for instalar drivers adicionais, instale-os em cada computador do farm do SharePoint que tem uma instalação do PowerPivot para SharePoint.</span><span class="sxs-lookup"><span data-stu-id="004dd-221">If you install additional drivers, be sure to install them on each computer in the SharePoint farm that has an installation of PowerPivot for SharePoint.</span></span> <span data-ttu-id="004dd-222">Se você tiver vários servidores PowerPivot no farm, deverá instalar os provedores em cada um deles.</span><span class="sxs-lookup"><span data-stu-id="004dd-222">If you have multiple PowerPivot servers in the farm, you must install the providers on each one.</span></span>

 <span data-ttu-id="004dd-223">Lembre-se de que os servidores SharePoint são aplicativos de 64 bits.</span><span class="sxs-lookup"><span data-stu-id="004dd-223">Remember that SharePoint servers are 64-bit applications.</span></span> <span data-ttu-id="004dd-224">Verifique se instalou a versão de 64 bits dos provedores de dados que você está usando para dar suporte a operações de atualização de dados.</span><span class="sxs-lookup"><span data-stu-id="004dd-224">Be sure to install the 64-bit version of the data providers you are using to support data refresh operations.</span></span>

##  <a name="step-6-grant-permissions-to-create-schedules-and-access-external-data-sources"></a><a name="bkmk_accounts"></a><span data-ttu-id="004dd-225">Etapa 6: conceder permissões para criar agendas e acessar fontes de dados externas</span><span class="sxs-lookup"><span data-stu-id="004dd-225">Step 6: Grant permissions to create schedules and access external data sources</span></span>
 <span data-ttu-id="004dd-226">Os proprietários ou autores de pastas de trabalho precisam ter permissão **Colaborar** para agendar a atualização de dados em uma pasta de trabalho.</span><span class="sxs-lookup"><span data-stu-id="004dd-226">Workbook owners or authors must have **Contribute** permission to schedule data refresh on a workbook.</span></span> <span data-ttu-id="004dd-227">Considerando esse nível de permissão, ele pode abrir e editar a página de configuração de atualização de dados da pasta de trabalho para especificar as credenciais e as informações de agendamento usadas para atualizar os dados.</span><span class="sxs-lookup"><span data-stu-id="004dd-227">Given this permission level, he or she can open and edit the workbook's data refresh configuration page to specify the credentials and schedule information used to refresh the data.</span></span>

 <span data-ttu-id="004dd-228">Além das permissões do SharePoint, as permissões de banco de dados em fontes de dados externas também devem ser revisadas para verificar se as contas usadas durante a atualização de dados têm direitos de acesso suficientes aos dados.</span><span class="sxs-lookup"><span data-stu-id="004dd-228">In addition to SharePoint permissions, database permissions on external data sources must also be reviewed to ensure that accounts used during data refresh have sufficient access rights to the data.</span></span> <span data-ttu-id="004dd-229">Determinar os requisitos de permissão exige uma avaliação cautelosa de sua parte, pois as permissões que você precisa conceder variam de acordo com a cadeia de conexão da pasta de trabalho e a identidade de usuário sob a qual o trabalho de atualização de dados está em execução.</span><span class="sxs-lookup"><span data-stu-id="004dd-229">Determining permission requirements will require careful evaluation on your part because the permissions that you need to grant will vary depending on the connection string in the workbook and the user identity under which the data refresh job is running.</span></span>

 <span data-ttu-id="004dd-230">**Por que as cadeias de conexão existentes em uma pasta de trabalho PowerPivot são importantes para operações de atualização de dados PowerPivot?**</span><span class="sxs-lookup"><span data-stu-id="004dd-230">**Why existing connection strings in a PowerPivot workbook matter to PowerPivot data refresh operations**</span></span>

 <span data-ttu-id="004dd-231">Quando a atualização de dados é executada, o servidor envia uma solicitação de conexão para a fonte de dados externa usando a cadeia de conexão que foi criada quando os dados foram importados inicialmente.</span><span class="sxs-lookup"><span data-stu-id="004dd-231">When data refresh runs, the server sends a connection request to the external data source using the connection string that was created when the data was originally imported.</span></span> <span data-ttu-id="004dd-232">O local do servidor, o nome do banco de dados e os parâmetros de autenticação especificados na cadeia de conexão serão reutilizados durante a atualização de dados para acessar as mesmas fontes de dados.</span><span class="sxs-lookup"><span data-stu-id="004dd-232">The server location, database name, and authentication parameters specified in that connection string are now reused during data refresh to access the same data sources.</span></span> <span data-ttu-id="004dd-233">A cadeia de conexão e sua construção geral não podem ser modificadas para a atualização de dados.</span><span class="sxs-lookup"><span data-stu-id="004dd-233">The connection string and its overall construction cannot be modified for data refresh purposes.</span></span> <span data-ttu-id="004dd-234">Elas são reutilizadas simplesmente como estão durante a atualização de dados.</span><span class="sxs-lookup"><span data-stu-id="004dd-234">It is simply reused as-is during data refresh.</span></span> <span data-ttu-id="004dd-235">Em alguns casos, se você usar uma autenticação que não seja do Windows para conectar-se a uma fonte de dados, poderá substituir o nome de usuário e a senha na cadeia de conexão.</span><span class="sxs-lookup"><span data-stu-id="004dd-235">In some cases, if you are using non-Windows authentication to connect to a data source, you can override the user name and password in the connection string.</span></span> <span data-ttu-id="004dd-236">Mais detalhes sobre isso são fornecidos neste tópico.</span><span class="sxs-lookup"><span data-stu-id="004dd-236">More detail about this is provided further on in this topic.</span></span>

 <span data-ttu-id="004dd-237">Para a maioria das pastas de trabalho, a opção de autenticação padrão na conexão é usar conexões confiáveis ou a segurança integrada do Windows, resultando em cadeias de conexão que incluem `SSPI=IntegratedSecurity` ou `SSPI=TrustedConnection`.</span><span class="sxs-lookup"><span data-stu-id="004dd-237">For most workbooks, the default authentication option on the connection is to use trusted connections or Windows integrated security, resulting in connection strings that include `SSPI=IntegratedSecurity` or `SSPI=TrustedConnection`.</span></span> <span data-ttu-id="004dd-238">Quando essa cadeia de conexão é usada durante a atualização de dados, a conta usada para executar o trabalho de atualização de dados torna-se o ' usuário atual '.</span><span class="sxs-lookup"><span data-stu-id="004dd-238">When this connection string is used during data refresh, the account used to run the data refresh job becomes the 'current user'.</span></span> <span data-ttu-id="004dd-239">Como tal, essa conta precisa de permissões de leitura em qualquer fonte de dados externa que seja acessada por uma conexão confiável.</span><span class="sxs-lookup"><span data-stu-id="004dd-239">As such, this account needs read permissions on any external data source that is accessed via a trusted connection.</span></span>

 <span data-ttu-id="004dd-240">**Você habilitou a conta de atualização de dados autônoma do PowerPivot?**</span><span class="sxs-lookup"><span data-stu-id="004dd-240">**Did you enable the PowerPivot unattended data refresh account?**</span></span>

 <span data-ttu-id="004dd-241">Em caso positivo, você deve conceder permissões de leitura a essa conta nas fontes de dados que são acessadas durante a atualização de dados.</span><span class="sxs-lookup"><span data-stu-id="004dd-241">If yes, then you should grant that account read permissions on data sources that are accessed during data refresh.</span></span> <span data-ttu-id="004dd-242">O motivo pelo qual essa conta precisa de permissões de leitura é porque, em uma pasta de trabalho que usa as opções de autenticação padrão, a conta autônoma será o ' usuário atual ' durante a atualização de dados.</span><span class="sxs-lookup"><span data-stu-id="004dd-242">The reason why this account needs read permissions is because in a workbook that uses the default authentication options, the unattended account will be the 'current user' during data refresh.</span></span> <span data-ttu-id="004dd-243">A menos que o proprietário da agenda substitua as credenciais na cadeia de conexão, essa conta precisará de permissões de leitura em qualquer quantidade de fontes de dados que forem ativamente usadas em sua organização.</span><span class="sxs-lookup"><span data-stu-id="004dd-243">Unless the schedule owner overrides the credentials in the connection string, this account will need read permissions on any number of data sources that are actively used in your organization.</span></span>

 <span data-ttu-id="004dd-244">**Você está usando a opção de credencial 2: permitir que o proprietário da agenda insira nome de usuário e senha do Windows?**</span><span class="sxs-lookup"><span data-stu-id="004dd-244">**Are you using credential option 2: allowing the schedule owner to enter a Windows user name and password?**</span></span>

 <span data-ttu-id="004dd-245">Normalmente, os usuários que criam pastas de trabalho PowerPivot já possuem permissões suficientes porque eles já importaram os dados inicialmente.</span><span class="sxs-lookup"><span data-stu-id="004dd-245">Typically, users who create PowerPivot workbooks already have sufficient permissions because he or she already imported the data in the first place.</span></span> <span data-ttu-id="004dd-246">Se esses usuários configurarem a atualização de dados subsequentemente para ser executada sob sua própria identidade de usuário do Windows, sua conta de usuário do Windows, que já tem direitos no banco de dados, será usada para recuperar dados durante a atualização de dados.</span><span class="sxs-lookup"><span data-stu-id="004dd-246">If these users subsequently configure data refresh to run under their own Windows user identity, their Windows user account, which already has rights on the database, will be used to retrieve data during data refresh.</span></span> <span data-ttu-id="004dd-247">As permissões existentes devem ser suficientes.</span><span class="sxs-lookup"><span data-stu-id="004dd-247">Existing permissions should be sufficient.</span></span>

 <span data-ttu-id="004dd-248">**Você está usando a opção de credencial 3: usar um aplicativo de destino do Serviço de Repositório Seguro para fornecer uma identidade de usuário para executar trabalhos de atualização de dados?**</span><span class="sxs-lookup"><span data-stu-id="004dd-248">**Are you using credential option 3: using a Secure Store Service target application to provide a user identity for running data refresh jobs?**</span></span>

 <span data-ttu-id="004dd-249">Qualquer conta usada para executar um trabalho de atualização de dados precisa de permissões de leitura, pelos mesmos motivos descritos para a conta de atualização de dados autônoma do PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="004dd-249">Any account used to run a data refresh job needs read permissions, for the same reasons as those described for the PowerPivot unattended data refresh account.</span></span>

 <span data-ttu-id="004dd-250">**Como verificar as cadeias de conexão para determinar se é possível substituir as credenciais usadas durante a atualização de dados**</span><span class="sxs-lookup"><span data-stu-id="004dd-250">**How to check connection strings to determine whether you can override credentials used during data refresh**</span></span>

 <span data-ttu-id="004dd-251">Conforme dito anteriormente, você pode substituir um nome de usuário e uma senha diferentes no nível do trabalho de atualização de dados se a conexão estiver usando uma autenticação que não seja do Windows (por exemplo, autenticação do SQL Server).</span><span class="sxs-lookup"><span data-stu-id="004dd-251">As previously noted, you can substitute a different user name and password at the data refresh job level if the connection is using non-Windows authentication (for example, SQL Server authentication).</span></span> <span data-ttu-id="004dd-252">As credenciais que não são do Windows são transmitidas na cadeia de conexão por meio dos parâmetros de ID de usuário e senha.</span><span class="sxs-lookup"><span data-stu-id="004dd-252">Non-Windows credentials are passed on the connection string using the User ID and Password parameters.</span></span> <span data-ttu-id="004dd-253">Se sua pasta de trabalho contiver uma cadeia de conexão com esses parâmetros, você poderá especificar opcionalmente um nome de usuário e uma senha diferentes para atualizar os dados dessa fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="004dd-253">If your workbook contains a connection string with these parameters, you can optionally specify a different user name and password for refreshing data from that data source.</span></span>

 <span data-ttu-id="004dd-254">As etapas a seguir explicam como determinar se você tem uma cadeia de conexão que aceita substituições de nomes de usuário e senhas.</span><span class="sxs-lookup"><span data-stu-id="004dd-254">The following steps explain how to determine whether you have a connection string that accepts user name and password overrides.</span></span>

1.  <span data-ttu-id="004dd-255">Abra a pasta de trabalho no Excel.</span><span class="sxs-lookup"><span data-stu-id="004dd-255">Open the workbook in Excel.</span></span>

2.  <span data-ttu-id="004dd-256">Abra a janela do PowerPivot (no Excel, na faixa PowerPivot, clique em Janela do PowerPivot).</span><span class="sxs-lookup"><span data-stu-id="004dd-256">Open the PowerPivot window (in Excel, on the PowerPivot ribbon, click PowerPivot Window).</span></span>

3.  <span data-ttu-id="004dd-257">Clique em **Design**.</span><span class="sxs-lookup"><span data-stu-id="004dd-257">Click **Design**.</span></span>

4.  <span data-ttu-id="004dd-258">Clique em **Conexões Existentes**.</span><span class="sxs-lookup"><span data-stu-id="004dd-258">Click **Existing Connections**.</span></span>

     <span data-ttu-id="004dd-259">Todas as conexões usadas na pasta de trabalho são listadas em **Conexões de Dados PowerPivot**.</span><span class="sxs-lookup"><span data-stu-id="004dd-259">All of the connections used in the workbook are listed under **PowerPivot Data Connections**.</span></span>

5.  <span data-ttu-id="004dd-260">Selecione a conexão e clique em **Editar**e em **Avançado**.</span><span class="sxs-lookup"><span data-stu-id="004dd-260">Select the connection and click **Edit**, and then click **Advanced**.</span></span> <span data-ttu-id="004dd-261">A cadeia de conexão estará no final da página.</span><span class="sxs-lookup"><span data-stu-id="004dd-261">The connection string is at the bottom of the page.</span></span>

 <span data-ttu-id="004dd-262">Se você vir **Integrated Security=SSPI** na cadeia de conexão, não poderá substituir as credenciais nessa cadeia de conexão.</span><span class="sxs-lookup"><span data-stu-id="004dd-262">If you see **Integrated Security=SSPI** in the connection string, you cannot override the credentials in the connection string.</span></span> <span data-ttu-id="004dd-263">A conexão sempre usará o usuário atual.</span><span class="sxs-lookup"><span data-stu-id="004dd-263">The connection will always use the current user.</span></span> <span data-ttu-id="004dd-264">Qualquer credencial fornecida será ignorada.</span><span class="sxs-lookup"><span data-stu-id="004dd-264">Any credentials that you provide are ignored.</span></span>

 <span data-ttu-id="004dd-265">Se você vir **informações de persistência de segurança = falso, senha = \* \* \* \* \* \* \* \* \* \* \* , \<userlogin> userid =**, você terá uma cadeia de conexão que aceitará substituições de credencial.</span><span class="sxs-lookup"><span data-stu-id="004dd-265">If you see **Persist Security Info=False, Password=\*\*\*\*\*\*\*\*\*\*\*, UserID=\<userlogin>**,then you have a connection string that will accept credential overrides.</span></span> <span data-ttu-id="004dd-266">As credenciais que aparecem na cadeia de conexão (como UserID e Password) não são credenciais do Windows, e sim logons de bancos de dados ou outras contas de acesso válidas para a fonte de dados de destino.</span><span class="sxs-lookup"><span data-stu-id="004dd-266">Credentials that appear in a connection string (such as UserID and Password) are not Windows credentials, but rather database logins or other sign-in accounts that are valid for the target data source.</span></span>

 <span data-ttu-id="004dd-267">**Como substituir credenciais na cadeia de conexão**</span><span class="sxs-lookup"><span data-stu-id="004dd-267">**How to override credentials in the connection string**</span></span>

 <span data-ttu-id="004dd-268">A substituição de credenciais é feita por meio da especificação das credenciais da fonte de dados na agenda de atualização de dados.</span><span class="sxs-lookup"><span data-stu-id="004dd-268">Overriding credentials is done by specifying data source credentials in the data refresh schedule.</span></span> <span data-ttu-id="004dd-269">Como administrador, você pode fornecer um aplicativo de destino no Serviço de Repositório Seguro que mapeia as credenciais usadas para acessar dados externos.</span><span class="sxs-lookup"><span data-stu-id="004dd-269">As an administrator, you can provide a target application in Secure Store Service that maps the credentials used to access external data.</span></span> <span data-ttu-id="004dd-270">O proprietário da agenda pode inserir a ID do aplicativo de destino na agenda de atualização de dados definida por ele.</span><span class="sxs-lookup"><span data-stu-id="004dd-270">The schedule owner can then enter the target application ID in the data refresh schedule that he or she defines.</span></span> <span data-ttu-id="004dd-271">Para obter mais informações sobre como criar esse aplicativo de destino, consulte [configurar credenciais armazenadas para a atualização de dados PowerPivot &#40;PowerPivot para SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="004dd-271">For more information about creating this target application, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span></span>

 <span data-ttu-id="004dd-272">Opcionalmente, o proprietário da agenda pode digitar um conjunto de credenciais que são usadas para conectar-se a fontes de dados durante a atualização de dados.</span><span class="sxs-lookup"><span data-stu-id="004dd-272">Alternatively, the schedule owner can type in the set of credentials that are used to connect to data sources during data refresh.</span></span> <span data-ttu-id="004dd-273">A ilustração a seguir mostra essa opção de fonte de dados na página de definição da agenda.</span><span class="sxs-lookup"><span data-stu-id="004dd-273">The following illustration shows this data source option in the schedule definition page.</span></span>

 <span data-ttu-id="004dd-274">![SSAS_PowerPivotKJ_DataRefreshDSOptions](media/ssas-powerpivotkj-datarefreshdsoptions.gif "SSAS_PowerPivotKJ_DataRefreshDSOptions")</span><span class="sxs-lookup"><span data-stu-id="004dd-274">![SSAS_PowerPivotKJ_DataRefreshDSOptions](media/ssas-powerpivotkj-datarefreshdsoptions.gif "SSAS_PowerPivotKJ_DataRefreshDSOptions")</span></span>

 <span data-ttu-id="004dd-275">**Identificando os requisitos de acesso aos dados**</span><span class="sxs-lookup"><span data-stu-id="004dd-275">**Identifying data access requirements**</span></span>

 <span data-ttu-id="004dd-276">Conforme dito nas seções anteriores, a conta usada para executar a atualização de dados e conectar-se a fontes de dados externas é geralmente a mesma.</span><span class="sxs-lookup"><span data-stu-id="004dd-276">As noted in previous sections, the account used to run data refresh and connect to external data sources is often one and the same.</span></span> <span data-ttu-id="004dd-277">Sendo assim, a conta usada para acessar fontes de dados externas é determinada pelo conjunto de opções nessa parte da página da agenda de atualização de dados.</span><span class="sxs-lookup"><span data-stu-id="004dd-277">As such, the account used to access external data sources is determined by the options set in this part of the data refresh schedule page.</span></span> <span data-ttu-id="004dd-278">Ela pode ser a conta de atualização de dados autônoma do PowerPivot, a conta de um usuário individual do Windows ou a conta armazenada em um aplicativo de destino predefinido.</span><span class="sxs-lookup"><span data-stu-id="004dd-278">This might be the PowerPivot unattended data refresh account, the Windows account of an individual user, or the account that is stored in a predefined target application.</span></span>

 <span data-ttu-id="004dd-279">![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")</span><span class="sxs-lookup"><span data-stu-id="004dd-279">![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")</span></span>

 <span data-ttu-id="004dd-280">Em casos em que a conta usada para executar a atualização de dados é diferente da conta usada para importar dados (por exemplo, a conta de atualização de dados autônoma do PowerPivot por meio da opção 1, ou outro conjunto de credenciais armazenadas por meio da opção de credencial 3), você precisará criar um novo logon de banco de dados para essa conta e conceder a ela permissões de leitura nas fontes de dados externas.</span><span class="sxs-lookup"><span data-stu-id="004dd-280">In cases where the account used to run data refresh is different from the account used to import data (for example, the PowerPivot unattended data refresh account via credential option one, or some other set of stored credentials via credential option three), you will need to create a new database login for that account and grant it read permissions on the external data sources.</span></span>

 <span data-ttu-id="004dd-281">Depois de saber quais contas exigem acesso aos dados, você pode começar a verificar as permissões nas fontes de dados que são mais comumente usadas nas pastas de trabalho PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="004dd-281">Once you understand which accounts require data access, you can begin to check permissions on the data sources that are most often used in PowerPivot workbooks.</span></span> <span data-ttu-id="004dd-282">Comece com os data warehouses ou bancos de dados de relatórios que são ativamente usados, mas também peça a opinião dos seus usuários mais ativos do PowerPivot para descobrir que fontes de dados eles estão usando.</span><span class="sxs-lookup"><span data-stu-id="004dd-282">Start with any data warehouses or reporting databases that are actively used, but also solicit input from your most active PowerPivot users to find out which data sources they are using.</span></span> <span data-ttu-id="004dd-283">Se você tiver uma lista de fontes de dados, poderá começar a verificar cada uma delas para confirmar se as permissões estão definidas corretamente.</span><span class="sxs-lookup"><span data-stu-id="004dd-283">Once you have a list of data sources, you can begin checking each one to ensure that permissions are set correctly.</span></span>

##  <a name="step-7-enable-workbook-upgrade-for-data-refresh"></a><a name="bkmk_upgradewrkbk"></a><span data-ttu-id="004dd-284">Etapa 7: habilitar a atualização da pasta de trabalho para atualização de dados</span><span class="sxs-lookup"><span data-stu-id="004dd-284">Step 7: Enable workbook upgrade for data refresh</span></span>
 <span data-ttu-id="004dd-285">Por padrão, pastas de trabalho criadas usando a versão [!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)] do PowerPivot para Excel não podem ser configuradas para a atualização de dados agendada em uma versão [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] do PowerPivot para SharePoint.</span><span class="sxs-lookup"><span data-stu-id="004dd-285">By default, workbooks that were created using the [!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)] version of PowerPivot for Excel cannot be configured for scheduled data refresh on a [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] version of PowerPivot for SharePoint.</span></span> <span data-ttu-id="004dd-286">Se você hospedar versões mais recentes e anteriores de pastas de trabalho PowerPivot em seu ambiente do SharePoint, deverá primeiro atualizar quaisquer pastas de trabalho [!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)] antes de agendá-las para atualização de dados automática no servidor.</span><span class="sxs-lookup"><span data-stu-id="004dd-286">If you host newer and older versions of PowerPivot workbooks in your SharePoint environment, you must upgrade any [!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)] workbooks first before they can be scheduled for automatic data refresh on the server.</span></span>

##  <a name="step-8-verify-data-refresh-configuration"></a><a name="bkmk_verify"></a><span data-ttu-id="004dd-287">Etapa 8: verificar a configuração de atualização de dados</span><span class="sxs-lookup"><span data-stu-id="004dd-287">Step 8: Verify data refresh configuration</span></span>
 <span data-ttu-id="004dd-288">Para verificar a atualização de dados, você deve ter uma pasta de trabalho PowerPivot publicada em um site do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="004dd-288">To verify data refresh, you must have a PowerPivot workbook that is published to a SharePoint site.</span></span> <span data-ttu-id="004dd-289">Você deve ter permissões de colaboração na pasta de trabalho e permissões para acessar qualquer fonte de dados incluída na agenda de atualização de dados.</span><span class="sxs-lookup"><span data-stu-id="004dd-289">You must have Contribute permissions on the workbook and permissions to access any data sources that are included in the data refresh schedule.</span></span>

 <span data-ttu-id="004dd-290">Quando você criar a agenda, marque a caixa de seleção **Também atualizar o mais rápido possível** para executar a atualização de dados imediatamente.</span><span class="sxs-lookup"><span data-stu-id="004dd-290">When you create the schedule, select the **Also refresh as soon as possible** checkbox to run data refresh immediately.</span></span> <span data-ttu-id="004dd-291">Em seguida, você pode verificar a página do histórico de atualização de dados dessa pasta de trabalho para confirmar se foi executada com êxito.</span><span class="sxs-lookup"><span data-stu-id="004dd-291">You can then check the data refresh history page of that workbook to verify that it ran successfully.</span></span> <span data-ttu-id="004dd-292">Lembre-se de que o trabalho de timer da Atualização de Dados PowerPivot é executado a cada minuto.</span><span class="sxs-lookup"><span data-stu-id="004dd-292">Recall that the PowerPivot Data Refresh timer job runs every minute.</span></span> <span data-ttu-id="004dd-293">Levará no mínimo esse tempo para obter a confirmação de que a atualização de dados foi bem-sucedida.</span><span class="sxs-lookup"><span data-stu-id="004dd-293">It will take at least that long to get confirmation that data refresh succeeded.</span></span>

 <span data-ttu-id="004dd-294">Tente todas as opções de credenciais para as quais planeja oferecer suporte.</span><span class="sxs-lookup"><span data-stu-id="004dd-294">Be sure to try all of the credential options you plan to support.</span></span> <span data-ttu-id="004dd-295">Por exemplo, se você tiver configurado a conta de atualização de dados autônoma do PowerPivot, verifique se a atualização de dados ocorre usando essa opção.</span><span class="sxs-lookup"><span data-stu-id="004dd-295">For example, if you configured the PowerPivot unattended data refresh account, verify that data refresh succeeds using that option.</span></span> <span data-ttu-id="004dd-296">Para obter mais informações sobre agendamento e exibição de informações de status, consulte [agendar uma atualização de dados &#40;PowerPivot para SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md) e [Exibir o histórico de atualização de dados &#40;PowerPivot para SharePoint ](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md)&#41;.</span><span class="sxs-lookup"><span data-stu-id="004dd-296">For more information about scheduling and viewing status information, see [Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md) and [View Data Refresh History &#40;PowerPivot for SharePoint&#41;](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md).</span></span>

 <span data-ttu-id="004dd-297">Se a atualização de dados falhar, consulte a página [Troubleshooting PowerPivot Data Refresh](https://go.microsoft.com/fwlink/?LinkID=223279) no wiki do TechNet para saber quais são as soluções possíveis.</span><span class="sxs-lookup"><span data-stu-id="004dd-297">If data refresh fails, refer to the [Troubleshooting PowerPivot Data Refresh](https://go.microsoft.com/fwlink/?LinkID=223279) page on the TechNet wiki for possible solutions.</span></span>

##  <a name="modify-configuration-settings-for-data-refresh"></a><a name="bkmk_config"></a><span data-ttu-id="004dd-298">Modificar definições de configuração para atualização de dados</span><span class="sxs-lookup"><span data-stu-id="004dd-298">Modify Configuration Settings for Data Refresh</span></span>
 <span data-ttu-id="004dd-299">Cada aplicativo de serviço PowerPivot tem parâmetros de configuração que afetam as operações de atualização de dados.</span><span class="sxs-lookup"><span data-stu-id="004dd-299">Each PowerPivot service application has configuration settings that affect data refresh operations.</span></span> <span data-ttu-id="004dd-300">Esta seção explica como modificar essas definições.</span><span class="sxs-lookup"><span data-stu-id="004dd-300">This section explains how to modify those settings.</span></span>

###  <a name="set-business-hours-to-determine-off-hours-processing"></a><a name="procIntervals"></a><span data-ttu-id="004dd-301">Definir ' horário comercial ' para determinar o processamento fora do horário de expediente</span><span class="sxs-lookup"><span data-stu-id="004dd-301">Set 'Business Hours' to determine off-hours processing</span></span>
 <span data-ttu-id="004dd-302">Os usuários do SharePoint que agendam operações de atualização de dados podem especificar uma hora de início antes de "Depois do horário comercial".</span><span class="sxs-lookup"><span data-stu-id="004dd-302">SharePoint users who schedule data refresh operations can specify an earliest start time of "After business hours".</span></span> <span data-ttu-id="004dd-303">Isso poderá ser útil se eles desejarem recuperar dados de transações comerciais que foram acumulados durante o dia comercial.</span><span class="sxs-lookup"><span data-stu-id="004dd-303">This may be useful if they want to retrieve business transaction data that accumulated during the business day.</span></span> <span data-ttu-id="004dd-304">Como administrador de farm, você pode especificar o intervalo de horas que melhor defina um dia comercial para sua organização.</span><span class="sxs-lookup"><span data-stu-id="004dd-304">As a farm administrator, you can specify the range of hours that best defines a business day for your organization.</span></span> <span data-ttu-id="004dd-305">Se você definir o dia comercial como de 4h às 20h, o processamento da atualização de dados baseada em uma hora de início "Depois do horário comercial" iniciará às 20h01.</span><span class="sxs-lookup"><span data-stu-id="004dd-305">If you define the business day to be from 04:00 to 20:00, then data refresh processing that is based on an "After business hours" start time will begin at 20:01.</span></span>

 <span data-ttu-id="004dd-306">Solicitações de atualização de dados executadas fora do horário comercial são adicionadas à fila na ordem de recebimento.</span><span class="sxs-lookup"><span data-stu-id="004dd-306">Data refresh requests that run during off-hours are added to the queue in the order in which the request is received.</span></span> <span data-ttu-id="004dd-307">Solicitações individuais são processadas conforme os recursos do servidor se tornam disponíveis.</span><span class="sxs-lookup"><span data-stu-id="004dd-307">Individual requests will be processed as server resources become available.</span></span>

1.  <span data-ttu-id="004dd-308">Na administração central, em gerenciamento de aplicativos, clique em **gerenciar aplicativos de serviço**.</span><span class="sxs-lookup"><span data-stu-id="004dd-308">In Central Administration, in Application Management, click **Manage Service Applications**.</span></span>

2.  <span data-ttu-id="004dd-309">Clique no nome do aplicativo de serviço PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="004dd-309">Click the PowerPivot service application name.</span></span> <span data-ttu-id="004dd-310">O Painel de Gerenciamento do PowerPivot é exibido.</span><span class="sxs-lookup"><span data-stu-id="004dd-310">The PowerPivot Management Dashboard appears.</span></span>

3.  <span data-ttu-id="004dd-311">Em Ações, clique em **Configurar parâmetros do aplicativo de serviço** para abrir a página Configurações do Aplicativo de Serviço PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="004dd-311">In Actions, click **Configure service application settings** to open the PowerPivot Service Application Settings page</span></span>

4.  <span data-ttu-id="004dd-312">Na seção Atualização de Dados, em Horário comercial, digite uma hora de início e uma hora de término que definam o período de processamento depois do horário comercial.</span><span class="sxs-lookup"><span data-stu-id="004dd-312">In the Data Refresh section, in Business Hours, enter a start time and end time that defines the after business hours processing period.</span></span>

     <span data-ttu-id="004dd-313">Se não desejar definir um período de processamento fora do horário comercial, você poderá digitar o mesmo valor para Hora de Início e Hora de Término (por exemplo, 12h para os dois horários).</span><span class="sxs-lookup"><span data-stu-id="004dd-313">If you do not want an off-hours processing period defined, you can enter the same value for both Start Time and End Time (for example, 12:00 for both times).</span></span> <span data-ttu-id="004dd-314">No entanto, lembre-se de que as páginas de definição da agenda dos sites do SharePoint ainda terão "Depois do horário comercial" como uma opção.</span><span class="sxs-lookup"><span data-stu-id="004dd-314">However, be aware that the schedule definition pages on the SharePoint sites will still have "After business hours" as an option.</span></span> <span data-ttu-id="004dd-315">Os usuários que selecionarem essa opção em um farm que não tem nenhum intervalo de processamento fora do horário comercial definido, eventualmente, obterão erros de atualização de dados pois os trabalhos de processamento não serão iniciados.</span><span class="sxs-lookup"><span data-stu-id="004dd-315">Users who select that option on a farm that has no off-hour processing range defined for it will eventually get data refresh errors as processing jobs fail to start.</span></span>

5.  <span data-ttu-id="004dd-316">Clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="004dd-316">Click **OK**.</span></span>

###  <a name="limit-how-long-data-refresh-history-is-retained"></a><a name="usagehist"></a><span data-ttu-id="004dd-317">Limitar por quanto tempo o histórico de atualização de dados é retido</span><span class="sxs-lookup"><span data-stu-id="004dd-317">Limit how long data refresh history is retained</span></span>
 <span data-ttu-id="004dd-318">O histórico de atualização de dados é um registro detalhado das mensagens de êxito e de falha geradas por operações de atualização de dados ao longo do tempo.</span><span class="sxs-lookup"><span data-stu-id="004dd-318">Data refresh history is a detailed record of the success and failure messages that are generated for data refresh operations over time.</span></span> <span data-ttu-id="004dd-319">As informações do histórico são coletadas e gerenciadas por meio do sistema de coleta de dados de uso no farm.</span><span class="sxs-lookup"><span data-stu-id="004dd-319">History information is gathered and managed through the usage data collection system in the farm.</span></span> <span data-ttu-id="004dd-320">Dessa forma, limites que você define para o histórico de dados de uso também se aplicam ao histórico de atualização de dados.</span><span class="sxs-lookup"><span data-stu-id="004dd-320">As such, limits that you set on usage data history also apply to data refresh history.</span></span> <span data-ttu-id="004dd-321">Como os relatórios de atividade de uso reúnem dados de todo o sistema PowerPivot, uma única configuração de histórico é usada para controlar a retenção de dados de controle para o histórico de atualização de dados e todos os outros dados de uso que são coletados e armazenados.</span><span class="sxs-lookup"><span data-stu-id="004dd-321">Because the usage activity reports pull together data from across the PowerPivot system, a single history setting is used to control data retention for both data refresh history and all other usage data that is collected and stored.</span></span>

1.  <span data-ttu-id="004dd-322">Na administração central, em gerenciamento de aplicativos, clique em **gerenciar aplicativos de serviço**.</span><span class="sxs-lookup"><span data-stu-id="004dd-322">In Central Administration, in Application Management, click **Manage Service Applications**.</span></span>

2.  <span data-ttu-id="004dd-323">Clique no nome do aplicativo de serviço PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="004dd-323">Click the PowerPivot service application name.</span></span> <span data-ttu-id="004dd-324">O Painel de Gerenciamento do PowerPivot é exibido.</span><span class="sxs-lookup"><span data-stu-id="004dd-324">The PowerPivot Management Dashboard appears.</span></span>

3.  <span data-ttu-id="004dd-325">Em Ações, clique em **Configurar parâmetros do aplicativo de serviço** para abrir a página Configurações do Aplicativo de Serviço PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="004dd-325">In Actions, click **Configure service application settings** to open the PowerPivot Service Application Settings page</span></span>

4.  <span data-ttu-id="004dd-326">Na seção Coleta de Dados de Uso, em Histórico de Dados de Uso, digite o número de dias dos quais você deseja manter um registro de atividades de atualização de dados para cada pasta de trabalho.</span><span class="sxs-lookup"><span data-stu-id="004dd-326">In the Usage Data Collection section, in Usage Data History, type the number of days for which you want to keep a record of data refresh activity for each workbook.</span></span>

     <span data-ttu-id="004dd-327">O padrão é 365 dias.</span><span class="sxs-lookup"><span data-stu-id="004dd-327">The default is 365 days.</span></span> <span data-ttu-id="004dd-328">O valor mínimo é 1 dia e o máximo é 5.000 dias.</span><span class="sxs-lookup"><span data-stu-id="004dd-328">The minimum value is 1 day and the maximum is 5000 days.</span></span> <span data-ttu-id="004dd-329">0 especifica um período de retenção ilimitado. Os dados nunca são excluídos.</span><span class="sxs-lookup"><span data-stu-id="004dd-329">0 specifies an unlimited retention period; data is never deleted.</span></span> <span data-ttu-id="004dd-330">Observe que não há configuração para desativar o histórico.</span><span class="sxs-lookup"><span data-stu-id="004dd-330">Note that there is no setting for turning off history.</span></span>

5.  <span data-ttu-id="004dd-331">Clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="004dd-331">Click **OK**.</span></span>

 <span data-ttu-id="004dd-332">As informações do histórico são disponibilizadas para os usuários do SharePoint quando eles escolhem a opção Gerenciar Atualização de Dados em uma pasta de trabalho que tem um histórico de atualização de dados.</span><span class="sxs-lookup"><span data-stu-id="004dd-332">History information is made available to SharePoint users when they choose the Manage Data Refresh option on a workbook that has a data refresh history.</span></span> <span data-ttu-id="004dd-333">Essas informações também são usadas no Painel de Gerenciamento PowerPivot utilizado pelos administradores de farm para gerenciar operações do serviço PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="004dd-333">This information is also used in the PowerPivot Management Dashboard used by farm administrators to manage PowerPivot service operations.</span></span> <span data-ttu-id="004dd-334">Para obter mais informações, consulte [Exibir o histórico de atualização de dados &#40;PowerPivot para SharePoint&#41;](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="004dd-334">For more information, see [View Data Refresh History &#40;PowerPivot for SharePoint&#41;](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md).</span></span>

 <span data-ttu-id="004dd-335">O armazenamento físico de longo prazo de dados de histórico está no banco de dados do aplicativo do serviço PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="004dd-335">Long-term physical storage of history data is in the PowerPivot service application database for the PowerPivot service application.</span></span> <span data-ttu-id="004dd-336">Para obter mais informações sobre como os dados de uso são coletados e armazenados, consulte [PowerPivot Usage Data Collection](power-pivot-sharepoint/power-pivot-usage-data-collection.md).</span><span class="sxs-lookup"><span data-stu-id="004dd-336">For more information about how usage data is collected and stored, see [PowerPivot Usage Data Collection](power-pivot-sharepoint/power-pivot-usage-data-collection.md).</span></span>

##  <a name="reschedule-the-powerpivot-data-refresh-timer-job"></a><a name="configTimerJob"></a><span data-ttu-id="004dd-337">Reagendar o trabalho de timer da atualização de dados PowerPivot</span><span class="sxs-lookup"><span data-stu-id="004dd-337">Reschedule the PowerPivot Data Refresh timer job</span></span>
 <span data-ttu-id="004dd-338">A atualização de dados agendada é disparada pelo trabalho de timer da Atualização de Dados PowerPivot que examina informações da agenda no banco de dados do aplicativo do serviço PowerPivot em intervalos de um minuto.</span><span class="sxs-lookup"><span data-stu-id="004dd-338">Scheduled data refresh is triggered by a PowerPivot Data Refresh timer job that scans schedule information in the PowerPivot service application database at one minute intervals.</span></span> <span data-ttu-id="004dd-339">Quando a atualização de dados está agendada para começar, o trabalho de timer adiciona a solicitação a uma fila de processamento em um servidor PowerPivot disponível.</span><span class="sxs-lookup"><span data-stu-id="004dd-339">When data refresh is scheduled to begin, the timer job adds the request to a processing queue on an available PowerPivot server.</span></span>

 <span data-ttu-id="004dd-340">Você pode aumentar o período de tempo entre exames como uma técnica de ajuste do desempenho.</span><span class="sxs-lookup"><span data-stu-id="004dd-340">You can increase the length of time between scans as a performance tuning technique.</span></span> <span data-ttu-id="004dd-341">Você também pode desabilitar o trabalho de timer para interromper temporariamente as operações de atualização de dados ao solucionar problemas.</span><span class="sxs-lookup"><span data-stu-id="004dd-341">You can also disable the timer job to temporarily stop data refresh operations while you troubleshoot problems.</span></span>

 <span data-ttu-id="004dd-342">A configuração padrão é um minuto que é o valor mais baixo que pode ser especificado.</span><span class="sxs-lookup"><span data-stu-id="004dd-342">The default setting is one minute, which is the lowest value you can specify.</span></span> <span data-ttu-id="004dd-343">Esse valor é recomendado porque fornece o resultado mais previsível para agendas que executam em horários arbitrários ao longo do dia.</span><span class="sxs-lookup"><span data-stu-id="004dd-343">This value is recommended because it provides the most predictable outcome for schedules that run at arbitrary times throughout the day.</span></span> <span data-ttu-id="004dd-344">Por exemplo, se um usuário agendar a atualização de dados para as 16h15, e o trabalho de timer examinar as agendas a cada minuto, a solicitação de atualização de dados agendada será detectada às 16h15 e o processamento ocorrerá alguns minutos depois das 16h15.</span><span class="sxs-lookup"><span data-stu-id="004dd-344">For example, if a user schedules data refresh for 4:15 PM, and the timer job scans for schedules every minute, the scheduled data refresh request will be detected at 4:15 and processing will occur within a few minutes of 4:15.</span></span>

 <span data-ttu-id="004dd-345">Se você aumentar o intervalo de exame para que ele seja executado com pouca frequência (por exemplo, uma vez por dia à meia-noite), todas as operações de atualização de dados que foram agendadas para serem executadas nesse intervalo serão adicionadas à fila de processamento ao mesmo tempo, podendo sobrecarregar o servidor e privar outros aplicativos de recursos do sistema.</span><span class="sxs-lookup"><span data-stu-id="004dd-345">If you raise the scan interval so that it runs very infrequently (for example, once a day at midnight), all of the data refresh operations that were scheduled to run during that interval are added to the processing queue all at once, potentially overwhelming the server and starving other applications of system resources.</span></span> <span data-ttu-id="004dd-346">Dependendo do número de atualizações agendadas, a fila de processamento de operações de atualização de dados poderá aumentar de tal forma que nenhum trabalho poderá ser concluído.</span><span class="sxs-lookup"><span data-stu-id="004dd-346">Depending on the number of scheduled refreshes, the processing queue for data refresh operations might build up to such an extent that not all jobs will be able to complete.</span></span> <span data-ttu-id="004dd-347">As solicitações de atualização de dados que estão no final da fila talvez sejam descartadas se coincidirem com o próximo intervalo de processamento.</span><span class="sxs-lookup"><span data-stu-id="004dd-347">Data refresh requests at the end of the queue might be dropped if they run into the next processing interval.</span></span>

 <span data-ttu-id="004dd-348">Dependendo do suporte oferecido por seu hardware, você poderá atenuar esse problema especificando que processadores adicionais executem um maior número de trabalhos de atualização de dados em paralelo.</span><span class="sxs-lookup"><span data-stu-id="004dd-348">If your hardware supports it, you can mitigate this problem by specifying additional processors to run more data refresh jobs in parallel.</span></span> <span data-ttu-id="004dd-349">Para obter mais informações, consulte [Configurar a atualização de dados dedicada ou processamento somente de consulta &#40;PowerPivot para SharePoint&#41;](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="004dd-349">For more information, see [Configure Dedicated Data Refresh or Query-Only Processing &#40;PowerPivot for SharePoint&#41;](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md).</span></span> <span data-ttu-id="004dd-350">Para obter mais informações sobre como as solicitações de atualização de dados são descobertas, adicionadas a uma fila e processadas, consulte [PowerPivot data Refresh](power-pivot-sharepoint/power-pivot-data-refresh.md).</span><span class="sxs-lookup"><span data-stu-id="004dd-350">For more information about how data refresh requests are discovered, added to a queue, and processed, see [PowerPivot Data Refresh](power-pivot-sharepoint/power-pivot-data-refresh.md).</span></span>

1.  <span data-ttu-id="004dd-351">Na Administração Central, clique em **Monitoramento**.</span><span class="sxs-lookup"><span data-stu-id="004dd-351">In Central Administration, click **Monitoring**.</span></span>

2.  <span data-ttu-id="004dd-352">Clique em **examinar definições de trabalho**.</span><span class="sxs-lookup"><span data-stu-id="004dd-352">Click **Review Job Definitions**.</span></span>

3.  <span data-ttu-id="004dd-353">Selecione o **Trabalho de Timer da Atualização de Dados do PowerPivot**.</span><span class="sxs-lookup"><span data-stu-id="004dd-353">Select the **PowerPivot Data Refresh Timer Job**.</span></span>

4.  <span data-ttu-id="004dd-354">Modifique a frequência da agenda para alterar a frequência com que o trabalho de timer examina as informações da agenda da atualização de dados.</span><span class="sxs-lookup"><span data-stu-id="004dd-354">Modify the schedule frequency to change how often the timer job scans for data refresh schedule information.</span></span>

##  <a name="disable-the-data-refresh-timer-job"></a><a name="bkmk_disableDR"></a><span data-ttu-id="004dd-355">Desabilitar o trabalho de timer da atualização de dados</span><span class="sxs-lookup"><span data-stu-id="004dd-355">Disable the Data Refresh Timer Job</span></span>
 <span data-ttu-id="004dd-356">O trabalho de timer da atualização de dados PowerPivot é um trabalho de timer no nível de farm que é habilitado ou desabilitado para todas as instâncias do servidor PowerPivot no farm.</span><span class="sxs-lookup"><span data-stu-id="004dd-356">The PowerPivot data refresh timer job is a farm-level timer job that is either enabled or disabled for all PowerPivot server instances in the farm.</span></span> <span data-ttu-id="004dd-357">Ele não está ligado a um aplicativo Web ou a um aplicativo do serviço PowerPivot específico.</span><span class="sxs-lookup"><span data-stu-id="004dd-357">It is not tied to a specific Web application or PowerPivot service application.</span></span> <span data-ttu-id="004dd-358">Não é possível desabilitá-lo em alguns servidores para forçar o processamento da atualização de dados em outros servidores do farm.</span><span class="sxs-lookup"><span data-stu-id="004dd-358">You cannot disable it on some servers to force data refresh processing to other servers in the farm.</span></span>

 <span data-ttu-id="004dd-359">Se você desabilitar o trabalho de timer da atualização de dados PowerPivot, as solicitações que já estavam na fila serão processadas, mas nenhuma nova solicitação será adicionada até que você habilite novamente o trabalho.</span><span class="sxs-lookup"><span data-stu-id="004dd-359">If you disable the PowerPivot data refresh timer job, requests that were already in the queue will be processed, but no new requests will be added until you re-enable the job.</span></span> <span data-ttu-id="004dd-360">As solicitações que estavam agendadas para ocorrer no passado não são processadas.</span><span class="sxs-lookup"><span data-stu-id="004dd-360">Requests that were scheduled to occur in the past are not processed.</span></span>

 <span data-ttu-id="004dd-361">Desabilitar o trabalho de timer não tem nenhum efeito na disponibilidade de recursos nas páginas do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="004dd-361">Disabling the timer job has no effect on feature availability in application pages.</span></span> <span data-ttu-id="004dd-362">Não há nenhuma maneira de remover ou ocultar o recurso de atualização de dados em aplicativos Web.</span><span class="sxs-lookup"><span data-stu-id="004dd-362">There is no way to remove or hide the data refresh feature in web applications.</span></span> <span data-ttu-id="004dd-363">Os usuários que têm permissões de Colaboração ou superior ainda poderão criar novas agendas para operações de atualização de dados, mesmo que o trabalho de timer seja desabilitado permanentemente.</span><span class="sxs-lookup"><span data-stu-id="004dd-363">Users who have Contribute permissions or above will still be able to create new schedules for data refresh operations, even if the timer job is permanently disabled.</span></span>

## <a name="see-also"></a><span data-ttu-id="004dd-364">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="004dd-364">See Also</span></span>
 <span data-ttu-id="004dd-365">[Agendar uma atualização de dados &#40;PowerPivot para SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md) [Configurar a atualização de dados dedicada ou processamento somente de consulta &#40;PowerPivot para SharePoint&#41;](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md) [Configurar a conta de atualização de dados autônoma do PowerPivot &#40;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md) PowerPivot para SharePoint&#41;[configurar credenciais armazenadas para a atualização de dados do PowerPivot &#40;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md) PowerPivot para SharePoint&#41;</span><span class="sxs-lookup"><span data-stu-id="004dd-365">[Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md) [Configure Dedicated Data Refresh or Query-Only Processing &#40;PowerPivot for SharePoint&#41;](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md) [Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md) [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)</span></span>


