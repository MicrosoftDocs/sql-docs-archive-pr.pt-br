---
title: Manipular várias etapas de trabalho | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ssms
ms.topic: conceptual
helpviewer_keywords:
- job steps [SQL Server Agent]
- ordering job steps [SQL Server]
- multiple job steps
- SQL Server Agent jobs, job steps
- control of flow for jobs [SQL Server]
ms.assetid: 7aba19ff-72b3-45f6-8e54-23f4988d63a8
author: stevestein
ms.author: sstein
ms.openlocfilehash: fef0fb69b5bfd028977276d8efabc333a21e0feb
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87569007"
---
# <a name="handle-multiple-job-steps"></a><span data-ttu-id="f633d-102">Manipular várias etapas de trabalho</span><span class="sxs-lookup"><span data-stu-id="f633d-102">Handle Multiple Job Steps</span></span>
  <span data-ttu-id="f633d-103">Se um trabalho tiver mais de uma etapa, você terá que especificar a ordem em que as etapas de trabalho devem ser executadas.</span><span class="sxs-lookup"><span data-stu-id="f633d-103">If your job has more than one job step, you must specify the order in which the job steps run.</span></span> <span data-ttu-id="f633d-104">Isso é chamado *controle de fluxo\*\*.*</span><span class="sxs-lookup"><span data-stu-id="f633d-104">This is called *control of flow\*\*.*</span></span> <span data-ttu-id="f633d-105">Você pode adicionar novas etapas de trabalho e reorganizar o fluxo a qualquer hora; as alterações entram em vigor na próxima vez em que o trabalho é executado.</span><span class="sxs-lookup"><span data-stu-id="f633d-105">You can add new job steps and rearrange the flow of job steps at any time; the changes take effect the next time the job is run.</span></span> <span data-ttu-id="f633d-106">Essa ilustração mostra o controle de fluxo para um trabalho de backup de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="f633d-106">This illustration shows the control of flow for a database backup job.</span></span>  
  
 <span data-ttu-id="f633d-107">![Controle de fluxo das etapas de trabalho do SQL Server Agent](../../database-engine/media/dbflow01.gif "Controle de fluxo das etapas de trabalho do SQL Server Agent")</span><span class="sxs-lookup"><span data-stu-id="f633d-107">![SQL Server Agent job steps control of flow](../../database-engine/media/dbflow01.gif "SQL Server Agent job steps control of flow")</span></span>  
  
 <span data-ttu-id="f633d-108">A primeira etapa é Fazer Backup do Banco de Dados.</span><span class="sxs-lookup"><span data-stu-id="f633d-108">The first step is Backup Database.</span></span> <span data-ttu-id="f633d-109">Se essa etapa falhar, o [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent informará a falha ao operador definido para receber a notificação.</span><span class="sxs-lookup"><span data-stu-id="f633d-109">If this step fails, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent reports failure to the operator who is defined to receive notification.</span></span> <span data-ttu-id="f633d-110">Se a etapa Fazer Backup de Banco de Dados tiver êxito, o trabalho passará à próxima etapa, “Scrub” dos Dados do Cliente.</span><span class="sxs-lookup"><span data-stu-id="f633d-110">If the Backup Database step succeeds, the job proceeds to the next step, "Scrub" Customer Data.</span></span> <span data-ttu-id="f633d-111">Se essa etapa falhar, o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent irá passar para a etapa Recuperar Banco de Dados.</span><span class="sxs-lookup"><span data-stu-id="f633d-111">If this step fails, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent skips forward to Restore Database.</span></span> <span data-ttu-id="f633d-112">Se "Scrub" dos Dados do Cliente tiver êxito, o trabalho passará à próxima etapa, Atualizar Estatísticas e assim por diante, até que a etapa final resulte em Informar Êxito ou Informar Falha.</span><span class="sxs-lookup"><span data-stu-id="f633d-112">If "Scrub" Customer Data succeeds, the job proceeds to the next step, Update Statistics, and so on, until the final step either results in Report Success or Report Failure.</span></span>  
  
 <span data-ttu-id="f633d-113">É você quem define a ação de controle de fluxo quanto ao êxito ou falha de cada etapa do trabalho.</span><span class="sxs-lookup"><span data-stu-id="f633d-113">You define a control-of-flow action for the success and failure of each job step.</span></span> <span data-ttu-id="f633d-114">É preciso especificar a ação a ser tomada mediante o êxito ou a falha da etapa de trabalho.</span><span class="sxs-lookup"><span data-stu-id="f633d-114">You must specify an action to be taken when a job step succeeds and an action to be taken when a job step fails.</span></span> <span data-ttu-id="f633d-115">Você também pode definir o número de novas tentativas, em caso de falha da etapa de trabalho e o intervalo entre elas.</span><span class="sxs-lookup"><span data-stu-id="f633d-115">You can also define the number of retry attempts for failed job steps and the interval between the retry attempts.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="f633d-116">Quando a GUI do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent é utilizada para excluir uma ou mais etapas de um trabalho com várias etapas, ela remove todas as etapas e, em seguida, adiciona novamente as etapas restantes com as referências corretas das ações em caso de êxito ou falha.</span><span class="sxs-lookup"><span data-stu-id="f633d-116">When you use the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent graphical user interface (GUI) and delete one or more steps from a multistep job, the GUI removes all job steps and then adds the remaining steps back with the correct on-success or on-failure references.</span></span> <span data-ttu-id="f633d-117">Por exemplo, suponha que você tenha um trabalho com cinco etapas e que a primeira etapa esteja configurada para passar à etapa 4, caso obtenha êxito.</span><span class="sxs-lookup"><span data-stu-id="f633d-117">For example, suppose you have a job with five steps, and the first step is configured to jump to step 4 if it completes successfully.</span></span> <span data-ttu-id="f633d-118">Se você excluir a etapa 3, a GUI removerá todas as etapas do trabalho e adicionará as quatro etapas restantes (1, 2, 4 e 5) com as referências corretas.</span><span class="sxs-lookup"><span data-stu-id="f633d-118">If you delete step 3, the GUI removes all steps for this job and adds the remaining four steps (1, 2, 4, and 5) with corrected references.</span></span> <span data-ttu-id="f633d-119">Nesse caso, a referência na etapa 1 seria reconfigurada para passar à etapa 3, caso a etapa 1 obtenha êxito.</span><span class="sxs-lookup"><span data-stu-id="f633d-119">In this case, the reference in step 1 would be reconfigured to jump to step 3 if step 1 completes successfully.</span></span>  
  
 <span data-ttu-id="f633d-120">As etapas de trabalho devem ser autossuficientes.</span><span class="sxs-lookup"><span data-stu-id="f633d-120">Job steps must be self-contained.</span></span> <span data-ttu-id="f633d-121">Ou seja, um trabalho não pode transmitir valores Boolianos, dados ou valores numéricos entre etapas de trabalho.</span><span class="sxs-lookup"><span data-stu-id="f633d-121">That is, a job cannot pass Boolean values, data, or numeric values between job steps.</span></span> <span data-ttu-id="f633d-122">É possível, contudo, transmitir valores de uma etapa de trabalho [!INCLUDE[tsql](../../includes/tsql-md.md)] para outra, usando tabelas permanentes ou tabelas temporárias globais.</span><span class="sxs-lookup"><span data-stu-id="f633d-122">You can, however, pass values from one [!INCLUDE[tsql](../../includes/tsql-md.md)] job step to another by using permanent tables or global temporary tables.</span></span> <span data-ttu-id="f633d-123">É possível transmitir valores entre etapas de trabalho que executam programas executáveis, de uma etapa de trabalho para outra usando arquivos.</span><span class="sxs-lookup"><span data-stu-id="f633d-123">You can pass values from job steps that run executable programs from one job step to another job step by using files.</span></span> <span data-ttu-id="f633d-124">Por exemplo, o executável de uma etapa de trabalho grava um arquivo e o executável da etapa subsequente o lê.</span><span class="sxs-lookup"><span data-stu-id="f633d-124">For example, the executable run by one job step writes a file, and the executable run by a subsequent job step reads the file.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="f633d-125">Se você criar etapas de trabalho em loop (etapa 1 seguida da etapa 2, então a etapa 2 retorna à etapa 1), aparecerá uma mensagem de aviso quando o trabalho for criado pelo [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f633d-125">If you create looping job steps (job step 1 is followed by job step 2, then job step 2 returns to job step 1), a warning message appears when the job is created using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span></span>  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="f633d-126">O Agent registra as informações do trabalho e suas etapas no histórico de trabalhos.</span><span class="sxs-lookup"><span data-stu-id="f633d-126">Agent records job and job step information in the job history.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f633d-127">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="f633d-127">See Also</span></span>  
 <span data-ttu-id="f633d-128">[sp_add_job &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-add-job-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="f633d-128">[sp_add_job &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-add-job-transact-sql) </span></span>  
 <span data-ttu-id="f633d-129">[dbo.sysjobhistory &#40;Transact-SQL&#41;](/sql/relational-databases/system-tables/dbo-sysjobhistory-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="f633d-129">[dbo.sysjobhistory &#40;Transact-SQL&#41;](/sql/relational-databases/system-tables/dbo-sysjobhistory-transact-sql) </span></span>  
 <span data-ttu-id="f633d-130">[Trabalhos dedbo.sys&#40;&#41;de Transact-SQL](/sql/relational-databases/system-tables/dbo-sysjobs-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="f633d-130">[dbo.sysjobs &#40;Transact-SQL&#41;](/sql/relational-databases/system-tables/dbo-sysjobs-transact-sql) </span></span>  
 <span data-ttu-id="f633d-131">[dbo.sysJobSteps &#40;Transact-SQL&#41;](/sql/relational-databases/system-tables/dbo-sysjobsteps-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="f633d-131">[dbo.sysjobsteps &#40;Transact-SQL&#41;](/sql/relational-databases/system-tables/dbo-sysjobsteps-transact-sql) </span></span>  
 <span data-ttu-id="f633d-132">[Implementar trabalhos](implement-jobs.md) </span><span class="sxs-lookup"><span data-stu-id="f633d-132">[Implement Jobs](implement-jobs.md) </span></span>  
 [<span data-ttu-id="f633d-133">Gerenciar etapas de trabalho</span><span class="sxs-lookup"><span data-stu-id="f633d-133">Manage Job Steps</span></span>](manage-job-steps.md)  
  
  
