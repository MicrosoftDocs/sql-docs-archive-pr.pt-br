---
title: Gerenciar etapas de trabalho | Microsoft Docs
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ssms
ms.topic: conceptual
helpviewer_keywords:
- job steps [SQL Server replication]
- job steps [SQL Server Agent]
- jobs [SQL Server Agent], Integration Services package step
- executable programs as job steps
- operating systems [SQL Server], job steps
- Transact-SQL job step
- job steps [Transact-SQL]
- Integration Services packages, job steps
- replication job steps [SQL Server]
- logs [SQL Server], jobs
- SQL Server Agent jobs, job steps
- ActiveX scripting jobs [SQL Server]
- job steps [Analysis Services]
ms.assetid: 51352afc-a0a4-428b-8985-f9e58bb57c31
author: stevestein
ms.author: sstein
ms.openlocfilehash: 7362df13956e44b73d6984691e882bec2f39a1e4
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87575542"
---
# <a name="manage-job-steps"></a><span data-ttu-id="9a91e-102">Gerenciar etapas de trabalho</span><span class="sxs-lookup"><span data-stu-id="9a91e-102">Manage Job Steps</span></span>
  <span data-ttu-id="9a91e-103">Uma etapa de trabalho é uma ação que o trabalho realiza em um banco de dados ou servidor.</span><span class="sxs-lookup"><span data-stu-id="9a91e-103">A job step is an action that the job takes on a database or a server.</span></span> <span data-ttu-id="9a91e-104">Todo trabalho deve ter, pelo menos, uma etapa de trabalho.</span><span class="sxs-lookup"><span data-stu-id="9a91e-104">Every job must have at least one job step.</span></span> <span data-ttu-id="9a91e-105">As etapas de trabalho podem ser:</span><span class="sxs-lookup"><span data-stu-id="9a91e-105">Job steps can be:</span></span>  
  
-   <span data-ttu-id="9a91e-106">Programas executáveis e comandos de sistema operacional.</span><span class="sxs-lookup"><span data-stu-id="9a91e-106">Executable programs and operating system commands.</span></span>  
  
-   [!INCLUDE[tsql](../../includes/tsql-md.md)] <span data-ttu-id="9a91e-107">instruções, inclusive procedimentos armazenados e procedimentos armazenados estendidos.</span><span class="sxs-lookup"><span data-stu-id="9a91e-107">statements, including stored procedures and extended stored procedures.</span></span>  
  
-   <span data-ttu-id="9a91e-108">Scripts PowerShell.</span><span class="sxs-lookup"><span data-stu-id="9a91e-108">PowerShell scripts.</span></span>  
  
-   [!INCLUDE[msCoName](../../includes/msconame-md.md)] <span data-ttu-id="9a91e-109">Scripts ActiveX.</span><span class="sxs-lookup"><span data-stu-id="9a91e-109">ActiveX scripts.</span></span>  
  
-   <span data-ttu-id="9a91e-110">Tarefas de replicação.</span><span class="sxs-lookup"><span data-stu-id="9a91e-110">Replication tasks.</span></span>  
  
-   [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="9a91e-111">tarefas.</span><span class="sxs-lookup"><span data-stu-id="9a91e-111">tasks.</span></span>  
  
-   [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] <span data-ttu-id="9a91e-112">pacotes.</span><span class="sxs-lookup"><span data-stu-id="9a91e-112">packages.</span></span>  
  
 <span data-ttu-id="9a91e-113">Toda etapa de trabalho é executada em um contexto de segurança específico.</span><span class="sxs-lookup"><span data-stu-id="9a91e-113">Every job step runs in a specific security context.</span></span> <span data-ttu-id="9a91e-114">Se a etapa de trabalho especificar um proxy, será executada no contexto de segurança da credencial para aquele proxy.</span><span class="sxs-lookup"><span data-stu-id="9a91e-114">If the job step specifies a proxy, the job step runs in the security context of the credential for the proxy.</span></span> <span data-ttu-id="9a91e-115">Se a etapa de trabalho não especificar um proxy, ela será executada no contexto de segurança da conta de serviço do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent.</span><span class="sxs-lookup"><span data-stu-id="9a91e-115">If a job step does not specify a proxy, the job step runs in the context of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent service account.</span></span> <span data-ttu-id="9a91e-116">Apenas membros da função de servidor fixa sysadmin podem criar trabalhos que não especifiquem um proxy explicitamente.</span><span class="sxs-lookup"><span data-stu-id="9a91e-116">Only members of the sysadmin fixed server role can create jobs that do not explicitly specify a proxy.</span></span>  
  
 <span data-ttu-id="9a91e-117">Como as etapas de trabalho são executadas no contexto de um usuário específico do [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows, esse usuário deve ter as permissões e a configuração necessárias para a execução da etapa de trabalho.</span><span class="sxs-lookup"><span data-stu-id="9a91e-117">Because job steps run in the context of a specific [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows user, that user must have the permissions and configuration necessary for the job step to execute.</span></span> <span data-ttu-id="9a91e-118">Por exemplo, se você criar um trabalho que requeira uma letra de unidade ou um caminho UNC (convenção de nomenclatura universal), as etapas do trabalho poderão ser executadas em sua conta de usuário do Microsoft Windows durante o teste das tarefas.</span><span class="sxs-lookup"><span data-stu-id="9a91e-118">For example, if you create a job that requires a drive letter or a Universal Naming Convention (UNC) path, the job steps may run under your Windows user account while testing the tasks.</span></span> <span data-ttu-id="9a91e-119">Porém, o usuário Windows da etapa de trabalho também deve ter as permissões necessárias, as configurações de letra de unidade ou o acesso à unidade necessária.</span><span class="sxs-lookup"><span data-stu-id="9a91e-119">However, the Windows user for the job step must also have the necessary permissions, drive letter configurations, or access to the required drive.</span></span> <span data-ttu-id="9a91e-120">Caso contrário, a etapa de trabalho falhará.</span><span class="sxs-lookup"><span data-stu-id="9a91e-120">Otherwise, the job step fails.</span></span> <span data-ttu-id="9a91e-121">Para evitar esse problema, assegure que o proxy de cada etapa de trabalho tenha as permissões necessárias para a tarefa executada pela etapa.</span><span class="sxs-lookup"><span data-stu-id="9a91e-121">To prevent this problem, ensure that the proxy for each job step has the necessary permissions for the task that the job step performs.</span></span> <span data-ttu-id="9a91e-122">Para obter mais informações, consulte [central de segurança para SQL Server mecanismo de banco de dados e banco de dados SQL do Azure](../../relational-databases/security/security-center-for-sql-server-database-engine-and-azure-sql-database.md).</span><span class="sxs-lookup"><span data-stu-id="9a91e-122">For more information, see [Security Center for SQL Server Database Engine and Azure SQL Database](../../relational-databases/security/security-center-for-sql-server-database-engine-and-azure-sql-database.md).</span></span>  
  
## <a name="job-step-logs"></a><span data-ttu-id="9a91e-123">Logs de etapas de trabalho</span><span class="sxs-lookup"><span data-stu-id="9a91e-123">Job Step Logs</span></span>  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="9a91e-124">O Agent pode gravar a saída de algumas etapas de trabalho em um arquivo do sistema operacional ou na tabela sysjobstepslogs do banco de dados msdb.</span><span class="sxs-lookup"><span data-stu-id="9a91e-124">Agent can write output from some job steps either to an operating system file or to the sysjobstepslogs table in the msdb database.</span></span> <span data-ttu-id="9a91e-125">Os seguintes tipos de etapa de trabalho podem gravar a saída em ambos os destinos:</span><span class="sxs-lookup"><span data-stu-id="9a91e-125">The following job step types can write output to both destinations:</span></span>  
  
-   <span data-ttu-id="9a91e-126">Programas executáveis e comandos de sistema operacional.</span><span class="sxs-lookup"><span data-stu-id="9a91e-126">Executable programs and operating system commands.</span></span>  
  
-   <span data-ttu-id="9a91e-127">Instruções[!INCLUDE[tsql](../../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="9a91e-127">[!INCLUDE[tsql](../../includes/tsql-md.md)] statements.</span></span>  
  
-   [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="9a91e-128">tarefas.</span><span class="sxs-lookup"><span data-stu-id="9a91e-128">tasks.</span></span>  
  
 <span data-ttu-id="9a91e-129">Apenas etapas de trabalho executadas por usuários membros da função de servidor fixa sysadmin podem gravar a saída de etapas de trabalho em arquivos do sistema operacional.</span><span class="sxs-lookup"><span data-stu-id="9a91e-129">Only job steps that are executed by users who are members of the sysadmin fixed server role can write job step output to operating system files.</span></span> <span data-ttu-id="9a91e-130">Se as etapas de trabalho forem executadas por usuários que são membros das funções de banco de dados fixas SQLAgentUserRole, SQLAgentReaderRole ou SQLAgentOperatorRole no banco de dados msdb, a saída dessas etapas só poderá ser gravada na tabela sysjobstepslogs.</span><span class="sxs-lookup"><span data-stu-id="9a91e-130">If job steps are executed by users who are members of the SQLAgentUserRole, SQLAgentReaderRole, or the SQLAgentOperatorRole fixed database roles in the msdb database, then the output from these job steps can be written only to the sysjobstepslogs table.</span></span>  
  
 <span data-ttu-id="9a91e-131">Os logs de etapas de trabalho são eliminados automaticamente na exclusão de trabalhos ou de etapas de trabalho.</span><span class="sxs-lookup"><span data-stu-id="9a91e-131">Job step logs are automatically deleted when jobs or job steps are deleted.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="9a91e-132">O registro de tarefas de replicação e de etapas de trabalho de pacotes do [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] é manipulado por seus respectivos subsistemas.</span><span class="sxs-lookup"><span data-stu-id="9a91e-132">Replication task and [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] package job step logging is handled by their respective subsystem.</span></span> <span data-ttu-id="9a91e-133">Não é possível usar o [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent para configurar o registro desses tipos de etapa de trabalho.</span><span class="sxs-lookup"><span data-stu-id="9a91e-133">You cannot use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent to configure jog step logging for these types of job steps.</span></span>  
  
## <a name="executable-programs-and-operating-system-commands-as-job-steps"></a><span data-ttu-id="9a91e-134">Programas executáveis e comandos do sistema operacional como etapas de trabalho</span><span class="sxs-lookup"><span data-stu-id="9a91e-134">Executable Programs and Operating-System Commands As Job Steps</span></span>  
 <span data-ttu-id="9a91e-135">Programas executáveis e comandos de sistema operacional podem ser usados como etapas de trabalho.</span><span class="sxs-lookup"><span data-stu-id="9a91e-135">Executable programs and operating-system commands can be used as job steps.</span></span> <span data-ttu-id="9a91e-136">Esses arquivos podem ter as extensões .bat, .cmd, .com ou .exe.</span><span class="sxs-lookup"><span data-stu-id="9a91e-136">These files may have .bat, .cmd, .com, or .exe file extensions.</span></span>  
  
 <span data-ttu-id="9a91e-137">Ao usar um programa executável ou um comando de sistema operacional como etapa de trabalho, é necessário especificar:</span><span class="sxs-lookup"><span data-stu-id="9a91e-137">When you use an executable program or an operating-system command as a job step, you must specify:</span></span>  
  
-   <span data-ttu-id="9a91e-138">O código de saída do processo retornado, se o comando teve êxito.</span><span class="sxs-lookup"><span data-stu-id="9a91e-138">The process exit code returned if the command was successful.</span></span>  
  
-   <span data-ttu-id="9a91e-139">O comando a ser executado.</span><span class="sxs-lookup"><span data-stu-id="9a91e-139">The command to execute.</span></span> <span data-ttu-id="9a91e-140">Para executar um comando de sistema operacional, trata-se do próprio comando.</span><span class="sxs-lookup"><span data-stu-id="9a91e-140">To execute an operating system command, this is simply the command itself.</span></span> <span data-ttu-id="9a91e-141">No caso de um programa externo, é o nome do programa e os argumentos para o programa; por exemplo: **C:\Program Files\Microsoft SQL Server\100\Tools\Binn\sqlcmd.exe -e -q "sp_who"**</span><span class="sxs-lookup"><span data-stu-id="9a91e-141">For an external program, this is the name of the program and the arguments to the program, for example: **C:\Program Files\Microsoft SQL Server\100\Tools\Binn\sqlcmd.exe -e -q "sp_who"**</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="9a91e-142">É necessário fornecer o caminho completo para o executável, caso este não esteja localizado em um diretório especificado no caminho de sistema ou no caminho para o usuário em cujo nome a etapa de trabalho é executada.</span><span class="sxs-lookup"><span data-stu-id="9a91e-142">You must provide the full path to the executable if the executable is not located in a directory specified in the system path or the path for the user that the job step runs as.</span></span>  
  
## <a name="transact-sql-job-steps"></a><span data-ttu-id="9a91e-143">Etapas de trabalho do Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="9a91e-143">Transact-SQL Job Steps</span></span>  
 <span data-ttu-id="9a91e-144">Ao criar uma etapa de trabalho [!INCLUDE[tsql](../../includes/tsql-md.md)] , você deve:</span><span class="sxs-lookup"><span data-stu-id="9a91e-144">When you create a [!INCLUDE[tsql](../../includes/tsql-md.md)] job step, you must:</span></span>  
  
-   <span data-ttu-id="9a91e-145">Identificar o banco de dados no qual executar o trabalho.</span><span class="sxs-lookup"><span data-stu-id="9a91e-145">Identify the database in which to run the job.</span></span>  
  
-   <span data-ttu-id="9a91e-146">Digitar a instrução [!INCLUDE[tsql](../../includes/tsql-md.md)] a executar.</span><span class="sxs-lookup"><span data-stu-id="9a91e-146">Type the [!INCLUDE[tsql](../../includes/tsql-md.md)] statement to execute.</span></span> <span data-ttu-id="9a91e-147">A instrução pode chamar um procedimento armazenado ou um procedimento armazenado estendido.</span><span class="sxs-lookup"><span data-stu-id="9a91e-147">The statement may call a stored procedure or an extended stored procedure.</span></span>  
  
 <span data-ttu-id="9a91e-148">Opcionalmente, você pode abrir um arquivo [!INCLUDE[tsql](../../includes/tsql-md.md)] existente na forma de um comando para a etapa de trabalho.</span><span class="sxs-lookup"><span data-stu-id="9a91e-148">Optionally, you can open an existing [!INCLUDE[tsql](../../includes/tsql-md.md)] file as the command for the job step.</span></span>  
  
 [!INCLUDE[tsql](../../includes/tsql-md.md)] <span data-ttu-id="9a91e-149">Etapas de trabalho não usam proxies do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent.</span><span class="sxs-lookup"><span data-stu-id="9a91e-149">job steps do not use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent proxies.</span></span> <span data-ttu-id="9a91e-150">Em vez disso, a etapa de trabalho é executada como o seu proprietário ou como a conta de serviço do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent, caso o proprietário da etapa de trabalho seja membro da função de servidor fixa sysadmin.</span><span class="sxs-lookup"><span data-stu-id="9a91e-150">Instead, the job step runs as the owner of the job step, or as the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent service account if the owner of the job step is a member of the sysadmin fixed server role.</span></span> <span data-ttu-id="9a91e-151">Os membros da função de servidor fixa sysadmin também podem especificar que as etapas de trabalho [!INCLUDE[tsql](../../includes/tsql-md.md)] sejam executadas sob o contexto de outro usuário através do parâmetro *database_user_name* do procedimento armazenado sp_add_jobstep.</span><span class="sxs-lookup"><span data-stu-id="9a91e-151">Members of the sysadmin fixed server role can also specify that [!INCLUDE[tsql](../../includes/tsql-md.md)] job steps run under the context of another user by using the *database_user_name* parameter of the sp_add_jobstep stored procedure.</span></span> <span data-ttu-id="9a91e-152">Para obter mais informações, consulte [sp_add_jobstep &#40;&#41;Transact-SQL ](/sql/relational-databases/system-stored-procedures/sp-add-jobstep-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="9a91e-152">For more information, see [sp_add_jobstep &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-add-jobstep-transact-sql).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="9a91e-153">Uma única etapa de trabalho [!INCLUDE[tsql](../../includes/tsql-md.md)] pode conter vários lotes.</span><span class="sxs-lookup"><span data-stu-id="9a91e-153">A single [!INCLUDE[tsql](../../includes/tsql-md.md)] job step can contain multiple batches.</span></span> [!INCLUDE[tsql](../../includes/tsql-md.md)] <span data-ttu-id="9a91e-154">As etapas de trabalho podem conter comandos GO inseridos.</span><span class="sxs-lookup"><span data-stu-id="9a91e-154">job steps can contain embedded GO commands.</span></span>  
  
## <a name="powershell-scripting-job-steps"></a><span data-ttu-id="9a91e-155">Etapas de trabalho de scripts PowerShell</span><span class="sxs-lookup"><span data-stu-id="9a91e-155">PowerShell Scripting Job Steps</span></span>  
 <span data-ttu-id="9a91e-156">Ao criar uma etapa de trabalho de script PowerShell, é necessário especificar uma das duas opções a seguir como comando da etapa:</span><span class="sxs-lookup"><span data-stu-id="9a91e-156">When you create a PowerShell script job step, you must specify one of two things as the command for the step:</span></span>  
  
-   <span data-ttu-id="9a91e-157">O texto de um script PowerShell.</span><span class="sxs-lookup"><span data-stu-id="9a91e-157">The text of a PowerShell script.</span></span>  
  
-   <span data-ttu-id="9a91e-158">Um arquivo de script PowerShell existente a ser aberto.</span><span class="sxs-lookup"><span data-stu-id="9a91e-158">An existing PowerShell script file to be opened.</span></span>  
  
 <span data-ttu-id="9a91e-159">O [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] subsistema PowerShell do agente abre uma sessão do PowerShell e carrega os [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] snap-ins do PowerShell. O script do PowerShell usado como o comando de etapa de trabalho pode fazer referência ao [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] provedor e aos cmdlets do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="9a91e-159">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent PowerShell subsystem opens a PowerShell session and loads the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell snap-ins. The PowerShell script used as the job step command can reference the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell provider and cmdlets.</span></span> <span data-ttu-id="9a91e-160">Para obter mais informações sobre como escrever scripts PowerShell usando os snap-ins de PowerShell do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , consulte [SQL Server PowerShell](../../powershell/sql-server-powershell.md).</span><span class="sxs-lookup"><span data-stu-id="9a91e-160">For more information about writing PowerShell scripts using the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell snap-ins, see the [SQL Server PowerShell](../../powershell/sql-server-powershell.md).</span></span>  
  
## <a name="activex-scripting-job-steps"></a><span data-ttu-id="9a91e-161">Etapas de trabalho de scripts ActiveX</span><span class="sxs-lookup"><span data-stu-id="9a91e-161">ActiveX Scripting Job Steps</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="9a91e-162">A etapa de trabalho de script ActiveX será removida do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent em uma futura versão do [!INCLUDE[msCoName](../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="9a91e-162">The ActiveX scripting job step will be removed from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent in a future version of [!INCLUDE[msCoName](../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="9a91e-163">Evite usar esse recurso em desenvolvimentos novos e planeje modificar os aplicativos que atualmente o utilizam.</span><span class="sxs-lookup"><span data-stu-id="9a91e-163">Avoid using this feature in new development work, and plan to modify applications that currently use this feature.</span></span>  
  
 <span data-ttu-id="9a91e-164">Ao criar uma etapa de trabalho de scripts ActiveX, você deve:</span><span class="sxs-lookup"><span data-stu-id="9a91e-164">When you create an ActiveX scripting job step, you must:</span></span>  
  
-   <span data-ttu-id="9a91e-165">Identificar a linguagem de script na qual a etapa de trabalho é gravada.</span><span class="sxs-lookup"><span data-stu-id="9a91e-165">Identify the scripting language in which the job step is written.</span></span>  
  
-   <span data-ttu-id="9a91e-166">Gravar o script ActiveX.</span><span class="sxs-lookup"><span data-stu-id="9a91e-166">Write the ActiveX script.</span></span>  
  
 <span data-ttu-id="9a91e-167">Você também pode abrir um arquivo de script ActiveX existente na forma de um comando para a etapa de trabalho.</span><span class="sxs-lookup"><span data-stu-id="9a91e-167">You can also open an existing ActiveX script file as the command for the job step.</span></span> <span data-ttu-id="9a91e-168">Alternativamente, os comandos de script ActiveX podem ser compilados externamente (por exemplo, por meio do Microsoft Visual Basic) e executados como programas executáveis.</span><span class="sxs-lookup"><span data-stu-id="9a91e-168">Alternatively, ActiveX script commands can be externally compiled (for example, using Microsoft Visual Basic) and then run as executable programs.</span></span>  
  
 <span data-ttu-id="9a91e-169">Quando um comando de etapa de trabalho é um script ActiveX, é possível usar o objeto SQLActiveScriptHost para imprimir a saída em um log de histórico de etapas de trabalho ou criar objetos COM.</span><span class="sxs-lookup"><span data-stu-id="9a91e-169">When a job step command is an ActiveX script, you can use the SQLActiveScriptHost object to print output to the job step history log or create COM objects.</span></span> <span data-ttu-id="9a91e-170">SQLActiveScriptHost é um objeto global introduzido pelo sistema host do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent no namespace de script.</span><span class="sxs-lookup"><span data-stu-id="9a91e-170">SQLActiveScriptHost is a global object that is introduced by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent hosting system into the script name space.</span></span> <span data-ttu-id="9a91e-171">O objeto tem dois métodos (Print e CreateObject).</span><span class="sxs-lookup"><span data-stu-id="9a91e-171">The object has two methods (Print and CreateObject).</span></span> <span data-ttu-id="9a91e-172">O exemplo a seguir mostra como a criação de scripts do ActiveX funciona no Visual Basic Scripting Edition (VBScript).</span><span class="sxs-lookup"><span data-stu-id="9a91e-172">The following example shows how ActiveX scripting works in Visual Basic Scripting Edition (VBScript).</span></span>  
  
```  
' VBScript example for ActiveX Scripting job step  
' Create a Dmo.Server object. The object connects to the  
' server on which the script is running.  
  
Set oServer = CreateObject("SQLDmo.SqlServer")  
oServer.LoginSecure = True  
oServer.Connect "(local)"  
'Disconnect and destroy the server object  
oServer.DisConnect  
Set oServer = nothing
```  
  
## <a name="replication-job-steps"></a><span data-ttu-id="9a91e-173">Etapas de trabalho de replicação</span><span class="sxs-lookup"><span data-stu-id="9a91e-173">Replication Job Steps</span></span>  
 <span data-ttu-id="9a91e-174">Quando você cria publicações e assinaturas que usam replicação, são criados trabalhos de replicação por padrão.</span><span class="sxs-lookup"><span data-stu-id="9a91e-174">When you create publications and subscriptions using replication, replication jobs are created by default.</span></span> <span data-ttu-id="9a91e-175">O tipo de trabalho criado é determinado pelo tipo de replicação (de instantâneo, transacional ou de mesclagem) e pelas opções usadas.</span><span class="sxs-lookup"><span data-stu-id="9a91e-175">The type of job created is determined by the type of replication (snapshot, transactional, or merge) and the options used.</span></span>  
  
 <span data-ttu-id="9a91e-176">Etapas de trabalho de replicação ativam um destes agentes de replicação:</span><span class="sxs-lookup"><span data-stu-id="9a91e-176">Replication job steps activate one of these replication agents:</span></span>  
  
-   <span data-ttu-id="9a91e-177">Snapshot Agent (trabalho Snapshot)</span><span class="sxs-lookup"><span data-stu-id="9a91e-177">Snapshot Agent (Snapshot job)</span></span>  
  
-   <span data-ttu-id="9a91e-178">Log Reader Agent (trabalho LogReader)</span><span class="sxs-lookup"><span data-stu-id="9a91e-178">Log Reader Agent (LogReader job)</span></span>  
  
-   <span data-ttu-id="9a91e-179">Distribution Agent (trabalho Distribution)</span><span class="sxs-lookup"><span data-stu-id="9a91e-179">Distribution Agent (Distribution job)</span></span>  
  
-   <span data-ttu-id="9a91e-180">Merge Agent (trabalho Merge)</span><span class="sxs-lookup"><span data-stu-id="9a91e-180">Merge Agent (Merge job)</span></span>  
  
-   <span data-ttu-id="9a91e-181">Queue Reader Agent (trabalho QueueReader)</span><span class="sxs-lookup"><span data-stu-id="9a91e-181">Queue Reader Agent (QueueReader job)</span></span>  
  
 <span data-ttu-id="9a91e-182">Quando a replicação está configurada, é possível especificar a execução de agentes de replicação de três formas: continuamente, depois que o [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent é iniciado; sob demanda; ou de acordo com a agenda.</span><span class="sxs-lookup"><span data-stu-id="9a91e-182">When replication is set up, you can specify to run the replication agents in one of three ways: continuously after [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent is started, on demand, or according to a schedule.</span></span> <span data-ttu-id="9a91e-183">Para obter mais informações sobre os agentes de replicações, consulte [Visão geral dos agentes de replicação](../../relational-databases/replication/agents/replication-agents-overview.md).</span><span class="sxs-lookup"><span data-stu-id="9a91e-183">For more information about replication agents, see [Replication Agents Overview](../../relational-databases/replication/agents/replication-agents-overview.md).</span></span>  
  
## <a name="analysis-services-job-steps"></a><span data-ttu-id="9a91e-184">Etapas de trabalho do Analysis Services</span><span class="sxs-lookup"><span data-stu-id="9a91e-184">Analysis Services Job Steps</span></span>  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="9a91e-185">O Agent dá suporte a dois tipos distintos de etapas de trabalho do Analysis Services, etapas de trabalho de comando e de consulta.</span><span class="sxs-lookup"><span data-stu-id="9a91e-185">Agent supports two distinct types of Analysis Services job steps, command job steps, and query job steps.</span></span>  
  
### <a name="analysis-services-command-job-steps"></a><span data-ttu-id="9a91e-186">Etapas de trabalho de comando do Analysis Services</span><span class="sxs-lookup"><span data-stu-id="9a91e-186">Analysis Services Command Job Steps</span></span>  
 <span data-ttu-id="9a91e-187">Ao criar uma etapa de trabalho de comando do [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , é necessário:</span><span class="sxs-lookup"><span data-stu-id="9a91e-187">When you create an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] command job step, you must:</span></span>  
  
-   <span data-ttu-id="9a91e-188">Identificar o servidor OLAP do banco de dados no qual a etapa de trabalho será executada.</span><span class="sxs-lookup"><span data-stu-id="9a91e-188">Identify the database OLAP server in which to run the job step.</span></span>  
  
-   <span data-ttu-id="9a91e-189">Digitar a instrução a ser executada.</span><span class="sxs-lookup"><span data-stu-id="9a91e-189">Type the statement to execute.</span></span> <span data-ttu-id="9a91e-190">A instrução deve ser um XML para o método [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] **Execute**.</span><span class="sxs-lookup"><span data-stu-id="9a91e-190">The statement must be an XML for [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] **Execute** method.</span></span> <span data-ttu-id="9a91e-191">A instrução talvez não tenha um envelope SOAP completo ou um XML para o método [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] **Discover**.</span><span class="sxs-lookup"><span data-stu-id="9a91e-191">The statement may not contain a complete SOAP envelope or an XML for [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] **Discover** method.</span></span> <span data-ttu-id="9a91e-192">Observe que, embora o [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] dê suporte a envelopes SOAP completos e ao método **Discover** , as etapas de trabalho do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent não dão.</span><span class="sxs-lookup"><span data-stu-id="9a91e-192">Notice that, while [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] supports complete SOAP envelopes and the **Discover** method, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent job steps do not.</span></span>  
  
### <a name="analysis-services-query-job-steps"></a><span data-ttu-id="9a91e-193">Etapas de trabalho de consulta do Analysis Services</span><span class="sxs-lookup"><span data-stu-id="9a91e-193">Analysis Services Query Job Steps</span></span>  
 <span data-ttu-id="9a91e-194">Ao criar uma etapa de trabalho de consulta do [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , é necessário:</span><span class="sxs-lookup"><span data-stu-id="9a91e-194">When you create an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] query job step, you must:</span></span>  
  
-   <span data-ttu-id="9a91e-195">Identificar o servidor OLAP do banco de dados no qual a etapa de trabalho será executada.</span><span class="sxs-lookup"><span data-stu-id="9a91e-195">Identify the database OLAP server in which to run the job step.</span></span>  
  
-   <span data-ttu-id="9a91e-196">Digitar a instrução a ser executada.</span><span class="sxs-lookup"><span data-stu-id="9a91e-196">Type the statement to execute.</span></span> <span data-ttu-id="9a91e-197">A instrução deve ser uma consulta de linguagem MDX.</span><span class="sxs-lookup"><span data-stu-id="9a91e-197">The statement must be a multidimensional expressions (MDX) query.</span></span>  
  
 <span data-ttu-id="9a91e-198">Para obter mais informações sobre MDX, consulte [conceitos básicos de consulta mdx &#40;Analysis Services&#41;](https://docs.microsoft.com/analysis-services/multidimensional-models/mdx/mdx-query-fundamentals-analysis-services).</span><span class="sxs-lookup"><span data-stu-id="9a91e-198">For more information on MDX, see [MDX Query Fundamentals &#40;Analysis Services&#41;](https://docs.microsoft.com/analysis-services/multidimensional-models/mdx/mdx-query-fundamentals-analysis-services).</span></span>  
  
## <a name="integration-services-packages"></a><span data-ttu-id="9a91e-199">Pacotes do Integration Services</span><span class="sxs-lookup"><span data-stu-id="9a91e-199">Integration Services Packages</span></span>  
 <span data-ttu-id="9a91e-200">Ao criar uma etapa de trabalho de pacote do [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] , é necessário fazer o seguinte:</span><span class="sxs-lookup"><span data-stu-id="9a91e-200">When you create an [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] package job step, you must do the following:</span></span>  
  
-   <span data-ttu-id="9a91e-201">Identificar a origem do pacote.</span><span class="sxs-lookup"><span data-stu-id="9a91e-201">Identify the source of the package.</span></span>  
  
-   <span data-ttu-id="9a91e-202">Identificar o local do pacote.</span><span class="sxs-lookup"><span data-stu-id="9a91e-202">Identify the location of the package.</span></span>  
  
-   <span data-ttu-id="9a91e-203">Se arquivos de configuração forem necessários para o pacote, identificar os arquivos de configuração.</span><span class="sxs-lookup"><span data-stu-id="9a91e-203">If configuration files are required for the package, identify the configuration files.</span></span>  
  
-   <span data-ttu-id="9a91e-204">Se arquivos de comando forem necessários para o pacote, identificar os arquivos de comando.</span><span class="sxs-lookup"><span data-stu-id="9a91e-204">If command files are required for the package, identify the command files.</span></span>  
  
-   <span data-ttu-id="9a91e-205">Identificar a verificação a ser usada para o pacote.</span><span class="sxs-lookup"><span data-stu-id="9a91e-205">Identify the verification to use for the package.</span></span> <span data-ttu-id="9a91e-206">Por exemplo, você pode especificar que o pacote deve estar assinado ou ter um ID de pacote específico.</span><span class="sxs-lookup"><span data-stu-id="9a91e-206">For example, you can specify that the package must be signed, or that the package must have a specific package ID.</span></span>  
  
-   <span data-ttu-id="9a91e-207">Identificar as fontes de dados do pacote.</span><span class="sxs-lookup"><span data-stu-id="9a91e-207">Identify the data sources for the package.</span></span>  
  
-   <span data-ttu-id="9a91e-208">Identificar os provedores de log do pacote.</span><span class="sxs-lookup"><span data-stu-id="9a91e-208">Identify the log providers for the package.</span></span>  
  
-   <span data-ttu-id="9a91e-209">Especificar variáveis e valores a serem definidos antes da execução do pacote.</span><span class="sxs-lookup"><span data-stu-id="9a91e-209">Specify variables and values to set before running the package.</span></span>  
  
-   <span data-ttu-id="9a91e-210">Identificar opções de execução.</span><span class="sxs-lookup"><span data-stu-id="9a91e-210">Identify execution options.</span></span>  
  
-   <span data-ttu-id="9a91e-211">Adicionar ou modificar opções de linha de comando.</span><span class="sxs-lookup"><span data-stu-id="9a91e-211">Add or modify command-line options.</span></span>  
  
 <span data-ttu-id="9a91e-212">Observe que, se você implantar o pacote no Catálogo do SSIS e especificar o **Catálogo do SSIS** como a origem do pacote, grande parte dessas informações de configuração será obtida automaticamente do pacote.</span><span class="sxs-lookup"><span data-stu-id="9a91e-212">Note that if you deployed the package to the SSIS Catalog and you specify **SSIS Catalog** as the package source, much of this configuration information is obtained automatically from the package.</span></span> <span data-ttu-id="9a91e-213">Na guia **Configuração** , você pode especificar o ambiente, valores de parâmetros, valores de gerenciadores de conexões, substituições de propriedade e se o pacote é executado em um ambiente de runtime de 32 bits.</span><span class="sxs-lookup"><span data-stu-id="9a91e-213">Under the **Configuration** tab you can specify the environment, parameter values, connection manager values, property overrides, and whether the package runs in a 32-bit runtime environment.</span></span>  
  
 <span data-ttu-id="9a91e-214">Para obter mais informações sobre como criar etapas de trabalho que executam pacotes do [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] , consulte [Trabalhos do SQL Server Agent para pacotes](../../integration-services/packages/sql-server-agent-jobs-for-packages.md).</span><span class="sxs-lookup"><span data-stu-id="9a91e-214">For more information about creating job steps that run [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] packages, see [SQL Server Agent Jobs for Packages](../../integration-services/packages/sql-server-agent-jobs-for-packages.md).</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="9a91e-215">Related Tasks</span><span class="sxs-lookup"><span data-stu-id="9a91e-215">Related Tasks</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="9a91e-216">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="9a91e-216">**Description**</span></span>|<span data-ttu-id="9a91e-217">**Tópico**</span><span class="sxs-lookup"><span data-stu-id="9a91e-217">**Topic**</span></span>|  
|<span data-ttu-id="9a91e-218">Descreve como criar uma etapa de trabalho com um programa executável.</span><span class="sxs-lookup"><span data-stu-id="9a91e-218">Describes how to create a job step with an executable program.</span></span>|[<span data-ttu-id="9a91e-219">Criar uma etapa de trabalho CmdExec</span><span class="sxs-lookup"><span data-stu-id="9a91e-219">Create a CmdExec Job Step</span></span>](create-a-cmdexec-job-step.md)|  
|<span data-ttu-id="9a91e-220">Descreve como redefinir permissões no [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent.</span><span class="sxs-lookup"><span data-stu-id="9a91e-220">Describes how to reset [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent permissions.</span></span>|[<span data-ttu-id="9a91e-221">Configure a User to Create and Manage SQL Server Agent Jobs</span><span class="sxs-lookup"><span data-stu-id="9a91e-221">Configure a User to Create and Manage SQL Server Agent Jobs</span></span>](configure-a-user-to-create-and-manage-sql-server-agent-jobs.md)|  
|<span data-ttu-id="9a91e-222">Descreve como criar uma etapa de trabalho do [!INCLUDE[tsql](../../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="9a91e-222">Describes how to create a [!INCLUDE[tsql](../../includes/tsql-md.md)] job step.</span></span>|[<span data-ttu-id="9a91e-223">Create a Transact-SQL Job Step</span><span class="sxs-lookup"><span data-stu-id="9a91e-223">Create a Transact-SQL Job Step</span></span>](create-a-transact-sql-job-step.md)|  
|<span data-ttu-id="9a91e-224">Descreve como definir opções para etapas de trabalho Transact-SQL no Microsoft [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent.</span><span class="sxs-lookup"><span data-stu-id="9a91e-224">Describes how to define options for Microsoft [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent Transact-SQL job steps.</span></span>|[<span data-ttu-id="9a91e-225">Define Transact-SQL Job Step Options</span><span class="sxs-lookup"><span data-stu-id="9a91e-225">Define Transact-SQL Job Step Options</span></span>](define-transact-sql-job-step-options.md)|  
|<span data-ttu-id="9a91e-226">Descreve como criar e executar uma etapa de trabalho do script ActiveX.</span><span class="sxs-lookup"><span data-stu-id="9a91e-226">Describes how to create an ActiveX script job step.</span></span>|[<span data-ttu-id="9a91e-227">Create an ActiveX Script Job Step</span><span class="sxs-lookup"><span data-stu-id="9a91e-227">Create an ActiveX Script Job Step</span></span>](create-an-activex-script-job-step.md)|  
|<span data-ttu-id="9a91e-228">Descreve como criar e definir etapas de trabalho do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent que executem comandos e consultas do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="9a91e-228">Describes how to create and define [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent job steps that execute [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Analysis Services commands and queries.</span></span>|[<span data-ttu-id="9a91e-229">Create an Analysis Services Job Step</span><span class="sxs-lookup"><span data-stu-id="9a91e-229">Create an Analysis Services Job Step</span></span>](create-an-analysis-services-job-step.md)|  
|<span data-ttu-id="9a91e-230">Descreve qual ação o [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] deve realizar se uma falha ocorrer durante a execução do trabalho.</span><span class="sxs-lookup"><span data-stu-id="9a91e-230">Describes what action [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] should take if a failure occurs during job execution.</span></span>|[<span data-ttu-id="9a91e-231">Set Job Step Success or Failure Flow</span><span class="sxs-lookup"><span data-stu-id="9a91e-231">Set Job Step Success or Failure Flow</span></span>](set-job-step-success-or-failure-flow.md)|  
|<span data-ttu-id="9a91e-232">Descreve como exibir detalhes de etapa de trabalho na caixa de diálogo Propriedades da Etapa de Trabalho.</span><span class="sxs-lookup"><span data-stu-id="9a91e-232">Describes how to view job step details in the Job Step Properties dialog.</span></span>|[<span data-ttu-id="9a91e-233">View Job Step Information</span><span class="sxs-lookup"><span data-stu-id="9a91e-233">View Job Step Information</span></span>](view-job-step-information.md)|  
|<span data-ttu-id="9a91e-234">Descreve como excluir um log de etapa de trabalho do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent.</span><span class="sxs-lookup"><span data-stu-id="9a91e-234">Describes how to delete a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent job step log.</span></span>|[<span data-ttu-id="9a91e-235">Delete a Job Step Log</span><span class="sxs-lookup"><span data-stu-id="9a91e-235">Delete a Job Step Log</span></span>](delete-a-job-step-log.md)|  
  
## <a name="see-also"></a><span data-ttu-id="9a91e-236">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="9a91e-236">See Also</span></span>  
 <span data-ttu-id="9a91e-237">[dbo.sysjobstepslogs &#40;Transact-SQL&#41;](/sql/relational-databases/system-tables/dbo-sysjobstepslogs-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="9a91e-237">[dbo.sysjobstepslogs &#40;Transact-SQL&#41;](/sql/relational-databases/system-tables/dbo-sysjobstepslogs-transact-sql) </span></span>  
 <span data-ttu-id="9a91e-238">[Criar trabalhos](create-jobs.md) </span><span class="sxs-lookup"><span data-stu-id="9a91e-238">[Create Jobs](create-jobs.md) </span></span>  
 [<span data-ttu-id="9a91e-239">sp_add_job &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="9a91e-239">sp_add_job &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-add-job-transact-sql)  
