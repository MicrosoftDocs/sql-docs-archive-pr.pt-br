---
title: Instalar o Provedor Analysis Services OLE DB em servidores do SharePoint | Microsoft Docs
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: database-engine
ms.topic: conceptual
ms.assetid: 2c62daf9-1f2d-4508-a497-af62360ee859
author: maggiesMSFT
ms.author: maggies
ms.openlocfilehash: 371d344a451e7702a525e0cb6afa3421b6598cac
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87576167"
---
# <a name="install-the-analysis-services-ole-db-provider-on-sharepoint-servers"></a><span data-ttu-id="7a4a1-102">Instalar o provedor OLE DB do Analysis Services em SharePoint Servers</span><span class="sxs-lookup"><span data-stu-id="7a4a1-102">Install the Analysis Services OLE DB Provider on SharePoint Servers</span></span>
  <span data-ttu-id="7a4a1-103">O Provedor OLE DB da Microsoft para Analysis Services (MSOLAP) é uma interface que os aplicativos cliente usam para interagir com dados do [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7a4a1-103">The Microsoft OLE DB Provider for Analysis Services (MSOLAP) is an interface that client applications use to interact with [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] data.</span></span> <span data-ttu-id="7a4a1-104">Em um ambiente do SharePoint que inclui o [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)], o provedor administra solicitações de conexões para dados [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7a4a1-104">In a SharePoint environment that includes [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)], the provider handles connection requests for [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] data.</span></span>  
  
 <span data-ttu-id="7a4a1-105">O provedor de dados é incluído no pacote de instalação do [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] (spPowerPivot.msi), mas pode exigir a instalação manual.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-105">The data provider is included in the [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] installation package (spPowerPivot.msi), but might require manual installation.</span></span> <span data-ttu-id="7a4a1-106">Há duas razões para você precisar instalar uma biblioteca de cliente ou um provedor de dados manualmente em um servidor do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-106">There are two reasons why you might need to manually install a client library or data provider on a SharePoint server.</span></span>  
  
-   <span data-ttu-id="7a4a1-107">**Habilitar a compatibilidade com versões anteriores**.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-107">**Enable backwards compatibility**.</span></span> <span data-ttu-id="7a4a1-108">As pastas de trabalho do [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] especificam a versão [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] do provedor OLE DB do Analysis Services na cadeia de conexão.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-108">[!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] workbooks specify the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version of the Analysis Services OLE DB provider in their connection string.</span></span> <span data-ttu-id="7a4a1-109">Como tal, a versão desse provedor deve estar presente no computador para que a solicitação tenha sucesso.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-109">As such, this provider version must be present on the computer in order for the request to succeed.</span></span>  
  
-   <span data-ttu-id="7a4a1-110">**Habilite o acesso a dados em uma instância dedicada de serviços do Excel**.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-110">**Enable data access on a dedicated Excel Services instance**.</span></span> <span data-ttu-id="7a4a1-111">Se seu farm do SharePoint incluir Serviços do Excel em um servidor que também não tenha [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)], instale a versão do [!INCLUDE[ssSQL11SP1](../../includes/sssql11sp1-md.md)] do provedor e outros componentes de conectividade de cliente usando o pacote de instalação do [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7a4a1-111">If your SharePoint farm includes Excel Services on a server that does not also have [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)], install the [!INCLUDE[ssSQL11SP1](../../includes/sssql11sp1-md.md)] version of the provider and other client connectivity components by using the [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] installation package.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="7a4a1-112">Esses cenários não são mutuamente exclusivos.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-112">These scenarios are not mutually exclusive.</span></span> <span data-ttu-id="7a4a1-113">Hospedar várias versões de pasta de trabalho em um farm que inclui servidores de aplicativos que executam Serviços do Excel sem uma instância do [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] requer que você instale versões mais antigas e mais novas do provedor de dados em cada computador com os Serviços do Excel.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-113">Hosting multiple workbook versions on a farm that includes application servers running Excel Services without a [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] instance will require that you install both older and newer versions of the data provider on each Excel Services computer.</span></span>  
  
  
##  <a name="versions-of-the-ole-db-provider-supporting-powerpivot-data-access"></a><a name="bkmk_vers"></a><span data-ttu-id="7a4a1-114">Versões do provedor de OLE DB que dão suporte ao acesso a dados PowerPivot</span><span class="sxs-lookup"><span data-stu-id="7a4a1-114">Versions of the OLE DB Provider Supporting PowerPivot Data Access</span></span>  
 <span data-ttu-id="7a4a1-115">Um farm do SharePoint pode incluir várias versões do provedor OLE DB do Analysis Services, incluindo versões mais antigas que não têm suporte para o acesso a dados PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-115">A SharePoint farm might include multiple versions of the Analysis Services OLE DB provider, including older versions that do not support PowerPivot data access.</span></span>  
  
 <span data-ttu-id="7a4a1-116">Por padrão, o SharePoint 2010 instala a versão [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] do provedor.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-116">By default, SharePoint 2010 installs the [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] version of the provider.</span></span> <span data-ttu-id="7a4a1-117">Embora seja identificada como MSOLAP.4 (mesmo número de versão usado no [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]), essa versão não funciona para o acesso a dados PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-117">Although it is identified as MSOLAP.4 (the same version number used for [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]), this version does not work for PowerPivot data access.</span></span> <span data-ttu-id="7a4a1-118">Para que as conexões sejam bem-sucedidas, você deve ter a versão [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] ou [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] do provedor.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-118">In order for connections to succeed, you must have the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] or [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] version of the provider.</span></span>  
  
 <span data-ttu-id="7a4a1-119">Uma versão pós-[!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] do provedor OLE DB inclui transportes e suporte à conexão para estruturas de dados do [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7a4a1-119">A post [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] version of the OLE DB provider includes transports and connection support for [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] data structures.</span></span> <span data-ttu-id="7a4a1-120">As pastas de trabalho [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] usam versões mais novas desse provedor para solicitar processamento de consulta em servidores do [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] no farm.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-120">[!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] workbooks use newer versions of this provider to request query processing from [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] servers in the farm.</span></span> <span data-ttu-id="7a4a1-121">Para obter uma versão atualizada, você pode baixá-la e instalá-la diretamente de uma página do SQL Server Feature Pack.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-121">To get an updated version, you can download and install it through a SQL Server Feature Pack page.</span></span>  
  
 <span data-ttu-id="7a4a1-122">A tabela a seguir descreve as versões válidas:</span><span class="sxs-lookup"><span data-stu-id="7a4a1-122">The following table describes the valid versions:</span></span>  
  
|<span data-ttu-id="7a4a1-123">Versão do produto</span><span class="sxs-lookup"><span data-stu-id="7a4a1-123">Product version</span></span>|<span data-ttu-id="7a4a1-124">Versão do arquivo</span><span class="sxs-lookup"><span data-stu-id="7a4a1-124">File version</span></span>|<span data-ttu-id="7a4a1-125">Válida para:</span><span class="sxs-lookup"><span data-stu-id="7a4a1-125">Valid for:</span></span>|  
|---------------------|------------------|----------------|  
|[!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]|<span data-ttu-id="7a4a1-126">MSOLAP100.dll no sistema de arquivos</span><span class="sxs-lookup"><span data-stu-id="7a4a1-126">MSOLAP100.dll in the file system</span></span><br /><br /> <span data-ttu-id="7a4a1-127">MSOLAP.4 em uma cadeia de conexão do Excel</span><span class="sxs-lookup"><span data-stu-id="7a4a1-127">MSOLAP.4 in an Excel connection string</span></span><br /><br /> <span data-ttu-id="7a4a1-128">10.50.1600 ou posterior nos detalhes de versão do arquivo</span><span class="sxs-lookup"><span data-stu-id="7a4a1-128">10.50.1600 or later in file version details</span></span>|<span data-ttu-id="7a4a1-129">Use para modelos de dados criados usando a versão [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] do PowerPivot para Excel.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-129">Use for data models created using the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version of PowerPivot for Excel.</span></span>|  
|[!INCLUDE[ssSQL11](../../includes/sssql11-md.md)]|<span data-ttu-id="7a4a1-130">MSOLAP110.dll no sistema de arquivos</span><span class="sxs-lookup"><span data-stu-id="7a4a1-130">MSOLAP110.dll in the file system</span></span><br /><br /> <span data-ttu-id="7a4a1-131">MSOLAP.5 em uma cadeia de conexão do Excel</span><span class="sxs-lookup"><span data-stu-id="7a4a1-131">MSOLAP.5 in an Excel connection string</span></span><br /><br /> <span data-ttu-id="7a4a1-132">11.0.0000 ou posterior nos detalhes de versão do arquivo</span><span class="sxs-lookup"><span data-stu-id="7a4a1-132">11.0.0000 or later in file version details</span></span>|<span data-ttu-id="7a4a1-133">Use para modelos de dados criados usando a versão [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] ou [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] do [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] para Excel.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-133">Use for data models created using the [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] or [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] version of [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] for Excel.</span></span>|  
|[!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]|<span data-ttu-id="7a4a1-134">MSOLAP120.dll no sistema de arquivos</span><span class="sxs-lookup"><span data-stu-id="7a4a1-134">MSOLAP120.dll in the file system</span></span><br /><br /> <span data-ttu-id="7a4a1-135">12.0.20000 ou posterior nos detalhes de versão do arquivo</span><span class="sxs-lookup"><span data-stu-id="7a4a1-135">12.0.20000 or later in file version details</span></span>|<span data-ttu-id="7a4a1-136">Use para modelos de dados além dos modelos do [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7a4a1-136">Use for data models other than [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] models.</span></span>|  
  
  
##  <a name="why-you-need-to-install-the-ole-db-provider"></a><a name="bkmk_why"></a><span data-ttu-id="7a4a1-137">Por que você precisa instalar o provedor de OLE DB</span><span class="sxs-lookup"><span data-stu-id="7a4a1-137">Why you need to install the OLE DB Provider</span></span>  
 <span data-ttu-id="7a4a1-138">Há dois cenários que requerem a instalação manual do provedor OLE DB em servidores no farm.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-138">There are two scenarios that call for manually installing the OLE DB provider on servers in the farm.</span></span>  
  
 <span data-ttu-id="7a4a1-139">**O cenário mais comum** é quando você tem versões mais antigas e mais recentes de [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] pastas de trabalho que são salvas em bibliotecas de documentos no farm.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-139">**The most common scenario** is when you have older and newer versions of [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] workbooks that are saved in document libraries in the farm.</span></span> <span data-ttu-id="7a4a1-140">Se os analistas na sua organização estiverem usando a versão [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] do [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] para Excel e salvarem essas pastas de trabalho em uma instalação [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)][!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)], a pasta de trabalho mais antiga não funcionará.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-140">If analysts in your organization are using the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version of [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] for Excel, and they save those workbooks to a [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)][!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] installation, the older workbook will not work.</span></span> <span data-ttu-id="7a4a1-141">Sua cadeia de conexão fará referência a uma versão mais antiga do provedor, que não estará no servidor, a menos que você a instale.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-141">Its connection string will reference an older version of the provider, which won't be on the server unless you install it.</span></span> <span data-ttu-id="7a4a1-142">A instalação de ambas as versões habilitará o acesso a dados para pastas de trabalho PowerPivot criadas em versões mais antigas e mais novas do [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] para Excel.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-142">Installing both versions will enable data access for PowerPivot workbooks created in older and newer versions of [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] for Excel.</span></span> <span data-ttu-id="7a4a1-143">A Instalação do [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] não instala a versão [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] do provedor, portanto, você deverá instalá-la manualmente se estiver usando pastas de trabalho de uma versão anterior.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-143">[!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] Setup does not install the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version of the provider, so you must install it manually if you are using workbooks from a previous version.</span></span>  
  
 <span data-ttu-id="7a4a1-144">**O segundo cenário** é quando você tem um servidor em um farm do SharePoint que executa os serviços do Excel, mas não o [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="7a4a1-144">**The second scenario** is when you have a server in a SharePoint farm that runs Excel Services, but not [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)].</span></span> <span data-ttu-id="7a4a1-145">Nesse caso, o servidor de aplicativo que executa os Serviços do Excel deve ser atualizado manualmente para usar uma versão mais nova do provedor.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-145">In this case, the application server that runs Excel Services must be manually updated to use a newer version of the provider.</span></span> <span data-ttu-id="7a4a1-146">Isso é necessário para conectar-se a uma instância do PowerPivot para SharePoint.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-146">This is necessary for connecting to a PowerPivot for SharePoint instance.</span></span> <span data-ttu-id="7a4a1-147">Se os Serviços do Excel estiverem usando uma versão anterior do provedor, a solicitação de conexão falhará.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-147">If Excel Services is using an older version of the provider, the connection request will fail.</span></span> <span data-ttu-id="7a4a1-148">Observe que o provedor deve ser instalado com a instalação do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ou o pacote de instalação do [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] (spPowerPivot.msi) para se certificar de que todos os componentes que exigirem o suporte a [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] serão instalados.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-148">Note that the provider must be installed by using [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] setup or the [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] installation package (spPowerPivot.msi) in order to ensure that all components required support [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] are installed.</span></span>  
  
  
##  <a name="install-the-sql-server-2012-ole-db-provider-on-an-excel-services-server-by-using-sql-server-setup"></a><a name="bkmk_sql11"></a><span data-ttu-id="7a4a1-149">Instalar o provedor de OLE DB SQL Server 2012 em um servidor de serviços do Excel usando a instalação do SQL Server</span><span class="sxs-lookup"><span data-stu-id="7a4a1-149">Install the SQL Server 2012 OLE DB Provider on an Excel Services server by using SQL Server Setup</span></span>  
 <span data-ttu-id="7a4a1-150">Use as instruções a seguir para adicionar o provedor OLE DB e outros componentes de conectividade de cliente aos SharePoint Servers que ainda não tenham esse recurso instalado, como servidores de aplicativo que executem os Serviços do Excel sem o PowerPivot para SharePoint no mesmo hardware.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-150">Use the following instructions to add the OLE DB provider and other client connectivity components to SharePoint servers that do not already have them installed, such as application servers that run Excel Services without PowerPivot for SharePoint on the same hardware.</span></span>  
  
 <span data-ttu-id="7a4a1-151">Use estas instruções para instalar o provedor de OLE DB de Analysis Services atual e adicionar o **Microsoft.AnalysisServices.Xmla.dll** ao assembly global.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-151">Use these instructions to install the current Analysis Services OLE DB provider and to add the **Microsoft.AnalysisServices.Xmla.dll** to the global assembly.</span></span>  
  
#### <a name="run-sql-server-setup-and-install-the-client-connectivity-tools"></a><span data-ttu-id="7a4a1-152">Executar a instalação do SQL Server e instalar as Ferramentas de Conectividade de Cliente</span><span class="sxs-lookup"><span data-stu-id="7a4a1-152">Run SQL Server Setup and Install the Client Connectivity Tools</span></span>  
  
1.  <span data-ttu-id="7a4a1-153">No servidor de aplicativo que hospeda os Serviços do Excel, execute a instalação do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-153">On the application server that hosts Excel Services, run SQL Server Setup.</span></span>  
  
2.  <span data-ttu-id="7a4a1-154">Na página instalação, escolha **novo SQL Server instalação autônoma ou adicionar recursos a uma instalação existente**.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-154">On the Installation page, choose **New SQL Server stand-alone installation or add features to an existing installation**.</span></span>  
  
3.  <span data-ttu-id="7a4a1-155">Na página tipo de instalação, escolha **executar uma nova instalação do SQL Server 2012**.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-155">On the Installation Type page, choose **Perform a new installation of SQL Server 2012**.</span></span>  
  
4.  <span data-ttu-id="7a4a1-156">Na página função de instalação, escolha **SQL Server instalação de recurso**.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-156">On the Setup Role page, choose **SQL Server Feature Installation**.</span></span>  
  
5.  <span data-ttu-id="7a4a1-157">Na página **seleção de recursos** , clique em **conectividade de ferramentas de cliente**.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-157">On the **Feature Selection** page, click **Client Tools Connectivity**.</span></span> <span data-ttu-id="7a4a1-158">Esta opção instala **Microsoft.AnalysisServices.Xmla.dll**</span><span class="sxs-lookup"><span data-stu-id="7a4a1-158">This option installs **Microsoft.AnalysisServices.Xmla.dll**</span></span>  
  
     <span data-ttu-id="7a4a1-159">Não selecione nenhum outro recurso.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-159">Do not select any other features.</span></span>  
  
6.  <span data-ttu-id="7a4a1-160">Clique em **Avançar** para concluir o assistente e clique em **instalar** para executar a instalação.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-160">Click **Next** to finish the wizard, and then click **Install** to run Setup.</span></span>  
  
7.  <span data-ttu-id="7a4a1-161">Repita as etapas anteriores se você tiver outros servidores executando Serviços do Excel, sem uma instalação do PowerPivot para SharePoint no mesmo servidor.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-161">Repeat the previous steps if you have other servers running Excel Services, without a PowerPivot for SharePoint installation on the same server.</span></span>  
  
#### <a name="verify-msolap5-is-a-trusted-provider"></a><span data-ttu-id="7a4a1-162">Verifique se MSOLAP.5 é um provedor de confiança</span><span class="sxs-lookup"><span data-stu-id="7a4a1-162">Verify MSOLAP.5 is a trusted provider</span></span>  
  
1.  <span data-ttu-id="7a4a1-163">Na Administração Central, clique em **Gerenciar aplicativos de serviço**e clique no aplicativo de serviço de Serviços do Excel.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-163">In Central Administration, click **Manage service applications**, and then click the Excel Services service application.</span></span>  
  
2.  <span data-ttu-id="7a4a1-164">Clique em **Provedores de Dados Confiáveis**.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-164">Click **Trusted Data Providers**.</span></span>  
  
3.  <span data-ttu-id="7a4a1-165">Verifique se MSOLAP.5 aparece na lista.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-165">Verify that MSOLAP.5 appears in the list.</span></span> <span data-ttu-id="7a4a1-166">Dependendo do modo como você configurou o PowerPivot para SharePoint, o MSOLAP.5 talvez já seja confiável.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-166">Depending on how you configured PowerPivot for SharePoint, MSOLAP.5 might already be trusted.</span></span> <span data-ttu-id="7a4a1-167">Se você usasse a ferramenta de Configuração do PowerPivot, mas excluísse essa ação da lista de tarefas, o MSOLAP.5 não será confiável para os Serviços do Excel e deverá ser adicionado manualmente.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-167">If you used the PowerPivot Configuration tool, but then excluded this action from the task list, MSOLAP.5 will not be trusted by Excel Services and now needs to be added manually.</span></span>  
  
4.  <span data-ttu-id="7a4a1-168">Se o MSOLAP não estiver listado, clique em **adicionar provedor de dados confiáveis**.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-168">If MSOLAP is not listed, click **Add Trusted Data Provider**.</span></span>  
  
5.  <span data-ttu-id="7a4a1-169">Na ID do Provedor, digite `MSOLAP.5`.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-169">In Provider ID, type `MSOLAP.5`.</span></span>  
  
6.  <span data-ttu-id="7a4a1-170">Em Tipo de Provedor, verifique se a opção OLE DB está selecionada.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-170">For Provider Type, ensure that OLE DB is selected.</span></span>  
  
7.  <span data-ttu-id="7a4a1-171">Na Descrição do Provedor, digite **Microsoft OLE DB Provider for OLAP Services 11.0**.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-171">In Provider Description, type **Microsoft OLE DB Provider for OLAP Services 11.0**.</span></span>  
  
#### <a name="verify-installation"></a><span data-ttu-id="7a4a1-172">Verifique a instalação</span><span class="sxs-lookup"><span data-stu-id="7a4a1-172">Verify installation</span></span>  
  
1.  <span data-ttu-id="7a4a1-173">Vá para Arquivos de Programas\Microsoft Analysis Services\AS OLEDB\110.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-173">Go to Program files\Microsoft Analysis Services\AS OLEDB\110.</span></span>  
  
2.  <span data-ttu-id="7a4a1-174">Clique com o botão direito do mouse em msolap110.dll e selecione **Propriedades**.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-174">Right-click msolap110.dll and select **Properties**.</span></span>  
  
3.  <span data-ttu-id="7a4a1-175">Clique em **Detalhes**.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-175">Click **Details**.</span></span>  
  
4.  <span data-ttu-id="7a4a1-176">Exiba as informações de versão do arquivo.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-176">View the file version information.</span></span> <span data-ttu-id="7a4a1-177">A versão deve incluir 11, 0. \<buildnumber> .</span><span class="sxs-lookup"><span data-stu-id="7a4a1-177">The version should include 11.00.\<buildnumber>.</span></span>  
  
5.  <span data-ttu-id="7a4a1-178">Na pasta Windows\assembly, verifique se Microsoft.AnalysisServices.Xmla.dll, versão 11.0.0.0 está listado.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-178">In the Windows\assembly folder, verify that Microsoft.AnalysisServices.Xmla.dll, version 11.0.0.0, is listed.</span></span>  
  
  
##  <a name="use-the-powerpivot-for-sharepoint-installation-package-sppowerpivotmsi-to-install-the-sql-server-2012-ole-db-provider"></a><a name="bkmk_install2012_from_sppowerpivot_msi"></a><span data-ttu-id="7a4a1-179">Usar o spPowerPivot.msi (pacote de instalação do PowerPivot para SharePoint) para instalar o provedor de OLE DB do SQL Server 2012</span><span class="sxs-lookup"><span data-stu-id="7a4a1-179">Use the PowerPivot for SharePoint Installation package (spPowerPivot.msi) to install the SQL Server 2012 OLE DB Provider</span></span>  
 <span data-ttu-id="7a4a1-180">Instale o [!INCLUDE[ssSQL11SP1](../../includes/sssql11sp1-md.md)] provedor de OLE DB no e no servidor de serviços do Excel usando o [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] pacote de instalação **(spPowerPivot.msi)**.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-180">Install the [!INCLUDE[ssSQL11SP1](../../includes/sssql11sp1-md.md)] OLE DB Provider on and Excel Services Server by using the [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] installation package **(spPowerPivot.msi)**.</span></span>  
  
#### <a name="download-the-msolap5-provider-from-the-sssql11sp1-feature-pack"></a><span data-ttu-id="7a4a1-181">Baixe o provedor MSOLAP.5 do [!INCLUDE[ssSQL11SP1](../../includes/sssql11sp1-md.md)] Feature Pack.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-181">Download the MSOLAP.5 provider from the [!INCLUDE[ssSQL11SP1](../../includes/sssql11sp1-md.md)] Feature Pack.</span></span>  
  
1.  <span data-ttu-id="7a4a1-182">Navegue até [o Microsoft® SQL Server® 2012 SP1 Feature Pack](https://www.microsoft.com/download/details.aspx?id=35580)</span><span class="sxs-lookup"><span data-stu-id="7a4a1-182">Browse to [Microsoft® SQL Server® 2012 SP1 Feature Pack](https://www.microsoft.com/download/details.aspx?id=35580)</span></span>  
  
2.  <span data-ttu-id="7a4a1-183">Clique em **instruções de instalação**.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-183">Click **Install Instructions**.</span></span>  
  
3.  <span data-ttu-id="7a4a1-184">Consulte a seção "Provedor Microsoft Analysis Services OLE DB para Microsoft SQL Server 2012 SP1".</span><span class="sxs-lookup"><span data-stu-id="7a4a1-184">See the section "Microsoft Analysis Services OLE DB Provider for Microsoft SQL Server 2012 SP1".</span></span> <span data-ttu-id="7a4a1-185">Baixe o arquivo e inicie a instalação.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-185">Download the file and start the installation.</span></span>  
  
4.  <span data-ttu-id="7a4a1-186">Na página **seleção de recursos** , selecione **provedor Analysis Services OLE DB para SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-186">On the **Feature Selection** page, select **Analysis Services OLE DB Provider for SQL Server**.</span></span> <span data-ttu-id="7a4a1-187">Desmarque os outros componentes e conclua a instalação.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-187">Unselect the other components and complete the installation.</span></span> <span data-ttu-id="7a4a1-188">Para obter mais informações sobre spPowerPivot.msi, consulte [instalar ou desinstalar o suplemento PowerPivot para SharePoint &#40;SharePoint 2013&#41;](https://docs.microsoft.com/analysis-services/instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013).</span><span class="sxs-lookup"><span data-stu-id="7a4a1-188">For more information on spPowerPivot.msi, see [Install or Uninstall the PowerPivot for SharePoint Add-in &#40;SharePoint 2013&#41;](https://docs.microsoft.com/analysis-services/instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013).</span></span>  
  
5.  <span data-ttu-id="7a4a1-189">Registre o MSOLAP.5 como um provedor confiável em Serviços do Excel do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-189">Register MSOLAP.5 as a trusted provider with SharePoint Excel Services.</span></span> <span data-ttu-id="7a4a1-190">Para obter mais informações, consulte [Adicionar MSOLAP.5 como um provedor de dados confiável em Serviços do Excel](https://technet.microsoft.com/library/hh758436.aspx).</span><span class="sxs-lookup"><span data-stu-id="7a4a1-190">For more information, see [Add MSOLAP.5 as a Trusted Data Provider in Excel Services](https://technet.microsoft.com/library/hh758436.aspx).</span></span>  
  
  
##  <a name="install-the-sql-server-2008-r2-ole-db-provider-to-host-earlier-version-workbooks"></a><a name="bkmk_kj"></a><span data-ttu-id="7a4a1-191">Instalar o provedor de OLE DB SQL Server 2008 R2 para hospedar pastas de trabalho da versão anterior</span><span class="sxs-lookup"><span data-stu-id="7a4a1-191">Install the SQL Server 2008 R2 OLE DB Provider to host earlier version workbooks</span></span>  
 <span data-ttu-id="7a4a1-192">Use as instruções seguintes para instalar a versão [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] do provedor de MSOLAP.4 e registrar o arquivo Microsoft.AnalysisServices.ChannelTransport.dll arquivo.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-192">Use the following instructions to install the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version of the MSOLAP.4 provider, and register the Microsoft.AnalysisServices.ChannelTransport.dll file.</span></span> <span data-ttu-id="7a4a1-193">O ChannelTransport é um subcomponente do provedor OLE DB do Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-193">The ChannelTransport is a subcomponent of the Analysis Services OLE DB provider.</span></span> <span data-ttu-id="7a4a1-194">A versão [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] do provedor lê o registro ao usar ChannelTransport para fazer uma conexão.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-194">The [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version of the provider reads the registry when using ChannelTransport to make a connection.</span></span> <span data-ttu-id="7a4a1-195">Registrar esse arquivo é uma etapa pós-instalação necessária somente para conexões tratadas pelo provedor [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] em um servidor do [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7a4a1-195">Registering this file is a post-installation step required only for connections handled by the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] provider on a [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] server.</span></span>  
  
#### <a name="step-1-download-and-install-the-client-library"></a><span data-ttu-id="7a4a1-196">Etapa 1: baixar e instalar a biblioteca de cliente</span><span class="sxs-lookup"><span data-stu-id="7a4a1-196">Step 1: Download and install the client library</span></span>  
  
1.  <span data-ttu-id="7a4a1-197">Na [página SQL Server 2008 R2 Feature Pack](https://www.microsoft.com/download/details.aspx?id=44272), encontre provedor Microsoft Analysis Services OLE DB para Microsoft SQL Server 2008 R2.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-197">On the [SQL Server 2008 R2 Feature Pack page](https://www.microsoft.com/download/details.aspx?id=44272), find Microsoft Analysis Services OLE DB Provider for Microsoft SQL Server 2008 R2.</span></span>  
  
2.  <span data-ttu-id="7a4a1-198">Baixe o Pacote x64 do programa de instalação `SQLServer2008_ASOLEDB10.msi`.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-198">Download the x64 Package of the `SQLServer2008_ASOLEDB10.msi` installation program.</span></span> <span data-ttu-id="7a4a1-199">Embora o nome do arquivo contenha SQLServer2008, é o arquivo correto para a versão do SQL Server 2008 R2 do provedor.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-199">Although the file name contains SQLServer2008, it is the correct file for the SQL Server 2008 R2 version of the provider.</span></span>  
  
3.  <span data-ttu-id="7a4a1-200">No computador que tem uma instalação do [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)], execute o .msi para instalar a biblioteca.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-200">On the computer that has an installation of [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)], run the .msi to install the library.</span></span>  
  
4.  <span data-ttu-id="7a4a1-201">Se você houver outros servidores no farm que executam apenas os Serviços do Excel, sem o [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] no mesmo servidor, repetir as etapas anteriores para instalar a versão 2008 R2 do provedor no computador com Serviços do Excel.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-201">If you have other servers in the farm that run just Excel Services, without [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] on the same server, repeat the previous steps to install the 2008 R2 version of the provider on the Excel Services computer.</span></span>  
  
#### <a name="step-2-register-the-microsoftanalysisserviceschanneltransportdll-file"></a><span data-ttu-id="7a4a1-202">Etapa 2: registrar o arquivo Microsoft.AnalysisServices.ChannelTransport.dll</span><span class="sxs-lookup"><span data-stu-id="7a4a1-202">Step 2: Register the Microsoft.AnalysisServices.ChannelTransport.dll file</span></span>  
  
1.  <span data-ttu-id="7a4a1-203">Use o utilitário regasm.exe para registrar o arquivo.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-203">Use the regasm.exe utility to register the file.</span></span> <span data-ttu-id="7a4a1-204">Se você não tiver executado regasm.exe antes, adicione sua pasta pai, C:\Windows\Microsoft.NET\Framework64\v4.0.30319 \\ , à variável de caminho do sistema.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-204">If you have not run regasm.exe before, add its parent folder, C:\Windows\Microsoft.NET\Framework64\v4.0.30319\\, to the system path variable.</span></span>  
  
2.  <span data-ttu-id="7a4a1-205">Abra um prompt de comando com permissões de administrador.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-205">Open a command prompt with administrator permissions.</span></span>  
  
3.  <span data-ttu-id="7a4a1-206">Vá para esta pasta C: \Windows\assembly\GAC_MSIL\Microsoft.AnalysisServices.ChannelTransport\10.0.0.0__89845dcd8080cc91</span><span class="sxs-lookup"><span data-stu-id="7a4a1-206">Go to this folder C:\Windows\assembly\GAC_MSIL\Microsoft.AnalysisServices.ChannelTransport\10.0.0.0__89845dcd8080cc91</span></span>  
  
4.  <span data-ttu-id="7a4a1-207">Digite o seguinte comando: `regasm microsoft.analysisservices.channeltransport.dll`</span><span class="sxs-lookup"><span data-stu-id="7a4a1-207">Enter the following command: `regasm microsoft.analysisservices.channeltransport.dll`</span></span>  
  
5.  <span data-ttu-id="7a4a1-208">Repita as etapas anteriores para qualquer computador no qual você instalou a versão 2008 R2 do provedor manualmente.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-208">Repeat the previous steps for any computer on which you manually installed the 2008 R2 version of the provider.</span></span>  
  
#### <a name="verify-installation"></a><span data-ttu-id="7a4a1-209">Verifique a instalação</span><span class="sxs-lookup"><span data-stu-id="7a4a1-209">Verify installation</span></span>  
  
1.  <span data-ttu-id="7a4a1-210">Agora você já deve poder dividir ou filtrar pastas de trabalho do [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7a4a1-210">You should now be able to slice or filter [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] workbooks.</span></span> <span data-ttu-id="7a4a1-211">Se um erro ocorrer, verifique se você usou a versão de 64 bits de regasm.exe para registrar o arquivo.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-211">If an error occurs, verify that you used the 64-bit version of regasm.exe to register the file.</span></span>  
  
2.  <span data-ttu-id="7a4a1-212">Além disso você pode verificar a versão de arquivo.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-212">Additionally, you can check the file version.</span></span>  
  
     <span data-ttu-id="7a4a1-213">Acesse `C:\Program files\Microsoft Analysis Services\AS OLEDB\10`.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-213">Go to `C:\Program files\Microsoft Analysis Services\AS OLEDB\10`.</span></span> <span data-ttu-id="7a4a1-214">Clique com o botão direito do mouse em **msolap100.dll** e selecione **Propriedades**.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-214">Right-click **msolap100.dll** and select **Properties**.</span></span> <span data-ttu-id="7a4a1-215">Clique em **Detalhes**.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-215">Click **Details**.</span></span>  
  
     <span data-ttu-id="7a4a1-216">Exiba as informações de versão do arquivo.</span><span class="sxs-lookup"><span data-stu-id="7a4a1-216">View the file version information.</span></span> <span data-ttu-id="7a4a1-217">A versão deve incluir 10,50. \<buildnumber> .</span><span class="sxs-lookup"><span data-stu-id="7a4a1-217">The version should include 10.50.\<buildnumber>.</span></span>  
  
  
## <a name="see-also"></a><span data-ttu-id="7a4a1-218">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="7a4a1-218">See Also</span></span>  
 [<span data-ttu-id="7a4a1-219">Instalação do PowerPivot para SharePoint 2010</span><span class="sxs-lookup"><span data-stu-id="7a4a1-219">PowerPivot for SharePoint 2010 Installation</span></span>](../../../2014/sql-server/install/powerpivot-for-sharepoint-2010-installation.md)  
  
  
