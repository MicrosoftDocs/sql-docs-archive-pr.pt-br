---
title: Renomear uma instância do cluster de failover do SQL Server | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: install
ms.topic: conceptual
helpviewer_keywords:
- clusters [SQL Server], virtual servers
- renaming virtual servers
- virtual servers [SQL Server], failover clustering
- failover clustering [SQL Server], virtual servers
ms.assetid: 2a49d417-25fb-4760-8ae5-5871bfb1e6f3
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 397e36931e446861db0fcb899cad30e8c7b1ffc2
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87573593"
---
# <a name="rename-a-sql-server-failover-cluster-instance"></a><span data-ttu-id="bdd63-102">Renomear uma instância do cluster de failover do SQL Server</span><span class="sxs-lookup"><span data-stu-id="bdd63-102">Rename a SQL Server Failover Cluster Instance</span></span>
  <span data-ttu-id="bdd63-103">Quando uma instância do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] fizer parte de um cluster de failover, o processo de renomeação do servidor virtual diferirá da renomeação de uma instância autônoma.</span><span class="sxs-lookup"><span data-stu-id="bdd63-103">When a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance is part of a failover cluster, the process of renaming the virtual server differs from that of renaming a stand-alone instance.</span></span> <span data-ttu-id="bdd63-104">Para obter mais informações, consulte [Renomear um computador que hospeda uma instância autônoma do SQL Server](../../../database-engine/install-windows/rename-a-computer-that-hosts-a-stand-alone-instance-of-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="bdd63-104">For more information, see [Rename a Computer that Hosts a Stand-Alone Instance of SQL Server](../../../database-engine/install-windows/rename-a-computer-that-hosts-a-stand-alone-instance-of-sql-server.md).</span></span>  
  
 <span data-ttu-id="bdd63-105">O nome do servidor virtual sempre será igual ao nome do Nome de Rede do SQL (o Nome de Rede do Servidor Virtual SQL).</span><span class="sxs-lookup"><span data-stu-id="bdd63-105">The name of the virtual server is always the same as the name of the SQL Network Name (the SQL Virtual Server Network Name).</span></span> <span data-ttu-id="bdd63-106">Embora você possa alterar o nome do servidor virtual, você não pode alterar o nome da instância.</span><span class="sxs-lookup"><span data-stu-id="bdd63-106">Although you can change the name of the virtual server, you cannot change the instance name.</span></span> <span data-ttu-id="bdd63-107">Por exemplo, você pode alterar um servidor virtual chamado VS1\instance1 para algum outro nome, como SQL35\instance1, mas a parte da instância do nome, instance1, permanecerá inalterada.</span><span class="sxs-lookup"><span data-stu-id="bdd63-107">For example, you can change a virtual server named VS1\instance1 to some other name, such as SQL35\instance1, but the instance portion of the name, instance1, will remain unchanged.</span></span>  
  
 <span data-ttu-id="bdd63-108">Antes de começar o processo de renomeação, revise os itens a seguir.</span><span class="sxs-lookup"><span data-stu-id="bdd63-108">Before you begin the renaming process, review the items below.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="bdd63-109">não dá suporte à renomeação de servidores envolvidos na replicação, exceto no caso de uso de envio de logs com a replicação.</span><span class="sxs-lookup"><span data-stu-id="bdd63-109">does not support renaming servers involved in replication, except in the case of using log shipping with replication.</span></span> <span data-ttu-id="bdd63-110">O servidor secundário no envio de logs poderá ser renomeado se o servidor primário for permanentemente perdido.</span><span class="sxs-lookup"><span data-stu-id="bdd63-110">The secondary server in log shipping can be renamed if the primary server is permanently lost.</span></span> <span data-ttu-id="bdd63-111">Para obter mais informações, veja [Replicação e envio de logs &#40;SQL Server&#41;](../../../database-engine/log-shipping/log-shipping-and-replication-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="bdd63-111">For more information, see [Log Shipping and Replication &#40;SQL Server&#41;](../../../database-engine/log-shipping/log-shipping-and-replication-sql-server.md).</span></span>  
  
-   <span data-ttu-id="bdd63-112">Quando você renomear um servidor virtual que está configurado para usar espelhamento de banco de dados, deverá desativar o espelhamento de banco de dados antes da operação de renomeação e, em seguida, restabelecer o espelhamento do banco de dados com o novo nome do servidor virtual.</span><span class="sxs-lookup"><span data-stu-id="bdd63-112">When renaming a virtual server that is configured to use database mirroring, you must turn off database mirroring before the renaming operation, and then re-establish database mirroring with the new virtual server name.</span></span> <span data-ttu-id="bdd63-113">Os metadados do espelhamento de banco de dados não serão atualizados automaticamente para refletir o novo nome do servidor virtual.</span><span class="sxs-lookup"><span data-stu-id="bdd63-113">Metadata for database mirroring will not be updated automatically to reflect the new virtual server name.</span></span>  
  
### <a name="to-rename-a-virtual-server"></a><span data-ttu-id="bdd63-114">Para renomear um servidor virtual</span><span class="sxs-lookup"><span data-stu-id="bdd63-114">To rename a virtual server</span></span>  
  
1.  <span data-ttu-id="bdd63-115">Usando o Cluster Administrator, altere o Nome de Rede do SQL para um novo nome.</span><span class="sxs-lookup"><span data-stu-id="bdd63-115">Using Cluster Administrator, change the SQL Network Name to the new name.</span></span>  
  
2.  <span data-ttu-id="bdd63-116">Coloque o recurso de nome de rede offline.</span><span class="sxs-lookup"><span data-stu-id="bdd63-116">Take the network name resource offline.</span></span> <span data-ttu-id="bdd63-117">Isso coloca o recurso do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] e também outros recursos dependentes offline.</span><span class="sxs-lookup"><span data-stu-id="bdd63-117">This takes the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] resource and other dependent resources offline as well.</span></span>  
  
3.  <span data-ttu-id="bdd63-118">Coloque o recurso do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] online novamente.</span><span class="sxs-lookup"><span data-stu-id="bdd63-118">Bring the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] resource back online.</span></span>  
  
## <a name="verify-the-renaming-operation"></a><span data-ttu-id="bdd63-119">Verificar a operação de renomeação</span><span class="sxs-lookup"><span data-stu-id="bdd63-119">Verify the Renaming Operation</span></span>  
 <span data-ttu-id="bdd63-120">Depois que um servidor virtual for renomeado, quaisquer conexões que usavam o nome antigo do computador agora deverão ser conectadas usando o novo nome.</span><span class="sxs-lookup"><span data-stu-id="bdd63-120">After a virtual server has been renamed, any connections that used the old name must now connect using the new name.</span></span>  
  
 <span data-ttu-id="bdd63-121">Para verificar se a operação de renomeação foi concluída, selecione informações de `@@servername` ou `sys.servers`.</span><span class="sxs-lookup"><span data-stu-id="bdd63-121">To verify that the renaming operation has completed, select information from either `@@servername` or `sys.servers`.</span></span> <span data-ttu-id="bdd63-122">A função `@@servername` retornará o nome do novo servidor virtual, e a tabela `sys.servers` mostrará o nome do novo servidor virtual.</span><span class="sxs-lookup"><span data-stu-id="bdd63-122">The `@@servername` function will return the new virtual server name, and the `sys.servers` table will show the new virtual server name.</span></span> <span data-ttu-id="bdd63-123">Para verificar se o processo de failover está funcionando corretamente com o novo nome, o usuário também deve tentar fazer com o que o recurso do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] falhe nos outros nós.</span><span class="sxs-lookup"><span data-stu-id="bdd63-123">To verify that the failover process is working correctly with the new name, the user should also try to fail the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] resource over to the other nodes.</span></span>  
  
 <span data-ttu-id="bdd63-124">Para as conexões de qualquer nó no cluster, o novo nome poderá ser usado quase imediatamente.</span><span class="sxs-lookup"><span data-stu-id="bdd63-124">For connections from any node in the cluster, the new name can be used almost immediately.</span></span> <span data-ttu-id="bdd63-125">No entanto, para as conexões que usam o novo nome de um computador cliente, o novo nome não poderá ser usado para se conectar ao servidor até que o novo nome esteja visível para aquele computador cliente.</span><span class="sxs-lookup"><span data-stu-id="bdd63-125">However, for connections using the new name from a client computer, the new name cannot be used to connect to the server until the new name is visible to that client computer.</span></span> <span data-ttu-id="bdd63-126">O tempo necessário para que o novo nome seja propagado por uma rede pode ser de alguns segundos ou de 3 a 5 minutos, dependendo da configuração da rede; poderá ser necessário mais tempo antes de o nome antigo do servidor virtual não estar mais visível na rede.</span><span class="sxs-lookup"><span data-stu-id="bdd63-126">The length of time required for the new name to be propagated across a network can be a few seconds, or as long as 3 to 5 minutes, depending on the network configuration; additional time may be required before the old virtual server name is no longer visible on the network.</span></span>  
  
 <span data-ttu-id="bdd63-127">Para minimizar o atraso de propagação de rede de um servidor virtual que está renomeando a operação, use as etapas a seguir:</span><span class="sxs-lookup"><span data-stu-id="bdd63-127">To minimize network propagation delay of a virtual server renaming operation, use the following steps:</span></span>  
  
#### <a name="to-minimize-network-propagation-delay"></a><span data-ttu-id="bdd63-128">Para minimizar o atraso de propagação de rede</span><span class="sxs-lookup"><span data-stu-id="bdd63-128">To minimize network propagation delay</span></span>  
  
1.  <span data-ttu-id="bdd63-129">Emita os comandos a seguir a partir de um prompt de comando no nó de servidor:</span><span class="sxs-lookup"><span data-stu-id="bdd63-129">Issue the following commands from a command prompt on the server node:</span></span>  
  
    ```  
    ipconfig /flushdns  
    ipconfig /registerdns  
    nbtstat -RR  
    ```  
  
## <a name="additional-considerations-after-the-renaming-operation"></a><span data-ttu-id="bdd63-130">Considerações adicionais depois da operação de renomeação</span><span class="sxs-lookup"><span data-stu-id="bdd63-130">Additional considerations after the Renaming Operation</span></span>  
 <span data-ttu-id="bdd63-131">Depois de renomearmos o nome de rede do cluster de failover, precisamos verificar e executar as instruções a seguir para habilitar todos os cenários no [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent e [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="bdd63-131">After we rename the network name of failover cluster we need to verify and perform the following instructions to enable all scenarios in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent and [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="bdd63-132">\*\* [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] :\*\* Depois de alterar o nome de rede de uma [!INCLUDE[ssASCurrent](../../../includes/ssascurrent-md.md)] instância de cluster de failover usando a ferramenta Administrador de cluster do Windows, a atualização futura ou a operação de desinstalação poderá falhar.</span><span class="sxs-lookup"><span data-stu-id="bdd63-132">**[!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)]:** After you change the network name of a [!INCLUDE[ssASCurrent](../../../includes/ssascurrent-md.md)] failover cluster instance using Windows Cluster Administrator tool, the future upgrade or uninstall operation might fail.</span></span> <span data-ttu-id="bdd63-133">Para resolver esse problema, atualize a [entrada do registro](https://go.microsoft.com/fwlink/?LinkId=244002) **ClusterName** seguindo as instruções na seção de resolução deste ( https://go.microsoft.com/fwlink/?LinkId=244002) .</span><span class="sxs-lookup"><span data-stu-id="bdd63-133">To resolve this issue update the **ClusterName** registry entry following the instructions in the resolution section of [this](https://go.microsoft.com/fwlink/?LinkId=244002) (https://go.microsoft.com/fwlink/?LinkId=244002).</span></span>  
  
 <span data-ttu-id="bdd63-134">\*\* [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Serviço do agente:\*\* Verifique e execute as ações adicionais abaixo para [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Serviço do agente:</span><span class="sxs-lookup"><span data-stu-id="bdd63-134">**[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent Service:** Verify and perform the below additional actions for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent Service:</span></span>  
  
-   <span data-ttu-id="bdd63-135">Corrija as configurações do Registro se o SQL Agent estiver configurado para encaminhamento de evento.</span><span class="sxs-lookup"><span data-stu-id="bdd63-135">Fix the registry settings if SQL Agent is configured for event forwarding.</span></span> <span data-ttu-id="bdd63-136">Para obter mais informações, consulte [Designar um servidor de encaminhamento de eventos &#40;SQL Server Management Studio&#41;](../../../ssms/agent/designate-an-events-forwarding-server-sql-server-management-studio.md).</span><span class="sxs-lookup"><span data-stu-id="bdd63-136">For more information, see [Designate an Events Forwarding Server &#40;SQL Server Management Studio&#41;](../../../ssms/agent/designate-an-events-forwarding-server-sql-server-management-studio.md).</span></span>  
  
-   <span data-ttu-id="bdd63-137">Corrija o servidor mestre (MSX) e os nomes de instância de servidores de destino (TSX) quando os nomes dos computadores e da rede de cluster forem renomeados.</span><span class="sxs-lookup"><span data-stu-id="bdd63-137">Fix the master server (MSX) and target servers (TSX) instance names when machines / cluster network name is renamed.</span></span> <span data-ttu-id="bdd63-138">Para obter mais informações, consulte estes tópicos:</span><span class="sxs-lookup"><span data-stu-id="bdd63-138">For more information, see the following topics:</span></span>  
  
    -   [<span data-ttu-id="bdd63-139">Remover vários servidores de destino de um servidor mestre</span><span class="sxs-lookup"><span data-stu-id="bdd63-139">Defect Multiple Target Servers from a Master Server</span></span>](../../../ssms/agent/defect-multiple-target-servers-from-a-master-server.md)  
  
    -   [<span data-ttu-id="bdd63-140">Criar um ambiente multisservidor</span><span class="sxs-lookup"><span data-stu-id="bdd63-140">Create a Multiserver Environment</span></span>](../../../ssms/agent/create-a-multiserver-environment.md)  
  
-   <span data-ttu-id="bdd63-141">Reconfigure o envio de logs para que o nome de servidor atualizado seja usado para fazer backup e restaurar logs.</span><span class="sxs-lookup"><span data-stu-id="bdd63-141">Reconfigure the Log Shipping so that updated server name is used to backup and restore logs.</span></span> <span data-ttu-id="bdd63-142">Para obter mais informações, consulte estes tópicos:</span><span class="sxs-lookup"><span data-stu-id="bdd63-142">For more information, see the following topics:</span></span>  
  
    -   [<span data-ttu-id="bdd63-143">Configurar o envio de logs &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="bdd63-143">Configure Log Shipping &#40;SQL Server&#41;</span></span>](../../../database-engine/log-shipping/configure-log-shipping-sql-server.md)  
  
    -   [<span data-ttu-id="bdd63-144">Remover envio de log &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="bdd63-144">Remove Log Shipping &#40;SQL Server&#41;</span></span>](../../../database-engine/log-shipping/remove-log-shipping-sql-server.md)  
  
-   <span data-ttu-id="bdd63-145">Atualize o Jobsteps que depende do nome do servidor.</span><span class="sxs-lookup"><span data-stu-id="bdd63-145">Update the Jobsteps that depend on server name.</span></span> <span data-ttu-id="bdd63-146">Para obter mais informações, consulte [Gerenciar etapas de trabalho](../../../ssms/agent/manage-job-steps.md).</span><span class="sxs-lookup"><span data-stu-id="bdd63-146">For more information, see [Manage Job Steps](../../../ssms/agent/manage-job-steps.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="bdd63-147">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="bdd63-147">See Also</span></span>  
 [<span data-ttu-id="bdd63-148">Renomear um computador que hospeda uma instância autônoma do SQL Server</span><span class="sxs-lookup"><span data-stu-id="bdd63-148">Rename a Computer that Hosts a Stand-Alone Instance of SQL Server</span></span>](../../../database-engine/install-windows/rename-a-computer-that-hosts-a-stand-alone-instance-of-sql-server.md)  
  
  
