---
title: Instâncias do cluster de failover do AlwaysOn (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- clustering [SQL Server]
- high availability [SQL Server], failover clustering
- virtual servers [SQL Server], about virtual servers
- clusters [SQL Server]
- servers [SQL Server], failover clustering
- resource groups [SQL Server]
- availability [SQL Server]
- failover clustering [SQL Server]
- AlwaysOn [SQL Server], see failover clustering [SQL Server]
ms.assetid: 86a15b33-4d03-4549-8ea2-b45e4f1baad7
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 6adc173560fd83d00616eb00c63651ef667c2a00
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87573579"
---
# <a name="always-on-failover-cluster-instances-sql-server"></a><span data-ttu-id="e956f-102">Instâncias do cluster de failover do AlwaysOn (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="e956f-102">Always On Failover Cluster Instances (SQL Server)</span></span>
  <span data-ttu-id="e956f-103">Como parte da [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] oferta de Always on, always on instâncias de cluster de failover aproveitam a funcionalidade WSFC (Windows Server failover clustering) para fornecer alta disponibilidade local por meio de redundância no nível de instância de servidor-uma FCI ( *instância de cluster de failover* ).</span><span class="sxs-lookup"><span data-stu-id="e956f-103">As part of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Always On offering, Always On Failover Cluster Instances leverages Windows Server Failover Clustering (WSFC) functionality to provide local high availability through redundancy at the server-instance level-a *failover cluster instance* (FCI).</span></span> <span data-ttu-id="e956f-104">Uma FCI é uma instância única do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] que é instalada em nós de WSFC (Windows Server Failover Clustering) e, possivelmente, em várias sub-redes.</span><span class="sxs-lookup"><span data-stu-id="e956f-104">An FCI is a single instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] that is installed across Windows Server Failover Clustering (WSFC) nodes and, possibly, across multiple subnets.</span></span> <span data-ttu-id="e956f-105">Na rede, uma FCI aparece ser uma instância do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] sendo executada em um único computador, mas proporciona failover de um nó do WSFC para outro se o nó atual se tornar indisponível.</span><span class="sxs-lookup"><span data-stu-id="e956f-105">On the network, an FCI appears to be an instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] running on a single computer, but the FCI provides failover from one WSFC node to another if the current node becomes unavailable.</span></span>  
  
 <span data-ttu-id="e956f-106">Uma FCI pode aproveitar os [Grupos de disponibilidade AlwaysOn](../../../database-engine/availability-groups/windows/always-on-availability-groups-sql-server.md)para oferecer recuperação remota de desastre no nível do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e956f-106">An FCI can leverage [Always On Availability Groups](../../../database-engine/availability-groups/windows/always-on-availability-groups-sql-server.md)to provide remote disaster recovery at the database level.</span></span> <span data-ttu-id="e956f-107">Para obter mais informações, consulte [Clustering de failover e Grupos de Disponibilidade AlwaysOn (;SQL Server);](../../../database-engine/availability-groups/windows/failover-clustering-and-always-on-availability-groups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="e956f-107">For more information, see [Failover Clustering and Always On Availability Groups (;SQL Server);](../../../database-engine/availability-groups/windows/failover-clustering-and-always-on-availability-groups-sql-server.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e956f-108">A partir do [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)], as Instâncias de Cluster de Failover do AlwaysOn dão suporte a CSV (Volumes Compartilhados Clusterizados) no [!INCLUDE[winserver2008r2](../../../includes/winserver2008r2-md.md)] e no [!INCLUDE[win8srv](../../../includes/win8srv-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e956f-108">Beginning in [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)], Always On Failover Cluster Instances supports Clustered Shared Volumes (CSV) in both [!INCLUDE[winserver2008r2](../../../includes/winserver2008r2-md.md)] and [!INCLUDE[win8srv](../../../includes/win8srv-md.md)].</span></span> <span data-ttu-id="e956f-109">Para obter mais informações sobre CSV, consulte [Noções básicas sobre volumes compartilhados clusterizados em um cluster de failover](https://technet.microsoft.com/library/dd759255.aspx).</span><span class="sxs-lookup"><span data-stu-id="e956f-109">For more information on CSV, see [Understanding Cluster Shared Volumes in a Failover Cluster](https://technet.microsoft.com/library/dd759255.aspx).</span></span>  
  
 <span data-ttu-id="e956f-110">**Neste tópico:**</span><span class="sxs-lookup"><span data-stu-id="e956f-110">**In this Topic:**</span></span>  
  
-   [<span data-ttu-id="e956f-111">Benefícios</span><span class="sxs-lookup"><span data-stu-id="e956f-111">Benefits</span></span>](#Benefits)  
  
-   [<span data-ttu-id="e956f-112">Recomendações</span><span class="sxs-lookup"><span data-stu-id="e956f-112">Recommendations</span></span>](#Recommendations)  
  
-   [<span data-ttu-id="e956f-113">Visão geral da instância de cluster de failover</span><span class="sxs-lookup"><span data-stu-id="e956f-113">Failover Cluster Instance Overview</span></span>](#Overview)  
  
-   [<span data-ttu-id="e956f-114">Elementos de uma instância de cluster de failover</span><span class="sxs-lookup"><span data-stu-id="e956f-114">Elements of a Failover Cluster Instance</span></span>](#FCIelements)  
  
-   [<span data-ttu-id="e956f-115">Conceitos e tarefas de SQL Server failover</span><span class="sxs-lookup"><span data-stu-id="e956f-115">SQL Server Failover Concepts and Tasks</span></span>](#ConceptsAndTasks)  
  
-   [<span data-ttu-id="e956f-116">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="e956f-116">Related Topics</span></span>](#RelatedTopics)  
  
##  <a name="benefits-of-a-failover-cluster-instance"></a><a name="Benefits"></a> <span data-ttu-id="e956f-117">Benefícios de uma instância de cluster de failover</span><span class="sxs-lookup"><span data-stu-id="e956f-117">Benefits of a Failover Cluster Instance</span></span>  
 <span data-ttu-id="e956f-118">Quando há falha de hardware ou de software de um servidor, os aplicativos ou clientes que conectam ao servidor enfrentam um tempo de inatividade.</span><span class="sxs-lookup"><span data-stu-id="e956f-118">When there is hardware or software failure of a server, the applications or clients connecting to the server will experience downtime.</span></span> <span data-ttu-id="e956f-119">Quando uma instância do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] é configurada para ser uma FCI (em vez de uma instância autônoma), a alta disponibilidade dessa instância do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] é protegida pela presença de nós redundantes na FCI.</span><span class="sxs-lookup"><span data-stu-id="e956f-119">When a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance is configured to be an FCI (instead of a standalone instance), the high availability of that [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance is protected by the presence of redundant nodes in the FCI.</span></span> <span data-ttu-id="e956f-120">Somente um dos nós na FCI tem o grupo de recursos do WSFC de cada vez.</span><span class="sxs-lookup"><span data-stu-id="e956f-120">Only one of the nodes in the FCI owns the WSFC resource group at a time.</span></span> <span data-ttu-id="e956f-121">No caso de uma falha (problemas de hardware, falhas de sistema operacional, aplicativo ou falhas de serviço) ou de uma atualização planejada, a propriedade do grupo de recursos é movida para outro nó do WSFC.</span><span class="sxs-lookup"><span data-stu-id="e956f-121">In case of a failure (hardware failures, operating system failures, application or service failures), or a planned upgrade, the resource group ownership is moved to another WSFC node.</span></span> <span data-ttu-id="e956f-122">Este processo é transparente ao cliente ou aplicativo que se conecta ao [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] e isso minimiza o tempo de inatividade pelo qual passa o aplicativo ou os clientes durante uma falha.</span><span class="sxs-lookup"><span data-stu-id="e956f-122">This process is transparent to the client or application connecting to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] and this minimize the downtime the application or clients experience during a failure.</span></span> <span data-ttu-id="e956f-123">Alguns dos principais benefícios que instâncias de cluster de failover do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] oferecem:</span><span class="sxs-lookup"><span data-stu-id="e956f-123">The following lists some key benefits that [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover cluster instances provide:</span></span>  
  
-   <span data-ttu-id="e956f-124">Proteção em nível de instância por redundância</span><span class="sxs-lookup"><span data-stu-id="e956f-124">Protection at the instance level through redundancy</span></span>  
  
-   <span data-ttu-id="e956f-125">Failover automático no caso de uma falha (problemas de hardware, falhas de sistema operacional, aplicativo ou falhas de serviço)</span><span class="sxs-lookup"><span data-stu-id="e956f-125">Automatic failover in the event of a failure (hardware failures, operating system failures, application or service failures)</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="e956f-126">Em um grupo de disponibilidade AlwaysOn, não há suporte ao failover automático em uma FCI para outros nós no grupo de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="e956f-126">In an Always On availability group, automatic failover from an FCI to other nodes within the availability group is not supported.</span></span> <span data-ttu-id="e956f-127">Isto significa que os nós das FCIs e autônomos não deverão ser acoplados dentro de um grupo de disponibilidade se o failover automático for um componente importante de sua solução de alta disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="e956f-127">This means that FCIs and standalone nodes should not be coupled together within an availability group if automatic failover is an important component your high availability solution.</span></span> <span data-ttu-id="e956f-128">Porém, este acoplamento pode ser feito para sua solução de *recuperação de desastres* .</span><span class="sxs-lookup"><span data-stu-id="e956f-128">However, this coupling can be made for your *disaster recovery* solution.</span></span>  
  
-   <span data-ttu-id="e956f-129">Suporte para uma matriz ampla de soluções de armazenamento, inclusive discos de cluster do WSFC (iSCSI, Fiber Channel e assim por diante) e compartilhamentos de arquivos de protocolo SMB.</span><span class="sxs-lookup"><span data-stu-id="e956f-129">Support for a broad array of storage solutions, including WSFC cluster disks (iSCSI, Fiber Channel, and so on) and server message block (SMB) file shares.</span></span>  
  
-   <span data-ttu-id="e956f-130">Solução de recuperação de desastres que usa uma FCI de várias sub-redes ou executa um banco de dados hospedado por FCI em um grupo de disponibilidade AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="e956f-130">Disaster recovery solution using a multi-subnet FCI or running an FCI-hosted database inside an Always On availability group.</span></span> <span data-ttu-id="e956f-131">Com o novo suporte a várias sub-redes no [!INCLUDE[msCoName](../../../includes/msconame-md.md)][!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)], uma FCI de várias sub-redes não mais exigirá uma LAN virtual, aumentando a capacidade de gerenciamento e a segurança de uma FCI de várias sub-redes.</span><span class="sxs-lookup"><span data-stu-id="e956f-131">With the new multi-subnet support in [!INCLUDE[msCoName](../../../includes/msconame-md.md)][!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)], a multi-subnet FCI no longer requires a virtual LAN, increasing the manageability and security of a multi-subnet FCI.</span></span>  
  
-   <span data-ttu-id="e956f-132">Zero reconfiguração de aplicativos e clientes durante failovers</span><span class="sxs-lookup"><span data-stu-id="e956f-132">Zero reconfiguration of applications and clients during failovers</span></span>  
  
-   <span data-ttu-id="e956f-133">Política de failover flexível para eventos de gatilho granulares para failovers automáticos</span><span class="sxs-lookup"><span data-stu-id="e956f-133">Flexible failover policy for granular trigger events for automatic failovers</span></span>  
  
-   <span data-ttu-id="e956f-134">Failovers confiáveis por meio de detecção de integridade periódica e detalhada usando conexões dedicadas e persistidas</span><span class="sxs-lookup"><span data-stu-id="e956f-134">Reliable failovers through periodic and detailed health detection using dedicated and persisted connections</span></span>  
  
-   <span data-ttu-id="e956f-135">Capacidade de configuração e previsibilidade em tempo de failover por meio de pontos de verificação indiretos em segundo plano</span><span class="sxs-lookup"><span data-stu-id="e956f-135">Configurability and predictability in failover time through indirect background checkpoints</span></span>  
  
-   <span data-ttu-id="e956f-136">Uso acelerado de recurso durante failovers</span><span class="sxs-lookup"><span data-stu-id="e956f-136">Throttled resource usage during failovers</span></span>  
  
##  <a name="recommendations"></a><a name="Recommendations"></a> <span data-ttu-id="e956f-137">Recomendações</span><span class="sxs-lookup"><span data-stu-id="e956f-137">Recommendations</span></span>  
 <span data-ttu-id="e956f-138">Em um ambiente de produção, é recomendável usar endereços IP estáticos juntamente com o endereço IP virtual de uma instância de cluster de failover.</span><span class="sxs-lookup"><span data-stu-id="e956f-138">In a production environment, we recommend that you use static IP addresses in conjunction the virtual IP address of a Failover Cluster Instance.</span></span>  <span data-ttu-id="e956f-139">Não é recomendável o uso do DHCP em um ambiente de produção.</span><span class="sxs-lookup"><span data-stu-id="e956f-139">We recommend against using DHCP in a production environment.</span></span> <span data-ttu-id="e956f-140">No caso de tempo de inatividade, se a concessão do IP DHCP expirar, será necessário tempo adicional para registrar novamente o endereço IP DHCP novo associado ao nome DNS.</span><span class="sxs-lookup"><span data-stu-id="e956f-140">In the event of down time, if the DHCP IP lease expires, extra time is required to re-register the new DHCP IP address associated with the DNS name.</span></span>  
  
##  <a name="failover-cluster-instance-overview"></a><a name="Overview"></a><span data-ttu-id="e956f-141">Visão geral da instância de cluster de failover</span><span class="sxs-lookup"><span data-stu-id="e956f-141">Failover Cluster Instance Overview</span></span>  
 <span data-ttu-id="e956f-142">Uma FCI é executada em um grupo de recursos do WSFC com um ou mais nós do WSFC.</span><span class="sxs-lookup"><span data-stu-id="e956f-142">An FCI runs in a WSFC resource group with one or more WSFC nodes.</span></span> <span data-ttu-id="e956f-143">Quando a FCI é iniciada, um dos nós assume a propriedade do grupo de recursos e coloca sua instância do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] online.</span><span class="sxs-lookup"><span data-stu-id="e956f-143">When the FCI starts up, one of the nodes assume ownership of the resource group and brings its [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance online.</span></span> <span data-ttu-id="e956f-144">Os recursos de propriedade deste nó incluem:</span><span class="sxs-lookup"><span data-stu-id="e956f-144">The resources owned by this node include:</span></span>  
  
-   <span data-ttu-id="e956f-145">Nome da rede</span><span class="sxs-lookup"><span data-stu-id="e956f-145">Network name</span></span>  
  
-   <span data-ttu-id="e956f-146">Endereço IP</span><span class="sxs-lookup"><span data-stu-id="e956f-146">IP address</span></span>  
  
-   <span data-ttu-id="e956f-147">Discos compartilhados</span><span class="sxs-lookup"><span data-stu-id="e956f-147">Shared disks</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="e956f-148">Serviço do Mecanismo de Banco de Dados</span><span class="sxs-lookup"><span data-stu-id="e956f-148">Database Engine service</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="e956f-149">Agent</span><span class="sxs-lookup"><span data-stu-id="e956f-149">Agent service</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="e956f-150">Analysis Services, se estiver instalado</span><span class="sxs-lookup"><span data-stu-id="e956f-150">Analysis Services service, if installed</span></span>  
  
-   <span data-ttu-id="e956f-151">Um recurso de compartilhamento de arquivos, se o recurso FILESTREAM estiver instalado</span><span class="sxs-lookup"><span data-stu-id="e956f-151">One file share resource, if the FILESTREAM feature is installed</span></span>  
  
 <span data-ttu-id="e956f-152">A qualquer momento, somente o proprietário do grupo de recursos (e nenhum outro nó na FCI) está executando os respectivos serviços do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] no grupo de recursos.</span><span class="sxs-lookup"><span data-stu-id="e956f-152">At any time, only the resource group owner (and no other node in the FCI) is running its respective [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] services in the resource group.</span></span> <span data-ttu-id="e956f-153">Quando um failover ocorrer, se é um failover automático ou um failover planejado, esta sequência de eventos acontece:</span><span class="sxs-lookup"><span data-stu-id="e956f-153">When a failover occurs, whether it be an automatic failover or a planned failover, the following sequence of events happen:</span></span>  
  
1.  <span data-ttu-id="e956f-154">A menos que ocorra uma falha de hardware ou de sistema, todas as páginas sujas no cache do buffer serão gravadas no disco.</span><span class="sxs-lookup"><span data-stu-id="e956f-154">Unless a hardware or system failure occurs, all dirty pages in the buffer cache are written to disk.</span></span>  
  
2.  <span data-ttu-id="e956f-155">Todos os respectivos serviços do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] no grupo de recursos são parados no nó ativo.</span><span class="sxs-lookup"><span data-stu-id="e956f-155">All respective [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] services in the resource group are stopped on the active node.</span></span>  
  
3.  <span data-ttu-id="e956f-156">A propriedade de grupo de recursos é transferida para outro nó na FCI.</span><span class="sxs-lookup"><span data-stu-id="e956f-156">The resource group ownership is transferred to another node in the FCI.</span></span>  
  
4.  <span data-ttu-id="e956f-157">O novo proprietário do grupo de recursos inicia seus serviços do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="e956f-157">The new resource group owner starts its [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] services.</span></span>  
  
5.  <span data-ttu-id="e956f-158">As solicitações de conexão de aplicativo cliente são automaticamente direcionadas para o novo nó ativo usando o mesmo VNN (nome de rede virtual).</span><span class="sxs-lookup"><span data-stu-id="e956f-158">Client application connection requests are automatically directed to the new active node using the same virtual network name (VNN).</span></span>  
  
 <span data-ttu-id="e956f-159">A FCI fica online contanto que seu cluster WSFC subjacente esteja com boa integridade de quorum (a maioria dos nós do quorum WSFC estão disponíveis como destinos de failover automáticos).</span><span class="sxs-lookup"><span data-stu-id="e956f-159">The FCI is online as long as its underlying WSFC cluster is in good quorum health (the majority of the quorum WSFC nodes are available as automatic failover targets).</span></span> <span data-ttu-id="e956f-160">Quando o cluster do WSFC perde seu quorum, devido a falha de hardware, software, rede ou configuração de quorum imprópria, o cluster do WSFC inteiro, junto com o FCI, é colocado offline.</span><span class="sxs-lookup"><span data-stu-id="e956f-160">When the WSFC cluster loses its quorum, whether due to hardware, software, network failure, or improper quorum configuration, the entire WSFC cluster, along with the FCI, is brought offline.</span></span> <span data-ttu-id="e956f-161">É necessário realizar uma intervenção manual neste cenário de failover não planejado para restabelecer o quorum nos nós disponíveis restantes para colocar o cluster do WSFC e da FCI online novamente.</span><span class="sxs-lookup"><span data-stu-id="e956f-161">Manual intervention is then required in this unplanned failover scenario to reestablish quorum in the remaining available nodes in order to bring the WSFC cluster and FCI back online.</span></span> <span data-ttu-id="e956f-162">Para obter mais informações, consulte [configuração de modos de quorum WSFC e votação (; SQL Server);](wsfc-quorum-modes-and-voting-configuration-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="e956f-162">For more information, see [WSFC Quorum Modes and Voting Configuration (;SQL Server);](wsfc-quorum-modes-and-voting-configuration-sql-server.md).</span></span>  
  
### <a name="predictable-failover-time"></a><span data-ttu-id="e956f-163">Hora de failover previsível</span><span class="sxs-lookup"><span data-stu-id="e956f-163">Predictable Failover Time</span></span>  
 <span data-ttu-id="e956f-164">Dependendo de quando sua instância do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] executou uma operação de ponto de verificação pela última vez, pode haver uma quantidade significativa de páginas sujas no cache do buffer.</span><span class="sxs-lookup"><span data-stu-id="e956f-164">Depending on when your [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance last performed a checkpoint operation, there can be a substantial amount of dirty pages in the buffer cache.</span></span> <span data-ttu-id="e956f-165">Por consequência, os failovers duram o suficiente para gravar as páginas sujas restantes no disco, o que pode levar a um tempo de failover longo e imprevisível.</span><span class="sxs-lookup"><span data-stu-id="e956f-165">Consequently, failovers last as long as it takes to write the remaining dirty pages to disk, which can lead to long and unpredictable failover time.</span></span> <span data-ttu-id="e956f-166">A partir do [!INCLUDE[msCoName](../../../includes/msconame-md.md)][!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)], a FCI pode usar pontos de verificação indiretos para limitar a quantidade de páginas sujas mantidas no cache do buffer.</span><span class="sxs-lookup"><span data-stu-id="e956f-166">Beginning with [!INCLUDE[msCoName](../../../includes/msconame-md.md)][!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)], the FCI can use indirect checkpoints to throttle the amount of dirty pages kept in the buffer cache.</span></span> <span data-ttu-id="e956f-167">Embora consuma recursos adicionais sob carga de trabalho normal, isto torna o failover mais previsível e também mais configurável.</span><span class="sxs-lookup"><span data-stu-id="e956f-167">While this does consume additional resources under regular workload, it makes the failover time more predictable as well as more configurable.</span></span> <span data-ttu-id="e956f-168">Isto é muito útil quando o acordo do nível de serviço em sua organização especifica o RTO (objetivo de tempo de recuperação) para sua solução de alta disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="e956f-168">This is very useful when the service-level agreement in your organization specifies the recovery time objective (RTO) for your high availability solution.</span></span> <span data-ttu-id="e956f-169">Para obter mais informações sobre pontos de verificação indiretos, consulte [Indirect Checkpoints](../../../relational-databases/logs/database-checkpoints-sql-server.md#IndirectChkpt).</span><span class="sxs-lookup"><span data-stu-id="e956f-169">For more information on indirect checkpoints, see [Indirect Checkpoints](../../../relational-databases/logs/database-checkpoints-sql-server.md#IndirectChkpt).</span></span>  
  
### <a name="reliable-health-monitoring-and-flexible-failover-policy"></a><span data-ttu-id="e956f-170">Monitoramento de integridade confiável e política de failover flexível</span><span class="sxs-lookup"><span data-stu-id="e956f-170">Reliable Health Monitoring and Flexible Failover Policy</span></span>  
 <span data-ttu-id="e956f-171">Depois que a FCI é iniciada com sucesso, o serviço do WSFC monitora a integridade do cluster do WSFC subjacente e também a integridade da instância do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="e956f-171">After the FCI starts successfully, the WSFC service monitors both the health of the underlying WSFC cluster, as well as the health of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance.</span></span> <span data-ttu-id="e956f-172">A partir do [!INCLUDE[msCoName](../../../includes/msconame-md.md)][!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)], o serviço do WSFC usa uma conexão dedicada para sondar a instância do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ativa em busca de diagnóstico de componente detalhados por meio de um procedimento armazenado de sistema.</span><span class="sxs-lookup"><span data-stu-id="e956f-172">Beginning with [!INCLUDE[msCoName](../../../includes/msconame-md.md)][!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)], the WSFC service uses a dedicated connection to poll the active [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance for detailed component diagnostics through a system stored procedure.</span></span> <span data-ttu-id="e956f-173">São três implicações:</span><span class="sxs-lookup"><span data-stu-id="e956f-173">The implication of this is three-fold:</span></span>  
  
-   <span data-ttu-id="e956f-174">A conexão dedicada para a instância do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] possibilita sondar diagnóstico de componente com confiança o tempo todo, mesmo quando a FCI está sob carga pesada.</span><span class="sxs-lookup"><span data-stu-id="e956f-174">The dedicated connection to the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance makes it possible to reliably poll for component diagnostics all the time, even when the FCI is under heavy load.</span></span> <span data-ttu-id="e956f-175">Isto possibilita distinguir entre um sistema que está sob carga pesada e um sistema que de fato tem condições de falha, impedindo, portanto, problemas como falsos failovers.</span><span class="sxs-lookup"><span data-stu-id="e956f-175">This makes it possible to distinguish between a system that is under heavy load and a system that actually has failure conditions, thus preventing issues such as false failovers.</span></span>  
  
-   <span data-ttu-id="e956f-176">Os diagnóstico de componente detalhado possibilita configurar uma política de failover mais flexível, por meio da qual você pode escolher quais condições de falha acionam failovers e quais condições de falha não acionam.</span><span class="sxs-lookup"><span data-stu-id="e956f-176">The detailed component diagnostics makes it possible to configure a more flexible failover policy, whereby you can choose what failure conditions trigger failovers and which failure conditions do not.</span></span>  
  
-   <span data-ttu-id="e956f-177">O diagnóstico de componente detalhado também permite uma melhor solução de problemas de failovers automáticos retroativamente.</span><span class="sxs-lookup"><span data-stu-id="e956f-177">The detailed component diagnostics also enables better troubleshooting of automatic failovers retroactively.</span></span> <span data-ttu-id="e956f-178">As informações de diagnóstico são armazenadas em arquivos de log que são colocados com os logs de erros do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="e956f-178">The diagnostic information is stored to log files, which are collocated with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] error logs.</span></span> <span data-ttu-id="e956f-179">Você pode carregá-los no Visualizador do Arquivo de Log para inspecionar os estados do componente que levam até a ocorrência de failover para determinar o que causa o failover.</span><span class="sxs-lookup"><span data-stu-id="e956f-179">You can load them into the Log File Viewer to inspect the component states leading up to the failover occurrence in order to determine what cause that failover.</span></span>  
  
 <span data-ttu-id="e956f-180">Para obter mais informações, consulte [política de failover para instâncias de cluster de failover](failover-policy-for-failover-cluster-instances.md)</span><span class="sxs-lookup"><span data-stu-id="e956f-180">For more information, see [Failover Policy for Failover Cluster Instances](failover-policy-for-failover-cluster-instances.md)</span></span>  
  
##  <a name="elements-of-a-failover-cluster-instance"></a><a name="FCIelements"></a><span data-ttu-id="e956f-181">Elementos de uma instância de cluster de failover</span><span class="sxs-lookup"><span data-stu-id="e956f-181">Elements of a Failover Cluster Instance</span></span>  
 <span data-ttu-id="e956f-182">Uma FCI consiste em um conjunto de servidores físicos (nós) que contêm configuração de hardware semelhante e também configuração de software idêntica, que inclui versão de sistema operacional e nível de patch e versão do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , nível de patch, componentes e nome de instância.</span><span class="sxs-lookup"><span data-stu-id="e956f-182">An FCI consists of a set of physical servers (nodes) that contain similar hardware configuration as well as identical software configuration that includes operating system version and patch level, and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] version, patch level, components, and instance name.</span></span> <span data-ttu-id="e956f-183">A configuração de software idêntica é necessária para assegurar que a FCI possa ser completamente funcional porque ocorre o failover entre os nós.</span><span class="sxs-lookup"><span data-stu-id="e956f-183">Identical software configuration is necessary to ensure that the FCI can be fully functional as it fails over between the nodes.</span></span>  
  
 <span data-ttu-id="e956f-184">Grupo de recursos do WSFC</span><span class="sxs-lookup"><span data-stu-id="e956f-184">WSFC Resource Group</span></span>  
 <span data-ttu-id="e956f-185">Uma FCI do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] é executada em um grupo de recursos do WSFC.</span><span class="sxs-lookup"><span data-stu-id="e956f-185">A [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] FCI runs in a WSFC resource group.</span></span> <span data-ttu-id="e956f-186">Cada nó no grupo de recursos mantém uma cópia sincronizada dos parâmetros de configuração e chave do Registro como pontos de verificação para assegurar a funcionalidade completa da FCI depois de um failover e somente um dos nós no cluster possui o grupo de recursos de cada vez (o nó ativo).</span><span class="sxs-lookup"><span data-stu-id="e956f-186">Each node in the resource group maintains a synchronized copy of the configuration settings and check-pointed registry keys to ensure full functionality of the FCI after a failover, and only one of the nodes in the cluster owns the resource group at a time (the active node).</span></span> <span data-ttu-id="e956f-187">O serviço do WSFC gerencia o cluster de servidores, a configuração de quorum, a política de failover e as operações de failover, assim como os endereços de VNN e IP virtuais para a FCI.</span><span class="sxs-lookup"><span data-stu-id="e956f-187">The WSFC service manages the server cluster, quorum configuration, failover policy, and failover operations, as well as the VNN and virtual IP addresses for the FCI.</span></span> <span data-ttu-id="e956f-188">No caso de uma falha (problemas de hardware, falhas de sistema operacional, aplicativo ou falhas de serviço) ou de uma atualização planejada, a propriedade do grupo de recursos é movida para outro nó na FCI. O número de nós que têm suporte em um grupo de recursos do WSFC depende de sua edição do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="e956f-188">In case of a failure (hardware failures, operating system failures, application or service failures) or a planned upgrade, the resource group ownership is moved to another node in the FCI.The number of nodes that are supported in a WSFC resource group depends on your [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] edition.</span></span> <span data-ttu-id="e956f-189">Além disso, o mesmo cluster do WSFC pode executar várias FCIs (vários grupos de recursos), dependendo de sua capacidade de hardware, como CPUs, memória e número de discos.</span><span class="sxs-lookup"><span data-stu-id="e956f-189">Also, the same WSFC cluster can run multiple FCIs (multiple resource groups), depending on your hardware capacity, such as CPUs, memory, and number of disks.</span></span>  
  
 <span data-ttu-id="e956f-190">Binários do SQL Server</span><span class="sxs-lookup"><span data-stu-id="e956f-190">SQL Server Binaries</span></span>  
 <span data-ttu-id="e956f-191">Os binários de produto são instalados localmente em cada nó da FCI, um processo semelhante a instalações autônomas do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="e956f-191">The product binaries are installed locally on each node of the FCI, a process similar to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] stand-alone installations.</span></span> <span data-ttu-id="e956f-192">Porém, durante a inicialização, os serviços não são iniciados automaticamente, mas são gerenciados pelo WSFC.</span><span class="sxs-lookup"><span data-stu-id="e956f-192">However, during startup, the services are not started automatically, but managed by WSFC.</span></span>  
  
 <span data-ttu-id="e956f-193">Armazenamento</span><span class="sxs-lookup"><span data-stu-id="e956f-193">Storage</span></span>  
 <span data-ttu-id="e956f-194">Ao contrário do grupo de disponibilidade AlwaysOn, uma FCI deve usar armazenamento compartilhado entre todos os nós do FCI para banco de dados e armazenamento de log.</span><span class="sxs-lookup"><span data-stu-id="e956f-194">Contrary to the Always On availability group, an FCI must use shared storage between all nodes of the FCI for database and log storage.</span></span> <span data-ttu-id="e956f-195">O armazenamento compartilhado pode ser na forma de discos de cluster do WSFC, discos em uma rede SAN ou compartilhamentos de arquivos em um SMB.</span><span class="sxs-lookup"><span data-stu-id="e956f-195">The shared storage can be in the form of WSFC cluster disks, disks on a SAN, or file shares on an SMB.</span></span> <span data-ttu-id="e956f-196">Deste modo, todos os nós na FCI têm a mesma exibição dos dados de instância sempre que um failover ocorre.</span><span class="sxs-lookup"><span data-stu-id="e956f-196">This way, all nodes in the FCI have the same view of instance data whenever a failover occurs.</span></span> <span data-ttu-id="e956f-197">No entanto, isto significa que o armazenamento compartilhado tem o potencial de ser o único ponto de falha, e a FCI depende da solução de armazenamento subjacente para assegurar a proteção de dados.</span><span class="sxs-lookup"><span data-stu-id="e956f-197">This does mean, however, that the shared storage has the potential of being the single point of failure, and FCI depends on the underlying storage solution to ensure data protection.</span></span>  
  
 <span data-ttu-id="e956f-198">Nome da rede</span><span class="sxs-lookup"><span data-stu-id="e956f-198">Network Name</span></span>  
 <span data-ttu-id="e956f-199">O VNN para a FCI fornece um ponto de conexão unificado para a FCI.</span><span class="sxs-lookup"><span data-stu-id="e956f-199">The VNN for the FCI provides a unified connection point for the FCI.</span></span> <span data-ttu-id="e956f-200">Isto permite que aplicativos conectem-se ao VNN sem a necessidade de conhecer o nó ativo atualmente.</span><span class="sxs-lookup"><span data-stu-id="e956f-200">This allows applications to connect to the VNN without the need to know the currently active node.</span></span> <span data-ttu-id="e956f-201">Quando um failover ocorre, o VNN é registrado para o novo nó ativo depois de iniciar.</span><span class="sxs-lookup"><span data-stu-id="e956f-201">When a failover occurs, the VNN is registered to the new active node after it starts.</span></span> <span data-ttu-id="e956f-202">Este processo é transparente ao cliente ou aplicativo que se conecta ao [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] e isso minimiza o tempo de inatividade pelo qual passa o aplicativo ou os clientes durante uma falha.</span><span class="sxs-lookup"><span data-stu-id="e956f-202">This process is transparent to the client or application connecting to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] and this minimize the downtime the application or clients experience during a failure.</span></span>  
  
 <span data-ttu-id="e956f-203">IP virtuais</span><span class="sxs-lookup"><span data-stu-id="e956f-203">Virtual IPs</span></span>  
 <span data-ttu-id="e956f-204">No caso de uma FCI de várias sub-redes, um endereço IP virtual é atribuído a cada sub-rede na FCI.</span><span class="sxs-lookup"><span data-stu-id="e956f-204">In the case of a multi-subnet FCI, a virtual IP address is assigned to each subnet in the FCI.</span></span> <span data-ttu-id="e956f-205">Durante um failover, o VNN no servidor DNS é atualizado para apontar para o endereço IP virtual para a respectiva sub-rede.</span><span class="sxs-lookup"><span data-stu-id="e956f-205">During a failover, the VNN on the DNS server is updated to point to the virtual IP address for the respective subnet.</span></span> <span data-ttu-id="e956f-206">Aplicativos e clientes podem então se conectar ao FCI usando o mesmo VNN depois de um failover de várias sub-redes.</span><span class="sxs-lookup"><span data-stu-id="e956f-206">Applications and clients can then connect to the FCI using the same VNN after a multi-subnet failover.</span></span>  
  
##  <a name="sql-server-failover-concepts-and-tasks"></a><a name="ConceptsAndTasks"></a> <span data-ttu-id="e956f-207">Conceitos e tarefas de failover do SQL Server</span><span class="sxs-lookup"><span data-stu-id="e956f-207">SQL Server Failover Concepts and Tasks</span></span>  
  
|<span data-ttu-id="e956f-208">Conceitos e tarefas</span><span class="sxs-lookup"><span data-stu-id="e956f-208">Concepts and Tasks</span></span>|<span data-ttu-id="e956f-209">Tópico</span><span class="sxs-lookup"><span data-stu-id="e956f-209">Topic</span></span>|  
|------------------------|-----------|  
|<span data-ttu-id="e956f-210">Descreve o mecanismo de detecção de falha e a política de failover flexível.</span><span class="sxs-lookup"><span data-stu-id="e956f-210">Describes the failure detection mechanism and the flexible failover policy.</span></span>|[<span data-ttu-id="e956f-211">Failover Policy for Failover Cluster Instances</span><span class="sxs-lookup"><span data-stu-id="e956f-211">Failover Policy for Failover Cluster Instances</span></span>](failover-policy-for-failover-cluster-instances.md)|  
|<span data-ttu-id="e956f-212">Descreve os conceitos na administração e na manutenção da FCI.</span><span class="sxs-lookup"><span data-stu-id="e956f-212">Describes concepts in FCI administration and maintenance.</span></span>|[<span data-ttu-id="e956f-213">Administração e manutenção da instância de cluster de failover</span><span class="sxs-lookup"><span data-stu-id="e956f-213">Failover Cluster Instance Administration and Maintenance</span></span>](failover-cluster-instance-administration-and-maintenance.md)|  
|<span data-ttu-id="e956f-214">Descreve a configuração e os conceitos de várias sub-redes</span><span class="sxs-lookup"><span data-stu-id="e956f-214">Describes multi-subnet configuration and concepts</span></span>|[<span data-ttu-id="e956f-215">Clustering de várias sub-redes SQL Server (; SQL Server);</span><span class="sxs-lookup"><span data-stu-id="e956f-215">SQL Server Multi-Subnet Clustering (;SQL Server);</span></span>](sql-server-multi-subnet-clustering-sql-server.md)|  
  
##  <a name="related-topics"></a><a name="RelatedTopics"></a><span data-ttu-id="e956f-216">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="e956f-216">Related Topics</span></span>  
  
|<span data-ttu-id="e956f-217">**Descrições do tópico**</span><span class="sxs-lookup"><span data-stu-id="e956f-217">**Topic descriptions**</span></span>|<span data-ttu-id="e956f-218">**Tópico**</span><span class="sxs-lookup"><span data-stu-id="e956f-218">**Topic**</span></span>|  
|----------------------------|---------------|  
|<span data-ttu-id="e956f-219">Descreve como instalar uma nova FCI do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="e956f-219">Describes how to install a new [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] FCI.</span></span>|[<span data-ttu-id="e956f-220">Criar um novo cluster de failover de SQL Server (; Instalação);</span><span class="sxs-lookup"><span data-stu-id="e956f-220">Create a New SQL Server Failover Cluster (;Setup);</span></span>](../install/create-a-new-sql-server-failover-cluster-setup.md)|  
|<span data-ttu-id="e956f-221">Descreve como atualizar para um cluster de failover do [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="e956f-221">Describes how to upgrade to a [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] failover cluster.</span></span>|[<span data-ttu-id="e956f-222">Atualizar um cluster de failover do SQL Server</span><span class="sxs-lookup"><span data-stu-id="e956f-222">Upgrade a SQL Server Failover Cluster</span></span>](upgrade-a-sql-server-failover-cluster-instance.md)|  
|<span data-ttu-id="e956f-223">Descreve conceitos de clustering de failover do Windows e fornece links para tarefas relativas ao clustering de failover do Windows.</span><span class="sxs-lookup"><span data-stu-id="e956f-223">Describes Windows Failover Clustering Concepts and provides links to tasks related to Windows Failover Clustering</span></span>|[!INCLUDE[nextref_longhorn](../../../includes/nextref-longhorn-md.md)]<span data-ttu-id="e956f-224">: [Visão geral de clusters de failover](https://go.microsoft.com/fwlink/?LinkId=177878)</span><span class="sxs-lookup"><span data-stu-id="e956f-224">: [Overview of Failover Clusters](https://go.microsoft.com/fwlink/?LinkId=177878)</span></span><br /><br /> [!INCLUDE[nextref_longhorn](../../../includes/nextref-longhorn-md.md)] <span data-ttu-id="e956f-225">R2: [Visão geral de clusters de failover](https://go.microsoft.com/fwlink/?LinkId=177879)</span><span class="sxs-lookup"><span data-stu-id="e956f-225">R2: [Overview of Failover Clusters](https://go.microsoft.com/fwlink/?LinkId=177879)</span></span>|  
|<span data-ttu-id="e956f-226">Descreve as distinções em conceitos entre nós em uma FCI e réplicas dentro de um grupo de disponibilidade e considerações para usar uma FCI para hospedar uma réplica para um grupo de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="e956f-226">Describes the distinctions in concepts between nodes in an FCI and replicas within an availability group and considerations for using an FCI to host a replica for an availability group.</span></span>|[<span data-ttu-id="e956f-227">Clustering de failover e Grupos de Disponibilidade AlwaysOn (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="e956f-227">Failover Clustering and Always On Availability Groups (SQL Server)</span></span>](../../../database-engine/availability-groups/windows/failover-clustering-and-always-on-availability-groups-sql-server.md)|  
  
  
