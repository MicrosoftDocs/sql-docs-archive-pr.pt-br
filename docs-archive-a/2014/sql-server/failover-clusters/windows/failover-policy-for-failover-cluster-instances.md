---
title: Política de failover para instâncias de cluster de failover | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- flexible failover policy
ms.assetid: 39ceaac5-42fa-4b5d-bfb6-54403d7f0dc9
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 8d441e5627280cb46168d9ff187d7f43da8b26a6
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87573568"
---
# <a name="failover-policy-for-failover-cluster-instances"></a><span data-ttu-id="1bf79-102">Política de failover para instâncias de cluster de failover</span><span class="sxs-lookup"><span data-stu-id="1bf79-102">Failover Policy for Failover Cluster Instances</span></span>
  <span data-ttu-id="1bf79-103">Em uma FCI (instância de cluster de failover) do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , somente um nó pode ter o grupo de recursos de cluster do WSFC (Windows Server Failover Cluster) em um determinado momento.</span><span class="sxs-lookup"><span data-stu-id="1bf79-103">In a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover cluster instance (FCI), only one node can own the Windows Server Failover Cluster (WSFC) cluster resource group at a given time.</span></span> <span data-ttu-id="1bf79-104">As solicitações do cliente são atendidas por esse nó na FCI.</span><span class="sxs-lookup"><span data-stu-id="1bf79-104">The client requests are served through this node in the FCI.</span></span> <span data-ttu-id="1bf79-105">Em caso de falha e uma reinicialização malsucedida, a propriedade de grupo é movida para outro nó do WSFC na FCI.</span><span class="sxs-lookup"><span data-stu-id="1bf79-105">In the case of a failure and an unsuccessful restart, the group ownership is moved to another WSFC node in the FCI.</span></span> <span data-ttu-id="1bf79-106">Esse processo é chamado de failover.</span><span class="sxs-lookup"><span data-stu-id="1bf79-106">This process is called failover.</span></span> [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] <span data-ttu-id="1bf79-107">aumenta a confiabilidade de detecção de falha e fornece uma política de failover flexível.</span><span class="sxs-lookup"><span data-stu-id="1bf79-107">increases the reliability of failure detection and provides a flexible failover policy.</span></span>  
  
 <span data-ttu-id="1bf79-108">Uma FCI do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] depende do serviço do WSFC subjacente para detecção de failover.</span><span class="sxs-lookup"><span data-stu-id="1bf79-108">A [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] FCI depends on the underlying WSFC service for failover detection.</span></span> <span data-ttu-id="1bf79-109">Assim, dois mecanismos determinam o comportamento de failover para FCI: a primeira é a funcionalidade nativa do WSFC e a última é a funcionalidade adicionada pela instalação do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="1bf79-109">Therefore, two mechanisms determine the failover behavior for FCI: the former is native WSFC functionality, and the latter is functionality added by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] setup.</span></span>  
  
-   <span data-ttu-id="1bf79-110">O cluster do WSFC mantém a configuração de quorum que assegura um destino de failover exclusivo em um failover automático.</span><span class="sxs-lookup"><span data-stu-id="1bf79-110">The WSFC cluster maintains the quorum configuration, which ensures a unique failover target in an automatic failover.</span></span> <span data-ttu-id="1bf79-111">O serviço do WSFC determina se o cluster está na integridade de quorum ideal o tempo todo e coloca o grupo de recursos online e offline devidamente.</span><span class="sxs-lookup"><span data-stu-id="1bf79-111">The WSFC service determines whether the cluster is in optimal quorum health at all times and brings the resource group online and offline accordingly.</span></span>  
  
-   <span data-ttu-id="1bf79-112">A instância ativa do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] relata periodicamente um conjunto de diagnóstico de componente para o grupo de recursos do WSFC sobre uma conexão dedicada.</span><span class="sxs-lookup"><span data-stu-id="1bf79-112">The active [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance periodically reports a set of component diagnostics to the WSFC resource group over a dedicated connection.</span></span> <span data-ttu-id="1bf79-113">O grupo de recursos do WSFC mantém a política de failover, que define as condições de falha que acionam reinicializações e failovers.</span><span class="sxs-lookup"><span data-stu-id="1bf79-113">The WSFC resource group maintains the failover policy, which defines the failure conditions that trigger restarts and failovers.</span></span>  
  
 <span data-ttu-id="1bf79-114">Este tópico discute o segundo mecanismo acima.</span><span class="sxs-lookup"><span data-stu-id="1bf79-114">This topic discusses the second mechanism above.</span></span> <span data-ttu-id="1bf79-115">Para obter mais informações sobre o comportamento do WSFC para configuração de quorum e detecção de integridade, consulte [Configuração de modos de quorum e votação do WSFC &#40;SQL Server&#41;](wsfc-quorum-modes-and-voting-configuration-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="1bf79-115">For more information on the WSFC behavior for quorum configuration and health detection, see [WSFC Quorum Modes and Voting Configuration &#40;SQL Server&#41;](wsfc-quorum-modes-and-voting-configuration-sql-server.md).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="1bf79-116">Failovers automáticos de e para uma FCI não são permitidos em um grupo de disponibilidade AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="1bf79-116">Automatic failovers to and from an FCI are not allowed in an AlwaysOn availability group.</span></span> <span data-ttu-id="1bf79-117">No entanto, failovers manuais de e para uma FCI são permitidos em um grupo de disponibilidade AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="1bf79-117">However, manual failovers to and from and FCI are allowed in an AlwaysOn availability group.</span></span>  
  
##  <a name="failover-policy-overview"></a><a name="Concepts"></a> <span data-ttu-id="1bf79-118">Visão geral da política de failover</span><span class="sxs-lookup"><span data-stu-id="1bf79-118">Failover Policy Overview</span></span>  
 <span data-ttu-id="1bf79-119">O processo de failover pode ser dividido nas etapas seguintes:</span><span class="sxs-lookup"><span data-stu-id="1bf79-119">The failover process can be broken down into the following steps:</span></span>  
  
1.  [<span data-ttu-id="1bf79-120">Monitorar o status de integridade</span><span class="sxs-lookup"><span data-stu-id="1bf79-120">Monitor the Health Status</span></span>](failover-policy-for-failover-cluster-instances.md#monitor)  
  
2.  [<span data-ttu-id="1bf79-121">Determinando falhas</span><span class="sxs-lookup"><span data-stu-id="1bf79-121">Determining Failures</span></span>](failover-policy-for-failover-cluster-instances.md#determine)  
  
3.  [<span data-ttu-id="1bf79-122">Respondendo a falhas</span><span class="sxs-lookup"><span data-stu-id="1bf79-122">Responding to Failures</span></span>](failover-policy-for-failover-cluster-instances.md#respond)  
  
###  <a name="monitor-the-health-status"></a><a name="monitor"></a><span data-ttu-id="1bf79-123">Monitorar o status de integridade</span><span class="sxs-lookup"><span data-stu-id="1bf79-123">Monitor the Health Status</span></span>  
 <span data-ttu-id="1bf79-124">Há três tipos de status de integridade que são monitorados para a FCI:</span><span class="sxs-lookup"><span data-stu-id="1bf79-124">There are three types of health statuses that are monitored for the FCI:</span></span>  
  
-   [<span data-ttu-id="1bf79-125">Estado do serviço de SQL Server</span><span class="sxs-lookup"><span data-stu-id="1bf79-125">State of the SQL Server service</span></span>](failover-policy-for-failover-cluster-instances.md#service)  
  
-   [<span data-ttu-id="1bf79-126">Capacidade de resposta da instância do SQL Server</span><span class="sxs-lookup"><span data-stu-id="1bf79-126">Responsiveness of the SQL Server instance</span></span>](failover-policy-for-failover-cluster-instances.md#instance)  
  
-   [<span data-ttu-id="1bf79-127">Diagnóstico de componente do SQL Server</span><span class="sxs-lookup"><span data-stu-id="1bf79-127">SQL Server component diagnostics</span></span>](failover-policy-for-failover-cluster-instances.md#component)  
  
####  <a name="state-of-the-sql-server-service"></a><a name="service"></a> <span data-ttu-id="1bf79-128">Estado do serviço SQL Server</span><span class="sxs-lookup"><span data-stu-id="1bf79-128">State of the SQL Server service</span></span>  
 <span data-ttu-id="1bf79-129">O serviço do WSFC monitora o estado inicial do serviço SQL Server no nó de FCI ativo para detectar quando o serviço SQL Server é interrompido.</span><span class="sxs-lookup"><span data-stu-id="1bf79-129">The WSFC service monitors the start state of the SQL Server service on the active FCI node to detect when the SQL Server service is stopped.</span></span>  
  
####  <a name="responsiveness-of-the-sql-server-instance"></a><a name="instance"></a><span data-ttu-id="1bf79-130">Capacidade de resposta da instância de SQL Server</span><span class="sxs-lookup"><span data-stu-id="1bf79-130">Responsiveness of the SQL Server instance</span></span>  
 <span data-ttu-id="1bf79-131">Durante a inicialização do SQL Server, o serviço do WSFC usa a DLL do recurso de Mecanismo de Banco de Dados do SQL Server para criar uma nova conexão com um thread separado que é usado exclusivamente para monitorar o status de integridade.</span><span class="sxs-lookup"><span data-stu-id="1bf79-131">During SQL Server startup, the WSFC service uses the SQL Server Database Engine resource DLL to create a new connection to on a separate thread that is used exclusively for monitoring the health status.</span></span> <span data-ttu-id="1bf79-132">Isso assegura que a instância do SQL tenha os recursos necessários para relatar seu status de integridade durante o carregamento.</span><span class="sxs-lookup"><span data-stu-id="1bf79-132">This ensures that there the SQL instance has the required resources to report its health status while under load.</span></span> <span data-ttu-id="1bf79-133">Com o uso dessa conexão dedicada, o SQL Server executa o procedimento armazenado de sistema [sp_server_diagnostics &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-server-diagnostics-transact-sql) no modo de repetição para relatar periodicamente o status de integridade dos componentes do SQL Server para a DLL de recurso.</span><span class="sxs-lookup"><span data-stu-id="1bf79-133">Using this dedicated connection, SQL Server runs the [sp_server_diagnostics &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-server-diagnostics-transact-sql) system stored procedure in repeat mode to periodically report the health status of the SQL Server components to the resource DLL.</span></span>  
  
 <span data-ttu-id="1bf79-134">A DLL do recurso determina a capacidade de resposta da instância do SQL que usa um tempo limite de verificação de integridade.</span><span class="sxs-lookup"><span data-stu-id="1bf79-134">The resource DLL determines the responsiveness of the SQL instance using a health check timeout.</span></span> <span data-ttu-id="1bf79-135">A propriedade HealthCheckTimeout define por quanto tempo a DLL do recurso deve esperar o procedimento armazenado sp_server_diagnostics antes de relatar a instância do SQL como sem resposta para o serviço do WSFC.</span><span class="sxs-lookup"><span data-stu-id="1bf79-135">The HealthCheckTimeout property defines how long the resource DLL should wait for the sp_server_diagnostics stored procedure before it reports the SQL instance as unresponsive to the WSFC service.</span></span> <span data-ttu-id="1bf79-136">Essa propriedade pode ser configurada com o uso de T-SQL, bem como no snap-in Gerenciador de Cluster de Failover.</span><span class="sxs-lookup"><span data-stu-id="1bf79-136">This property is configurable using T-SQL as well as in the Failover Cluster Manager snap-in.</span></span> <span data-ttu-id="1bf79-137">Para obter mais informações, consulte [Configure HealthCheckTimeout Property Settings](configure-healthchecktimeout-property-settings.md).</span><span class="sxs-lookup"><span data-stu-id="1bf79-137">For more information, see [Configure HealthCheckTimeout Property Settings](configure-healthchecktimeout-property-settings.md).</span></span> <span data-ttu-id="1bf79-138">Os itens a seguir descrevem como essa propriedade afeta as configurações de tempo limite e intervalo de repetição:</span><span class="sxs-lookup"><span data-stu-id="1bf79-138">The following items describe how this property affects timeout and repeat interval settings:</span></span>  
  
-   <span data-ttu-id="1bf79-139">A DLL de recurso chama o procedimento armazenado sp_server_diagnostics e define o intervalo de repetição para um terço da configuração de HealthCheckTimeout.</span><span class="sxs-lookup"><span data-stu-id="1bf79-139">The resource DLL calls the sp_server_diagnostics stored procedure and sets the repeat interval to one-third of the HealthCheckTimeout setting.</span></span>  
  
-   <span data-ttu-id="1bf79-140">Se o procedimento armazenado sp_server_diagnostics estiver lento ou não estiver retornando informações, a DLL do recurso esperará o intervalo especificado por HealthCheckTimeout antes de relatar para o serviço do WSFC que a instância do SQL não está respondendo.</span><span class="sxs-lookup"><span data-stu-id="1bf79-140">If the sp_server_diagnostics stored procedure is slow or is not returning information, the resource DLL will wait for the interval specified by HealthCheckTimeout before it reports to the WSFC service that the SQL instance is unresponsive.</span></span>  
  
-   <span data-ttu-id="1bf79-141">Se a conexão dedicada for perdida, a DLL do recurso tentará estabelecer novamente a conexão com a instância SQL do intervalo especificado por HealthCheckTimeout antes de relatar para o serviço do WSFC que a instância do SQL não está respondendo.</span><span class="sxs-lookup"><span data-stu-id="1bf79-141">If the dedicated connection is lost, the resource DLL will retry the connection to the SQL instance for the interval specified by HealthCheckTimeout before it reports to the WSFC service that the SQL instance is unresponsive.</span></span>  
  
####  <a name="sql-server-component-diagnostics"></a><a name="component"></a><span data-ttu-id="1bf79-142">Diagnóstico de componente do SQL Server</span><span class="sxs-lookup"><span data-stu-id="1bf79-142">SQL Server component diagnostics</span></span>  
 <span data-ttu-id="1bf79-143">O procedimento armazenado de sistema sp_server_diagnostics coleta periodicamente o diagnóstico de componente na instância do SQL.</span><span class="sxs-lookup"><span data-stu-id="1bf79-143">The system stored procedure sp_server_diagnostics periodically collects component diagnostics on the SQL instance.</span></span> <span data-ttu-id="1bf79-144">As informações de diagnóstico coletadas são apresentadas como uma linha para cada um dos seguintes componentes e passados para o thread de chamada.</span><span class="sxs-lookup"><span data-stu-id="1bf79-144">The diagnostic information that is collected is surfaced as a row for each of the following components and passed to the calling thread.</span></span>  
  
1.  <span data-ttu-id="1bf79-145">sistema</span><span class="sxs-lookup"><span data-stu-id="1bf79-145">system</span></span>  
  
2.  <span data-ttu-id="1bf79-146">recurso</span><span class="sxs-lookup"><span data-stu-id="1bf79-146">resource</span></span>  
  
3.  <span data-ttu-id="1bf79-147">processo de consulta</span><span class="sxs-lookup"><span data-stu-id="1bf79-147">query process</span></span>  
  
4.  <span data-ttu-id="1bf79-148">io_subsystem</span><span class="sxs-lookup"><span data-stu-id="1bf79-148">io_subsystem</span></span>  
  
5.  <span data-ttu-id="1bf79-149">events</span><span class="sxs-lookup"><span data-stu-id="1bf79-149">events</span></span>  
  
 <span data-ttu-id="1bf79-150">O sistema, o recurso e os componentes do processo de consulta são usados para detecção de falha.</span><span class="sxs-lookup"><span data-stu-id="1bf79-150">The system, resource, and query process components are used for failure detection.</span></span> <span data-ttu-id="1bf79-151">O io_subsytem e os componentes de eventos são usados apenas para fins de diagnóstico.</span><span class="sxs-lookup"><span data-stu-id="1bf79-151">The io_subsytem and events components are used for diagnostic purposes only.</span></span>  
  
 <span data-ttu-id="1bf79-152">Cada conjunto de linhas de informações também é gravado no log de diagnósticos do cluster do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="1bf79-152">Each rowset of information is also written to the SQL Server cluster diagnostics log.</span></span> <span data-ttu-id="1bf79-153">Para obter mais informações, consulte [Exibir e ler o log de diagnóstico da instância do cluster de failover](view-and-read-failover-cluster-instance-diagnostics-log.md).</span><span class="sxs-lookup"><span data-stu-id="1bf79-153">For more information, see [View and Read Failover Cluster Instance Diagnostics Log](view-and-read-failover-cluster-instance-diagnostics-log.md).</span></span>  
  
> [!TIP]  
>  <span data-ttu-id="1bf79-154">Embora o procedimento armazenado sp_server_diagnostic seja usado pela tecnologia AlwaysOn do SQL Server, ele está disponível para utilização em qualquer instância do SQL Server para ajudar a detectar e solucionar problemas.</span><span class="sxs-lookup"><span data-stu-id="1bf79-154">While the sp_server_diagnostic stored procedure is used by SQL Server AlwaysOn technology, it is available for use in any SQL Server instance to help detect and troubleshoot problems.</span></span>  
  
####  <a name="determining-failures"></a><a name="determine"></a> <span data-ttu-id="1bf79-155">Determinando falhas</span><span class="sxs-lookup"><span data-stu-id="1bf79-155">Determining Failures</span></span>  
 <span data-ttu-id="1bf79-156">A DLL do recurso do Mecanismo de Banco de Dados do SQL Server determina se o status de integridade detectado é uma condição para falha usando a propriedade FailureConditionLevel.</span><span class="sxs-lookup"><span data-stu-id="1bf79-156">The SQL Server Database Engine resource DLL determines whether the detected health status is a condition for failure using the FailureConditionLevel property.</span></span> <span data-ttu-id="1bf79-157">A propriedade FailureConditionLevel define quais status de integridade detectados causam reinicializações ou failovers.</span><span class="sxs-lookup"><span data-stu-id="1bf79-157">The FailureConditionLevel property defines which detected health statuses cause restarts or failovers.</span></span> <span data-ttu-id="1bf79-158">Há vários níveis de opções disponíveis, variando desde nenhuma reinicialização automática ou failover a todas as condições de falha possíveis resultantes em uma reinicialização automática ou failover.</span><span class="sxs-lookup"><span data-stu-id="1bf79-158">Multiple levels of options are available, ranging from no automatic restart or failover to all possible failure conditions resulting in an automatic restart or failover.</span></span> <span data-ttu-id="1bf79-159">Para obter mais informações sobre como configurar essa propriedade, consulte [Configure FailureConditionLevel Property Settings](configure-failureconditionlevel-property-settings.md).</span><span class="sxs-lookup"><span data-stu-id="1bf79-159">For more information about how to configure this property, see [Configure FailureConditionLevel Property Settings](configure-failureconditionlevel-property-settings.md).</span></span>  
  
 <span data-ttu-id="1bf79-160">As condições de falha são definidas em uma escala crescente.</span><span class="sxs-lookup"><span data-stu-id="1bf79-160">The failure conditions are set on an increasing scale.</span></span> <span data-ttu-id="1bf79-161">Para os níveis 1-5, cada um deles deve incluir todas as condições dos níveis anteriores, além de suas próprias condições.</span><span class="sxs-lookup"><span data-stu-id="1bf79-161">For levels 1-5, each level includes all the conditions from the previous levels in addition to its own conditions.</span></span> <span data-ttu-id="1bf79-162">Isso significa que, a cada nível, há uma probabilidade crescente de failover ou reinicialização.</span><span class="sxs-lookup"><span data-stu-id="1bf79-162">This means that with each level, there is an increased probability of a failover or restart.</span></span> <span data-ttu-id="1bf79-163">Os níveis de condição de falha são descritos na tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="1bf79-163">The failure condition levels are described in the following table.</span></span>  
  
 <span data-ttu-id="1bf79-164">Examine [sp_server_diagnostics &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-server-diagnostics-transact-sql), pois esse procedimento armazenado de sistema desempenha uma função importante nos níveis de condição de falha.</span><span class="sxs-lookup"><span data-stu-id="1bf79-164">Review [sp_server_diagnostics &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-server-diagnostics-transact-sql) as this system stored procedure plays in important role in the failure condition levels.</span></span>  
  
|<span data-ttu-id="1bf79-165">Nível</span><span class="sxs-lookup"><span data-stu-id="1bf79-165">Level</span></span>|<span data-ttu-id="1bf79-166">Condição</span><span class="sxs-lookup"><span data-stu-id="1bf79-166">Condition</span></span>|<span data-ttu-id="1bf79-167">Descrição</span><span class="sxs-lookup"><span data-stu-id="1bf79-167">Description</span></span>|  
|-----------|---------------|-----------------|  
|<span data-ttu-id="1bf79-168">0</span><span class="sxs-lookup"><span data-stu-id="1bf79-168">0</span></span>|<span data-ttu-id="1bf79-169">Nenhum failover ou reinicialização automática</span><span class="sxs-lookup"><span data-stu-id="1bf79-169">No automatic failover or restart</span></span>|<span data-ttu-id="1bf79-170">Indica que nenhum failover ou reinicialização será disparado automaticamente em nenhuma condição de falha.</span><span class="sxs-lookup"><span data-stu-id="1bf79-170">Indicates that no failover or restart will be triggered automatically on any failure conditions.</span></span> <span data-ttu-id="1bf79-171">Esse nível destina-se apenas a fins de manutenção do sistema.</span><span class="sxs-lookup"><span data-stu-id="1bf79-171">This level is for system maintenance purposes only.</span></span>|  
|<span data-ttu-id="1bf79-172">1</span><span class="sxs-lookup"><span data-stu-id="1bf79-172">1</span></span>|<span data-ttu-id="1bf79-173">Failover ou reinicialização quando o servidor estiver inativo</span><span class="sxs-lookup"><span data-stu-id="1bf79-173">Failover or restart on server down</span></span>|<span data-ttu-id="1bf79-174">Indica que uma reinicialização ou failover de servidor será disparado se a seguinte condição for gerada:</span><span class="sxs-lookup"><span data-stu-id="1bf79-174">Indicates that a server restart or failover will be triggered if the following condition is raised:</span></span><br /><br /> <span data-ttu-id="1bf79-175">O serviço SQL Server está inativo.</span><span class="sxs-lookup"><span data-stu-id="1bf79-175">SQL Server service is down.</span></span>|  
|<span data-ttu-id="1bf79-176">2</span><span class="sxs-lookup"><span data-stu-id="1bf79-176">2</span></span>|<span data-ttu-id="1bf79-177">Failover ou reinicialização em caso de servidor sem resposta</span><span class="sxs-lookup"><span data-stu-id="1bf79-177">Failover or restart on server unresponsive</span></span>|<span data-ttu-id="1bf79-178">Indica que uma reinicialização ou failover de servidor será disparado uma destas condições for gerada:</span><span class="sxs-lookup"><span data-stu-id="1bf79-178">Indicates that a server restart or failover will be triggered if any of the following conditions are raised:</span></span><br /><br /> <span data-ttu-id="1bf79-179">O serviço SQL Server está inativo.</span><span class="sxs-lookup"><span data-stu-id="1bf79-179">SQL Server service is down.</span></span><br /><br /> <span data-ttu-id="1bf79-180">A instância do SQL Server não está respondendo (a DLL do Recurso não pode receber dados de sp_server_diagnostics nas configurações de HealthCheckTimeout).</span><span class="sxs-lookup"><span data-stu-id="1bf79-180">SQL Server instance is not responsive (Resource DLL cannot receive data from sp_server_diagnostics within the HealthCheckTimeout settings).</span></span>|  
|<span data-ttu-id="1bf79-181">3\*</span><span class="sxs-lookup"><span data-stu-id="1bf79-181">3\*</span></span>|<span data-ttu-id="1bf79-182">Failover ou reinicialização em caso de erros críticos de servidor</span><span class="sxs-lookup"><span data-stu-id="1bf79-182">Failover or restart on critical server errors</span></span>|<span data-ttu-id="1bf79-183">Indica que uma reinicialização ou failover de servidor será disparado uma destas condições for gerada:</span><span class="sxs-lookup"><span data-stu-id="1bf79-183">Indicates that a server restart or failover will be triggered if any of the following conditions are raised:</span></span><br /><br /> <span data-ttu-id="1bf79-184">O serviço SQL Server está inativo.</span><span class="sxs-lookup"><span data-stu-id="1bf79-184">SQL Server service is down.</span></span><br /><br /> <span data-ttu-id="1bf79-185">A instância do SQL Server não está respondendo (a DLL do Recurso não pode receber dados de sp_server_diagnostics nas configurações de HealthCheckTimeout).</span><span class="sxs-lookup"><span data-stu-id="1bf79-185">SQL Server instance is not responsive (Resource DLL cannot receive data from sp_server_diagnostics within the HealthCheckTimeout settings).</span></span><br /><br /> <span data-ttu-id="1bf79-186">O procedimento armazenado de sistema sp_server_diagnostics retorna 'erro de sistema'.</span><span class="sxs-lookup"><span data-stu-id="1bf79-186">System stored procedure sp_server_diagnostics returns 'system error'.</span></span>|  
|<span data-ttu-id="1bf79-187">4</span><span class="sxs-lookup"><span data-stu-id="1bf79-187">4</span></span>|<span data-ttu-id="1bf79-188">Failover ou reinicialização em caso de erros moderados de servidor</span><span class="sxs-lookup"><span data-stu-id="1bf79-188">Failover or restart on moderate server errors</span></span>|<span data-ttu-id="1bf79-189">Indica que uma reinicialização ou failover de servidor será disparado uma destas condições for gerada:</span><span class="sxs-lookup"><span data-stu-id="1bf79-189">Indicates that a server restart or failover will be triggered if any of the following conditions are raised:</span></span><br /><br /> <span data-ttu-id="1bf79-190">O serviço SQL Server está inativo.</span><span class="sxs-lookup"><span data-stu-id="1bf79-190">SQL Server service is down.</span></span><br /><br /> <span data-ttu-id="1bf79-191">A instância do SQL Server não está respondendo (a DLL do Recurso não pode receber dados de sp_server_diagnostics nas configurações de HealthCheckTimeout).</span><span class="sxs-lookup"><span data-stu-id="1bf79-191">SQL Server instance is not responsive (Resource DLL cannot receive data from sp_server_diagnostics within the HealthCheckTimeout settings).</span></span><br /><br /> <span data-ttu-id="1bf79-192">O procedimento armazenado de sistema sp_server_diagnostics retorna 'erro de sistema'.</span><span class="sxs-lookup"><span data-stu-id="1bf79-192">System stored procedure sp_server_diagnostics returns 'system error'.</span></span><br /><br /> <span data-ttu-id="1bf79-193">O procedimento armazenado de sistema sp_server_diagnostics retorna 'erro de recurso'.</span><span class="sxs-lookup"><span data-stu-id="1bf79-193">System  stored procedure sp_server_diagnostics returns 'resource error'.</span></span>|  
|<span data-ttu-id="1bf79-194">5</span><span class="sxs-lookup"><span data-stu-id="1bf79-194">5</span></span>|<span data-ttu-id="1bf79-195">Failover ou reinicialização em qualquer condição de falha qualificada</span><span class="sxs-lookup"><span data-stu-id="1bf79-195">Failover or restart on any qualified failure conditions</span></span>|<span data-ttu-id="1bf79-196">Indica que uma reinicialização ou failover de servidor será disparado uma destas condições for gerada:</span><span class="sxs-lookup"><span data-stu-id="1bf79-196">Indicates that a server restart or failover will be triggered if any of the following conditions are raised:</span></span><br /><br /> <span data-ttu-id="1bf79-197">O serviço SQL Server está inativo.</span><span class="sxs-lookup"><span data-stu-id="1bf79-197">SQL Server service is down.</span></span><br /><br /> <span data-ttu-id="1bf79-198">A instância do SQL Server não está respondendo (a DLL do Recurso não pode receber dados de sp_server_diagnostics nas configurações de HealthCheckTimeout).</span><span class="sxs-lookup"><span data-stu-id="1bf79-198">SQL Server instance is not responsive (Resource DLL cannot receive data from sp_server_diagnostics within the HealthCheckTimeout settings).</span></span><br /><br /> <span data-ttu-id="1bf79-199">O procedimento armazenado de sistema sp_server_diagnostics retorna 'erro de sistema'.</span><span class="sxs-lookup"><span data-stu-id="1bf79-199">System stored procedure sp_server_diagnostics returns 'system error'.</span></span><br /><br /> <span data-ttu-id="1bf79-200">O procedimento armazenado de sistema sp_server_diagnostics retorna 'erro de recurso'.</span><span class="sxs-lookup"><span data-stu-id="1bf79-200">System  stored procedure sp_server_diagnostics returns 'resource error'.</span></span><br /><br /> <span data-ttu-id="1bf79-201">O procedimento armazenado de sistema sp_server_diagnostics retorna 'query_processing error'.</span><span class="sxs-lookup"><span data-stu-id="1bf79-201">System stored procedure sp_server_diagnostics returns 'query_processing error'.</span></span>|  
  
 <span data-ttu-id="1bf79-202">\*Valor padrão</span><span class="sxs-lookup"><span data-stu-id="1bf79-202">\*Default Value</span></span>  
  
####  <a name="responding-to-failures"></a><a name="respond"></a> <span data-ttu-id="1bf79-203">Respondendo a falhas</span><span class="sxs-lookup"><span data-stu-id="1bf79-203">Responding to Failures</span></span>  
 <span data-ttu-id="1bf79-204">Após a detecção de uma ou mais condições de falha, como o serviço do WSFC responderá às falhas dependerá do estado do quorum do WSFC e das configurações de reinicialização e failover do grupo de recursos de FCI.</span><span class="sxs-lookup"><span data-stu-id="1bf79-204">After one or more failure conditions are detected, how the WSFC service responds to the failures depends on the WSFC quorum state and the restart and failover settings of the FCI resource group.</span></span> <span data-ttu-id="1bf79-205">Se a FCI tiver perdido seu quorum do WSFC, toda a FCI é colocada offline e a FCI perdeu sua alta disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="1bf79-205">If the FCI has lost its WSFC quorum, then the entire FCI is brought offline and the FCI has lost its high availability.</span></span> <span data-ttu-id="1bf79-206">Se a FCI ainda tiver seu quorum do WSFC, o serviço do WSFC poderá responder primeiro tentando reiniciar o nó com falha e depois executando failover se as tentativas de reinicialização não forem bem-sucedidas.</span><span class="sxs-lookup"><span data-stu-id="1bf79-206">If the FCI still retains its WSFC quorum, then the WSFC service may respond by first attempting to restart the failed node and then failover if the restart attempts are unsuccessful.</span></span> <span data-ttu-id="1bf79-207">As configurações de reinicialização e failover são definidas no snap-in Gerenciador de Cluster de Failover.</span><span class="sxs-lookup"><span data-stu-id="1bf79-207">The restart and failover settings are configured in the Failover Cluster Manager snap-in.</span></span> <span data-ttu-id="1bf79-208">Para obter mais informações sobre essas configurações, consulte [ \<Resource> Propriedades: guia políticas](https://technet.microsoft.com/library/cc725685.aspx).</span><span class="sxs-lookup"><span data-stu-id="1bf79-208">For more information these settings, see [\<Resource> Properties: Policies Tab](https://technet.microsoft.com/library/cc725685.aspx).</span></span>  
  
 <span data-ttu-id="1bf79-209">Para obter mais informações sobre como manter a integridade do quórum, veja [Configuração de modos de quorum e votação do WSFC &#40;SQL Server&#41;](wsfc-quorum-modes-and-voting-configuration-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="1bf79-209">For more information on maintaining quorum health, see [WSFC Quorum Modes and Voting Configuration &#40;SQL Server&#41;](wsfc-quorum-modes-and-voting-configuration-sql-server.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1bf79-210">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="1bf79-210">See Also</span></span>  
 [<span data-ttu-id="1bf79-211">ALTER SERVER CONFIGURATION &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="1bf79-211">ALTER SERVER CONFIGURATION &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/alter-server-configuration-transact-sql)  
  
  
