---
title: Referências de coleções de campos de conjuntos de dados (Construtor de Relatórios e SSRS) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
ms.assetid: 006c6bd3-d776-4c20-9092-32e40688ac49
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 9e4140c35f8035e3ac8fae37aefb9d7f2afcaecc
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87582325"
---
# <a name="dataset-fields-collection-references-report-builder-and-ssrs"></a><span data-ttu-id="40f23-102">Referências de coleções de campos de conjuntos de dados (Construtor de Relatórios e SSRS)</span><span class="sxs-lookup"><span data-stu-id="40f23-102">Dataset Fields Collection References (Report Builder and SSRS)</span></span>
  <span data-ttu-id="40f23-103">Cada conjunto de dados de um relatório contém uma coleção Fields.</span><span class="sxs-lookup"><span data-stu-id="40f23-103">Each dataset in a report contains one Fields collection.</span></span> <span data-ttu-id="40f23-104">A coleção Fields é o conjunto de campos especificado pela consulta do conjunto de dados, além de qualquer campo calculado adicional que você criar.</span><span class="sxs-lookup"><span data-stu-id="40f23-104">The Fields collection is the set of fields specified by the dataset query plus any additional calculated fields that you create.</span></span> <span data-ttu-id="40f23-105">Assim que você criar um conjunto de dados, a coleção de campos aparecerá no painel **Dados do Relatório** .</span><span class="sxs-lookup"><span data-stu-id="40f23-105">After you create a dataset, the field collection appears in the **Report Data** pane.</span></span>  
  
 <span data-ttu-id="40f23-106">Uma referência de campo simples em uma expressão é exibida na superfície de design como uma expressão simples.</span><span class="sxs-lookup"><span data-stu-id="40f23-106">A simple field reference in an expression displays on the design surface as a simple expression.</span></span> <span data-ttu-id="40f23-107">Por exemplo, quando você arrasta o campo `Sales` do painel de dados do relatório para uma célula de tabela na superfície de design, o `[Sales]` é exibido.</span><span class="sxs-lookup"><span data-stu-id="40f23-107">For example, when you drag the field `Sales` from the Report Data pane to a table cell on the design surface, `[Sales]` is displayed.</span></span> <span data-ttu-id="40f23-108">Isso representa a expressão subjacente `=Fields!Sales.Value` definida na propriedade Value da caixa de texto.</span><span class="sxs-lookup"><span data-stu-id="40f23-108">This represents the underlying expression `=Fields!Sales.Value` that is set on the text box Value property.</span></span> <span data-ttu-id="40f23-109">Quando o relatório for executado, o processador de relatório avaliará essa expressão e exibirá os dados reais a partir da fonte de dados na caixa de texto da célula de tabela.</span><span class="sxs-lookup"><span data-stu-id="40f23-109">When the report runs, the report processor evaluates this expression and displays the actual data from the data source in the text box in the table cell.</span></span> <span data-ttu-id="40f23-110">Para obter mais informações, consulte [Expressões &#40;Construtor de Relatórios e SSRS&#41;](expressions-report-builder-and-ssrs.md) e [Coleção de campos de conjuntos de dados &#40;Construtor de Relatórios e SSRS&#41;](../report-data/dataset-fields-collection-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="40f23-110">For more, see [Expressions &#40;Report Builder and SSRS&#41;](expressions-report-builder-and-ssrs.md) and [Dataset Fields Collection &#40;Report Builder and SSRS&#41;](../report-data/dataset-fields-collection-report-builder-and-ssrs.md).</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
## <a name="displaying-the-field-collection-for-a-dataset"></a><span data-ttu-id="40f23-111">Exibindo a coleção de campos de um conjunto de dados</span><span class="sxs-lookup"><span data-stu-id="40f23-111">Displaying the Field Collection for a Dataset</span></span>  
 <span data-ttu-id="40f23-112">Para exibir os valores individuais de uma coleção de dados, arraste cada campo para uma linha de detalhes da tabela e execute o relatório.</span><span class="sxs-lookup"><span data-stu-id="40f23-112">To display the individual values for a field collection, drag each field to a table detail row and run the report.</span></span> <span data-ttu-id="40f23-113">Referências provenientes da linha de detalhes de uma tabela ou da região de dados da lista exibem um valor para cada linha do conjunto de dados.</span><span class="sxs-lookup"><span data-stu-id="40f23-113">References from the detail row of a table or list data region display a value for each row in the dataset.</span></span>  
  
 <span data-ttu-id="40f23-114">Para exibir valores resumidos para o campo, arraste cada campo numérico para a área de dados de uma matriz.</span><span class="sxs-lookup"><span data-stu-id="40f23-114">To display summarized values for a field, drag each numeric field to the data area of a matrix.</span></span> <span data-ttu-id="40f23-115">A função de agregação padrão de total da linha é Sum, por exemplo, `=Sum(Fields!Sales.Value)`.</span><span class="sxs-lookup"><span data-stu-id="40f23-115">The default aggregate function for the total row is Sum, for example, `=Sum(Fields!Sales.Value)`.</span></span> <span data-ttu-id="40f23-116">Você também pode alterar a função padrão para calcular outros totais.</span><span class="sxs-lookup"><span data-stu-id="40f23-116">You can change the default function in order to calculate different totals.</span></span> <span data-ttu-id="40f23-117">Para obter mais informações, consulte [Referência de funções de agregação &#40;Construtor de Relatórios e SSRS&#41;](report-builder-functions-aggregate-functions-reference.md).</span><span class="sxs-lookup"><span data-stu-id="40f23-117">For more information, see [Aggregate Functions Reference &#40;Report Builder and SSRS&#41;](report-builder-functions-aggregate-functions-reference.md).</span></span>  
  
 <span data-ttu-id="40f23-118">Para exibir valores resumidos de uma coleção de campos em uma caixa de texto diretamente na superfície de design (não parte de uma região de dados), especifique o nome do conjunto de dados como um escopo da função de agregação.</span><span class="sxs-lookup"><span data-stu-id="40f23-118">To display summarized values for a field collection in a text box directly on the design surface (not part of a data region), you must specify the dataset name as a scope for the aggregate function.</span></span> <span data-ttu-id="40f23-119">Por exemplo, para um conjunto de dados chamado `SalesData`, a expressão a seguir especifica o total de todos os valores do campo `Sales`: `=Sum(Fields!Sales,"SalesData")`.</span><span class="sxs-lookup"><span data-stu-id="40f23-119">For example, for a dataset named `SalesData`, the following expression specifies the total of all values for the field `Sales`: `=Sum(Fields!Sales,"SalesData")`.</span></span>  
  
 <span data-ttu-id="40f23-120">Quando você usa a caixa de diálogo **Expressão** para definir uma referência de campo simples, é possível selecionar a coleção Fields no painel Categoria e ver a lista de campos disponíveis no painel **Campo** .</span><span class="sxs-lookup"><span data-stu-id="40f23-120">When you use the **Expression** dialog box to define a simple field reference, you can select the Fields collection in the Category pane and see the list of available fields in the **Field** pane.</span></span> <span data-ttu-id="40f23-121">Cada campo tem várias propriedades, incluindo o Value e IsMissing.</span><span class="sxs-lookup"><span data-stu-id="40f23-121">Each field has several properties, including Value and IsMissing.</span></span> <span data-ttu-id="40f23-122">As demais propriedades são propriedades de campo estendidas predefinidas que podem estar disponíveis para o conjunto de dados, dependendo do tipo de fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="40f23-122">The remaining properties are predefined extended field properties that may be available to the dataset depending on the data source type.</span></span>  
  
### <a name="detecting-nulls-for-a-dataset-field"></a><span data-ttu-id="40f23-123">Detectando nulos para um campo do conjunto de dados</span><span class="sxs-lookup"><span data-stu-id="40f23-123">Detecting Nulls for a Dataset Field</span></span>  
 <span data-ttu-id="40f23-124">Para detectar se o valor de um campo é nulo (`Nothing` em [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]), use a função `IsNothing`.</span><span class="sxs-lookup"><span data-stu-id="40f23-124">To detect a field value that is null (`Nothing` in [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]), you can use the function `IsNothing`.</span></span> <span data-ttu-id="40f23-125">Se ela for incluída em uma caixa de texto de uma linha de detalhes de tabela, a expressão a seguir testará o campo `MiddleName` e substituirá o texto "No Middle Name" quando o valor for nulo e o próprio valor do campo quando esse valor não for nulo:</span><span class="sxs-lookup"><span data-stu-id="40f23-125">When placed in a text box in a table details row, the following expression tests the field `MiddleName` and substitutes the text "No Middle Name" when the value is null, and the field value itself when the value is not null:</span></span>  
  
 `=IIF(IsNothing(Fields!MiddleName.Value),"No Middle Name",Fields!MiddleName.Value)`  
  
### <a name="detecting-missing-fields-for-dynamic-queries-at-run-time"></a><span data-ttu-id="40f23-126">Detectando campos ausentes em consultas dinâmicas em tempo de execução</span><span class="sxs-lookup"><span data-stu-id="40f23-126">Detecting Missing Fields for Dynamic Queries at Run Time</span></span>  
 <span data-ttu-id="40f23-127">Por padrão, os itens na coleção Fields têm duas propriedades: Value e IsMissing.</span><span class="sxs-lookup"><span data-stu-id="40f23-127">By default, items in the Fields collection have two properties: Value and IsMissing.</span></span> <span data-ttu-id="40f23-128">A propriedade IsMissing indica se um campo que foi definido para um conjunto de dados em tempo de design estará contido em um dos campos recuperados em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="40f23-128">The IsMissing property indicates whether a field that is defined for a dataset at design time is contained in the fields retrieved at run time.</span></span> <span data-ttu-id="40f23-129">Por exemplo, sua consulta pode chamar um procedimento armazenado no qual o conjunto de resultados varia com um parâmetro de entrada ou sua consulta pode ser `SELECT * FROM` *\<table>* onde a definição da tabela foi alterada.</span><span class="sxs-lookup"><span data-stu-id="40f23-129">For example, your query might call a stored procedure in which the result set varies with an input parameter, or your query might be `SELECT * FROM` *\<table>* where the table definition changed.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="40f23-130">IsMissing detecta alterações no esquema do conjunto de dados entre o tempo de design e o tempo de execução de qualquer tipo de fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="40f23-130">IsMissing detects changes in the dataset schema between design time and run time for any type of data source.</span></span> <span data-ttu-id="40f23-131">IsMissing não pode ser usado para detectar Membros vazios em um cubo multidimensional e não está relacionado aos conceitos de linguagem de consulta MDX do `EMPTY` e do `NON EMPTY` .</span><span class="sxs-lookup"><span data-stu-id="40f23-131">IsMissing cannot be used to detect empty members in a multidimensional cube and is not related to the MDX query language concepts of `EMPTY` and `NON EMPTY`.</span></span>  
  
 <span data-ttu-id="40f23-132">É possível testar a propriedade IsMissing em código personalizado para determinar a existência de um campo em um conjunto de resultados.</span><span class="sxs-lookup"><span data-stu-id="40f23-132">You can test the IsMissing property in custom code to determine if a field is present in the result set.</span></span> <span data-ttu-id="40f23-133">Não é possível testar sua presença usando uma expressão com uma chamada de função [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)], como `IIF` ou `SWITCH`, pois [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] avalia todos os parâmetros da chamada de função, resultando em um erro quando a referência ao campo ausente for avaliada.</span><span class="sxs-lookup"><span data-stu-id="40f23-133">You cannot test for its presence using an expression with a [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] function call such as `IIF` or `SWITCH`, because [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] evaluates all parameters in the call to the function, which results in an error when the reference to the missing is evaluated.</span></span>  
  
#### <a name="example-for-controlling-the-visibility-of-a-dynamic-column-for-a-missing-field"></a><span data-ttu-id="40f23-134">Exemplo de controle da visibilidade de uma coluna dinâmica de um campo ausente</span><span class="sxs-lookup"><span data-stu-id="40f23-134">Example for Controlling the Visibility of a Dynamic Column for a Missing Field</span></span>  
 <span data-ttu-id="40f23-135">Para definir uma expressão que controla a visibilidade de uma coluna que exibe um campo em um conjunto de dados, primeiro defina uma função de código personalizado que retorne um valor booliano com base na existência ou ausência do campo.</span><span class="sxs-lookup"><span data-stu-id="40f23-135">To set an expression that controls the visibility of a column that displays a field in a dataset, you must first define a custom code function that returns a Boolean value based on whether the field is missing.</span></span> <span data-ttu-id="40f23-136">Por exemplo, a função de código personalizado a seguir retornará verdadeiro se o campo estiver ausente e falso se ele existir.</span><span class="sxs-lookup"><span data-stu-id="40f23-136">For example, the following custom code function returns true if the field is missing and false if the field exists.</span></span>  
  
```  
Public Function IsFieldMissing(field as Field) as Boolean  
 If (field.IsMissing) Then  
 Return True  
  Else   
  Return False  
 End If  
End Function  
```  
  
 <span data-ttu-id="40f23-137">Para usar essa função para controlar a visibilidade de uma coluna, defina a propriedade Hidden da coluna como a seguinte expressão:</span><span class="sxs-lookup"><span data-stu-id="40f23-137">To use this function to control visibility of a column, set the Hidden property of the column to the following expression:</span></span>  
  
 `=Code.IsFieldMissing(Fields!FieldName)`  
  
 <span data-ttu-id="40f23-138">A coluna ficará oculta se o campo não existir.</span><span class="sxs-lookup"><span data-stu-id="40f23-138">The column is hidden when the field does not exist.</span></span>  
  
#### <a name="example-for-controlling-the-text-box-value-for-a-missing-field"></a><span data-ttu-id="40f23-139">Exemplo de controle da visibilidade de um valor de caixa de texto de um campo ausente</span><span class="sxs-lookup"><span data-stu-id="40f23-139">Example for Controlling the Text Box Value for a Missing Field</span></span>  
 <span data-ttu-id="40f23-140">Para usar o texto que você escrever em substituição do valor de um campo ausente, escreva um código personalizado que retorne o texto que você possa usar no lugar do valor do campo quando o campo estiver ausente.</span><span class="sxs-lookup"><span data-stu-id="40f23-140">To substitute text that you write in place of the value of a missing field, you must write custom code that returns text you can use in place of a field value when the field is missing.</span></span> <span data-ttu-id="40f23-141">Por exemplo, a função de código personalizado a seguir retornará o valor do campo se o campo existir e a mensagem indicando que você deve especificar o segundo parâmetro se o campo não existir:</span><span class="sxs-lookup"><span data-stu-id="40f23-141">For example, the following custom code function returns the value of the field if the field exists, and the message that you specify as the second parameter if the field does not exist:</span></span>  
  
```  
Public Function IsFieldMissingThenString(field as Field, strMessage as String) as String  
 If (field.IsMissing) Then  
  Return strMessage  
 Else   
  Return field.Value  
  End If  
End Function  
```  
  
 <span data-ttu-id="40f23-142">Para usar essa função em uma caixa de texto, adicione a seguinte expressão à propriedade Value:</span><span class="sxs-lookup"><span data-stu-id="40f23-142">To use this function in a text box, add the following expression to the Value property:</span></span>  
  
 `=Code.IsFieldMissingThenString(Fields!FieldName,"Missing")`  
  
 <span data-ttu-id="40f23-143">A caixa de texto exibe o valor do campo ou o texto que você especificou.</span><span class="sxs-lookup"><span data-stu-id="40f23-143">The text box displays either the field value or the text that you specified.</span></span>  
  
### <a name="using-extended-field-properties"></a><span data-ttu-id="40f23-144">Usando propriedades de campo estendidas</span><span class="sxs-lookup"><span data-stu-id="40f23-144">Using Extended Field Properties</span></span>  
 <span data-ttu-id="40f23-145">As propriedades de campo estendidas são propriedades adicionais definidas em um campo pela extensão de processamento de dados, que é determinada pelo tipo de fonte de dados do conjunto de dados.</span><span class="sxs-lookup"><span data-stu-id="40f23-145">Extended field properties are additional properties defined on a field by the data processing extension, which is determined by the data source type for the dataset.</span></span> <span data-ttu-id="40f23-146">As propriedades de campo estendidas são predefinidas ou específicas para um tipo de fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="40f23-146">Extended field properties are predefined or specific to a data source type.</span></span> <span data-ttu-id="40f23-147">Para obter mais informações, consulte [Propriedades de campos estendidos para um banco de dados do Analysis Services &#40;SSRS&#41;](../report-data/extended-field-properties-for-an-analysis-services-database-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="40f23-147">For more information, see [Extended Field Properties for an Analysis Services Database &#40;SSRS&#41;](../report-data/extended-field-properties-for-an-analysis-services-database-ssrs.md).</span></span>  
  
 <span data-ttu-id="40f23-148">Se você especificar uma propriedade que não é suportada pelo campo, a avaliação da expressão será `null` (`Nothing` em [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]).</span><span class="sxs-lookup"><span data-stu-id="40f23-148">If you specify a property that is not supported for that field, the expression evaluates to `null` (`Nothing` in [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]).</span></span> <span data-ttu-id="40f23-149">Se um provedor de dados não oferecer suporte a propriedades de campo estendidas, ou se o campo não for encontrado quando a consulta for executada, o valor da propriedade será \`null` (`Nothing` em [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]) para propriedades do tipo `String` e `Object` e zero (0) para propriedades do tipo `Integer\`.</span><span class="sxs-lookup"><span data-stu-id="40f23-149">If a data provider does not support extended field properties, or if the field is not found when the query is executed, the value for the property is `null` (`Nothing` in [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]) for properties of type `String` and `Object`, and zero (0) for properties of type `Integer`.</span></span> <span data-ttu-id="40f23-150">Uma extensão de processamento de dados pode fazer bom uso das propriedades predefinidas ao otimizar consultas que incluem essa sintaxe.</span><span class="sxs-lookup"><span data-stu-id="40f23-150">A data processing extension may take advantage of predefined properties by optimizing queries that include this syntax.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="40f23-151">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="40f23-151">See Also</span></span>  
 <span data-ttu-id="40f23-152">[Exemplos de expressões &#40;Construtor de Relatórios e SSRS&#41;](expression-examples-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="40f23-152">[Expression Examples &#40;Report Builder and SSRS&#41;](expression-examples-report-builder-and-ssrs.md) </span></span>  
 [<span data-ttu-id="40f23-153">Adicionar dados a um relatório &#40;Construtor de Relatórios e SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="40f23-153">Add Data to a Report &#40;Report Builder and SSRS&#41;</span></span>](../report-data/report-datasets-ssrs.md)  
  
  
