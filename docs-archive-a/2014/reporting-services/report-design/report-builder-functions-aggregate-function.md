---
title: Função de agregação (Construtor de Relatórios e SSRS) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
ms.assetid: 16ce643f-bbb3-40a5-ba78-7aed73156f3e
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: fcc65f1e60c29ba9ea6a4206b419eb0b13edb0ff
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87574498"
---
# <a name="aggregate-function-report-builder-and-ssrs"></a><span data-ttu-id="00d1b-102">Função de agregação (Construtor de Relatórios e SSRS)</span><span class="sxs-lookup"><span data-stu-id="00d1b-102">Aggregate Function (Report Builder and SSRS)</span></span>
  <span data-ttu-id="00d1b-103">Retorna uma agregação personalizada da expressão especificada, conforme definido pelo provedor de dados.</span><span class="sxs-lookup"><span data-stu-id="00d1b-103">Returns a custom aggregate of the specified expression, as defined by the data provider.</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
## <a name="syntax"></a><span data-ttu-id="00d1b-104">Sintaxe</span><span class="sxs-lookup"><span data-stu-id="00d1b-104">Syntax</span></span>  
  
```  
  
Aggregate(expression, scope)  
```  
  
#### <a name="parameters"></a><span data-ttu-id="00d1b-105">parâmetros</span><span class="sxs-lookup"><span data-stu-id="00d1b-105">Parameters</span></span>  
 <span data-ttu-id="00d1b-106">*expressão*</span><span class="sxs-lookup"><span data-stu-id="00d1b-106">*expression*</span></span>  
 <span data-ttu-id="00d1b-107">A expressão na qual executar a agregação.</span><span class="sxs-lookup"><span data-stu-id="00d1b-107">The expression on which to perform the aggregation.</span></span> <span data-ttu-id="00d1b-108">A expressão deve ser uma referência de campo simples.</span><span class="sxs-lookup"><span data-stu-id="00d1b-108">The expression must be a simple field reference.</span></span>  
  
 <span data-ttu-id="00d1b-109">*escopo*</span><span class="sxs-lookup"><span data-stu-id="00d1b-109">*scope*</span></span>  
 <span data-ttu-id="00d1b-110">(`String`) O nome de um conjunto de dados, grupo ou região de dados que contém os itens do relatório aos quais a função de agregação deve ser aplicada.</span><span class="sxs-lookup"><span data-stu-id="00d1b-110">(`String`) The name of a dataset, group, or data region that contains the report items to which to apply the aggregate function.</span></span> <span data-ttu-id="00d1b-111">*Scope* deve ser uma constante de cadeia de caracteres e não pode ser uma expressão.</span><span class="sxs-lookup"><span data-stu-id="00d1b-111">*Scope* must be a string constant andcannot be an expression.</span></span> <span data-ttu-id="00d1b-112">Se *scope* não estiver especificado, será usado o escopo atual.</span><span class="sxs-lookup"><span data-stu-id="00d1b-112">If *scope* is not specified, the current scope is used.</span></span>  
  
## <a name="return-type"></a><span data-ttu-id="00d1b-113">Tipo de retorno</span><span class="sxs-lookup"><span data-stu-id="00d1b-113">Return Type</span></span>  
 <span data-ttu-id="00d1b-114">O tipo de retorno é determinado pelo provedor de dados.</span><span class="sxs-lookup"><span data-stu-id="00d1b-114">Return type is determined by the data provider.</span></span> <span data-ttu-id="00d1b-115">Retornará `Nothing` se o provedor de dados não oferecer suporte a esta função ou se os dados não estiverem disponíveis.</span><span class="sxs-lookup"><span data-stu-id="00d1b-115">Returns `Nothing` if the data provider does not support this function or data is not available.</span></span>  
  
## <a name="remarks"></a><span data-ttu-id="00d1b-116">Comentários</span><span class="sxs-lookup"><span data-stu-id="00d1b-116">Remarks</span></span>  
 <span data-ttu-id="00d1b-117">A função `Aggregate` fornece um método para usar agregações que são calculadas na fonte de dados externa.</span><span class="sxs-lookup"><span data-stu-id="00d1b-117">The `Aggregate` function provides a way to use aggregates that are calculated on the external data source.</span></span> <span data-ttu-id="00d1b-118">O suporte para esse recurso é determinado pela extensão de dados.</span><span class="sxs-lookup"><span data-stu-id="00d1b-118">Support for this feature is determined by the data extension.</span></span> <span data-ttu-id="00d1b-119">Por exemplo, a extensão de processamento de dados do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] recupera conjuntos de linhas simples de uma consulta MDX.</span><span class="sxs-lookup"><span data-stu-id="00d1b-119">For example, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] data processing extension retrieves flattened rowsets from an MDX query.</span></span> <span data-ttu-id="00d1b-120">Algumas linhas no conjunto de resultados podem conter valores de agregação calculados no servidor de fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="00d1b-120">Some rows in the result set can contain aggregate values calculated on the data source server.</span></span> <span data-ttu-id="00d1b-121">Eles são conhecidos como *agregações do servidor*.</span><span class="sxs-lookup"><span data-stu-id="00d1b-121">These are known as *server aggregates*.</span></span> <span data-ttu-id="00d1b-122">Para exibir as agregações do servidor no designer de consultas gráficas para [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], é possível usar o botão **Mostrar Agregação** na barra de ferramentas.</span><span class="sxs-lookup"><span data-stu-id="00d1b-122">To view server aggregates in the graphical query designer for [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], you can use the **Show Aggregate** button on the toolbar.</span></span> <span data-ttu-id="00d1b-123">Para obter mais informações, consulte [Interface do usuário do Designer de Consultas MDX do Analysis Services &#40;Construtor de Relatórios&#41;](../analysis-services-mdx-query-designer-user-interface-report-builder.md).</span><span class="sxs-lookup"><span data-stu-id="00d1b-123">For more information, see [Analysis Services MDX Query Designer User Interface &#40;Report Builder&#41;](../analysis-services-mdx-query-designer-user-interface-report-builder.md).</span></span>  
  
 <span data-ttu-id="00d1b-124">Ao exibir a combinação de valores de agregação e do conjunto de dados de detalhes nas linhas de detalhes de uma região de dados Tablix, normalmente as agregações do servidor não são incluídas porque não são dados de detalhes.</span><span class="sxs-lookup"><span data-stu-id="00d1b-124">When you display the combination of aggregate and detail dataset values on detail rows of a Tablix data region, server aggregates would not typically be included because they are not detail data.</span></span> <span data-ttu-id="00d1b-125">No entanto, talvez você queira exibir todos os valores recuperados para o conjunto de dados e personalizar a maneira como os dados de agregação são calculados e exibidos.</span><span class="sxs-lookup"><span data-stu-id="00d1b-125">However, you may want to display all values retrieved for the dataset and customize the way aggregate data is calculated and displayed.</span></span>  
  
 <span data-ttu-id="00d1b-126">O [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] detecta o uso da função `Aggregate` em expressões no relatório para determinar se as agregações do servidor devem ser exibidas nas linhas de detalhes.</span><span class="sxs-lookup"><span data-stu-id="00d1b-126">[!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] detects the use of the `Aggregate` function in expressions in your report in order to determine whether to display server aggregates on detail rows.</span></span> <span data-ttu-id="00d1b-127">Se a `Aggregate` for incluída em uma expressão em uma região de dados, as agregações do servidor poderão ser exibidas apenas nas linhas do grupo total ou do total geral, não nas linhas de detalhes.</span><span class="sxs-lookup"><span data-stu-id="00d1b-127">If you include `Aggregate` in an expression in a data region, server aggregates can only appear on group total or grand total rows, not on detail rows.</span></span> <span data-ttu-id="00d1b-128">Para exibir as agregações do servidor nas linhas de detalhes, não use a função `Aggregate`.</span><span class="sxs-lookup"><span data-stu-id="00d1b-128">If you want to display server aggregates on detail rows, do not use the `Aggregate` function.</span></span>  
  
 <span data-ttu-id="00d1b-129">É possível alterar este comportamento padrão, alterando o valor da opção **Interpretar subtotais como detalhes** na caixa de diálogo **Propriedades do Conjunto de Dados** .</span><span class="sxs-lookup"><span data-stu-id="00d1b-129">You can change this default behavior by changing the value of the **Interpret subtotals as details** option on the **Dataset Properties** dialog box.</span></span> <span data-ttu-id="00d1b-130">Quando esta opção está definida como `True`, todos os dados, incluindo agregações do servidor, são exibidos como dados de detalhes.</span><span class="sxs-lookup"><span data-stu-id="00d1b-130">When this option is set to `True`, all data, including server aggregates, appears as detail data.</span></span> <span data-ttu-id="00d1b-131">Quando está definida como `False`, as agregações do servidor são exibidas como totais.</span><span class="sxs-lookup"><span data-stu-id="00d1b-131">When set to `False`, server aggregates appear as totals.</span></span> <span data-ttu-id="00d1b-132">A configuração desta propriedade afeta todas as regiões de dados vinculadas a este conjunto de dados.</span><span class="sxs-lookup"><span data-stu-id="00d1b-132">The setting for this property affects all data regions that are linked to this dataset.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="00d1b-133">Todos os grupos contentores do item de relatório que faz referência à `Aggregate` devem ter referências de campos simples para suas expressões de grupos, por exemplo, `[FieldName]`.</span><span class="sxs-lookup"><span data-stu-id="00d1b-133">All containing groups for the report item that references `Aggregate` must have simple field references for their group expressions, for example, `[FieldName]`.</span></span> <span data-ttu-id="00d1b-134">Não é possível usar a `Aggregate` em uma região de dados que usa expressões de grupos complexas.</span><span class="sxs-lookup"><span data-stu-id="00d1b-134">You cannot use `Aggregate` in a data region that uses complex group expressions.</span></span> <span data-ttu-id="00d1b-135">Para a extensão de processamento de dados do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], a consulta deve incluir os campos MDX do tipo `LevelProperty` (e não do tipo `MemberProperty`) para dar suporte à agregação usando a função `Aggregate`.</span><span class="sxs-lookup"><span data-stu-id="00d1b-135">For the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] data processing extension, your query must include MDX fields of type `LevelProperty` (not `MemberProperty`) to support aggregation using the `Aggregate`function.</span></span>  
  
 <span data-ttu-id="00d1b-136">*Expression* pode conter chamadas para funções de agregação aninhadas com as seguintes exceções e condições:</span><span class="sxs-lookup"><span data-stu-id="00d1b-136">*Expression* can contain calls to nested aggregate functions with the following exceptions and conditions:</span></span>  
  
-   <span data-ttu-id="00d1b-137">*Scope* para agregações aninhadas deve ser igual ao escopo da agregação externa ou deve estar contido nela.</span><span class="sxs-lookup"><span data-stu-id="00d1b-137">*Scope* for nested aggregates must be the same as, or contained by, the scope of the outer aggregate.</span></span> <span data-ttu-id="00d1b-138">Para todos os escopos distintos na expressão, um escopo deve estar em uma relação filho com todos os outros escopos.</span><span class="sxs-lookup"><span data-stu-id="00d1b-138">For all distinct scopes in the expression, one scope must be in a child relationship to all other scopes.</span></span>  
  
-   <span data-ttu-id="00d1b-139">*Scope* para agregações aninhadas não pode ser o nome de um conjunto de dados.</span><span class="sxs-lookup"><span data-stu-id="00d1b-139">*Scope* for nested aggregates cannot be the name of a dataset.</span></span>  
  
-   <span data-ttu-id="00d1b-140">A *expressão* não deve conter `First` funções,, `Last` `Previous` ou `RunningValue` .</span><span class="sxs-lookup"><span data-stu-id="00d1b-140">*Expression* must not contain `First`, `Last`, `Previous`, or `RunningValue` functions.</span></span>  
  
-   <span data-ttu-id="00d1b-141">*Expression* não deve conter agregações aninhadas que especifiquem *recursive*.</span><span class="sxs-lookup"><span data-stu-id="00d1b-141">*Expression* must not contain nested aggregates that specify *recursive*.</span></span>  
  
 <span data-ttu-id="00d1b-142">Para obter mais informações, consulte [Referência de funções de agregação &#40;Construtor de Relatórios e SSRS&#41;](report-builder-functions-aggregate-functions-reference.md) e [Escopo das expressões para totais, agregações e coleções internas &#40;Construtor de Relatórios e SSRS&#41;](expression-scope-for-totals-aggregates-and-built-in-collections.md).</span><span class="sxs-lookup"><span data-stu-id="00d1b-142">For more information, see [Aggregate Functions Reference &#40;Report Builder and SSRS&#41;](report-builder-functions-aggregate-functions-reference.md) and [Expression Scope for Totals, Aggregates, and Built-in Collections &#40;Report Builder and SSRS&#41;](expression-scope-for-totals-aggregates-and-built-in-collections.md).</span></span>  
  
 <span data-ttu-id="00d1b-143">Para obter mais informações sobre agregações recursivas, consulte [Criando grupos de hierarquias recursivas &#40;Construtor de Relatórios e SSRS&#41;](creating-recursive-hierarchy-groups-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="00d1b-143">For more information about recursive aggregates, see [Creating Recursive Hierarchy Groups &#40;Report Builder and SSRS&#41;](creating-recursive-hierarchy-groups-report-builder-and-ssrs.md).</span></span>  
  
## <a name="comparing-the-aggregate-and-sum-functions"></a><span data-ttu-id="00d1b-144">Comparando as funções Agregação e Soma</span><span class="sxs-lookup"><span data-stu-id="00d1b-144">Comparing the Aggregate and Sum Functions</span></span>  
 <span data-ttu-id="00d1b-145">A função de `Aggregate` difere das funções de agregação numéricas, como `Sum`, pelo fato de que a função de `Aggregate` retorna um valor calculado pelo provedor de dados ou pela extensão de processamento de dados.</span><span class="sxs-lookup"><span data-stu-id="00d1b-145">The `Aggregate` function differs from numeric aggregate functions like `Sum` in that the `Aggregate` function returns a value that is calculated by the data provider or data processing extension.</span></span> <span data-ttu-id="00d1b-146">As funções de agregação numéricas `Sum` , como retornam um valor que é calculado pelo processador de relatório em um conjunto de dados do DataSet que é determinado pelo parâmetro de *escopo* .</span><span class="sxs-lookup"><span data-stu-id="00d1b-146">Numeric aggregate functions like `Sum` return a value that is calculated by the report processor on a set of data from the dataset that is determined by the *scope* parameter.</span></span> <span data-ttu-id="00d1b-147">Para obter mais informações, consulte as funções de agregação listadas em [Referência de funções de agregação &#40;Construtor de Relatórios e SSRS&#41;](report-builder-functions-aggregate-functions-reference.md).</span><span class="sxs-lookup"><span data-stu-id="00d1b-147">For more information, see the aggregate functions listed in [Aggregate Functions Reference &#40;Report Builder and SSRS&#41;](report-builder-functions-aggregate-functions-reference.md).</span></span>  
  
## <a name="example"></a><span data-ttu-id="00d1b-148">Exemplo</span><span class="sxs-lookup"><span data-stu-id="00d1b-148">Example</span></span>  
 <span data-ttu-id="00d1b-149">O seguinte exemplo de código mostra uma expressão que recupera uma agregação do servidor para o campo `LineTotal`.</span><span class="sxs-lookup"><span data-stu-id="00d1b-149">The following code example shows an expression that retrieves a server aggregate for the field `LineTotal`.</span></span> <span data-ttu-id="00d1b-150">A expressão é adicionada a uma célula em uma linha que pertence ao grupo `GroupbyOrder`.</span><span class="sxs-lookup"><span data-stu-id="00d1b-150">The expression is added to a cell in a row that belongs to the group `GroupbyOrder`.</span></span>  
  
```  
=Aggregate(Fields!LineTotal.Value, "GroupbyOrder")  
```  
  
## <a name="see-also"></a><span data-ttu-id="00d1b-151">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="00d1b-151">See Also</span></span>  
 <span data-ttu-id="00d1b-152">[Usos de expressões em relatórios &#40;Construtor de Relatórios e SSRS&#41;](expression-uses-in-reports-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="00d1b-152">[Expression Uses in Reports &#40;Report Builder and SSRS&#41;](expression-uses-in-reports-report-builder-and-ssrs.md) </span></span>  
 <span data-ttu-id="00d1b-153">[Exemplos de expressões &#40;Construtor de Relatórios e SSRS&#41;](expression-examples-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="00d1b-153">[Expression Examples &#40;Report Builder and SSRS&#41;](expression-examples-report-builder-and-ssrs.md) </span></span>  
 <span data-ttu-id="00d1b-154">[Tipos de dados em expressões &#40;Construtor de Relatórios e SSRS&#41;](expressions-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="00d1b-154">[Data Types in Expressions &#40;Report Builder and SSRS&#41;](expressions-report-builder-and-ssrs.md) </span></span>  
 [<span data-ttu-id="00d1b-155">Escopo das expressões para totais, agregações e coleções internas &#40;Construtor de Relatórios e SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="00d1b-155">Expression Scope for Totals, Aggregates, and Built-in Collections &#40;Report Builder and SSRS&#41;</span></span>](expression-scope-for-totals-aggregates-and-built-in-collections.md)  
  
  
