---
title: Referências de código personalizado e assemblies em expressões no Designer de Relatórios (SSRS) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
helpviewer_keywords:
- items [Reporting Services], expressions
- data [Reporting Services], expressions
- expressions [Reporting Services], about expressions
- expressions [Reporting Services]
- SSRS, expressions
- formulas [Reporting Services]
- data manipulation [Reporting Services]
- SQL Server Reporting Services, expressions
ms.assetid: ae8a0166-2ccc-45f4-8d28-c150da7b73de
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 0f895d1ecc569092dfbae22b514d3470e020b94d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87683442"
---
# <a name="custom-code-and-assembly-references-in-expressions-in-report-designer-ssrs"></a><span data-ttu-id="1c7be-102">Referências a código personalizado e assemblies em expressões no Designer de Relatórios (SSRS)</span><span class="sxs-lookup"><span data-stu-id="1c7be-102">Custom Code and Assembly References in Expressions in Report Designer (SSRS)</span></span>
  <span data-ttu-id="1c7be-103">É possível adicionar referências ao código personalizado inserido em um relatório ou aos assemblies personalizados criados e salvos em seu computador e implantá-los no servidor de relatório.</span><span class="sxs-lookup"><span data-stu-id="1c7be-103">You can add references to custom code embedded in a report or to custom assemblies that you build and save to your computer and deploy to the report server.</span></span> <span data-ttu-id="1c7be-104">Use o código inserido para constantes personalizadas, funções complexas ou funções usadas várias vezes em um mesmo relatório.</span><span class="sxs-lookup"><span data-stu-id="1c7be-104">Use embedded code for custom constants, complex functions or functions that are used multiple times in a single report.</span></span> <span data-ttu-id="1c7be-105">Use assemblies de código personalizado para manter o código em um único local e compartilhá-lo para uso em vários relatórios.</span><span class="sxs-lookup"><span data-stu-id="1c7be-105">Use custom code assemblies to maintain code in a single place and share it for use by multiple reports.</span></span> <span data-ttu-id="1c7be-106">O código personalizado pode incluir novas constantes, variáveis, funções ou sub-rotinas personalizadas.</span><span class="sxs-lookup"><span data-stu-id="1c7be-106">Custom code can include new custom constants, variables, functions, or subroutines.</span></span> <span data-ttu-id="1c7be-107">É possível incluir referências somente leitura em coleções internas, como a coleção de Parâmetros.</span><span class="sxs-lookup"><span data-stu-id="1c7be-107">You can include read-only references to built-in collections such as the Parameters collection.</span></span> <span data-ttu-id="1c7be-108">No entanto, não é possível passar conjuntos de valores de dados do relatório para funções personalizadas. Especificamente, não há suporte para agregações personalizadas.</span><span class="sxs-lookup"><span data-stu-id="1c7be-108">However, you cannot pass sets of report data values to custom functions; specifically, custom aggregates are not supported.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="1c7be-109">Para cálculos de detecção de hora avaliados uma vez em tempo de execução que você deseja manter com o mesmo valor ao longo do processamento do relatório, considere se uma variável de relatório ou uma variável de grupo deve ser usada.</span><span class="sxs-lookup"><span data-stu-id="1c7be-109">For time-sensitive calculations that are evaluated once at run-time and that you want to remain the same value throughout report processing, consider whether to use a report variable or group variable.</span></span> <span data-ttu-id="1c7be-110">Para obter mais informações, consulte [Referências de coleções de variáveis de grupo e de relatório &#40;Construtor de Relatórios e SSRS&#41;](built-in-collections-report-and-group-variables-references-report-builder.md).</span><span class="sxs-lookup"><span data-stu-id="1c7be-110">For more information, see [Report and Group Variables Collections References &#40;Report Builder and SSRS&#41;](built-in-collections-report-and-group-variables-references-report-builder.md).</span></span>  
  
 <span data-ttu-id="1c7be-111">O Designer de Relatórios é o ambiente de criação preferido a ser usado para adicionar código personalizado a um relatório.</span><span class="sxs-lookup"><span data-stu-id="1c7be-111">Report Designer is the preferred authoring environment to use to add custom code to a report.</span></span> <span data-ttu-id="1c7be-112">O Construtor de Relatórios dá suporte ao processamento de relatórios que têm expressões válidas ou que incluem referências a assemblies personalizados em um servidor de relatório.</span><span class="sxs-lookup"><span data-stu-id="1c7be-112">Report Builder supports processing reports that have valid expressions, or that include references to custom assemblies on a report server.</span></span> <span data-ttu-id="1c7be-113">O Construtor de Relatórios não fornece uma maneira de adicionar uma referência a um assembly personalizado.</span><span class="sxs-lookup"><span data-stu-id="1c7be-113">Report Builder does not provide a way to add a reference to a custom assembly.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="1c7be-114">Lembre-se de que, durante uma atualização de um servidor de relatório, os relatórios que dependem de assemblies personalizados podem exigir etapas adicionais para concluir a atualização.</span><span class="sxs-lookup"><span data-stu-id="1c7be-114">Be aware that during an upgrade of a report server, reports that depend on custom assemblies might require additional steps to complete the upgrade.</span></span> <span data-ttu-id="1c7be-115">Para obter mais informações, consulte [Use Upgrade Advisor to Prepare for Upgrades](../../sql-server/install/use-upgrade-advisor-to-prepare-for-upgrades.md).</span><span class="sxs-lookup"><span data-stu-id="1c7be-115">For more information, see [Use Upgrade Advisor to Prepare for Upgrades](../../sql-server/install/use-upgrade-advisor-to-prepare-for-upgrades.md).</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
##  <a name="working-with-custom-code-in-report-builder"></a><a name="RB3"></a> <span data-ttu-id="1c7be-116">Trabalhando com código personalizado no Construtor de Relatórios</span><span class="sxs-lookup"><span data-stu-id="1c7be-116">Working with Custom Code in Report Builder</span></span>  
 <span data-ttu-id="1c7be-117">No Construtor de Relatórios, você pode abrir um relatório em um servidor de relatório que inclua referências a assemblies personalizados.</span><span class="sxs-lookup"><span data-stu-id="1c7be-117">In Report Builder, you can open a report from a report server that includes references to custom assemblies.</span></span> <span data-ttu-id="1c7be-118">Por exemplo, você pode editar relatórios que são criados e implantados no Designer de Relatórios no [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="1c7be-118">For example, you can edit reports that are created and deployed by using Report Designer in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].</span></span> <span data-ttu-id="1c7be-119">Os assemblies personalizados devem ser implantados no servidor de relatório.</span><span class="sxs-lookup"><span data-stu-id="1c7be-119">The custom assemblies must be deployed to the report server.</span></span>  
  
 <span data-ttu-id="1c7be-120">Não é possível fazer o seguinte:</span><span class="sxs-lookup"><span data-stu-id="1c7be-120">You cannot do the following:</span></span>  
  
1.  <span data-ttu-id="1c7be-121">Adicionar referências ou instâncias de membro de classe a um relatório.</span><span class="sxs-lookup"><span data-stu-id="1c7be-121">Add references or class member instances to a report.</span></span>  
  
2.  <span data-ttu-id="1c7be-122">Visualizar um relatório com referências a assemblies personalizados no modo local.</span><span class="sxs-lookup"><span data-stu-id="1c7be-122">Preview a report with references to custom assemblies in local mode.</span></span>  
  
##  <a name="including-references-to-commonly-used-functions"></a><a name="Common"></a><span data-ttu-id="1c7be-123">Incluindo referências a funções comumente usadas</span><span class="sxs-lookup"><span data-stu-id="1c7be-123">Including References to Commonly Used Functions</span></span>  
 <span data-ttu-id="1c7be-124">Use a caixa de diálogo **Expressão** para exibir uma lista categorizada de funções comuns internas do [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="1c7be-124">Use the **Expression** dialog box to view a categorized list of common functions built-in to [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)].</span></span> <span data-ttu-id="1c7be-125">Quando você expande **Funções Comuns** e clica em uma categoria, o painel **Item** exibe a lista de funções incluídas em uma expressão.</span><span class="sxs-lookup"><span data-stu-id="1c7be-125">When you expand **Common Functions** and click a category, the **Item** pane displays the list of functions that you include in an expression.</span></span> <span data-ttu-id="1c7be-126">As funções comuns incluem classes dos [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] <xref:System.Math> namespaces e das funções de biblioteca de <xref:System.Convert> tempo de [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] execução.</span><span class="sxs-lookup"><span data-stu-id="1c7be-126">The common functions include classes from the [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] <xref:System.Math> and <xref:System.Convert> namespaces and [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] run-time library functions.</span></span> <span data-ttu-id="1c7be-127">Por conveniência, é possível exibir as funções usadas mais frequentemente na caixa de diálogo **Expressão** , onde elas são listadas por categoria: Texto, Data e Hora, Matemática, Inspeção, Fluxo do Programa, Agregação, Financeira, Conversão e Diversas.</span><span class="sxs-lookup"><span data-stu-id="1c7be-127">For convenience, you can view the most commonly used functions in the **Expression** dialog box, where they are listed by category: Text, Date and Time, Math, Inspection, Program Flow, Aggregate, Financial, Conversion, and Miscellaneous.</span></span> <span data-ttu-id="1c7be-128">As funções usadas com menor frequência não são exibidas na lista, mas ainda podem ser usadas em uma expressão.</span><span class="sxs-lookup"><span data-stu-id="1c7be-128">Less commonly used functions do not appear in the list but can still be used in an expression.</span></span>  
  
 <span data-ttu-id="1c7be-129">Para usar uma função interna, clique duas vezes no nome da função no painel Item.</span><span class="sxs-lookup"><span data-stu-id="1c7be-129">To use a built-in function, double-click the function name in the Item pane.</span></span> <span data-ttu-id="1c7be-130">Uma descrição da função é exibida no painel Descrição e um exemplo de chamada da função é exibido no painel Exemplo.</span><span class="sxs-lookup"><span data-stu-id="1c7be-130">A description of the function appears in the Description pane and an example of the function call appears in the Example pane.</span></span> <span data-ttu-id="1c7be-131">No painel de código, quando você digita o nome da função seguido por um parêntese esquerdo **(**, a ajuda do IntelliSense exibe cada sintaxe válida para a chamada de função.</span><span class="sxs-lookup"><span data-stu-id="1c7be-131">In the code pane, when you type the function name followed by a left parenthesis **(**, the IntelliSense help displays each valid syntax for the function call.</span></span> <span data-ttu-id="1c7be-132">Por exemplo, para calcular o valor máximo de um campo denominado `Quantity` em uma tabela, adicione a expressão simples `=Max(` ao painel Código e use as marcas inteligentes para exibir todas as sintaxes válidas possíveis para a chamada da função.</span><span class="sxs-lookup"><span data-stu-id="1c7be-132">For example, to calculate the maximum value for a field named `Quantity` in a table, add the simple expression `=Max(` to the Code pane, and then use the smart tags to view all possible valid syntaxes for the function call.</span></span> <span data-ttu-id="1c7be-133">Para concluir este exemplo, digite `=Max(Fields!Quantity.Value)`.</span><span class="sxs-lookup"><span data-stu-id="1c7be-133">To complete this example, type `=Max(Fields!Quantity.Value)`.</span></span>  
  
 <span data-ttu-id="1c7be-134">Para obter mais informações sobre cada função, consulte <xref:System.Math>, <xref:System.Convert>e [Membros da Biblioteca de Runtime do Visual Basic](https://go.microsoft.com/fwlink/?LinkId=198941) no MSDN.</span><span class="sxs-lookup"><span data-stu-id="1c7be-134">For more information about each function, see <xref:System.Math>, <xref:System.Convert>, and [Visual Basic Runtime Library Members](https://go.microsoft.com/fwlink/?LinkId=198941) on MSDN.</span></span>  
  
##  <a name="including-references-to-less-commonly-used-functions"></a><a name="NotCommon"></a><span data-ttu-id="1c7be-135">Incluindo referências a funções usadas com menos frequência</span><span class="sxs-lookup"><span data-stu-id="1c7be-135">Including References to Less Commonly Used Functions</span></span>  
 <span data-ttu-id="1c7be-136">Para incluir uma referência em outros namespaces de CLR usados com menor frequência, você deve usar uma referência totalmente qualificada, por exemplo, <xref:System.Text.StringBuilder>.</span><span class="sxs-lookup"><span data-stu-id="1c7be-136">To include a reference to other less commonly used CLR namespaces, you must use a fully qualified reference, for example, <xref:System.Text.StringBuilder>.</span></span> <span data-ttu-id="1c7be-137">O IntelliSense não tem suporte no painel de código da caixa de diálogo **Expressão** para essas funções usadas com menor frequência.</span><span class="sxs-lookup"><span data-stu-id="1c7be-137">IntelliSense is not supported in the code pane of the **Expression** dialog box for these less commonly used functions.</span></span>  
  
 <span data-ttu-id="1c7be-138">Para obter mais informações, confira [Membros da Biblioteca de Runtime do Visual Basic](https://go.microsoft.com/fwlink/?LinkId=198941) no MSDN.</span><span class="sxs-lookup"><span data-stu-id="1c7be-138">For more information, see [Visual Basic Runtime Library Members](https://go.microsoft.com/fwlink/?LinkId=198941) on MSDN.</span></span>  
  
##  <a name="including-references-to-external-assemblies"></a><a name="External"></a> <span data-ttu-id="1c7be-139">Incluindo referências em assemblies externos</span><span class="sxs-lookup"><span data-stu-id="1c7be-139">Including References to External Assemblies</span></span>  
 <span data-ttu-id="1c7be-140">Para incluir uma referência em uma classe em um assembly externo, você deve identificar o assembly para o processador de relatório.</span><span class="sxs-lookup"><span data-stu-id="1c7be-140">To include a reference to a class in an external assembly, you must identify the assembly for the report processor.</span></span> <span data-ttu-id="1c7be-141">Use a página **Referências** da caixa de diálogo **Propriedades do Relatório** para especificar o nome totalmente qualificado do assembly a ser adicionado ao relatório.</span><span class="sxs-lookup"><span data-stu-id="1c7be-141">Use the **References** page of the **Report Properties** dialog box to specify the fully qualified name of the assembly to add to the report.</span></span> <span data-ttu-id="1c7be-142">Na expressão, você deve usar o nome totalmente qualificado para a classe no assembly.</span><span class="sxs-lookup"><span data-stu-id="1c7be-142">In your expression, you must use the fully qualified name for the class in the assembly.</span></span> <span data-ttu-id="1c7be-143">As classes em um assembly externo não são exibidas na caixa de diálogo **Expressão** . Você deve fornecer o nome correto para a classe.</span><span class="sxs-lookup"><span data-stu-id="1c7be-143">Classes in an external assembly do not appear in the **Expression** dialog box; you must provide the correct name for the class.</span></span> <span data-ttu-id="1c7be-144">Um nome totalmente qualificado inclui o namespace, o nome da classe e o nome do membro.</span><span class="sxs-lookup"><span data-stu-id="1c7be-144">A fully qualified name includes the namespace, the class name, and the member name.</span></span>  
  
##  <a name="including-embedded-code"></a><a name="Embedded"></a> <span data-ttu-id="1c7be-145">Incluindo código inserido</span><span class="sxs-lookup"><span data-stu-id="1c7be-145">Including Embedded Code</span></span>  
 <span data-ttu-id="1c7be-146">Para adicionar código inserido a um relatório, use a guia Código da caixa de diálogo **Propriedades do Relatório** .</span><span class="sxs-lookup"><span data-stu-id="1c7be-146">To add embedded code to a report, use the Code tab of the **Report Properties** dialog box.</span></span> <span data-ttu-id="1c7be-147">O bloco de código criado pode conter vários métodos.</span><span class="sxs-lookup"><span data-stu-id="1c7be-147">The code block you create can contain multiple methods.</span></span> <span data-ttu-id="1c7be-148">Os métodos no código inserido devem ser gravados [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] e devem ser baseados em instância.</span><span class="sxs-lookup"><span data-stu-id="1c7be-148">Methods in embedded code must be written in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] and must be instance-based.</span></span> <span data-ttu-id="1c7be-149">O processador de relatório adiciona referências automaticamente para os namespaces System.Convert e System.Math.</span><span class="sxs-lookup"><span data-stu-id="1c7be-149">The report processor automatically adds references for the System.Convert and System.Math namespaces.</span></span> <span data-ttu-id="1c7be-150">Use a página **Referências** da caixa de diálogo **Propriedades do Relatório** para adicionar referências adicionais do assembly.</span><span class="sxs-lookup"><span data-stu-id="1c7be-150">Use the **References** page of the **Report Properties** dialog box to add additional assembly references.</span></span> <span data-ttu-id="1c7be-151">Para obter mais informações, consulte [Adicionar uma referência de assembly a um relatório &#40;SSRS&#41;](add-an-assembly-reference-to-a-report-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="1c7be-151">For more information, see [Add an Assembly Reference to a Report &#40;SSRS&#41;](add-an-assembly-reference-to-a-report-ssrs.md).</span></span>  
  
 <span data-ttu-id="1c7be-152">Os métodos no código inserido são disponibilizados por meio de um membro do `Code` definido globalmente.</span><span class="sxs-lookup"><span data-stu-id="1c7be-152">Methods in embedded code are available through a globally defined `Code` member.</span></span> <span data-ttu-id="1c7be-153">Você os acessa consultando o membro do `Code` e o nome do método.</span><span class="sxs-lookup"><span data-stu-id="1c7be-153">You access these by referring to the `Code` member and the method name.</span></span> <span data-ttu-id="1c7be-154">O exemplo a seguir chama o método `ToUSD` que converte o valor no campo `StandardCost` para um valor em dólar:</span><span class="sxs-lookup"><span data-stu-id="1c7be-154">The following example calls the method `ToUSD`, which converts the value in the `StandardCost` field to a dollar value:</span></span>  
  
```  
=Code.ToUSD(Fields!StandardCost.Value)  
```  
  
 <span data-ttu-id="1c7be-155">Para fazer referência às coleções internas no código personalizado, inclua uma referência no objeto `Report` interno:</span><span class="sxs-lookup"><span data-stu-id="1c7be-155">To reference built-in collections in your custom code, include a reference to the built-in `Report` object:</span></span>  
  
```  
=Report.Parameters!Param1.Value  
```  
  
 <span data-ttu-id="1c7be-156">Os exemplos a seguir mostram como definir algumas constantes e variáveis personalizadas.</span><span class="sxs-lookup"><span data-stu-id="1c7be-156">The following examples show how to define some custom constants and variables.</span></span>  
  
```  
Public Const MyNote = "Authored by Bob"  
Public Const NCopies As Int32 = 2  
Public Dim  MyVersion As String = "123.456"  
Public Dim MyDoubleVersion As Double = 123.456  
```  
  
 <span data-ttu-id="1c7be-157">Embora as constantes personalizadas não apareçam na categoria de **Constantes** na caixa de diálogo **Expressão** (que exibe apenas constantes internas), é possível adicionar referências a elas por meio de qualquer expressão, conforme mostrado nos exemplos a seguir.</span><span class="sxs-lookup"><span data-stu-id="1c7be-157">Although custom constants do not appear in the **Constants** category in the **Expression** dialog box (which only displays built-in constants), you can add references to them from any expression, as shown in the following examples.</span></span> <span data-ttu-id="1c7be-158">Em uma expressão, uma constante personalizada é tratada como uma `Variant`.</span><span class="sxs-lookup"><span data-stu-id="1c7be-158">In an expression, a custom constant is treated as a `Variant`.</span></span>  
  
```  
=Code.MyNote  
=Code.NCopies  
=Code.MyVersion  
=Code.MyDoubleVersion  
```  
  
 <span data-ttu-id="1c7be-159">O exemplo a seguir inclui a referência e a implementação de código da função `FixSpelling` que substitui o texto `"Bicycle"` para todas as ocorrências do texto "Bike" no campo `SubCategory`.</span><span class="sxs-lookup"><span data-stu-id="1c7be-159">The following example includes both the code reference and the code implementation of the function `FixSpelling`, which substitutes the text `"Bicycle"` for all occurrences of the text "Bike" in the `SubCategory` field.</span></span>  
  
 `=Code.FixSpelling(Fields!SubCategory.Value)`  
  
 <span data-ttu-id="1c7be-160">O código a seguir, quando inserido em um bloco de código de definição de relatório, mostra uma implementação do método `FixSpelling`.</span><span class="sxs-lookup"><span data-stu-id="1c7be-160">The following code, when embedded in a report definition code block, shows an implementation of the `FixSpelling` method.</span></span> <span data-ttu-id="1c7be-161">Este exemplo mostra como usar uma referência totalmente qualificada para a [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] `StringBuilder` classe.</span><span class="sxs-lookup"><span data-stu-id="1c7be-161">This example shows you how to use a fully qualified reference to the [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] `StringBuilder` class.</span></span>  
  
```vb  
Public Function FixSpelling(ByVal s As String) As String  
   Dim strBuilder As New System.Text.StringBuilder(s)  
   If s.Contains("Bike") Then  
      strBuilder.Replace("Bike", "Bicycle")  
      Return strBuilder.ToString()  
      Else : Return s  
   End If  
End Function  
```  
  
 <span data-ttu-id="1c7be-162">Para obter mais informações sobre coleções de objetos internos e inicialização, consulte [Referências globais internas e referências de usuários &#40;Construtor de Relatórios e SSRS&#41;](built-in-collections-built-in-globals-and-users-references-report-builder.md) e [Inicializando objetos Assembly personalizados](../custom-assemblies/initializing-custom-assembly-objects.md).</span><span class="sxs-lookup"><span data-stu-id="1c7be-162">For more information about built-in object collections and initialization, see [Built-in Globals and Users References &#40;Report Builder and SSRS&#41;](built-in-collections-built-in-globals-and-users-references-report-builder.md) and [Initializing Custom Assembly Objects](../custom-assemblies/initializing-custom-assembly-objects.md).</span></span>  
  
##  <a name="including-references-to-parameters-from-code"></a><a name="Parameters"></a> <span data-ttu-id="1c7be-163">Incluindo referências a parâmetros no código</span><span class="sxs-lookup"><span data-stu-id="1c7be-163">Including References to Parameters from Code</span></span>  
 <span data-ttu-id="1c7be-164">É possível fazer referência à coleção de parâmetros globais por meio de código personalizado em um bloco de código da definição do relatório ou em um assembly personalizado fornecido.</span><span class="sxs-lookup"><span data-stu-id="1c7be-164">You can reference the global parameters collection via custom code in a Code block of the report definition or in a custom assembly that you provide.</span></span> <span data-ttu-id="1c7be-165">A coleção de parâmetros é somente leitura e não possui iteradores públicos.</span><span class="sxs-lookup"><span data-stu-id="1c7be-165">The parameters collection is read-only and has no public iterators.</span></span> <span data-ttu-id="1c7be-166">Você não pode usar uma [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] `For Each` construção para percorrer a coleção.</span><span class="sxs-lookup"><span data-stu-id="1c7be-166">You cannot use a [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] `For Each` construct to step through the collection.</span></span> <span data-ttu-id="1c7be-167">É preciso saber o nome do parâmetro definido na definição de relatório antes de referenciá-lo no código.</span><span class="sxs-lookup"><span data-stu-id="1c7be-167">You need to know the name of the parameter defined in the report definition before you can reference it in your code.</span></span> <span data-ttu-id="1c7be-168">No entanto, é possível iterar através de todos os valores de um parâmetro de vários valores.</span><span class="sxs-lookup"><span data-stu-id="1c7be-168">You can, however, iterate through all the values of a multivalue parameter.</span></span>  
  
 <span data-ttu-id="1c7be-169">A tabela a seguir inclui exemplos de como fazer referência à coleção interna de `Parameters` no código personalizado:</span><span class="sxs-lookup"><span data-stu-id="1c7be-169">The following table includes examples of referencing the built-in collection `Parameters` from custom code:</span></span>  
  
|<span data-ttu-id="1c7be-170">Descrição</span><span class="sxs-lookup"><span data-stu-id="1c7be-170">Description</span></span>|<span data-ttu-id="1c7be-171">Referência em expressão</span><span class="sxs-lookup"><span data-stu-id="1c7be-171">Reference in Expression</span></span>|<span data-ttu-id="1c7be-172">Definição de código personalizado</span><span class="sxs-lookup"><span data-stu-id="1c7be-172">Custom Code definition</span></span>|  
|-----------------|-----------------------------|----------------------------|  
|<span data-ttu-id="1c7be-173">Passando uma coleção de parâmetros globais inteira para código personalizado.</span><span class="sxs-lookup"><span data-stu-id="1c7be-173">Passing an entire global parameter collection to custom code.</span></span><br /><br /> <span data-ttu-id="1c7be-174">Esta função retorna o valor de um parâmetro de relatório específico *MyParameter*.</span><span class="sxs-lookup"><span data-stu-id="1c7be-174">This function returns the value of a specific report parameter *MyParameter*.</span></span>|`=Code.DisplayAParameterValue(Parameters)`|`Public Function DisplayAParameterValue(`<br /><br /> `ByVal parameters as Parameters) as Object`<br /><br /> `Return parameters("MyParameter").Value`<br /><br /> `End Function`|  
|<span data-ttu-id="1c7be-175">Passando um parâmetro individual para código personalizado.</span><span class="sxs-lookup"><span data-stu-id="1c7be-175">Passing an individual parameter to custom code.</span></span><br /><br /> <span data-ttu-id="1c7be-176">Este exemplo retorna o valor do parâmetro passado.</span><span class="sxs-lookup"><span data-stu-id="1c7be-176">This example returns the value of the parameter passed in.</span></span> <span data-ttu-id="1c7be-177">Se o parâmetro for um parâmetro de vários valores, a cadeia de caracteres de retorno será uma concatenação de todos os valores.</span><span class="sxs-lookup"><span data-stu-id="1c7be-177">If the parameter is a multivalue parameter, the return string is a concatenation of all the values.</span></span>|`=Code.ShowParametersValues(Parameters!DayOfTheWeek)`|`Public Function ShowParameterValues(ByVal parameter as Parameter)` <br />  `as String` <br /> `Dim s as String`  <br />  `If parameter.IsMultiValue then` <br />  `s = "Multivalue: "`  <br /> `For i as integer = 0 to parameter.Count-1` <br />  `s = s + CStr(parameter.Value(i)) + " "`  <br />  `Next` <br /> `Else` <br /> `s = "Single value: " + CStr(parameter.Value)` <br /> `End If` <br />  `Return s` <br /> `End Function`|  
  
##  <a name="including-references-to-code-from-custom-assemblies"></a><a name="Custom"></a> <span data-ttu-id="1c7be-178">Incluindo referências a código em assemblies personalizados</span><span class="sxs-lookup"><span data-stu-id="1c7be-178">Including References to Code from Custom Assemblies</span></span>  
 <span data-ttu-id="1c7be-179">Para usar assemblies personalizados em um relatório, você deve primeiro criar o assembly, torná-lo disponível para o Designer de Relatórios, adicionar uma referência ao assembly no relatório e usar uma expressão no relatório para fazer referência aos métodos contidos nesse assembly.</span><span class="sxs-lookup"><span data-stu-id="1c7be-179">To use custom assemblies in a report, you must first create the assembly, make it available to Report Designer, add a reference to the assembly in the report, and then use an expression in the report to refer to the methods contained in that assembly.</span></span> <span data-ttu-id="1c7be-180">Quando o relatório é implantado no servidor de relatório, você deve também implantar o assembly personalizado no servidor de relatório.</span><span class="sxs-lookup"><span data-stu-id="1c7be-180">When the report is deployed to the report server, you must also deploy the custom assembly to the report server.</span></span>  
  
 <span data-ttu-id="1c7be-181">Para obter informações sobre como criar um assembly personalizado e torná-lo disponível para o [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)], consulte [Usando assemblies personalizados com relatórios](../custom-assemblies/using-custom-assemblies-with-reports.md).</span><span class="sxs-lookup"><span data-stu-id="1c7be-181">For information about creating a custom assembly and making it available to [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)], see [Using Custom Assemblies with Reports](../custom-assemblies/using-custom-assemblies-with-reports.md).</span></span>  
  
 <span data-ttu-id="1c7be-182">Para consultar o código personalizado em uma expressão, você deve chamar o membro de uma classe dentro do assembly.</span><span class="sxs-lookup"><span data-stu-id="1c7be-182">To refer to custom code in an expression, you must call the member of a class within the assembly.</span></span> <span data-ttu-id="1c7be-183">A maneira de fazer isso depende do método ser estático ou baseado em instância.</span><span class="sxs-lookup"><span data-stu-id="1c7be-183">How you do this depends on whether the method is static or instance-based.</span></span> <span data-ttu-id="1c7be-184">Os métodos estáticos dentro de um assembly personalizado estão disponíveis globalmente dentro do relatório.</span><span class="sxs-lookup"><span data-stu-id="1c7be-184">Static methods within a custom assembly are available globally within the report.</span></span> <span data-ttu-id="1c7be-185">É possível acessar métodos estáticos em expressões especificando o namespace, a classe e o nome do método.</span><span class="sxs-lookup"><span data-stu-id="1c7be-185">You can access static methods in expressions by specifying the namespace, class, and method name.</span></span> <span data-ttu-id="1c7be-186">O exemplo a seguir chama o método `ToGBP` , que converte o valor do valor **StandardCost** de dólar para libras esterlinas:</span><span class="sxs-lookup"><span data-stu-id="1c7be-186">The following example calls the method `ToGBP`, which converts the value of the **StandardCost** value from dollar to pounds sterling:</span></span>  
  
```  
=CurrencyConversion.DollarCurrencyConversion.ToGBP(Fields!StandardCost.Value)  
```  
  
 <span data-ttu-id="1c7be-187">Os métodos baseados em instância estão disponíveis por meio de um membro do `Code` definido globalmente.</span><span class="sxs-lookup"><span data-stu-id="1c7be-187">Instance-based methods are available through a globally defined `Code` member.</span></span> <span data-ttu-id="1c7be-188">Você os acessa fazendo referência ao membro do `Code`, seguido pelo nome da instância e do método.</span><span class="sxs-lookup"><span data-stu-id="1c7be-188">You access these by referring to the `Code` member, followed by the instance and method name.</span></span> <span data-ttu-id="1c7be-189">O exemplo a seguir chama o método `ToEUR` de instância, que converte o valor de **StandardCost** de dólar em euro:</span><span class="sxs-lookup"><span data-stu-id="1c7be-189">The following example calls the instance method `ToEUR`, which converts the value of **StandardCost** from dollar to euro:</span></span>  
  
```  
=Code.m_myDollarCoversion.ToEUR(Fields!StandardCost.Value)  
```  
  
> [!NOTE]  
>  <span data-ttu-id="1c7be-190">No Designer de Relatório, um assembly personalizado é carregado uma vez e não é descarregado até que o [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)]seja fechado.</span><span class="sxs-lookup"><span data-stu-id="1c7be-190">In Report Designer, a custom assembly is loaded once and is not unloaded until you close [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)].</span></span> <span data-ttu-id="1c7be-191">Se você visualizar um relatório, fizer alterações em um assembly personalizado usado no relatório e visualizar o relatório novamente, as alterações não serão exibidas na segunda visualização.</span><span class="sxs-lookup"><span data-stu-id="1c7be-191">If you preview a report, make changes to a custom assembly used in the report, and then preview the report again, the changes will not appear in the second preview.</span></span> <span data-ttu-id="1c7be-192">Para recarregar o assembly, feche e abra o [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] novamente e visualize o relatório.</span><span class="sxs-lookup"><span data-stu-id="1c7be-192">To reload the assembly, close and reopen [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] and then preview the report.</span></span>  
  
 <span data-ttu-id="1c7be-193">Para obter mais informações sobre como acessar o código, consulte [Accessing Custom Assemblies Through Expressions](../custom-assemblies/accessing-custom-assemblies-through-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="1c7be-193">For more information about accessing your code, see [Accessing Custom Assemblies Through Expressions](../custom-assemblies/accessing-custom-assemblies-through-expressions.md).</span></span>  
  
##  <a name="passing-built-in-collections-into-custom-assemblies"></a><a name="collections"></a> <span data-ttu-id="1c7be-194">Passando coleções internas para assemblies personalizados</span><span class="sxs-lookup"><span data-stu-id="1c7be-194">Passing Built-in Collections into Custom Assemblies</span></span>  
 <span data-ttu-id="1c7be-195">Se você deseja passar coleções internas, como *Globals* ou *Parameters* , em um assembly personalizado para processamento, você deve adicionar uma referência de assembly no projeto de código ao assembly que define as coleções internas e acessar o namespace correto.</span><span class="sxs-lookup"><span data-stu-id="1c7be-195">If you want to pass built-in collections, such as the *Globals* or *Parameters* collection, into a custom assembly for processing, you must add an assembly reference in your code project to the assembly that defines the built-in collections and access the correct namespace.</span></span> <span data-ttu-id="1c7be-196">O assembly que você precisará referenciar será diferente dependendo da finalidade para a qual você está desenvolvendo o assembly personalizado: para um relatório executado em um servidor de relatórios (relatório do servidor) ou um relatório executado localmente em um aplicativo .NET (relatório local).</span><span class="sxs-lookup"><span data-stu-id="1c7be-196">Depending on whether you are developing the custom assembly for a report that is run on a report server (server report) or a report that is run locally in a .NET application (local report), the assembly you need to reference is different.</span></span> <span data-ttu-id="1c7be-197">Veja abaixo para obter mais detalhes.</span><span class="sxs-lookup"><span data-stu-id="1c7be-197">See below for details.</span></span>  
  
-   <span data-ttu-id="1c7be-198">**Namespace:** Microsoft.ReportingServices.ReportProcessing.ReportObjectModel</span><span class="sxs-lookup"><span data-stu-id="1c7be-198">**Namespace:** Microsoft.ReportingServices.ReportProcessing.ReportObjectModel</span></span>  
  
-   <span data-ttu-id="1c7be-199">**Assembly (relatório local):** Microsoft.ReportingServices.ProcessingObjectModel.dll</span><span class="sxs-lookup"><span data-stu-id="1c7be-199">**Assembly (local report):** Microsoft.ReportingServices.ProcessingObjectModel.dll</span></span>  
  
-   <span data-ttu-id="1c7be-200">**Assembly (relatório do servidor):** Microsoft.ReportViewer.ProcessingObjectModel.dll</span><span class="sxs-lookup"><span data-stu-id="1c7be-200">**Assembly (server report):** Microsoft.ReportViewer.ProcessingObjectModel.dll</span></span>  
  
 <span data-ttu-id="1c7be-201">Como o conteúdo das coleções *Fields* e *ReportItems* pode ser alterado dinamicamente em runtime, você não deverá retê-las durante as chamadas no assembly personalizado (por exemplo, em uma variável de membro).</span><span class="sxs-lookup"><span data-stu-id="1c7be-201">Since the content of the *Fields* and *ReportItems* collections can change dynamically at runtime, you should not hold onto them across calls into the custom assembly (for example, in a member variable).</span></span> <span data-ttu-id="1c7be-202">A mesma recomendação geralmente se aplica a todas as coleções internas.</span><span class="sxs-lookup"><span data-stu-id="1c7be-202">The same recommendation applies generally to all built-in collections.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1c7be-203">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="1c7be-203">See Also</span></span>  
 <span data-ttu-id="1c7be-204">[Adicionar código a um relatório &#40;SSRS&#41;](add-code-to-a-report-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="1c7be-204">[Add Code to a Report &#40;SSRS&#41;](add-code-to-a-report-ssrs.md) </span></span>  
 <span data-ttu-id="1c7be-205">[Usando assemblies personalizados com relatórios](../custom-assemblies/using-custom-assemblies-with-reports.md) </span><span class="sxs-lookup"><span data-stu-id="1c7be-205">[Using Custom Assemblies with Reports](../custom-assemblies/using-custom-assemblies-with-reports.md) </span></span>  
 <span data-ttu-id="1c7be-206">[Adicionar uma referência de assembly a um relatório &#40;SSRS&#41;](add-an-assembly-reference-to-a-report-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="1c7be-206">[Add an Assembly Reference to a Report &#40;SSRS&#41;](add-an-assembly-reference-to-a-report-ssrs.md) </span></span>  
 <span data-ttu-id="1c7be-207">[Reporting Services tutoriais &#40;SSRS&#41;](../reporting-services-tutorials-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="1c7be-207">[Reporting Services Tutorials &#40;SSRS&#41;](../reporting-services-tutorials-ssrs.md) </span></span>  
 <span data-ttu-id="1c7be-208">[Exemplos de expressões &#40;Construtor de Relatórios e SSRS&#41;](expression-examples-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="1c7be-208">[Expression Examples &#40;Report Builder and SSRS&#41;](expression-examples-report-builder-and-ssrs.md) </span></span>  
 [<span data-ttu-id="1c7be-209">Exemplos de relatório (Construtor de Relatórios e SSRS)</span><span class="sxs-lookup"><span data-stu-id="1c7be-209">Report Samples (Report Builder and SSRS)</span></span>](https://go.microsoft.com/fwlink/?LinkId=198283)  
  
  
