---
title: Referências de coleções de variáveis de grupo e de relatório (Construtor de Relatórios e SSRS) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
f1_keywords:
- "10404"
- sql12.rtp.rptdesigner.categorygroupproperties.variables.f1
- "10083"
- sql12.rtp.rptdesigner.seriesgroupproperties.variables.f1
- sql12.rtp.rptdesigner.reportproperties.variables.f1
- sql12.rtp.rptdesigner.groupproperties.variables.f1
- "10292"
- "10412"
ms.assetid: 4be5b463-3ce2-483d-a3c6-dae752cb543e
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 41dd652bf39721b13801131a5ec268495edf9d29
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87678641"
---
# <a name="report-and-group-variables-collections-references-report-builder-and-ssrs"></a><span data-ttu-id="484ad-102">Referências de coleções de variáveis de grupo e de relatório (Construtor de Relatórios e SSRS)</span><span class="sxs-lookup"><span data-stu-id="484ad-102">Report and Group Variables Collections References (Report Builder and SSRS)</span></span>
  <span data-ttu-id="484ad-103">Quando há um cálculo complexo usado mais de uma vez em expressões em um relatório, convém criar uma variável.</span><span class="sxs-lookup"><span data-stu-id="484ad-103">When you have a complex calculation that is used more than once in expressions in a report, you might want to create a variable.</span></span> <span data-ttu-id="484ad-104">É possível criar uma variável do relatório ou uma variável do grupo.</span><span class="sxs-lookup"><span data-stu-id="484ad-104">You can create a report variable or a group variable.</span></span> <span data-ttu-id="484ad-105">Os nomes de variável devem ser exclusivos em um relatório.</span><span class="sxs-lookup"><span data-stu-id="484ad-105">Variable names must be unique in a report.</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
## <a name="report-variables"></a><span data-ttu-id="484ad-106">Variáveis do relatório</span><span class="sxs-lookup"><span data-stu-id="484ad-106">Report Variables</span></span>  
 <span data-ttu-id="484ad-107">Use uma variável do relatório para manter um valor para cálculos dependentes de tempo, como taxas de moeda ou carimbos de data/hora ou para um cálculo complexo que seja referenciado várias vezes.</span><span class="sxs-lookup"><span data-stu-id="484ad-107">Use a report variable to hold a value for time-dependent calculations, such as currency rates or time stamps, or for a complex calculation that is referenced multiple times.</span></span> <span data-ttu-id="484ad-108">Por padrão, uma variável do relatório é calculada uma vez e pode ser usada em expressões em um relatório.</span><span class="sxs-lookup"><span data-stu-id="484ad-108">By default, a report variable is calculated once and can be used in expressions throughout a report.</span></span> <span data-ttu-id="484ad-109">As variáveis de relatório são somente leitura por padrão.</span><span class="sxs-lookup"><span data-stu-id="484ad-109">Report variables are read-only by default.</span></span> <span data-ttu-id="484ad-110">Você pode alterar o padrão para habilitar uma variável de relatório como leitura-gravação.</span><span class="sxs-lookup"><span data-stu-id="484ad-110">You can change the default to enable a report variable as read-write.</span></span> <span data-ttu-id="484ad-111">O valor em uma variável de relatório é preservado durante toda a sessão, até o relatório ser processado novamente.</span><span class="sxs-lookup"><span data-stu-id="484ad-111">The value in a report variable is preserved throughout a session, until the report is processed again.</span></span>  
  
 <span data-ttu-id="484ad-112">Para adicionar uma variável do relatório, abra a caixa de diálogo **ReportProperties** , clique em **Variáveis**e forneça um nome e um valor.</span><span class="sxs-lookup"><span data-stu-id="484ad-112">To add a report variable, open the **ReportProperties** dialog box, click **Variables**, and provide a name and a value.</span></span> <span data-ttu-id="484ad-113">Os nomes são cadeias de caracteres que diferenciam maiúsculas de minúsculas, começando com uma letra e sem espaços.</span><span class="sxs-lookup"><span data-stu-id="484ad-113">Names are case-sensitive strings that begin with a letter and have no spaces.</span></span> <span data-ttu-id="484ad-114">Um nome pode conter letras, números ou sublinhados (_).</span><span class="sxs-lookup"><span data-stu-id="484ad-114">A name can include letters, numbers, or underscores (_).</span></span>  
  
 <span data-ttu-id="484ad-115">Para fazer referência à variável em uma expressão, use a sintaxe de coleção global, por exemplo, `=Variables!CustomTimeStamp.Value`.</span><span class="sxs-lookup"><span data-stu-id="484ad-115">To refer to the variable in an expression, use the global collection syntax, for example, `=Variables!CustomTimeStamp.Value`.</span></span> <span data-ttu-id="484ad-116">Na superfície de design, o valor é exibido em uma caixa de texto como `<<Expr>>`.</span><span class="sxs-lookup"><span data-stu-id="484ad-116">On the design surface, the value appears in a text box as `<<Expr>>`.</span></span>  
  
 <span data-ttu-id="484ad-117">Você pode usar variáveis de relatório dos seguintes modos:</span><span class="sxs-lookup"><span data-stu-id="484ad-117">You can use report variables in the following ways:</span></span>  
  
-   <span data-ttu-id="484ad-118">**Uso somente leitura** Defina um valor uma vez para criar uma constante para a sessão de relatório, por exemplo, para criar um carimbo de data/hora.</span><span class="sxs-lookup"><span data-stu-id="484ad-118">**Read-only use** Set a value once to create a constant for the report session, for example, to create a time stamp.</span></span>  
  
     <span data-ttu-id="484ad-119">Como as expressões nas caixas de texto são avaliadas sob demanda como páginas de um usuário em um relatório, os valores dinâmicos (por exemplo, uma expressão que inclui a função `Now()` , que retorna a hora do dia) poderão retornar valores diferentes se você percorrer as páginas para a frente e para trás com o botão **Voltar** .</span><span class="sxs-lookup"><span data-stu-id="484ad-119">Because expressions in text boxes are evaluated on-demand as a user pages through a report, dynamic values (for example, an expression that includes the `Now()` function, which returns the time of day) can return different values if you page forward and backward by using the **Back** button.</span></span> <span data-ttu-id="484ad-120">Ao configurar o valor de uma variável do relatório como a expressão `=Now()`e adicionar a variável à expressão, você garante que o mesmo valor seja usado no processamento do relatório.</span><span class="sxs-lookup"><span data-stu-id="484ad-120">By setting a the value of a report variable to the expression `=Now()`, and then adding the variable to your expression, you ensure the same value is used throughout report processing.</span></span>  
  
-   <span data-ttu-id="484ad-121">**Uso de leitura-gravação** Defina um valor uma vez e serialize-o dentro da sessão de relatório.</span><span class="sxs-lookup"><span data-stu-id="484ad-121">**Read-write use** Set a value once and serialize the value within a report session.</span></span> <span data-ttu-id="484ad-122">A opção de leitura-gravação para variáveis fornece uma alternativa melhor do que o uso de uma variável estática no bloco de Código na definição do relatório.</span><span class="sxs-lookup"><span data-stu-id="484ad-122">The read-write option for variables provides a better alternative than using a static variable in the Code block in the report definition.</span></span>  
  
     <span data-ttu-id="484ad-123">Quando você limpa a opção **somente leitura** para uma variável, a propriedade gravável para a variável é definida como `true` .</span><span class="sxs-lookup"><span data-stu-id="484ad-123">When you clear the **Read-Only** option for a variable, the Writable property for the variable is set to `true`.</span></span> <span data-ttu-id="484ad-124">Para atualizar o valor de uma expressão, use o método SetValue, por exemplo, `=Variables!MyVariable.SetValue("123")`.</span><span class="sxs-lookup"><span data-stu-id="484ad-124">To update the value from an expression, use the SetValue method, for example, `=Variables!MyVariable.SetValue("123")`.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="484ad-125">Não é possível controlar quando o processador do relatório inicializa uma variável ou avalia uma expressão que atualiza uma variável.</span><span class="sxs-lookup"><span data-stu-id="484ad-125">You cannot control when the report processor initializes a variable or evaluates an expression that updates a variable.</span></span> <span data-ttu-id="484ad-126">A ordem de execução da inicialização da variável não é definida.</span><span class="sxs-lookup"><span data-stu-id="484ad-126">The order of execution for variable initialization is undefined.</span></span>  
  
 <span data-ttu-id="484ad-127">Para obter mais informações, consulte [Visualizar relatórios no Construtor de Relatórios](../report-builder/previewing-reports-in-report-builder.md).</span><span class="sxs-lookup"><span data-stu-id="484ad-127">For more information about sessions, see [Previewing Reports in Report Builder](../report-builder/previewing-reports-in-report-builder.md).</span></span>  
  
## <a name="group-variables"></a><span data-ttu-id="484ad-128">Variáveis do grupo</span><span class="sxs-lookup"><span data-stu-id="484ad-128">Group Variables</span></span>  
 <span data-ttu-id="484ad-129">Use uma variável do grupo para calcular uma expressão complexa uma vez no escopo de um grupo.</span><span class="sxs-lookup"><span data-stu-id="484ad-129">Use a group variable to calculate a complex expression once in the scope of a group.</span></span> <span data-ttu-id="484ad-130">Uma variável do grupo é válida apenas no escopo do grupo e de seus grupos filho.</span><span class="sxs-lookup"><span data-stu-id="484ad-130">A group variable is valid only in the scope of the group and its child groups.</span></span>  
  
 <span data-ttu-id="484ad-131">Por exemplo, suponha que uma região de dados exiba dados de inventário para itens que estão em categorias de impostos diferentes e você queira aplicar taxas de impostos distintas a cada categoria.</span><span class="sxs-lookup"><span data-stu-id="484ad-131">For example, suppose a data region displays inventory data for items that are in different tax categories and you want to apply different tax rates for each category.</span></span> <span data-ttu-id="484ad-132">Você agrupa os dados em Categoria e define uma variável *Tax* no grupo pai.</span><span class="sxs-lookup"><span data-stu-id="484ad-132">You would group the data on Category and define a *Tax* variable on the parent group.</span></span> <span data-ttu-id="484ad-133">Em seguida, você define uma variável de grupo para *ItemTax* para cada categoria de imposto e atribui cada um dos diferentes subgrupos de Categoria à variável do grupo correto.</span><span class="sxs-lookup"><span data-stu-id="484ad-133">Then you would define a group variable for *ItemTax* for each tax category and assign each of the different Category subgroups to the correct group variable.</span></span> <span data-ttu-id="484ad-134">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="484ad-134">For example:</span></span>  
  
-   <span data-ttu-id="484ad-135">Para o grupo pai baseado em `[Category]`, defina a variável *Tax* com um valor `[Tax]`.</span><span class="sxs-lookup"><span data-stu-id="484ad-135">For the parent group based on `[Category]`, define the variable *Tax* with a value `[Tax]`.</span></span> <span data-ttu-id="484ad-136">Suponha que os valores da categoria sejam Alimentos e Vestuário.</span><span class="sxs-lookup"><span data-stu-id="484ad-136">Assume the category values are Food and Clothing.</span></span>  
  
-   <span data-ttu-id="484ad-137">Para o grupo filho baseado em `[Subcategory]`, defina a variável *ItemsTax* como `=Variables!Tax.Value * Sum(Fields!Price.Value)`.</span><span class="sxs-lookup"><span data-stu-id="484ad-137">For the child group based on `[Subcategory]`, define the variable *ItemsTax* as `=Variables!Tax.Value * Sum(Fields!Price.Value)`.</span></span> <span data-ttu-id="484ad-138">Suponha que os valores da subcategoria para a categoria Alimentos sejam Bebidas e Pães.</span><span class="sxs-lookup"><span data-stu-id="484ad-138">Assume the subcategory values for the category Food are Beverages and Bread.</span></span> <span data-ttu-id="484ad-139">Suponha que os valores da subcategoria para Vestuário sejam Camisas e Chapéus.</span><span class="sxs-lookup"><span data-stu-id="484ad-139">Assume the subcategory values for Clothing are Shirts and Hats.</span></span>  
  
-   <span data-ttu-id="484ad-140">Para uma caixa de texto em uma linha no grupo filho, adicione a expressão `=Variables!ItemsTax.Value`.</span><span class="sxs-lookup"><span data-stu-id="484ad-140">For a text box in a row in the child group, add the expression `=Variables!ItemsTax.Value`.</span></span>  
  
     <span data-ttu-id="484ad-141">A caixa de texto exibe o imposto total para Bebidas e Pães usando o imposto sobre Alimentos e para Camisas e Chapéus usando o imposto sobre Vestuário.</span><span class="sxs-lookup"><span data-stu-id="484ad-141">The text box displays the total tax for Beverages and Bread using the Food tax and for Shirts and Hats using the Clothing tax.</span></span>  
  
 <span data-ttu-id="484ad-142">Para adicionar uma variável do grupo, abra a caixa de diálogo **Propriedades do Grupo Tablix** , clique em **Variáveis**e forneça um nome e um valor.</span><span class="sxs-lookup"><span data-stu-id="484ad-142">To add a group variable, open the **Tablix Group Properties** dialog box, click **Variables**, and provide a name and a value.</span></span> <span data-ttu-id="484ad-143">A variável do grupo é calculada uma vez por valor do grupo exclusivo.</span><span class="sxs-lookup"><span data-stu-id="484ad-143">The group variable is calculated once per unique group value.</span></span>  
  
 <span data-ttu-id="484ad-144">Para fazer referência à variável em uma expressão, use a sintaxe de coleção global, por exemplo, `=Variables!GroupDescription.Value`.</span><span class="sxs-lookup"><span data-stu-id="484ad-144">To refer to the variable in an expression, use the global collection syntax, for example, `=Variables!GroupDescription.Value`.</span></span> <span data-ttu-id="484ad-145">Na superfície de design, o valor é exibido em uma caixa de texto como `<<Expr>>`.</span><span class="sxs-lookup"><span data-stu-id="484ad-145">On the design surface, the value appears in a text box as `<<Expr>>`.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="484ad-146">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="484ad-146">See Also</span></span>  
 <span data-ttu-id="484ad-147">[Filtrar, agrupar e classificar dados &#40;Construtor de Relatórios e SSRS&#41;](filter-group-and-sort-data-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="484ad-147">[Filter, Group, and Sort Data &#40;Report Builder and SSRS&#41;](filter-group-and-sort-data-report-builder-and-ssrs.md) </span></span>  
 <span data-ttu-id="484ad-148">[Coleções internas em expressões &#40;Construtor de Relatórios e SSRS&#41;](built-in-collections-in-expressions-report-builder.md) </span><span class="sxs-lookup"><span data-stu-id="484ad-148">[Built-in Collections in Expressions &#40;Report Builder and SSRS&#41;](built-in-collections-in-expressions-report-builder.md) </span></span>  
 [<span data-ttu-id="484ad-149">Exemplos de expressões &#40;Construtor de Relatórios e SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="484ad-149">Expression Examples &#40;Report Builder and SSRS&#41;</span></span>](expression-examples-report-builder-and-ssrs.md)  
  
  
