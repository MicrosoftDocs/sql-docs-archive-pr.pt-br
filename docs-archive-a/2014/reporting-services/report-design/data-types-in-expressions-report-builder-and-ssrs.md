---
title: Tipos de dados em expressões (Construtor de Relatórios e SSRS) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
ms.assetid: 94fdf921-270c-4c12-87b3-46b1cc98fae5
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 86aa646865ecfe3da6ed1ad4bacb75907ab39472
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87683432"
---
# <a name="data-types-in-expressions-report-builder-and-ssrs"></a><span data-ttu-id="0fe0a-102">Tipos de dados em expressões (Construtor de Relatórios e SSRS)</span><span class="sxs-lookup"><span data-stu-id="0fe0a-102">Data Types in Expressions (Report Builder and SSRS)</span></span>
  <span data-ttu-id="0fe0a-103">Os tipos de dados representam tipos diferentes de dados de forma que eles possam ser armazenados e processados com eficiência.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-103">Data types represent different kinds of data so that it can be stored and processed efficiently.</span></span> <span data-ttu-id="0fe0a-104">Tipos de dados comuns incluem texto (também conhecido como cadeias de caracteres) com e sem casas decimais, datas e horas e imagens.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-104">Typical data types include text (also known as strings), numbers with and without decimal places, dates and times, and images.</span></span> <span data-ttu-id="0fe0a-105">Os valores em um relatório devem ser um tipo de dados RDL.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-105">Values in a report must be an Report Definition Language (RDL) data type.</span></span> <span data-ttu-id="0fe0a-106">Você pode formatar um valor de acordo com sua preferência ao exibi-lo em um relatório.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-106">You can format a value according to your preference when you display it in a report.</span></span> <span data-ttu-id="0fe0a-107">Por exemplo, um campo que representa moeda pode ser armazenado na definição de relatório como um número de ponto flutuante, mas pode ser exibido em uma variedade de formatos, dependendo da propriedade de formato escolhida.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-107">For example, a field that represents currency is stored in the report definition as a floating point number, but can be displayed in a variety of formats depending on the format property you choose.</span></span>  
  
 <span data-ttu-id="0fe0a-108">Para obter mais informações sobre formatos de exibição, consulte [Formatando itens de relatório &#40;Construtor de Relatórios e SSRS&#41;](formatting-report-items-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="0fe0a-108">For more information about display formats, see [Formatting Report Items &#40;Report Builder and SSRS&#41;](formatting-report-items-report-builder-and-ssrs.md).</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
## <a name="report-definition-language-rdl-data-types-and-common-language-runtime-clr-data-types"></a><span data-ttu-id="0fe0a-109">Tipos de dados RDL e CLR</span><span class="sxs-lookup"><span data-stu-id="0fe0a-109">Report Definition Language (RDL) Data Types and Common Language Runtime (CLR) Data Types</span></span>  
 <span data-ttu-id="0fe0a-110">Valores que são especificados em um arquivo RDL devem ser um tipo de dados RDL.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-110">Values that are specified in an RDL file must be an RDL data type.</span></span> <span data-ttu-id="0fe0a-111">Quando o relatório é compilado e processado, os tipos de dados RDL são convertidos em tipos de dados CLR.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-111">When the report is compiled and processed, RDL data types are converted to CLR data types.</span></span> <span data-ttu-id="0fe0a-112">A seguinte tabela exibe a conversão, que é marcada como Padrão:</span><span class="sxs-lookup"><span data-stu-id="0fe0a-112">The following table displays the conversion, which is marked Default:</span></span>  
  
|<span data-ttu-id="0fe0a-113">Tipo RDL</span><span class="sxs-lookup"><span data-stu-id="0fe0a-113">RDL Type</span></span>|<span data-ttu-id="0fe0a-114">Tipos CLR</span><span class="sxs-lookup"><span data-stu-id="0fe0a-114">CLR Types</span></span>|  
|--------------|---------------|  
|<span data-ttu-id="0fe0a-115">String</span><span class="sxs-lookup"><span data-stu-id="0fe0a-115">String</span></span>|<span data-ttu-id="0fe0a-116">Padrão: cadeia de caracteres</span><span class="sxs-lookup"><span data-stu-id="0fe0a-116">Default: String</span></span><br /><br /> <span data-ttu-id="0fe0a-117">Chart, GUID, Timespan</span><span class="sxs-lookup"><span data-stu-id="0fe0a-117">Chart, GUID, Timespan</span></span>|  
|<span data-ttu-id="0fe0a-118">Boolean</span><span class="sxs-lookup"><span data-stu-id="0fe0a-118">Boolean</span></span>|<span data-ttu-id="0fe0a-119">Padrão: Boolean</span><span class="sxs-lookup"><span data-stu-id="0fe0a-119">Default: Boolean</span></span>|  
|<span data-ttu-id="0fe0a-120">Integer</span><span class="sxs-lookup"><span data-stu-id="0fe0a-120">Integer</span></span>|<span data-ttu-id="0fe0a-121">Padrão: Int64</span><span class="sxs-lookup"><span data-stu-id="0fe0a-121">Default: Int64</span></span><br /><br /> <span data-ttu-id="0fe0a-122">Int16, Int32, Uint16, Uint64, Byte, Sbyte</span><span class="sxs-lookup"><span data-stu-id="0fe0a-122">Int16, Int32, Uint16, Uint64, Byte, Sbyte</span></span>|  
|<span data-ttu-id="0fe0a-123">Datetime</span><span class="sxs-lookup"><span data-stu-id="0fe0a-123">DateTime</span></span>|<span data-ttu-id="0fe0a-124">Padrão: DateTime</span><span class="sxs-lookup"><span data-stu-id="0fe0a-124">Default: DateTime</span></span><br /><br /> <span data-ttu-id="0fe0a-125">DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="0fe0a-125">DateTimeOffset</span></span>|  
|<span data-ttu-id="0fe0a-126">Float</span><span class="sxs-lookup"><span data-stu-id="0fe0a-126">Float</span></span>|<span data-ttu-id="0fe0a-127">Padrão: Double</span><span class="sxs-lookup"><span data-stu-id="0fe0a-127">Default: Double</span></span><br /><br /> <span data-ttu-id="0fe0a-128">Single, Decimal</span><span class="sxs-lookup"><span data-stu-id="0fe0a-128">Single, Decimal</span></span>|  
|<span data-ttu-id="0fe0a-129">Binário</span><span class="sxs-lookup"><span data-stu-id="0fe0a-129">Binary</span></span>|<span data-ttu-id="0fe0a-130">Padrão: Byte[]</span><span class="sxs-lookup"><span data-stu-id="0fe0a-130">Default: Byte[]</span></span>|  
|<span data-ttu-id="0fe0a-131">Variante</span><span class="sxs-lookup"><span data-stu-id="0fe0a-131">Variant</span></span>|<span data-ttu-id="0fe0a-132">Qualquer um dos itens acima, exceto Byte[]</span><span class="sxs-lookup"><span data-stu-id="0fe0a-132">Any of the above except Byte[]</span></span>|  
|<span data-ttu-id="0fe0a-133">VariantArray</span><span class="sxs-lookup"><span data-stu-id="0fe0a-133">VariantArray</span></span>|<span data-ttu-id="0fe0a-134">Matriz de Variant</span><span class="sxs-lookup"><span data-stu-id="0fe0a-134">Array of Variant</span></span>|  
|<span data-ttu-id="0fe0a-135">Serializável</span><span class="sxs-lookup"><span data-stu-id="0fe0a-135">Serializable</span></span>|<span data-ttu-id="0fe0a-136">Variação ou tipos marcados com Serializable ou que implementam ISerializable.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-136">Variant or types marked with Serializable or that implement ISerializable.</span></span>|  
  
## <a name="understanding-data-types-and-writing-expressions"></a><span data-ttu-id="0fe0a-137">Entendendo tipos de dados e escrevendo expressões</span><span class="sxs-lookup"><span data-stu-id="0fe0a-137">Understanding Data Types and Writing Expressions</span></span>  
 <span data-ttu-id="0fe0a-138">É importante entender os tipos de dados quando você grava expressões para comparar ou combinar valores; por exemplo, quando você define expressões de grupo ou filtro ou calcular agregações.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-138">It is important to understand data types when you write expressions to compare or combine values, for example, when you define group or filter expressions, or calculate aggregates.</span></span> <span data-ttu-id="0fe0a-139">As comparações e os cálculos são válidos somente entre itens do mesmo tipo de dados.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-139">Comparisons and calculations are valid only between items of the same data type.</span></span> <span data-ttu-id="0fe0a-140">Se os tipos de dados não coincidirem, você deverá converter explicitamente o tipo de dados no item de relatório usando uma expressão.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-140">If the data types do not match, you must explicitly convert the data type in the report item by using an expression.</span></span>  
  
 <span data-ttu-id="0fe0a-141">A lista a seguir descreve os casos quando você precisa converter os dados em um tipo de dados diferente:</span><span class="sxs-lookup"><span data-stu-id="0fe0a-141">The following list describes cases when you may need to convert data to a different data type:</span></span>  
  
-   <span data-ttu-id="0fe0a-142">Comparando o valor de um parâmetro de relatório de um tipo de dados a um campo de conjunto de dados de um tipo de dados diferente.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-142">Comparing the value of a report parameter of one data type to a dataset field of a different data type.</span></span>  
  
-   <span data-ttu-id="0fe0a-143">Escrevendo expressões de filtro que compõem valores de tipos de dados diferentes.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-143">Writing filter expressions that compare values of different data types.</span></span>  
  
-   <span data-ttu-id="0fe0a-144">Escrevendo expressões de classificação que combinam campos de tipos de dados diferentes.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-144">Writing sort expressions that combine fields of different data types.</span></span>  
  
-   <span data-ttu-id="0fe0a-145">Escrevendo expressões de grupo que combinam campos de tipos de dados diferentes.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-145">Writing group expressions that combine fields of different data types.</span></span>  
  
-   <span data-ttu-id="0fe0a-146">Convertendo um valor recuperado da fonte de dados de um tipo de dados para um tipo de dados diferente.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-146">Converting a value retrieved from the data source from one data type to a different data type.</span></span>  
  
## <a name="determining-the-data-type-of-report-data"></a><span data-ttu-id="0fe0a-147">Determinando o tipo de dados dos dados do relatório</span><span class="sxs-lookup"><span data-stu-id="0fe0a-147">Determining the Data Type of Report Data</span></span>  
 <span data-ttu-id="0fe0a-148">Para determinar o tipo de dados de um item de relatório, você pode gravar uma expressão que retorne seu tipo de dados.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-148">To determine the data type of a report item, you can write an expression that returns its data type.</span></span> <span data-ttu-id="0fe0a-149">Por exemplo, para mostrar o tipo de dados para o campo `MyField`, adicione a seguinte expressão a uma célula de tabela: `=Fields!MyField.Value.GetType().ToString()`.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-149">For example, to show the data type for the field `MyField`, add the following expression to a table cell: `=Fields!MyField.Value.GetType().ToString()`.</span></span> <span data-ttu-id="0fe0a-150">O resultado exibe o tipo de dados CLR usado para representar `MyField`, por exemplo, `System.String` ou `System.DateTime`.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-150">The result displays the CLR data type used to represent `MyField`, for example, `System.String` or `System.DateTime`.</span></span>  
  
## <a name="converting-dataset-fields-to-a-different-data-type"></a><span data-ttu-id="0fe0a-151">Convertendo campos de conjunto de dados em um tipo de dados diferente</span><span class="sxs-lookup"><span data-stu-id="0fe0a-151">Converting Dataset Fields to a Different Data Type</span></span>  
 <span data-ttu-id="0fe0a-152">Você também pode converter os campos de conjunto de dados antes de usá-los em um relatório.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-152">You can also convert dataset fields before you use them in a report.</span></span> <span data-ttu-id="0fe0a-153">A lista a seguir descreve as maneiras que você pode converter um campo de conjunto de dados existente:</span><span class="sxs-lookup"><span data-stu-id="0fe0a-153">The following list describes ways that you can convert an existing dataset field:</span></span>  
  
-   <span data-ttu-id="0fe0a-154">Modifique a consulta do conjunto de dados para adicionar um novo campo de consulta com os dados convertidos.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-154">Modify the dataset query to add a new query field with the converted data.</span></span> <span data-ttu-id="0fe0a-155">Para as fontes de dados relacionais ou multidimensionais, isso usa os recursos de origem de dados para executar a conversão.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-155">For relational or multidimensional data sources, this uses data source resources to perform the conversion.</span></span>  
  
-   <span data-ttu-id="0fe0a-156">Crie um campo calculado com base em um campo de conjunto de dados de relatório existente, escrevendo uma expressão que converta todos os dados em uma coluna de conjunto de resultados em uma nova coluna com um tipo de dados diferente.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-156">Create a calculated field based on an existing report dataset field by writing an expression that converts all the data in one result set column to a new column with a different data type.</span></span> <span data-ttu-id="0fe0a-157">Por exemplo, a expressão seguir converte o campo Ano de um valor inteiro para um valor de cadeia: `=CStr(Fields!Year.Value)`.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-157">For example, the following expression converts the field Year from an integer value to a string value: `=CStr(Fields!Year.Value)`.</span></span> <span data-ttu-id="0fe0a-158">Para saber mais, confira [Adicionar, editar e atualizar campos no painel de dados do relatório &#40;Construtor de Relatórios e SSRS&#41;](../report-data/add-edit-refresh-fields-in-the-report-data-pane-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="0fe0a-158">For more information, see [Add, Edit, Refresh Fields in the Report Data Pane &#40;Report Builder and SSRS&#41;](../report-data/add-edit-refresh-fields-in-the-report-data-pane-report-builder-and-ssrs.md).</span></span>  
  
-   <span data-ttu-id="0fe0a-159">Verifique se a extensão de processamento de dados que você está usando inclui metadados para recuperar dados pré-formatados.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-159">Check whether the data processing extension you are using includes metadata for retrieving preformatted data.</span></span> <span data-ttu-id="0fe0a-160">Por exemplo, uma consulta MDX do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] inclui a propriedade estendida FORMATTED_VALUE para valores de cubo que já foram formatados ao processar o cubo.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-160">For example, a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] MDX query includes a FORMATTED_VALUE extended property for cube values that have already been formatted when processing the cube.</span></span> <span data-ttu-id="0fe0a-161">Para obter mais informações, consulte [Propriedades de campos estendidos para um banco de dados do Analysis Services &#40;SSRS&#41;](../report-data/extended-field-properties-for-an-analysis-services-database-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="0fe0a-161">For more information, see [Extended Field Properties for an Analysis Services Database &#40;SSRS&#41;](../report-data/extended-field-properties-for-an-analysis-services-database-ssrs.md).</span></span>  
  
## <a name="understanding-parameter-data-types"></a><span data-ttu-id="0fe0a-162">Entendendo os tipos de dados de parâmetro</span><span class="sxs-lookup"><span data-stu-id="0fe0a-162">Understanding Parameter Data Types</span></span>  
 <span data-ttu-id="0fe0a-163">Os parâmetros de relatório devem ser um dos cinco tipos de dados: Boolean, DateTime, Integer, Float ou Text (também conhecido como String).</span><span class="sxs-lookup"><span data-stu-id="0fe0a-163">Report parameters must be one of five data types: Boolean, DateTime, Integer, Float, or Text (also known as String).</span></span> <span data-ttu-id="0fe0a-164">Quando sua consulta de conjunto de dados inclui parâmetros de consulta, os parâmetros de relatório são criados automaticamente e vinculados a parâmetros de consulta.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-164">When a dataset query includes query parameters, report parameters are automatically created and linked to the query parameters.</span></span> <span data-ttu-id="0fe0a-165">O tipo de dados padrão para um parâmetro de relatório é String.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-165">The default data type for a report parameter is String.</span></span> <span data-ttu-id="0fe0a-166">Para alterar o tipo de dados padrão de um parâmetro de relatório, selecione o valor correto da lista suspensa **Tipo de dados** na página **Geral** da caixa de diálogo **Propriedades do Parâmetro de Relatórios** .</span><span class="sxs-lookup"><span data-stu-id="0fe0a-166">To change the default data type of a report parameter, select the correct value from the **Data type** drop-down list on the **General** page of the **Report Parameter Properties** dialog box.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="0fe0a-167">Os parâmetros de relatório que são tipos de dados DateTime não oferecem suporte a milissegundos.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-167">Report parameters that are DateTime data types do not support milliseconds.</span></span> <span data-ttu-id="0fe0a-168">Embora você possa criar um parâmetro com base em valores que incluem milissegundos, você não pode selecionar um valor a partir de uma lista suspensa de valores disponíveis que inclui valores de Data e Hora que incluem milissegundos.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-168">Although you can create a parameter based on values that include milliseconds, you cannot select a value from an available values drop-down list that includes Date or Time values that include milliseconds.</span></span>  
  
## <a name="writing-expressions-that-convert-data-types-or-extract-parts-of-data"></a><span data-ttu-id="0fe0a-169">Escrevendo expressões que convertem tipos de dados ou extraem partes de dados</span><span class="sxs-lookup"><span data-stu-id="0fe0a-169">Writing Expressions that Convert Data Types or Extract Parts of Data</span></span>  
 <span data-ttu-id="0fe0a-170">Quando você combina campos de texto e conjunto de dados usando o operador de concatenação (&), o CLR (Common Language Runtime) geralmente fornece os formatos padrão.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-170">When you combine text and dataset fields using the concatenation operator (&), the common language runtime (CLR) generally provides default formats.</span></span> <span data-ttu-id="0fe0a-171">Quando você precisa converter explicitamente um parâmetro ou campo de conjunto de dados em um tipo de dados específico, você deve usar um método CLR ou uma função de biblioteca de runtime do Visual Basic para converter os dados.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-171">When you need to explicitly convert a dataset field or parameter to a specific data type, you must use a CLR method or a Visual Basic runtime library function to convert the data.</span></span>  
  
 <span data-ttu-id="0fe0a-172">A tabela a seguir mostra exemplos de conversão de tipos de dados.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-172">The following table shows examples of converting data types.</span></span>  
  
|<span data-ttu-id="0fe0a-173">Tipo de conversão</span><span class="sxs-lookup"><span data-stu-id="0fe0a-173">Type of conversion</span></span>|<span data-ttu-id="0fe0a-174">Exemplo</span><span class="sxs-lookup"><span data-stu-id="0fe0a-174">Example</span></span>|  
|------------------------|-------------|  
|<span data-ttu-id="0fe0a-175">DateTime para String</span><span class="sxs-lookup"><span data-stu-id="0fe0a-175">DateTime to String</span></span>|`=CStr(Fields!Date.Value)`|  
|<span data-ttu-id="0fe0a-176">String para DateTime</span><span class="sxs-lookup"><span data-stu-id="0fe0a-176">String to DateTime</span></span>|`=DateTime.Parse(Fields!DateTimeinStringFormat.Value)`|  
|<span data-ttu-id="0fe0a-177">String para DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="0fe0a-177">String to DateTimeOffset</span></span>|`=DateTimeOffset.Parse(Fields!DateTimeOffsetinStringFormat.Value)`|  
|<span data-ttu-id="0fe0a-178">Extraindo o ano</span><span class="sxs-lookup"><span data-stu-id="0fe0a-178">Extracting the Year</span></span>|`=Year(Fields!TimeinStringFormat.Value)`<br /><br /> `-- or --`<br /><br /> `=Year(Fields!TimeinDateTimeFormat.Value)`|  
|<span data-ttu-id="0fe0a-179">Booleano para Integer</span><span class="sxs-lookup"><span data-stu-id="0fe0a-179">Boolean to Integer</span></span>|`=CInt(Parameters!BooleanField.Value)`<br /><br /> <span data-ttu-id="0fe0a-180">\- 1 é verdadeiro e 0 é falso.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-180">-1 is True and 0 is False.</span></span>|  
|<span data-ttu-id="0fe0a-181">Booleano para Integer</span><span class="sxs-lookup"><span data-stu-id="0fe0a-181">Boolean to Integer</span></span>|`=System.Convert.ToInt32(Fields!BooleanFormat.Value)`<br /><br /> <span data-ttu-id="0fe0a-182">1 é verdadeiro e 0 é falso.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-182">1 is True and 0 is False.</span></span>|  
|<span data-ttu-id="0fe0a-183">Apenas a parte DateTime do valor DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="0fe0a-183">Just the DateTime part of a DateTimeOffset value</span></span>|`=Fields!MyDatetimeOffset.Value.DateTime`|  
|<span data-ttu-id="0fe0a-184">Apenas a parte Offset do valor DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="0fe0a-184">Just the Offset part of a DateTimeOffset value</span></span>|`=Fields!MyDatetimeOffset.Value.Offset`|  
  
 <span data-ttu-id="0fe0a-185">Você também pode usar a função Formatar para controlar o formato de exibição do valor.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-185">You can also use the Format function to control the display format for value.</span></span> <span data-ttu-id="0fe0a-186">Para obter mais informações, consulte [Funções (Visual Basic)](https://go.microsoft.com/fwlink/?linkid=111483).</span><span class="sxs-lookup"><span data-stu-id="0fe0a-186">For more information, see [Functions (Visual Basic)](https://go.microsoft.com/fwlink/?linkid=111483).</span></span>  
  
## <a name="advanced-examples"></a><span data-ttu-id="0fe0a-187">Exemplos avançados</span><span class="sxs-lookup"><span data-stu-id="0fe0a-187">Advanced Examples</span></span>  
 <span data-ttu-id="0fe0a-188">Quando você se conecta a uma fonte de dados com um provedor de dados que não fornece suporte à conversão para todos os tipos de dados dessa fonte de dados, o tipo de dados padrão para tipos de dados não suportados é String.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-188">When you connect to a data source with a data provider that does not provide conversion support for all the data types on the data source, the default data type for unsupported data source types is String.</span></span> <span data-ttu-id="0fe0a-189">Os exemplos a seguir fornecem soluções para tipos de dados específicos retornados como uma cadeia.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-189">The following examples provide solutions to specific data types that are returned as a string.</span></span>  
  
### <a name="concatenating-a-string-and-a-clr-datetimeoffset-data-type"></a><span data-ttu-id="0fe0a-190">Concatenando um tipo de dados String e um DateTimeOffset CLR</span><span class="sxs-lookup"><span data-stu-id="0fe0a-190">Concatenating a String and a CLR DateTimeOffset Data Type</span></span>  
 <span data-ttu-id="0fe0a-191">Para a maioria dos tipos de dados, o CLR fornece conversões padrão para que você possa concatenar valores que são de tipos de dados diferentes em uma cadeia, usando o operador &.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-191">For most data types, the CLR provides default conversions so that you can concatenate values that are different data types into one string by using the & operator.</span></span> <span data-ttu-id="0fe0a-192">Por exemplo, a expressão a seguir concatena o texto "A data e hora são:" com um campo de conjunto de dados StartDate, que é um valor <xref:System.DateTime> : `="The date and time are: " & Fields!StartDate.Value`.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-192">For example, the following expression concatenates the text "The date and time are: " with a dataset field StartDate, which is a <xref:System.DateTime> value: `="The date and time are: " & Fields!StartDate.Value`.</span></span>  
  
 <span data-ttu-id="0fe0a-193">Para alguns tipos de dados, talvez você precise incluir a função ToString.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-193">For some data types, you may need to include the ToString function.</span></span> <span data-ttu-id="0fe0a-194">Por exemplo, a expressão a seguir mostra o mesmo exemplo usando o tipo de dados CLR <xref:System.DateTimeOffset>, que inclui a data, a hora e o deslocamento de fuso horário relativo ao fuso horário UTC: `="The time is: " & Fields!StartDate.Value.ToString()`.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-194">For example, the following expression shows the same example using the CLR data type <xref:System.DateTimeOffset>, which include the date, the time, and a time-zone offset relative to the UTC time zone: `="The time is: " & Fields!StartDate.Value.ToString()`.</span></span>  
  
### <a name="converting-a-string-data-type-to-a-clr-datetime-data-type"></a><span data-ttu-id="0fe0a-195">Convertendo um tipo de dados String em um tipo de dados DateTime CLR</span><span class="sxs-lookup"><span data-stu-id="0fe0a-195">Converting a String Data Type to a CLR DateTime Data Type</span></span>  
 <span data-ttu-id="0fe0a-196">Se uma extensão de processamento de dados não oferecer suporte a todos os tipos de dados definidos em uma fonte de dados, os dados poderão ser recuperados como texto.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-196">If a data processing extension does not support all data types defined on a data source, the data may be retrieved as text.</span></span> <span data-ttu-id="0fe0a-197">Por exemplo, um valor de tipo de dados `datetimeoffset(7)` pode ser recuperado como um tipo de dados String.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-197">For example, a `datetimeoffset(7)` data type value may be retrieved as a String data type.</span></span> <span data-ttu-id="0fe0a-198">Em Perth, Austrália, o valor da cadeia para 1º de julho de 2008, às 6:05:07,9999999 AM.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-198">In Perth, Australia, the string value for July 1, 2008, at 6:05:07.9999999 A.M.</span></span> <span data-ttu-id="0fe0a-199">seria semelhante a:</span><span class="sxs-lookup"><span data-stu-id="0fe0a-199">would resemble:</span></span>  
  
 `2008-07-01 06:05:07.9999999 +08:00`  
  
 <span data-ttu-id="0fe0a-200">Este exemplo mostra a data (1º de julho de 2008), seguida pela hora com uma precisão de 7 dígitos (6:05:07.9999999 AM), seguida pelo deslocamento de fuso horário UTC em horas e minutos (mais 8 horas, 0 minutos).</span><span class="sxs-lookup"><span data-stu-id="0fe0a-200">This example shows the date (July 1, 2008), followed by the time to a 7-digit precision (6:05:07.9999999 A.M.), followed by a UTC time zone offset in hours and minutes (plus 8 hours, 0 minutes).</span></span> <span data-ttu-id="0fe0a-201">Para os exemplos a seguir, este valor foi colocado em um campo `String` chamado `MyDateTime.Value`.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-201">For the following examples, this value has been placed in a `String` field called `MyDateTime.Value`.</span></span>  
  
 <span data-ttu-id="0fe0a-202">Você pode usar uma das seguintes estratégias para converter esses dados para um ou mais valores CLR:</span><span class="sxs-lookup"><span data-stu-id="0fe0a-202">You can use one of the following strategies to convert this data to one or more CLR values:</span></span>  
  
-   <span data-ttu-id="0fe0a-203">Em uma caixa de texto, use uma expressão para extrair partes da cadeia.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-203">In a text box, use an expression to extract parts of the string.</span></span> <span data-ttu-id="0fe0a-204">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="0fe0a-204">For example:</span></span>  
  
    -   <span data-ttu-id="0fe0a-205">A expressão a seguir extrai apenas a parte da hora do deslocamento de fuso horário UTC e converte-a em minutos: `=CInt(Fields!MyDateTime.Value.Substring(Fields!MyDateTime.Value.Length-5,2)) * 60`</span><span class="sxs-lookup"><span data-stu-id="0fe0a-205">The following expression extracts just the hour part of the UTC time zone offset and converts it to minutes: `=CInt(Fields!MyDateTime.Value.Substring(Fields!MyDateTime.Value.Length-5,2)) * 60`</span></span>  
  
         <span data-ttu-id="0fe0a-206">O resultado é `480`.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-206">The result is `480`.</span></span>  
  
    -   <span data-ttu-id="0fe0a-207">A expressão a seguir converte a cadeia em um valor de data e hora: `=DateTime.Parse(Fields!MyDateTime.Value)`</span><span class="sxs-lookup"><span data-stu-id="0fe0a-207">The following expression converts the string to a date and time value: `=DateTime.Parse(Fields!MyDateTime.Value)`</span></span>  
  
         <span data-ttu-id="0fe0a-208">Se a cadeia `MyDateTime.Value` tiver um deslocamento UTC, a função `DateTime.Parse` primeiro se ajustará para o deslocamento UTC (7 AM</span><span class="sxs-lookup"><span data-stu-id="0fe0a-208">If the `MyDateTime.Value` string has a UTC offset, the `DateTime.Parse` function first adjusts for the UTC offset (7 A.M.</span></span> <span data-ttu-id="0fe0a-209">- [`+08:00`] para a hora UTC de 11 PM.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-209">- [`+08:00`] to the UTC time of 11 P.M.</span></span> <span data-ttu-id="0fe0a-210">da noite anterior).</span><span class="sxs-lookup"><span data-stu-id="0fe0a-210">the night before).</span></span> <span data-ttu-id="0fe0a-211">A função `DateTime.Parse` então aplicará o deslocamento UTC do servidor de relatórios local e, se necessário, ajustará a hora novamente para o Horário de Verão.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-211">The `DateTime.Parse` function then applies the local report server UTC offset and, if necessary, adjusts the time again for Daylight Saving Time.</span></span> <span data-ttu-id="0fe0a-212">Por exemplo, em Redmond, Washington, o deslocamento de horário local ajustado para o Horário de Verão é `[-07:00]`ou 7 horas antes de 11 PM.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-212">For example, in Redmond, Washington, the local time offset adjusted for Daylight Saving Time is `[-07:00]`, or 7 hours earlier than 11 PM.</span></span> <span data-ttu-id="0fe0a-213">O resultado é o seguinte valor `DateTime`: `2007-07-06 04:07:07 PM` (6 de julho de 2007 às 4:07 PM).</span><span class="sxs-lookup"><span data-stu-id="0fe0a-213">The result is the following `DateTime` value: `2007-07-06 04:07:07 PM` (July 6, 2007 at 4:07 P.M).</span></span>  
  
 <span data-ttu-id="0fe0a-214">Para obter mais informações sobre como converter cadeias de caracteres em `DateTime` tipos de dados, consulte [analisando cadeias de caracteres de data e hora](https://go.microsoft.com/fwlink/?LinkId=89703), [Formatando data e hora para uma cultura específica](https://go.microsoft.com/fwlink/?LinkId=89704)e [escolhendo entre DateTime, DateTimeOffset e TimeZoneInfo](https://go.microsoft.com/fwlink/?linkid=110652) no msdn.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-214">For more information about converting strings to `DateTime` data types, see [Parsing Date and Time Strings](https://go.microsoft.com/fwlink/?LinkId=89703), [Formatting Date and Time for a Specific Culture](https://go.microsoft.com/fwlink/?LinkId=89704), and [Choosing Between DateTime, DateTimeOffset, and TimeZoneInfo](https://go.microsoft.com/fwlink/?linkid=110652) on MSDN.</span></span>  
  
-   <span data-ttu-id="0fe0a-215">Adicione um novo campo calculado ao conjunto de dados de relatório que use uma expressão para extrair partes da cadeia.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-215">Add a new calculated field to the report dataset that uses an expression to extract parts of the string.</span></span> <span data-ttu-id="0fe0a-216">Para saber mais, confira [Adicionar, editar e atualizar campos no painel de dados do relatório &#40;Construtor de Relatórios e SSRS&#41;](../report-data/add-edit-refresh-fields-in-the-report-data-pane-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="0fe0a-216">For more information, see [Add, Edit, Refresh Fields in the Report Data Pane &#40;Report Builder and SSRS&#41;](../report-data/add-edit-refresh-fields-in-the-report-data-pane-report-builder-and-ssrs.md).</span></span>  
  
-   <span data-ttu-id="0fe0a-217">Altere a consulta do conjunto de dados do relatório para usar as funções [!INCLUDE[tsql](../../includes/tsql-md.md)] para extrair os valores de data e hora independentemente para criar colunas separadas.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-217">Change the report dataset query to use [!INCLUDE[tsql](../../includes/tsql-md.md)] functions to extract the date and time values independently to create separate columns.</span></span> <span data-ttu-id="0fe0a-218">O exemplo a seguir mostra como usar a função `DatePart` para adicionar uma coluna para o ano e um coluna para o fuso horário UTC convertido em minutos:</span><span class="sxs-lookup"><span data-stu-id="0fe0a-218">The following example shows how to use the function `DatePart` to add a column for the year and a column for the UTC time zone converted to minutes:</span></span>  
  
     `SELECT`  
  
     `MyDateTime,`  
  
     `DATEPART(year, MyDateTime) AS Year,`  
  
     `DATEPART(tz, MyDateTime) AS OffsetinMinutes`  
  
     `FROM MyDates`  
  
     <span data-ttu-id="0fe0a-219">O conjunto de resultados tem três colunas.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-219">The result set has three columns.</span></span> <span data-ttu-id="0fe0a-220">A primeira coluna é a data e hora, a segunda coluna é o ano e a terceira é o deslocamento UTC em minutos.</span><span class="sxs-lookup"><span data-stu-id="0fe0a-220">The first column is the date and time, the second column is the year, and the third column is the UTC offset in minutes.</span></span> <span data-ttu-id="0fe0a-221">A linha a seguir mostra os dados de exemplo:</span><span class="sxs-lookup"><span data-stu-id="0fe0a-221">The following row shows example data:</span></span>  
  
     `2008-07-01 06:05:07             2008                   480`  
  
 <span data-ttu-id="0fe0a-222">Para obter mais informações sobre tipos de dados do banco de dados [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], consulte [Tipos de dados &#40;Transact-SQL&#41;](/sql/t-sql/data-types/data-types-transact-sql) e [Tipos e funções de dados de data e hora &#40;Transact-SQL&#41;](/sql/t-sql/functions/date-and-time-data-types-and-functions-transact-sql) em [Manuais Online do SQL Server](https://go.microsoft.com/fwlink/?linkid=120955).</span><span class="sxs-lookup"><span data-stu-id="0fe0a-222">For more information about [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database data types, see [Data Types &#40;Transact-SQL&#41;](/sql/t-sql/data-types/data-types-transact-sql), and [Date and Time Data Types and Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/date-and-time-data-types-and-functions-transact-sql) in [SQL Server Books Online](https://go.microsoft.com/fwlink/?linkid=120955).</span></span>  
  
 <span data-ttu-id="0fe0a-223">Para obter mais emformações sobre tipos de dados [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , consulte [Tipos de dados no Analysis Services](https://docs.microsoft.com/analysis-services/multidimensional-models/olap-physical/data-types-in-analysis-services) em [SQL Server Books Onleme](https://go.microsoft.com/fwlink/?linkid=120955).</span><span class="sxs-lookup"><span data-stu-id="0fe0a-223">For more information about [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] data types, see [Data Types in Analysis Services](https://docs.microsoft.com/analysis-services/multidimensional-models/olap-physical/data-types-in-analysis-services) in [SQL Server Books Online](https://go.microsoft.com/fwlink/?linkid=120955).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0fe0a-224">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="0fe0a-224">See Also</span></span>  
 [<span data-ttu-id="0fe0a-225">Formatando itens de relatório &#40;Construtor de Relatórios e SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="0fe0a-225">Formatting Report Items &#40;Report Builder and SSRS&#41;</span></span>](formatting-report-items-report-builder-and-ssrs.md)  
  
  
