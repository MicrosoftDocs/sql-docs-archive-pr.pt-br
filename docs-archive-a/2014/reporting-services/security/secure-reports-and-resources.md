---
title: Proteger relatórios e recursos | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
helpviewer_keywords:
- security [Reporting Services], reports
- security [Reporting Services], resources
- reports [Reporting Services], security
- confidential reports [Reporting Services]
- resources [Reporting Services], security
ms.assetid: 63cd55c7-fd2a-49e3-a3f8-59eb1a1c6e83
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 6c8eef86da2fe9c7dcc92488a08516a73aa37e92
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87574477"
---
# <a name="secure-reports-and-resources"></a><span data-ttu-id="15278-102">Proteger relatórios e recursos</span><span class="sxs-lookup"><span data-stu-id="15278-102">Secure Reports and Resources</span></span>
  <span data-ttu-id="15278-103">É possível definir a segurança de relatórios e recursos individuais para controlar o nível de acesso que os usuários têm a esses itens.</span><span class="sxs-lookup"><span data-stu-id="15278-103">You can set security for individual reports and resources to control the degree of access that users have to these items.</span></span> <span data-ttu-id="15278-104">Por padrão, somente os usuários que são membros do grupo interno de **Administradores** podem executar relatórios, exibir recursos, modificar propriedades e excluir os itens.</span><span class="sxs-lookup"><span data-stu-id="15278-104">By default, only users who are members of the **Administrators** built-in group can run reports, view resources, modify properties, and delete the items.</span></span> <span data-ttu-id="15278-105">Todos os outros usuários devem ter atribuições de função que permitam o acesso a um relatório ou recurso.</span><span class="sxs-lookup"><span data-stu-id="15278-105">All other users must have role assignments created for them that allow access to a report or resource.</span></span>  
  
## <a name="role-based-access-to-reports-and-resources"></a><span data-ttu-id="15278-106">Access baseado em funções a relatórios e recursos</span><span class="sxs-lookup"><span data-stu-id="15278-106">Role-based Access to Reports and Resources</span></span>  
 <span data-ttu-id="15278-107">Para conceder acesso a relatórios e recursos, você pode permitir que os usuários herdem as atribuições de função existentes de uma pasta pai ou criem uma nova atribuição de função no próprio item.</span><span class="sxs-lookup"><span data-stu-id="15278-107">To grant access to reports and resources, you can allow users to inherit existing role assignments from a parent folder or create a new role assignment on the item itself.</span></span>  
  
 <span data-ttu-id="15278-108">Na maioria dos casos, você provavelmente vai usar as permissões que são herdadas de uma pasta pai.</span><span class="sxs-lookup"><span data-stu-id="15278-108">In most cases, you will probably want to use the permissions that are inherited from a parent folder.</span></span> <span data-ttu-id="15278-109">A definição de segurança em relatórios e recursos individuais é necessária somente se você desejar ocultar o relatório ou recurso dos usuários que não precisam saber de sua existência ou desejar aumentar o nível de acesso para um relatório ou item.</span><span class="sxs-lookup"><span data-stu-id="15278-109">Setting security on individual reports and resources should only be necessary if you want to hide the report or resource from users who do not need to know that the report or resource exists, or to increase the level of access for a report or item.</span></span> <span data-ttu-id="15278-110">Esses objetivos não são mutuamente exclusivos.</span><span class="sxs-lookup"><span data-stu-id="15278-110">These objectives are not mutually exclusive.</span></span> <span data-ttu-id="15278-111">Você pode restringir o acesso a um relatório a um grupo menor de usuários e fornecer a todos ou a alguns deles privilégios adicionais para gerenciar o relatório.</span><span class="sxs-lookup"><span data-stu-id="15278-111">You can restrict access to a report to a smaller set of users, and provide all or some of them with additional privileges to manage the report.</span></span>  
  
 <span data-ttu-id="15278-112">Você talvez precise criar várias atribuições de função para alcançar seus objetivos.</span><span class="sxs-lookup"><span data-stu-id="15278-112">You may need to create multiple role assignments to achieve your objectives.</span></span> <span data-ttu-id="15278-113">Por exemplo, suponha que você queira disponibilizar um relatório para dois usuários Ann e Fernando, e para o grupo Gerentes de Recursos Humanos.</span><span class="sxs-lookup"><span data-stu-id="15278-113">For example, suppose you have a report that you want to make accessible to two users, Ann and Fernando, and to the Human Resource Managers group.</span></span> <span data-ttu-id="15278-114">Ann e Fernando devem poder gerenciar o relatório, mas os membros do grupo só precisam executá-lo.</span><span class="sxs-lookup"><span data-stu-id="15278-114">Ann and Fernando must be able to manage the report, but the Human Resource Managers members need only to run it.</span></span> <span data-ttu-id="15278-115">Para acomodar todos esses usuários, você deveria criar três atribuição de função separadas: uma para que Ann fosse gerente de conteúdo do relatório, uma para Fernando ser gerente de conteúdo do relatório e outra para dar suporte a tarefas de somente exibição para o grupo Gerentes de Recursos Humanos.</span><span class="sxs-lookup"><span data-stu-id="15278-115">To accommodate all of these users, you would create three separate role assignments: one to make Ann a content manager of the report, one to make Fernando a content manager of the report, and one to support view-only tasks for the Human Resource Managers group.</span></span>  
  
 <span data-ttu-id="15278-116">Depois de definir a segurança em um relatório ou recurso, essas configurações permanecem com o item, mesmo que ele seja movido para um novo local.</span><span class="sxs-lookup"><span data-stu-id="15278-116">Once you set security on a report or resource, those settings stay with the item even if you move the item to a new location.</span></span> <span data-ttu-id="15278-117">Por exemplo, se você mover um relatório ao qual somente poucas pessoas têm acesso, o relatório continuará disponível somente para esses usuários mesmo que seja movido para uma pasta que tem uma política de segurança relativamente aberta.</span><span class="sxs-lookup"><span data-stu-id="15278-117">For example, if you move a report that only a few people are authorized to access, the report continues to be available to just those users even if you move it to a folder that has a relatively open security policy.</span></span>  
  
## <a name="mitigating-html-injection-attacks-in-a-published-report-or-document"></a><span data-ttu-id="15278-118">Diminuindo ataques de injeção HTML em um relatório ou documento publicado</span><span class="sxs-lookup"><span data-stu-id="15278-118">Mitigating HTML Injection Attacks in a Published Report or Document</span></span>  
 <span data-ttu-id="15278-119">No [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)], relatórios e recursos são processados com a identidade de segurança do usuário que está executando o relatório.</span><span class="sxs-lookup"><span data-stu-id="15278-119">In [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)], reports and resources are processed under the security identity of the user who is running the report.</span></span> <span data-ttu-id="15278-120">Se o relatório contiver expressões, scripts, itens de relatório personalizados ou assemblies personalizados, o código será executado com as credenciais do usuário.</span><span class="sxs-lookup"><span data-stu-id="15278-120">If the report contains expressions, script, custom report items, or custom assemblies, the code runs under the user's credentials.</span></span> <span data-ttu-id="15278-121">Se um recurso for um documento HTML que contém script. o script será executado quando o usuário abrir o documento no servidor de relatório.</span><span class="sxs-lookup"><span data-stu-id="15278-121">If a resource is an HTML document that contains script, the script will run when the user opens the document on the report server.</span></span> <span data-ttu-id="15278-122">A possibilidade de executar scripts ou códigos em um relatório é um recurso avançado que pode ser um pouco arriscado.</span><span class="sxs-lookup"><span data-stu-id="15278-122">The ability to run script or code within a report is a powerful feature that comes with a certain level of risk.</span></span> <span data-ttu-id="15278-123">Se o código for suspeito, o servidor de relatório e o usuário que está executando o relatório estarão vulneráveis a ataques.</span><span class="sxs-lookup"><span data-stu-id="15278-123">If the code is malicious, the report server and the user who is running the report are vulnerable to attack.</span></span>  
  
 <span data-ttu-id="15278-124">Ao conceder acesso a relatórios e recursos processados como HTML, é importante lembrar que os relatórios são processados em confiança total e que scripts possivelmente suspeitos podem ser enviados ao cliente.</span><span class="sxs-lookup"><span data-stu-id="15278-124">When granting access to reports and to resources that are processed as HTML, it is important to remember that reports are processed in full trust and that potentially malicious script might be sent to the client.</span></span> <span data-ttu-id="15278-125">Dependendo das configurações do navegador, o cliente executará o HTML no nível de confiança especificado no navegador.</span><span class="sxs-lookup"><span data-stu-id="15278-125">Depending on browser settings, the client will execute the HTML at the level of trust that is specified in the browser.</span></span>  
  
 <span data-ttu-id="15278-126">Você pode diminuir o risco de executar scripts suspeitos tomando as seguintes precauções:</span><span class="sxs-lookup"><span data-stu-id="15278-126">You can mitigate the risk of running malicious script by taking the following precautions:</span></span>  
  
-   <span data-ttu-id="15278-127">Tome cuidado ao decidir quem pode publicar conteúdo em um servidor de relatório.</span><span class="sxs-lookup"><span data-stu-id="15278-127">Be selective when deciding who can publish content to a report server.</span></span> <span data-ttu-id="15278-128">Como conteúdos suspeitos podem ser publicados, limite os usuários que podem publicar conteúdo a um pequeno número de usuários confiáveis.</span><span class="sxs-lookup"><span data-stu-id="15278-128">Because the potential for publishing malicious content exists, you should limit users who can publish content to a small number of trusted users.</span></span>  
  
-   <span data-ttu-id="15278-129">Todos os editores devem evitar publicar relatórios e recursos provenientes de origens desconhecidas ou não confiáveis.</span><span class="sxs-lookup"><span data-stu-id="15278-129">All publishers should avoid publishing reports and resources that come from unknown or untrusted sources.</span></span> <span data-ttu-id="15278-130">Se necessário, abra o arquivo em um editor de textos e procure scripts e URLs suspeitos.</span><span class="sxs-lookup"><span data-stu-id="15278-130">If necessary, open the file in a text editor and look for suspicious script and URLs.</span></span>  
  
## <a name="report-parameters-and-script-injection"></a><span data-ttu-id="15278-131">Parâmetros de Relatórios e Injeção de Script</span><span class="sxs-lookup"><span data-stu-id="15278-131">Report Parameters and Script Injection</span></span>  
 <span data-ttu-id="15278-132">Os Parâmetros de Relatório proporcionam flexibilidade para o projeto geral e a emissão do relatório.</span><span class="sxs-lookup"><span data-stu-id="15278-132">Report Parameters provide flexibility for the overall report design and execution.</span></span> <span data-ttu-id="15278-133">Porém, essa mesma flexibilidade pode, em alguns casos, ser usada por um invasor em ataques de atração.</span><span class="sxs-lookup"><span data-stu-id="15278-133">However, this same flexibility can, in some cases be used by an attacker in luring attacks.</span></span> <span data-ttu-id="15278-134">Para atenuar o risco de execução acidental de scripts mal-intencionados, abra apenas relatórios renderizados de fontes confiáveis.</span><span class="sxs-lookup"><span data-stu-id="15278-134">To mitigate the risk of inadvertently running malicious scripts, only open rendered reports from trusted sources.</span></span> <span data-ttu-id="15278-135">Recomenda-se que você considere o seguinte cenário, que é um potencial ataque de injeção de script ao Renderizador de HTML:</span><span class="sxs-lookup"><span data-stu-id="15278-135">It is recommended you consider the following scenario that is a potential HTML Renderer script injection attack:</span></span>  
  
1.  <span data-ttu-id="15278-136">Um relatório contém uma caixa de texto com a ação de hiperlink definida como o valor de um parâmetro que pode conter texto mal-intencionado.</span><span class="sxs-lookup"><span data-stu-id="15278-136">A report contains a text box with the hyperlink action set to the value of a parameter which could contain malicious text.</span></span>  
  
2.  <span data-ttu-id="15278-137">O relatório é publicado em um servidor de relatórios ou de outra forma disponibilizado de modo que o valor de parâmetro de relatório possa ser controlado pela URL de uma página da Web.</span><span class="sxs-lookup"><span data-stu-id="15278-137">The report is published to a report server or otherwise made available in such a way that the report parameter value can be controlled from the URL of a web page.</span></span>  
  
3.  <span data-ttu-id="15278-138">Um invasor cria um link para a página da Web ou o servidor de relatório especificando o valor do parâmetro no formato "JavaScript: \<malicious script here> " e envia esse link para outra pessoa em um ataque de chamariz.</span><span class="sxs-lookup"><span data-stu-id="15278-138">An attacker creates a link to the web page or report server specifying the value of the parameter in the form "javascript:\<malicious script here>" and sends that link to someone else in a luring attack.</span></span>  
  
## <a name="mitigating-script-injection-attacks-in-a-hyperlink-in-a-published-report-or-document"></a><span data-ttu-id="15278-139">Atenuando ataques de injeção de script em um hiperlink de um relatório ou documento publicado</span><span class="sxs-lookup"><span data-stu-id="15278-139">Mitigating Script Injection Attacks in a Hyperlink in a Published Report or Document</span></span>  
 <span data-ttu-id="15278-140">Relatórios podem conter hiperlinks inseridos no valor da propriedade Action de um item de relatório ou parte de um item de relatório.</span><span class="sxs-lookup"><span data-stu-id="15278-140">Reports can contain embedded hyperlinks in the value of the Action property on a report item or part of a report item.</span></span> <span data-ttu-id="15278-141">Hiperlinks podem ser associados a dados que recuperados de uma fonte de dados externa quando o relatório é processado.</span><span class="sxs-lookup"><span data-stu-id="15278-141">Hyperlinks can be bound to data that is retrieved from an external data source when the report is processed.</span></span> <span data-ttu-id="15278-142">Se um usuário mal-intencionado modificar os dados subjacentes, o hiperlink pode correr o risco de explorações de script.</span><span class="sxs-lookup"><span data-stu-id="15278-142">If a malicious user modifies the underlying data, the hyperlink might be at risk for scripting exploits.</span></span> <span data-ttu-id="15278-143">Se um usuário clicar no link no relatório publicado ou exportado, o script mal-intencionado pode ser executado.</span><span class="sxs-lookup"><span data-stu-id="15278-143">If a user clicks the link in the published or exported report, malicious script could run.</span></span>  
  
 <span data-ttu-id="15278-144">Para atenuar o risco de incluir links em um relatório que executam inadvertidamente scripts mal-intencionados, associe hiperlinks a dados apenas de fontes confiáveis.</span><span class="sxs-lookup"><span data-stu-id="15278-144">To mitigate the risk of including links in a report that inadvertently run malicious scripts, only bind hyperlinks to data from trusted sources.</span></span> <span data-ttu-id="15278-145">Verifique se os dados dos resultados da consulta e as expressões que associam dados a hiperlinks não criam links que possam ser explorados.</span><span class="sxs-lookup"><span data-stu-id="15278-145">Verify that data from the query results and the expressions that bind data to hyperlinks do not create links that can be exploited.</span></span> <span data-ttu-id="15278-146">Por exemplo, não baseie um hiperlink em uma expressão que concatene dados de vários campos de conjuntos de dados.</span><span class="sxs-lookup"><span data-stu-id="15278-146">For example, do not base a hyperlink on an expression that concatenates data from multiple dataset fields.</span></span> <span data-ttu-id="15278-147">Se necessário, navegue até o relatório e use "Exibir origem" para verificar scripts e URLs suspeitos.</span><span class="sxs-lookup"><span data-stu-id="15278-147">If necessary, browse to the report and use "View Source" to check for suspicious scripts and URLs.</span></span>  
  
## <a name="mitigating-sql-injection-attacks-in-a-parameterized-report"></a><span data-ttu-id="15278-148">Diminuindo ataques de injeção SQL em um relatório parametrizado</span><span class="sxs-lookup"><span data-stu-id="15278-148">Mitigating SQL Injection Attacks in a Parameterized Report</span></span>  
 <span data-ttu-id="15278-149">Em qualquer relatório que inclua um parâmetro do tipo `String`, use uma lista de valores disponíveis (também conhecida como uma lista de valores válidos) e verifique se todos os usuários que executam o relatório têm somente as permissões necessárias para exibir os dados do relatório.</span><span class="sxs-lookup"><span data-stu-id="15278-149">In any report that includes a parameter of type `String`, be sure to use an available values list (also known as a valid values list) and ensure that any user running the report has only the permissions required to view the data in the report.</span></span> <span data-ttu-id="15278-150">Quando você define um parâmetro do tipo `String`, é exibida para o usuário uma caixa de texto que pode ter qualquer valor.</span><span class="sxs-lookup"><span data-stu-id="15278-150">When you define a parameter of type `String`, the user is presented with a text box that can take any value.</span></span> <span data-ttu-id="15278-151">Uma lista de valores disponíveis limita os valores que podem ser inseridos.</span><span class="sxs-lookup"><span data-stu-id="15278-151">An available values list limits the values that can be entered.</span></span> <span data-ttu-id="15278-152">Se o parâmetro do relatório estiver associado a um parâmetro de consulta e uma lista de valores disponíveis não for usada, um usuário do relatório poderá digitar sintaxe SQL na caixa de texto, abrindo potencialmente o relatório e o servidor a um ataque de injeção SQL.</span><span class="sxs-lookup"><span data-stu-id="15278-152">If the report parameter is tied to a query parameter and you do not use an available values list, it is possible for a report user to type SQL syntax into the text box, potentially opening the report and your server to a SQL injection attack.</span></span> <span data-ttu-id="15278-153">Se o usuário tiver permissões suficientes para executar a nova instrução SQL, resultados indesejados podem ser produzidos no servidor.</span><span class="sxs-lookup"><span data-stu-id="15278-153">If the user has sufficient permissions to execute the new SQL statement, it may produce unwanted results on the server.</span></span>  
  
 <span data-ttu-id="15278-154">Se um parâmetro de relatório não estiver associado a um parâmetro de consulta e os valores de parâmetro forem incluídos no relatório, um usuário do relatório poderá digitar a sintaxe de expressão ou uma URL no valor de parâmetro e processar o relatório em Excel ou HTML.</span><span class="sxs-lookup"><span data-stu-id="15278-154">If a report parameter is not tied to a query parameter and the parameter values are included in the report, it is possible for a report user to type expression syntax or a URL into the parameter value and render the report to Excel or HTML.</span></span> <span data-ttu-id="15278-155">Se outro usuário exibir o relatório e clicar no conteúdo do parâmetro renderizado, o usuário poderá executar acidentalmente o script ou link mal-intencionado.</span><span class="sxs-lookup"><span data-stu-id="15278-155">If another user then views the report and clicks the rendered parameter contents, the user may inadvertently execute the malicious script or link.</span></span>  
  
 <span data-ttu-id="15278-156">Para reduzir o risco de execução acidental de scripts mal-intencionados, só abra relatórios renderizados de fontes confiáveis.</span><span class="sxs-lookup"><span data-stu-id="15278-156">To mitigate the risk of inadvertently running malicious scripts, open rendered reports only from trusted sources.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="15278-157">Em versões anteriores da documentação, foi incluído um exemplo de criação de uma consulta dinâmica como uma expressão.</span><span class="sxs-lookup"><span data-stu-id="15278-157">In previous releases of the documentation, an example of creating a dynamic query as an expression was included.</span></span> <span data-ttu-id="15278-158">Esse tipo de consulta cria uma vulnerabilidade a ataques de injeção SQL e, portanto, não é recomendado.</span><span class="sxs-lookup"><span data-stu-id="15278-158">This type of query creates a vulnerability to SQL injection attacks and therefore is not recommended.</span></span>  
  
## <a name="securing-confidential-reports"></a><span data-ttu-id="15278-159">Protegendo relatórios confidenciais</span><span class="sxs-lookup"><span data-stu-id="15278-159">Securing Confidential Reports</span></span>  
 <span data-ttu-id="15278-160">Os relatórios que contêm informações confidenciais devem ser protegidos no nível de acesso aos dados, solicitando que os usuários forneçam credenciais para acessar dados confidenciais.</span><span class="sxs-lookup"><span data-stu-id="15278-160">Reports that contain confidential information should be secured at the data-access level, by requiring users to provide credentials to access sensitive data.</span></span> <span data-ttu-id="15278-161">Para obter mais informações, consulte [Especificar informações de credenciais e de conexão para fontes de dados de relatório](../report-data/specify-credential-and-connection-information-for-report-data-sources.md).</span><span class="sxs-lookup"><span data-stu-id="15278-161">For more information, see [Specify Credential and Connection Information for Report Data Sources](../report-data/specify-credential-and-connection-information-for-report-data-sources.md).</span></span> <span data-ttu-id="15278-162">Você também pode proteger uma pasta deixá-la inacessível para usuários não autorizados.</span><span class="sxs-lookup"><span data-stu-id="15278-162">You can also secure a folder to make it inaccessible to unauthorized users.</span></span> <span data-ttu-id="15278-163">Para obter mais informações, consulte [Proteger pastas](secure-folders.md).</span><span class="sxs-lookup"><span data-stu-id="15278-163">For more information, see [Secure Folders](secure-folders.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="15278-164">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="15278-164">See Also</span></span>  
 <span data-ttu-id="15278-165">(create-and-manage-role-assignments.md)</span><span class="sxs-lookup"><span data-stu-id="15278-165">(create-and-manage-role-assignments.md)</span></span>   
 <span data-ttu-id="15278-166">[Configurar o acesso ao Construtor de Relatórios](../report-server/configure-report-builder-access.md) </span><span class="sxs-lookup"><span data-stu-id="15278-166">[Configure Report Builder Access](../report-server/configure-report-builder-access.md) </span></span>  
 <span data-ttu-id="15278-167">[Concedendo permissões em um servidor de relatório no modo nativo](granting-permissions-on-a-native-mode-report-server.md) </span><span class="sxs-lookup"><span data-stu-id="15278-167">[Granting Permissions on a Native Mode Report Server](granting-permissions-on-a-native-mode-report-server.md) </span></span>  
 <span data-ttu-id="15278-168">[Proteger itens de fonte de dados compartilhados](secure-shared-data-source-items.md) </span><span class="sxs-lookup"><span data-stu-id="15278-168">[Secure Shared Data Source Items](secure-shared-data-source-items.md) </span></span>  
 [<span data-ttu-id="15278-169">Store Credentials in a Reporting Services Data Source</span><span class="sxs-lookup"><span data-stu-id="15278-169">Store Credentials in a Reporting Services Data Source</span></span>](../report-data/store-credentials-in-a-reporting-services-data-source.md)  
  
  
