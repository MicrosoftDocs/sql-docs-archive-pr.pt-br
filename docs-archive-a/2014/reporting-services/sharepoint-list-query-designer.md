---
title: Designer de consulta de lista do SharePoint | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
ms.assetid: 593de30c-69f0-42a8-8467-16e78647b74c
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 018b525cb68972f579aebfbfec70d0b94afc4b55
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87679129"
---
# <a name="sharepoint-list-query-designer"></a><span data-ttu-id="2fda4-102">Designer de Consulta de Lista do SharePoint</span><span class="sxs-lookup"><span data-stu-id="2fda4-102">SharePoint List Query Designer</span></span>
  <span data-ttu-id="2fda4-103">O Designer de Relatórios fornece um designer de consultas gráficas e um designer de consulta baseado em texto para ajudá-lo a criar uma consulta que especifica os dados a serem recuperados do site do SharePoint para um conjunto de dados de relatório.</span><span class="sxs-lookup"><span data-stu-id="2fda4-103">Report Designer provides both a graphical query designer and a text-based query designer to help you create a query that specifies the data to retrieve from a SharePoint site for a report dataset.</span></span> <span data-ttu-id="2fda4-104">Use o designer de consultas gráficas para explorar os metadados de lista do SharePoint, criar uma consulta interativamente e exibir os resultados da consulta.</span><span class="sxs-lookup"><span data-stu-id="2fda4-104">Use the graphical query designer to explore the SharePoint list metadata, interactively build a query, and view the results of your query.</span></span> <span data-ttu-id="2fda4-105">Use o designer de consulta baseado em texto para exibir a consulta que foi criada pelo designer de consultas gráficas, modificar uma consulta ou digitar os comandos da consulta.</span><span class="sxs-lookup"><span data-stu-id="2fda4-105">Use the text-based query designer to view the query that was built by the graphical query designer, modify a query, or type the query commands.</span></span> <span data-ttu-id="2fda4-106">Também é possível importar uma consulta existente de um arquivo ou relatório.</span><span class="sxs-lookup"><span data-stu-id="2fda4-106">You can also import an existing query from a file or report.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="2fda4-107">Os usuários acessam fontes de dados quando criam e executam consultas.</span><span class="sxs-lookup"><span data-stu-id="2fda4-107">Users access data sources when they create and run queries.</span></span> <span data-ttu-id="2fda4-108">Você deve conceder permissões mínimas nas fontes de dados, como permissões somente leitura.</span><span class="sxs-lookup"><span data-stu-id="2fda4-108">You should grant minimal permissions on the data sources, such as read-only permissions.</span></span>  
  
## <a name="graphical-query-designer"></a><span data-ttu-id="2fda4-109">Designer de Consultas Gráficas</span><span class="sxs-lookup"><span data-stu-id="2fda4-109">Graphical Query Designer</span></span>  
 <span data-ttu-id="2fda4-110">No designer de consultas gráficas, você pode explorar o site do SharePoint, crie interativamente o comando que recupera dados da lista do SharePoint para um conjunto de dados.</span><span class="sxs-lookup"><span data-stu-id="2fda4-110">In the graphical query designer you can explorer the SharePoint site, interactively build the command that retrieve SharePoint list data for a dataset.</span></span> <span data-ttu-id="2fda4-111">Você escolhe os campos a serem incluídos no conjunto de dados e, opcionalmente, especifica os filtros que limitam os dados desse conjunto.</span><span class="sxs-lookup"><span data-stu-id="2fda4-111">You choose the fields to include in the dataset and optionally, specify filters that limit the data in the dataset.</span></span> <span data-ttu-id="2fda4-112">Você pode especificar que os filtros sejam usados como parâmetros e fornecer o valor do filtro em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="2fda4-112">You can specify that filters are used as parameters and provide the value of the filter at run-time.</span></span>  
  
 <span data-ttu-id="2fda4-113">As listas do SharePoint incluem um número grande de campos específicos do SharePoint que poderiam não ser úteis para serem incluídos em relatórios.</span><span class="sxs-lookup"><span data-stu-id="2fda4-113">SharePoint lists include a large number of SharePoint specific fields that might not be useful to include in reports.</span></span> <span data-ttu-id="2fda4-114">O designer de consultas fornece uma opção para ocultar esses campos para tornar mais fácil e rápido determinar os campos para uso.</span><span class="sxs-lookup"><span data-stu-id="2fda4-114">The query designer provides an option to hide these fields to make it easier and quicker to determine the fields to use.</span></span>  
  
 <span data-ttu-id="2fda4-115">O designer de consultas gráficas é dividido em três áreas</span><span class="sxs-lookup"><span data-stu-id="2fda4-115">The graphical query designer is divided into three areas</span></span>  
  
-   <span data-ttu-id="2fda4-116">Explore o painel no qual você seleciona os itens de lista e seus campos a serem usados.</span><span class="sxs-lookup"><span data-stu-id="2fda4-116">Explore pane in which you select the list items and their fields to use.</span></span>  
  
-   <span data-ttu-id="2fda4-117">Área de design na qual você compila a consulta.</span><span class="sxs-lookup"><span data-stu-id="2fda4-117">Design area in which you build the query.</span></span>  
  
-   <span data-ttu-id="2fda4-118">Painéis de resultados nos quais você exibe os resultados da consulta.</span><span class="sxs-lookup"><span data-stu-id="2fda4-118">Results pane in which you view the query results.</span></span>  
  
 <span data-ttu-id="2fda4-119">A figura a seguir mostra o designer de consultas gráficas quando ele é usado com as listas do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="2fda4-119">The following figure shows the graphical query designer when it is used with SharePoint lists.</span></span>  
  
 <span data-ttu-id="2fda4-120">![rsQD_Relational_Graphical_SharePoint](media/rsqd-relational-graphical-sharepoint.gif "rsQD_Relational_Graphical_SharePoint")</span><span class="sxs-lookup"><span data-stu-id="2fda4-120">![rsQD_Relational_Graphical_SharePoint](media/rsqd-relational-graphical-sharepoint.gif "rsQD_Relational_Graphical_SharePoint")</span></span>  
  
 <span data-ttu-id="2fda4-121">A tabela a seguir descreve a função de cada painel.</span><span class="sxs-lookup"><span data-stu-id="2fda4-121">The following table describes the function of each pane.</span></span>  
  
 [<span data-ttu-id="2fda4-122">Listas do SharePoint</span><span class="sxs-lookup"><span data-stu-id="2fda4-122">SharePoint Lists</span></span>](#DatabaseView)  
 <span data-ttu-id="2fda4-123">Exibe listas do SharePoint e os campos em cada item na lista.</span><span class="sxs-lookup"><span data-stu-id="2fda4-123">Displays SharePoint lists and the fields within each item in the list.</span></span>  
  
 [<span data-ttu-id="2fda4-124">Campos selecionados</span><span class="sxs-lookup"><span data-stu-id="2fda4-124">Selected fields</span></span>](#SelectedFields)  
 <span data-ttu-id="2fda4-125">Exibe a lista de nomes de campos da lista do SharePoint dos itens selecionados no painel Listas do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="2fda4-125">Displays the list of SharePoint list field names from the selected items in the SharePoint Lists pane.</span></span> <span data-ttu-id="2fda4-126">Esses campos se tornam a coleção de campos do conjunto de dados de relatório.</span><span class="sxs-lookup"><span data-stu-id="2fda4-126">These fields become the field collection for the report dataset.</span></span>  
  
 [<span data-ttu-id="2fda4-127">Filtros aplicados</span><span class="sxs-lookup"><span data-stu-id="2fda4-127">Applied filters</span></span>](#AppliedFilters)  
 <span data-ttu-id="2fda4-128">Exibe uma lista de campos e critérios de filtragem para tabelas ou exibições na exibição Banco de Dados.</span><span class="sxs-lookup"><span data-stu-id="2fda4-128">Displays a list of fields and filter criteria for tables or views in the Database view.</span></span>  
  
 [<span data-ttu-id="2fda4-129">Resultados da consulta</span><span class="sxs-lookup"><span data-stu-id="2fda4-129">Query results</span></span>](#QueryResults)  
 <span data-ttu-id="2fda4-130">Exibe dados de exemplo do conjunto de resultados da consulta gerada automaticamente.</span><span class="sxs-lookup"><span data-stu-id="2fda4-130">Displays sample data for the result set for the automatically generated query.</span></span>  
  
###  <a name="sharepoint-lists-pane"></a><a name="DatabaseView"></a> <span data-ttu-id="2fda4-131">Painel de Listas do SharePoint</span><span class="sxs-lookup"><span data-stu-id="2fda4-131">SharePoint Lists Pane</span></span>  
 <span data-ttu-id="2fda4-132">O painel Listas do SharePoint exibe os metadados para objetos de banco de dados que você tem as permissões para exibir, o que é determinado pela conexão da fonte de dados e credenciais.</span><span class="sxs-lookup"><span data-stu-id="2fda4-132">The SharePoint Lists pane displays the metadata for database objects that you have the permissions to view, which is determined by the data source connection and credentials.</span></span> <span data-ttu-id="2fda4-133">A exibição hierárquica exibe objetos de banco de dados organizados por esquema de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="2fda4-133">The hierarchical view displays database objects organized by database schema.</span></span> <span data-ttu-id="2fda4-134">Expanda o nó de cada esquema para exibir tabelas, exibições, procedimentos armazenados e funções com valor de tabela.</span><span class="sxs-lookup"><span data-stu-id="2fda4-134">Expand the node for each schema to view tables, views, stored procedures, and table-valued functions.</span></span> <span data-ttu-id="2fda4-135">Expanda uma tabela ou exibição para exibir as colunas.</span><span class="sxs-lookup"><span data-stu-id="2fda4-135">Expand a table or view to display the columns.</span></span>  
  
###  <a name="selected-fields-pane"></a><a name="SelectedFields"></a><span data-ttu-id="2fda4-136">Painel campos selecionados</span><span class="sxs-lookup"><span data-stu-id="2fda4-136">Selected Fields Pane</span></span>  
 <span data-ttu-id="2fda4-137">O painel Campos Selecionados exibe os campos de item de lista que você seleciona para itens de lista do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="2fda4-137">The Selected Fields pane displays the list item fields that you select for SharePoint list items.</span></span> <span data-ttu-id="2fda4-138">Os campos mostrados neste painel se tornam a coleção de campos do conjunto de dados de relatório.</span><span class="sxs-lookup"><span data-stu-id="2fda4-138">The fields that are displayed in this pane become the field collection for the report dataset.</span></span> <span data-ttu-id="2fda4-139">Depois de criar um conjunto de dados e uma consulta, expanda o painel de dados do relatório para exibir a coleção de campos de um conjunto de dados de relatório.</span><span class="sxs-lookup"><span data-stu-id="2fda4-139">After you create a dataset and a query, use the Report Data pane to view the field collection for a report dataset.</span></span> <span data-ttu-id="2fda4-140">Esses campos representam os dados que você pode exibir em tabelas, gráficos e outros itens de relatório ao exibir um relatório.</span><span class="sxs-lookup"><span data-stu-id="2fda4-140">These fields represent the data you can display in tables, charts, and other report items when you view a report.</span></span>  
  
 <span data-ttu-id="2fda4-141">Para adicionar ou remover campos deste painel, marque ou desmarque as caixas de seleção para os campos de tabela ou exibição no painel Listas do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="2fda4-141">To add or remove fields to this pane, select or clear check boxes for the table or view fields in the SharePoint Lists pane.</span></span>  
  
###  <a name="applied-filters-pane"></a><a name="AppliedFilters"></a> <span data-ttu-id="2fda4-142">Painel Filtros Aplicados</span><span class="sxs-lookup"><span data-stu-id="2fda4-142">Applied Filters Pane</span></span>  
 <span data-ttu-id="2fda4-143">O painel Filtros Aplicados exibe os critérios usados para limitar o número de linhas de dados recuperadas no tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="2fda4-143">The Applied Filters pane displays the criteria that are used to limit the number of rows of data that are retrieved at run-time.</span></span> <span data-ttu-id="2fda4-144">Os critérios especificados nesse painel são usados para gerar uma cláusula [!INCLUDE[tsql](../includes/tsql-md.md)] WHERE.</span><span class="sxs-lookup"><span data-stu-id="2fda4-144">Criteria specified in this pane are used to generate a [!INCLUDE[tsql](../includes/tsql-md.md)] WHERE clause.</span></span> <span data-ttu-id="2fda4-145">Quando você seleciona a opção de parâmetro, um parâmetro de relatório é criado automaticamente.</span><span class="sxs-lookup"><span data-stu-id="2fda4-145">When you select the parameter option, a report parameter is automatically created.</span></span> <span data-ttu-id="2fda4-146">Os parâmetros de relatório se baseiam em parâmetros de consulta que permitem a um usuário especificar valores para a consulta, para controlar os dados no relatório.</span><span class="sxs-lookup"><span data-stu-id="2fda4-146">Report parameters that are based on query parameters enable a user to specify values for the query to control the data in the report.</span></span>  
  
 <span data-ttu-id="2fda4-147">As seguintes colunas são exibidas:</span><span class="sxs-lookup"><span data-stu-id="2fda4-147">The following columns are displayed:</span></span>  
  
-   <span data-ttu-id="2fda4-148">**Nome do Campo** Exibe o nome do campo ao qual aplicar os critérios.</span><span class="sxs-lookup"><span data-stu-id="2fda4-148">**Field Name** Displays the name of the field to apply the criteria to.</span></span>  
  
-   <span data-ttu-id="2fda4-149">**Operador** Exibe a operação a ser usada na expressão de filtro.</span><span class="sxs-lookup"><span data-stu-id="2fda4-149">**Operator** Displays the operation to use in the filter expression.</span></span>  
  
-   <span data-ttu-id="2fda4-150">**Valor** Exibe o valor a ser usado na expressão de filtro.</span><span class="sxs-lookup"><span data-stu-id="2fda4-150">**Value** Displays the value to use in the filter expression.</span></span>  
  
-   <span data-ttu-id="2fda4-151">**Parâmetro** Exibe a opção para adicionar um parâmetro à consulta.</span><span class="sxs-lookup"><span data-stu-id="2fda4-151">**Parameter** Displays the option to add a query parameter to the query.</span></span> <span data-ttu-id="2fda4-152">Use as propriedades do conjunto de dados para exibir as relações entre o parâmetro de consulta e o parâmetro do relatório.</span><span class="sxs-lookup"><span data-stu-id="2fda4-152">Use the Dataset properties to view the relationship between query parameter and report parameter.</span></span>  
  
###  <a name="query-results-pane"></a><a name="QueryResults"></a> <span data-ttu-id="2fda4-153">Painel Resultados da Consulta</span><span class="sxs-lookup"><span data-stu-id="2fda4-153">Query Results Pane</span></span>  
 <span data-ttu-id="2fda4-154">O painel Resultados da Consulta exibe os resultados para a consulta automaticamente gerada que é especificada por seleções nos outros painéis.</span><span class="sxs-lookup"><span data-stu-id="2fda4-154">The Query results pane displays the results for the automatically generated query that is specified by selections in the other panes.</span></span> <span data-ttu-id="2fda4-155">As colunas do conjunto de resultados são os campos que você especifica no painel Campos Selecionados e os dados de linha são limitados pelos filtros que você especifica no painel Filtros Aplicados.</span><span class="sxs-lookup"><span data-stu-id="2fda4-155">The columns in the result set are the fields that you specify in the Selected Fields pane and the row data is limited by the filters that you specify in the Applied Filters pane.</span></span>  
  
 <span data-ttu-id="2fda4-156">Esses dados representam valores da fonte de dados no momento em que você executa a consulta.</span><span class="sxs-lookup"><span data-stu-id="2fda4-156">This data represents values from the data source at the time that you run the query.</span></span> <span data-ttu-id="2fda4-157">Os dados não são salvos na definição de relatório. Os dados reais do relatório são recuperados quando o relatório é processado.</span><span class="sxs-lookup"><span data-stu-id="2fda4-157">The data is not saved in the report definition .The actual data in the report is retrieved when the report is processed.</span></span>  
  
 <span data-ttu-id="2fda4-158">A ordem de classificação do conjunto de resultados é determinada pela ordem em que os dados são recuperados da fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="2fda4-158">Sort order in the result set is determined by the order the data is retrieved from the data source.</span></span> <span data-ttu-id="2fda4-159">A ordem de classificação pode ser alterada modificando-se a consulta ou após a recuperação dos dados para o relatório.</span><span class="sxs-lookup"><span data-stu-id="2fda4-159">Sort order can be changed by modifying the query or after the data is retrieved for the report.</span></span>  
  
### <a name="graphical-query-designer-toolbar"></a><span data-ttu-id="2fda4-160">Barra de ferramentas do designer de consultas gráficas</span><span class="sxs-lookup"><span data-stu-id="2fda4-160">Graphical Query Designer Toolbar</span></span>  
 <span data-ttu-id="2fda4-161">A barra de ferramentas do designer de consulta relacional fornece os seguintes botões para ajudá-lo a especificar ou exibir os resultados de uma consulta.</span><span class="sxs-lookup"><span data-stu-id="2fda4-161">The relational query designer toolbar provides the following buttons to help you specify or view the results of a query.</span></span>  
  
|<span data-ttu-id="2fda4-162">Botão</span><span class="sxs-lookup"><span data-stu-id="2fda4-162">Button</span></span>|<span data-ttu-id="2fda4-163">Descrição</span><span class="sxs-lookup"><span data-stu-id="2fda4-163">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="2fda4-164">**Editar como Texto**</span><span class="sxs-lookup"><span data-stu-id="2fda4-164">**Edit As Text**</span></span>|<span data-ttu-id="2fda4-165">Alterna para o designer de consulta baseado em texto para exibir a consulta gerada automaticamente ou para modificar a consulta.</span><span class="sxs-lookup"><span data-stu-id="2fda4-165">Toggle to the text-based query designer to view the automatically generated query or to modify the query.</span></span>|  
|<span data-ttu-id="2fda4-166">**Importaçãoação**</span><span class="sxs-lookup"><span data-stu-id="2fda4-166">**Import**</span></span>|<span data-ttu-id="2fda4-167">Importa uma consulta existente de um arquivo ou relatório.</span><span class="sxs-lookup"><span data-stu-id="2fda4-167">Import an existing query from a file or report.</span></span> <span data-ttu-id="2fda4-168">Há suporte para os tipos de arquivo .sql e .rdl.</span><span class="sxs-lookup"><span data-stu-id="2fda4-168">File types .sql and .rdl are supported.</span></span>|  
|<span data-ttu-id="2fda4-169">**Executar consulta**</span><span class="sxs-lookup"><span data-stu-id="2fda4-169">**Run Query**</span></span>|<span data-ttu-id="2fda4-170">Executa a consulta.</span><span class="sxs-lookup"><span data-stu-id="2fda4-170">Run the query.</span></span> <span data-ttu-id="2fda4-171">O painel Resultados da consulta exibe o conjunto de resultados.</span><span class="sxs-lookup"><span data-stu-id="2fda4-171">The Query results pane displays the result set.</span></span>|  
|<span data-ttu-id="2fda4-172">**Mostrar Campos Ocultos**</span><span class="sxs-lookup"><span data-stu-id="2fda4-172">**Show Hidden Fields**</span></span>|<span data-ttu-id="2fda4-173">Alterne para mostrar ou ocultar os campos que foram gerados automaticamente pelo SharePoint como o ProgId e Nível para itens de link do SharePoint, mas que normalmente não são usados em relatórios.</span><span class="sxs-lookup"><span data-stu-id="2fda4-173">Toggle to show or hide the fields that were automatically generated by SharePoint such as the ProgId and Level for SharePoint link items, but are typically not used in reports..</span></span> <span data-ttu-id="2fda4-174">Ocultar esses campos torna a lista de campos mais curta e mais fácil de usar.</span><span class="sxs-lookup"><span data-stu-id="2fda4-174">Hiding these fields makes the field list shorter and easier to use.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="2fda4-175">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="2fda4-175">See Also</span></span>  
 [<span data-ttu-id="2fda4-176">Designers de Consulta do Reporting Services</span><span class="sxs-lookup"><span data-stu-id="2fda4-176">Reporting Services Query Designers</span></span>](../../2014/reporting-services/reporting-services-query-designers.md)  
  
  
