---
title: Fazer backup e restaurar as chaves de criptografia do Reporting Services | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: database-engine
ms.topic: conceptual
helpviewer_keywords:
- backing up encryption keys [Reporting Services]
- restoring encryption keys [Reporting Services]
- encryption keys [Reporting Services]
- symmetric keys [Reporting Services]
ms.assetid: 6773d5df-03ef-4781-beb7-9f6825bac979
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: c8e7e61f58632898fc6150210598a671157639a3
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87686117"
---
# <a name="back-up-and-restore-reporting-services-encryption-keys"></a><span data-ttu-id="583b2-102">Fazer backup e restaurar as chave de criptografia do Reporting Services</span><span class="sxs-lookup"><span data-stu-id="583b2-102">Back Up and Restore Reporting Services Encryption Keys</span></span>
  <span data-ttu-id="583b2-103">Um parte importante da configuração do servidor de relatório é a criação de uma cópia de backup da chave simétrica usada para criptografar informações confidenciais.</span><span class="sxs-lookup"><span data-stu-id="583b2-103">An important part of report server configuration is creating a backup copy of the symmetric key used for encrypting sensitive information.</span></span> <span data-ttu-id="583b2-104">Uma cópia de backup da chave é necessária para várias operações rotineiras, possibilitando que você reutilize um banco de dados de servidor de relatório existente em uma nova instalação.</span><span class="sxs-lookup"><span data-stu-id="583b2-104">A backup copy of the key is required for many routine operations, and enables you to reuse an existing report server database in a new installation.</span></span>  
  
 <span data-ttu-id="583b2-105">**[!INCLUDE[applies](../../includes/applies-md.md)]** Modo nativo do [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] | Modo do SharePoint para [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)]</span><span class="sxs-lookup"><span data-stu-id="583b2-105">**[!INCLUDE[applies](../../includes/applies-md.md)]**  [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Native Mode | [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] SharePoint mode</span></span>  
  
 <span data-ttu-id="583b2-106">Será necessário restaurar a cópia de backup da chave de criptografia quando ocorrer quaisquer dos seguintes eventos:</span><span class="sxs-lookup"><span data-stu-id="583b2-106">It is necessary to restore the backup copy of the encryption key when any of the following events occur:</span></span>  
  
-   <span data-ttu-id="583b2-107">Alteração do nome da conta de serviço do Windows Servidor de Relatório ou redefinição da senha.</span><span class="sxs-lookup"><span data-stu-id="583b2-107">Changing the Report Server Windows service account name or resetting the password.</span></span> <span data-ttu-id="583b2-108">Quando você usa o Gerenciador de configurações do Reporting Services, o backup da chave faz parte de uma operação de alteração de nome da conta de serviço.</span><span class="sxs-lookup"><span data-stu-id="583b2-108">When you use the Reporting Services Configuration Manager, backing up the key is part of a service account name change operation.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="583b2-109">Redefinir a senha não é o mesmo que alterar a senha.</span><span class="sxs-lookup"><span data-stu-id="583b2-109">Resetting the password is not the same as changing the password.</span></span> <span data-ttu-id="583b2-110">Uma redefinição de senha requer permissão para substituir informações de conta no controlador de domínio.</span><span class="sxs-lookup"><span data-stu-id="583b2-110">A password reset requires permission to overwrite account information on the domain controller.</span></span> <span data-ttu-id="583b2-111">As redefinições de senha são executadas por um administrador de sistema quando você esquecer ou não souber uma senha específica.</span><span class="sxs-lookup"><span data-stu-id="583b2-111">Password resets are performed by a system administrator when you forget or do not know a particular password.</span></span> <span data-ttu-id="583b2-112">Somente redefinições de senha requerem a restauração da chave simétrica.</span><span class="sxs-lookup"><span data-stu-id="583b2-112">Only password resets require symmetric key restoration.</span></span> <span data-ttu-id="583b2-113">A alteração periódica da senha de uma conta não requer a redefinição da chave simétrica.</span><span class="sxs-lookup"><span data-stu-id="583b2-113">Periodically changing an account password does not require you to reset the symmetric key.</span></span>  
  
-   <span data-ttu-id="583b2-114">Renomeação do computador ou da instância que hospeda o servidor de relatório (uma instância de servidor de relatório tem como base um nome de instância do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ).</span><span class="sxs-lookup"><span data-stu-id="583b2-114">Renaming the computer or instance that hosts the report server (a report server instance is based on a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance name).</span></span>  
  
-   <span data-ttu-id="583b2-115">Migração de uma instalação do servidor de relatório ou configuração de um servidor de relatório para usar um banco de dados de servidor de relatório diferente.</span><span class="sxs-lookup"><span data-stu-id="583b2-115">Migrating a report server installation or configuring a report server to use a different report server database.</span></span>  
  
-   <span data-ttu-id="583b2-116">Recuperação de uma instalação do servidor de relatório devido a uma falha de hardware.</span><span class="sxs-lookup"><span data-stu-id="583b2-116">Recovering a report server installation due to hardware failure.</span></span>  
  
 <span data-ttu-id="583b2-117">Você precisa fazer o backup somente de uma cópia da chave simétrica.</span><span class="sxs-lookup"><span data-stu-id="583b2-117">You only need to back up one copy of the symmetric key.</span></span> <span data-ttu-id="583b2-118">Há uma correspondência um para um entre um banco de dados do servidor de relatório e uma chave simétrica.</span><span class="sxs-lookup"><span data-stu-id="583b2-118">There is a one-to-one correspondence between a report server database and a symmetric key.</span></span> <span data-ttu-id="583b2-119">Embora você precise fazer o backup de uma cópia apenas, poderá ser necessário restaurar a chave várias vezes se você estiver executando vários servidores de relatório em um modelo de implantação de expansão.</span><span class="sxs-lookup"><span data-stu-id="583b2-119">Although you only need to back up one copy, you might need to restore the key multiple times if you are running multiple report servers in a scale-out deployment model.</span></span> <span data-ttu-id="583b2-120">Cada instância do servidor de relatório precisa de sua cópia da chave simétrica a fim de bloquear e desbloquear dados no banco de dados do servidor de relatório.</span><span class="sxs-lookup"><span data-stu-id="583b2-120">Each report server instance will need its copy of the symmetric key to lock and unlock data in the report server database.</span></span>  
  
  
## <a name="backing-up-the-encryption-keys"></a><span data-ttu-id="583b2-121">Fazendo backup das chaves de criptografia</span><span class="sxs-lookup"><span data-stu-id="583b2-121">Backing Up the Encryption Keys</span></span>  
 <span data-ttu-id="583b2-122">O backup da chave simétrica é um processo que grava a chave em um arquivo especificado e codifica a chave usando uma senha que você fornecer.</span><span class="sxs-lookup"><span data-stu-id="583b2-122">Backing up the symmetric key is a process that writes the key to a file that you specify, and then scrambles the key using a password that you provide.</span></span> <span data-ttu-id="583b2-123">A chave simétrica nunca pode ser armazenada em um estado não criptografado, portanto você deve fornecer uma senha para codificar a chave ao salvá-la em disco.</span><span class="sxs-lookup"><span data-stu-id="583b2-123">The symmetric key can never be stored in an unencrypted state so you must provide a password to encrypt the key when you save it to disk.</span></span> <span data-ttu-id="583b2-124">Depois que o arquivo for criado, você deverá armazená-lo em um local seguro **e lembrar-se da senha** usada para desbloquear o arquivo.</span><span class="sxs-lookup"><span data-stu-id="583b2-124">After the file is created, you must store it in a secure location **and remember the password** that is used to unlock the file.</span></span> <span data-ttu-id="583b2-125">Para fazer backup da chave simétrica, você pode usar as seguintes ferramentas:</span><span class="sxs-lookup"><span data-stu-id="583b2-125">To backup the symmetric key, you can use the following tools:</span></span>  
  
 <span data-ttu-id="583b2-126">**Modo nativo:** Gerenciador de configurações do Reporting Services ou o utilitário **rskeymgmt** .</span><span class="sxs-lookup"><span data-stu-id="583b2-126">**Native mode:** Either the Reporting Services Configuration Manager or the **rskeymgmt** utility.</span></span>  
  
 <span data-ttu-id="583b2-127">**O modo do SharePoint:** Páginas do PowerShell ou Administração Central do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="583b2-127">**SharePoint mode:** SharePoint Central Administration pages or PowerShell.</span></span>  
  
####  <a name="backup-sharepoint-mode-report-servers"></a><a name="bkmk_backup_sharepoint"></a> <span data-ttu-id="583b2-128">Fazer backup dos servidores de relatório do modo SharePoint</span><span class="sxs-lookup"><span data-stu-id="583b2-128">Backup SharePoint Mode Report Servers</span></span>  
 <span data-ttu-id="583b2-129">Para servidores de relatório do modo do SharePoint, você pode usar os comandos do PowerShell ou as páginas de gerenciamento para o aplicativo de serviço do [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="583b2-129">For SharePoint mode report servers you can either use PowerShell commands or use the management pages for the [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] service application.</span></span> <span data-ttu-id="583b2-130">Para obter mais informações, confira a seção “Gerenciamento de chaves” de [Gerenciar um aplicativo de serviço SharePoint do Reporting Services](../manage-a-reporting-services-sharepoint-service-application.md)</span><span class="sxs-lookup"><span data-stu-id="583b2-130">For more information, see the "Key Management" section of [Manage a Reporting Services SharePoint Service Application](../manage-a-reporting-services-sharepoint-service-application.md)</span></span>  
  
####  <a name="back-up-encryption-keys--reporting-services-configuration-manager-native-mode"></a><a name="bkmk_backup_configuration_manager"></a> <span data-ttu-id="583b2-131">Fazer backup das chaves de criptografia - Gerenciador de configurações do Reporting Services (Modo Nativo)</span><span class="sxs-lookup"><span data-stu-id="583b2-131">Back up encryption keys -Reporting Services Configuration Manager (Native Mode)</span></span>  
  
1.  <span data-ttu-id="583b2-132">Inicie o Gerenciador de configurações do Reporting Services e conecte-se à instância do servidor de relatório que deseja configurar.</span><span class="sxs-lookup"><span data-stu-id="583b2-132">Start the Reporting Services Configuration Manager, and then connect to the report server instance you want to configure.</span></span>  
  
2.  <span data-ttu-id="583b2-133">Clique em **Chaves de Criptografia**e clique em **Fazer Backup**.</span><span class="sxs-lookup"><span data-stu-id="583b2-133">Click **Encryption Keys**, and then click **Back Up**.</span></span>  
  
3.  <span data-ttu-id="583b2-134">Digite uma senha forte.</span><span class="sxs-lookup"><span data-stu-id="583b2-134">Type a strong password.</span></span>  
  
4.  <span data-ttu-id="583b2-135">Especifique um arquivo para conter a chave armazenada.</span><span class="sxs-lookup"><span data-stu-id="583b2-135">Specify a file to contain the stored key.</span></span> [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] <span data-ttu-id="583b2-136">acrescenta uma extensão .snk ao arquivo.</span><span class="sxs-lookup"><span data-stu-id="583b2-136">appends a .snk file extension to the file.</span></span> <span data-ttu-id="583b2-137">Considere o armazenamento do arquivo em um disco separado do servidor de relatório.</span><span class="sxs-lookup"><span data-stu-id="583b2-137">Consider storing the file on a disk separate from the report server.</span></span>  
  
5.  [!INCLUDE[clickOK](../../includes/clickok-md.md)]  
  
####  <a name="back-up-encryption-keys--rskeymgmt-native-mode"></a><a name="bkmk_backup_rskeymgmt"></a><span data-ttu-id="583b2-138">Fazer backup das chaves de criptografia-rskeymgmt (modo nativo)</span><span class="sxs-lookup"><span data-stu-id="583b2-138">Back up encryption keys -rskeymgmt (Native Mode)</span></span>  
  
1.  <span data-ttu-id="583b2-139">Execute **rskeymgmt.exe** localmente no computador que hospeda o servidor de relatório.</span><span class="sxs-lookup"><span data-stu-id="583b2-139">Run **rskeymgmt.exe** locally on the computer that hosts the report server.</span></span> <span data-ttu-id="583b2-140">Você deve usar o argumento de extração `-e` para copiar a chave, fornecer um nome de arquivo e especificar uma senha.</span><span class="sxs-lookup"><span data-stu-id="583b2-140">You must use the `-e` extract argument to copy the key, provide a file name, and specify a password.</span></span> <span data-ttu-id="583b2-141">O exemplo a seguir ilustra os argumentos que você deve especificar:</span><span class="sxs-lookup"><span data-stu-id="583b2-141">The following example illustrates the arguments you must specify:</span></span>  
  
    ```cmd
    rskeymgmt -e -f d:\rsdbkey.snk -p<password>  
    ```  
  
## <a name="restore-encryption-keys"></a><span data-ttu-id="583b2-142">Restaurar as chaves de criptografia</span><span class="sxs-lookup"><span data-stu-id="583b2-142">Restore Encryption Keys</span></span>  
 <span data-ttu-id="583b2-143">A restauração da chave simétrica substitui a chave simétrica existente que está armazenada no banco de dados do servidor de relatório.</span><span class="sxs-lookup"><span data-stu-id="583b2-143">Restoring the symmetric key overwrites the existing symmetric key that is stored in the report server database.</span></span> <span data-ttu-id="583b2-144">A restauração de uma chave de criptografia substitui uma chave inutilizável por uma cópia que você salvou em disco anteriormente.</span><span class="sxs-lookup"><span data-stu-id="583b2-144">Restoring an encryption key replaces an unusable key with a copy that you previously saved to disk.</span></span> <span data-ttu-id="583b2-145">A restauração de chaves de criptografia resulta nas seguintes ações:</span><span class="sxs-lookup"><span data-stu-id="583b2-145">Restoring encryption keys results in the following actions:</span></span>  
  
-   <span data-ttu-id="583b2-146">A chave simétrica é aberta a partir do arquivo de backup protegido por senha.</span><span class="sxs-lookup"><span data-stu-id="583b2-146">The symmetric key is opened from the password protected backup file.</span></span>  
  
-   <span data-ttu-id="583b2-147">A chave simétrica é criptografada usando-se a chave pública do serviço do Windows Servidor de Relatório.</span><span class="sxs-lookup"><span data-stu-id="583b2-147">The symmetric key is encrypted using the public key of the Report Server Windows service.</span></span>  
  
-   <span data-ttu-id="583b2-148">A chave simétrica criptografada é armazenada no banco de dados do servidor de relatório.</span><span class="sxs-lookup"><span data-stu-id="583b2-148">The encrypted symmetric key is stored in the report server database.</span></span>  
  
-   <span data-ttu-id="583b2-149">Os dados da chave simétrica armazenada anteriormente (por exemplo, informações de chave que já estavam no banco de dados do servidor de relatório de uma implantação anterior) serão excluídos.</span><span class="sxs-lookup"><span data-stu-id="583b2-149">The previously stored symmetric key data (for example, key information that was already in the report server database from a previous deployment) is deleted.</span></span>  
  
 <span data-ttu-id="583b2-150">Para restaurar a chave de criptografia, você deve ter uma cópia da chave de criptografia em arquivo.</span><span class="sxs-lookup"><span data-stu-id="583b2-150">To restore the encryption key, you must have a copy of the encryption key on file.</span></span> <span data-ttu-id="583b2-151">Você também deve saber a senha que desbloqueia a cópia armazenada.</span><span class="sxs-lookup"><span data-stu-id="583b2-151">You must also know the password that unlocks the stored copy.</span></span> <span data-ttu-id="583b2-152">Se você tiver a chave e a senha, poderá executar a ferramenta Configuração do Reporting Services ou o utilitário **rskeymgmt** para restaurar a chave.</span><span class="sxs-lookup"><span data-stu-id="583b2-152">If you have the key and the password, you can run the Reporting Services Configuration tool or **rskeymgmt** utility to restore the key.</span></span> <span data-ttu-id="583b2-153">A chave simétrica deve ser a mesma que bloqueia e desbloqueia os dados criptografados atualmente armazenados no banco de dados do servidor de relatório.</span><span class="sxs-lookup"><span data-stu-id="583b2-153">The symmetric key must be the same one that locks and unlocks encrypted data currently stored in the report server database.</span></span> <span data-ttu-id="583b2-154">Se você restaurar uma cópia que não seja válida, o servidor de relatório não poderá acessar os dados criptografados atualmente armazenados no banco de dados do servidor de relatório.</span><span class="sxs-lookup"><span data-stu-id="583b2-154">If you restore a copy that is not valid, the report server cannot access the encrypted data currently stored in the report server database.</span></span> <span data-ttu-id="583b2-155">Se isso ocorrer, poderá ser necessário excluir todos os valores criptografados se você não puder restaurar uma chave válida.</span><span class="sxs-lookup"><span data-stu-id="583b2-155">If this occurs, you might need to delete all encrypted values if you cannot restore a valid key.</span></span> <span data-ttu-id="583b2-156">Se por alguma razão você não puder restaurar a chave de criptografia (por exemplo, se você não tiver uma cópia de backup), você deverá excluir a chave existente e o conteúdo criptografado.</span><span class="sxs-lookup"><span data-stu-id="583b2-156">If for some reason you cannot restore the encryption key (for example, if you do not have a backup copy), you must delete the existing key and encrypted content.</span></span> <span data-ttu-id="583b2-157">Para obter mais informações, consulte [Excluir e recriar chaves de criptografia &#40; 	Gerenciador de Configurações do SSRS&#41;](ssrs-encryption-keys-delete-and-re-create-encryption-keys.md).</span><span class="sxs-lookup"><span data-stu-id="583b2-157">For more information, see [Delete and Re-create Encryption Keys  &#40;SSRS Configuration Manager&#41;](ssrs-encryption-keys-delete-and-re-create-encryption-keys.md).</span></span> <span data-ttu-id="583b2-158">Para obter mais informações sobre como criar chaves simétricas, veja [Inicializar um servidor de relatório &#40;SSRS Configuration Manager&#41;](ssrs-encryption-keys-initialize-a-report-server.md).</span><span class="sxs-lookup"><span data-stu-id="583b2-158">For more information about creating symmetric keys, see [Initialize a Report Server &#40;SSRS Configuration Manager&#41;](ssrs-encryption-keys-initialize-a-report-server.md).</span></span>  
  
####  <a name="restore-encryption-keys--reporting-services-configuration-manager-native-mode"></a><a name="bkmk_restore_configuration_manager"></a><span data-ttu-id="583b2-159">Restaurar chaves de criptografia-Gerenciador de Configurações do Reporting Services (modo nativo)</span><span class="sxs-lookup"><span data-stu-id="583b2-159">Restore encryption keys -Reporting Services Configuration Manager (Native Mode)</span></span>  
  
1.  <span data-ttu-id="583b2-160">Inicie o Gerenciador de configurações do Reporting Services e conecte-se à instância do servidor de relatório que deseja configurar.</span><span class="sxs-lookup"><span data-stu-id="583b2-160">Start the Reporting Services Configuration Manager, and then connect to the report server instance you want to configure.</span></span>  
  
2.  <span data-ttu-id="583b2-161">Na página chaves de criptografia, clique em **restaurar**.</span><span class="sxs-lookup"><span data-stu-id="583b2-161">On the Encryption Keys page, click **Restore**.</span></span>  
  
3.  <span data-ttu-id="583b2-162">Selecione o arquivo .snk que contém a cópia de backup.</span><span class="sxs-lookup"><span data-stu-id="583b2-162">Select the .snk file that contains the back up copy.</span></span>  
  
4.  <span data-ttu-id="583b2-163">Digite a senha que desbloqueia o arquivo.</span><span class="sxs-lookup"><span data-stu-id="583b2-163">Type the password that unlocks the file.</span></span>  
  
5.  [!INCLUDE[clickOK](../../includes/clickok-md.md)]  
  
####  <a name="restore-encryption-keys---rskeymgmt-native-mode"></a><a name="bkmk_restore_rskeymgmt"></a><span data-ttu-id="583b2-164">Restaurar chaves de criptografia-rskeymgmt (modo nativo)</span><span class="sxs-lookup"><span data-stu-id="583b2-164">Restore encryption keys - rskeymgmt (Native Mode)</span></span>  
  
1.  <span data-ttu-id="583b2-165">Execute **rskeymgmt.exe** localmente no computador que hospeda o servidor de relatório.</span><span class="sxs-lookup"><span data-stu-id="583b2-165">Run **rskeymgmt.exe** locally on the computer that hosts the report server.</span></span> <span data-ttu-id="583b2-166">Use o argumento `-a` para restaurar as chaves.</span><span class="sxs-lookup"><span data-stu-id="583b2-166">Use the `-a` argument to restore the keys.</span></span> <span data-ttu-id="583b2-167">Você deve fornecer um nome de arquivo totalmente qualificado e especificar uma senha.</span><span class="sxs-lookup"><span data-stu-id="583b2-167">You must provide a fully-qualified file name and specify a password.</span></span> <span data-ttu-id="583b2-168">O exemplo a seguir ilustra os argumentos que você deve especificar:</span><span class="sxs-lookup"><span data-stu-id="583b2-168">The following example illustrates the arguments you must specify:</span></span>  
  
    ```cmd
    rskeymgmt -a -f d:\rsdbkey.snk -p<password>  
    ```  
  
## <a name="see-also"></a><span data-ttu-id="583b2-169">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="583b2-169">See Also</span></span>  
 [<span data-ttu-id="583b2-170">Configurar e gerenciar chaves de criptografia &#40;SSRS Configuration Manager&#41;</span><span class="sxs-lookup"><span data-stu-id="583b2-170">Configure and Manage Encryption Keys &#40;SSRS Configuration Manager&#41;</span></span>](ssrs-encryption-keys-manage-encryption-keys.md)  
