---
title: Implementar a segurança dinâmica usando filtros de linha | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 8bf03c45-caf5-4eda-9314-e4f8f24a159f
author: minewiskan
ms.author: owend
manager: kfile
ms.openlocfilehash: 09a15f818f57d7a9d808c89ced41b285536a7883
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87569776"
---
# <a name="implement-dynamic-security-by-using-row-filters"></a><span data-ttu-id="fa1d6-102">Implementar a segurança dinâmica usando filtros de linha</span><span class="sxs-lookup"><span data-stu-id="fa1d6-102">Implement Dynamic Security by Using Row Filters</span></span>
  <span data-ttu-id="fa1d6-103">Nesta lição suplementar, você criará uma função adicional que implementa a segurança dinâmica.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-103">In this supplemental lesson, you will create an additional role that implements dynamic security.</span></span> <span data-ttu-id="fa1d6-104">A segurança dinâmica oferece segurança no nível de linha com base no nome de usuário ou na ID de logon do usuário conectado no momento.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-104">Dynamic security provides row-level security based on the user name or login id of the user currently logged on.</span></span> <span data-ttu-id="fa1d6-105">Para obter mais informações, consulte [Funções &#40;SSAS Tabular&#41;](https://docs.microsoft.com/analysis-services/tabular-models/roles-ssas-tabular).</span><span class="sxs-lookup"><span data-stu-id="fa1d6-105">To learn more, see [Roles &#40;SSAS Tabular&#41;](https://docs.microsoft.com/analysis-services/tabular-models/roles-ssas-tabular).</span></span>  
  
 <span data-ttu-id="fa1d6-106">Para implementar a segurança dinâmica, você deverá adicionar uma tabela a seu modelo contendo os nomes de usuários Windows desses usuários que podem criar uma conexão com o modelo como uma fonte de dados e procurar objetos e dados do modelo.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-106">To implement dynamic security, you must add a table to your model containing the Windows user names of those users that can create a connection to the model as a data source and browse model objects and data.</span></span> <span data-ttu-id="fa1d6-107">O modelo criado usando este tutorial está no contexto da Adventure Works Corp.; entretanto, para concluir esta lição, você deve adicionar uma tabela contendo os usuários de seu próprio domínio.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-107">The model you create using this tutorial is in the context of Adventure Works Corp.; however, in order to complete this lesson, you must add a table containing users from your own domain.</span></span> <span data-ttu-id="fa1d6-108">Você não precisará das senhas para os nomes de usuários que serão adicionados.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-108">You will not need the passwords for the user names that will be added.</span></span> <span data-ttu-id="fa1d6-109">Para criar uma tabela Employee Security, com um exemplo pequeno de usuários de seu próprio domínio, você usará o recurso Colar, colando dados de funcionário de uma planilha do Excel.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-109">To create an Employee Security table, with a small sample of users from your own domain, you will use the Paste feature, pasting employee data from an Excel spreadsheet.</span></span> <span data-ttu-id="fa1d6-110">Em um cenário do mundo real, a tabela que contém nomes de usuários adicionada a um modelo normalmente empregaria uma tabela de um banco de dados real como uma fonte de dados; por exemplo, uma tabela real dimEmployee.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-110">In a real-world scenario, the table containing user names you add to a model would typically use a table from an actual database as a data source; for example, a real dimEmployee table.</span></span>  
  
 <span data-ttu-id="fa1d6-111">Para implementar a segurança dinâmica, você usará duas novas funções DAX: [função de nome de usuário &#40;dax&#41;](/dax/username-function-dax) e [lookupvalue função &#40;Dax&#41;](/dax/lookupvalue-function-dax).</span><span class="sxs-lookup"><span data-stu-id="fa1d6-111">In order to implement dynamic security, you will use two new DAX functions: [USERNAME Function &#40;DAX&#41;](/dax/username-function-dax) and [LOOKUPVALUE Function &#40;DAX&#41;](/dax/lookupvalue-function-dax).</span></span> <span data-ttu-id="fa1d6-112">Essas funções, aplicadas em uma fórmula de filtro de linha, são definidas em uma nova função.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-112">These functions, applied in a row filter formula, are defined in a new role.</span></span> <span data-ttu-id="fa1d6-113">Usando a função LOOKUPVALUE, a fórmula especifica um valor da tabela Employee Security e passa esse valor para a função USERNAME, que especifica o nome de usuário do usuário registrado que pertence a esta função.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-113">Using the LOOKUPVALUE function, the formula specifies a value from the Employee Security table and then passes that value to the USERNAME function, which specifies the user name of the user logged on belongs to this role.</span></span> <span data-ttu-id="fa1d6-114">O usuário pode procurar somente os dados especificados pelos filtros de linha da função.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-114">The user can then browse only data specified by the role's row filters.</span></span> <span data-ttu-id="fa1d6-115">Neste cenário, você especificará que os funcionários de vendas só podem procurar dados de vendas pela internet para as regiões de vendas das quais eles são membro.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-115">In this scenario, you will specify that sales employees can only browse internet sales data for the sales territories in which they are a member.</span></span>  
  
 <span data-ttu-id="fa1d6-116">Para concluir esta lição suplementar, você executará uma série de tarefas.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-116">In order to complete this supplemental lesson, you will complete a series of tasks.</span></span> <span data-ttu-id="fa1d6-117">Aquelas tarefas que são exclusivas deste cenário de modelo tabular da Adventure Works, mas que não seriam aplicariam necessariamente a um cenário do mundo real, são identificadas como tal.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-117">Those tasks that are unique to this Adventure Works tabular model scenario, but would not necessarily apply to a real-world scenario are identified as such.</span></span> <span data-ttu-id="fa1d6-118">Cada tarefa inclui informações adicionais que descrevem o propósito da tarefa.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-118">Each task includes additional information describing the purpose of the task.</span></span>  
  
 <span data-ttu-id="fa1d6-119">Tempo estimado para conclusão desta lição: **30 minutos**</span><span class="sxs-lookup"><span data-stu-id="fa1d6-119">Estimated time to complete this lesson: **30 minutes**</span></span>  
  
## <a name="prerequisites"></a><span data-ttu-id="fa1d6-120">Pré-requisitos</span><span class="sxs-lookup"><span data-stu-id="fa1d6-120">Prerequisites</span></span>  
 <span data-ttu-id="fa1d6-121">Este tópico de lição suplementar faz parte de um tutorial de modelagem tabular, que deve ser concluído na devida ordem.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-121">This supplemental lesson topic is part of a tabular modeling tutorial, which should be completed in order.</span></span> <span data-ttu-id="fa1d6-122">Antes de executar as tarefas nesta lição suplementar, você deve ter concluído todas as lições anteriores.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-122">Before performing the tasks in this supplemental lesson, you should have completed all previous lessons.</span></span>  
  
## <a name="add-the-dimsalesterritory-table-to-the-aw-internet-sales-tabular-model-project"></a><span data-ttu-id="fa1d6-123">Adicione a tabela dimSalesTerritory ao Projeto de Modelo de Tabela de Vendas pela Internet da AW</span><span class="sxs-lookup"><span data-stu-id="fa1d6-123">Add the dimSalesTerritory table to the AW Internet Sales Tabular Model Project</span></span>  
 <span data-ttu-id="fa1d6-124">Para implementar a segurança dinâmica para este cenário do Adventure Works, inclua duas tabelas adicionais no seu modelo.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-124">In order to implement dynamic security for this Adventure Works scenario, you must add two additional tables to your model.</span></span> <span data-ttu-id="fa1d6-125">A primeira tabela que você adicionará é dimSalesTerritory (como Sales Territory) do mesmo banco de dados AdventureWorksDW.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-125">The first table you will add is dimSalesTerritory (as Sales Territory) from the same AdventureWorksDW database.</span></span> <span data-ttu-id="fa1d6-126">Você aplicará um filtro de linha posteriormente à tabela Sales Territory que define os dados específicos que o usuário registrado pode procurar.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-126">You will later apply a row filter to the Sales Territory table that defines the particular data the logged on user can browse.</span></span>  
  
#### <a name="to-add-the-dimsalesterritory-table"></a><span data-ttu-id="fa1d6-127">Para adicionar a tabela dimSalesTerritory</span><span class="sxs-lookup"><span data-stu-id="fa1d6-127">To add the dimSalesTerritory table</span></span>  
  
1.  <span data-ttu-id="fa1d6-128">No [!INCLUDE[ssBIDevStudio](../includes/ssbidevstudio-md.md)], clique no menu **Modelo** e em **Conexões Existentes**.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-128">In [!INCLUDE[ssBIDevStudio](../includes/ssbidevstudio-md.md)], click on the **Model** menu, and then click **Existing Connections**.</span></span>  
  
2.  <span data-ttu-id="fa1d6-129">Na caixa de diálogo **Conexões Existentes** , verifique se a conexão da fonte de dados **Adventure Works DB do SQL** está selecionada e clique em **Abrir**.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-129">In the **Existing Connections** dialog box, verify the **Adventure Works DB from SQL** data source connection is selected, and then click **Open**.</span></span>  
  
     <span data-ttu-id="fa1d6-130">Se a caixa de diálogo Credenciais de Representação aparecer, digite as credenciais de representação usadas na Lição 2: adicionar dados.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-130">If the Impersonation Credentials dialog box appears, type the impersonation credentials you used in Lesson 2: Add Data.</span></span>  
  
3.  <span data-ttu-id="fa1d6-131">Na página **Escolher Como Importar os Dados** , deixe marcada a opção **Selecionar itens em uma lista de tabelas e exibições para escolher os dados a serem importados** e clique em **Avançar**.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-131">On the **Choose How to Import the Data** page, leave **Select from a list of tables and views to choose the data to import** selected, and then click **Next**.</span></span>  
  
4.  <span data-ttu-id="fa1d6-132">Na página **Selecionar Tabelas e Exibições** , selecione a tabela **DimSalesTerritory** .</span><span class="sxs-lookup"><span data-stu-id="fa1d6-132">On the **Select Tables and Views** page, select the **DimSalesTerritory** table.</span></span>  
  
5.  <span data-ttu-id="fa1d6-133">Na coluna Nome Amigável, digite **Região de Vendas**.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-133">In the Friendly Name column, type **Sales Territory**.</span></span>  
  
6.  <span data-ttu-id="fa1d6-134">Clique em **Visualizar e Filtrar**.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-134">Click **Preview and Filter**.</span></span>  
  
7.  <span data-ttu-id="fa1d6-135">Desmarque a coluna **SalesTerritoryAlternateKey** e clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-135">Deselect the **SalesTerritoryAlternateKey** column, and then click **Ok**.</span></span>  
  
8.  <span data-ttu-id="fa1d6-136">Na página **Selecionar Tabelas e Exibições** , clique em **Concluir**.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-136">On the **Select Tables and Views** page, click **Finish**.</span></span>  
  
     <span data-ttu-id="fa1d6-137">A nova tabela será adicionada ao workspace do modelo.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-137">The new table will be added to the model workspace.</span></span> <span data-ttu-id="fa1d6-138">Objetos e dados da tabela de origem dimSalesTerritory são importados para a nova tabela Sales Territory em seu Modelo de Tabela de Vendas pela Internet AW.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-138">Objects and data from the source dimSalesTerritory table are then imported into the new Sales Territory table in your AW Internet Sales Tabular Model.</span></span>  
  
9. <span data-ttu-id="fa1d6-139">Depois que a tabela for importada, clique em **Fechar**.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-139">After the table has been imported, click **Close**.</span></span>  
  
## <a name="give-the-columns-friendly-names"></a><span data-ttu-id="fa1d6-140">Atribuir os nomes amigáveis de colunas</span><span class="sxs-lookup"><span data-stu-id="fa1d6-140">Give the Columns Friendly Names</span></span>  
 <span data-ttu-id="fa1d6-141">Nesta tarefa, você renomeará as colunas na tabela Sales Territory, atribuindo-lhes nomes amigáveis.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-141">In this task, you will rename the columns in the Sales Territory table, giving them friendly names.</span></span> <span data-ttu-id="fa1d6-142">Nem sempre é necessário atribuir nomes amigáveis a tabelas e/ou colunas; no entanto, isso facilita a navegação do seu projeto de modelo no designer de modelo, bem como a procura de objetos de modelo e os dados em uma lista de campos do aplicativo cliente.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-142">It is not always necessary to give tables and/or columns friendly names; however, it does make your model project easier to navigate in the model designer as well as for users browsing model objects and data in a client application field list.</span></span>  
  
#### <a name="to-rename-columns-in-the-sales-territory-table"></a><span data-ttu-id="fa1d6-143">Para renomear Colunas na Tabela Sales Territory</span><span class="sxs-lookup"><span data-stu-id="fa1d6-143">To rename Columns in the Sales Territory Table</span></span>  
  
-   <span data-ttu-id="fa1d6-144">No designer de modelos, renomeie as colunas da tabela **Região de Vendas** :</span><span class="sxs-lookup"><span data-stu-id="fa1d6-144">In the model designer, rename the columns in the **Sales Territory** table:</span></span>  
  
     <span data-ttu-id="fa1d6-145">**Sales Territory**</span><span class="sxs-lookup"><span data-stu-id="fa1d6-145">**Sales Territory**</span></span>  
  
    |<span data-ttu-id="fa1d6-146">Nome de origem</span><span class="sxs-lookup"><span data-stu-id="fa1d6-146">Source Name</span></span>|<span data-ttu-id="fa1d6-147">Nome amigável</span><span class="sxs-lookup"><span data-stu-id="fa1d6-147">Friendly Name</span></span>|  
    |-----------------|-------------------|  
    |<span data-ttu-id="fa1d6-148">SalesTerritoryKey</span><span class="sxs-lookup"><span data-stu-id="fa1d6-148">SalesTerritoryKey</span></span>|<span data-ttu-id="fa1d6-149">Sales Territory Id</span><span class="sxs-lookup"><span data-stu-id="fa1d6-149">Sales Territory Id</span></span>|  
    |<span data-ttu-id="fa1d6-150">SalesTerritoryRegion</span><span class="sxs-lookup"><span data-stu-id="fa1d6-150">SalesTerritoryRegion</span></span>|<span data-ttu-id="fa1d6-151">Sales Territory Region</span><span class="sxs-lookup"><span data-stu-id="fa1d6-151">Sales Territory Region</span></span>|  
    |<span data-ttu-id="fa1d6-152">SalesTerritoryCountry</span><span class="sxs-lookup"><span data-stu-id="fa1d6-152">SalesTerritoryCountry</span></span>|<span data-ttu-id="fa1d6-153">Sales Territory Country</span><span class="sxs-lookup"><span data-stu-id="fa1d6-153">Sales Territory Country</span></span>|  
    |<span data-ttu-id="fa1d6-154">SalesTerritoryGroup</span><span class="sxs-lookup"><span data-stu-id="fa1d6-154">SalesTerritoryGroup</span></span>|<span data-ttu-id="fa1d6-155">Sales Territory Group</span><span class="sxs-lookup"><span data-stu-id="fa1d6-155">Sales Territory Group</span></span>|  
  
## <a name="add-a-table-with-user-name-data"></a><span data-ttu-id="fa1d6-156">Adicionar uma tabela com os dados de nome de usuário</span><span class="sxs-lookup"><span data-stu-id="fa1d6-156">Add a table with user name data</span></span>  
 <span data-ttu-id="fa1d6-157">Como a tabela dimEmployee no banco de dados de exemplo AdventureWorksDW contém usuários do domínio AdventureWorks, e esses nomes de usuários não existem em seu próprio ambiente, crie uma tabela em seu modelo que contenha um exemplo pequeno (três) de usuários reais de sua organização.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-157">Because the dimEmployee table in the AdventureWorksDW sample database contains users from the AdventureWorks domain, and those user names do not exist in your own environment, you must create a table in your model that contains a small sample (three) of actual users from your organization.</span></span> <span data-ttu-id="fa1d6-158">Você adicionará estes usuários como membros à nova função.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-158">You will then add these users as members to the new role.</span></span> <span data-ttu-id="fa1d6-159">Você não precisa das senhas para os nomes de usuários de exemplo, mas precisará dos nomes de usuários reais do Windows de seu próprio domínio.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-159">You do not need the passwords for the sample user names, but you will need actual Windows user names from your own domain.</span></span>  
  
#### <a name="to-add-an-employee-security-table"></a><span data-ttu-id="fa1d6-160">Para adicionar uma tabela Segurança de Funcionário</span><span class="sxs-lookup"><span data-stu-id="fa1d6-160">To add an Employee Security table</span></span>  
  
1.  <span data-ttu-id="fa1d6-161">Abra o Microsoft Excel e crie uma nova planilha.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-161">Open Microsoft Excel, creating a new worksheet.</span></span>  
  
2.  <span data-ttu-id="fa1d6-162">Copie a tabela a seguir incluindo a linha de cabeçalho e cole-a na planilha.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-162">Copy the following table, including the header row, and then paste it into the worksheet.</span></span>  
  
    |<span data-ttu-id="fa1d6-163">Employee Id</span><span class="sxs-lookup"><span data-stu-id="fa1d6-163">Employee Id</span></span>|<span data-ttu-id="fa1d6-164">Sales Territory Id</span><span class="sxs-lookup"><span data-stu-id="fa1d6-164">Sales Territory Id</span></span>|<span data-ttu-id="fa1d6-165">Nome</span><span class="sxs-lookup"><span data-stu-id="fa1d6-165">First Name</span></span>|<span data-ttu-id="fa1d6-166">Sobrenome</span><span class="sxs-lookup"><span data-stu-id="fa1d6-166">Last Name</span></span>|<span data-ttu-id="fa1d6-167">Login Id</span><span class="sxs-lookup"><span data-stu-id="fa1d6-167">Login Id</span></span>|  
    |-----------------|------------------------|----------------|---------------|--------------|  
    |<span data-ttu-id="fa1d6-168">1</span><span class="sxs-lookup"><span data-stu-id="fa1d6-168">1</span></span>|<span data-ttu-id="fa1d6-169">2</span><span class="sxs-lookup"><span data-stu-id="fa1d6-169">2</span></span>|\<user first name>|\<user last name>|\<domain\username>|  
    |<span data-ttu-id="fa1d6-170">1</span><span class="sxs-lookup"><span data-stu-id="fa1d6-170">1</span></span>|<span data-ttu-id="fa1d6-171">3</span><span class="sxs-lookup"><span data-stu-id="fa1d6-171">3</span></span>|\<user first name>|\<user last name>|\<domain\username>|  
    |<span data-ttu-id="fa1d6-172">2</span><span class="sxs-lookup"><span data-stu-id="fa1d6-172">2</span></span>|<span data-ttu-id="fa1d6-173">4</span><span class="sxs-lookup"><span data-stu-id="fa1d6-173">4</span></span>|\<user first name>|\<user last name>|\<domain\username>|  
    |<span data-ttu-id="fa1d6-174">3</span><span class="sxs-lookup"><span data-stu-id="fa1d6-174">3</span></span>|<span data-ttu-id="fa1d6-175">5</span><span class="sxs-lookup"><span data-stu-id="fa1d6-175">5</span></span>|\<user first name>|\<user last name>|\<domain\username>|  
  
3.  <span data-ttu-id="fa1d6-176">Na nova planilha, substitua o nome, o sobrenome e o domínio\nome de usuário pelos nomes e ids de logon de três usuários em sua organização.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-176">In the new worksheet, replace the first name, last name, and domain\username with the names and login ids of three users in your organization.</span></span> <span data-ttu-id="fa1d6-177">Coloque o mesmo usuário nas duas primeiras linhas, para Employee Id 1.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-177">Put the same user on the first two rows, for Employee Id 1.</span></span> <span data-ttu-id="fa1d6-178">Isso mostrará que este usuário pertence a mais de uma região de vendas.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-178">This will show this user belongs to more than one sales territory.</span></span> <span data-ttu-id="fa1d6-179">Deixe os campos Employee Id e Sales Territory Id como tal.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-179">Leave the Employee Id and Sales Territory Id fields as they are.</span></span>  
  
4.  <span data-ttu-id="fa1d6-180">Salve a planilha como `Sample Employee` .</span><span class="sxs-lookup"><span data-stu-id="fa1d6-180">Save the worksheet as `Sample Employee`.</span></span>  
  
5.  <span data-ttu-id="fa1d6-181">Na planilha, selecione todas as células com dados de funcionário, incluindo os cabeçalhos, clique com o botão direito do mouse nos dados selecionados e clique em **Copiar**.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-181">In the worksheet, select all of the cells with employee data, including the headers, then right click the selected data, and then click **Copy**.</span></span>  
  
6.  <span data-ttu-id="fa1d6-182">No [!INCLUDE[ssBIDevStudio](../includes/ssbidevstudio-md.md)], clique no menu **Editar** e em **Colar**.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-182">In [!INCLUDE[ssBIDevStudio](../includes/ssbidevstudio-md.md)], click the **Edit** menu, and then click **Paste**.</span></span>  
  
     <span data-ttu-id="fa1d6-183">Se a opção Colar estiver acinzentada, clique em qualquer coluna de qualquer tabela na janela do designer de modelos, clique no menu **Editar** e em **Colar**.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-183">If Paste is greyed out, click any column in any table in the model designer window, and then click the **Edit** menu, and then click **Paste**.</span></span>  
  
7.  <span data-ttu-id="fa1d6-184">Na caixa de diálogo **visualização de colagem** , em **nome da tabela**, digite `Employee Security` .</span><span class="sxs-lookup"><span data-stu-id="fa1d6-184">In the **Paste Preview** dialog box, in **Table Name**, type `Employee Security`.</span></span>  
  
8.  <span data-ttu-id="fa1d6-185">Em **Dados a serem colados**, verifique se os dados incluem todos os dados de usuário e cabeçalhos da planilha Funcionário de Exemplo.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-185">In **Data to be pasted**, verify the data includes all of the user data and headers from the Sample Employee worksheet.</span></span>  
  
9. <span data-ttu-id="fa1d6-186">Verifique se a opção **Usar primeira linha como cabeçalhos de coluna** está marcada e clique em **Ok**.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-186">Verify **Use first row as column headers** is checked, and then click **Ok**.</span></span>  
  
     <span data-ttu-id="fa1d6-187">Uma nova tabela nomeada Employee Security com dados de funcionário copiados da planilha Sample Employee é criada.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-187">A new table named Employee Security with employee data copied from the Sample Employee worksheet is created.</span></span>  
  
## <a name="create-relationships-between-internet-sales-geography-and-sales-territory-table"></a><span data-ttu-id="fa1d6-188">Criar relações entre as tabelas Internet Sales, Geography e Sales Territory</span><span class="sxs-lookup"><span data-stu-id="fa1d6-188">Create Relationships Between Internet Sales, Geography, and Sales Territory table</span></span>  
 <span data-ttu-id="fa1d6-189">A tabela vendas pela Internet, Geografia e região de vendas contém uma coluna comum, ID da região de vendas. A coluna ID da região de vendas na tabela região de vendas contém valores com uma ID diferente para cada região de vendas.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-189">The Internet Sales, Geography, and Sales Territory table all contain a common column, Sales Territory Id. The Sales Territory Id column in the Sales Territory table contains values with a different Id for each sales territory.</span></span>  
  
#### <a name="to-create-relationships-between-the-internet-sales-geography-and-the-sales-territory-table"></a><span data-ttu-id="fa1d6-190">Para criar relações entre as tabelas Internet Sales, Geography e Sales Territory</span><span class="sxs-lookup"><span data-stu-id="fa1d6-190">To create relationships between the Internet Sales, Geography, and the Sales Territory table</span></span>  
  
1.  <span data-ttu-id="fa1d6-191">No designer de modelos, em Exibição de Diagrama, na tabela **Geografia** , clique e mantenha o botão do mouse pressionado na coluna **ID da Região de Vendas** , arraste o cursor até a coluna **ID da Região de Vendas** da tabela **Região de Vendas** e solte o botão.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-191">In the model designer, in Diagram View, in the **Geography** table, click and hold on the **Sales Territory Id** column, then drag the cursor to the **Sales Territory Id** column in the **Sales Territory** table, and then release.</span></span>  
  
2.  <span data-ttu-id="fa1d6-192">Na tabela **Vendas pela Internet** , clique e mantenha o botão do mouse pressionado na coluna **ID da Região de Vendas** , arraste o cursor até a coluna **ID da Região de Vendas** da tabela **Região de Vendas** e solte o botão.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-192">In the **Internet Sales** table, click and hold on the **Sales Territory Id** column, then drag the cursor to the **Sales Territory Id** column in the **Sales Territory** table, and then release.</span></span>  
  
     <span data-ttu-id="fa1d6-193">Note que a propriedade ativa desta relação é False, o que significa que ela está inativa.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-193">Notice the Active property for this relationship is False, meaning it is inactive.</span></span> <span data-ttu-id="fa1d6-194">Isso ocorre porque a tabela Internet Sales já tem outra relação ativa que é usada em medidas.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-194">This is because the Internet Sales table already has another active relationship that is used in measures.</span></span>  
  
## <a name="hide-the-employee-security-table-from-client-applications"></a><span data-ttu-id="fa1d6-195">Ocultar a tabela Employee Security de aplicativos cliente</span><span class="sxs-lookup"><span data-stu-id="fa1d6-195">Hide the Employee Security Table from Client Applications</span></span>  
 <span data-ttu-id="fa1d6-196">Nesta tarefa, você ocultará a tabela de segurança do funcionário, impedindo que ela apareça na lista de campos de um aplicativo cliente.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-196">In this task, you will hide the Employee Security table, keeping it from appearing in a client application's field list.</span></span> <span data-ttu-id="fa1d6-197">Lembre-se que ocultar uma tabela não a protege.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-197">Keep in-mind that hiding a table does not secure it.</span></span> <span data-ttu-id="fa1d6-198">Os usuários ainda poderão consultar dados da tabela Employee Security se souberem como fazê-lo.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-198">Users can still query Employee Security table data if they know how.</span></span> <span data-ttu-id="fa1d6-199">Para proteger os dados da tabela Employee Security, impedindo que usuários possam consultar seus dados, você aplicará um filtro em uma tarefa posterior.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-199">In order to secure the Employee Security table data, preventing users from being able to query any of its data, you will apply a filter in a later task.</span></span>  
  
#### <a name="to-hide-the-employee-table-from-client-applications"></a><span data-ttu-id="fa1d6-200">Para ocultar a tabela Employee de aplicativos cliente</span><span class="sxs-lookup"><span data-stu-id="fa1d6-200">To hide the Employee Table from client applications</span></span>  
  
-   <span data-ttu-id="fa1d6-201">No designer de modelos, na Exibição de Diagrama, clique com o botão direito do mouse no título de tabela **Funcionário** e, em seguida, clique em **Ocultar das Ferramentas de Cliente**.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-201">In the model designer, in Diagram View, right-click the **Employee** table heading, and then click **Hide from Client Tools**.</span></span>  
  
## <a name="create-a-sales-employees-by-territory-user-role"></a><span data-ttu-id="fa1d6-202">Criar uma função de usuário de Funcionários de Vendas por Região</span><span class="sxs-lookup"><span data-stu-id="fa1d6-202">Create a Sales Employees by Territory user role</span></span>  
 <span data-ttu-id="fa1d6-203">Nesta tarefa, você criará uma nova função de usuário.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-203">In this task, you will create a new user role.</span></span> <span data-ttu-id="fa1d6-204">Esta função incluirá um filtro de linha que define quais linhas da tabela Sales Territory são visíveis a usuários.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-204">This role will include a row filter defining which rows of the Sales Territory table are visible to users.</span></span> <span data-ttu-id="fa1d6-205">O filtro é aplicado na direção de relação um para muitos a todas as outras tabelas relacionadas a Sales Territory.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-205">The filter is then applied in the one-to many relationship direction to all other tables related to Sales Territory.</span></span> <span data-ttu-id="fa1d6-206">Você também aplicará um filtro simples que protege a tabela Employee Security inteira contra a consulta por qualquer usuário que seja membro da função.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-206">You will also apply a simple filter that secures the entire Employee Security table from being queryable by any user that is a member of the role.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="fa1d6-207">A função Funcionários de Vendas por Região criada nesta lição restringe os membros para procurar (ou consultar) apenas dados de vendas da região de vendas à qual pertencem.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-207">The Sales Employees by Territory role you create in this lesson restricts members to browse (or query) only sales data for the sales territory to which they belong.</span></span> <span data-ttu-id="fa1d6-208">Se você adicionar um usuário como um membro à função Funcionários de Vendas por Região que também existe como um membro em uma função criada na [Lição 12: Criar funções](../analysis-services/lesson-11-create-roles.md), você obterá uma combinação de permissões.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-208">If you add a user as a member to the Sales Employees by Territory role that also exists as a member in a role created in [Lesson 12: Create Roles](../analysis-services/lesson-11-create-roles.md), you will get a combination of permissions.</span></span> <span data-ttu-id="fa1d6-209">Quando um usuário é um membro de várias funções, permissões e filtros de linha definidos para cada função são cumulativos.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-209">When a user is a member of multiple roles, the permissions, and row filters defined for each role are cumulative.</span></span> <span data-ttu-id="fa1d6-210">Quer dizer, o usuário terá as maiores permissões determinadas pela combinação de funções.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-210">That is, the user will have the greater permissions determined by the combination of roles.</span></span>  
  
#### <a name="to-create-a-sales-employees-by-territory-user-role"></a><span data-ttu-id="fa1d6-211">Para criar uma função de usuário de Funcionários de Vendas por Região</span><span class="sxs-lookup"><span data-stu-id="fa1d6-211">To create a Sales Employees by Territory user role</span></span>  
  
1.  <span data-ttu-id="fa1d6-212">No [!INCLUDE[ssBIDevStudio](../includes/ssbidevstudio-md.md)], clique no menu **Modelo** e em **Funções**.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-212">In [!INCLUDE[ssBIDevStudio](../includes/ssbidevstudio-md.md)], click the **Model** menu, and then click **Roles**.</span></span>  
  
2.  <span data-ttu-id="fa1d6-213">Na caixa de diálogo **Gerenciador de Funções** , clique em **Novo**.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-213">In the **Role Manager** dialog box, click **New**.</span></span>  
  
     <span data-ttu-id="fa1d6-214">Uma nova função com a permissão Nenhum é adicionada à lista.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-214">A new role with the None permission is added to the list.</span></span>  
  
3.  <span data-ttu-id="fa1d6-215">Clique na nova função e, na coluna **nome** , renomeie a função como `Sales Employees by Territory` .</span><span class="sxs-lookup"><span data-stu-id="fa1d6-215">Click on the new role, and then in the **Name** column, rename the role to `Sales Employees by Territory`.</span></span>  
  
4.  <span data-ttu-id="fa1d6-216">Na coluna **Permissões**, clique na lista suspensa e, em seguida, selecione a permissão **Leitura**.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-216">In the **Permissions** column, click the dropdown list, and then select the **Read** permission.</span></span>  
  
5.  <span data-ttu-id="fa1d6-217">Clique na guia **Membros** e em **Adicionar**.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-217">Click on the **Members** tab, and then click **Add**.</span></span>  
  
6.  <span data-ttu-id="fa1d6-218">Na caixa de diálogo **Selecionar Usuário ou Grupo** , em **Inserir o objeto nomeado a ser selecionado**, digite o primeiro nome de usuário de exemplo que você usou ao criar a tabela Segurança do Funcionário.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-218">In the **Select User or Group** dialog box, in **Enter the object named to select**, type the first sample user name you used when creating the Employee Security table.</span></span> <span data-ttu-id="fa1d6-219">Clique em **Verificar Nomes** para verificar se o nome de usuário é válido e, em seguida, clique em **Ok**.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-219">Click **Check Names** to verify the user name is valid, and then click **Ok**.</span></span>  
  
     <span data-ttu-id="fa1d6-220">Repita esta etapa, adicionando os outros nomes de usuários de exemplo usados ao criar a tabela Employee Security.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-220">Repeat this step, adding the other sample user names you used when creating the Employee Security table.</span></span>  
  
7.  <span data-ttu-id="fa1d6-221">Clique na guia **Filtros de Linha** .</span><span class="sxs-lookup"><span data-stu-id="fa1d6-221">Click on the **Row Filters** tab.</span></span>  
  
8.  <span data-ttu-id="fa1d6-222">Para a `Employee Security` tabela, na coluna **filtro Dax** , digite a fórmula a seguir.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-222">For the `Employee Security` table, in the **DAX Filter** column, type the following formula.</span></span>  
  
     `=FALSE()`  
  
     <span data-ttu-id="fa1d6-223">Ao concluir a criação da fórmula, pressione ENTER.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-223">When you have finished building the formula, press ENTER.</span></span>  
  
     <span data-ttu-id="fa1d6-224">Esta fórmula especifica que todas as colunas são resolvidas com a condição Booliana false; portanto, nenhuma coluna da tabela Employee Security pode ser consultada por um membro da função de usuário Sales Employees by Territory.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-224">This formula specifies that all columns resolve to the false Boolean condition; therefore, no columns for the Employee Security table can be queried by a member of the Sales Employees by Territory user role.</span></span>  
  
9. <span data-ttu-id="fa1d6-225">Na tabela **Região de Vendas** , digite a fórmula a seguir.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-225">For the **Sales Territory** table, type the following formula.</span></span>  
  
     `='Sales Territory'[Sales Territory Id]=LOOKUPVALUE('Employee Security'[Sales Territory Id], 'Employee Security'[Login Id], USERNAME(), 'Employee Security'[Sales Territory Id], 'Sales Territory'[Sales Territory Id])`  
  
     <span data-ttu-id="fa1d6-226">Ao concluir a criação da fórmula, pressione ENTER.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-226">When you have finished building the formula, press ENTER.</span></span>  
  
     <span data-ttu-id="fa1d6-227">Nesta fórmula, a função LOOKUPVALUE retorna todos os valores da coluna Employee Security[Sales Territory Id], onde Employee Security[Login Id] equivale ao nome de usuário atual registrado no Windows, e Employee Security[Sales Territory Id] equivale ao Sales Territory[Sales Territory Id].</span><span class="sxs-lookup"><span data-stu-id="fa1d6-227">In this formula, the LOOKUPVALUE function returns all values for the Employee Security[Sales Territory Id] column, where the Employee Security[Login Id] is the same as the current logged on Windows user name, and Employee Security[Sales Territory Id] is the same as the Sales Territory[Sales Territory Id].</span></span>  
  
     <span data-ttu-id="fa1d6-228">O conjunto de Sales Territory IDs retornado por LOOKUPVALUE é usado para restringir as linhas mostradas na tabela Sales Territory.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-228">The set of Sales Territory IDs returned by LOOKUPVALUE is then used to restrict the rows shown in the Sales Territory table.</span></span> <span data-ttu-id="fa1d6-229">Apenas as linhas em que Sales Territory ID para a linha estiver no conjunto de IDs retornadas pela função LOOKUPVALUE são exibidas.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-229">Only rows where the Sales Territory ID for the row is in the set of IDs returned by the LOOKUPVALUE function are displayed.</span></span>  
  
10. <span data-ttu-id="fa1d6-230">Na caixa de diálogo Gerenciador de Funções, clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-230">In the Role Manager dialog box, click **Ok**.</span></span>  
  
## <a name="test-the-sales-employees-by-territory-user-role"></a><span data-ttu-id="fa1d6-231">Testar a função de usuário de Funcionários de Vendas por Região</span><span class="sxs-lookup"><span data-stu-id="fa1d6-231">Test the Sales Employees by Territory User Role</span></span>  
 <span data-ttu-id="fa1d6-232">Nesta tarefa, você usará o recurso Analisar no Excel no [!INCLUDE[ssBIDevStudio](../includes/ssbidevstudio-md.md)] para testar a eficácia da função de usuário Sales Employees by Territory.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-232">In this task, you will use the Analyze in Excel feature in [!INCLUDE[ssBIDevStudio](../includes/ssbidevstudio-md.md)] to test the efficacy of the Sales Employees by Territory user role.</span></span> <span data-ttu-id="fa1d6-233">Você especificará um dos nomes de usuários adicionado à tabela Employee Security e como um membro da função.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-233">You will specify one of the user names you added to the Employee Security table and as a member of the role.</span></span> <span data-ttu-id="fa1d6-234">Este nome de usuário será usado como o nome de usuário efetivo na conexão criada entre o Excel e o modelo.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-234">This user name will then be used as the effective user name in the connection created between Excel and the model.</span></span>  
  
#### <a name="to-test-the-sales-employees-by-territory-user-role"></a><span data-ttu-id="fa1d6-235">Para testar a função de usuário de Funcionários de Vendas por Região</span><span class="sxs-lookup"><span data-stu-id="fa1d6-235">To test the Sales Employees by Territory user role</span></span>  
  
1.  <span data-ttu-id="fa1d6-236">No [!INCLUDE[ssBIDevStudio](../includes/ssbidevstudio-md.md)], clique no menu **Modelo** e em **Analisar no Excel**.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-236">In [!INCLUDE[ssBIDevStudio](../includes/ssbidevstudio-md.md)], click the **Model** menu, and then click **Analyze in Excel**.</span></span>  
  
2.  <span data-ttu-id="fa1d6-237">Na caixa de diálogo **Analisar no Excel**, **especifique o nome de usuário ou função a ser usada para se conectar ao modelo**, selecione **Outro Usuário do Windows** e, em seguida, clique em **Procurar**.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-237">In the **Analyze in Excel** dialog box, in **Specify the user name or role to use to connect to the model**, select **Other Windows User**, and then click **Browse**.</span></span>  
  
3.  <span data-ttu-id="fa1d6-238">Na caixa de diálogo **Selecionar Usuário ou Grupo** , em **Inserir o nome de objeto a ser selecionado**, digite um dos nomes de usuário incluídos na tabela Funcionário e clique em **Verificar Nomes**.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-238">In the **Select User or Group** dialog box, in **Enter the object name to select**, type one of the user names you included in the Employee table, and then click **Check Names**.</span></span>  
  
4.  <span data-ttu-id="fa1d6-239">Clique em **Ok** para fechar a caixa de diálogo **Selecionar Usuário ou Grupo** e clique em **Ok** para fechar a caixa de diálogo **Analisar no Excel**.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-239">Click **Ok** to close the **Select User or Group** dialog box, and then click **Ok** to close the **Analyze in Excel** dialog box.</span></span>  
  
     <span data-ttu-id="fa1d6-240">O Excel abrirá uma nova pasta de trabalho.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-240">Excel will open with a new workbook.</span></span> <span data-ttu-id="fa1d6-241">Uma Tabela Dinâmica é criada automaticamente.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-241">A Pivot table is automatically created.</span></span> <span data-ttu-id="fa1d6-242">A Lista de Campos de Tabela Dinâmica inclui a maioria dos campos de dados disponíveis no novo modelo.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-242">The Pivot Table Field List includes most of the data fields available in your new model.</span></span>  
  
     <span data-ttu-id="fa1d6-243">Note que a tabela Employee Security não fica visível na Lista de campos de Tabela Dinâmica.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-243">Notice the Employee Security table is not visible in the Pivot Table Field List.</span></span> <span data-ttu-id="fa1d6-244">Isso ocorre porque você optou por ocultar esta tabela de ferramentas de cliente em uma tarefa anterior.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-244">This is because you chose to hide this table from client tools in a previous task.</span></span>  
  
5.  <span data-ttu-id="fa1d6-245">Na lista **Campo da Tabela Dinâmica** , em **∑ Vendas pela Internet** (medidas), selecione a medida **Total de Vendas pela Internet** .</span><span class="sxs-lookup"><span data-stu-id="fa1d6-245">In the **Pivot Table Field** list, in **∑ Internet Sales** (measures), select the **Internet Total Sales** measure.</span></span> <span data-ttu-id="fa1d6-246">A medida será inserida nos campos **Valores** .</span><span class="sxs-lookup"><span data-stu-id="fa1d6-246">The measure will be entered into the **Values** fields.</span></span>  
  
6.  <span data-ttu-id="fa1d6-247">Na lista **Campo da Tabela Dinâmica** , selecione a coluna **ID da Região de Vendas** da tabela **Região de Vendas** .</span><span class="sxs-lookup"><span data-stu-id="fa1d6-247">In the **Pivot Table Field** list, select the **Sales Territory Id** column from the **Sales Territory** table.</span></span> <span data-ttu-id="fa1d6-248">A coluna será inserida nos campos **Rótulos de Linha** .</span><span class="sxs-lookup"><span data-stu-id="fa1d6-248">The column will be entered into the **Row Labels** fields.</span></span>  
  
     <span data-ttu-id="fa1d6-249">Observe que os valores de vendas pela Internet aparecem somente para a região à qual o nome de usuário efetivo usado pertence.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-249">Notice Internet sales figures appear only for the one region to which the effective user name you used belongs.</span></span> <span data-ttu-id="fa1d6-250">Se você selecionar outra coluna; por exemplo, City, da tabela Geography como campo Row Label, apenas as cidades da região de vendas à qual o usuário efetivo pertence serão exibidas.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-250">If you select another column; for example, City, from the Geography table as Row Label field, only cities in the sales territory to which the effective user belongs are displayed.</span></span>  
  
     <span data-ttu-id="fa1d6-251">Este usuário não pode navegar nem consultar dados de vendas pela Internet regiões que não sejam aquela à qual eles pertencem porque o filtro de linha definido para a tabela Sales Territory na função de usuário Sales Employees by Territory efetivamente protege dados para todos os dados relacionados a outras regiões de vendas.</span><span class="sxs-lookup"><span data-stu-id="fa1d6-251">This user cannot browse or query any Internet sales data for territories other than the one they belong because the row filter defined for the Sales Territory table in the Sales Employees by Territory user role effectively secures data for all data related to other sales territories.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="fa1d6-252">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="fa1d6-252">See Also</span></span>  
 <span data-ttu-id="fa1d6-253">[Função de nome de usuário &#40;DAX&#41;](/dax/username-function-dax) </span><span class="sxs-lookup"><span data-stu-id="fa1d6-253">[USERNAME Function &#40;DAX&#41;](/dax/username-function-dax) </span></span>  
 <span data-ttu-id="fa1d6-254">[Função LOOKUPvalue &#40;DAX&#41;](/dax/lookupvalue-function-dax) </span><span class="sxs-lookup"><span data-stu-id="fa1d6-254">[LOOKUPVALUE Function &#40;DAX&#41;](/dax/lookupvalue-function-dax) </span></span>  
 [<span data-ttu-id="fa1d6-255">Função CUSTOMDATA &#40;DAX&#41;</span><span class="sxs-lookup"><span data-stu-id="fa1d6-255">CUSTOMDATA Function &#40;DAX&#41;</span></span>](/dax/customdata-function-dax)  
  
  
