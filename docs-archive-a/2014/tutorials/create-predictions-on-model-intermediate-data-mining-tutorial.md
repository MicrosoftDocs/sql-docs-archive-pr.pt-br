---
title: Criando previsões em um modelo de clustering de sequência (tutorial de mineração de dados intermediário) | Microsoft Docs
ms.custom: ''
ms.date: 03/08/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 94a8d4f9-a76a-49c5-9785-917010359511
author: minewiskan
ms.author: owend
manager: kfilee
ms.openlocfilehash: 2402c28a564502df9ce12c5e3f97b9d19590cfea
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87568271"
---
# <a name="creating-predictions-on-a-sequence-clustering-model-intermediate-data-mining-tutorial"></a><span data-ttu-id="1dd48-102">Criando previsões em um modelo de cluster de sequências (Tutorial de mineração de dados intermediário)</span><span class="sxs-lookup"><span data-stu-id="1dd48-102">Creating Predictions on a Sequence Clustering Model (Intermediate Data Mining Tutorial)</span></span>
  <span data-ttu-id="1dd48-103">Depois de entender melhor o modelo de clustering de sequências navegando no visualizador, você pode criar consultas de previsão usando a previsão Construtor de Consultas na guia **previsão do modelo de mineração** no designer de mineração de dados.</span><span class="sxs-lookup"><span data-stu-id="1dd48-103">After you understand the sequence clustering model better by browsing it in the viewer, you can create prediction queries by using Prediction Query Builder on the **Mining Model Prediction** tab in Data Mining Designer.</span></span> <span data-ttu-id="1dd48-104">Para criar uma previsão, primeiro selecione o modelo de clustering de sequências e selecione os dados de entrada.</span><span class="sxs-lookup"><span data-stu-id="1dd48-104">To create a prediction, you first select the sequence clustering model, and then select the input data.</span></span> <span data-ttu-id="1dd48-105">Para entradas, use uma fonte de dados externa ou crie uma consulta singleton e forneça valores em uma caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="1dd48-105">For inputs, you can use either an external data source, or you can build a singleton query and provide values in a dialog box.</span></span>  
  
 <span data-ttu-id="1dd48-106">Esta lição supõe que você já saiba usar o construtor de consultas de previsão e que deseja aprender a criar consultas específicas de um modelo de clustering de sequências.</span><span class="sxs-lookup"><span data-stu-id="1dd48-106">This lesson assumes that you are already familiar with how to use the prediction query builder and want to learn how to build queries that are specific to a sequence clustering model.</span></span> <span data-ttu-id="1dd48-107">Para obter informações gerais sobre como usar Construtor de Consultas de previsão, consulte [interfaces de consulta de mineração de dados](../../2014/analysis-services/data-mining/data-mining-query-tools.md) ou a seção do tutorial de mineração de dados básico, [Criando previsões &#40;tutorial de mineração de dados básico&#41;](../../2014/tutorials/creating-predictions-basic-data-mining-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="1dd48-107">For general information about how to use Prediction Query Builder, see [Data Mining Query Interfaces](../../2014/analysis-services/data-mining/data-mining-query-tools.md) or the section of the Basic Data Mining tutorial, [Creating Predictions &#40;Basic Data Mining Tutorial&#41;](../../2014/tutorials/creating-predictions-basic-data-mining-tutorial.md).</span></span>  
  
## <a name="creating-predictions-on-the-regional-model"></a><span data-ttu-id="1dd48-108">Criando previsões em um modelo regional</span><span class="sxs-lookup"><span data-stu-id="1dd48-108">Creating Predictions on the Regional Model</span></span>  
 <span data-ttu-id="1dd48-109">Para este cenário, primeiro você criará algumas consultas de previsão singleton, para ter uma ideia de como as previsões podem variar por região.</span><span class="sxs-lookup"><span data-stu-id="1dd48-109">For this scenario, you will first create some singleton prediction queries, to get an idea of how predictions might be different by region.</span></span>  
  
#### <a name="to-create-a-singleton-query-on-a-sequence-clustering-model"></a><span data-ttu-id="1dd48-110">Para criar uma consulta de previsão singleton em um modelo de clustering de sequências</span><span class="sxs-lookup"><span data-stu-id="1dd48-110">To create a singleton query on a sequence clustering model</span></span>  
  
1.  <span data-ttu-id="1dd48-111">Clique na guia **previsão do modelo de mineração** do designer de mineração de dados.</span><span class="sxs-lookup"><span data-stu-id="1dd48-111">Click the **Mining Model Prediction** tab of Data Mining Designer.</span></span>  
  
2.  <span data-ttu-id="1dd48-112">No menu de colunas do **modelo de mineração** , selecione **consulta singleton**.</span><span class="sxs-lookup"><span data-stu-id="1dd48-112">In the **Mining Model** column menu, select **Singleton Query**.</span></span>  
  
     <span data-ttu-id="1dd48-113">O painel **modelo de mineração** e o painel entrada de **consulta singleton** são exibidos.</span><span class="sxs-lookup"><span data-stu-id="1dd48-113">The **Mining Model** pane and **Singleton Query Input** pane appear.</span></span>  
  
3.  <span data-ttu-id="1dd48-114">No painel **modelo de mineração** , clique em **selecionar modelo**.</span><span class="sxs-lookup"><span data-stu-id="1dd48-114">In the **Mining Model** pane, click **Select Model**.</span></span> <span data-ttu-id="1dd48-115">(se o modo de clustering de sequências já tiver sido selecionado, você poderá ignorar esta etapa).</span><span class="sxs-lookup"><span data-stu-id="1dd48-115">(You can skip this step if the sequence clustering mode is already selected.)</span></span>  
  
     <span data-ttu-id="1dd48-116">A caixa de diálogo **selecionar modelo de mineração** é aberta.</span><span class="sxs-lookup"><span data-stu-id="1dd48-116">The **Select Mining Model** dialog box opens.</span></span>  
  
4.  <span data-ttu-id="1dd48-117">Expanda o nó que representa o **clustering de sequência**da estrutura de mineração com região e selecione o **clustering de sequência de modelo com região**.</span><span class="sxs-lookup"><span data-stu-id="1dd48-117">Expand the node that represents the mining structure **Sequence Clustering with Region**, and select the model **Sequence Clustering with Region**.</span></span> <span data-ttu-id="1dd48-118">Clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="1dd48-118">Click **OK**.</span></span> <span data-ttu-id="1dd48-119">Por ora, ignore o painel de entrada; você especificará as entradas depois de configurar as funções de previsão.</span><span class="sxs-lookup"><span data-stu-id="1dd48-119">For now, ignore the input pane; you will specify the inputs after you have set up the prediction functions.</span></span>  
  
5.  <span data-ttu-id="1dd48-120">Na grade, clique na célula vazia em **origem** e selecione **função de previsão.**</span><span class="sxs-lookup"><span data-stu-id="1dd48-120">In the grid, click the empty cell under **Source** and select **Prediction Function.**</span></span> <span data-ttu-id="1dd48-121">Na célula em **campo**, selecione **PredictSequence**.</span><span class="sxs-lookup"><span data-stu-id="1dd48-121">In the cell under **Field**, select **PredictSequence**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="1dd48-122">Você também pode usar a função **Predict** .</span><span class="sxs-lookup"><span data-stu-id="1dd48-122">You can also use the **Predict** function.</span></span> <span data-ttu-id="1dd48-123">Se você fizer isso, certifique-se de escolher a versão da função **Predict** que usa uma coluna de tabela como argumento.</span><span class="sxs-lookup"><span data-stu-id="1dd48-123">If you do, be sure to choose the version of the **Predict** function that takes a table column as argument..</span></span>  
  
6.  <span data-ttu-id="1dd48-124">No painel **modelo de mineração** , selecione a tabela aninhada `v Assoc Seq Line Items` e arraste-a para a grade, para a caixa **critérios/argumento** da função **PredictSequence** .</span><span class="sxs-lookup"><span data-stu-id="1dd48-124">In the **Mining Model** pane, select the nested table `v Assoc Seq Line Items`, and drag it into the grid, to the **Criteria/Argument** box for the **PredictSequence** function.</span></span>  
  
     <span data-ttu-id="1dd48-125">Arrastar e soltar nomes de tabela e coluna permite que você crie instruções complexas sem erros de sintaxe.</span><span class="sxs-lookup"><span data-stu-id="1dd48-125">Dragging and dropping table and column names enables you to build complex statements without syntax errors.</span></span> <span data-ttu-id="1dd48-126">No entanto, ele substitui o conteúdo atual da célula, que inclui outros argumentos opcionais para a função **PredictSequence** .</span><span class="sxs-lookup"><span data-stu-id="1dd48-126">However, it replaces the current contents of the cell, which include other optional arguments for the **PredictSequence** function.</span></span> <span data-ttu-id="1dd48-127">Para exibir os outros argumentos, você pode adicionar temporariamente uma segunda instância da função à grade para referência.</span><span class="sxs-lookup"><span data-stu-id="1dd48-127">To view the other arguments, you can temporarily add a second instance of the function to the grid for reference.</span></span>  
  
7.  <span data-ttu-id="1dd48-128">Clique no botão **resultado** no canto superior do construtor de consultas de previsão.</span><span class="sxs-lookup"><span data-stu-id="1dd48-128">Click the **Result** button in the upper corner of the Prediction Query Builder.</span></span>  
  
 <span data-ttu-id="1dd48-129">Os resultados esperados contêm uma única coluna com a **expressão**de cabeçalho.</span><span class="sxs-lookup"><span data-stu-id="1dd48-129">The expected results contain a single column with the heading **Expression**.</span></span> <span data-ttu-id="1dd48-130">A coluna **expressão** contém uma tabela aninhada com três colunas da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="1dd48-130">The **Expression** column contains a nested table with three columns as follows:</span></span>  
  
|<span data-ttu-id="1dd48-131">$SEQUENCE</span><span class="sxs-lookup"><span data-stu-id="1dd48-131">$SEQUENCE</span></span>|<span data-ttu-id="1dd48-132">Número da Linha</span><span class="sxs-lookup"><span data-stu-id="1dd48-132">Line Number</span></span>|<span data-ttu-id="1dd48-133">Modelo</span><span class="sxs-lookup"><span data-stu-id="1dd48-133">Model</span></span>|  
|---------------|-----------------|-----------|  
|<span data-ttu-id="1dd48-134">1</span><span class="sxs-lookup"><span data-stu-id="1dd48-134">1</span></span>||<span data-ttu-id="1dd48-135">Mountain-200</span><span class="sxs-lookup"><span data-stu-id="1dd48-135">Mountain-200</span></span>|  
  
 <span data-ttu-id="1dd48-136">O que significam esses resultados?</span><span class="sxs-lookup"><span data-stu-id="1dd48-136">What do these results mean?</span></span> <span data-ttu-id="1dd48-137">Lembre-se de que você não especificou entradas.</span><span class="sxs-lookup"><span data-stu-id="1dd48-137">Remember that you did not specify any inputs.</span></span> <span data-ttu-id="1dd48-138">Dessa forma, a previsão é feita em relação à toda a população de casos, e o Analysis Services retorna a previsão geral mais provável.</span><span class="sxs-lookup"><span data-stu-id="1dd48-138">Therefore, the prediction is made against the entire population of cases, and Analysis Services returns the most likely prediction overall.</span></span>  
  
### <a name="adding-inputs-to-a-singleton-prediction-query"></a><span data-ttu-id="1dd48-139">Adicionando entradas a uma consulta de previsão singleton</span><span class="sxs-lookup"><span data-stu-id="1dd48-139">Adding Inputs to a Singleton Prediction Query</span></span>  
 <span data-ttu-id="1dd48-140">Até agora, você não especificou entradas.</span><span class="sxs-lookup"><span data-stu-id="1dd48-140">Until now, you have not specified any inputs.</span></span> <span data-ttu-id="1dd48-141">Na próxima tarefa, você usará o painel **entrada de consulta singleton** para especificar algumas entradas para a consulta.</span><span class="sxs-lookup"><span data-stu-id="1dd48-141">In the next task, you will use the **Singleton Query Input** pane to specify some inputs to the query.</span></span> <span data-ttu-id="1dd48-142">Primeiro, use [Região] como uma entrada do modelo de clustering de sequências regional para determinar se as sequências previstas são iguais para todas as regiões.</span><span class="sxs-lookup"><span data-stu-id="1dd48-142">First, you will use [Region] as an input to the regional sequence clustering model, to determine whether the predicted sequences are the same for all regions.</span></span> <span data-ttu-id="1dd48-143">Assim, você aprenderá a modificar a consulta para adicionar a probabilidade de cada previsão e mesclar os resultados para facilitar sua exibição.</span><span class="sxs-lookup"><span data-stu-id="1dd48-143">You will then learn how to modify the query to add the probability for each prediction, and flatten the results to make them easier to view.</span></span>  
  
##### <a name="to-generate-predictions-for-a-specific-customer-group"></a><span data-ttu-id="1dd48-144">Para gerar previsões para um grupo de clientes específico</span><span class="sxs-lookup"><span data-stu-id="1dd48-144">To generate predictions for a specific customer group</span></span>  
  
1.  <span data-ttu-id="1dd48-145">Clique no botão **design** no canto superior esquerdo do construtor de consultas de previsão para voltar para a grade de construção da consulta.</span><span class="sxs-lookup"><span data-stu-id="1dd48-145">Click the **Design** button in the upper left-hand corner of the Prediction Query Builder to switch back to the query building grid.</span></span>  
  
2.  <span data-ttu-id="1dd48-146">Na caixa de diálogo **entrada de consulta singleton** , clique na caixa **valor** para `Region` e selecione **Europa**.</span><span class="sxs-lookup"><span data-stu-id="1dd48-146">In the **Singleton Query Input** dialog box, click the **Value** box for `Region`, and select **Europe**.</span></span>  
  
3.  <span data-ttu-id="1dd48-147">Clique no botão **resultado** para exibir previsões para clientes na Europa.</span><span class="sxs-lookup"><span data-stu-id="1dd48-147">Click the **Result** button to view predictions for customers in Europe.</span></span>  
  
4.  <span data-ttu-id="1dd48-148">Clique no botão **design** no canto superior esquerdo do construtor de consultas de previsão para voltar para a grade de construção da consulta.</span><span class="sxs-lookup"><span data-stu-id="1dd48-148">Click the **Design** button in the upper left-hand corner of the Prediction Query Builder to switch back to the query building grid.</span></span>  
  
5.  <span data-ttu-id="1dd48-149">Na caixa de diálogo **entrada de consulta singleton** , clique na caixa **valor** para e `Region` selecione **América do Norte**.</span><span class="sxs-lookup"><span data-stu-id="1dd48-149">In the **Singleton Query Input** dialog box, click the **Value** box for `Region`, and select **North America**.</span></span>  
  
6.  <span data-ttu-id="1dd48-150">Clique no botão **resultado** para exibir previsões para clientes em América do Norte.</span><span class="sxs-lookup"><span data-stu-id="1dd48-150">Click the **Result** button to view predictions for customers in North America.</span></span>  
  
### <a name="adding-probabilities-by-using-a-custom-expression"></a><span data-ttu-id="1dd48-151">Adicionando probabilidades usando uma expressão personalizada</span><span class="sxs-lookup"><span data-stu-id="1dd48-151">Adding Probabilities by Using a Custom Expression</span></span>  
 <span data-ttu-id="1dd48-152">Gerar a probabilidade de cada previsão é ligeiramente mais complicado, já que a probabilidade é um atributo da previsão e é gerada como uma tabela aninhada.</span><span class="sxs-lookup"><span data-stu-id="1dd48-152">To output the probability for each prediction is slightly more complicated, because the probability is an attribute of the prediction and is output as a nested table.</span></span> <span data-ttu-id="1dd48-153">Se você já conhece DMX (Data Mining Extensions), poderá alterar com facilidade a consulta e adicionar uma instrução de subseleção na tabela aninhada.</span><span class="sxs-lookup"><span data-stu-id="1dd48-153">If you are familiar with Data Mining Extensions (DMX), you can easily alter the query to add a sub-select statement on the nested table.</span></span> <span data-ttu-id="1dd48-154">No entanto, você também poderá criar uma instrução de subseleção no Construtor de Consultas de Previsão ao adicionar uma expressão personalizada.</span><span class="sxs-lookup"><span data-stu-id="1dd48-154">However, you can also create a sub-select statement in the Prediction Query Builder by adding a custom expression.</span></span>  
  
##### <a name="to-output-probabilities-for-a-predicted-sequence-by-using-a-custom-expression"></a><span data-ttu-id="1dd48-155">Para gerar probabilidades para uma sequência prevista usando uma expressão personalizada</span><span class="sxs-lookup"><span data-stu-id="1dd48-155">To output probabilities for a predicted sequence by using a custom expression</span></span>  
  
1.  <span data-ttu-id="1dd48-156">Clique no botão **design** no canto superior esquerdo do construtor de consultas de previsão para voltar para a grade de construção da consulta.</span><span class="sxs-lookup"><span data-stu-id="1dd48-156">Click the **Design** button in the upper left-hand corner of the Prediction Query Builder to switch back to the query building grid.</span></span>  
  
2.  <span data-ttu-id="1dd48-157">Na grade, em **origem**, clique em uma nova linha e selecione **expressão personalizada**.</span><span class="sxs-lookup"><span data-stu-id="1dd48-157">In the grid, under **Source**, click a new row, and select **Custom Expression**.</span></span>  
  
3.  <span data-ttu-id="1dd48-158">Deixe a caixa sob o **campo** em branco.</span><span class="sxs-lookup"><span data-stu-id="1dd48-158">Leave the box under **Field** blank.</span></span>  
  
4.  <span data-ttu-id="1dd48-159">Para **alias**, digite `t` .</span><span class="sxs-lookup"><span data-stu-id="1dd48-159">For **Alias**, type `t`.</span></span>  
  
5.  <span data-ttu-id="1dd48-160">Na caixa **critérios/argumento** , digite a instrução de subseleção completa, conforme mostrado no exemplo de código a seguir.</span><span class="sxs-lookup"><span data-stu-id="1dd48-160">In the **Criteria/Argument** box, type the complete sub-select statement as shown in the following code sample.</span></span> <span data-ttu-id="1dd48-161">Não se esqueça de incluir os parênteses inicial e final.</span><span class="sxs-lookup"><span data-stu-id="1dd48-161">Be sure to include the starting and ending parentheses.</span></span>  
  
    ```  
    (SELECT PredictProbability([Model]) FROM PredictSequence([Sequence Clustering with Region].[v Assoc Seq Line Items]))  
    ```  
  
6.  <span data-ttu-id="1dd48-162">Clique no botão **resultado** para exibir previsões para clientes na Europa.</span><span class="sxs-lookup"><span data-stu-id="1dd48-162">Click the **Result** button to view predictions for customers in Europe.</span></span>  
  
 <span data-ttu-id="1dd48-163">Agora, os resultados contêm duas tabelas aninhadas, uma com a previsão e outra com a probabilidade da previsão.</span><span class="sxs-lookup"><span data-stu-id="1dd48-163">The results now contain two nested tables, one with the prediction, and one with the probability for the prediction.</span></span> <span data-ttu-id="1dd48-164">Se a consulta não funcionar, você poderá alternar para o modo de design e examinar a instrução completa da consulta, que deve ser assim:</span><span class="sxs-lookup"><span data-stu-id="1dd48-164">If the query does not work, you can switch to query design view and review the complete query statement, which should be as follows:</span></span>  
  
```  
SELECT  
  PredictSequence([Sequence Clustering with Region].[v Assoc Seq Line Items]),  
  ( (SELECT PredictProbability([Model]) FROM PredictSequence([Sequence Clustering with Region].[v Assoc Seq Line Items]))) as [t]  
FROM  
  [Sequence Clustering with Region]  
NATURAL PREDICTION JOIN  
(SELECT 'Europe' AS [Region]) AS t  
```  
  
### <a name="working-with-results"></a><span data-ttu-id="1dd48-165">Trabalhando com resultados</span><span class="sxs-lookup"><span data-stu-id="1dd48-165">Working with Results</span></span>  
 <span data-ttu-id="1dd48-166">Quando houver muitas tabelas aninhadas nos resultados, talvez seja melhor mesclá-los para obter uma exibição melhor.</span><span class="sxs-lookup"><span data-stu-id="1dd48-166">When there are many nested tables in the results, you might want to flatten the results for easier viewing.</span></span> <span data-ttu-id="1dd48-167">Para isso, modifique a consulta manualmente e adicione a palavra-chave `FLATTENED`.</span><span class="sxs-lookup"><span data-stu-id="1dd48-167">To do this, you can manually modify the query and add the `FLATTENED` keyword.</span></span>  
  
##### <a name="to-flatten-nested-rowsets-in-a-prediction-query"></a><span data-ttu-id="1dd48-168">Para mesclar conjuntos de linhas aninhadas em uma consulta de previsão</span><span class="sxs-lookup"><span data-stu-id="1dd48-168">To flatten nested rowsets in a prediction query</span></span>  
  
1.  <span data-ttu-id="1dd48-169">Clique no botão **consulta** no canto do construtor de consultas de previsão.</span><span class="sxs-lookup"><span data-stu-id="1dd48-169">Click the **Query** button in the corner of the Prediction Query Builder.</span></span>  
  
     <span data-ttu-id="1dd48-170">A grade se transformará em um painel aberto, onde você poderá exibir e modificar a instrução DMX criada pelo Construtor de Consultas de Previsão.</span><span class="sxs-lookup"><span data-stu-id="1dd48-170">The grid changes to an open pane where you can view and modify the DMX statement that was created by the Prediction Query Builder.</span></span>  
  
2.  <span data-ttu-id="1dd48-171">Após a palavra-chave `SELECT`, digite `FLATTENED`.</span><span class="sxs-lookup"><span data-stu-id="1dd48-171">After the `SELECT` keyword, type `FLATTENED`.</span></span>  
  
     <span data-ttu-id="1dd48-172">O texto completo da consulta deve ser similar ao seguinte:</span><span class="sxs-lookup"><span data-stu-id="1dd48-172">The complete text of the query should be similar to the following:</span></span>  
  
    ```  
    SELECT FLATTENED  
      PredictSequence([Sequence Clustering with Region].[v Assoc Seq Line Items]),  
      ( (SELECT PredictProbability([Model]) FROM PredictSequence([Sequence Clustering with Region].[v Assoc Seq Line Items]))) as [t]  
    FROM  
      [Sequence Clustering with Region]  
    NATURAL PREDICTION JOIN  
    (SELECT 'Europe' AS [Region]) AS t  
    ```  
  
3.  <span data-ttu-id="1dd48-173">Clique no botão **resultados** no canto superior do construtor de consultas de previsão.</span><span class="sxs-lookup"><span data-stu-id="1dd48-173">Click the **Results** button in the upper corner of the Prediction Query Builder.</span></span>  
  
 <span data-ttu-id="1dd48-174">Depois de editar manualmente uma consulta, você não conseguirá voltar ao modo Design sem perder as alterações.</span><span class="sxs-lookup"><span data-stu-id="1dd48-174">After you have manually edited a query, you will not be able to switch back to Design view without losing the changes.</span></span> <span data-ttu-id="1dd48-175">No entanto, é possível salvar a instrução DMX criada manualmente em um arquivo de texto e então voltar para o modo Design.</span><span class="sxs-lookup"><span data-stu-id="1dd48-175">You can, however, save the DMX statement that you created manually to a text file, and then change back to Design view.</span></span> <span data-ttu-id="1dd48-176">Quando você fizer isso, a consulta será revertida para a última versão válida do modo Design.</span><span class="sxs-lookup"><span data-stu-id="1dd48-176">When you do so, the query is reverted to the last version that was valid in Design view.</span></span>  
  
## <a name="creating-predictions-on-the-related-model"></a><span data-ttu-id="1dd48-177">Criando previsões em um modelo relacionado</span><span class="sxs-lookup"><span data-stu-id="1dd48-177">Creating Predictions on the Related Model</span></span>  
 <span data-ttu-id="1dd48-178">Os exemplos anteriores usaram uma coluna da tabela de casos, Região, como a entrada da consulta de previsão singleton, porque você estava interessado em saber se o modelo encontrou diferenças entre regiões.</span><span class="sxs-lookup"><span data-stu-id="1dd48-178">The previous examples used a case table column, Region, as the input to the singleton prediction query, because you were interested in knowing whether the model had found any differences between regions.</span></span> <span data-ttu-id="1dd48-179">No entanto, depois de explorar o modelo, você decidiu que as diferenças não são significativas o suficiente para justificar recomendações de personalização de produtos por região.</span><span class="sxs-lookup"><span data-stu-id="1dd48-179">However, after exploring the model, you decided that the differences are not strong enough to justify customizing product recommendations by region.</span></span> <span data-ttu-id="1dd48-180">O que realmente interessa a você na previsão são os itens selecionados pelos clientes.</span><span class="sxs-lookup"><span data-stu-id="1dd48-180">What you are really interested in predicting is the items that customers select.</span></span> <span data-ttu-id="1dd48-181">Dessa forma, nas consultas a seguir, você usará o modelo de clustering de sequências que não inclui Região para gerar recomendações para todos os clientes.</span><span class="sxs-lookup"><span data-stu-id="1dd48-181">Therefore, in the queries that follow, you will use the sequence clustering model that does not include Region, to generate recommendations for all customers.</span></span>  
  
### <a name="using-nested-table-columns-as-input"></a><span data-ttu-id="1dd48-182">Usando colunas da tabela aninhada como entrada</span><span class="sxs-lookup"><span data-stu-id="1dd48-182">Using Nested Table Columns as Input</span></span>  
 <span data-ttu-id="1dd48-183">Primeiro, você criará uma consulta de previsão singleton que obtém um único item como entrada e retorna o próximo item mais provável.</span><span class="sxs-lookup"><span data-stu-id="1dd48-183">First you will create a singleton prediction query that takes a single item as input and returns the next most likely item.</span></span> <span data-ttu-id="1dd48-184">Para obter uma previsão desse tipo, use uma coluna de tabela aninhada como o valor de entrada.</span><span class="sxs-lookup"><span data-stu-id="1dd48-184">To get a prediction of this kind, you have to use a nested table column as the input value.</span></span> <span data-ttu-id="1dd48-185">Isso acontece porque o atributo que está sendo previsto, Modelo, faz parte de uma tabela aninhada.</span><span class="sxs-lookup"><span data-stu-id="1dd48-185">This is because the attribute that you are predicting, Model, is part of a nested table.</span></span> <span data-ttu-id="1dd48-186">Analysis Services fornece a caixa de diálogo **entrada de tabela aninhada** para ajudá-lo a criar facilmente consultas de previsão em atributos de tabela aninhada, usando o construtor de consultas de previsão.</span><span class="sxs-lookup"><span data-stu-id="1dd48-186">Analysis Services provides the **Nested Table Input** dialog box to help you easily create prediction queries on nested table attributes, by using the Prediction Query Builder.</span></span>  
  
##### <a name="to-use-a-nested-table-as-input-to-a-prediction"></a><span data-ttu-id="1dd48-187">Para usar uma tabela aninhada como entrada para uma previsão</span><span class="sxs-lookup"><span data-stu-id="1dd48-187">To use a nested table as input to a prediction</span></span>  
  
1.  <span data-ttu-id="1dd48-188">Clique no botão **design** no canto superior esquerdo do construtor de consultas de previsão para voltar para a grade de construção da consulta.</span><span class="sxs-lookup"><span data-stu-id="1dd48-188">Click the **Design** button in the upper left-hand corner of the Prediction Query Builder to switch back to the query building grid.</span></span>  
  
2.  <span data-ttu-id="1dd48-189">Na caixa de diálogo **entrada de consulta singleton** , clique na caixa **valor** para e `Region` Selecione a linha vazia para limpar a entrada desse campo.</span><span class="sxs-lookup"><span data-stu-id="1dd48-189">In the **Singleton Query Input** dialog box, click the **Value** box for `Region`, and select the empty row to clear the input for this field.</span></span>  
  
3.  <span data-ttu-id="1dd48-190">Na caixa de diálogo **entrada de consulta singleton** , clique na caixa **valor** para e, em `vAssocSeqLineItems` seguida, clique no botão (...).</span><span class="sxs-lookup"><span data-stu-id="1dd48-190">In the **Singleton Query Input** dialog box, click the **Value** box for `vAssocSeqLineItems`, and then click the (...) button.</span></span>  
  
4.  <span data-ttu-id="1dd48-191">Na caixa de diálogo **entrada de tabela aninhada** , clique em **Adicionar**.</span><span class="sxs-lookup"><span data-stu-id="1dd48-191">In the **Nested Table Input** dialog box, click **Add**.</span></span>  
  
5.  <span data-ttu-id="1dd48-192">Na nova linha, clique na caixa em `Model` e selecione aro de passeio na lista.</span><span class="sxs-lookup"><span data-stu-id="1dd48-192">In the new row, click the box under `Model`, and select Touring Tire from the list.</span></span> <span data-ttu-id="1dd48-193">Clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="1dd48-193">Click **OK**.</span></span>  
  
6.  <span data-ttu-id="1dd48-194">Clique no botão **resultado** para exibir as previsões.</span><span class="sxs-lookup"><span data-stu-id="1dd48-194">Click the **Result** button to view the predictions.</span></span>  
  
 <span data-ttu-id="1dd48-195">O modelo recomenda os itens a seguir para todos os clientes que escolherem Pneu de Passeio como o primeiro item.</span><span class="sxs-lookup"><span data-stu-id="1dd48-195">The model recommends the following next items for all customers who choose the Touring Tire as the first item.</span></span> <span data-ttu-id="1dd48-196">Você já sabe, pela exploração do modelo, que os clientes frequentemente compram os produtos Pneu de Passeio e Tubo de Pneu para Passeio juntos e, portanto, essas recomendações parecem boas.</span><span class="sxs-lookup"><span data-stu-id="1dd48-196">You already know from exploring the model that customers frequently purchase the products Touring Tire and Touring Tire Tube together, so these recommendations look good.</span></span>  
  
|<span data-ttu-id="1dd48-197">$SEQUENCE</span><span class="sxs-lookup"><span data-stu-id="1dd48-197">$SEQUENCE</span></span>|<span data-ttu-id="1dd48-198">Número da Linha</span><span class="sxs-lookup"><span data-stu-id="1dd48-198">Line Number</span></span>|<span data-ttu-id="1dd48-199">Modelo</span><span class="sxs-lookup"><span data-stu-id="1dd48-199">Model</span></span>|  
|---------------|-----------------|-----------|  
|<span data-ttu-id="1dd48-200">1</span><span class="sxs-lookup"><span data-stu-id="1dd48-200">1</span></span>||<span data-ttu-id="1dd48-201">Tubo de pneu para passeio</span><span class="sxs-lookup"><span data-stu-id="1dd48-201">Touring Tire Tube</span></span>|  
|<span data-ttu-id="1dd48-202">2</span><span class="sxs-lookup"><span data-stu-id="1dd48-202">2</span></span>||<span data-ttu-id="1dd48-203">Sport-100</span><span class="sxs-lookup"><span data-stu-id="1dd48-203">Sport-100</span></span>|  
|<span data-ttu-id="1dd48-204">3</span><span class="sxs-lookup"><span data-stu-id="1dd48-204">3</span></span>||<span data-ttu-id="1dd48-205">Jersey Logo de manga longa</span><span class="sxs-lookup"><span data-stu-id="1dd48-205">Long-Sleeve Logo Jersey</span></span>|  
  
### <a name="creating-a-bulk-prediction-query-using-nested-table-inputs"></a><span data-ttu-id="1dd48-206">Criando uma consulta de previsão em massa usando entradas de tabela aninhada</span><span class="sxs-lookup"><span data-stu-id="1dd48-206">Creating a Bulk Prediction Query using Nested Table Inputs</span></span>  
 <span data-ttu-id="1dd48-207">Agora que você já está satisfeito com o modelo que cria o tipo de previsões que poderão ser usadas em recomendações, crie uma consulta de previsão mapeada para uma fonte de dados externa.</span><span class="sxs-lookup"><span data-stu-id="1dd48-207">Now that you are satisfied that the model creates the kind of predictions that you can use in making recommendations, you will create a prediction query that is mapped to an external data source.</span></span> <span data-ttu-id="1dd48-208">Essa fonte de dados fornecerá valores que representam produtos atuais.</span><span class="sxs-lookup"><span data-stu-id="1dd48-208">That data source will provide values representing current products.</span></span> <span data-ttu-id="1dd48-209">Como você está interessado na criação de uma consulta de previsão que ofereça ID do Cliente e uma lista de produtos como entrada, adicione a tabela de clientes como uma tabela de caso e a tabela de compras como a tabela aninhada.</span><span class="sxs-lookup"><span data-stu-id="1dd48-209">Because you are interested in creating a prediction query that provides Customer ID and a list of products as input, you will add the customer table as the case table, and the purchases table as the nested table.</span></span> <span data-ttu-id="1dd48-210">Em seguida, adicione funções de previsão, como feito anteriormente, para criar recomendações.</span><span class="sxs-lookup"><span data-stu-id="1dd48-210">Then you will add prediction functions as you did previously to create recommendations.</span></span>  
  
 <span data-ttu-id="1dd48-211">Esse procedimento é igual ao usado na criação de previsões para o cenário de cesta de compras da Lição 3; no entanto, em um modelo de clustering de sequências, as previsões também precisam do pedido como entrada.</span><span class="sxs-lookup"><span data-stu-id="1dd48-211">This is the same procedure that you use to create predictions for the market basket scenario in Lesson 3; however, in a sequence clustering model predictions also need the order as input.</span></span>  
  
##### <a name="to-create-a-prediction-query-using-nested-table-inputs"></a><span data-ttu-id="1dd48-212">Para criar uma consulta de previsão usando entradas de tabela aninhada</span><span class="sxs-lookup"><span data-stu-id="1dd48-212">To create a prediction query using nested table inputs</span></span>  
  
1.  <span data-ttu-id="1dd48-213">No painel **modelo de mineração** , selecione o modelo de clustering de sequência, se ainda não estiver selecionado.</span><span class="sxs-lookup"><span data-stu-id="1dd48-213">In the **Mining Model** pane, select the Sequence Clustering model, if it is not already selected.</span></span>  
  
2.  <span data-ttu-id="1dd48-214">Na caixa de diálogo **selecionar tabela (s) de entrada** , clique em **selecionar tabela de casos**.</span><span class="sxs-lookup"><span data-stu-id="1dd48-214">In the **Select Input Table(s)** dialog box, click **Select Case Table**.</span></span>  
  
3.  <span data-ttu-id="1dd48-215">Na caixa de diálogo **selecionar tabela** , para fonte de dados, selecione pedidos.</span><span class="sxs-lookup"><span data-stu-id="1dd48-215">In the **Select Table** dialog box, for Data Source, select Orders.</span></span> <span data-ttu-id="1dd48-216">Na lista **nome da tabela/exibição** , selecione vAssocSeqOrders e clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="1dd48-216">In the **Table/View Name** list, select vAssocSeqOrders, and then click **OK**.</span></span>  
  
4.  <span data-ttu-id="1dd48-217">Na caixa de diálogo **selecionar tabela (s) de entrada** , clique em **selecionar tabela aninhada**.</span><span class="sxs-lookup"><span data-stu-id="1dd48-217">In the **Select Input Table(s)** dialog box, click **Select Nested Table**.</span></span>  
  
5.  <span data-ttu-id="1dd48-218">Na caixa de diálogo **selecionar tabela** , para **fonte de dados**, selecione pedidos.</span><span class="sxs-lookup"><span data-stu-id="1dd48-218">In the **Select Table** dialog box, for **Data Source**, select Orders.</span></span> <span data-ttu-id="1dd48-219">Na lista **nome da tabela/exibição** , selecione vAssocSeqLineItems e clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="1dd48-219">In the **Table/View name** list, select vAssocSeqLineItems, and then click **OK**.</span></span>  
  
     <span data-ttu-id="1dd48-220">O Analysis Services tentará detectar relacionamentos e os criará automaticamente, caso os tipos de dados forem iguais e se os nomes de colunas forem similares.</span><span class="sxs-lookup"><span data-stu-id="1dd48-220">Analysis Services will try to detect relationships and create them automatically if the data types match and the column names are similar.</span></span> <span data-ttu-id="1dd48-221">Se as relações que ele cria estiverem erradas, você poderá clicar com o botão direito do mouse na linha de junção e selecionar **Modificar Conexões** para editar o mapeamento de coluna ou clicar com o botão direito do mouse na linha de junção e selecionar **excluir** para remover completamente a relação.</span><span class="sxs-lookup"><span data-stu-id="1dd48-221">If the relationships that it creates are wrong, you can right-click the join line and select **Modify Connections** to edit the column mapping, or you can right-click the join line and select **Delete** to remove the relationship completely.</span></span> <span data-ttu-id="1dd48-222">Nesse caso, como as tabelas já foram unidas na exibição da fonte de dados, esses relacionamentos serão automaticamente adicionados ao painel de design.</span><span class="sxs-lookup"><span data-stu-id="1dd48-222">In this case, because the tables were already joined in the data source view, those relationships are automatically added to the design pane.</span></span>  
  
6.  <span data-ttu-id="1dd48-223">Adicione uma nova linha à grade.</span><span class="sxs-lookup"><span data-stu-id="1dd48-223">Add a new row to the grid.</span></span> <span data-ttu-id="1dd48-224">Para **origem**, selecione vAssocSeqOrders e, para **campo**, selecione CustomerKey.</span><span class="sxs-lookup"><span data-stu-id="1dd48-224">For **Source**, select vAssocSeqOrders, and for **Field**, select CustomerKey.</span></span>  
  
7.  <span data-ttu-id="1dd48-225">Adicione uma nova linha à grade.</span><span class="sxs-lookup"><span data-stu-id="1dd48-225">Add a new row to the grid.</span></span> <span data-ttu-id="1dd48-226">Para **origem**, selecione **função de previsão**e, para **campo**, selecione **PredictSequence**.</span><span class="sxs-lookup"><span data-stu-id="1dd48-226">For **Source**, select **Prediction Function**, and for **Field**, select **PredictSequence**.</span></span>  
  
8.  <span data-ttu-id="1dd48-227">Arraste vAssocSeqLineItems para a caixa **critérios/argumento** .</span><span class="sxs-lookup"><span data-stu-id="1dd48-227">Drag vAssocSeqLineItems, into the **Criteria/Argument** box.</span></span> <span data-ttu-id="1dd48-228">Clique no final da caixa **critérios/argumento** e digite os seguintes argumentos: `2` .</span><span class="sxs-lookup"><span data-stu-id="1dd48-228">Click at the end of the **Criteria/Argument** box and then type the following arguments: `2`.</span></span>  
  
     <span data-ttu-id="1dd48-229">O texto completo na caixa **critérios/argumento** deve ser:`[Sequence Clustering].[v Assoc Seq Line Items],2`</span><span class="sxs-lookup"><span data-stu-id="1dd48-229">The complete text in the **Criteria/Argument** box should be: `[Sequence Clustering].[v Assoc Seq Line Items],2`</span></span>  
  
9. <span data-ttu-id="1dd48-230">Clique no botão **resultado** para exibir as previsões para cada cliente.</span><span class="sxs-lookup"><span data-stu-id="1dd48-230">Click the **Result** button to view the predictions for each customer.</span></span>  
  
 <span data-ttu-id="1dd48-231">Você concluiu o tutorial sobre modelos de clustering de sequências.</span><span class="sxs-lookup"><span data-stu-id="1dd48-231">You have completed the tutorial on sequence clustering models.</span></span>  
  
## <a name="next-steps"></a><span data-ttu-id="1dd48-232">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="1dd48-232">Next Steps</span></span>  
 <span data-ttu-id="1dd48-233">Se você tiver concluído todas as seções no [tutorial de mineração de dados intermediário &#40;Analysis Services&#41;de mineração de dados ](../../2014/tutorials/intermediate-data-mining-tutorial-analysis-services-data-mining.md), a próxima etapa poderá ser aprender a usar as instruções DMX (Data Mining Extensions) para criar modelos e gerar previsões.</span><span class="sxs-lookup"><span data-stu-id="1dd48-233">If you have finished all the sections in the [Intermediate Data Mining Tutorial &#40;Analysis Services - Data Mining&#41;](../../2014/tutorials/intermediate-data-mining-tutorial-analysis-services-data-mining.md), the next step might be to learn to use Data Mining Extensions (DMX) statements to build models and generate predictions.</span></span> <span data-ttu-id="1dd48-234">Para obter mais informações, consulte [criando e consultando modelos de mineração de dados com DMX: tutoriais &#40;Analysis Services&#41;de mineração de dados ](../../2014/tutorials/create-query-data-mining-models-dmx-tutorials.md).</span><span class="sxs-lookup"><span data-stu-id="1dd48-234">For more information, see [Creating and Querying Data Mining Models with DMX: Tutorials &#40;Analysis Services - Data Mining&#41;](../../2014/tutorials/create-query-data-mining-models-dmx-tutorials.md).</span></span>  
  
 <span data-ttu-id="1dd48-235">Se você já conhece conceitos de programação, também poderá usar Objetos de Gerenciamento de Análise (AMO) para começar a trabalhar com objetos de mineração de dados programaticamente.</span><span class="sxs-lookup"><span data-stu-id="1dd48-235">If you are familiar with programming concepts, you can also use Analysis Management Objects (AMO) to programmatically work with data mining objects.</span></span> <span data-ttu-id="1dd48-236">Para obter mais informações, consulte [Classes de mineração de dados AMO](https://docs.microsoft.com/bi-reference/amo/amo-data-mining-classes).</span><span class="sxs-lookup"><span data-stu-id="1dd48-236">For more information, see [AMO Data Mining Classes](https://docs.microsoft.com/bi-reference/amo/amo-data-mining-classes).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1dd48-237">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="1dd48-237">See Also</span></span>  
 <span data-ttu-id="1dd48-238">[Exemplos de consulta de modelo de clustering de sequência](../../2014/analysis-services/data-mining/sequence-clustering-model-query-examples.md) </span><span class="sxs-lookup"><span data-stu-id="1dd48-238">[Sequence Clustering Model Query Examples](../../2014/analysis-services/data-mining/sequence-clustering-model-query-examples.md) </span></span>  
 [<span data-ttu-id="1dd48-239">Conteúdo do modelo de mineração para modelos de clustering de sequência &#40;Analysis Services – Data Mining&#41;</span><span class="sxs-lookup"><span data-stu-id="1dd48-239">Mining Model Content for Sequence Clustering Models &#40;Analysis Services - Data Mining&#41;</span></span>](../../2014/analysis-services/data-mining/mining-model-content-for-sequence-clustering-models.md)  
  
  
