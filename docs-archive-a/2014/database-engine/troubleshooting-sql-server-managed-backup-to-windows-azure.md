---
title: Solução de problemas SQL Server Backup gerenciado para o Azure | Microsoft Docs
description: Este artigo descreve as tarefas e ferramentas que podem ser usadas para solucionar erros que podem ocorrer durante SQL Server Backup gerenciado para Microsoft Azure operações.
ms.custom: ''
ms.date: 03/08/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: backup-restore
ms.topic: conceptual
ms.assetid: a34d35b0-48eb-4ed1-9f19-ea14754650da
author: mashamsft
ms.author: mathoma
ms.openlocfilehash: 9c7ed5dd25ed2b02445bfae5eb78ac03b2270552
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87681063"
---
# <a name="troubleshooting-sql-server-managed--backup-to-azure"></a><span data-ttu-id="e3910-103">Solucionar problemas de backup gerenciado do SQL Server para Azure</span><span class="sxs-lookup"><span data-stu-id="e3910-103">Troubleshooting SQL Server Managed  Backup to Azure</span></span>
  <span data-ttu-id="e3910-104">Este tópico descreve as tarefas e as ferramentas que você pode usar para solucionar erros que podem ocorrer durante as operações do [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e3910-104">This topic describes the tasks and tools you can use to troubleshoot errors that may occur during [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] operations.</span></span>  
  
## <a name="overview"></a><span data-ttu-id="e3910-105">Visão geral</span><span class="sxs-lookup"><span data-stu-id="e3910-105">Overview</span></span>  
 <span data-ttu-id="e3910-106">O [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] tem verificações internas e soluções de problemas; portanto, em muitos casos, as falhas internas são administradas pelo próprio processo do [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e3910-106">[!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] has built in checks and troubleshooting, so in many cases internal failures are taken care of by [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] process itself.</span></span>  
  
 <span data-ttu-id="e3910-107">Um exemplo de tal caso é uma exclusão de um arquivo de backup, resultando em uma interrupção da cadeia de logs que afeta a capacidade de recuperação – [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] identificará a interrupção na cadeia de logs e agendará um backup para ser levado imediatamente.</span><span class="sxs-lookup"><span data-stu-id="e3910-107">Example of one such case is a deletion of a backup file resulting in a break of the log chain affecting recoverability - [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] will identify the break in log chain and schedule a backup to be taken immediately.</span></span> <span data-ttu-id="e3910-108">No entanto, recomendamos que você monitore o status e aborde todos os erros que requerem intervenção manual.</span><span class="sxs-lookup"><span data-stu-id="e3910-108">However we recommend that you monitor the status and address any errors that require manual intervention.</span></span>  
  
 <span data-ttu-id="e3910-109">O [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] registra eventos e erros usando procedimentos armazenados do sistema, exibições de sistema e eventos estendidos.</span><span class="sxs-lookup"><span data-stu-id="e3910-109">[!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] logs events and errors using system stored procedures, system views and extended events.</span></span> <span data-ttu-id="e3910-110">As exibições do sistema e os procedimentos armazenados fornecem informações de configuração do [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)], status de backups agendados e os erros capturados pelos Eventos Estendidos.</span><span class="sxs-lookup"><span data-stu-id="e3910-110">System views and stored procedures provide [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] configuration information, status of backup scheduled backups, and also the errors captured by Extended Events.</span></span> <span data-ttu-id="e3910-111">O [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] usa os Eventos Estendidos para capturar os erros a serem usados na solução de problemas.</span><span class="sxs-lookup"><span data-stu-id="e3910-111">[!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] uses Extended Events to capture the errors to use for troubleshooting.</span></span> <span data-ttu-id="e3910-112">Além de registrar eventos, as Políticas de Administrador Inteligentes do SQL Server fornecem um status de integridade que é usado por um trabalho de notificação por email para fornecer notificações ou informar sobre erros e problemas.</span><span class="sxs-lookup"><span data-stu-id="e3910-112">In addition to logging events, SQL Server Smart Admin Policies provide a health status which is used by an email notification job to provide notification or errors and issues.</span></span> <span data-ttu-id="e3910-113">Para obter mais informações, consulte [monitorar SQL Server Backup gerenciado no Azure](../relational-databases/backup-restore/sql-server-managed-backup-to-microsoft-azure.md).</span><span class="sxs-lookup"><span data-stu-id="e3910-113">For more information see [Monitor SQL Server Managed Backup to Azure](../relational-databases/backup-restore/sql-server-managed-backup-to-microsoft-azure.md).</span></span>  
  
 [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)]<span data-ttu-id="e3910-114">também usa o mesmo log que é usado ao fazer backup manual do armazenamento do Azure (SQL Server Backup para URL).</span><span class="sxs-lookup"><span data-stu-id="e3910-114">also uses the same logging that is used when manually backing up to Azure storage (SQL Server Backup to URL).</span></span> <span data-ttu-id="e3910-115">Para obter mais informações sobre problemas relacionados ao backup em URL, consulte a seção solução de problemas em [SQL Server Backup to URL Best Practices and Troubleshooting](../relational-databases/backup-restore/sql-server-backup-to-url-best-practices-and-troubleshooting.md)</span><span class="sxs-lookup"><span data-stu-id="e3910-115">For more information on Backup to URL related issues, see the troubleshooting section in [SQL Server Backup to URL Best Practices and Troubleshooting](../relational-databases/backup-restore/sql-server-backup-to-url-best-practices-and-troubleshooting.md)</span></span>  
  
### <a name="general-troubleshooting-steps"></a><span data-ttu-id="e3910-116">Etapas gerais da solução de problemas</span><span class="sxs-lookup"><span data-stu-id="e3910-116">General Troubleshooting Steps</span></span>  
  
1.  <span data-ttu-id="e3910-117">Habilite a Notificação por Email para começar a receber emails de erros e avisos.</span><span class="sxs-lookup"><span data-stu-id="e3910-117">Enable Email Notification to start to receive emails for error and warnings.</span></span>  
  
     <span data-ttu-id="e3910-118">Se desejar, você também pode executar `smart_admin.fn_get_health_status` periodicamente para verificar os erros e as contagens de agregação.</span><span class="sxs-lookup"><span data-stu-id="e3910-118">Alternatively, you can also periodically run `smart_admin.fn_get_health_status` to check the aggregated errors and counts.</span></span> <span data-ttu-id="e3910-119">Por exemplo, `number_of_invalid_credential_errors` é o número de vezes em que o backup inteligente tentou um backup mas obteve um erro de credencial inválida.</span><span class="sxs-lookup"><span data-stu-id="e3910-119">For example, `number_of_invalid_credential_errors` is the number of times smart backup attempted a backup but got invalid credential error.</span></span> <span data-ttu-id="e3910-120">`Number_of_backup_loops` e `number_of_retention_loops` não são erros, mas indicam o número de vezes que o thread de backup e o thread de retenção verificaram a lista de bancos de dados.</span><span class="sxs-lookup"><span data-stu-id="e3910-120">`Number_of_backup_loops` and `number_of_retention_loops` are not errors; but they indicate the number of times backup thread and retention thread scanned the list of databases.</span></span> <span data-ttu-id="e3910-121">Normalmente, quando @begin_time e @end_time não são fornecidos, a função está mostrando as informações dos últimos 30 minutos e, normalmente, devemos ver valores diferentes de zero para essas duas colunas.</span><span class="sxs-lookup"><span data-stu-id="e3910-121">Typically, when @begin_time and @end_time are not provided, the function is showing the information from last 30 minutes, then we should normally see non-zero values for these two columns.</span></span> <span data-ttu-id="e3910-122">Se eles forem zero, o sistema está sobrecarregado ou não está respondendo.</span><span class="sxs-lookup"><span data-stu-id="e3910-122">If they are zero then it implies system overloaded or even system not responding.</span></span> <span data-ttu-id="e3910-123">Para obter mais informações, consulte a seção **solução de problemas do sistema** mais adiante neste tópico.</span><span class="sxs-lookup"><span data-stu-id="e3910-123">For more information, see **Troubleshooting System Issues** section later in this topic.</span></span>  
  
2.  <span data-ttu-id="e3910-124">Revise os logs de Eventos Estendidos para obter mais detalhes sobre erros e outros eventos associados.</span><span class="sxs-lookup"><span data-stu-id="e3910-124">Review the Extended Event logs to learn more details on the errors and other associated events.</span></span>  
  
3.  <span data-ttu-id="e3910-125">Use as informações nos logs para resolver o problema.</span><span class="sxs-lookup"><span data-stu-id="e3910-125">Use the information in the logs to resolve the issue.</span></span>  <span data-ttu-id="e3910-126">No caso de um problema ou erro do sistema, talvez seja necessário reiniciar o serviço ou o SQL Server Agent.</span><span class="sxs-lookup"><span data-stu-id="e3910-126">In case of a system issue or error, you may need to restart the service or SQL Server Agent.</span></span>  
  
### <a name="common-causes-of-errors"></a><span data-ttu-id="e3910-127">Causas comuns de erros</span><span class="sxs-lookup"><span data-stu-id="e3910-127">Common Causes of Errors</span></span>  
 <span data-ttu-id="e3910-128">Esta é a lista das causas comuns de falhas:</span><span class="sxs-lookup"><span data-stu-id="e3910-128">Following is the list of common causes resulting in failures:</span></span>  
  
1.  <span data-ttu-id="e3910-129">**Alterações na credencial SQL:** Se o nome da credencial usada pelo [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] for alterado ou se for excluído, o [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] não poderá fazer backups.</span><span class="sxs-lookup"><span data-stu-id="e3910-129">**Changes to SQL Credential:** If the name of the credential used by [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] is changed or if it is deleted, [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] will not be able to take backups.</span></span> <span data-ttu-id="e3910-130">A alteração deve ser aplicada aos parâmetros de configuração do [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e3910-130">The change should be applied to [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] configuration settings.</span></span>  
  
2.  <span data-ttu-id="e3910-131">**Alterações nos valores de chave de acesso de armazenamento:** Se os valores de chave de armazenamento forem alterados para a conta do Azure, mas a credencial do SQL não for atualizada com os novos valores, o [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] falhará ao autenticar no armazenamento e falhará no backup dos bancos de dados configurados para usar essa conta.</span><span class="sxs-lookup"><span data-stu-id="e3910-131">**Changes to storage access key values:** If the storage key values are changed for the Azure account, but SQL Credential is not updated with the new values, [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] will fail when authenticating to the storage, and fails to backup databases configured to use this account.</span></span>  
  
3.  <span data-ttu-id="e3910-132">**Alterações na conta de armazenamento do Azure:** Excluir ou renomear a conta de armazenamento sem alterações correspondentes à credencial do SQL causará [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] falha e nenhum backup será feito.</span><span class="sxs-lookup"><span data-stu-id="e3910-132">**Changes to Azure Storage Account:** Deleting or renaming storage account without corresponding changes to the SQL Credential will cause [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] to fail and no backups will be taken.</span></span> <span data-ttu-id="e3910-133">Se você excluir uma conta de armazenamento, verifique se os bancos de dados foram reconfigurados com informações válidas da conta de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="e3910-133">If you delete a storage account, ensure that the databases are reconfigured with valid storage account information.</span></span> <span data-ttu-id="e3910-134">Se uma conta de armazenamento for renomeada ou os valores de chave forem alterados, verifique se essas alterações são refletidas na Credencial do SQL usada pelo [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e3910-134">If a storage account is renamed or the key values are changed, ensure that these changes are reflected in the SQL Credential used by [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)].</span></span>  
  
4.  <span data-ttu-id="e3910-135">**Alterações nas propriedades do banco de dados:** As alterações nos modelos de recuperação ou a alteração do nome podem fazer com que os backups falhem.</span><span class="sxs-lookup"><span data-stu-id="e3910-135">**Changes to Database Properties:** Changes to recovery models or changing the name can cause backups to fail.</span></span>  
  
5.  <span data-ttu-id="e3910-136">**Alterações no modelo de recuperação:** Se o modelo de recuperação do banco de dados for alterado para simples de completo ou bulk-logged, os backups serão interrompidos e os bancos de dados serão ignorados pelo [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="e3910-136">**Changes to Recovery Model:** If the recovery model of the database is changed to simple from full or bulk-logged, backups will stop, and the databases will be skipped by [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)].</span></span> <span data-ttu-id="e3910-137">Para obter mais informações, consulte [SQL Server Backup gerenciado para o Azure: interoperabilidade e coexistência](../../2014/database-engine/sql-server-managed-backup-to-windows-azure-interoperability-and-coexistence.md)</span><span class="sxs-lookup"><span data-stu-id="e3910-137">For more information, see [SQL Server Managed Backup to Azure: Interoperability and Coexistence](../../2014/database-engine/sql-server-managed-backup-to-windows-azure-interoperability-and-coexistence.md)</span></span>  
  
### <a name="most-common-error-messages-and-solutions"></a><span data-ttu-id="e3910-138">Mensagens de erro e soluções mais comuns</span><span class="sxs-lookup"><span data-stu-id="e3910-138">Most Common Error Messages and Solutions</span></span>  
  
1.  <span data-ttu-id="e3910-139">**Erros ao habilitar ou configurar [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] :**</span><span class="sxs-lookup"><span data-stu-id="e3910-139">**Errors when enabling or configuring [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)]:**</span></span>  
  
     <span data-ttu-id="e3910-140">Erro: "falha ao acessar a URL de armazenamento.... Forneça uma credencial SQL válida... ": você pode ver que este e outros erros semelhantes referentes a credenciais do SQL.</span><span class="sxs-lookup"><span data-stu-id="e3910-140">Error: " Failed to access the storage URL.... Provide a valid SQL Credential..." : You may see this and other similar errors referring to SQL Credentials.</span></span>  <span data-ttu-id="e3910-141">Nesses casos, examine o nome da credencial do SQL que você forneceu e também as informações armazenadas na credencial do SQL – o nome da conta de armazenamento e a chave de acesso de armazenamento e certifique-se de que elas sejam atuais e válidas.</span><span class="sxs-lookup"><span data-stu-id="e3910-141">In such cases, review the name of the SQL Credential you provided, and also the information stored in the SQL Credential - the storage account name, and the storage access key and make sure that they are current and valid.</span></span>  
  
     <span data-ttu-id="e3910-142">Erro: "... Não é possível configurar o banco de dados... como ele é um banco de dados do sistema ": você verá esse erro se tentar habilitar o [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] para um banco de dados do sistema.</span><span class="sxs-lookup"><span data-stu-id="e3910-142">Error: "... cannot configure the database....because it is a system database": You will see this error if you try to enable [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] for a system database.</span></span>  <span data-ttu-id="e3910-143">O [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] não oferece suporte a backups para bancos de dados do sistema.</span><span class="sxs-lookup"><span data-stu-id="e3910-143">[!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] does not support backups for system databases.</span></span>  <span data-ttu-id="e3910-144">Para configurar o backup para um banco de dados do sistema, use outras tecnologias de Backup do SQL Server como planos de manutenção.</span><span class="sxs-lookup"><span data-stu-id="e3910-144">To configure backup for a system database use other SQL Server Backup technologies such as maintenance plans.</span></span>  
  
     <span data-ttu-id="e3910-145">Erro: "... Fornecer um período de retenção.... ": você poderá ver erros referentes ao período de retenção se não tiver especificado um período de retenção para o banco de dados ou instância quando estiver configurando esses valores pela primeira vez.</span><span class="sxs-lookup"><span data-stu-id="e3910-145">Error:" ... Provide a retention period...." : You may see errors regarding the retention period if you either have not specified a retention period for the database or instance when you are configuring these values for the first time.</span></span> <span data-ttu-id="e3910-146">Você também poderá consultar um erro se fornecer um valor diferente de um número entre 1 e 30.</span><span class="sxs-lookup"><span data-stu-id="e3910-146">You may also see an error if you provide a value other than a number between 1 and 30.</span></span> <span data-ttu-id="e3910-147">O valor permitido para o período de retenção é um número entre 1 e 30.</span><span class="sxs-lookup"><span data-stu-id="e3910-147">The allowed value for the retention period is a number between 1 and 30.</span></span>  
  
2.  <span data-ttu-id="e3910-148">**Erros de notificação por email:**</span><span class="sxs-lookup"><span data-stu-id="e3910-148">**Email Notification Errors:**</span></span>  
  
     <span data-ttu-id="e3910-149">Erro: "Database Mail não está habilitado..."-você verá esse erro se habilitar notificações por email, mas Database Mail não estiver configurado na instância.</span><span class="sxs-lookup"><span data-stu-id="e3910-149">Error: "Database Mail is not enabled..." - You will see this error if you enable e-mail notifications, but Database Mail is not configured on the instance.</span></span> <span data-ttu-id="e3910-150">Você deve configurar o Database Mail na instância para que possa receber a notificação sobre o status de integridade do [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e3910-150">You must configure Database Mail on the instance to be able to receive notification of the health status of [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)].</span></span> <span data-ttu-id="e3910-151">Para obter informações sobre como habilitar o Database Mail, consulte [configurar Database Mail](../relational-databases/database-mail/configure-database-mail.md).</span><span class="sxs-lookup"><span data-stu-id="e3910-151">For information about how to enable database mail, see [Configure Database Mail](../relational-databases/database-mail/configure-database-mail.md).</span></span> <span data-ttu-id="e3910-152">Você também deve habilitar o SQL Server Agent para usar o Database Mail para notificações.</span><span class="sxs-lookup"><span data-stu-id="e3910-152">You must also enable SQL Server Agent to use Database Mail for notifications.</span></span> <span data-ttu-id="e3910-153">Para obter mais informações, consulte [antes de começar](../relational-databases/database-mail/configure-sql-server-agent-mail-to-use-database-mail.md#BeforeYouBegin).</span><span class="sxs-lookup"><span data-stu-id="e3910-153">For more information, see [Before You Begin](../relational-databases/database-mail/configure-sql-server-agent-mail-to-use-database-mail.md#BeforeYouBegin).</span></span>  
  
     <span data-ttu-id="e3910-154">Esta é uma lista dos números de erro que você possivelmente verá e que estão associados às notificações por email:</span><span class="sxs-lookup"><span data-stu-id="e3910-154">Following is a list of error numbers you might see that are associated with email notifications:</span></span>  
  
    -   <span data-ttu-id="e3910-155">ErrorNumber: 45209</span><span class="sxs-lookup"><span data-stu-id="e3910-155">ErrorNumber: 45209</span></span>  
  
    -   <span data-ttu-id="e3910-156">ErrorNumber: 45210</span><span class="sxs-lookup"><span data-stu-id="e3910-156">ErrorNumber: 45210</span></span>  
  
    -   <span data-ttu-id="e3910-157">ErrorNumber: 45211</span><span class="sxs-lookup"><span data-stu-id="e3910-157">ErrorNumber: 45211</span></span>  
  
3.  <span data-ttu-id="e3910-158">**Erros de conectividade:**</span><span class="sxs-lookup"><span data-stu-id="e3910-158">**Connectivity Errors:**</span></span>  
  
    -   <span data-ttu-id="e3910-159">**Erros relacionados à conectividade do SQL:** Esses erros ocorrem quando há problemas ao se conectar à instância do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="e3910-159">**Errors Related to SQL Connectivity:** These errors happen when there are issues connecting to SQL Server instance.</span></span> <span data-ttu-id="e3910-160">Os eventos estendidos expõem esses tipos de erros pelo canal de administração.</span><span class="sxs-lookup"><span data-stu-id="e3910-160">The extended events expose these type of errors through the admin channel.</span></span> <span data-ttu-id="e3910-161">Veja a seguir os dois eventos estendidos que você pode consultar em busca de erros relacionados a esse tipo de problemas de conectividade:</span><span class="sxs-lookup"><span data-stu-id="e3910-161">Following are the two extended events that you might see for errors related to this type of connectivity issues:</span></span>  
  
         <span data-ttu-id="e3910-162">FileRetentionAdminXEvent com event_type = SqlError.</span><span class="sxs-lookup"><span data-stu-id="e3910-162">FileRetentionAdminXEvent with event_type = SqlError.</span></span> <span data-ttu-id="e3910-163">Para obter detalhes deste erro, consulte o error_code, error_message e stack_trace desse evento.</span><span class="sxs-lookup"><span data-stu-id="e3910-163">For details of this error, look at the error_code, error_message and stack_trace of that event.</span></span> <span data-ttu-id="e3910-164">O error_code é o número do erro de SqlException.</span><span class="sxs-lookup"><span data-stu-id="e3910-164">The error_code is the SqlException's error number.</span></span>  
  
         <span data-ttu-id="e3910-165">SmartBackupAdminXevent com as seguintes mensagens/prefixos de mensagem:</span><span class="sxs-lookup"><span data-stu-id="e3910-165">SmartBackupAdminXevent with the following messages/message prefixes:</span></span>  
  
         <span data-ttu-id="e3910-166">*"Ocorreu um erro interno ao configurar SQL Server Backup gerenciado para as configurações padrão do Azure para a instância. Erro pode ser transitório. "*</span><span class="sxs-lookup"><span data-stu-id="e3910-166">*"An internal error occurred while configuring SQL Server Managed Backup to Azure default settings for instance. Error might be transient."*</span></span>  
  
         <span data-ttu-id="e3910-167">*"Provavelmente está tendo problemas de conectividade com SQL Server. Ignorando o banco de dados na iteração atual. "*</span><span class="sxs-lookup"><span data-stu-id="e3910-167">*"Probably experiencing connectivity issues with SQL Server. Skipping database in the current iteration."*</span></span>  
  
         <span data-ttu-id="e3910-168">*"Falha ao consultar informações de uso do log. A falha pode ser transitória. Ignorando o banco de dados na iteração atual. "*</span><span class="sxs-lookup"><span data-stu-id="e3910-168">*"Querying log usage info failed. The failure might be transient. Skipping database in the current iteration."*</span></span>  
  
         <span data-ttu-id="e3910-169">*"Exceção SQL encontrada ao carregar os metadados do agente SSMBackup2WA. A falha pode ser transitória. A operação será repetida. "*</span><span class="sxs-lookup"><span data-stu-id="e3910-169">*"SQL exception encountered while loading SSMBackup2WA agent metadata. The failure might be transient. Operation will be retried."*</span></span>  
  
         <span data-ttu-id="e3910-170">*"SSMBackup2WA encontrou uma exceção SQL durante... "*</span><span class="sxs-lookup"><span data-stu-id="e3910-170">*"SSMBackup2WA encountered SQL exception while ... "*</span></span>  
  
    -   <span data-ttu-id="e3910-171">**Erros durante a conexão com a conta de armazenamento:**</span><span class="sxs-lookup"><span data-stu-id="e3910-171">**Errors Connecting to the storage account:**</span></span>  
  
         <span data-ttu-id="e3910-172">As exceções de armazenamento são relatadas em FileRetentionAdminXEvent com event_type = XstoreError.</span><span class="sxs-lookup"><span data-stu-id="e3910-172">Storage exceptions are reported in FileRetentionAdminXEvent with event_type = XstoreError.</span></span> <span data-ttu-id="e3910-173">Para obter detalhes do erro, consulte o error_message e stack_trace desse evento.</span><span class="sxs-lookup"><span data-stu-id="e3910-173">For details of the error, look at the error_message and stack_trace of that event.</span></span>  
  
         <span data-ttu-id="e3910-174">Como o Backup Gerenciado do SQL Server usa a tecnologia subjacente de Backup para URL, os erros relacionados à conectividade de armazenamento aplicam-se a ambos os recursos.</span><span class="sxs-lookup"><span data-stu-id="e3910-174">Since SQL Server Managed Backup uses the underlying Backup to URL technology, the errors related to storage connectivity apply to both the features.</span></span> <span data-ttu-id="e3910-175">Para obter mais informações sobre etapas de solução de problemas, consulte a **seção solução de problemas** do artigo [SQL Server práticas recomendadas de backup to URL e solução de problemas](../relational-databases/backup-restore/sql-server-backup-to-url-best-practices-and-troubleshooting.md) .</span><span class="sxs-lookup"><span data-stu-id="e3910-175">For more information on troubleshooting steps, see **troubleshooting section** of the [SQL Server Backup to URL Best Practices and Troubleshooting](../relational-databases/backup-restore/sql-server-backup-to-url-best-practices-and-troubleshooting.md) article.</span></span>  
  
### <a name="troubleshooting-system-issues"></a><span data-ttu-id="e3910-176">Solucionando problemas do sistema</span><span class="sxs-lookup"><span data-stu-id="e3910-176">Troubleshooting System Issues</span></span>  
 <span data-ttu-id="e3910-177">Estes são alguns cenários possíveis quando há um problema no sistema (SQL Server, SQL Server Agent) e seus efeitos no [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)]:</span><span class="sxs-lookup"><span data-stu-id="e3910-177">Following are some scenarios when there is an issue with the system (SQL Server, SQL Server Agent) and its effects on [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)]:</span></span>  
  
-   <span data-ttu-id="e3910-178">**Sqlservr.exe para de responder ou para de funcionar quando o [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] está em execução:** se SQL Server para de funcionar, o agente do SQL será desligado normalmente, [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] também parará e os eventos serão registrados no arquivo SQL Agent. out.</span><span class="sxs-lookup"><span data-stu-id="e3910-178">**Sqlservr.exe stops responding or stops working when [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] is running:** If SQL Server stops working, SQL Agent will gracefully shut down, [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] also stops and the events are logged in SQL Agent.out file.</span></span>  
  
     <span data-ttu-id="e3910-179">Se o SQL Server parar de responder, os eventos serão registrados no canal de administração.</span><span class="sxs-lookup"><span data-stu-id="e3910-179">If SQL Server stops responding, events are logged in the admin channel.</span></span>  <span data-ttu-id="e3910-180">Um exemplo do log de eventos:</span><span class="sxs-lookup"><span data-stu-id="e3910-180">An example of the event log:</span></span>  
  
     <span data-ttu-id="e3910-181">*Erro de SQL (mecanismo não respondendo ou Get sqlException: SqlException:* </span><span class="sxs-lookup"><span data-stu-id="e3910-181">*Sql Error (engine not responding or get sqlException: SqlException:* </span></span>  
     <span data-ttu-id="e3910-182">*código de erro, mensagem e StackTrace serão exibidos em um canal de administrador XEvent, junto com algumas informações adicionais, como:* </span><span class="sxs-lookup"><span data-stu-id="e3910-182">*error code, message and stacktrace will be displayed in an admin channel xevent, together with some extra information, such as :* </span></span>  
    <span data-ttu-id="e3910-183">*"Provavelmente está tendo problemas de conectividade com SQL Server. Ignorando o banco de dados na iteração atual "*</span><span class="sxs-lookup"><span data-stu-id="e3910-183">*"Probably experiencing connectivity issues with SQL Server. Skipping database in the current iteration"*</span></span>  
  
-   <span data-ttu-id="e3910-184">**O agente SQL para de responder ou para de funcionar quando o [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] está em execução:**</span><span class="sxs-lookup"><span data-stu-id="e3910-184">**SQL Agent stops responding or stops working when [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] is running:**</span></span>  
  
     <span data-ttu-id="e3910-185">Se o SQL Agent para de funcionar, o [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] também será interrompido e os eventos serão registrados no canal de administração.</span><span class="sxs-lookup"><span data-stu-id="e3910-185">If SQL Agent stops working, [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] also stops and events are logged in the admin channel.</span></span> <span data-ttu-id="e3910-186">Isso é semelhante aos cenários em que o SQL Server para de responder.</span><span class="sxs-lookup"><span data-stu-id="e3910-186">This is similar to the scenarios when SQL Server stops responding.</span></span>  
  
     <span data-ttu-id="e3910-187">Se o SQL Agent parar de responder, o [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] não poderá continuar as operações de backup, e os eventos serão registrados no canal de administração.</span><span class="sxs-lookup"><span data-stu-id="e3910-187">If SQL Agent stops responding, [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] will be unable to continue with backup operations, and events are logged in the admin channel.</span></span> <span data-ttu-id="e3910-188">Um exemplo do log de eventos:</span><span class="sxs-lookup"><span data-stu-id="e3910-188">An example of the event log:</span></span>  
  
     <span data-ttu-id="e3910-189">*Bloqueios de trabalho: consulte canal de administrador XEvents* </span><span class="sxs-lookup"><span data-stu-id="e3910-189">*Job hangs: see admin channel xevents* </span></span>  
    <span data-ttu-id="e3910-190">*"Uma atualização de progresso não foi recebida de SQL Server em mais de" + Constants. DBBackupInfoMsgMaxWaitTime + "horas para backup de banco de dados.   O backup de nuvem SSM continuará aguardando. "*</span><span class="sxs-lookup"><span data-stu-id="e3910-190">*"A progress update hasn't been received from SQL Server in more than " + Constants.DBBackupInfoMsgMaxWaitTime  + " hours for database backup.   SSM Cloud Backup will continue to wait."*</span></span>  
  
 <span data-ttu-id="e3910-191">Se você tiver habilitado a notificação por email, receberá uma notificação que inclui o **número de loops de backup** e o **número de loops de retenção**.</span><span class="sxs-lookup"><span data-stu-id="e3910-191">If you have enabled email notification, you will receive a notification which includes **Number of Backup Loops** and **Number of Retention Loops**.</span></span> <span data-ttu-id="e3910-192">Se o valor retornado na notificação para uma ou ambas as colunas for zero, isso pode ser uma indicação de que o sistema não está respondendo.</span><span class="sxs-lookup"><span data-stu-id="e3910-192">If the value returned in the notification for one or both of these two columns is zero, it could be an indication that the system is not responding.</span></span>  
  
> [!WARNING]  
>  <span data-ttu-id="e3910-193">Os processos internos que geram os resultados para o relatório supõem que os logs de diagnóstico de mecanismo estejam no mesmo local do log de erros do SQL Agent, que, por padrão, está na mesma pasta dos logs de erro da instância do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="e3910-193">The internal processes that generate the results for the report, assumes that the engine diagnostic logs are in the same location of SQL Agent error log, which by default is in the same folder as the error logs of the SQL Server instance.</span></span> <span data-ttu-id="e3910-194">Se os logs de diagnóstico do mecanismo forem movidos para um local diferente do local do log de erros do SQL Agent, o sistema não conseguirá localizar os logs de diagnóstico de backup e, consequentemente o relatório da notificação por email poderá não estar correto.</span><span class="sxs-lookup"><span data-stu-id="e3910-194">If the engine diagnostic logs are moved to a location other than SQL Agent error log location, the system is unable to find the smart backup diagnostic logs, and hence the report in the email notification may not be correct.</span></span> <span data-ttu-id="e3910-195">Por exemplo, você pode ver um valor **0** em todos os campos relatados, incluindo o número de loops de backup e o número de loops de retenção.</span><span class="sxs-lookup"><span data-stu-id="e3910-195">For example, you might see a value of **0** in all the fields reported including the Number of Backup Loops and Number of Retention Loops.</span></span> <span data-ttu-id="e3910-196">Neste caso onde os logs de diagnóstico são movidos para um local diferente, isso pode não significar que o sistema não esteja respondendo, mas que o sistema não consegue encontrar os logs.</span><span class="sxs-lookup"><span data-stu-id="e3910-196">In this case where the diagnostic logs are moved to a different location, it may not mean that the system is not responding, but that the system is unable to find the logs.</span></span> <span data-ttu-id="e3910-197">Primeiro, verifique se o local dos logs de diagnóstico e dos logs de erro do SQL Agent estão no mesmo local</span><span class="sxs-lookup"><span data-stu-id="e3910-197">Ensure that the location of the diagnostic logs and SQL Agent error logs are at the same location first.</span></span> <span data-ttu-id="e3910-198">Para verificar o local atual dos logs de diagnóstico, você pode usar [Sys. dm_os_server_diagnostics_log_configurations](/sql/relational-databases/system-dynamic-management-views/sys-dm-os-server-diagnostics-log-configurations).</span><span class="sxs-lookup"><span data-stu-id="e3910-198">To verify the current location of the diagnostic logs, you can use [sys.dm_os_server_diagnostics_log_configurations](/sql/relational-databases/system-dynamic-management-views/sys-dm-os-server-diagnostics-log-configurations).</span></span> <span data-ttu-id="e3910-199">A `path` coluna retorna o local atual dos logs de diagnóstico do mecanismo.</span><span class="sxs-lookup"><span data-stu-id="e3910-199">The `path` column returns the current location of the engine diagnostic logs.</span></span>  <span data-ttu-id="e3910-200">Ele deve estar na mesma pasta que os logs de erros do SQL Agent.</span><span class="sxs-lookup"><span data-stu-id="e3910-200">It should be in the same folder as the SQL Agent error logs.</span></span> <span data-ttu-id="e3910-201">Você pode obter o caminho do log de erros do SQL Agent usando o procedimento armazenado `dbo.sp_get_sqlagent_properties`.</span><span class="sxs-lookup"><span data-stu-id="e3910-201">You can get SQL Agent error log path using the `dbo.sp_get_sqlagent_properties` stored procedure.</span></span>  
  
 <span data-ttu-id="e3910-202">Verifique os logs de eventos estendidos para ver os detalhes dos erros.</span><span class="sxs-lookup"><span data-stu-id="e3910-202">Check the extended event logs to see details of the errors.</span></span> <span data-ttu-id="e3910-203">Corrija os erros ou reinicie o SQL Server Agent para resolver a situação.</span><span class="sxs-lookup"><span data-stu-id="e3910-203">fix the errors, or restart SQL Server Agent to correct the situation.</span></span>  
  
  
