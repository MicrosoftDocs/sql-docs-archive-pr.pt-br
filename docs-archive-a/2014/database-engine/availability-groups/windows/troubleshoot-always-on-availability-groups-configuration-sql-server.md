---
title: Solucionar problemas de configuração de Grupos de Disponibilidade AlwaysOn (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 01/31/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- troubleshooting [SQL Server], deploying
- Availability Groups [SQL Server], troubleshooting
- Availability Groups [SQL Server], configuring
ms.assetid: 8c222f98-7392-4faf-b7ad-5fb60ffa237e
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 165036ba539c3392b1944282bd9d6126eb471a97
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87685286"
---
# <a name="troubleshoot-alwayson-availability-groups-configuration-sql-server"></a><span data-ttu-id="adbad-102">Solucionar problemas de configuração de grupos de disponibilidade AlwaysOn (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="adbad-102">Troubleshoot AlwaysOn Availability Groups Configuration (SQL Server)</span></span>
  <span data-ttu-id="adbad-103">Este tópico fornece informações para ajudar a solucionar problemas típicos ao configurar instâncias de servidor para o [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span><span class="sxs-lookup"><span data-stu-id="adbad-103">This topic provides information to help you troubleshoot typical problems with configuring server instances for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span></span> <span data-ttu-id="adbad-104">Os problemas de configuração típicos incluem: o [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] está desabilitado, as contas estão configuradas incorretamente, o ponto de extremidade de espelhamento de banco de dados não existe, o ponto de extremidade está inacessível (Erro 1418 do SQL Server), o acesso à rede não existe e falha no comando de junção de banco de dados (Erro 35250 do SQL Server).</span><span class="sxs-lookup"><span data-stu-id="adbad-104">Typical configuration problems include [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] is disabled, accounts are incorrectly configured, the database mirroring endpoint does not exist, the endpoint is inaccessible (SQL Server Error 1418), network access does not exist, and a join database command fails (SQL Server Error 35250).</span></span>

> [!NOTE]
>  <span data-ttu-id="adbad-105">Verifique se você está atendendo aos pré-requisitos do [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="adbad-105">Ensure that you are meeting the [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] prerequisites.</span></span> <span data-ttu-id="adbad-106">Para obter mais informações, consulte [Pré-requisitos, restrições e recomendações para grupos de disponibilidade AlwaysOn &#40;SQL Server&#41;](prereqs-restrictions-recommendations-always-on-availability.md).</span><span class="sxs-lookup"><span data-stu-id="adbad-106">For more information, see [Prerequisites, Restrictions, and Recommendations for AlwaysOn Availability Groups &#40;SQL Server&#41;](prereqs-restrictions-recommendations-always-on-availability.md).</span></span>

 <span data-ttu-id="adbad-107">**Neste tópico:**</span><span class="sxs-lookup"><span data-stu-id="adbad-107">**In This Topic:**</span></span>

|<span data-ttu-id="adbad-108">Seção</span><span class="sxs-lookup"><span data-stu-id="adbad-108">Section</span></span>|<span data-ttu-id="adbad-109">Descrição</span><span class="sxs-lookup"><span data-stu-id="adbad-109">Description</span></span>|
|-------------|-----------------|
|[<span data-ttu-id="adbad-110">Os grupos de disponibilidade AlwaysOn não estão habilitados</span><span class="sxs-lookup"><span data-stu-id="adbad-110">AlwaysOn Availability Groups Is Not Enabled</span></span>](#IsHadrEnabled)|<span data-ttu-id="adbad-111">Se uma instância do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] não estiver habilitada para o [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], a instância não dará suporte à criação de grupo de disponibilidade e não poderá hospedar nenhuma réplica de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="adbad-111">If an instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] is not enabled for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], the instance does not support availability group creation and cannot host any availability replicas.</span></span>|
|[<span data-ttu-id="adbad-112">Contas</span><span class="sxs-lookup"><span data-stu-id="adbad-112">Accounts</span></span>](#Accounts)|<span data-ttu-id="adbad-113">Discute os requisitos para configurar corretamente as contas nas quais o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] será executado.</span><span class="sxs-lookup"><span data-stu-id="adbad-113">Discusses requirements for correctly configuring the accounts under which [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] is running.</span></span>|
|[<span data-ttu-id="adbad-114">Pontos de extremidade</span><span class="sxs-lookup"><span data-stu-id="adbad-114">Endpoints</span></span>](#Endpoints)|<span data-ttu-id="adbad-115">Discute como diagnosticar problemas com o ponto de extremidade de espelhamento de banco de dados de uma instância de servidor.</span><span class="sxs-lookup"><span data-stu-id="adbad-115">Discusses how to diagnose issues with the database mirroring endpoint of a server instance.</span></span>|
|[<span data-ttu-id="adbad-116">Nome do sistema</span><span class="sxs-lookup"><span data-stu-id="adbad-116">System name</span></span>](#SystemName)|<span data-ttu-id="adbad-117">Resume as alternativas para especificar o nome do sistema de uma instância do servidor em uma URL de ponto de extremidade.</span><span class="sxs-lookup"><span data-stu-id="adbad-117">Summarizes the alternatives for specifying the system name of a server instance in an endpoint URL.</span></span>|
|[<span data-ttu-id="adbad-118">Acesso de rede</span><span class="sxs-lookup"><span data-stu-id="adbad-118">Network access</span></span>](#NetworkAccess)|<span data-ttu-id="adbad-119">Documenta o requisito de que cada instância do servidor que está hospedando uma réplica de disponibilidade deve poder acessar a porta de cada uma das instâncias do servidor sobre TCP.</span><span class="sxs-lookup"><span data-stu-id="adbad-119">Documents the requirement that each server instance that is hosting an availability replica must be able to access the port of each of the other server instances over TCP.</span></span>|
|[<span data-ttu-id="adbad-120">Acesso ao ponto de extremidade (erro 1418 do SQL Server)</span><span class="sxs-lookup"><span data-stu-id="adbad-120">Endpoint Access (SQL Server Error 1418)</span></span>](#Msg1418)|<span data-ttu-id="adbad-121">Contém informações sobre essa mensagem de erro do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="adbad-121">Contains information about this [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] error message.</span></span>|
|[<span data-ttu-id="adbad-122">Falha ao unir bancos de dados (erro 35250 do SQL Server)</span><span class="sxs-lookup"><span data-stu-id="adbad-122">Join Database Fails (SQL Server Error 35250)</span></span>](#JoinDbFails)|<span data-ttu-id="adbad-123">Discute as possíveis causas e resolução de uma falha ao unir bancos de dados secundários a um grupo de disponibilidade porque a conexão com a réplica primária não está ativa.</span><span class="sxs-lookup"><span data-stu-id="adbad-123">Discusses the possible causes and resolution of a failure to join secondary databases to an availability group because the connection to the primary replica is not active.</span></span>|
|[<span data-ttu-id="adbad-124">O roteamento somente leitura não está funcionando corretamente</span><span class="sxs-lookup"><span data-stu-id="adbad-124">Read-Only Routing is Not Working Correctly</span></span>](#ROR)||
|[<span data-ttu-id="adbad-125">Tarefas relacionadas</span><span class="sxs-lookup"><span data-stu-id="adbad-125">Related Tasks</span></span>](#RelatedTasks)|<span data-ttu-id="adbad-126">Contém uma lista de tópicos orientados para tarefas nos Manuais Online do [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] que são particularmente relevantes para solucionar problemas de configuração de grupos de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="adbad-126">Contains a list of task-oriented topics in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] Books Online that are particularly relevant to troubleshooting an availability group configuration.</span></span>|
|[<span data-ttu-id="adbad-127">Conteúdo relacionado</span><span class="sxs-lookup"><span data-stu-id="adbad-127">Related Content</span></span>](#RelatedContent)|<span data-ttu-id="adbad-128">Contém uma lista de recursos relevantes que são externos aos Manuais Online do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="adbad-128">Contains a list of relevant resources that are external to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Books Online.</span></span>|

##  <a name="alwayson-availability-groups-is-not-enabled"></a><a name="IsHadrEnabled"></a><span data-ttu-id="adbad-129">Grupos de Disponibilidade AlwaysOn não está habilitado</span><span class="sxs-lookup"><span data-stu-id="adbad-129">AlwaysOn Availability Groups Is Not Enabled</span></span>
 <span data-ttu-id="adbad-130">O recurso do [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] deve estar habilitado em cada uma das instâncias do [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)].</span><span class="sxs-lookup"><span data-stu-id="adbad-130">The [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] feature must be enabled on each of the instances of [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)].</span></span> <span data-ttu-id="adbad-131">Para obter mais informações, veja [Habilitar e desabilitar Grupos de Disponibilidade AlwaysOn &#40;SQL Server&#41;](enable-and-disable-always-on-availability-groups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="adbad-131">For more information, see [Enable and Disable AlwaysOn Availability Groups &#40;SQL Server&#41;](enable-and-disable-always-on-availability-groups-sql-server.md).</span></span>

##  <a name="accounts"></a><a name="Accounts"></a> <span data-ttu-id="adbad-132">Contas</span><span class="sxs-lookup"><span data-stu-id="adbad-132">Accounts</span></span>
 <span data-ttu-id="adbad-133">As contas nas quais o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] está sendo executado devem ser configuradas corretamente.</span><span class="sxs-lookup"><span data-stu-id="adbad-133">The accounts under which [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] is running must be correctly configured.</span></span>

1.  <span data-ttu-id="adbad-134">As contas têm as permissões corretas?</span><span class="sxs-lookup"><span data-stu-id="adbad-134">Do the accounts have the correct permissions?</span></span>

    1.  <span data-ttu-id="adbad-135">Se os parceiros forem executados como a mesma conta de usuário do domínio, os logons de usuário corretos existirão automaticamente em ambos os bancos de dados **master** .</span><span class="sxs-lookup"><span data-stu-id="adbad-135">If the partners run as the same domain user account, the correct user logins exist automatically in both **master** databases.</span></span> <span data-ttu-id="adbad-136">Isso simplifica a configuração de segurança do banco de dados e é recomendado.</span><span class="sxs-lookup"><span data-stu-id="adbad-136">This simplifies the security configuration the database and is recommended.</span></span>

    2.  <span data-ttu-id="adbad-137">Se duas instâncias do servidor forem executadas como contas diferentes, o logon de cada conta deverá ser criado no banco de dados **master** na instância do servidor remoto e esse logon deverá receber permissões CONNECT para se conectar ao ponto de extremidade de espelhamento do banco de dados dessa instância do servidor.</span><span class="sxs-lookup"><span data-stu-id="adbad-137">If two server instances run as different accounts, the login each account must be created in **master** on the remote server instance, and that login must be granted CONNECT permissions to connect to the database mirroring endpoint of that server instance.</span></span> <span data-ttu-id="adbad-138">Para obter mais informações, consulte[Configurar contas de logon para espelhamento de banco de dados ou Grupos de Disponibilidade AlwaysOn &#40;SQL Server&#41;](../../database-mirroring/set-up-login-accounts-database-mirroring-always-on-availability.md).</span><span class="sxs-lookup"><span data-stu-id="adbad-138">For more information, see[Set Up Login Accounts for Database Mirroring or AlwaysOn Availability Groups &#40;SQL Server&#41;](../../database-mirroring/set-up-login-accounts-database-mirroring-always-on-availability.md).</span></span>

2.  <span data-ttu-id="adbad-139">Se o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] estiver sendo executado como uma conta interna, como Sistema Local, Serviço Local ou Serviço de Rede ou uma conta que não pertença ao domínio, você deverá usar certificados para autenticação de ponto de extremidade.</span><span class="sxs-lookup"><span data-stu-id="adbad-139">If [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] is running as a built-in account, such as Local System, Local Service, or Network Service, or a nondomain account, you must use certificates for endpoint authentication.</span></span> <span data-ttu-id="adbad-140">Se suas contas de serviço estiverem usando contas de domínio no mesmo domínio, você poderá escolher conceder acesso de CONNECT a cada conta de serviço em todos os locais de réplica ou usar certificados.</span><span class="sxs-lookup"><span data-stu-id="adbad-140">If your service accounts are using domain accounts in the same domain, you can choose to grant CONNECT access for each service account on all the replica locations or you can use certificates.</span></span> <span data-ttu-id="adbad-141">Para obter mais informações, veja [Usar certificados para um ponto de extremidade do espelhamento de banco de dados &#40;Transact-SQL&#41;](../../database-mirroring/use-certificates-for-a-database-mirroring-endpoint-transact-sql.md).</span><span class="sxs-lookup"><span data-stu-id="adbad-141">For more information, see[Use Certificates for a Database Mirroring Endpoint &#40;Transact-SQL&#41;](../../database-mirroring/use-certificates-for-a-database-mirroring-endpoint-transact-sql.md).</span></span>

##  <a name="endpoints"></a><a name="Endpoints"></a> <span data-ttu-id="adbad-142">Endpoints</span><span class="sxs-lookup"><span data-stu-id="adbad-142">Endpoints</span></span>
 <span data-ttu-id="adbad-143">Os pontos de extremidade devem ser configurados corretamente.</span><span class="sxs-lookup"><span data-stu-id="adbad-143">Endpoints must be correctly configured.</span></span>

1.  <span data-ttu-id="adbad-144">Verifique se cada instância do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] que vai hospedar uma réplica de disponibilidade (cada *local de réplica*) tem um ponto de extremidade de espelhamento de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="adbad-144">Make sure that each instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] that is going to host an availability replica (each *replica location*) has a database mirroring endpoint.</span></span> <span data-ttu-id="adbad-145">Para determinar se existe um ponto de extremidade de espelhamento do banco de dados em determinada instância do servidor, use a exibição de catálogo [sys.database_mirroring_endpoints](/sql/relational-databases/system-catalog-views/sys-database-mirroring-endpoints-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="adbad-145">To determine whether a database mirroring endpoint exists on a given server instance, use the [sys.database_mirroring_endpoints](/sql/relational-databases/system-catalog-views/sys-database-mirroring-endpoints-transact-sql) catalog view.</span></span> <span data-ttu-id="adbad-146">Para obter mais informações, veja [Criar um ponto de extremidade de espelhamento de banco de dados para a Autenticação do Windows &#40;SQL Server&#41;](../../database-mirroring/create-a-database-mirroring-endpoint-for-windows-authentication-transact-sql.md) ou [Permitir que um ponto de extremidade de espelhamento de banco de dados use certificados para conexões de saída &#40;Transact-SQL&#41;](../../database-mirroring/database-mirroring-use-certificates-for-outbound-connections.md).</span><span class="sxs-lookup"><span data-stu-id="adbad-146">For more information, see either [Create a Database Mirroring Endpoint for Windows Authentication &#40;Transact-SQL&#41;](../../database-mirroring/create-a-database-mirroring-endpoint-for-windows-authentication-transact-sql.md) or [Allow a Database Mirroring Endpoint to Use Certificates for Outbound Connections &#40;Transact-SQL&#41;](../../database-mirroring/database-mirroring-use-certificates-for-outbound-connections.md).</span></span>

2.  <span data-ttu-id="adbad-147">Verifique se os números da porta estão corretos.</span><span class="sxs-lookup"><span data-stu-id="adbad-147">Check that the port numbers are correct.</span></span>

     <span data-ttu-id="adbad-148">Para identificar a porta associada atualmente com o ponto de extremidade de espelhamento de banco de dados de uma instância de servidor, use a seguinte instrução do [!INCLUDE[tsql](../../../includes/tsql-md.md)] :</span><span class="sxs-lookup"><span data-stu-id="adbad-148">To identify the port currently associated with database mirroring endpoint of a server instance, use the following [!INCLUDE[tsql](../../../includes/tsql-md.md)] statement:</span></span>

    ```
    SELECT type_desc, port FROM sys.tcp_endpoints;
    GO
    ```

3.  <span data-ttu-id="adbad-149">Para os problemas da configuração do [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] que forem difíceis de explicar, recomendamos que você inspecione cada instância do servidor para determinar se ela está escutando nas portas corretas.</span><span class="sxs-lookup"><span data-stu-id="adbad-149">For [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] setup issues that are difficult to explain, we recommend that you inspect each server instance to determine whether it is listening on the correct ports.</span></span> <span data-ttu-id="adbad-150">Para obter mais informações sobre como verificar a disponibilidade de porta, veja [MSSQLSERVER_1418](../../../relational-databases/errors-events/mssqlserver-1418-database-engine-error.md).</span><span class="sxs-lookup"><span data-stu-id="adbad-150">For information about verifying port availability, see [MSSQLSERVER_1418](../../../relational-databases/errors-events/mssqlserver-1418-database-engine-error.md).</span></span>

4.  <span data-ttu-id="adbad-151">Verifique se os pontos de extremidade foram iniciados (STATE=STARTED).</span><span class="sxs-lookup"><span data-stu-id="adbad-151">Make sure that the endpoints are started (STATE=STARTED).</span></span> <span data-ttu-id="adbad-152">Em cada instância do servidor, use a seguinte instrução [!INCLUDE[tsql](../../../includes/tsql-md.md)]:</span><span class="sxs-lookup"><span data-stu-id="adbad-152">On each server instance, use the following [!INCLUDE[tsql](../../../includes/tsql-md.md)] statement:</span></span>

    ```
    SELECT state_desc FROM sys.database_mirroring_endpoints
    ```

     <span data-ttu-id="adbad-153">Para obter mais informações sobre a coluna **state_desc**, veja [sys.database_mirroring_endpoints &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/sys-database-mirroring-endpoints-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="adbad-153">For more information about the **state_desc** column, see [sys.database_mirroring_endpoints &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/sys-database-mirroring-endpoints-transact-sql).</span></span>

     <span data-ttu-id="adbad-154">Para iniciar um ponto de extremidade, use a seguinte instrução [!INCLUDE[tsql](../../../includes/tsql-md.md)]:</span><span class="sxs-lookup"><span data-stu-id="adbad-154">To start an endpoint, use the following [!INCLUDE[tsql](../../../includes/tsql-md.md)] statement:</span></span>

    ```
    ALTER ENDPOINT Endpoint_Mirroring 
    STATE = STARTED 
    AS TCP (LISTENER_PORT = <port_number>)
    FOR database_mirroring (ROLE = ALL);
    GO
    ```

     <span data-ttu-id="adbad-155">Para obter mais informações, consulte [ALTER ENDPOINT &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-endpoint-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="adbad-155">For more information, see [ALTER ENDPOINT &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-endpoint-transact-sql).</span></span>

5.  <span data-ttu-id="adbad-156">Verifique se o logon do outro servidor tem permissão CONNECT.</span><span class="sxs-lookup"><span data-stu-id="adbad-156">Make sure that the login from the other server has CONNECT permission.</span></span> <span data-ttu-id="adbad-157">Para determinar quem tem permissão CONNECT para um ponto de extremidade, em cada instância do servidor, use a seguinte instrução [!INCLUDE[tsql](../../../includes/tsql-md.md)] :</span><span class="sxs-lookup"><span data-stu-id="adbad-157">To determine who has CONNECT permission for an endpoint, on each server instance use the following [!INCLUDE[tsql](../../../includes/tsql-md.md)] statement:</span></span>

    ```
    SELECT 'Metadata Check';
    SELECT EP.name, SP.STATE, 
       CONVERT(nvarchar(38), suser_name(SP.grantor_principal_id)) 
          AS GRANTOR, 
       SP.TYPE AS PERMISSION,
       CONVERT(nvarchar(46),suser_name(SP.grantee_principal_id)) 
          AS GRANTEE 
       FROM sys.server_permissions SP , sys.endpoints EP
       WHERE SP.major_id = EP.endpoint_id
       ORDER BY Permission,grantor, grantee; 
    GO

    ```

##  <a name="system-name"></a><a name="SystemName"></a> <span data-ttu-id="adbad-158">System Name</span><span class="sxs-lookup"><span data-stu-id="adbad-158">System Name</span></span>
 <span data-ttu-id="adbad-159">Para o nome de sistema de uma instância do servidor em uma URL de ponto de extremidade, você pode usar qualquer nome que identifique o sistema inequivocamente.</span><span class="sxs-lookup"><span data-stu-id="adbad-159">For the system name of a server instance in an endpoint URL, you can use any name that unambiguously identifies the system.</span></span> <span data-ttu-id="adbad-160">O endereço de servidor pode ser um nome de sistema (se os sistemas estiverem no mesmo domínio), um nome de domínio totalmente qualificado ou um endereço de IP (preferivelmente, um endereço de IP estático).</span><span class="sxs-lookup"><span data-stu-id="adbad-160">The server address can be a system name (if the systems are in the same domain), a fully qualified domain name, or an IP address (preferably, a static IP address).</span></span> <span data-ttu-id="adbad-161">Usando o nome de domínio totalmente qualificado o funcionamento é garantido.</span><span class="sxs-lookup"><span data-stu-id="adbad-161">Using the fully qualified domain name is guaranteed to work.</span></span> <span data-ttu-id="adbad-162">Para obter mais informações, consulte [Especificar a URL do ponto de extremidade ao adicionar ou modificar uma réplica de disponibilidade &#40;SQL Server&#41;](specify-endpoint-url-adding-or-modifying-availability-replica.md).</span><span class="sxs-lookup"><span data-stu-id="adbad-162">For more information, see [Specify the Endpoint URL When Adding or Modifying an Availability Replica &#40;SQL Server&#41;](specify-endpoint-url-adding-or-modifying-availability-replica.md).</span></span>

##  <a name="network-access"></a><a name="NetworkAccess"></a> <span data-ttu-id="adbad-163">Network Access</span><span class="sxs-lookup"><span data-stu-id="adbad-163">Network Access</span></span>
 <span data-ttu-id="adbad-164">Cada instância do servidor que esteja hospedando uma réplica de disponibilidade deve poder acessar a porta de cada uma das instâncias do servidor sobre TCP.</span><span class="sxs-lookup"><span data-stu-id="adbad-164">Each server instance that is hosting an availability replica must be able to access the port of each of the other server instance over TCP.</span></span> <span data-ttu-id="adbad-165">Isso será especialmente importante se as instâncias do servidor estiverem em domínios diferentes que não confiam um no outro (domínios não confiáveis).</span><span class="sxs-lookup"><span data-stu-id="adbad-165">This is especially important if the server instances are in different domains that do not trust each other (untrusted domains).</span></span>

##  <a name="endpoint-access-sql-server-error-1418"></a><a name="Msg1418"></a> <span data-ttu-id="adbad-166">Acesso ao ponto de extremidade (erro 1418 do SQL Server)</span><span class="sxs-lookup"><span data-stu-id="adbad-166">Endpoint Access (SQL Server Error 1418)</span></span>
 <span data-ttu-id="adbad-167">Essa mensagem do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] indica que o endereço de rede do servidor especificado na URL do ponto de extremidade não pode ser atingido ou não existe e sugere que você verifique o nome do endereço de rede e emita o comando novamente.</span><span class="sxs-lookup"><span data-stu-id="adbad-167">This [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] message indicates that the server network address specified in the endpoint URL cannot be reached or does not exist, and it suggests that you verify the network address name and reissue the command.</span></span> <span data-ttu-id="adbad-168">Para obter mais informações, veja [MSSQLSERVER_1418](../../../relational-databases/errors-events/mssqlserver-1418-database-engine-error.md).</span><span class="sxs-lookup"><span data-stu-id="adbad-168">For more information, see [MSSQLSERVER_1418](../../../relational-databases/errors-events/mssqlserver-1418-database-engine-error.md).</span></span>

##  <a name="join-database-fails-sql-server-error-35250"></a><a name="JoinDbFails"></a> <span data-ttu-id="adbad-169">Falha ao unir bancos de dados (erro 35250 do SQL Server)</span><span class="sxs-lookup"><span data-stu-id="adbad-169">Join Database Fails (SQL Server Error 35250)</span></span>
 <span data-ttu-id="adbad-170">Discute as possíveis causas e resolução de uma falha ao unir bancos de dados secundários a um grupo de disponibilidade porque a conexão com a réplica primária não está ativa.</span><span class="sxs-lookup"><span data-stu-id="adbad-170">This section discusses the possible causes and resolution of a failure to join secondary databases to the availability group because the connection to the primary replica is not active.</span></span>

 <span data-ttu-id="adbad-171">**Resolução:**</span><span class="sxs-lookup"><span data-stu-id="adbad-171">**Resolution:**</span></span>

1.  <span data-ttu-id="adbad-172">Verifique a configuração do firewall para confirmar se ele permite comunicação da porta do ponto de extremidade entre as instâncias do servidor que hospedam a réplica primária e a réplica secundária (por padrão, a porta 5022).</span><span class="sxs-lookup"><span data-stu-id="adbad-172">Check the firewall setting to see if whether allows the endpoint port communication between the server instances that host primary replica and the secondary replica (port 5022 by default).</span></span>

2.  <span data-ttu-id="adbad-173">Verifique se a conta de serviço de rede tem permissão para conectar-se ao ponto de extremidade.</span><span class="sxs-lookup"><span data-stu-id="adbad-173">Check whether the network service account has connect permission to the endpoint.</span></span>

##  <a name="read-only-routing-is-not-working-correctly"></a><a name="ROR"></a> <span data-ttu-id="adbad-174">O roteamento somente leitura não está funcionando corretamente</span><span class="sxs-lookup"><span data-stu-id="adbad-174">Read-Only Routing is Not Working Correctly</span></span>
 <span data-ttu-id="adbad-175">Verifique as configurações de valores a seguir e corrija-as se necessário.</span><span class="sxs-lookup"><span data-stu-id="adbad-175">Verify the following configuration values settings and correct them if necessary.</span></span>

||<span data-ttu-id="adbad-176">Ligado...</span><span class="sxs-lookup"><span data-stu-id="adbad-176">On...</span></span>|<span data-ttu-id="adbad-177">Ação</span><span class="sxs-lookup"><span data-stu-id="adbad-177">Action</span></span>|<span data-ttu-id="adbad-178">Comentários</span><span class="sxs-lookup"><span data-stu-id="adbad-178">Comments</span></span>|<span data-ttu-id="adbad-179">Link</span><span class="sxs-lookup"><span data-stu-id="adbad-179">Link</span></span>|
|------|---------|------------|--------------|----------|
|<span data-ttu-id="adbad-180">![Caixa de seleção](../../media/checkboxemptycenterxtraspacetopandright.gif "Caixa de seleção")</span><span class="sxs-lookup"><span data-stu-id="adbad-180">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="adbad-181">Réplica primária atual</span><span class="sxs-lookup"><span data-stu-id="adbad-181">Current primary replica</span></span>|<span data-ttu-id="adbad-182">Verifique se o ouvinte do grupo de disponibilidade está online.</span><span class="sxs-lookup"><span data-stu-id="adbad-182">Ensure that the availability group listener is online.</span></span>|<span data-ttu-id="adbad-183">**Para verificar se o ouvinte está online:**</span><span class="sxs-lookup"><span data-stu-id="adbad-183">**To verify whether the listener is online:**</span></span><br /><br /> `SELECT * FROM sys.dm_tcp_listener_states;`<br /><br /> <span data-ttu-id="adbad-184">**Para reiniciar um ouvinte offline:**</span><span class="sxs-lookup"><span data-stu-id="adbad-184">**To restart an offline listener:**</span></span><br /><br /> `ALTER AVAILABILITY GROUP myAG RESTART LISTENER 'myAG_Listener';`|[<span data-ttu-id="adbad-185">sys.dm_tcp_listener_states &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="adbad-185">sys.dm_tcp_listener_states &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-dynamic-management-views/sys-dm-tcp-listener-states-transact-sql)<br /><br /> [<span data-ttu-id="adbad-186">ALTER AVAILABILITY GROUP &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="adbad-186">ALTER AVAILABILITY GROUP &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/alter-availability-group-transact-sql)|
|<span data-ttu-id="adbad-187">![Caixa de seleção](../../media/checkboxemptycenterxtraspacetopandright.gif "Caixa de seleção")</span><span class="sxs-lookup"><span data-stu-id="adbad-187">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="adbad-188">Réplica primária atual</span><span class="sxs-lookup"><span data-stu-id="adbad-188">Current primary replica</span></span>|<span data-ttu-id="adbad-189">Verifique se READ_ONLY_ROUTING_LIST contém somente instâncias de servidor que hospedem uma réplica secundária legível.</span><span class="sxs-lookup"><span data-stu-id="adbad-189">Ensure that the READ_ONLY_ROUTING_LIST contains only server instances that are hosting a readable secondary replica.</span></span>|<span data-ttu-id="adbad-190">**Para identificar réplicas secundárias legíveis:** sys.availability_replicas (coluna**secondary_role_allow_connections_desc** )</span><span class="sxs-lookup"><span data-stu-id="adbad-190">**To identify readable secondary replicas:** sys.availability_replicas  (**secondary_role_allow_connections_desc** column)</span></span><br /><br /> <span data-ttu-id="adbad-191">**Para exibir uma lista de roteamento somente leitura:** sys.availability_read_only_routing_lists</span><span class="sxs-lookup"><span data-stu-id="adbad-191">**To view a read-only routing list:** sys.availability_read_only_routing_lists</span></span><br /><br /> <span data-ttu-id="adbad-192">**Para alterar uma lista de roteamento somente leitura:** ALTER AVAILABILITY GROUP</span><span class="sxs-lookup"><span data-stu-id="adbad-192">**To change a read-only routing list:** ALTER AVAILABILITY GROUP</span></span>|[<span data-ttu-id="adbad-193">sys.availability_replicas &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="adbad-193">sys.availability_replicas &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-catalog-views/sys-availability-replicas-transact-sql)<br /><br /> [<span data-ttu-id="adbad-194">sys.availability_read_only_routing_lists &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="adbad-194">sys.availability_read_only_routing_lists &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-catalog-views/sys-availability-read-only-routing-lists-transact-sql)<br /><br /> [<span data-ttu-id="adbad-195">ALTER AVAILABILITY GROUP &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="adbad-195">ALTER AVAILABILITY GROUP &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/alter-availability-group-transact-sql)|
|<span data-ttu-id="adbad-196">![Caixa de seleção](../../media/checkboxemptycenterxtraspacetopandright.gif "Caixa de seleção")</span><span class="sxs-lookup"><span data-stu-id="adbad-196">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="adbad-197">Cada réplica em read_only_routing_list</span><span class="sxs-lookup"><span data-stu-id="adbad-197">Every replica in the read_only_routing_list</span></span>|<span data-ttu-id="adbad-198">Verifique se o firewall do Windows não está bloqueando a porta READ_ONLY_ROUTING_URL.</span><span class="sxs-lookup"><span data-stu-id="adbad-198">Ensure that the Windows firewall is not blocking the READ_ONLY_ROUTING_URL port.</span></span>|-|[<span data-ttu-id="adbad-199">Configurar um Firewall do Windows para acesso ao Mecanismo de Banco de Dados</span><span class="sxs-lookup"><span data-stu-id="adbad-199">Configure a Windows Firewall for Database Engine Access</span></span>](../../configure-windows/configure-a-windows-firewall-for-database-engine-access.md)|
|<span data-ttu-id="adbad-200">![Caixa de seleção](../../media/checkboxemptycenterxtraspacetopandright.gif "Caixa de seleção")</span><span class="sxs-lookup"><span data-stu-id="adbad-200">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="adbad-201">Cada réplica em read_only_routing_list</span><span class="sxs-lookup"><span data-stu-id="adbad-201">Every replica in the read_only_routing_list</span></span>|<span data-ttu-id="adbad-202">No [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Configuration Manager, verifique se:</span><span class="sxs-lookup"><span data-stu-id="adbad-202">In [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Configuration Manager, verify that:</span></span><br /><br /> <span data-ttu-id="adbad-203">A conectividade remota do SQL Server está habilitada.</span><span class="sxs-lookup"><span data-stu-id="adbad-203">SQL Server remote connectivity is enabled.</span></span><br /><br /> <span data-ttu-id="adbad-204">TCP/IP está habilitado.</span><span class="sxs-lookup"><span data-stu-id="adbad-204">TCP/IP is enabled.</span></span><br /><br /> <span data-ttu-id="adbad-205">Os endereços IP estão configurados corretamente.</span><span class="sxs-lookup"><span data-stu-id="adbad-205">The IP addresses are configured correctly.</span></span>|-|[<span data-ttu-id="adbad-206">Exibir ou alterar as propriedades de servidor &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="adbad-206">View or Change Server Properties &#40;SQL Server&#41;</span></span>](../../configure-windows/view-or-change-server-properties-sql-server.md)<br /><br /> [<span data-ttu-id="adbad-207">Configurar um servidor para escuta em uma porta TCP específica &#40;SQL Server Configuration Manager&#41;</span><span class="sxs-lookup"><span data-stu-id="adbad-207">Configure a Server to Listen on a Specific TCP Port &#40;SQL Server Configuration Manager&#41;</span></span>](../../configure-windows/configure-a-server-to-listen-on-a-specific-tcp-port.md)|
|<span data-ttu-id="adbad-208">![Caixa de seleção](../../media/checkboxemptycenterxtraspacetopandright.gif "Caixa de seleção")</span><span class="sxs-lookup"><span data-stu-id="adbad-208">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="adbad-209">Cada réplica em read_only_routing_list</span><span class="sxs-lookup"><span data-stu-id="adbad-209">Every replica in the read_only_routing_list</span></span>|<span data-ttu-id="adbad-210">Verifique se a READ_ONLY_ROUTING_URL (TCP<strong>:// *`system-address`* :</strong>*Port*) contém o FQDN (nome de domínio totalmente qualificado) e o número da porta corretos.</span><span class="sxs-lookup"><span data-stu-id="adbad-210">Ensure that the READ_ONLY_ROUTING_URL (TCP<strong>://*`system-address`*:</strong>*port*) contains the correct fully-qualified domain name (FQDN) and port number.</span></span>|-|[<span data-ttu-id="adbad-211">Calculando read_only_routing_url de AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="adbad-211">Calculating read_only_routing_url for AlwaysOn</span></span>](https://docs.microsoft.com/archive/blogs/mattn/calculating-read_only_routing_url-for-alwayson)<br /><br /> [<span data-ttu-id="adbad-212">sys.availability_replicas &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="adbad-212">sys.availability_replicas &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-catalog-views/sys-availability-replicas-transact-sql)<br /><br /> [<span data-ttu-id="adbad-213">ALTER AVAILABILITY GROUP &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="adbad-213">ALTER AVAILABILITY GROUP &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/alter-availability-group-transact-sql)|
|<span data-ttu-id="adbad-214">![Caixa de seleção](../../media/checkboxemptycenterxtraspacetopandright.gif "Caixa de seleção")</span><span class="sxs-lookup"><span data-stu-id="adbad-214">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="adbad-215">Sistema cliente</span><span class="sxs-lookup"><span data-stu-id="adbad-215">Client system</span></span>|<span data-ttu-id="adbad-216">Verifique se o driver cliente dá suporte a roteamento somente leitura.</span><span class="sxs-lookup"><span data-stu-id="adbad-216">Verify that the client driver supports read-only routing.</span></span>|-|[<span data-ttu-id="adbad-217">Conectividade de Cliente AlwaysOn (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="adbad-217">AlwaysOn Client Connectivity (SQL Server)</span></span>](always-on-client-connectivity-sql-server.md)|

##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="adbad-218">Tarefas relacionadas</span><span class="sxs-lookup"><span data-stu-id="adbad-218">Related Tasks</span></span>

-   [<span data-ttu-id="adbad-219">Criação e configuração de grupos de disponibilidade &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="adbad-219">Creation and Configuration of Availability Groups &#40;SQL Server&#41;</span></span>](creation-and-configuration-of-availability-groups-sql-server.md)

-   [<span data-ttu-id="adbad-220">Criar um ponto de extremidade de espelhamento de banco de dados para a Autenticação do Windows &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="adbad-220">Create a Database Mirroring Endpoint for Windows Authentication &#40;Transact-SQL&#41;</span></span>](../../database-mirroring/create-a-database-mirroring-endpoint-for-windows-authentication-transact-sql.md)

-   [<span data-ttu-id="adbad-221">Especificar a URL do ponto de extremidade ao adicionar ou modificar uma réplica de disponibilidade &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="adbad-221">Specify the Endpoint URL When Adding or Modifying an Availability Replica &#40;SQL Server&#41;</span></span>](specify-endpoint-url-adding-or-modifying-availability-replica.md)

-   [<span data-ttu-id="adbad-222">Preparar um banco de dados secundário manualmente para um grupo de disponibilidade &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="adbad-222">Manually Prepare a Secondary Database for an Availability Group &#40;SQL Server&#41;</span></span>](manually-prepare-a-secondary-database-for-an-availability-group-sql-server.md)

-   [<span data-ttu-id="adbad-223">Solucionar problemas de uma operação de adição de arquivo com falha &#40;Grupos de Disponibilidade AlwaysOn&#41;</span><span class="sxs-lookup"><span data-stu-id="adbad-223">Troubleshoot a Failed Add-File Operation &#40;AlwaysOn Availability Groups&#41;</span></span>](troubleshoot-a-failed-add-file-operation-always-on-availability-groups.md)

-   [<span data-ttu-id="adbad-224">Gerenciamento de logons e trabalhos para os bancos de dados de um grupo de disponibilidade &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="adbad-224">Management of Logins and Jobs for the Databases of an Availability Group &#40;SQL Server&#41;</span></span>](../../logins-and-jobs-for-availability-group-databases.md)

-   [<span data-ttu-id="adbad-225">Gerenciar metadados ao disponibilizar um banco de dados em outra instância do servidor &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="adbad-225">Manage Metadata When Making a Database Available on Another Server Instance &#40;SQL Server&#41;</span></span>](../../../relational-databases/databases/manage-metadata-when-making-a-database-available-on-another-server.md)

##  <a name="related-content"></a><a name="RelatedContent"></a> <span data-ttu-id="adbad-226">Conteúdo relacionado</span><span class="sxs-lookup"><span data-stu-id="adbad-226">Related Content</span></span>

-   <span data-ttu-id="adbad-227">[Exibir eventos e logs de um cluster de failover](https://technet.microsoft.com/library/cc772342\(WS.10\).aspx)</span><span class="sxs-lookup"><span data-stu-id="adbad-227">[View Events and Logs for a Failover Cluster](https://technet.microsoft.com/library/cc772342\(WS.10\).aspx)</span></span>

-   [<span data-ttu-id="adbad-228">Cluster de failover Get-ClusterLog do cmdlet</span><span class="sxs-lookup"><span data-stu-id="adbad-228">Get-ClusterLog Failover Cluster Cmdlet</span></span>](https://technet.microsoft.com/library/ee461045.aspx)

-   [<span data-ttu-id="adbad-229">Blog da equipe do AlwaysOn do SQL Server: blog oficial da equipe do SQL Server AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="adbad-229">SQL Server AlwaysOn Team Blog: The official SQL Server AlwaysOn Team Blog</span></span>](https://blogs.msdn.com/b/sqlalwayson/)

## <a name="see-also"></a><span data-ttu-id="adbad-230">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="adbad-230">See Also</span></span>
 <span data-ttu-id="adbad-231">[Segurança de transporte para espelhamento de banco de dados e Grupos de Disponibilidade AlwaysOn &#40;SQL Server&#41;](../../database-mirroring/transport-security-database-mirroring-always-on-availability.md) pré-requisitos de [configuração de rede do cliente](../../configure-windows/client-network-configuration.md) [, restrições e recomendações para grupos de disponibilidade AlwaysOn](prereqs-restrictions-recommendations-always-on-availability.md) &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="adbad-231">[Transport Security for Database Mirroring and AlwaysOn Availability Groups &#40;SQL Server&#41;](../../database-mirroring/transport-security-database-mirroring-always-on-availability.md) [Client Network Configuration](../../configure-windows/client-network-configuration.md) [Prerequisites, Restrictions, and Recommendations for AlwaysOn Availability Groups &#40;SQL Server&#41;](prereqs-restrictions-recommendations-always-on-availability.md)</span></span>


