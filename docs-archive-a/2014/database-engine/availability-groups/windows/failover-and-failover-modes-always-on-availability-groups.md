---
title: Failover e modos de failover (Grupos de Disponibilidade AlwaysOn) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- Availability Groups [SQL Server], availability replicas
- Availability Groups [SQL Server], failover
- Availability Groups [SQL Server], failover modes
- failover [SQL Server], AlwaysOn Availability Groups
ms.assetid: 378d2d63-50b9-420b-bafb-d375543fda17
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: eb904cd0f0649c43553b5d6c8b031c5f284901f4
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87573289"
---
# <a name="failover-and-failover-modes-alwayson-availability-groups"></a><span data-ttu-id="37dd7-102">Failover e modos de failover (grupos de disponibilidade AlwaysOn)</span><span class="sxs-lookup"><span data-stu-id="37dd7-102">Failover and Failover Modes (AlwaysOn Availability Groups)</span></span>
  <span data-ttu-id="37dd7-103">Dentro do contexto de um grupo de disponibilidade, as funções primária e secundária das réplicas de disponibilidade, normalmente, são intercambiáveis em um processo conhecido como *failover*.</span><span class="sxs-lookup"><span data-stu-id="37dd7-103">Within the context of an availability group, the primary role and secondary role of availability replicas are typically interchangeable in a process known as *failover*.</span></span> <span data-ttu-id="37dd7-104">Existem três formas de failover: failover automático (sem perda de dados), failover manual planejado (sem perda de dados) e failover manual forçado (com possível perda de dados), geralmente chamado de *failover forçado*.</span><span class="sxs-lookup"><span data-stu-id="37dd7-104">Three forms of failover exist: automatic failover (without data loss), planned manual failover (without data loss), and forced manual failover (with possible data loss), typically called *forced failover*.</span></span> <span data-ttu-id="37dd7-105">Os failovers automáticos e manuais planejados preservam todos os seus dados.</span><span class="sxs-lookup"><span data-stu-id="37dd7-105">Automatic and planned manual failover preserve all your data.</span></span> <span data-ttu-id="37dd7-106">Um grupo de disponibilidade faz failover no nível da réplica de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="37dd7-106">An availability group fails over at the availability-replica level.</span></span> <span data-ttu-id="37dd7-107">Ou seja, um grupo de disponibilidade realiza failover em uma de suas réplicas secundárias (o *destino de failover*atual).</span><span class="sxs-lookup"><span data-stu-id="37dd7-107">That is, an availability group fails over to one of its secondary replicas (the current *failover target*).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="37dd7-108">Problemas no nível do banco de dados, como um banco de dados que se torna suspeito devido à perda de um arquivo de dados, à exclusão de um banco de dados ou à corrupção de um log de transações não causam o failover do grupo de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="37dd7-108">Issues at the database level, such as a database becoming suspect due to the loss of a data file, deletion of a database, or corruption of a transaction log, do not cause an availability group to failover.</span></span>  
  
 <span data-ttu-id="37dd7-109">Durante o failover, o destino de failover assume a função primária, recupera seus bancos de dados e os coloca online como os novos bancos de dados primários.</span><span class="sxs-lookup"><span data-stu-id="37dd7-109">During the failover, the failover target takes over the primary role, recovers its databases, and brings them online as the new primary databases.</span></span> <span data-ttu-id="37dd7-110">A réplica primária anterior, quando disponível, alterna para a função secundária, e seus bancos de dados se tornam bancos de dados secundários.</span><span class="sxs-lookup"><span data-stu-id="37dd7-110">The former primary replica, when available, switches to the secondary role, and its databases become secondary databases.</span></span> <span data-ttu-id="37dd7-111">Potencialmente, essas funções podem ser alternadas (ou usar um destino de failover diferente) como resposta a várias falhas ou por razões administrativas.</span><span class="sxs-lookup"><span data-stu-id="37dd7-111">Potentially, these roles can switch back and forth (or to a different failover target) in response to multiple failures or for administrative purposes.</span></span>  
  
 <span data-ttu-id="37dd7-112">Os formulários de failover aos quais uma determinada réplica de disponibilidade dá suporte são especificados pela propriedade *modo de failover* .</span><span class="sxs-lookup"><span data-stu-id="37dd7-112">The form(s) of failover that a given availability replica supports is specified by the *failover mode* property.</span></span> <span data-ttu-id="37dd7-113">Para uma determinada réplica de disponibilidade, os possíveis modos de failover dependem do [modo de disponibilidade](availability-modes-always-on-availability-groups.md) da réplica, da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="37dd7-113">For a given availability replica, the possible failover modes depends on the [availability mode](availability-modes-always-on-availability-groups.md) of the replica, as follows:</span></span>  
  
-   <span data-ttu-id="37dd7-114">**Réplicas de confirmação síncrona** dão suporte a duas configurações: automática ou manual.</span><span class="sxs-lookup"><span data-stu-id="37dd7-114">**Synchronous-commit replicas** support two settings-automatic or manual.</span></span> <span data-ttu-id="37dd7-115">A configuração "automática" dá suporte a failover automático e failover manual.</span><span class="sxs-lookup"><span data-stu-id="37dd7-115">The "automatic" setting supports both automatic failover and manual failover.</span></span> <span data-ttu-id="37dd7-116">Para evitar a perda de dados, os failovers automático e planejado requerem que o destino de failover seja uma réplica secundária de confirmação síncrona com um estado de sincronização íntegro (isso indica que cada banco de dados secundário no destino de failover é sincronizado com seu banco de dados primário correspondente).</span><span class="sxs-lookup"><span data-stu-id="37dd7-116">To prevent data loss, automatic failover and planned failover require that the failover target be a synchronous-commit secondary replica with a healthy synchronization state (this indicates that every secondary database on the failover target is synchronized with its corresponding primary database).</span></span> <span data-ttu-id="37dd7-117">Sempre que uma réplica secundária não atender a essas duas condições, ela dará suporte somente ao failover forçado.</span><span class="sxs-lookup"><span data-stu-id="37dd7-117">Whenever a secondary replica does not meet both of these conditions, it supports only forced failover.</span></span> <span data-ttu-id="37dd7-118">Observe que o failover forçado também dá suporte a réplicas cujo estado da função é RESOLVING.</span><span class="sxs-lookup"><span data-stu-id="37dd7-118">Note that forced failover is also supported a replicas whose role is in the RESOLVING state.</span></span>  
  
-   <span data-ttu-id="37dd7-119">**Réplicas de confirmação assíncrona** dão suporte somente ao modo de failover manual.</span><span class="sxs-lookup"><span data-stu-id="37dd7-119">**Asynchronous-commit replicas** support only the manual failover mode.</span></span> <span data-ttu-id="37dd7-120">Além disso, como elas nunca são sincronizadas, dão suporte apenas ao failover forçado.</span><span class="sxs-lookup"><span data-stu-id="37dd7-120">Moreover, because they are never synchronized, they support only forced failover.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="37dd7-121">Depois de um failover, os aplicativos cliente que precisam acessar os bancos de dados primários devem conectar-se com a nova réplica primária.</span><span class="sxs-lookup"><span data-stu-id="37dd7-121">After a failover, client applications that need to access the primary databases must connect to the new primary replica.</span></span> <span data-ttu-id="37dd7-122">Além disso, se a nova réplica secundária estiver configurada para permitir acesso somente leitura, os aplicativos cliente somente leitura poderão conectar-se a ela.</span><span class="sxs-lookup"><span data-stu-id="37dd7-122">Also, if the new secondary replica is configured to allow read-only access, read-only client applications can connect to it.</span></span> <span data-ttu-id="37dd7-123">Para obter informações sobre como clientes conectam a um grupo de disponibilidade, veja [Ouvintes do grupo de disponibilidade, conectividade de cliente e failover de aplicativos &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md).</span><span class="sxs-lookup"><span data-stu-id="37dd7-123">For information about how clients connect to an availability group, see [Availability Group Listeners, Client Connectivity, and Application Failover &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md).</span></span>  
  
  
##  <a name="terms-and-definitions"></a><a name="TermsAndDefinitions"></a> <span data-ttu-id="37dd7-124">Termos e definições</span><span class="sxs-lookup"><span data-stu-id="37dd7-124">Terms and Definitions</span></span>  
 <span data-ttu-id="37dd7-125">failover automático</span><span class="sxs-lookup"><span data-stu-id="37dd7-125">Automatic failover</span></span>  
 <span data-ttu-id="37dd7-126">Um failover que ocorre automaticamente na perda da réplica primária.</span><span class="sxs-lookup"><span data-stu-id="37dd7-126">A failover that occurs automatically on the loss of the primary replica.</span></span> <span data-ttu-id="37dd7-127">Há suporte para o failover automático apenas quando a réplica primária atual e uma réplica secundária estão configuradas como modo de failover definido como AUTOMATIC e a réplica secundária está sincronizada no momento.</span><span class="sxs-lookup"><span data-stu-id="37dd7-127">Automatic failover is supported only when the current primary and one secondary replica are both configured with failover mode set to AUTOMATIC and the secondary replica currently synchronized.</span></span>  <span data-ttu-id="37dd7-128">Se o modo de failover da réplica primária ou secundária for MANUAL, o failover automático não poderá ocorrer.</span><span class="sxs-lookup"><span data-stu-id="37dd7-128">If the failover mode of either the primary or secondary replica is MANUAL, automatic failover cannot occur.</span></span>  
  
 <span data-ttu-id="37dd7-129">Failover manual planejado (sem perda de dados)</span><span class="sxs-lookup"><span data-stu-id="37dd7-129">Planned manual failover (without data loss)</span></span>  
 <span data-ttu-id="37dd7-130">O failover manual planejado, ou *failover manual*, é um failover iniciado por um administrador de banco de dados, em geral para fins administrativos.</span><span class="sxs-lookup"><span data-stu-id="37dd7-130">Planned manual failover, or *manual failover*, is a failover that is initiated by a database administrator, typically, for administrative purposes.</span></span> <span data-ttu-id="37dd7-131">Um failover manual planejado tem suporte apenas se a réplica primária e a réplica secundária estiverem configuradas para modo de confirmação síncrona, e a réplica secundária estiver sincronizada atualmente (no modo SYNCHRONIZED).</span><span class="sxs-lookup"><span data-stu-id="37dd7-131">A planned manual failover is supported only if both the primary replica and secondary replica are configured for synchronous-commit mode and the secondary replica is currently synchronized (in the SYNCHRONIZED state).</span></span> <span data-ttu-id="37dd7-132">Quando a réplica secundária de destino está sincronizada, o failover manual (sem perda de dados) será possível até mesmo se a réplica primária tiver falhado, pois os bancos de dados secundários estão prontos para o failover.</span><span class="sxs-lookup"><span data-stu-id="37dd7-132">When the target secondary replica is synchronized, manual failover (without data loss) is possible even if the primary replica has crashed because the secondary databases are ready for failover.</span></span> <span data-ttu-id="37dd7-133">Um administrador de banco de dados inicia um failover manual manualmente.</span><span class="sxs-lookup"><span data-stu-id="37dd7-133">A database administrator manually initiates a manual failover.</span></span>  
  
 <span data-ttu-id="37dd7-134">Failover forçado (com possível perda de dados)</span><span class="sxs-lookup"><span data-stu-id="37dd7-134">Forced failover (with possible data loss)</span></span>  
 <span data-ttu-id="37dd7-135">Um failover que pode ser iniciado por um administrador de banco de dados quando nenhuma réplica secundária é SYNCHRONIZED com a réplica primária ou a réplica primária não está em execução e nenhuma réplica secundária está pronta para failover.</span><span class="sxs-lookup"><span data-stu-id="37dd7-135">A failover that can be initiated by a database administrator when no secondary replica is SYNCHRONIZED with the primary replica or the primary replica is not running and no secondary replica is failover ready.</span></span> <span data-ttu-id="37dd7-136">O failover forçado leva a um risco de perda de dados e é recomendável estritamente para a recuperação de desastres.</span><span class="sxs-lookup"><span data-stu-id="37dd7-136">Forced failover risks possible data loss and is recommended strictly for disaster recovery.</span></span> <span data-ttu-id="37dd7-137">O failover forçado também é conhecido como failover manual forçado porque ele só pode ser iniciado manualmente.</span><span class="sxs-lookup"><span data-stu-id="37dd7-137">Forced failover is also known as forced manual failover because it can only be initiated manually.</span></span> <span data-ttu-id="37dd7-138">Este é o único formulário de failover com suporte em modo de disponibilidade da confirmação assíncrona.</span><span class="sxs-lookup"><span data-stu-id="37dd7-138">This is the only form of failover supported by in asynchronous-commit availability mode.</span></span>  
  
 [!INCLUDE[ssFosAutoC](../../../includes/ssfosautoc-md.md)]  
 <span data-ttu-id="37dd7-139">Em um grupo de disponibilidade específico, existe apenas um par de réplicas de disponibilidade (inclusive a réplica primária atual) que está configurado para o modo de confirmação síncrona com failover automático, se houver.</span><span class="sxs-lookup"><span data-stu-id="37dd7-139">Within a given availability group, a pair of availability replicas (including the current primary replica) that are configured for synchronous-commit mode with automatic failover, if any.</span></span> <span data-ttu-id="37dd7-140">Um[!INCLUDE[ssFosAuto](../../../includes/ssfosauto-md.md)]terá efeito apenas se a réplica secundária estiver SYNCHRONIZED no momento com a réplica primária.</span><span class="sxs-lookup"><span data-stu-id="37dd7-140">An[!INCLUDE[ssFosAuto](../../../includes/ssfosauto-md.md)]takes effect only if the secondary replica is currently SYNCHRONIZED with the primary replica.</span></span>  
  
 [!INCLUDE[ssFosSyncC](../../../includes/ssfossyncc-md.md)]  
 <span data-ttu-id="37dd7-141">Em um grupo de disponibilidade específico, um conjunto de duas ou três réplicas de disponibilidade (inclusive a réplica primária atual) que estão configuradas para o modo de confirmação síncrona, se houver.</span><span class="sxs-lookup"><span data-stu-id="37dd7-141">Within a given availability group, a set of two or three availability replicas (including the current primary replica) that are configured for synchronous-commit mode, if any.</span></span> <span data-ttu-id="37dd7-142">Um [!INCLUDE[ssFosSync](../../../includes/ssfossync-md.md)]terá efeito apenas se as réplicas secundárias estiverem configuradas para modo de failover manual e pelo menos uma réplica secundária estiver SYNCHRONIZED no momento com a réplica primária.</span><span class="sxs-lookup"><span data-stu-id="37dd7-142">A [!INCLUDE[ssFosSync](../../../includes/ssfossync-md.md)]takes effect only if the secondary replicas are configured for manual failover mode and at least one secondary replica is currently SYNCHRONIZED with the primary replica.</span></span>  
  
 [!INCLUDE[ssFosEntireC](../../../includes/ssfosentirec-md.md)]  
 <span data-ttu-id="37dd7-143">Dentro de um determinado grupo de disponibilidade, o conjunto de todas as réplicas de disponibilidade cujo estado operacional é ONLINE no momento, independentemente do modo de disponibilidade e do modo de failover.</span><span class="sxs-lookup"><span data-stu-id="37dd7-143">Within a given availability group, the set of all availability replicas whose operational state is currently ONLINE, regardless of availability mode and of failover mode.</span></span> <span data-ttu-id="37dd7-144">O [!INCLUDE[ssFosEntire](../../../includes/ssfosentire-md.md)]se tornará relevante quando nenhuma réplica secundária estiver SYNCHRONIZED no momento com a réplica primária.</span><span class="sxs-lookup"><span data-stu-id="37dd7-144">The [!INCLUDE[ssFosEntire](../../../includes/ssfosentire-md.md)]becomes relevant when no secondary replica is currently SYNCHRONIZED with the primary replica.</span></span>  
  
##  <a name="overview-of-failover"></a><a name="Overview"></a> <span data-ttu-id="37dd7-145">Visão geral de failover</span><span class="sxs-lookup"><span data-stu-id="37dd7-145">Overview of Failover</span></span>  
 <span data-ttu-id="37dd7-146">A tabela a seguir resume os formulários de failover com suporte sob diferentes modos de disponibilidade e failover.</span><span class="sxs-lookup"><span data-stu-id="37dd7-146">The following table summarizes which forms of failover are supported under different availability and failover modes.</span></span> <span data-ttu-id="37dd7-147">Para cada emparelhamento, o modo de disponibilidade efetiva e o modo de failover são determinados pela interseção dos modos de réplica primária mais os modos de uma ou mais réplicas secundárias.</span><span class="sxs-lookup"><span data-stu-id="37dd7-147">For each pairing, the effective availability mode and failover mode is determined by the intersection of the modes of the primary replica plus the modes of one or more secondary replicas.</span></span>  
  
||<span data-ttu-id="37dd7-148">Modo de confirmação assíncrona</span><span class="sxs-lookup"><span data-stu-id="37dd7-148">Asynchronous-commit mode</span></span>|<span data-ttu-id="37dd7-149">Modo de confirmação síncrona com modo de failover manual</span><span class="sxs-lookup"><span data-stu-id="37dd7-149">Synchronous-commit mode with manual-failover mode</span></span>|<span data-ttu-id="37dd7-150">Modo de confirmação síncrona com modo de failover automático</span><span class="sxs-lookup"><span data-stu-id="37dd7-150">Synchronous-commit mode with automatic-failover mode</span></span>|  
|-|-------------------------------|---------------------------------------------------------|------------------------------------------------------------|  
|<span data-ttu-id="37dd7-151">failover automático</span><span class="sxs-lookup"><span data-stu-id="37dd7-151">Automatic failover</span></span>|<span data-ttu-id="37dd7-152">Não</span><span class="sxs-lookup"><span data-stu-id="37dd7-152">No</span></span>|<span data-ttu-id="37dd7-153">Não</span><span class="sxs-lookup"><span data-stu-id="37dd7-153">No</span></span>|<span data-ttu-id="37dd7-154">Sim</span><span class="sxs-lookup"><span data-stu-id="37dd7-154">Yes</span></span>|  
|<span data-ttu-id="37dd7-155">Failover manual planejado</span><span class="sxs-lookup"><span data-stu-id="37dd7-155">Planned manual failover</span></span>|<span data-ttu-id="37dd7-156">Não</span><span class="sxs-lookup"><span data-stu-id="37dd7-156">No</span></span>|<span data-ttu-id="37dd7-157">Sim</span><span class="sxs-lookup"><span data-stu-id="37dd7-157">Yes</span></span>|<span data-ttu-id="37dd7-158">Sim</span><span class="sxs-lookup"><span data-stu-id="37dd7-158">Yes</span></span>|  
|<span data-ttu-id="37dd7-159">failover forçado</span><span class="sxs-lookup"><span data-stu-id="37dd7-159">Forced failover</span></span>|<span data-ttu-id="37dd7-160">Sim</span><span class="sxs-lookup"><span data-stu-id="37dd7-160">Yes</span></span>|<span data-ttu-id="37dd7-161">Sim</span><span class="sxs-lookup"><span data-stu-id="37dd7-161">Yes</span></span>|<span data-ttu-id="37dd7-162">Ok**<sup>\*</sup>**</span><span class="sxs-lookup"><span data-stu-id="37dd7-162">Yes**<sup>\*</sup>**</span></span>|  
  
 <span data-ttu-id="37dd7-163">**<sup>\*</sup>** Se você emitir um comando de failover forçado em uma réplica secundária sincronizada, a réplica secundária se comformará com o mesmo de um failover manual.</span><span class="sxs-lookup"><span data-stu-id="37dd7-163">**<sup>\*</sup>**  If you issue a forced failover command on a synchronized secondary replica, the secondary replica behaves the same as for a manual failover.</span></span>  
  
 <span data-ttu-id="37dd7-164">A quantidade de tempo durante o qual o banco de dados fica indisponível durante um failover depende do tipo de failover e de sua causa.</span><span class="sxs-lookup"><span data-stu-id="37dd7-164">The amount of time that the database is unavailable during a failover depends on the type of failover and its cause.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="37dd7-165">Para dar suporte a conexões de cliente depois de um failover, com exceção de bancos de dados independentes, os logons e os trabalhos definidos em quaisquer dos bancos de dados primários antigos devem ser recriados manualmente no novo banco de dados primário.</span><span class="sxs-lookup"><span data-stu-id="37dd7-165">To support client connections after failover, except for contained databases, logins and jobs defined on any of the former primary databases must be manually recreated on the new primary database.</span></span> <span data-ttu-id="37dd7-166">Para obter mais informações, consulte [Gerenciamento de logons e trabalhos para os bancos de dados de um grupo de disponibilidade &#40;SQL Server&#41;](../../logins-and-jobs-for-availability-group-databases.md).</span><span class="sxs-lookup"><span data-stu-id="37dd7-166">For more information, see [Management of Logins and Jobs for the Databases of an Availability Group &#40;SQL Server&#41;](../../logins-and-jobs-for-availability-group-databases.md).</span></span>  
  
### <a name="failover-sets"></a><span data-ttu-id="37dd7-167">Conjuntos de failover</span><span class="sxs-lookup"><span data-stu-id="37dd7-167">Failover Sets</span></span>  
 <span data-ttu-id="37dd7-168">As formas de failover possíveis para um determinado grupo de disponibilidade podem ser compreendidas em termos de conjuntos de failover.</span><span class="sxs-lookup"><span data-stu-id="37dd7-168">The forms of failover that are possible for a given availability group can be understood in terms of failover sets.</span></span> <span data-ttu-id="37dd7-169">Um conjunto de failover consiste na réplica primária e nas réplicas secundárias que oferecem suporte a uma determinada forma de failover, da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="37dd7-169">A failover set consists of the primary replica and secondary replicas that support a given form of failover, as follows:</span></span>  
  
-   <span data-ttu-id="37dd7-170">**[!INCLUDE[ssFosAutoC](../../../includes/ssfosautoc-md.md)] (opcional):**  Em um grupo de disponibilidade específico, existe apenas um par de réplicas de disponibilidade (inclusive a réplica primária atual) que está configurado para o modo de confirmação síncrona com failover automático, se houver.</span><span class="sxs-lookup"><span data-stu-id="37dd7-170">**[!INCLUDE[ssFosAutoC](../../../includes/ssfosautoc-md.md)] (optional):**  Within a given availability group, a pair of availability replicas (including the current primary replica) that are configured for synchronous-commit mode with automatic failover, if any.</span></span> <span data-ttu-id="37dd7-171">Um conjunto de failover automático terá efeito apenas se a réplica secundária estiver SYNCHRONIZED no momento com a réplica primária.</span><span class="sxs-lookup"><span data-stu-id="37dd7-171">An automatic failover set takes effect only if the secondary replica is currently SYNCHRONIZED with the primary replica.</span></span>  
  
-   <span data-ttu-id="37dd7-172">**[!INCLUDE[ssFosSyncC](../../../includes/ssfossyncc-md.md)] (opcional):**  Em um grupo de disponibilidade específico, um conjunto de duas ou três réplicas de disponibilidade (inclusive a réplica primária atual) que estão configuradas para o modo de confirmação síncrona, se houver.</span><span class="sxs-lookup"><span data-stu-id="37dd7-172">**[!INCLUDE[ssFosSyncC](../../../includes/ssfossyncc-md.md)] (optional):**  Within a given availability group, a set of two or three availability replicas (including the current primary replica) that are configured for synchronous-commit mode, if any.</span></span> <span data-ttu-id="37dd7-173">Um conjunto de failover de confirmação síncrona terá efeito se as réplicas secundárias estiverem configuradas para o modo de failover manual e pelo menos uma réplica secundária estiver SYNCHRONIZED no momento com a réplica primária.</span><span class="sxs-lookup"><span data-stu-id="37dd7-173">A synchronous-commit failover set takes effect only if the secondary replicas are configured for manual failover mode and at least one secondary replica is currently SYNCHRONIZED with the primary replica.</span></span>  
  
-   <span data-ttu-id="37dd7-174">**[!INCLUDE[ssFosEntireC](../../../includes/ssfosentirec-md.md)]:**  Dentro de um determinado grupo de disponibilidade, o conjunto de todas as réplicas de disponibilidade cujo estado operacional é ONLINE no momento, independentemente do modo de disponibilidade e do modo de failover.</span><span class="sxs-lookup"><span data-stu-id="37dd7-174">**[!INCLUDE[ssFosEntireC](../../../includes/ssfosentirec-md.md)] :**  Within a given availability group, the set of all availability replicas whose operational state is currently ONLINE, regardless of availability mode and of failover mode.</span></span> <span data-ttu-id="37dd7-175">O conjunto de failover inteiro se tornará relevante quando nenhuma réplica secundária estiver SYNCHRONIZED no momento com a réplica primária.</span><span class="sxs-lookup"><span data-stu-id="37dd7-175">The entire failover set becomes relevant when no secondary replica is currently SYNCHRONIZED with the primary replica.</span></span>  
  
 <span data-ttu-id="37dd7-176">Quando você configura uma réplica de disponibilidade como confirmação síncrona com failover automático, a réplica de disponibilidade se torna parte do [!INCLUDE[ssFosAuto](../../../includes/ssfosauto-md.md)].</span><span class="sxs-lookup"><span data-stu-id="37dd7-176">When you configure an availability replica as synchronous commit with automatic failover, the availability replica becomes part of the [!INCLUDE[ssFosAuto](../../../includes/ssfosauto-md.md)].</span></span> <span data-ttu-id="37dd7-177">Porém, se a definição entra em vigor ou não depende da primária atual.</span><span class="sxs-lookup"><span data-stu-id="37dd7-177">However whether the set takes effect depends the current primary.</span></span> <span data-ttu-id="37dd7-178">Os formulários de failover que são realmente possíveis em um determinado momento dependem de quais conjuntos de failover estão em vigor atualmente.</span><span class="sxs-lookup"><span data-stu-id="37dd7-178">The forms of failover that are actually possible at a given time depends on what failover sets are currently in effect.</span></span>  
  
 <span data-ttu-id="37dd7-179">Por exemplo, considere um grupo de disponibilidade que tem quatro réplicas de disponibilidade, da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="37dd7-179">For example, consider an availability group that has four availability replicas, as follows:</span></span>  
  
|<span data-ttu-id="37dd7-180">Réplica</span><span class="sxs-lookup"><span data-stu-id="37dd7-180">Replica</span></span>|<span data-ttu-id="37dd7-181">Modo de disponibilidade e configurações de modo de failover</span><span class="sxs-lookup"><span data-stu-id="37dd7-181">Availability Mode and Failover Mode Settings</span></span>|  
|-------------|--------------------------------------------------|  
|<span data-ttu-id="37dd7-182">Um</span><span class="sxs-lookup"><span data-stu-id="37dd7-182">A</span></span>|<span data-ttu-id="37dd7-183">Modo de confirmação síncrona com failover automático</span><span class="sxs-lookup"><span data-stu-id="37dd7-183">Synchronous commit with automatic failover</span></span>|  
|<span data-ttu-id="37dd7-184">B</span><span class="sxs-lookup"><span data-stu-id="37dd7-184">B</span></span>|<span data-ttu-id="37dd7-185">Modo de confirmação síncrona com failover automático</span><span class="sxs-lookup"><span data-stu-id="37dd7-185">Synchronous commit with automatic failover</span></span>|  
|<span data-ttu-id="37dd7-186">C</span><span class="sxs-lookup"><span data-stu-id="37dd7-186">C</span></span>|<span data-ttu-id="37dd7-187">Confirmação síncrona apenas com failover manual planejado</span><span class="sxs-lookup"><span data-stu-id="37dd7-187">Synchronous commit with planned manual failover only</span></span>|  
|<span data-ttu-id="37dd7-188">D</span><span class="sxs-lookup"><span data-stu-id="37dd7-188">D</span></span>|<span data-ttu-id="37dd7-189">Confirmação assíncrona (apenas com failover forçado)</span><span class="sxs-lookup"><span data-stu-id="37dd7-189">Asynchronous commit (with only forced failover)</span></span>|  
  
 <span data-ttu-id="37dd7-190">O comportamento do failover para cada réplica secundária depende de qual réplica de disponibilidade é a réplica primária no momento.</span><span class="sxs-lookup"><span data-stu-id="37dd7-190">The failover behavior for each secondary replica depends on which availability replica is currently the primary replica.</span></span> <span data-ttu-id="37dd7-191">Basicamente, para uma determinada réplica secundária, o comportamento de failover é o pior caso dependendo da réplica primária atual.</span><span class="sxs-lookup"><span data-stu-id="37dd7-191">Basically, for a given secondary replica, the failover behavior is the worst case given the current primary replica.</span></span> <span data-ttu-id="37dd7-192">A figura a seguir ilustra como o comportamento de failover de réplicas secundárias varia de acordo com a réplica primária atual, e se ela está configurada para o modo de confirmação assíncrona (apenas com failover forçado) ou modo de confirmação síncrona (com ou sem failover automático).</span><span class="sxs-lookup"><span data-stu-id="37dd7-192">The following figure illustrates how the failover behavior of secondary replicas varies depending on the current primary replica, and whether it is configured for asynchronous-commit mode (with only forced failover) or synchronous-commit mode (with or without automatic failover).</span></span>  
  
 <span data-ttu-id="37dd7-193">![Como a configuração da réplica primária afeta o failover](../../media/aoag-failoversetexample.gif "Como a configuração da réplica primária afeta o failover")</span><span class="sxs-lookup"><span data-stu-id="37dd7-193">![How primary replica configuration affects failover](../../media/aoag-failoversetexample.gif "How primary replica configuration affects failover")</span></span>  
  
##  <a name="automatic-failover"></a><a name="AutomaticFailover"></a> <span data-ttu-id="37dd7-194">Automatic Failover</span><span class="sxs-lookup"><span data-stu-id="37dd7-194">Automatic Failover</span></span>  
 <span data-ttu-id="37dd7-195">Um failover automático faz com que uma réplica secundária qualificada faça a transição automática para a função primária depois que a réplica primária se torna indisponível.</span><span class="sxs-lookup"><span data-stu-id="37dd7-195">An automatic failover causes a qualified secondary replica to automatically transition to the primary role after the primary replica becomes unavailable.</span></span> <span data-ttu-id="37dd7-196">O failover automático é mais adequado quando o nó WSFC que hospeda a réplica primária é local em relação ao nó que hospeda a réplica secundária.</span><span class="sxs-lookup"><span data-stu-id="37dd7-196">Automatic failover is best suited when the WSFC node that hosts the primary replica is local to the node that hosts the secondary replica.</span></span> <span data-ttu-id="37dd7-197">Isso ocorre porque a sincronização de dados funciona melhor com baixa latência de mensagem entre computadores e porque as conexões cliente podem permanecer locais.</span><span class="sxs-lookup"><span data-stu-id="37dd7-197">This is because data synchronization works best with low message latency between computers and because client connections can remain local.</span></span>  
  
  
###  <a name="conditions-required-for-an-automatic-failover"></a><a name="RequiredConditions"></a> <span data-ttu-id="37dd7-198">Condições exigidas para um failover automático</span><span class="sxs-lookup"><span data-stu-id="37dd7-198">Conditions Required for an Automatic Failover</span></span>  
 <span data-ttu-id="37dd7-199">O failover automático ocorre apenas sob as seguintes condições:</span><span class="sxs-lookup"><span data-stu-id="37dd7-199">Automatic failover occurs only under the following conditions:</span></span>  
  
-   <span data-ttu-id="37dd7-200">Um conjunto de failover automático existe.</span><span class="sxs-lookup"><span data-stu-id="37dd7-200">An automatic failover set exists.</span></span> <span data-ttu-id="37dd7-201">Este conjunto consiste em uma réplica primária e uma réplica secundária (o *destino do failover automático*) que estão configuradas para modo de confirmação síncrona e ambas estão definidas como failover AUTOMATIC.</span><span class="sxs-lookup"><span data-stu-id="37dd7-201">This set consists of a primary replica and a secondary replica (the *automatic failover target*) that are both configured for synchronous-commit mode and set to AUTOMATIC failover.</span></span> <span data-ttu-id="37dd7-202">HYPERLINK "file:///C:\\\Users\\\marshow\\\AppData\\\Local\\\Temp\\\DxEditor\\\DduePreview\\\Default\\\6fe88e12-4df1-4025-ba24-7579635ccecf\\\HTM\\\html\\\29e0ac5d-eb58-4801-82b9-e278f08db920"  Se a réplica primária estiver configurada para failover MANUAL, o failover automático não será executado, mesmo se uma réplica secundária estiver configurada para failover AUTOMATIC.</span><span class="sxs-lookup"><span data-stu-id="37dd7-202">HYPERLINK "file:///C:\\\Users\\\marshow\\\AppData\\\Local\\\Temp\\\DxEditor\\\DduePreview\\\Default\\\6fe88e12-4df1-4025-ba24-7579635ccecf\\\HTM\\\html\\\29e0ac5d-eb58-4801-82b9-e278f08db920"  If the primary replica is set MANUAL failover, automatic failover cannot occur, even if a secondary replica is set to AUTOMATIC failover.</span></span>  
  
     <span data-ttu-id="37dd7-203">Para obter mais informações, consulte [Modos de disponibilidade &#40;Grupos de Disponibilidade AlwaysOn&#41;](availability-modes-always-on-availability-groups.md).</span><span class="sxs-lookup"><span data-stu-id="37dd7-203">For more information, see [Availability Modes &#40;AlwaysOn Availability Groups&#41;](availability-modes-always-on-availability-groups.md).</span></span>  
  
-   <span data-ttu-id="37dd7-204">O destino do failover automático tem um estado de sincronização íntegro (isto indica que todo banco de dados secundário no destino de failover é sincronizado com seu banco de dados primário correspondente).</span><span class="sxs-lookup"><span data-stu-id="37dd7-204">The automatic failover target has a healthy synchronization state (this indicates that every secondary database on the failover target is synchronized with its corresponding primary database).</span></span>  
  
    > [!TIP]  
    >  <span data-ttu-id="37dd7-205">Os Grupos de Disponibilidade AlwaysOn monitoram a integridade das duas réplicas em um conjunto de failover automático.</span><span class="sxs-lookup"><span data-stu-id="37dd7-205">AlwaysOn Availability Groups monitors the health of both replicas in an automatic failover set.</span></span> <span data-ttu-id="37dd7-206">Se alguma réplica falhar, o estado de integridade do grupo de disponibilidade será definido como CRITICAL.</span><span class="sxs-lookup"><span data-stu-id="37dd7-206">If either replica fails, the availability group's health state is set to CRITICAL.</span></span> <span data-ttu-id="37dd7-207">Se a réplica secundária falhar, o failover automático não será possível porque o destino de failover automático não estará disponível.</span><span class="sxs-lookup"><span data-stu-id="37dd7-207">If the secondary replica fails, automatic failover is not possible because the automatic failover target is unavailable.</span></span> <span data-ttu-id="37dd7-208">Se a réplica primária falhar, o grupo de disponibilidade realizará failover para a réplica secundária.</span><span class="sxs-lookup"><span data-stu-id="37dd7-208">If the primary replica fails, the availability group will fail over to the secondary replica.</span></span> <span data-ttu-id="37dd7-209">Até que a réplica primária antiga fique online, nenhum destino de failover automático existirá.</span><span class="sxs-lookup"><span data-stu-id="37dd7-209">Until the former primary replica comes online, no automatic failover target exists.</span></span> <span data-ttu-id="37dd7-210">Em qualquer caso, para garantir a disponibilidade no caso improvável de uma falha sequencial, recomendamos que você configure uma réplica secundária diferente como o destino de failover automático.</span><span class="sxs-lookup"><span data-stu-id="37dd7-210">In either case, to ensure availability in the unlikely case of a sequential failure, we recommend that you configure a different secondary replica as the automatic failover target.</span></span>  
    >   
    >  <span data-ttu-id="37dd7-211">Para obter mais informações, consulte [Usar as políticas AlwaysOn para exibir a integridade de um Grupo de Disponibilidade &#40;SQL Server&#41;](use-always-on-policies-to-view-the-health-of-an-availability-group-sql-server.md) e [Alterar o modo de failover de uma réplica de disponibilidade &#40;SQL Server&#41;](change-the-failover-mode-of-an-availability-replica-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="37dd7-211">For more information, see [Use AlwaysOn Policies to View the Health of an Availability Group &#40;SQL Server&#41;](use-always-on-policies-to-view-the-health-of-an-availability-group-sql-server.md) and [Change the Failover Mode of an Availability Replica &#40;SQL Server&#41;](change-the-failover-mode-of-an-availability-replica-sql-server.md).</span></span>  
  
-   <span data-ttu-id="37dd7-212">O cluster do WSFC (Windows Server Failover Clustering) tem quorum.</span><span class="sxs-lookup"><span data-stu-id="37dd7-212">The Windows Server Failover Clustering (WSFC) cluster has quorum.</span></span> <span data-ttu-id="37dd7-213">Para obter mais informações, veja [Configuração de modos de quorum WSFC e votação &#40;SQL Server&#41;](../../../sql-server/failover-clusters/windows/wsfc-quorum-modes-and-voting-configuration-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="37dd7-213">For more information, see [WSFC Quorum Modes and Voting Configuration &#40;SQL Server&#41;](../../../sql-server/failover-clusters/windows/wsfc-quorum-modes-and-voting-configuration-sql-server.md).</span></span>  
  
-   <span data-ttu-id="37dd7-214">A réplica primária se tornou indisponível, e os níveis da condição de failover definidos por sua política de failover flexível foram atendidos.</span><span class="sxs-lookup"><span data-stu-id="37dd7-214">The primary replica has become unavailable, and the failover-condition levels defined by your the flexible failover policy have been met.</span></span> <span data-ttu-id="37dd7-215">Para obter informações sobre os níveis de condição de failover, consulte [Política de failover flexível para failover automático de um grupo de disponibilidade &#40;SQL Server&#41;](flexible-automatic-failover-policy-availability-group.md).</span><span class="sxs-lookup"><span data-stu-id="37dd7-215">For information about failover-condition levels, see [Flexible Failover Policy for Automatic Failover of an Availability Group &#40;SQL Server&#41;](flexible-automatic-failover-policy-availability-group.md).</span></span>  
  
###  <a name="how-automatic-failover-works"></a><a name="HowAutoFoWorks"></a> <span data-ttu-id="37dd7-216">Como o failover automático funciona</span><span class="sxs-lookup"><span data-stu-id="37dd7-216">How Automatic Failover Works</span></span>  
 <span data-ttu-id="37dd7-217">Um failover automático inicia a seguinte sequência de ações:</span><span class="sxs-lookup"><span data-stu-id="37dd7-217">An automatic failover initiates the following sequence of actions:</span></span>  
  
1.  <span data-ttu-id="37dd7-218">Se a instância do servidor que está hospedando a réplica primária atual ainda estiver em execução, ela alterará o estado dos bancos de dados primários para DISCONNECTED e desconectará todos os clientes.</span><span class="sxs-lookup"><span data-stu-id="37dd7-218">If the server instance that is hosting the current primary replica is still running, it changes the state of the primary databases to DISCONNECTED and disconnects all clients.</span></span>  
  
2.  <span data-ttu-id="37dd7-219">Se qualquer registro de log estiver esperando em filas de recuperação na réplica secundária de destino, a réplica secundária aplicará os registros de log restantes para concluir o roll forward dos bancos de dados secundários.</span><span class="sxs-lookup"><span data-stu-id="37dd7-219">If any log records are waiting in recovery queues on the target secondary replica, the secondary replica applies the remaining log records to finish rolling forward the secondary databases.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="37dd7-220">A quantidade de tempo exigida para aplicar o log a um determinado banco de dados depende da velocidade do sistema, da carga de trabalho recente e da quantidade de log na fila de recuperação.</span><span class="sxs-lookup"><span data-stu-id="37dd7-220">The amount of time required to apply the log to a given database depends on the speed of the system, the recent work load, and the amount of log in the recovery queue.</span></span>  
  
3.  <span data-ttu-id="37dd7-221">A réplica secundária antiga faz a transição para a função primária.</span><span class="sxs-lookup"><span data-stu-id="37dd7-221">The former secondary replica transitions to the primary role.</span></span> <span data-ttu-id="37dd7-222">Seus bancos de dados se tornam os bancos de dados primários.</span><span class="sxs-lookup"><span data-stu-id="37dd7-222">Its databases become the primary databases.</span></span> <span data-ttu-id="37dd7-223">A nova réplica primária reverte todas as transações não confirmadas (a fase desfazer da recuperação) o mais rapidamente possível.</span><span class="sxs-lookup"><span data-stu-id="37dd7-223">The new primary replica rolls back any uncommitted transactions (the undo phase of recovery) as quickly as possible.</span></span> <span data-ttu-id="37dd7-224">Bloqueios isolam essas transações não confirmadas permitindo que a reversão ocorra em segundo plano enquanto os clientes usam o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="37dd7-224">Locks isolate these uncommitted transactions, allowing roll back to occur in the background while clients use the database.</span></span> <span data-ttu-id="37dd7-225">Esse processo não reverte nenhuma transação confirmada.</span><span class="sxs-lookup"><span data-stu-id="37dd7-225">This process does not roll back any committed transactions.</span></span>  
  
     <span data-ttu-id="37dd7-226">Até um determinado banco de dados secundário ser conectado, ele é marcado rapidamente como NOT_SYNCHRONIZED.</span><span class="sxs-lookup"><span data-stu-id="37dd7-226">Until a given secondary database is connected, it is briefly marked as NOT_SYNCHRONIZED.</span></span> <span data-ttu-id="37dd7-227">Antes do início da recuperação da reversão, os bancos de dados secundários podem se conectar aos novos bancos de dados primários e fazer a transição rápida para o estado SYNCHRONIZED.</span><span class="sxs-lookup"><span data-stu-id="37dd7-227">Before the rollback recovery starts, secondary databases can connect to the new primary databases and quickly transition to the SYNCHRONIZED state.</span></span> <span data-ttu-id="37dd7-228">O melhor caso geralmente é aquele em que uma terceira réplica de confirmação síncrona permanece na função secundária após o failover.</span><span class="sxs-lookup"><span data-stu-id="37dd7-228">The best case is usually for a third synchronous-commit replica that remains in the secondary role after the failover.</span></span>  
  
4.  <span data-ttu-id="37dd7-229">Posteriormente, quando a instância de servidor que está hospedando a réplica primária antiga é reiniciada, ela reconhece que outra réplica de disponibilidade possui a função primária agora.</span><span class="sxs-lookup"><span data-stu-id="37dd7-229">Later, when the server instance that is hosting the former primary replica restarts, it recognizes that another availability replica now owns the primary role.</span></span> <span data-ttu-id="37dd7-230">A réplica primária antiga faz a transição para a função secundária e seus bancos de dados se tornam bancos de dados secundários.</span><span class="sxs-lookup"><span data-stu-id="37dd7-230">The former primary replica transitions to the secondary role, and its databases become secondary databases.</span></span> <span data-ttu-id="37dd7-231">A nova réplica secundária conecta-se à réplica primária atual e atualiza seu banco de dados com os bancos de dados primários atuais o mais rapidamente possível.</span><span class="sxs-lookup"><span data-stu-id="37dd7-231">The new secondary replica connects to the current primary replica and catches its database up to the current primary databases as quickly as possible.</span></span> <span data-ttu-id="37dd7-232">Assim que a nova réplica secundária tiver sincronizado seus bancos de dados novamente, o failover será possível, na direção reversa.</span><span class="sxs-lookup"><span data-stu-id="37dd7-232">As soon as the new secondary replica has resynchronized its databases, failover is again possible, in the reverse direction.</span></span>  
  
###  <a name="to-configure-automatic-failover"></a><a name="EnableAutoFo"></a> <span data-ttu-id="37dd7-233">Para configurar o failover automático</span><span class="sxs-lookup"><span data-stu-id="37dd7-233">To Configure Automatic Failover</span></span>  
 <span data-ttu-id="37dd7-234">Uma réplica de disponibilidade pode ser configurada para dar suporte a failover automático a qualquer momento.</span><span class="sxs-lookup"><span data-stu-id="37dd7-234">An availability replica can be configured to support automatic failover at any point.</span></span>  
  
 <span data-ttu-id="37dd7-235">**To configure automatic failover**</span><span class="sxs-lookup"><span data-stu-id="37dd7-235">**To configure automatic failover**</span></span>  
  
1.  <span data-ttu-id="37dd7-236">Verifique se a réplica secundária está configurada para usar o modo de disponibilidade de confirmação síncrona.</span><span class="sxs-lookup"><span data-stu-id="37dd7-236">Ensure that the secondary replica is configured to use the synchronous-commit availability mode.</span></span> <span data-ttu-id="37dd7-237">Para obter mais informações, consulte [Alterar o modo de disponibilidade de uma réplica de disponibilidade &#40;SQL Server&#41;](change-the-availability-mode-of-an-availability-replica-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="37dd7-237">For more information, see [Change the Availability Mode of an Availability Replica &#40;SQL Server&#41;](change-the-availability-mode-of-an-availability-replica-sql-server.md).</span></span>  
  
2.  <span data-ttu-id="37dd7-238">Defina o modo do failover como automático.</span><span class="sxs-lookup"><span data-stu-id="37dd7-238">Set the failover mode to automatic.</span></span> <span data-ttu-id="37dd7-239">Para obter mais informações, consulte [Alterar o modo de failover de uma réplica de disponibilidade &#40;SQL Server&#41;](change-the-failover-mode-of-an-availability-replica-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="37dd7-239">For more information, see [Change the Failover Mode of an Availability Replica &#40;SQL Server&#41;](change-the-failover-mode-of-an-availability-replica-sql-server.md).</span></span>  
  
3.  <span data-ttu-id="37dd7-240">Opcionalmente, altere a política de failover flexível do grupo de disponibilidade para especificar as classificações de falhas que podem causar um failover automático.</span><span class="sxs-lookup"><span data-stu-id="37dd7-240">Optionally, change the flexible failover policy of the availability group to specify the sorts of failures that can cause an automatic failover to occur.</span></span> <span data-ttu-id="37dd7-241">Para obter mais informações, consulte [Configurar a política de failover flexível para condições de controle para failover automático e &#40; Grupos de disponibilidade AlwaysOn&#41;](configure-flexible-automatic-failover-policy.md) HYPERLINK "file:///C:\\\Users\\\marshow\\\AppData\\\Local\\\Temp\\\DxEditor\\\DduePreview\\\Default\\\6a8d98a9-6e6a-40d1-9809-efa9013d7452\\\HTM\\\html\\\1ed564b4-9835-4245-ae35-9ba67419a4ce" e [Política de failover para instâncias de cluster de failover](../../../sql-server/failover-clusters/windows/failover-policy-for-failover-cluster-instances.md).</span><span class="sxs-lookup"><span data-stu-id="37dd7-241">For more information, see [Configure the Flexible Failover Policy to Control Conditions for Automatic Failover &#40;AlwaysOn Availability Groups&#41;](configure-flexible-automatic-failover-policy.md) HYPERLINK "file:///C:\\\Users\\\marshow\\\AppData\\\Local\\\Temp\\\DxEditor\\\DduePreview\\\Default\\\6a8d98a9-6e6a-40d1-9809-efa9013d7452\\\HTM\\\html\\\1ed564b4-9835-4245-ae35-9ba67419a4ce"  and [Failover Policy for Failover Cluster Instances](../../../sql-server/failover-clusters/windows/failover-policy-for-failover-cluster-instances.md).</span></span>  
  
##  <a name="planned-manual-failover-without-data-loss"></a><a name="ManualFailover"></a> <span data-ttu-id="37dd7-242">Failover manual planejado (sem perda de dados)</span><span class="sxs-lookup"><span data-stu-id="37dd7-242">Planned Manual Failover (Without Data Loss)</span></span>  
 <span data-ttu-id="37dd7-243">Um failover manual faz com que uma réplica secundária sincronizada faça a transição para a função primária depois que um administrador de banco de dados emite um comando de failover manual na instância do servidor que hospeda a réplica secundária de destino.</span><span class="sxs-lookup"><span data-stu-id="37dd7-243">A manual failover causes a synchronized secondary replica to transition to the primary role after a database administrator issues a manual-failover command on the server instance that hosts the target secondary replica.</span></span> <span data-ttu-id="37dd7-244">Para dar suporte ao failover manual, a réplica secundária e a réplica primária atual devem ser configuradas para o modo de confirmação síncrona, se houver.</span><span class="sxs-lookup"><span data-stu-id="37dd7-244">To support manual failover, the secondary replica and the current primary replica must both be configured for synchronous-commit mode, if any.</span></span> <span data-ttu-id="37dd7-245">Todo banco de dados secundário na réplica de disponibilidade deve ser unido ao grupo de disponibilidade e sincronizado com seu banco de dados primário correspondente (ou seja, a réplica secundária deve ser sincronizada).</span><span class="sxs-lookup"><span data-stu-id="37dd7-245">Every secondary database on the availability replica must be joined to the availability group and synchronized with its corresponding primary database (that is, the secondary replica must be synchronized).</span></span> <span data-ttu-id="37dd7-246">Isso garante que todas as transações confirmadas em um banco de dados primário antigo também foram confirmadas no novo banco de dados primário.</span><span class="sxs-lookup"><span data-stu-id="37dd7-246">This guarantees that every transaction that was committed on a former primary database has also been committed on the new primary database.</span></span> <span data-ttu-id="37dd7-247">Portanto, os novos bancos de dados primários são idênticos aos bancos de dados primários antigos.</span><span class="sxs-lookup"><span data-stu-id="37dd7-247">Therefore, the new primary databases are identical to the old primary databases.</span></span>  
  
 <span data-ttu-id="37dd7-248">A figura a seguir ilustra os estágios de um failover planejado:</span><span class="sxs-lookup"><span data-stu-id="37dd7-248">The following figure illustrates the stages of a planned failover:</span></span>  
  
1.  <span data-ttu-id="37dd7-249">Antes do failover, a réplica primária é hospedada pela instância de servidor em `Node01`.</span><span class="sxs-lookup"><span data-stu-id="37dd7-249">Before the failover, the primary replica is hosted by the server instance on `Node01`.</span></span>  
  
2.  <span data-ttu-id="37dd7-250">Um administrador de banco de dados inicia um failover planejado.</span><span class="sxs-lookup"><span data-stu-id="37dd7-250">A database administrator initiates a planned failover.</span></span> <span data-ttu-id="37dd7-251">O destino de failover é a réplica de disponibilidade hospedada pela instância de servidor em `Node02`.</span><span class="sxs-lookup"><span data-stu-id="37dd7-251">The failover target is the availability replica hosted by the server instance on `Node02`.</span></span>  
  
3.  <span data-ttu-id="37dd7-252">O destino de failover (em `Node02`) se torna a nova réplica primária.</span><span class="sxs-lookup"><span data-stu-id="37dd7-252">The failover target (on `Node02`) becomes the new primary replica.</span></span> <span data-ttu-id="37dd7-253">Como esse é um failover planejado, a réplica primária anterior alterna para a função secundária durante o failover e coloca seus bancos de dados online como bancos de dados secundários imediatamente.</span><span class="sxs-lookup"><span data-stu-id="37dd7-253">Because this is a planned failover, the former primary replica switches to the secondary role during the failover and brings its databases online as secondary databases immediately.</span></span>  
  
 <span data-ttu-id="37dd7-254">![Ilustração de um failover manual planejado](../../media/aoag-plannedmanualfailover.gif "Ilustração de um failover manual planejado")</span><span class="sxs-lookup"><span data-stu-id="37dd7-254">![Illustation of a planned manual failover](../../media/aoag-plannedmanualfailover.gif "Illustation of a planned manual failover")</span></span>  
  
  
###  <a name="conditions-required-for-a-manual-failover"></a><a name="ManualFailoverConditions"></a> <span data-ttu-id="37dd7-255">Condições exigidas para um failover manual</span><span class="sxs-lookup"><span data-stu-id="37dd7-255">Conditions Required for a Manual Failover</span></span>  
 <span data-ttu-id="37dd7-256">Para dar suporte a um failover manual, a réplica primária atual deve ser definida como modo de confirmação síncrona e uma réplica secundária deve ser:</span><span class="sxs-lookup"><span data-stu-id="37dd7-256">To support a manual failover, the current primary replica must be set to synchronous-commit mode and a secondary replica must be:</span></span>  
  
-   <span data-ttu-id="37dd7-257">configurada para o modo de confirmação síncrona.</span><span class="sxs-lookup"><span data-stu-id="37dd7-257">Configured for synchronous-commit mode.</span></span>  
  
-   <span data-ttu-id="37dd7-258">Sincronizada atualmente com a réplica primária.</span><span class="sxs-lookup"><span data-stu-id="37dd7-258">Currently synchronized with the primary replica.</span></span>  
  
 <span data-ttu-id="37dd7-259">Para fazer failover manual de um grupo de disponibilidade, você deve estar conectado à réplica secundária que está para se tornar a nova réplica primária.</span><span class="sxs-lookup"><span data-stu-id="37dd7-259">To manually fail over an availability group, you must be connected to the secondary replica that is to become the new primary replica.</span></span>  
  
###  <a name="how-a-planned-manual-failover-works"></a><a name="ManualFailoverHowWorks"></a> <span data-ttu-id="37dd7-260">Como o failover manual planejado funciona</span><span class="sxs-lookup"><span data-stu-id="37dd7-260">How a Planned Manual Failover Works</span></span>  
 <span data-ttu-id="37dd7-261">O failover manual planejado, que deve ser iniciado na réplica secundária de destino, inicia a seguinte sequência de ações:</span><span class="sxs-lookup"><span data-stu-id="37dd7-261">A planned manual failover, which must be initiated on the target secondary replica, initiates the following sequence of actions:</span></span>  
  
1.  <span data-ttu-id="37dd7-262">Para garantir que nenhuma nova transação de usuário ocorra nos bancos de dados primários originais, o cluster do WSFC envia uma solicitação à réplica primária para tornar-se offline.</span><span class="sxs-lookup"><span data-stu-id="37dd7-262">To ensure that no new user transactions occur on the original primary databases, the WSFC cluster sends a request to the primary replica to go offline.</span></span>  
  
2.  <span data-ttu-id="37dd7-263">Se algum log estiver esperando na fila de recuperação de qualquer banco de dados secundário, a réplica secundária concluirá o roll forward daquele banco de dados secundário.</span><span class="sxs-lookup"><span data-stu-id="37dd7-263">If any log is waiting in the recovery queue of any secondary database, the secondary replica finishes rolling forward that secondary database.</span></span> <span data-ttu-id="37dd7-264">A quantidade de tempo necessária depende da velocidade do sistema, da carga de trabalho recente e da quantidade de log na fila de recuperação.</span><span class="sxs-lookup"><span data-stu-id="37dd7-264">The amount of time required depends on the speed of the system, the recent workload, and the amount of log in the recovery queue.</span></span> <span data-ttu-id="37dd7-265">Para saber o tamanho atual da fila de recuperação, use o contador de desempenho **Recovery Queue** .</span><span class="sxs-lookup"><span data-stu-id="37dd7-265">To learn the current size of the recovery queue, use the **Recovery Queue** performance counter.</span></span> <span data-ttu-id="37dd7-266">Para obter mais informações, consulte [SQL Server, Réplica de Banco de Dados](../../../relational-databases/performance-monitor/sql-server-database-replica.md).</span><span class="sxs-lookup"><span data-stu-id="37dd7-266">For more information, see [SQL Server, Database Replica](../../../relational-databases/performance-monitor/sql-server-database-replica.md).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="37dd7-267">O tempo do failover pode ser controlado por meio da limitação do tamanho da fila de recuperação.</span><span class="sxs-lookup"><span data-stu-id="37dd7-267">The failover time can be regulated by limiting the size of the recovery queue.</span></span> <span data-ttu-id="37dd7-268">Porém, isso pode fazer com que a réplica primária se torne mais lenta para permitir que a réplica secundária acompanhe.</span><span class="sxs-lookup"><span data-stu-id="37dd7-268">However, this can cause the primary replica to slow down to allow the secondary replica to keep up.</span></span>  
  
3.  <span data-ttu-id="37dd7-269">A réplica secundária se torna a nova réplica primária, e a réplica secundária antiga se torna a nova réplica secundária.</span><span class="sxs-lookup"><span data-stu-id="37dd7-269">The secondary replica becomes the new primary replica, and the former primary replica becomes the new secondary replica.</span></span>  
  
4.  <span data-ttu-id="37dd7-270">A nova réplica primária reverte todas as transações não confirmadas e coloca seus bancos de dados online como os bancos de dados primários. Todos os bancos de dados secundários são marcados brevemente como NOT SYNCHRONIZED até que se conectem e se sincronizem novamente com os novos bancos de dados primários.</span><span class="sxs-lookup"><span data-stu-id="37dd7-270">The new primary replica rolls back any uncommitted transactions and brings its databases online as the primary databases.All secondary databases are briefly marked as NOT SYNCHRONIZED until they connect and resynchronize to the new primary databases.</span></span> <span data-ttu-id="37dd7-271">Esse processo não reverte nenhuma transação confirmada.</span><span class="sxs-lookup"><span data-stu-id="37dd7-271">This process does not roll back any committed transactions.</span></span>  
  
5.  <span data-ttu-id="37dd7-272">Quando a réplica primária antiga volta a ficar online, ela assume a função secundária, e o banco de dados primário antigo se torna o banco de dados secundário.</span><span class="sxs-lookup"><span data-stu-id="37dd7-272">When the former primary replica comes back online, it takes on the secondary role, and the former primary database becomes the secondary database.</span></span> <span data-ttu-id="37dd7-273">A nova réplica secundária ressincroniza rapidamente os novos bancos de dados secundários com os bancos de dados primários correspondentes.</span><span class="sxs-lookup"><span data-stu-id="37dd7-273">The new secondary replica quickly resynchronizes the new secondary databases with the corresponding primary databases.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="37dd7-274">Assim que a nova réplica secundária tiver sincronizado os bancos de dados novamente, o failover será possível, mas na direção reversa.</span><span class="sxs-lookup"><span data-stu-id="37dd7-274">As soon as the new secondary replica has resynchronized the databases, failover is again possible, but in the reverse direction.</span></span>  
  
 <span data-ttu-id="37dd7-275">Após o failover, os clientes devem se reconectar ao banco de dados primário atual.</span><span class="sxs-lookup"><span data-stu-id="37dd7-275">After failover, clients must reconnect to the current primary database.</span></span> <span data-ttu-id="37dd7-276">Para obter mais informações, consulte [Ouvintes do grupo de disponibilidade, conectividade de cliente e failover de aplicativo &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md).</span><span class="sxs-lookup"><span data-stu-id="37dd7-276">For more information, see [Availability Group Listeners, Client Connectivity, and Application Failover &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md).</span></span>  
  
###  <a name="maintaining-availability-during-upgrades"></a><a name="ManualFailoverDuringUpgrades"></a> <span data-ttu-id="37dd7-277">Mantendo a disponibilidade durante as atualizações</span><span class="sxs-lookup"><span data-stu-id="37dd7-277">Maintaining Availability During Upgrades</span></span>  
 <span data-ttu-id="37dd7-278">O administrador de banco de dados de seus grupos de disponibilidade pode usar failovers manuais para manter a disponibilidade dos bancos de dados quando você atualizar hardware ou software.</span><span class="sxs-lookup"><span data-stu-id="37dd7-278">The database administrator for your availability groups can use manual failovers to maintain database availability when you upgrade hardware or software.</span></span> <span data-ttu-id="37dd7-279">Para usar um grupo de disponibilidade para atualizações de software, a instância do servidor e/ou o nó do computador que hospeda a réplica secundária de destino já deverá ter recebido as atualizações.</span><span class="sxs-lookup"><span data-stu-id="37dd7-279">To use an availability group for software upgrades, the server instance and/or computer node that hosts the target secondary replica must have already received the upgrades.</span></span> <span data-ttu-id="37dd7-280">Para obter mais informações, consulte [Upgrade and Update of Availability Group Servers with Minimal Downtime and Data Loss](upgrading-always-on-availability-group-replica-instances.md).</span><span class="sxs-lookup"><span data-stu-id="37dd7-280">For more information, see [Upgrade and Update of Availability Group Servers with Minimal Downtime and Data Loss](upgrading-always-on-availability-group-replica-instances.md).</span></span>  
  
##  <a name="forced-failover-with-possible-data-loss"></a><a name="ForcedFailover"></a> <span data-ttu-id="37dd7-281">Failover forçado (com possível perda de dados)</span><span class="sxs-lookup"><span data-stu-id="37dd7-281">Forced Failover (with Possible Data Loss)</span></span>  
 <span data-ttu-id="37dd7-282">O failover forçado de um grupo de disponibilidade (com possível perda de dados) é um método de recuperação de desastres que permite usar uma réplica secundária como um servidor em espera passiva. Como o failover forçado gera riscos de possível perda de dados, esse recurso deve ser usado com cautela e moderação.</span><span class="sxs-lookup"><span data-stu-id="37dd7-282">Forcing failover of an availability group (with possible data loss) is a disaster recovery method that allows you to use a secondary replica as a warm standby server.Because forcing failover risks possible data loss, it should be used cautiously and sparingly.</span></span> <span data-ttu-id="37dd7-283">É recomendável forçar o failover apenas se você precisar restaurar serviço para seus bancos de dados de disponibilidade imediatamente e estiver disposto a perder dados.</span><span class="sxs-lookup"><span data-stu-id="37dd7-283">We recommend forcing failover only if you must restore service to your availability databases immediately and are willing to risk losing data.</span></span> <span data-ttu-id="37dd7-284">Para obter mais informações sobre os pré-requisitos e as recomendações para forçar failover e para obter um cenário de exemplo que usa um failover forçado para se recuperar de uma falha catastrófica, consulte [Executar um failover manual forçado de um grupo de disponibilidade &#40;SQL Server&#41;](perform-a-forced-manual-failover-of-an-availability-group-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="37dd7-284">For more information about the prerequisites and recommendations for forcing failover and for an example scenario that uses a forced failover to recover from a catastrophic failure, see [Perform a Forced Manual Failover of an Availability Group &#40;SQL Server&#41;](perform-a-forced-manual-failover-of-an-availability-group-sql-server.md).</span></span>  
  
> [!WARNING]  
>  <span data-ttu-id="37dd7-285">O failover forçado requer que o cluster WSFC tenha quorum.</span><span class="sxs-lookup"><span data-stu-id="37dd7-285">Forcing failover requires that the WSFC cluster have quorum.</span></span> <span data-ttu-id="37dd7-286">Para obter informações sobre como configurar e forçar o quorum, consulte [WSFC &#40;Windows Server Failover Clustering&#41; com o SQL Server](../../../sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="37dd7-286">For information about configuring quorum and forcing quorum, see [Windows Server Failover Clustering &#40;WSFC&#41; with SQL Server](../../../sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server.md).</span></span>  
  
  
###  <a name="how-forced-failover-works"></a><a name="ForcedFailoverHowWorks"></a> <span data-ttu-id="37dd7-287">Como o failover forçado funciona</span><span class="sxs-lookup"><span data-stu-id="37dd7-287">How Forced Failover Works</span></span>  
 <span data-ttu-id="37dd7-288">Um failover forçado inicia uma transição da função primária para uma réplica de destino cujo estado da função é SECONDARY ou RESOLVING.</span><span class="sxs-lookup"><span data-stu-id="37dd7-288">Forcing failover initiates a transition of the primary role to a target replica whose role is in the SECONDARY or RESOLVING state.</span></span> <span data-ttu-id="37dd7-289">O destino do failover se torna a nova réplica primária e logo oferece suas cópias dos bancos de dados para clientes.</span><span class="sxs-lookup"><span data-stu-id="37dd7-289">The failover target becomes the new primary replica and immediately serves its copies of the databases to clients.</span></span> <span data-ttu-id="37dd7-290">Quando a réplica primária antiga se tornar disponível, ela fará a transição para a função secundária e seus bancos de dados se tornarão bancos de dados secundários.</span><span class="sxs-lookup"><span data-stu-id="37dd7-290">When the former primary replica becomes available, it will transition to the secondary role and its databases will become secondary databases.</span></span>  
  
 <span data-ttu-id="37dd7-291">Todos os bancos de dados secundários (inclusive os bancos de dados primários antigos, quando ficam disponíveis) são SUSPENDED.</span><span class="sxs-lookup"><span data-stu-id="37dd7-291">All secondary databases (including the former primary databases, when they become available) are SUSPENDED.</span></span> <span data-ttu-id="37dd7-292">Dependendo do estado de sincronização de dados anterior de um banco de dados secundário suspenso, ele poderá ser adequado para salvar dados confirmados ausentes para esse banco de dados primário.</span><span class="sxs-lookup"><span data-stu-id="37dd7-292">Depending on the previous data synchronization state of a suspended secondary database, it might be suitable for salvaging missing committed data for that primary database.</span></span> <span data-ttu-id="37dd7-293">Em uma réplica secundária configurada para acesso somente leitura, você pode consultar os bancos de dados secundários para descobrir manualmente dados ausentes.</span><span class="sxs-lookup"><span data-stu-id="37dd7-293">On a secondary replica that is configured for read-only access, you can query the secondary databases to manually discover missing data.</span></span> <span data-ttu-id="37dd7-294">Em seguida, você pode emitir instruções [!INCLUDE[tsql](../../../includes/tsql-md.md)] para fazer as alterações necessárias nos novos bancos de dados primários.</span><span class="sxs-lookup"><span data-stu-id="37dd7-294">Then you can issue [!INCLUDE[tsql](../../../includes/tsql-md.md)] statements on the new primary databases to make any necessary changes.</span></span>  
  
###  <a name="risks-of-forcing-failover"></a><a name="ForcedFailoverRisks"></a> <span data-ttu-id="37dd7-295">Riscos de forçar o failover</span><span class="sxs-lookup"><span data-stu-id="37dd7-295">Risks of Forcing Failover</span></span>  
 <span data-ttu-id="37dd7-296">É essencial compreender que forçar o failover pode provocar perda de dados.</span><span class="sxs-lookup"><span data-stu-id="37dd7-296">It is essential to understand that forcing failover can cause data loss.</span></span> <span data-ttu-id="37dd7-297">É possível que haja perda de dados porque a réplica de destino não pode se comunicar com a réplica primária e, portanto, não pode garantir que os bancos de dados estejam sincronizados.</span><span class="sxs-lookup"><span data-stu-id="37dd7-297">Data loss is possible because the target replica cannot communicate with the primary replica and, therefore, cannot guarantee that the databases are synchronized.</span></span> <span data-ttu-id="37dd7-298">O forçamento do failover inicia uma bifurcação de recuperação.</span><span class="sxs-lookup"><span data-stu-id="37dd7-298">Forcing failover starts a new recovery fork.</span></span> <span data-ttu-id="37dd7-299">Como os bancos de dados primários originais e os bancos de dados secundários estão em bifurcações de recuperação diferentes, cada banco de dados agora contém dados que o outro banco de dados não tem: cada banco de dados primário original contém as alterações que ainda não foram enviadas de sua fila de envio para o banco de dados secundário antigo (o log não enviado); o banco de dados secundário antigo contém as alterações feitas depois que o failover foi forçado.</span><span class="sxs-lookup"><span data-stu-id="37dd7-299">Because the original primary databases and secondary databases are on different recovery forks, each of them now contains data that the other database does not contain: each original primary database contains whatever changes were not yet sent from its send queue to the former secondary database (the unsent log); the former secondary databases contain whatever changes occur after failover was forced.</span></span>  
  
 <span data-ttu-id="37dd7-300">Se o failover for forçado porque houve falha na réplica primária, a perda potencial de dados dependerá de os logs de transações não terem sido enviados à réplica secundária antes da ocorrência da falha.</span><span class="sxs-lookup"><span data-stu-id="37dd7-300">If failover is forced because the primary replica has failed, potential data loss is depends on whether any transaction logs had not been sent to the secondary replica before the failure.</span></span> <span data-ttu-id="37dd7-301">No modo de confirmação assíncrona, o log acumulado não enviado é sempre uma possibilidade.</span><span class="sxs-lookup"><span data-stu-id="37dd7-301">Under the asynchronous-commit mode, accumulated unsent log is always a possibility.</span></span> <span data-ttu-id="37dd7-302">No modo de confirmação síncrona, isso é possível apenas até que os bancos de dados secundários sejam sincronizados.</span><span class="sxs-lookup"><span data-stu-id="37dd7-302">Under synchronous-commit mode, this is possible only until the secondary databases becomes synchronized.</span></span>  
  
 <span data-ttu-id="37dd7-303">A tabela a seguir resume a possibilidade de perda de dados para um banco de dados específico na réplica para a qual você força o failover.</span><span class="sxs-lookup"><span data-stu-id="37dd7-303">The following table summarizes the possibility of data loss for a particular database on the replica to which you force failover.</span></span>  
  
|<span data-ttu-id="37dd7-304">Modo de disponibilidade de réplica secundária</span><span class="sxs-lookup"><span data-stu-id="37dd7-304">Availability mode of Secondary Replica</span></span>|<span data-ttu-id="37dd7-305">O bancos de dados é sincronizado?</span><span class="sxs-lookup"><span data-stu-id="37dd7-305">Is database synchronized?</span></span>|<span data-ttu-id="37dd7-306">É possível haver perda de dados?</span><span class="sxs-lookup"><span data-stu-id="37dd7-306">Is data loss possible?</span></span>|  
|--------------------------------------------|-------------------------------|----------------------------|  
|<span data-ttu-id="37dd7-307">Synchronous-commit</span><span class="sxs-lookup"><span data-stu-id="37dd7-307">Synchronous-commit</span></span>|<span data-ttu-id="37dd7-308">Sim</span><span class="sxs-lookup"><span data-stu-id="37dd7-308">Yes</span></span>|<span data-ttu-id="37dd7-309">Não</span><span class="sxs-lookup"><span data-stu-id="37dd7-309">No</span></span>|  
|<span data-ttu-id="37dd7-310">Synchronous-commit</span><span class="sxs-lookup"><span data-stu-id="37dd7-310">Synchronous-commit</span></span>|<span data-ttu-id="37dd7-311">Não</span><span class="sxs-lookup"><span data-stu-id="37dd7-311">No</span></span>|<span data-ttu-id="37dd7-312">Sim</span><span class="sxs-lookup"><span data-stu-id="37dd7-312">Yes</span></span>|  
|<span data-ttu-id="37dd7-313">Asynchronous-commit</span><span class="sxs-lookup"><span data-stu-id="37dd7-313">Asynchronous-commit</span></span>|<span data-ttu-id="37dd7-314">Não</span><span class="sxs-lookup"><span data-stu-id="37dd7-314">No</span></span>|<span data-ttu-id="37dd7-315">Sim</span><span class="sxs-lookup"><span data-stu-id="37dd7-315">Yes</span></span>|  
||||  
  
 <span data-ttu-id="37dd7-316">Os bancos de dados secundários acompanham apenas duas bifurcações de recuperação, portanto, se você executar vários failovers forçados, nenhum banco de dados secundário que iniciou a sincronização de dados com o failover forçado anterior poderá ser retomado.</span><span class="sxs-lookup"><span data-stu-id="37dd7-316">Secondary databases track only two recovery forks, so if you perform multiple forced failovers, any secondary database that did start data synchronization with the previous force failover might not be able to resume.</span></span> <span data-ttu-id="37dd7-317">Se isso ocorrer, qualquer banco de dados secundário que não pode ser retomado precisará ser removido do grupo de disponibilidade e unido novamente depois de ser restaurado para o período correto e reunido para o grupo de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="37dd7-317">If this occurs, any secondary databases that cannot be resumed will need to be removed from the availability group, restored to the correct point in time, and rejoined to the availability group.</span></span> <span data-ttu-id="37dd7-318">Uma restauração não funcionará em várias bifurcações de recuperação, portanto, certifique-se de executar um backup do log depois de executar mais de um failover forçado.</span><span class="sxs-lookup"><span data-stu-id="37dd7-318">A restore will not work across multiple recovery forks, therefore, be sure to perform a log backup after performing more than one forced failover.</span></span>  
  
###  <a name="why-forced-failover-is-required-after-forcing-quorum"></a><a name="WhyFFoPostForcedQuorum"></a> <span data-ttu-id="37dd7-319">Por que o failover forçado é necessário após um quorum forçado</span><span class="sxs-lookup"><span data-stu-id="37dd7-319">Why Forced Failover is Required After Forcing Quorum</span></span>  
 <span data-ttu-id="37dd7-320">Depois de forçar o quorum no cluster WSFC (*quorum forçado*), é necessário realizar um failover forçado (com possível perda de dados) em cada grupo de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="37dd7-320">After quorum is forced on the WSFC cluster (*forced quorum*) you need to perform a forced failover (with possible data loss) on each availability group.</span></span> <span data-ttu-id="37dd7-321">O failover forçado é necessário porque o estado real dos valores do cluster WSFC pode ter sido perdido.</span><span class="sxs-lookup"><span data-stu-id="37dd7-321">The forced failover is required because the real state of the WSFC cluster values might have been lost.</span></span> <span data-ttu-id="37dd7-322">É necessário evitar failovers normais após um quorum forçado devido à possibilidade de que uma réplica secundária não sincronizada apareça para ser sincronizada no cluster WSFC reconfigurado.</span><span class="sxs-lookup"><span data-stu-id="37dd7-322">Preventing normal failovers after a forced quorum is required because of the possibility than an unsynchronized secondary replica would appear to be synchronized on the reconfigured WSFC cluster.</span></span>  
  
 <span data-ttu-id="37dd7-323">Por exemplo, considere um cluster WSFC que hospeda um grupo de disponibilidade em três nós:  O nó A hospeda a réplica primária e os nós B e C hospedam, cada um, uma réplica secundária.</span><span class="sxs-lookup"><span data-stu-id="37dd7-323">For example, consider a WSFC cluster that hosts an availability group on three nodes:  Node A hosts the primary replica and Node B and Node C each hosts a secondary replica.</span></span> <span data-ttu-id="37dd7-324">O nó C é desconectado do cluster WSFC enquanto a réplica secundária local é SYNCHRONIZED.</span><span class="sxs-lookup"><span data-stu-id="37dd7-324">Node C gets disconnected from the WSFC cluster while the local secondary replica is SYNCHRONIZED.</span></span>  <span data-ttu-id="37dd7-325">Mas os nós A e B retêm um quorum íntegro e o grupo de disponibilidade permanece online.</span><span class="sxs-lookup"><span data-stu-id="37dd7-325">But Node A and Node B retain a healthy quorum and the availability group remains online.</span></span> <span data-ttu-id="37dd7-326">No nó A, a réplica primária continua a aceitar atualizações e, no nó B, a réplica secundária continua a sincronizar com a réplica primária.</span><span class="sxs-lookup"><span data-stu-id="37dd7-326">On Node A, the primary replica continues to accept updates, and on Node B, the secondary replica continues to synchronize with the primary replica.</span></span> <span data-ttu-id="37dd7-327">A réplica secundária no nó C se torna não sincronizada e fica bem atrás da réplica primária.</span><span class="sxs-lookup"><span data-stu-id="37dd7-327">The secondary replica on Node C becomes unsynchronized and falls increasingly behind the primary replica.</span></span> <span data-ttu-id="37dd7-328">Entretanto, como o nó C é desconectado, a réplica permanece, incorretamente, no estado SYNCHRONIZED.</span><span class="sxs-lookup"><span data-stu-id="37dd7-328">However, because Node C is disconnected, the replica remains, incorrectly, in the SYNCHRONIZED state.</span></span>  
  
 <span data-ttu-id="37dd7-329">Se o quorum for perdido e, em seguida, forçado no Nó A, o estado de sincronização do grupo de disponibilidade no cluster WSFC deverá estar correto – com a réplica secundária no Nó C mostrada como UNSYNCHRONIZED.</span><span class="sxs-lookup"><span data-stu-id="37dd7-329">If quorum is lost and is then forced on Node A, the synchronization state of the availability group on the WSFC cluster should be correct-with the secondary replica on Node C shown as UNSYNCHRONIZED.</span></span> <span data-ttu-id="37dd7-330">No entanto, se o quorum for forçado no nó C, a sincronização do grupo de disponibilidade estará incorreta.</span><span class="sxs-lookup"><span data-stu-id="37dd7-330">However, if quorum is forced on Node C, the synchronization of the availability group will be incorrect.</span></span> <span data-ttu-id="37dd7-331">A sincronização no cluster será revertida ao estado de quando o Nó C foi desconectado, ou seja, com a réplica secundária no Nó C mostrada *incorretamente* como SYNCHRONIZED.</span><span class="sxs-lookup"><span data-stu-id="37dd7-331">The synchronization state on the cluster will have reverted back to when Node C was disconnected-with the secondary replica on Node C *incorrectly* shown as SYNCHRONIZED.</span></span> <span data-ttu-id="37dd7-332">Como os failovers manuais planejados garantem a segurança dos dados, eles não têm permissão para recolocar um grupo de disponibilidade online após o quorum ser forçado.</span><span class="sxs-lookup"><span data-stu-id="37dd7-332">Since planned manual failovers guarantee the safety of the data, they are disallowed for bring an availability group back online after quorum is forced.</span></span>  
  
###  <a name="tracking-potential-data-loss"></a><a name="TrackPotentialDataLoss"></a> <span data-ttu-id="37dd7-333">Controlando a potencial perda de dados</span><span class="sxs-lookup"><span data-stu-id="37dd7-333">Tracking Potential Data Loss</span></span>  
 <span data-ttu-id="37dd7-334">Quando o cluster WSFC tem um quorum íntegro, você pode calcular o potencial atual de perda de dados em bancos de dados.</span><span class="sxs-lookup"><span data-stu-id="37dd7-334">When the WSFC cluster has a healthy quorum, you can estimate the current potential for data loss on databases.</span></span> <span data-ttu-id="37dd7-335">Para uma réplica secundária específica, o potencial atual de perda de dados depende do atraso dos bancos de dados secundários locais em relação aos bancos de dados primários correspondentes.</span><span class="sxs-lookup"><span data-stu-id="37dd7-335">For a given secondary replica, the current potential for data loss depends on how far the local secondary databases are lagging behind the corresponding primary databases.</span></span> <span data-ttu-id="37dd7-336">Como o tempo de retardo varia com o passar do tempo, é recomendável acompanhar periodicamente a possível perda de dados para os bancos de dados secundários não sincronizados.</span><span class="sxs-lookup"><span data-stu-id="37dd7-336">Because the amount of lag varies over time, we recommend that you periodically track potential data loss for your unsynchronized secondary databases.</span></span> <span data-ttu-id="37dd7-337">Controlar o retardo envolve comparar a LSN da Última Confirmação e a Hora da Última Confirmação para cada banco de dados primário e seus bancos de dados secundários, como segue:</span><span class="sxs-lookup"><span data-stu-id="37dd7-337">Tracking lag involves comparing the Last Commit LSN and Last Commit Time for each primary database and its secondary databases, as follows:</span></span>  
  
1.  <span data-ttu-id="37dd7-338">Conecte-se à réplica primária.</span><span class="sxs-lookup"><span data-stu-id="37dd7-338">Connect to the primary replica.</span></span>  
  
2.  <span data-ttu-id="37dd7-339">Consulte as `last_commit_lsn` colunas (LSN da última transação confirmada) e `last_commit_time` (hora da última confirmação) da exibição de gerenciamento dinâmico [Sys. dm_hadr_database_replica_states](/sql/relational-databases/system-dynamic-management-views/sys-dm-hadr-database-replica-states-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="37dd7-339">Query the `last_commit_lsn` (LSN of the last committed transaction) and `last_commit_time` (time of the last commit) columns of the [sys.dm_hadr_database_replica_states](/sql/relational-databases/system-dynamic-management-views/sys-dm-hadr-database-replica-states-transact-sql) dynamic management view.</span></span>  
  
3.  <span data-ttu-id="37dd7-340">Compare os valores retornados para cada banco de dados primário e cada um de seus bancos de dados secundários.</span><span class="sxs-lookup"><span data-stu-id="37dd7-340">Compare the values returned for each primary database and each of its secondary databases.</span></span> <span data-ttu-id="37dd7-341">A diferença entre LSNs da Última Confirmação indica o tempo de retardo.</span><span class="sxs-lookup"><span data-stu-id="37dd7-341">The difference between their Last Commit LSNs indicate the amount of lag.</span></span>  
  
4.  <span data-ttu-id="37dd7-342">Você pode disparar um alerta quando o tempo de retardo em um banco de dados ou conjunto de bancos de dados excede o retardo máximo desejado para um período de tempo específico.</span><span class="sxs-lookup"><span data-stu-id="37dd7-342">You can trigger an alert when the amount of lag on a database or set of databases exceeds your desired maximum lag for a given period of time.</span></span> <span data-ttu-id="37dd7-343">Por exemplo, a consulta pode ser executada por um trabalho executado a cada minuto em cada banco de dados primário.</span><span class="sxs-lookup"><span data-stu-id="37dd7-343">For example, the query can be run by a job that executes every minute on each primary database.</span></span> <span data-ttu-id="37dd7-344">Se a diferença entre `last_commit_time` de um banco de dados primário e qualquer um de seus bancos de dados secundários exceder o ponto de recuperação objetivo (RPO) (por exemplo, 5 minutos) desde a última execução do trabalho, esse trabalho poderá gerar um alerta.</span><span class="sxs-lookup"><span data-stu-id="37dd7-344">If the difference between the `last_commit_time` of a primary database and any of its secondary databases has exceeded the recovery point objective (RPO) (for example, 5 minutes) since the last time the job executed, the job can raise an alert.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="37dd7-345">Quando o cluster WSFC não tem quorum ou o quorum foi forçado, `last_commit_lsn` e `last_commit_time` são NULL.</span><span class="sxs-lookup"><span data-stu-id="37dd7-345">When the WSFC cluster lacks quorum or quorum has been forced, `last_commit_lsn` and `last_commit_time` are NULL.</span></span> <span data-ttu-id="37dd7-346">Para obter informações sobre como você pode evitar a perda de dados após o quorum forçado, consulte “Maneiras possíveis de evitar a perda de dados após o quorum forçado” em [Executar um failover manual forçado de um grupo de disponibilidade &#40;SQL Server&#41;](perform-a-forced-manual-failover-of-an-availability-group-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="37dd7-346">For information about how you might be able to avoid data loss after you forced quorum, see "Potential Ways to Avoid Data Loss After Quorum is Forced" in [Perform a Forced Manual Failover of an Availability Group &#40;SQL Server&#41;](perform-a-forced-manual-failover-of-an-availability-group-sql-server.md).</span></span>  
  
###  <a name="managing-the-potential-data-loss"></a><a name="ForcedFailoverManagingDataLoss"></a> <span data-ttu-id="37dd7-347">Gerenciando a perda potencial de dados</span><span class="sxs-lookup"><span data-stu-id="37dd7-347">Managing the Potential Data Loss</span></span>  
 <span data-ttu-id="37dd7-348">Após um failover forçado, todos os bancos de dados secundários são suspensos.</span><span class="sxs-lookup"><span data-stu-id="37dd7-348">After failover is forced, all secondary databases are suspended.</span></span> <span data-ttu-id="37dd7-349">Isso inclui os antigos bancos de dados primários, depois que a antiga réplica primária ficar online novamente e descobrir que agora ela é uma réplica secundária.</span><span class="sxs-lookup"><span data-stu-id="37dd7-349">This includes the former primary databases, after the former primary replica comes back online and discovers that it is now a secondary replica.</span></span> <span data-ttu-id="37dd7-350">É necessário retomar manualmente cada banco de dados suspenso individualmente em cada réplica secundária.</span><span class="sxs-lookup"><span data-stu-id="37dd7-350">You must manually resume each suspended database individually on each secondary replica.</span></span>  
  
 <span data-ttu-id="37dd7-351">Assim que a réplica primária antiga estiver disponível, supondo que seus bancos de dados não estejam danificados, você poderá tentar gerenciar a possível perda de dados.</span><span class="sxs-lookup"><span data-stu-id="37dd7-351">Once the former primary replica is available, assuming that its databases are undamaged, you can attempt to manage the potential data loss.</span></span> <span data-ttu-id="37dd7-352">A abordagem disponível para o gerenciamento da perda potencial de dados depende de se a réplica primária original conectou-se com a nova réplica primária.</span><span class="sxs-lookup"><span data-stu-id="37dd7-352">The available approach for managing potential data loss depends on whether the original primary replica has connected to the new primary replica.</span></span> <span data-ttu-id="37dd7-353">Presumindo que a réplica primária original pode acessar a nova instância primária, a reconexão ocorrerá de forma automática e transparente.</span><span class="sxs-lookup"><span data-stu-id="37dd7-353">Assuming that the original primary replica can access the new primary instance, reconnecting occurs automatically and transparently.</span></span>  
  
#### <a name="the-original-primary-replica-has-reconnected"></a><span data-ttu-id="37dd7-354">A réplica primária original foi reconectada</span><span class="sxs-lookup"><span data-stu-id="37dd7-354">The Original Primary Replica Has Reconnected</span></span>  
 <span data-ttu-id="37dd7-355">Normalmente, depois de uma falha, quando a réplica primária original é reiniciada, ela se reconecta rapidamente a sua parceira.</span><span class="sxs-lookup"><span data-stu-id="37dd7-355">Typically, after a failure, when the original primary replica restarts it quickly reconnects to its partner.</span></span> <span data-ttu-id="37dd7-356">Na reconexão, a réplica primária original se torna a réplica secundária.</span><span class="sxs-lookup"><span data-stu-id="37dd7-356">On reconnecting, the original primary replica becomes the secondary replica.</span></span> <span data-ttu-id="37dd7-357">Seus bancos de dados se tornam os bancos de dados secundários e entram no estado SUSPENDED.</span><span class="sxs-lookup"><span data-stu-id="37dd7-357">Its databases becomes the secondary databases and enter the SUSPENDED state.</span></span> <span data-ttu-id="37dd7-358">Os novos bancos de dados secundários não serão revertidos a menos que você os retome.</span><span class="sxs-lookup"><span data-stu-id="37dd7-358">The new secondary databases will not be not rolled back unless you resume them.</span></span>  
  
 <span data-ttu-id="37dd7-359">Contudo, os bancos de dados suspensos estão inacessíveis. Portanto, você não pode inspecioná-los para avaliar os dados que seriam perdidos se você retomasse um banco de dados específico.</span><span class="sxs-lookup"><span data-stu-id="37dd7-359">However, the suspended databases are inaccessible, so you cannot inspect them to evaluate what data would be lost if you were to resume a given database.</span></span> <span data-ttu-id="37dd7-360">Portanto, a decisão de retomar ou remover um banco de dados secundário dependerá de se você está propenso a aceitar alguma perda dos dados, da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="37dd7-360">Therefore, the decision on whether to resume or remove a secondary database depends on whether you are willing to accept any data loss, as follows:</span></span>  
  
-   <span data-ttu-id="37dd7-361">Se a perda dos dados for inaceitável, será necessário remover os bancos de dados do grupo de disponibilidade para resgatá-los.</span><span class="sxs-lookup"><span data-stu-id="37dd7-361">If losing any data would be unacceptable, you should remove the databases from the availability group to salvage them.</span></span>  
  
     <span data-ttu-id="37dd7-362">O administrador de banco de dados agora pode recuperar os bancos de dados primários antigos e tentar recuperar os dados que foram perdidos.</span><span class="sxs-lookup"><span data-stu-id="37dd7-362">The database administrator can now recover the former primary databases and attempt to recover the data that would have been lost.</span></span> <span data-ttu-id="37dd7-363">Porém, quando um banco de dados primário antigo ficar online, ele será divergente do banco de dados primário atual, assim, o administrador de banco de dados precisa tornar o banco de dados removido ou o banco de dados primário atual inacessível para clientes, para evitar divergência adicional dos bancos de dados e impedir problemas do failover de cliente.</span><span class="sxs-lookup"><span data-stu-id="37dd7-363">However, when a former primary database comes online, it is divergent from the current primary database, so the database administrator needs to make either the removed database or the current primary database inaccessible to clients to avoid further divergence of the databases and to prevent client-failover issues.</span></span>  
  
-   <span data-ttu-id="37dd7-364">Se a perda de dados for aceitável para suas metas de negócios, você poderá retomar os bancos de dados secundários.</span><span class="sxs-lookup"><span data-stu-id="37dd7-364">If losing data would be acceptable to your business goals, you can resume the secondary databases.</span></span>  
  
     <span data-ttu-id="37dd7-365">A retomada de um novo banco de dados secundário faz com que ele seja revertido como a primeira etapa na sincronização do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="37dd7-365">Resuming a new secondary database causes it to be rolled back as the first step in synchronizing the database.</span></span> <span data-ttu-id="37dd7-366">Se houver registros de log aguardando na fila de envio no momento da falha, as transações correspondentes serão perdidas, mesmo se tiverem sido confirmadas.</span><span class="sxs-lookup"><span data-stu-id="37dd7-366">If any log records were waiting in the send queue at the time of failure, the corresponding transactions are lost, even if they were committed.</span></span>  
  
#### <a name="the-original-primary-replica-has-not-reconnected"></a><span data-ttu-id="37dd7-367">A réplica primária original não foi reconectada</span><span class="sxs-lookup"><span data-stu-id="37dd7-367">The Original Primary Replica Has Not Reconnected</span></span>  
 <span data-ttu-id="37dd7-368">Se for possível impedir temporariamente que a réplica primária original seja reconectada na rede com a nova réplica primária, você poderá inspecionar os bancos de dados primários originais para avaliar os dados que seriam perdidos se eles fossem retomados.</span><span class="sxs-lookup"><span data-stu-id="37dd7-368">If you can temporarily prevent the original primary replica from reconnecting over the network to the new primary replica, you can inspect the original primary databases to evaluate what data would be lost if they were resumed.</span></span>  
  
-   <span data-ttu-id="37dd7-369">Se a perda potencial de dados for aceitável</span><span class="sxs-lookup"><span data-stu-id="37dd7-369">If the potential data loss is acceptable</span></span>  
  
     <span data-ttu-id="37dd7-370">Permita que a réplica primária original se reconecte à nova réplica primária.</span><span class="sxs-lookup"><span data-stu-id="37dd7-370">Allow the original primary replica to reconnect to the new primary replica.</span></span> <span data-ttu-id="37dd7-371">A reconexão faz com que os novos bancos de dados secundários sejam suspensos.</span><span class="sxs-lookup"><span data-stu-id="37dd7-371">Reconnecting causes the new secondary databases to be suspended.</span></span> <span data-ttu-id="37dd7-372">Para iniciar a sincronização de dados em um banco de dados, basta retomá-lo.</span><span class="sxs-lookup"><span data-stu-id="37dd7-372">To start data synchronization on a database, simply resume it.</span></span> <span data-ttu-id="37dd7-373">A nova réplica secundária cancela a bifurcação de recuperação original para aquele banco de dados, perdendo as transações que nunca foram enviadas ou recebidas pela réplica secundária antiga.</span><span class="sxs-lookup"><span data-stu-id="37dd7-373">The new secondary replica drops the original recovery fork for that database, losing any transactions that were never sent to or received by the former secondary replica.</span></span>  
  
-   <span data-ttu-id="37dd7-374">Se a perda de dados for inaceitável</span><span class="sxs-lookup"><span data-stu-id="37dd7-374">If the data loss is unacceptable</span></span>  
  
     <span data-ttu-id="37dd7-375">Se o banco de dados primário original contiver dados críticos que seriam perdidos se você retomasse o banco de dados suspenso, você poderá preservar os dados no banco de dados primário original removendo-o do grupo de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="37dd7-375">If the original primary database contains critical data that would be lost if you resumed the suspended database, you can preserve the data on the original primary database by removing it from the availability group.</span></span> <span data-ttu-id="37dd7-376">Isso faz com que o banco de dados entre no estado RESTORING.</span><span class="sxs-lookup"><span data-stu-id="37dd7-376">This causes the database to enter the RESTORING state.</span></span> <span data-ttu-id="37dd7-377">Nesse ponto, é recomendável tentar fazer backup da parte final do log do banco de dados removido.</span><span class="sxs-lookup"><span data-stu-id="37dd7-377">At this point, we recommend that you attempt to back up the tail of the removed database's log.</span></span> <span data-ttu-id="37dd7-378">Em seguida, é possível atualizar o primário atual (o banco de dados secundário antigo) exportando os dados que você deseja resgatar do banco de dados primário original e importando-os no banco de dados primário atual.</span><span class="sxs-lookup"><span data-stu-id="37dd7-378">Then, you can update the current primary (the former secondary database) by exporting the data you want to salvage from the original primary database and importing it into the current primary database.</span></span> <span data-ttu-id="37dd7-379">É recomendável fazer um backup completo dos bancos de dados primários atualizados o mais rápido possível.</span><span class="sxs-lookup"><span data-stu-id="37dd7-379">We recommend taking a full database backup of the updated primary database as quickly as possible.</span></span>  
  
     <span data-ttu-id="37dd7-380">Em seguida, na instância de servidor que hospeda a nova réplica secundária, você pode excluir o banco de dados secundário suspenso e criar um novo banco de dados secundário restaurando esse backup (e pelo menos um backup de log subsequente) usando RESTORE WITH NORECOVERY.</span><span class="sxs-lookup"><span data-stu-id="37dd7-380">Then, on the server instance that hosts the new secondary replica, you can delete the suspended secondary database and create a new secondary database by restoring this backup (and least one subsequent log backup) using RESTORE WITH NORECOVERY.</span></span> <span data-ttu-id="37dd7-381">É recomendável atrasar backups de log adicionais dos bancos de dados primários atuais até que os bancos de dados secundários correspondentes sejam retomados.</span><span class="sxs-lookup"><span data-stu-id="37dd7-381">We recommend delaying additional log backups of the current primary databases until the corresponding secondary databases are resumed.</span></span>  
  
> [!WARNING]  
>  <span data-ttu-id="37dd7-382">O truncamento do log de transações será atrasado em um banco de dados primário enquanto qualquer um de seus bancos de dados secundários estiver suspenso.</span><span class="sxs-lookup"><span data-stu-id="37dd7-382">Transaction log truncation is delayed on a primary database while any of its secondary databases is suspended.</span></span> <span data-ttu-id="37dd7-383">Além disso, a integridade da sincronização de uma réplica secundária de confirmação síncrona não poderá fazer a transição para HEALTHY enquanto qualquer banco de dados local permanecer suspenso.</span><span class="sxs-lookup"><span data-stu-id="37dd7-383">Also the synchronization health of a synchronous-commit secondary replica cannot transition to HEALTHY as long as any local database remains suspended.</span></span>  
  
##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="37dd7-384">Tarefas relacionadas</span><span class="sxs-lookup"><span data-stu-id="37dd7-384">Related Tasks</span></span>  
 <span data-ttu-id="37dd7-385">**Para configurar o comportamento de failover**</span><span class="sxs-lookup"><span data-stu-id="37dd7-385">**To configure failover behavior**</span></span>  
  
-   [<span data-ttu-id="37dd7-386">Alterar o modo de disponibilidade de uma réplica de disponibilidade &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="37dd7-386">Change the Availability Mode of an Availability Replica &#40;SQL Server&#41;</span></span>](change-the-availability-mode-of-an-availability-replica-sql-server.md)  
  
-   [<span data-ttu-id="37dd7-387">Alterar o modo de failover de uma réplica de disponibilidade &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="37dd7-387">Change the Failover Mode of an Availability Replica &#40;SQL Server&#41;</span></span>](change-the-failover-mode-of-an-availability-replica-sql-server.md)  
  
-   [<span data-ttu-id="37dd7-388">Configure a política de failover flexível para controlar as condições de failover automático &#40;Grupos de Disponibilidade AlwaysOn&#41;</span><span class="sxs-lookup"><span data-stu-id="37dd7-388">Configure the Flexible Failover Policy to Control Conditions for Automatic Failover &#40;AlwaysOn Availability Groups&#41;</span></span>](configure-flexible-automatic-failover-policy.md)  
  
 <span data-ttu-id="37dd7-389">**Para executar um failover manual**</span><span class="sxs-lookup"><span data-stu-id="37dd7-389">**To perform a manual fail over**</span></span>  
  
-   [<span data-ttu-id="37dd7-390">Executar um failover manual planejado de um grupo de disponibilidade &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="37dd7-390">Perform a Planned Manual Failover of an Availability Group &#40;SQL Server&#41;</span></span>](perform-a-planned-manual-failover-of-an-availability-group-sql-server.md)  
  
-   [<span data-ttu-id="37dd7-391">Executar um failover manual forçado de um grupo de disponibilidade &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="37dd7-391">Perform a Forced Manual Failover of an Availability Group &#40;SQL Server&#41;</span></span>](perform-a-forced-manual-failover-of-an-availability-group-sql-server.md)  
  
-   [<span data-ttu-id="37dd7-392">Usar o Assistente de Grupo de Disponibilidade de Failover &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="37dd7-392">Use the Fail Over Availability Group Wizard &#40;SQL Server Management Studio&#41;</span></span>](use-the-fail-over-availability-group-wizard-sql-server-management-studio.md)  
  
-   [<span data-ttu-id="37dd7-393">Gerenciamento de logons e trabalhos para os bancos de dados de um grupo de disponibilidade &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="37dd7-393">Management of Logins and Jobs for the Databases of an Availability Group &#40;SQL Server&#41;</span></span>](../../logins-and-jobs-for-availability-group-databases.md)  
  
 <span data-ttu-id="37dd7-394">**Para definir a configuração de quorum do WSFC**</span><span class="sxs-lookup"><span data-stu-id="37dd7-394">**To configure WSFC Quorum Configuration**</span></span>  
  
-   [<span data-ttu-id="37dd7-395">Definir configurações de NodeWeight de quorum do cluster</span><span class="sxs-lookup"><span data-stu-id="37dd7-395">Configure Cluster Quorum NodeWeight Settings</span></span>](../../../sql-server/failover-clusters/windows/configure-cluster-quorum-nodeweight-settings.md)  
  
-   [<span data-ttu-id="37dd7-396">Exibir configurações de NodeWeight de quorum do cluster</span><span class="sxs-lookup"><span data-stu-id="37dd7-396">View Cluster Quorum NodeWeight Settings</span></span>](../../../sql-server/failover-clusters/windows/view-cluster-quorum-nodeweight-settings.md)  
  
-   [<span data-ttu-id="37dd7-397">Forçar um cluster WSFC para iniciar sem um quorum</span><span class="sxs-lookup"><span data-stu-id="37dd7-397">Force a WSFC Cluster to Start Without a Quorum</span></span>](../../../sql-server/failover-clusters/windows/force-a-wsfc-cluster-to-start-without-a-quorum.md)  
  
##  <a name="related-content"></a><a name="RelatedContent"></a> <span data-ttu-id="37dd7-398">Conteúdo relacionado</span><span class="sxs-lookup"><span data-stu-id="37dd7-398">Related Content</span></span>  
  
-   [<span data-ttu-id="37dd7-399">Guia de soluções AlwaysOn do Microsoft SQL Server para alta disponibilidade e recuperação de desastre</span><span class="sxs-lookup"><span data-stu-id="37dd7-399">Microsoft SQL Server AlwaysOn Solutions Guide for High Availability and Disaster Recovery</span></span>](https://go.microsoft.com/fwlink/?LinkId=227600)  
  
-   [<span data-ttu-id="37dd7-400">Blog da equipe do AlwaysOn do SQL Server: blog oficial da equipe do SQL Server AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="37dd7-400">SQL Server AlwaysOn Team Blog: The official SQL Server AlwaysOn Team Blog</span></span>](https://blogs.msdn.com/b/sqlalwayson/)  
  
## <a name="see-also"></a><span data-ttu-id="37dd7-401">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="37dd7-401">See Also</span></span>  
 <span data-ttu-id="37dd7-402">[Visão geral do Grupos de Disponibilidade AlwaysOn &#40;SQL Server&#41;](overview-of-always-on-availability-groups-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="37dd7-402">[Overview of AlwaysOn Availability Groups &#40;SQL Server&#41;](overview-of-always-on-availability-groups-sql-server.md) </span></span>  
 <span data-ttu-id="37dd7-403">[Modos de disponibilidade &#40;Grupos de Disponibilidade AlwaysOn&#41;](availability-modes-always-on-availability-groups.md) </span><span class="sxs-lookup"><span data-stu-id="37dd7-403">[Availability Modes &#40;AlwaysOn Availability Groups&#41;](availability-modes-always-on-availability-groups.md) </span></span>  
 <span data-ttu-id="37dd7-404">[WSFC &#40;Windows Server Failover Clustering&#41; com o SQL Server](../../../sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="37dd7-404">[Windows Server Failover Clustering &#40;WSFC&#41; with SQL Server](../../../sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server.md) </span></span>  
 <span data-ttu-id="37dd7-405">[Transações entre bancos de dados sem suporte para espelhamento de banco de dados ou Grupos de Disponibilidade AlwaysOn &#40;SQL Server&#41;](transactions-always-on-availability-and-database-mirroring.md) </span><span class="sxs-lookup"><span data-stu-id="37dd7-405">[Cross-Database Transactions Not Supported For Database Mirroring or AlwaysOn Availability Groups &#40;SQL Server&#41;](transactions-always-on-availability-and-database-mirroring.md) </span></span>  
 <span data-ttu-id="37dd7-406">[Política de failover para instâncias de cluster de failover](../../../sql-server/failover-clusters/windows/failover-policy-for-failover-cluster-instances.md) </span><span class="sxs-lookup"><span data-stu-id="37dd7-406">[Failover Policy for Failover Cluster Instances](../../../sql-server/failover-clusters/windows/failover-policy-for-failover-cluster-instances.md) </span></span>  
 [<span data-ttu-id="37dd7-407">Política de failover flexível para failover automático de um grupo de disponibilidade &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="37dd7-407">Flexible Failover Policy for Automatic Failover of an Availability Group &#40;SQL Server&#41;</span></span>](flexible-automatic-failover-policy-availability-group.md)  
  
  
