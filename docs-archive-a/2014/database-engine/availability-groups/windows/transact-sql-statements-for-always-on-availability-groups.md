---
title: Visão geral das instruções Transact-SQL para Grupos de Disponibilidade AlwaysOn (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 04/27/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- Availability Groups [SQL Server], about
- Availability Groups [SQL Server], Transact-SQL statements
ms.assetid: 184d0a81-2259-4db9-9d0d-01aac0b502c8
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: ff25fecf54cfdd1d9c03d1586f0272896542bfa7
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87685289"
---
# <a name="overview-of-transact-sql-statements-for-alwayson-availability-groups-sql-server"></a><span data-ttu-id="0d43d-102">Visão geral de instruções Transact-SQL para Grupos de Disponibilidade AlwaysOn (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="0d43d-102">Overview of Transact-SQL Statements for AlwaysOn Availability Groups (SQL Server)</span></span>
  <span data-ttu-id="0d43d-103">Este tópico apresenta as instruções [!INCLUDE[tsql](../../../includes/tsql-md.md)] que oferecem suporte à implantação do [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] e à criação e ao gerenciamento de grupos de disponibilidade, réplicas de disponibilidade e bancos de dados de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="0d43d-103">This topic introduces the [!INCLUDE[tsql](../../../includes/tsql-md.md)] statements that support deploying [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] and creating and managing an given availability group, availability replica and availability database.</span></span>  
  
  
##  <a name="create-endpoint"></a><a name="CreateEndpoint"></a><span data-ttu-id="0d43d-104">CRIAR PONTO DE EXTREMIDADE</span><span class="sxs-lookup"><span data-stu-id="0d43d-104">CREATE ENDPOINT</span></span>  
 <span data-ttu-id="0d43d-105">[criar ponto de extremidade... POR DATABASE_MIRRORING](/sql/t-sql/statements/create-endpoint-transact-sql) cria um ponto de extremidade de espelhamento de banco de dados, se não houver nenhum na instância do servidor.</span><span class="sxs-lookup"><span data-stu-id="0d43d-105">[CREATE ENDPOINT ... FOR DATABASE_MIRRORING](/sql/t-sql/statements/create-endpoint-transact-sql) creates a database mirroring endpoint, if none exists on the server instance.</span></span> <span data-ttu-id="0d43d-106">Cada instância de servidor na qual você pretende implantar o [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] ou o espelhamento de banco de dados requer um ponto de extremidade de espelhamento de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="0d43d-106">Every server instance on which you intend to deploy [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] or database mirroring requires a database mirroring endpoint.</span></span>  
  
 <span data-ttu-id="0d43d-107">Execute essa instrução na instância de servidor em que você está criando o ponto de extremidade.</span><span class="sxs-lookup"><span data-stu-id="0d43d-107">Execute this statement on the server instance on which you are creating the endpoint.</span></span> <span data-ttu-id="0d43d-108">É possível criar somente um ponto de extremidade de espelhamento de banco de dados em uma instância.</span><span class="sxs-lookup"><span data-stu-id="0d43d-108">You can create only one database mirroring endpoint on a given server instance.</span></span> <span data-ttu-id="0d43d-109">Para obter mais informações, consulte [O ponto de extremidade de espelhamento de banco de dados &#40;SQL Server&#41;](../../database-mirroring/the-database-mirroring-endpoint-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="0d43d-109">For more information, see [The Database Mirroring Endpoint &#40;SQL Server&#41;](../../database-mirroring/the-database-mirroring-endpoint-sql-server.md).</span></span>  
  
##  <a name="create-availability-group"></a><a name="CreateAG"></a><span data-ttu-id="0d43d-110">CRIAR GRUPO DE DISPONIBILIDADE</span><span class="sxs-lookup"><span data-stu-id="0d43d-110">CREATE AVAILABILITY GROUP</span></span>  
 <span data-ttu-id="0d43d-111">[CREATE AVAILABILITY GROUP](/sql/t-sql/statements/create-availability-group-transact-sql) cria um novo grupo de disponibilidade e opcionalmente um ouvinte de grupo de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="0d43d-111">[CREATE AVAILABILITY GROUP](/sql/t-sql/statements/create-availability-group-transact-sql) creates a new availability group and optionally an availability group listener.</span></span> <span data-ttu-id="0d43d-112">No mínimo, você deve especificar sua instância de servidor local que se tornará a réplica primária inicial.</span><span class="sxs-lookup"><span data-stu-id="0d43d-112">Minimally, you must specify your local server instance, which will become the initial primary replica.</span></span> <span data-ttu-id="0d43d-113">Opcionalmente, você também pode especificar até quatro réplicas secundárias.</span><span class="sxs-lookup"><span data-stu-id="0d43d-113">Optionally, you can also specify up to four secondary replicas.</span></span>  
  
 <span data-ttu-id="0d43d-114">Execute CREATE AVAILABILITY GROUP na instância do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] em que você deseja hospedar a réplica primária inicial de seu novo grupo de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="0d43d-114">Execute CREATE AVAILABILITY GROUP on the instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] that you want to host the initial primary replica of your new availability group.</span></span> <span data-ttu-id="0d43d-115">Essa instância de servidor deve residir em um nó de um WSFC (cluster de failover do Windows Server) (para obter mais informações, consulte [pré-requisitos, restrições e recomendações para Grupos de Disponibilidade AlwaysOn &#40;SQL Server&#41;](prereqs-restrictions-recommendations-always-on-availability.md).</span><span class="sxs-lookup"><span data-stu-id="0d43d-115">This server instance must reside on a node of a Windows Server Failover Cluster (WSFC) (for more information, see [Prerequisites, Restrictions, and Recommendations for AlwaysOn Availability Groups &#40;SQL Server&#41;](prereqs-restrictions-recommendations-always-on-availability.md).</span></span>  
  
##  <a name="alter-availability-group"></a><a name="AlterAG"></a><span data-ttu-id="0d43d-116">ALTERAR GRUPO DE DISPONIBILIDADE</span><span class="sxs-lookup"><span data-stu-id="0d43d-116">ALTER AVAILABILITY GROUP</span></span>  
 <span data-ttu-id="0d43d-117">[ALTER AVAILABILITY GROUP](/sql/t-sql/statements/alter-availability-group-transact-sql) oferece suporte à alteração de um grupo de disponibilidade existente ou de ouvinte de grupo de disponibilidade e ao failover de um grupo de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="0d43d-117">[ALTER AVAILABILITY GROUP](/sql/t-sql/statements/alter-availability-group-transact-sql) supports changing an existing availability group or availability group listener and for failing over an availability group.</span></span>  
  
 <span data-ttu-id="0d43d-118">Execute ALTER AVAILABILITY GROUP na instância do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] que hospeda a réplica primária atual.</span><span class="sxs-lookup"><span data-stu-id="0d43d-118">Execute ALTER AVAILABILITY GROUP on the instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] that hosts the current primary replica.</span></span>  
  
##  <a name="alter-database--set-hadr-"></a><a name="AlterDb"></a><span data-ttu-id="0d43d-119">ALTERAR BANCO DE DADOS... DEFINIR HADR...</span><span class="sxs-lookup"><span data-stu-id="0d43d-119">ALTER DATABASE ... SET HADR ...</span></span>  
 <span data-ttu-id="0d43d-120">As opções da cláusula [SET HADR](/sql/t-sql/statements/alter-database-transact-sql-set-hadr) da instrução ALTER DATABASE permitem unir um banco de dados secundário ao grupo de disponibilidade do banco de dados primário correspondente, removem um banco de dados unido e suspendem a sincronização de dados em um banco de dados unido e retomam a sincronização de dados.</span><span class="sxs-lookup"><span data-stu-id="0d43d-120">The options of the [SET HADR](/sql/t-sql/statements/alter-database-transact-sql-set-hadr) clause of the ALTER DATABASE statement enables you to join a secondary database to the availability group of the corresponding primary database, remove a joined database, and suspend data synchronization on a joined database, and resume data synchronization.</span></span>  
  
##  <a name="drop-availability-group"></a><a name="DropAG"></a><span data-ttu-id="0d43d-121">REMOVER GRUPO DE DISPONIBILIDADE</span><span class="sxs-lookup"><span data-stu-id="0d43d-121">DROP AVAILABILITY GROUP</span></span>  
 <span data-ttu-id="0d43d-122">[DROP AVAILABILITY GROUP](/sql/t-sql/statements/drop-availability-group-transact-sql) remove um grupo de disponibilidade especificado e todas as suas réplicas.</span><span class="sxs-lookup"><span data-stu-id="0d43d-122">[DROP AVAILABILITY GROUP](/sql/t-sql/statements/drop-availability-group-transact-sql) removes a specified availability group and all of its replicas.</span></span> <span data-ttu-id="0d43d-123">DROP AVAILABILITY GROUP pode ser executado em qualquer nó [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] no cluster de failover do WSFC.</span><span class="sxs-lookup"><span data-stu-id="0d43d-123">DROP AVAILABILITY GROUP can be run from any [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] node in the WSFC failover cluster.</span></span>  
  
##  <a name="restrictions-on-the-availability-group-transact-sql-statements"></a><a name="Restrictions"></a> <span data-ttu-id="0d43d-124">Restrições nas instruções Transact-SQL AVAILABILITY GROUP</span><span class="sxs-lookup"><span data-stu-id="0d43d-124">Restrictions on the AVAILABILITY GROUP Transact-SQL Statements</span></span>  
 <span data-ttu-id="0d43d-125">As instruções [!INCLUDE[tsql](../../../includes/tsql-md.md)] CREATE AVAILABILITY GROUP, ALTER AVAILABILITY GROUP e DROP AVAILABILITY GROUP têm as seguintes limitações:</span><span class="sxs-lookup"><span data-stu-id="0d43d-125">The CREATE AVAILABILITY GROUP, ALTER AVAILABILITY GROUP, and DROP AVAILABILITY GROUP [!INCLUDE[tsql](../../../includes/tsql-md.md)] statements have the following limitations:</span></span>  
  
-   <span data-ttu-id="0d43d-126">Com exceção de DROP AVAILABILITY GROUP, a execução dessas instruções requer que o serviço HADR seja habilitado na instância do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="0d43d-126">With the exception of DROP AVAILABILITY GROUP, executing these statements requires that the HADR service is enabled on the instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="0d43d-127">Para obter mais informações, veja [Habilitar e desabilitar Grupos de Disponibilidade AlwaysOn &#40;SQL Server&#41;](enable-and-disable-always-on-availability-groups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="0d43d-127">For more information, see [Enable and Disable AlwaysOn Availability Groups &#40;SQL Server&#41;](enable-and-disable-always-on-availability-groups-sql-server.md).</span></span>  
  
-   <span data-ttu-id="0d43d-128">Essas instruções não podem ser executadas dentro de transações ou lotes.</span><span class="sxs-lookup"><span data-stu-id="0d43d-128">These statements cannot be executed within transactions or batches.</span></span>  
  
-   <span data-ttu-id="0d43d-129">Embora elas se empenhem ao máximo para fazer a limpeza após uma falha, elas não garantem a reversão de todas as alterações após a falha.</span><span class="sxs-lookup"><span data-stu-id="0d43d-129">Though they make a best effort to clean up after a failure, these statements do not guarantee that they will roll back all changes on failure.</span></span> <span data-ttu-id="0d43d-130">No entanto, os sistemas devem ser capazes de tratar e, em seguida, ignorar as falhas parciais.</span><span class="sxs-lookup"><span data-stu-id="0d43d-130">However, systems should be able cleanly handle and then ignore partial failures.</span></span>  
  
-   <span data-ttu-id="0d43d-131">Essas instruções não oferecem suporte a expressões ou variáveis.</span><span class="sxs-lookup"><span data-stu-id="0d43d-131">These statements do not support expressions or variables.</span></span>  
  
-   <span data-ttu-id="0d43d-132">Se uma instrução [!INCLUDE[tsql](../../../includes/tsql-md.md)] for executada enquanto outra recuperação ou ação do grupo de disponibilidade estiver em andamento, a instrução retornará um erro.</span><span class="sxs-lookup"><span data-stu-id="0d43d-132">If a [!INCLUDE[tsql](../../../includes/tsql-md.md)] statement is executed while another availability group action or recovery is in process, the statement returns an error.</span></span> <span data-ttu-id="0d43d-133">Espere a conclusão da ação ou da recuperação e repita a instrução, se necessário.</span><span class="sxs-lookup"><span data-stu-id="0d43d-133">Wait for the action or recovery to complete, and retry the statement, if necessary.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0d43d-134">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="0d43d-134">See Also</span></span>  
 [<span data-ttu-id="0d43d-135">Visão geral do Grupos de Disponibilidade AlwaysOn &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="0d43d-135">Overview of AlwaysOn Availability Groups &#40;SQL Server&#41;</span></span>](overview-of-always-on-availability-groups-sql-server.md)  
  
  
