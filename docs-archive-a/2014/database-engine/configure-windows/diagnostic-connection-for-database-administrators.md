---
title: Conexão de diagnóstico para administradores de banco de dados | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: configuration
ms.topic: conceptual
helpviewer_keywords:
- server management [SQL Server], connections
- administrator connections [SQL Server]
- ports [SQL Server], DAC
- DAC
- network connections [SQL Server], dedicated administrator
- diagnostic connections [SQL Server]
- connections [SQL Server], dedicated administrator
- ports [SQL Server]
- dedicated administrator connections [SQL Server]
ms.assetid: 993e0820-17f2-4c43-880c-d38290bf7abc
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 0d452ca155a5187136c910e81e8bd073e34cad56
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87574905"
---
# <a name="diagnostic-connection-for-database-administrators"></a><span data-ttu-id="fd71a-102">Conexão de diagnóstico para administradores de banco de dados</span><span class="sxs-lookup"><span data-stu-id="fd71a-102">Diagnostic Connection for Database Administrators</span></span>
  [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="fd71a-103">fornece uma conexão diagnóstica especial para administradores quando conexões padrão com o servidor não são possíveis.</span><span class="sxs-lookup"><span data-stu-id="fd71a-103">provides a special diagnostic connection for administrators when standard connections to the server are not possible.</span></span> <span data-ttu-id="fd71a-104">Esta conexão diagnóstica permite que um administrador acesse o [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] para executar consultas diagnósticas e resolver problemas mesmo quando o [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] não está respondendo às solicitações de conexão padrão.</span><span class="sxs-lookup"><span data-stu-id="fd71a-104">This diagnostic connection allows an administrator to access [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to execute diagnostic queries and troubleshoot problems even when [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is not responding to standard connection requests.</span></span>  
  
 <span data-ttu-id="fd71a-105">Esta conexão de administrador dedicada (DAC) oferece suporte à criptografia e outros recursos de segurança do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fd71a-105">This dedicated administrator connection (DAC) supports encryption and other security features of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="fd71a-106">O DAC só permite alterar o contexto de usuário para outro usuário admin.</span><span class="sxs-lookup"><span data-stu-id="fd71a-106">The DAC only allows changing the user context to another admin user.</span></span>  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="fd71a-107">esforça-se o máximo para o êxito de uma conexão DAC, mas pode falhar em situações extremas.</span><span class="sxs-lookup"><span data-stu-id="fd71a-107">makes every attempt to make DAC connect successfully, but under extreme situations it may not be successful.</span></span>  
  
||  
|-|  
|<span data-ttu-id="fd71a-108">**Aplica-se a**: [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ( [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] até a [versão atual](https://go.microsoft.com/fwlink/p/?LinkId=299658)), [!INCLUDE[sqldbesa](../../includes/sqldbesa-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="fd71a-108">**Applies to**: [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ([!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] through [current version](https://go.microsoft.com/fwlink/p/?LinkId=299658)), [!INCLUDE[sqldbesa](../../includes/sqldbesa-md.md)].</span></span>|  
  
## <a name="connecting-with-dac"></a><span data-ttu-id="fd71a-109">Conectando com DAC</span><span class="sxs-lookup"><span data-stu-id="fd71a-109">Connecting with DAC</span></span>  
 <span data-ttu-id="fd71a-110">Por padrão, a conexão só é permitida de um cliente executando no servidor.</span><span class="sxs-lookup"><span data-stu-id="fd71a-110">By default, the connection is only allowed from a client running on the server.</span></span> <span data-ttu-id="fd71a-111">As conexões de rede apenas são permitidas se forem configuradas com o procedimento armazenado sp_configure com a [opção de conexões admin remotas](remote-admin-connections-server-configuration-option.md).</span><span class="sxs-lookup"><span data-stu-id="fd71a-111">Network connections are not permitted unless they are configured by using the sp_configure stored procedure with the [remote admin connections option](remote-admin-connections-server-configuration-option.md).</span></span>  
  
 <span data-ttu-id="fd71a-112">Apenas membros da função sysadmin do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] podem se conectar usando o DAC.</span><span class="sxs-lookup"><span data-stu-id="fd71a-112">Only members of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] sysadmin role can connect using the DAC.</span></span>  
  
 <span data-ttu-id="fd71a-113">O DAC está disponível e tem suporte através do utilitário de prompt de comando **sqlcmd** que usa uma opção de administrador especial (**-A**).</span><span class="sxs-lookup"><span data-stu-id="fd71a-113">The DAC is available and supported through the **sqlcmd** command-prompt utility using a special administrator switch (**-A**).</span></span> <span data-ttu-id="fd71a-114">Para obter mais informações sobre como usar **sqlcmd**, veja [Usar sqlcmd com variáveis de script](../../relational-databases/scripting/sqlcmd-use-with-scripting-variables.md).</span><span class="sxs-lookup"><span data-stu-id="fd71a-114">For more information about using **sqlcmd**, see [Use sqlcmd with Scripting Variables](../../relational-databases/scripting/sqlcmd-use-with-scripting-variables.md).</span></span> <span data-ttu-id="fd71a-115">Você também pode conectar a prefixação `admin:` ao nome da instância no formato **sqlcmd-Sadmin:** _<instance_name>._</span><span class="sxs-lookup"><span data-stu-id="fd71a-115">You can also connect prefixing `admin:`to the instance name in the format **sqlcmd -Sadmin:**_<instance_name>._</span></span> <span data-ttu-id="fd71a-116">Você também pode iniciar um DAC de um [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] Editor de consultas conectando-se ao `admin:` \<*instance_name*> .</span><span class="sxs-lookup"><span data-stu-id="fd71a-116">You can also initiate a DAC from a [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] Query Editor by connecting to `admin:`\<*instance_name*>.</span></span>  
  
## <a name="restrictions"></a><span data-ttu-id="fd71a-117">Restrições</span><span class="sxs-lookup"><span data-stu-id="fd71a-117">Restrictions</span></span>  
 <span data-ttu-id="fd71a-118">Como o DAC existe somente para diagnosticar problemas do servidor em circunstâncias raras, há algumas restrições na conexão:</span><span class="sxs-lookup"><span data-stu-id="fd71a-118">Because the DAC exists solely for diagnosing server problems in rare circumstances, there are some restrictions on the connection:</span></span>  
  
-   <span data-ttu-id="fd71a-119">Para garantir que existam recursos disponíveis para a conexão, apenas um DAC é permitido por instância do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fd71a-119">To guarantee that there are resources available for the connection, only one DAC is allowed per instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="fd71a-120">Se uma conexão DAC já estiver ativa, qualquer nova solicitação de conexão via DAC será negada com o erro 17810.</span><span class="sxs-lookup"><span data-stu-id="fd71a-120">If a DAC connection is already active, any new request to connect through the DAC is denied with error 17810.</span></span>  
  
-   <span data-ttu-id="fd71a-121">Para conservar recursos, o [!INCLUDE[ssExpress](../../includes/ssexpress-md.md)] não escuta na porta do DAC, a menos que tenha sido iniciado com um sinalizador de rastreamento 7806.</span><span class="sxs-lookup"><span data-stu-id="fd71a-121">To conserve resources, [!INCLUDE[ssExpress](../../includes/ssexpress-md.md)] does not listen on the DAC port unless started with a trace flag 7806.</span></span>  
  
-   <span data-ttu-id="fd71a-122">Inicialmente, o DAC tenta se conectar ao banco de dados padrão associado ao logon.</span><span class="sxs-lookup"><span data-stu-id="fd71a-122">The DAC initially attempts to connect to the default database associated with the login.</span></span> <span data-ttu-id="fd71a-123">Após uma conexão bem-sucedida, você pode se conectar ao banco de dados mestre.</span><span class="sxs-lookup"><span data-stu-id="fd71a-123">After it is successfully connected, you can connect to the master database.</span></span> <span data-ttu-id="fd71a-124">Se o banco de dados padrão estiver offline ou não estiver disponível, a conexão retornará o erro 4060.</span><span class="sxs-lookup"><span data-stu-id="fd71a-124">If the default database is offline or otherwise not available, the connection will return error 4060.</span></span> <span data-ttu-id="fd71a-125">Entretanto, ela terá êxito se você substituir o banco de dados padrão para se conectar ao banco de dados mestre em vez de usar o seguinte comando:</span><span class="sxs-lookup"><span data-stu-id="fd71a-125">However, it will succeed if you override the default database to connect to the master database instead using the following command:</span></span>  
  
     <span data-ttu-id="fd71a-126">**sqlcmd-A-d mestre**</span><span class="sxs-lookup"><span data-stu-id="fd71a-126">**sqlcmd -A -d master**</span></span>  
  
     <span data-ttu-id="fd71a-127">Recomendamos que você se conecte ao banco de dados mestre com o DAC porque esse mestre estará com certeza disponível se a instância do [!INCLUDE[ssDE](../../includes/ssde-md.md)] for iniciada.</span><span class="sxs-lookup"><span data-stu-id="fd71a-127">We recommend that you connect to the master database with the DAC because master is guaranteed to be available if the instance of the [!INCLUDE[ssDE](../../includes/ssde-md.md)] is started.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="fd71a-128">impede a execução de consultas paralelas ou comandos com o DAC.</span><span class="sxs-lookup"><span data-stu-id="fd71a-128">prohibits running parallel queries or commands with the DAC.</span></span> <span data-ttu-id="fd71a-129">Por exemplo, erro 3637 será gerado se você executar uma das seguintes instruções com o DAC:</span><span class="sxs-lookup"><span data-stu-id="fd71a-129">For example, error 3637 is generated if you execute either of the following statements with the DAC:</span></span>  
  
    -   <span data-ttu-id="fd71a-130">RESTORE</span><span class="sxs-lookup"><span data-stu-id="fd71a-130">RESTORE</span></span>  
  
    -   <span data-ttu-id="fd71a-131">BACKUP</span><span class="sxs-lookup"><span data-stu-id="fd71a-131">BACKUP</span></span>  
  
-   <span data-ttu-id="fd71a-132">Apenas recursos limitados têm garantia de disponibilidade com o DAC.</span><span class="sxs-lookup"><span data-stu-id="fd71a-132">Only limited resources are guaranteed to be available with the DAC.</span></span> <span data-ttu-id="fd71a-133">Não use o DAC para executar consultas com muitos recursos (por exemplo,</span><span class="sxs-lookup"><span data-stu-id="fd71a-133">Do not use the DAC to run resource-intensive queries (for example.</span></span> <span data-ttu-id="fd71a-134">uma junção complexa em tabela grande) ou consultas que podem ser bloqueadas.</span><span class="sxs-lookup"><span data-stu-id="fd71a-134">a complex join on large table) or queries that may block.</span></span> <span data-ttu-id="fd71a-135">Isso ajuda a evitar que o DAC combine qualquer problema de servidor existente.</span><span class="sxs-lookup"><span data-stu-id="fd71a-135">This helps prevent the DAC from compounding any existing server problems.</span></span> <span data-ttu-id="fd71a-136">Para evitar possíveis cenários de bloqueio, se você tiver que executar consultas que possam ser bloqueadas, execute-as nos níveis de isolamento baseados em instantâneos, se possível. Caso contrário, defina o nível de isolamento da transação como READ UNCOMMITTED e o valor LOCK_TIMEOUT como um valor curto, como 2000 milissegundos, ou ambos.</span><span class="sxs-lookup"><span data-stu-id="fd71a-136">To avoid potential blocking scenarios, if you have to run queries that may block, run the query under snapshot-based isolation levels if possible; otherwise, set the transaction isolation level to READ UNCOMMITTED and set the LOCK_TIMEOUT value to a short value such as 2000 milliseconds, or both.</span></span> <span data-ttu-id="fd71a-137">Isso impedirá que a sessão DAC seja bloqueada.</span><span class="sxs-lookup"><span data-stu-id="fd71a-137">This will prevent the DAC session from getting blocked.</span></span> <span data-ttu-id="fd71a-138">Porém, dependendo do estado do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , a sessão DAC pode ser travada imediatamente.</span><span class="sxs-lookup"><span data-stu-id="fd71a-138">However, depending on the state that the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is in, the DAC session might get blocked on a latch.</span></span> <span data-ttu-id="fd71a-139">É possível que você consiga encerrar a sessão DAC usando CNTRL-C, mas não é garantido.</span><span class="sxs-lookup"><span data-stu-id="fd71a-139">You might be able to terminate the DAC session using CNTRL-C but it is not guaranteed.</span></span> <span data-ttu-id="fd71a-140">Nesse caso, sua única opção pode ser reiniciar o [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fd71a-140">In that case, your only option may be to restart [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
-   <span data-ttu-id="fd71a-141">Para garantir a conectividade e resolver problemas com o DAC, o [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] reserva recursos limitados para processar comandos executados no DAC.</span><span class="sxs-lookup"><span data-stu-id="fd71a-141">To guarantee connectivity and troubleshooting with the DAC, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] reserves limited resources to process commands run on the DAC.</span></span> <span data-ttu-id="fd71a-142">Esses recursos geralmente só são suficientes para diagnósticos simples e resolução de problemas de funções, como as listadas abaixo.</span><span class="sxs-lookup"><span data-stu-id="fd71a-142">These resources are typically only enough for simple diagnostic and troubleshooting functions, such as those listed below.</span></span>  
  
 <span data-ttu-id="fd71a-143">Embora seja teoricamente possível executar qualquer instrução [!INCLUDE[tsql](../../includes/tsql-md.md)] que não tenha que ser executada paralelamente no DAC, recomendamos que você restrinja o uso dos seguintes comandos de diagnóstico e resolução de problemas:</span><span class="sxs-lookup"><span data-stu-id="fd71a-143">Although you can theoretically run any [!INCLUDE[tsql](../../includes/tsql-md.md)] statement that does not have to execute in parallel on the DAC, we strongly recommend that you restrict usage to the following diagnostic and troubleshooting commands:</span></span>  
  
-   <span data-ttu-id="fd71a-144">Consulta de exibições de gerenciamento dinâmico para diagnósticos básicos como sys.dm_tran_locks, para o status de bloqueio, sys.dm_os_memory_cache_counters, para verificar o funcionamento dos caches, e sys.dm_exec_requests e sys.dm_exec_sessions, para sessões e solicitações ativas.</span><span class="sxs-lookup"><span data-stu-id="fd71a-144">Querying dynamic management views for basic diagnostics such as sys.dm_tran_locks for the locking status, sys.dm_os_memory_cache_counters to check the health of caches, and sys.dm_exec_requests and sys.dm_exec_sessions for active sessions and requests.</span></span> <span data-ttu-id="fd71a-145">Evite exibições de gerenciamento dinâmico que sejam intensivas do recurso (por exemplo, sys.dm_tran_version_store examina o repositório de versão completo e pode causar E/S extensiva) ou que usem junções complexas.</span><span class="sxs-lookup"><span data-stu-id="fd71a-145">Avoid dynamic management views that are resource intensive (for example, sys.dm_tran_version_store scans the full version store and can cause extensive I/O) or that use complex joins.</span></span> <span data-ttu-id="fd71a-146">Para obter informações sobre implicações de desempenho, consulte a documentação sobre [exibições de gerenciamento dinâmico](../../relational-databases/views/views.md)específicas.</span><span class="sxs-lookup"><span data-stu-id="fd71a-146">For information about performance implications, see the documentation for the specific [dynamic management view](../../relational-databases/views/views.md).</span></span>  
  
-   <span data-ttu-id="fd71a-147">Consulta de exibições do catálogo.</span><span class="sxs-lookup"><span data-stu-id="fd71a-147">Querying catalog views.</span></span>  
  
-   <span data-ttu-id="fd71a-148">Comandos DBCC básicos como DBCC FREEPROCCACHE, DBCC FREESYSTEMCACHE, DBCC DROPCLEANBUFFERS`,` e DBCC SQLPERF.</span><span class="sxs-lookup"><span data-stu-id="fd71a-148">Basic DBCC commands such as DBCC FREEPROCCACHE, DBCC FREESYSTEMCACHE, DBCC DROPCLEANBUFFERS`,` and DBCC SQLPERF.</span></span> <span data-ttu-id="fd71a-149">Não execute comandos com uso intensivo de recursos, como **DBCC** CHECKDB, DBCC DBREINDEX ou DBCC SHRINKDATABASE.</span><span class="sxs-lookup"><span data-stu-id="fd71a-149">Do not run resource-intensive commands such as **DBCC** CHECKDB, DBCC DBREINDEX, or DBCC SHRINKDATABASE.</span></span>  
  
-   <span data-ttu-id="fd71a-150">Comando [!INCLUDE[tsql](../../includes/tsql-md.md)] KILL *\<spid>* .</span><span class="sxs-lookup"><span data-stu-id="fd71a-150">[!INCLUDE[tsql](../../includes/tsql-md.md)] KILL*\<spid>* command.</span></span> <span data-ttu-id="fd71a-151">Dependendo do estado do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], o comando KILL nem sempre pode ter êxito; assim, a única opção pode ser reiniciar o [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fd71a-151">Depending on the state of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], the KILL command might not always succeed; then the only option may be to restart [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="fd71a-152">A seguir, algumas diretrizes gerais:</span><span class="sxs-lookup"><span data-stu-id="fd71a-152">The following are some general guidelines:</span></span>  
  
    -   <span data-ttu-id="fd71a-153">Verifique se o SPID foi realmente interrompido consultando `SELECT * FROM sys.dm_exec_sessions WHERE session_id = <spid>`.</span><span class="sxs-lookup"><span data-stu-id="fd71a-153">Verify that the SPID was actually killed by querying `SELECT * FROM sys.dm_exec_sessions WHERE session_id = <spid>`.</span></span> <span data-ttu-id="fd71a-154">Se nenhuma linha for retornada, significa que a sessão foi interrompida.</span><span class="sxs-lookup"><span data-stu-id="fd71a-154">If it returns no rows, it means the session was killed.</span></span>  
  
    -   <span data-ttu-id="fd71a-155">Se a sessão ainda estiver ativa, verifique se há tarefas atribuídas para ela executando a consulta `SELECT * FROM sys.dm_os_tasks WHERE session_id = <spid>`.</span><span class="sxs-lookup"><span data-stu-id="fd71a-155">If the session is still there, verify whether there are tasks assigned to this session by running the query `SELECT * FROM sys.dm_os_tasks WHERE session_id = <spid>`.</span></span> <span data-ttu-id="fd71a-156">Se a tarefa estiver ativa, é provável que sua sessão esteja sendo interrompida no momento.</span><span class="sxs-lookup"><span data-stu-id="fd71a-156">If you see the task there, most likely your session is currently being killed.</span></span> <span data-ttu-id="fd71a-157">Observe que isso pode levar um tempo considerável e não ter êxito nenhum.</span><span class="sxs-lookup"><span data-stu-id="fd71a-157">Note that this may take considerable amount of time and may not succeed at all.</span></span>  
  
    -   <span data-ttu-id="fd71a-158">Se não houver nenhuma tarefa no sys.dm_os_tasks associado a esta sessão, mas a sessão continuar em sys.dm_exec_sessions após a execução do comando KILL, significa que você não tem um trabalhador disponível.</span><span class="sxs-lookup"><span data-stu-id="fd71a-158">If there are no tasks in the sys.dm_os_tasks associated with this session, but the session remains in sys.dm_exec_sessions after executing the KILL command, it means that you do not have a worker available.</span></span> <span data-ttu-id="fd71a-159">Selecione uma das tarefas atualmente em execução (uma tarefa listada na exibição de sys.dm_os_tasks com `sessions_id <> NULL`) e interrompa a sessão associada a ela para liberar o trabalhador.</span><span class="sxs-lookup"><span data-stu-id="fd71a-159">Select one of the currently running tasks (a task listed in the sys.dm_os_tasks view with a `sessions_id <> NULL`), and kill the session associated with it to free up the worker.</span></span> <span data-ttu-id="fd71a-160">Observe que talvez não seja suficiente interromper apenas uma sessão: talvez seja necessário interromper várias.</span><span class="sxs-lookup"><span data-stu-id="fd71a-160">Note that it may not be enough to kill a single session: you may have to kill multiple ones.</span></span>  
  
## <a name="dac-port"></a><span data-ttu-id="fd71a-161">Porta DAC</span><span class="sxs-lookup"><span data-stu-id="fd71a-161">DAC Port</span></span>  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="fd71a-162">verifica o DAC em uma porta TCP 1434, se estiver disponível, ou em uma porta TCP dinamicamente atribuída na inicialização do [!INCLUDE[ssDE](../../includes/ssde-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="fd71a-162">listens for the DAC on TCP port 1434 if available or a TCP port dynamically assigned upon [!INCLUDE[ssDE](../../includes/ssde-md.md)] startup.</span></span> <span data-ttu-id="fd71a-163">O log de erros contém o número da porta que o DAC está escutando.</span><span class="sxs-lookup"><span data-stu-id="fd71a-163">The error log contains the port number the DAC is listening on.</span></span> <span data-ttu-id="fd71a-164">Por padrão, a escuta do DAC aceita conexão apenas na porta local.</span><span class="sxs-lookup"><span data-stu-id="fd71a-164">By default the DAC listener accepts connection on only the local port.</span></span> <span data-ttu-id="fd71a-165">Para obter um exemplo de código que ativa conexões de administração remota, veja [Opção remote admin connections de configuração de servidor](remote-admin-connections-server-configuration-option.md).</span><span class="sxs-lookup"><span data-stu-id="fd71a-165">For a code sample that activates remote administration connections, see [remote admin connections Server Configuration Option](remote-admin-connections-server-configuration-option.md).</span></span>  
  
 <span data-ttu-id="fd71a-166">Depois que uma conexão de administração remota for configurada, a escuta do DAC será habilitada sem a necessidade de reiniciar o [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] e um cliente poderá se conectar ao DAC remotamente.</span><span class="sxs-lookup"><span data-stu-id="fd71a-166">After the remote administration connection is configured, the DAC listener is enabled without requiring a restart of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and a client can now connect to the DAC remotely.</span></span> <span data-ttu-id="fd71a-167">Você pode habilitar a escuta do DAC para aceitar conexões remotamente, mesmo que o [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] não responda durante a primeira conexão com o [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] usando o DAC localmente e, em seguida, executar o procedimento armazenado sp_configure para aceitar conexão de conexões remotas.</span><span class="sxs-lookup"><span data-stu-id="fd71a-167">You can enable the DAC listener to accept connections remotely even if [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is unresponsive by first connecting to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] using the DAC locally, and then executing the sp_configure stored procedure to accept connection from remote connections.</span></span>  
  
 <span data-ttu-id="fd71a-168">Em configurações de cluster, o DAC estará offline, por padrão.</span><span class="sxs-lookup"><span data-stu-id="fd71a-168">On cluster configurations, the DAC will be off by default.</span></span> <span data-ttu-id="fd71a-169">Os usuários podem executar a opção conexão de administração remota do sp_configure para permitir que a escuta do DAC acesse uma conexão remota.</span><span class="sxs-lookup"><span data-stu-id="fd71a-169">Users can execute the remote admin connection option of sp_configure to enable the DAC listener to access a remote connection.</span></span> <span data-ttu-id="fd71a-170">Se o [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] não estiver respondendo e a escuta do DAC não estiver habilitada, talvez seja necessário reiniciar o [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] para se conectar ao DAC.</span><span class="sxs-lookup"><span data-stu-id="fd71a-170">If [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is unresponsive and the DAC listener is not enabled, you might have to restart [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to connect with the DAC.</span></span> <span data-ttu-id="fd71a-171">Dessa forma, recomendamos que você habilite a opção de configuração conexões de administração remotas em sistemas clusterizados.</span><span class="sxs-lookup"><span data-stu-id="fd71a-171">Therefore, we recommend that you enable the remote admin connections configuration option on clustered systems.</span></span>  
  
 <span data-ttu-id="fd71a-172">A porta DAC é atribuída dinamicamente pelo [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] durante a inicialização.</span><span class="sxs-lookup"><span data-stu-id="fd71a-172">The DAC port is assigned dynamically by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] during startup.</span></span> <span data-ttu-id="fd71a-173">Ao conectar-se à instância padrão, o DAC evita usar uma solicitação do Protocolo de Resolução (SSRP) do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ao serviço SQL Server Browser.</span><span class="sxs-lookup"><span data-stu-id="fd71a-173">When connecting to the default instance, the DAC avoids using a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Resolution Protocol (SSRP) request to the SQL Server Browser Service when connecting.</span></span> <span data-ttu-id="fd71a-174">Primeiro ele se conecta usando a porta TCP 1434.</span><span class="sxs-lookup"><span data-stu-id="fd71a-174">It first connects over TCP port 1434.</span></span> <span data-ttu-id="fd71a-175">Se isso falhar, ele faz uma chamada ao SSRP para obter a porta.</span><span class="sxs-lookup"><span data-stu-id="fd71a-175">If that fails, it makes an SSRP call to get the port.</span></span> <span data-ttu-id="fd71a-176">Se o navegador do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] não estiver escutando as solicitações de SSRP, a solicitação de conexão retornará um erro.</span><span class="sxs-lookup"><span data-stu-id="fd71a-176">If [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Browser is not listening for SSRP requests, the connection request returns an error.</span></span> <span data-ttu-id="fd71a-177">Consulte o log de erros para localizar o número da porta que o DAC está escutando.</span><span class="sxs-lookup"><span data-stu-id="fd71a-177">Refer to the error log to find the port number DAC is listening on.</span></span> <span data-ttu-id="fd71a-178">Se o [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] for configurado para aceitar conexões de administração remotas, o DAC deverá ser iniciado com um número de porta explícito:</span><span class="sxs-lookup"><span data-stu-id="fd71a-178">If [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is configured to accept remote administration connections, the DAC must be initiated with an explicit port number:</span></span>  
  
 <span data-ttu-id="fd71a-179">**sqlcmd-STCP:** _ \<server> , \<port> _</span><span class="sxs-lookup"><span data-stu-id="fd71a-179">**sqlcmd-Stcp:** _\<server>,\<port>_</span></span>  
  
 <span data-ttu-id="fd71a-180">O log de erros do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] lista o número da porta para o DAC, que, por padrão, é 1434.</span><span class="sxs-lookup"><span data-stu-id="fd71a-180">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] error log lists the port number for the DAC, which is 1434 by default.</span></span> <span data-ttu-id="fd71a-181">Se o [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] estiver configurado para aceitar apenas conexões DAC locais, conecte usando o adaptador de loopback com o seguinte comando:</span><span class="sxs-lookup"><span data-stu-id="fd71a-181">If [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is configured to accept local DAC connections only, connect using the loopback adapter using the following command:</span></span>  
  
 <span data-ttu-id="fd71a-182">**sqlcmd-s 127.0.0.1**,`1434`</span><span class="sxs-lookup"><span data-stu-id="fd71a-182">**sqlcmd-S127.0.0.1**,`1434`</span></span>  
  
## <a name="example"></a><span data-ttu-id="fd71a-183">Exemplo</span><span class="sxs-lookup"><span data-stu-id="fd71a-183">Example</span></span>  
 <span data-ttu-id="fd71a-184">Neste exemplo, um administrador nota que o servidor `URAN123` não está respondendo e deseja diagnosticar o problema.</span><span class="sxs-lookup"><span data-stu-id="fd71a-184">In this example, an administrator notices that server `URAN123` is not responding and wants to diagnose the problem.</span></span> <span data-ttu-id="fd71a-185">Para isso, o usuário ativa o utilitário de prompt de comando `sqlcmd` e se conecta ao servidor `URAN123` usando `-A` para indicar o DAC.</span><span class="sxs-lookup"><span data-stu-id="fd71a-185">To do this, the user activates the `sqlcmd` command prompt utility and connects to server `URAN123` using `-A` to indicate the DAC.</span></span>  
  
 `sqlcmd -S URAN123 -U sa -P <xxx> -A`  
  
 <span data-ttu-id="fd71a-186">Agora o administrador pode executar consultas para diagnosticar o problema e possivelmente encerrar as sessões sem-resposta.</span><span class="sxs-lookup"><span data-stu-id="fd71a-186">The administrator can now execute queries to diagnose the problem and possibly terminate the unresponsive sessions.</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="fd71a-187">Related Tasks</span><span class="sxs-lookup"><span data-stu-id="fd71a-187">Related Tasks</span></span>  
  
## <a name="related-content"></a><span data-ttu-id="fd71a-188">Conteúdo relacionado</span><span class="sxs-lookup"><span data-stu-id="fd71a-188">Related Content</span></span>  
 [<span data-ttu-id="fd71a-189">Usar sqlcmd com variáveis de script</span><span class="sxs-lookup"><span data-stu-id="fd71a-189">Use sqlcmd with Scripting Variables</span></span>](../../relational-databases/scripting/sqlcmd-use-with-scripting-variables.md)  
  
 [<span data-ttu-id="fd71a-190">Utilitário sqlcmd</span><span class="sxs-lookup"><span data-stu-id="fd71a-190">sqlcmd Utility</span></span>](../../tools/sqlcmd-utility.md)  
  
 [<span data-ttu-id="fd71a-191">SELECT &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="fd71a-191">SELECT &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/queries/select-transact-sql)  
  
 [<span data-ttu-id="fd71a-192">sp_who &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="fd71a-192">sp_who &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-who-transact-sql)  
  
 [<span data-ttu-id="fd71a-193">sp_lock &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="fd71a-193">sp_lock &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-lock-transact-sql)  
  
 [<span data-ttu-id="fd71a-194">KILL &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="fd71a-194">KILL &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/language-elements/kill-transact-sql)  
  
 [<span data-ttu-id="fd71a-195">DBCC CHECKALLOC &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="fd71a-195">DBCC CHECKALLOC &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/database-console-commands/dbcc-checkalloc-transact-sql)  
  
 [<span data-ttu-id="fd71a-196">DBCC CHECKDB &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="fd71a-196">DBCC CHECKDB &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/database-console-commands/dbcc-checkdb-transact-sql)  
  
 [<span data-ttu-id="fd71a-197">DBCC OPENTRAN &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="fd71a-197">DBCC OPENTRAN &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/database-console-commands/dbcc-opentran-transact-sql)  
  
 [<span data-ttu-id="fd71a-198">DBCC INPUTBUFFER &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="fd71a-198">DBCC INPUTBUFFER &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/database-console-commands/dbcc-inputbuffer-transact-sql)  
  
 [<span data-ttu-id="fd71a-199">Opções de configuração do servidor &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="fd71a-199">Server Configuration Options &#40;SQL Server&#41;</span></span>](server-configuration-options-sql-server.md)  
  
 [<span data-ttu-id="fd71a-200">Funções e exibições de gerenciamento dinâmico relacionadas à transação &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="fd71a-200">Transaction Related Dynamic Management Views and Functions &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-dynamic-management-views/transaction-related-dynamic-management-views-and-functions-transact-sql)  
  
 [<span data-ttu-id="fd71a-201">Sinalizadores de rastreamento &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="fd71a-201">Trace Flags &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/database-console-commands/dbcc-traceon-trace-flags-transact-sql)  
  
  
