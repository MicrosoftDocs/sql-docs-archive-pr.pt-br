---
title: Alterações recentes em recursos de Mecanismo de Banco de Dados no SQL Server 2014 | Microsoft Docs
ms.custom: ''
ms.date: 01/19/2019
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: release-landing
ms.topic: conceptual
helpviewer_keywords:
- Database Engine [SQL Server], what's new
- breaking changes [SQL Server]
ms.assetid: 47edefbd-a09b-4087-937a-453cd5c6e061
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: bf1a25aabde1e684407218da7365ae7a2b4265a7
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87685938"
---
# <a name="breaking-changes-to-database-engine-features-in-sql-server-2014"></a><span data-ttu-id="034be-102">Alterações em recursos do Mecanismo de Banco de Dados que causam interrupção no SQL Server 2014</span><span class="sxs-lookup"><span data-stu-id="034be-102">Breaking Changes to Database Engine Features in SQL Server 2014</span></span>
  <span data-ttu-id="034be-103">Este tópico descreve as alterações significativas no [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] [!INCLUDE[ssDE](../includes/ssde-md.md)] e nas versões anteriores do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="034be-103">This topic describes breaking changes in the [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] [!INCLUDE[ssDE](../includes/ssde-md.md)] and earlier versions of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="034be-104">Essas alterações podem danificar aplicativos, scripts ou funcionalidades baseados em versões anteriores do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="034be-104">These changes might break applications, scripts, or functionalities that are based on earlier versions of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="034be-105">Talvez você tenha esses problemas ao atualizar.</span><span class="sxs-lookup"><span data-stu-id="034be-105">You might encounter these issues when you upgrade.</span></span> <span data-ttu-id="034be-106">Para obter mais informações, consulte [Use Upgrade Advisor to Prepare for Upgrades](../sql-server/install/use-upgrade-advisor-to-prepare-for-upgrades.md).</span><span class="sxs-lookup"><span data-stu-id="034be-106">For more information, see [Use Upgrade Advisor to Prepare for Upgrades](../sql-server/install/use-upgrade-advisor-to-prepare-for-upgrades.md).</span></span>  
  
##  <a name="breaking-changes-in-sssql14"></a><a name="SQL14"></a> <span data-ttu-id="034be-107">Últimas alterações do [!INCLUDE[ssSQL14](../includes/sssql14-md.md)]</span><span class="sxs-lookup"><span data-stu-id="034be-107">Breaking Changes in [!INCLUDE[ssSQL14](../includes/sssql14-md.md)]</span></span>  
 <span data-ttu-id="034be-108">Nenhum novo problema.</span><span class="sxs-lookup"><span data-stu-id="034be-108">No new issues.</span></span>  
  
##  <a name="breaking-changes-in-sssql11"></a><a name="Denali"></a> <span data-ttu-id="034be-109">Últimas alterações do [!INCLUDE[ssSQL11](../includes/sssql11-md.md)]</span><span class="sxs-lookup"><span data-stu-id="034be-109">Breaking Changes in [!INCLUDE[ssSQL11](../includes/sssql11-md.md)]</span></span>  
  
### <a name="transact-sql"></a><span data-ttu-id="034be-110">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="034be-110">Transact-SQL</span></span>  
  
|<span data-ttu-id="034be-111">Recurso</span><span class="sxs-lookup"><span data-stu-id="034be-111">Feature</span></span>|<span data-ttu-id="034be-112">Descrição</span><span class="sxs-lookup"><span data-stu-id="034be-112">Description</span></span>|  
|-------------|-----------------|  
|<span data-ttu-id="034be-113">Selecionando a partir de colunas ou tabelas denominadas NEXT</span><span class="sxs-lookup"><span data-stu-id="034be-113">Selecting from columns or tables named NEXT</span></span>|<span data-ttu-id="034be-114">As sequências usam a função NEXT VALUE FOR do padrão ANSI.</span><span class="sxs-lookup"><span data-stu-id="034be-114">Sequences use the ANSI standard NEXT VALUE FOR function.</span></span> <span data-ttu-id="034be-115">Se uma tabela ou uma coluna for nomeada em seguida e a tabela ou coluna tiver um alias como valor, e se o padrão ANSI como for omitido, a instrução resultante poderá causar um erro.</span><span class="sxs-lookup"><span data-stu-id="034be-115">If a table or a column is named NEXT and the table or column is aliased as VALUE, and if the ANSI standard AS is omitted, the resultant statement can cause an error.</span></span> <span data-ttu-id="034be-116">Para obter uma solução alternativa, inclua a palavra-chave AS do padrão ANSI.</span><span class="sxs-lookup"><span data-stu-id="034be-116">To work around, include the ANSI standard AS keyword.</span></span> <span data-ttu-id="034be-117">Por exemplo, `SELECT NEXT VALUE FROM Table` deveria ser reescrito como `SELECT NEXT AS VALUE FROM Table` e `SELECT Col1 FROM NEXT VALUE` deveria ser reescrito como `SELECT Col1 FROM NEXT AS VALUE`.</span><span class="sxs-lookup"><span data-stu-id="034be-117">For example, `SELECT NEXT VALUE FROM Table` should be rewritten as `SELECT NEXT AS VALUE FROM Table` and `SELECT Col1 FROM NEXT VALUE` should be rewritten as `SELECT Col1 FROM NEXT AS VALUE`.</span></span>|  
|<span data-ttu-id="034be-118">operador PIVOT</span><span class="sxs-lookup"><span data-stu-id="034be-118">PIVOT operator</span></span>|<span data-ttu-id="034be-119">O operador PIVOT não é permitido em uma consulta CTE (expressão de tabela comum) recursiva quando o nível de compatibilidade do banco de dados é definido como 110.</span><span class="sxs-lookup"><span data-stu-id="034be-119">The PIVOT operator is not allowed in a recursive common table expression (CTE) query when the database compatibility level is set to 110.</span></span> <span data-ttu-id="034be-120">Escreva a consulta novamente ou altere o nível de compatibilidade para 100 ou menos.</span><span class="sxs-lookup"><span data-stu-id="034be-120">Rewrite the query, or change the compatibility level to 100 or lower.</span></span> <span data-ttu-id="034be-121">O uso de PIVOT e uma consulta CTE recursiva produz resultados incorretos quando há mais de uma única linha por agrupamento.</span><span class="sxs-lookup"><span data-stu-id="034be-121">Using PIVOT in a recursive CTE query produces incorrect results when there is more than a single row per grouping.</span></span>|  
|<span data-ttu-id="034be-122">sp_setapprole e sp_unsetapprole</span><span class="sxs-lookup"><span data-stu-id="034be-122">sp_setapprole and sp_unsetapprole</span></span>|<span data-ttu-id="034be-123">O parâmetro `OUTPUT` de cookie para `sp_setapprole` é documentado atualmente como `varbinary(8000)` que é o comprimento máximo correto.</span><span class="sxs-lookup"><span data-stu-id="034be-123">The cookie `OUTPUT` parameter for `sp_setapprole` is currently documented as `varbinary(8000)` which is the correct maximum length.</span></span> <span data-ttu-id="034be-124">No entanto, a implementação atual retorna `varbinary(50)`.</span><span class="sxs-lookup"><span data-stu-id="034be-124">However the current implementation returns `varbinary(50)`.</span></span> <span data-ttu-id="034be-125">Os aplicativos devem continuar a reservar `varbinary(8000)` para que o aplicativo continue a operar corretamente se o tamanho de retorno do cookie aumentar em uma versão futura.</span><span class="sxs-lookup"><span data-stu-id="034be-125">Applications should continue to reserve `varbinary(8000)` so that the application continues to operate correctly if the cookie return size increases in a future release.</span></span> <span data-ttu-id="034be-126">Para obter mais informações, veja [sp_setapprole &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-setapprole-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="034be-126">For more information, see [sp_setapprole &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-setapprole-transact-sql).</span></span>|  
|<span data-ttu-id="034be-127">EXECUTE AS</span><span class="sxs-lookup"><span data-stu-id="034be-127">EXECUTE AS</span></span>|<span data-ttu-id="034be-128">O parâmetro OUTPUT de cookie para EXECUTE AS está documentado atualmente como `varbinary(8000)`, que tem o comprimento máximo correto.</span><span class="sxs-lookup"><span data-stu-id="034be-128">The cookie OUTPUT parameter for EXECUTE AS is currently documented as `varbinary(8000)` which is the correct maximum length.</span></span> <span data-ttu-id="034be-129">No entanto, a implementação atual retorna `varbinary(100)`.</span><span class="sxs-lookup"><span data-stu-id="034be-129">However the current implementation returns `varbinary(100)`.</span></span> <span data-ttu-id="034be-130">Os aplicativos devem continuar a reservar `varbinary(8000)` para que o aplicativo continue a operar corretamente se o tamanho de retorno do cookie aumentar em uma versão futura.</span><span class="sxs-lookup"><span data-stu-id="034be-130">Applications should continue to reserve `varbinary(8000)` so that the application continues to operate correctly if the cookie return size increases in a future release.</span></span> <span data-ttu-id="034be-131">Para obter mais informações, veja [EXECUTE AS &#40;Transact-SQL&#41;](/sql/t-sql/statements/execute-as-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="034be-131">For more information, see [EXECUTE AS &#40;Transact-SQL&#41;](/sql/t-sql/statements/execute-as-transact-sql).</span></span>|  
|<span data-ttu-id="034be-132">função sys.fn_get_audit_file</span><span class="sxs-lookup"><span data-stu-id="034be-132">sys.fn_get_audit_file function</span></span>|<span data-ttu-id="034be-133">Duas colunas adicionais (**user_defined_event_id** e **user_defined_information**) foram adicionadas para dar suporte a eventos de auditoria definidos pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="034be-133">Two additional columns (**user_defined_event_id** and **user_defined_information**) have been added to support user-defined audit events.</span></span> <span data-ttu-id="034be-134">Aplicativos que não selecionam colunas por nome podem retornar mais colunas do que o esperado.</span><span class="sxs-lookup"><span data-stu-id="034be-134">Applications that do not select columns by name might return more columns than expected.</span></span> <span data-ttu-id="034be-135">Selecione as colunas por nome ou ajuste o aplicativo para aceitar essas colunas adicionais.</span><span class="sxs-lookup"><span data-stu-id="034be-135">Either select columns by name, or adjust the application to accept these additional columns.</span></span>|  
|<span data-ttu-id="034be-136">Palavra-chave reservada WITHIN</span><span class="sxs-lookup"><span data-stu-id="034be-136">WITHIN reserved keyword</span></span>|<span data-ttu-id="034be-137">Agora, WITHIN é uma palavra-chave reservada.</span><span class="sxs-lookup"><span data-stu-id="034be-137">WITHIN is now a reserved keyword.</span></span> <span data-ttu-id="034be-138">As referências a colunas ou objetos denominados 'within' falharão.</span><span class="sxs-lookup"><span data-stu-id="034be-138">References to objects or columns named 'within' will fail.</span></span> <span data-ttu-id="034be-139">Renomeie a coluna ou o objeto ou delimite o nome usando colchetes ou aspas.</span><span class="sxs-lookup"><span data-stu-id="034be-139">Rename the object or column name or delimit the name by using brackets or quotes.</span></span>  <span data-ttu-id="034be-140">Por exemplo, `SELECT * FROM [within]`.</span><span class="sxs-lookup"><span data-stu-id="034be-140">For example, `SELECT * FROM [within]`.</span></span>|  
|<span data-ttu-id="034be-141">Operações CAST e CONVERT em colunas computadas do tipo `time` ou `datetime2`</span><span class="sxs-lookup"><span data-stu-id="034be-141">CAST and CONVERT operations on computed columns of type `time` or `datetime2`</span></span>|<span data-ttu-id="034be-142">Nas versões anteriores do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], o estilo padrão de operações CAST e CONVERT nos tipos de dados `time` e `datetime2` é 121, exceto quando um dos tipos é usado em uma expressão de coluna computada.</span><span class="sxs-lookup"><span data-stu-id="034be-142">In earlier versions of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], the default style for CAST and CONVERT operations on `time` and `datetime2` data types is 121 except when either type is used in a computed column expression.</span></span> <span data-ttu-id="034be-143">Para colunas computadas, o estilo padrão é 0.</span><span class="sxs-lookup"><span data-stu-id="034be-143">For computed columns, the default style is 0.</span></span> <span data-ttu-id="034be-144">Esse comportamento afeta as colunas computadas quando são criadas, usadas em consultas que envolvam parametrização automática ou usadas em definições de restrição.</span><span class="sxs-lookup"><span data-stu-id="034be-144">This behavior impacts computed columns when they are created, used in queries involving auto-parameterization, or used in constraint definitions.</span></span><br /><br /> <span data-ttu-id="034be-145">No nível de compatibilidade 110, o estilo padrão das operações CAST e CONVERT nos tipos de dados `time` e `datetime2` sempre é 121.</span><span class="sxs-lookup"><span data-stu-id="034be-145">Under compatibility level 110, the default style for CAST and CONVERT operations on `time` and `datetime2` data types is always 121.</span></span> <span data-ttu-id="034be-146">Se a sua consulta depender do comportamento antigo, use um nível de compatibilidade inferior a 110 ou especifique explicitamente o estilo 0 na consulta afetada.</span><span class="sxs-lookup"><span data-stu-id="034be-146">If your query relies on the old behavior, use a compatibility level less than 110, or explicitly specify the 0 style in the affected query.</span></span><br /><br /> <span data-ttu-id="034be-147">A atualização do banco de dados para o nível de compatibilidade 110 não alterará os dados de usuário que foram armazenados em disco.</span><span class="sxs-lookup"><span data-stu-id="034be-147">Upgrading the database to compatibility level 110 will not change user data that has been stored to disk.</span></span> <span data-ttu-id="034be-148">Você deve corrigir esses dados manualmente conforme apropriado.</span><span class="sxs-lookup"><span data-stu-id="034be-148">You must manually correct this data as appropriate.</span></span> <span data-ttu-id="034be-149">Por exemplo, se você usou SELECT INTO para criar uma tabela com base em uma fonte que continha uma expressão de coluna computada descrita acima, os dados (usando o estilo 0) serão armazenados, em vez da própria definição de coluna computada.</span><span class="sxs-lookup"><span data-stu-id="034be-149">For example, if you used SELECT INTO to create a table from a source that contained a computed column expression described above, the data (using style 0) would be stored rather than the computed column definition itself.</span></span> <span data-ttu-id="034be-150">Você precisará atualizar manualmente esses dados para que coincidam com o estilo 121.</span><span class="sxs-lookup"><span data-stu-id="034be-150">You would need to manually update this data to match style 121.</span></span>|  
|<span data-ttu-id="034be-151">ALTER TABLE</span><span class="sxs-lookup"><span data-stu-id="034be-151">ALTER TABLE</span></span>|<span data-ttu-id="034be-152">A instrução ALTER TABLE permite apenas nomes de tabela de duas partes (schema.object).</span><span class="sxs-lookup"><span data-stu-id="034be-152">The ALTER TABLE statement allows only two-part (schema.object) table names.</span></span> <span data-ttu-id="034be-153">A especificação de um nome de tabela usando os seguintes formatos agora falha no momento da compilação com o erro 117:</span><span class="sxs-lookup"><span data-stu-id="034be-153">Specifying a table name using the following formats now fails at compile time with error 117:</span></span><br /><br /> <span data-ttu-id="034be-154">server.database.schema.table</span><span class="sxs-lookup"><span data-stu-id="034be-154">server.database.schema.table</span></span><br /><br /> <span data-ttu-id="034be-155">.database.schema.table</span><span class="sxs-lookup"><span data-stu-id="034be-155">.database.schema.table</span></span><br /><br /> <span data-ttu-id="034be-156">..schema.table</span><span class="sxs-lookup"><span data-stu-id="034be-156">..schema.table</span></span><br /><br /> <span data-ttu-id="034be-157">As versões anteriores que especificam que o formato server.database.schema.table retornaram o erro 4902.</span><span class="sxs-lookup"><span data-stu-id="034be-157">In earlier versions specifying the format server.database.schema.table returned error 4902.</span></span> <span data-ttu-id="034be-158">A especificação do formato .database.schema.table ou do formato ..schema.table foi bem-sucedida.</span><span class="sxs-lookup"><span data-stu-id="034be-158">Specifying the format .database.schema.table or the format ..schema.table succeeded.</span></span> <span data-ttu-id="034be-159">Para resolver o problema, remova o uso de um prefixo de 4 partes.</span><span class="sxs-lookup"><span data-stu-id="034be-159">To resolve the problem, remove the use of a 4-part prefix.</span></span>|  
|<span data-ttu-id="034be-160">Navegando em metadados</span><span class="sxs-lookup"><span data-stu-id="034be-160">Browsing metadata</span></span>|<span data-ttu-id="034be-161">Consultar uma exibição usando FOR BROWSE ou SET NO_BROWSETABLE ON agora retorna os metadados da exibição, não os metadados do objeto subjacente.</span><span class="sxs-lookup"><span data-stu-id="034be-161">Querying a view using FOR BROWSE or SET NO_BROWSETABLE ON now returns the metadata of the view, not the metadata of the underlying object.</span></span> <span data-ttu-id="034be-162">Esse comportamento agora corresponde a outros métodos de navegação em metadados.</span><span class="sxs-lookup"><span data-stu-id="034be-162">This behavior now matches other methods of browsing metadata.</span></span>|  
|<span data-ttu-id="034be-163">SOUNDEX</span><span class="sxs-lookup"><span data-stu-id="034be-163">SOUNDEX</span></span>|<span data-ttu-id="034be-164">No nível de compatibilidade de banco de dados 110, a função SOUNDEX implementa novas regras que podem fazer com que os valores computados pela função sejam diferentes dos valores computados sob os níveis de compatibilidade anteriores.</span><span class="sxs-lookup"><span data-stu-id="034be-164">Under database compatibility level 110, the SOUNDEX function implements new rules that may cause the values computed by the function to be different than the values computed under earlier compatibility levels.</span></span> <span data-ttu-id="034be-165">Após a atualização para o nível de compatibilidade 110, talvez seja necessário recriar os índices, os heaps ou as restrições CHECK que usam a função SOUNDEX.</span><span class="sxs-lookup"><span data-stu-id="034be-165">After upgrading to compatibility level 110, you may need to rebuild the indexes, heaps, or CHECK constraints that use the SOUNDEX function.</span></span> <span data-ttu-id="034be-166">Para obter mais informações, consulte [SOUNDEX &#40;Transact-SQL&#41;](/sql/t-sql/functions/soundex-transact-sql)</span><span class="sxs-lookup"><span data-stu-id="034be-166">For more information, see [SOUNDEX &#40;Transact-SQL&#41;](/sql/t-sql/functions/soundex-transact-sql)</span></span>
|<span data-ttu-id="034be-167">Mensagem de contagem de linhas para instruções DML com falha</span><span class="sxs-lookup"><span data-stu-id="034be-167">Row count message for failed DML statements</span></span>|<span data-ttu-id="034be-168">No [!INCLUDE[ssSQL11](../includes/sssql11-md.md)], o [!INCLUDE[ssDE](../includes/ssde-md.md)] enviará consistentemente o token TDS DONE com RowCount: 0 aos clientes quando uma instrução DML falhar.</span><span class="sxs-lookup"><span data-stu-id="034be-168">In [!INCLUDE[ssSQL11](../includes/sssql11-md.md)], the [!INCLUDE[ssDE](../includes/ssde-md.md)] will consistently send the TDS DONE token with RowCount: 0 to clients when a DML statement fails.</span></span> <span data-ttu-id="034be-169">Nas versões anteriores do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], um valor incorreto de -1 é enviado ao cliente quando a instrução DML que falha está contida em um bloco TRY-CATCH é parametrizada automaticamente pelo [!INCLUDE[ssDE](../includes/ssde-md.md)] ou o bloco TRY-CATCH não está no mesmo nível da instrução que falhou.</span><span class="sxs-lookup"><span data-stu-id="034be-169">In earlier versions of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], an incorrect value of -1 is sent to the client when the DML statement that fails is contained in a TRY-CATCH block and is either autoparameterized by the [!INCLUDE[ssDE](../includes/ssde-md.md)] or the TRY-CATCH block is not on the same level as the failed statement.</span></span> <span data-ttu-id="034be-170">Por exemplo, se um bloco TRY-CATCH chamar um procedimento armazenado e uma instrução DML no procedimento falhar, o cliente receberá incorretamente um valor -1.</span><span class="sxs-lookup"><span data-stu-id="034be-170">For example, if a TRY-CATCH block calls a stored procedure and a DML statement in the procedure fails, the client will incorrectly receive a -1 value.</span></span><br /><br /> <span data-ttu-id="034be-171">Os aplicativos que confiarem nesse comportamento incorreto falharão.</span><span class="sxs-lookup"><span data-stu-id="034be-171">Applications that rely on this incorrect behavior will fail.</span></span>|  
|<span data-ttu-id="034be-172">SERVERPROPERTY (' edição ')</span><span class="sxs-lookup"><span data-stu-id="034be-172">SERVERPROPERTY ('Edition')</span></span>|<span data-ttu-id="034be-173">Edição instalada do produto da instância do [!INCLUDE[ssSQL11](../includes/sssql11-md.md)].</span><span class="sxs-lookup"><span data-stu-id="034be-173">Installed product edition of the instance of [!INCLUDE[ssSQL11](../includes/sssql11-md.md)].</span></span> <span data-ttu-id="034be-174">Use o valor dessa propriedade para determinar os recursos e os limites, como o número máximo de CPUs que têm suporte do produto instalado.</span><span class="sxs-lookup"><span data-stu-id="034be-174">Use the value of this property to determine the features and the limits, such as maximum number of CPUs that are supported by the installed product.</span></span><br /><br /> <span data-ttu-id="034be-175">Com base na edição Enterprise instalada, isso pode retornar ' Enterprise Edition ' ou ' Enterprise Edition: licenciamento baseado em núcleo '.</span><span class="sxs-lookup"><span data-stu-id="034be-175">Based on the installed Enterprise edition, this can return 'Enterprise Edition' or 'Enterprise Edition: Core-based Licensing'.</span></span> <span data-ttu-id="034be-176">As edições Enterprise são diferenciadas com base na capacidade de computação máxima por uma única instância do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="034be-176">The Enterprise editions are differentiated based on the maximum compute capacity by a single instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="034be-177">Para obter mais informações sobre os limites de capacidade de computação no [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] , consulte [computar limites de capacidade por edição do SQL Server](../sql-server/compute-capacity-limits-by-edition-of-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="034be-177">For more information on Compute capacity limits in [!INCLUDE[ssSQL11](../includes/sssql11-md.md)], see [Compute Capacity Limits by Edition of SQL Server](../sql-server/compute-capacity-limits-by-edition-of-sql-server.md).</span></span>|  
|<span data-ttu-id="034be-178">CREATE LOGIN</span><span class="sxs-lookup"><span data-stu-id="034be-178">CREATE LOGIN</span></span>|<span data-ttu-id="034be-179">A `CREATE LOGIN WITH PASSWORD = '` opção de *senha* `' HASHED` não pode ser usada com hashes criados por [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 7 ou anterior.</span><span class="sxs-lookup"><span data-stu-id="034be-179">The `CREATE LOGIN WITH PASSWORD = '`*password*`' HASHED` option cannot be used with hashes created by [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 7 or earlier.</span></span>|  
|<span data-ttu-id="034be-180">Operações CAST e CONVERT para `datetimeoffset`</span><span class="sxs-lookup"><span data-stu-id="034be-180">CAST and CONVERT operations for `datetimeoffset`</span></span>|<span data-ttu-id="034be-181">Os únicos estilos que têm suporte ao serem convertidos de tipos de data e hora para `datetimeoffset` são 0 ou 1.</span><span class="sxs-lookup"><span data-stu-id="034be-181">The only styles that are supported when converting from date and time types to `datetimeoffset` are 0 or 1.</span></span> <span data-ttu-id="034be-182">Todos os outros estilos de conversão retornam erro 9809.</span><span class="sxs-lookup"><span data-stu-id="034be-182">All other conversion styles return error 9809.</span></span> <span data-ttu-id="034be-183">Por exemplo, o seguinte código retorna um erro 9809.</span><span class="sxs-lookup"><span data-stu-id="034be-183">For example, the following code returns error 9809.</span></span><br /><br /> `SELECT CONVERT(date, CAST('7070-11-25 16:25:01.00986 -02:07' as datetimeoffset(5)), 107);`|  
  
### <a name="dynamic-management-views"></a><span data-ttu-id="034be-184">Exibições de Gerenciamento Dinâmico</span><span class="sxs-lookup"><span data-stu-id="034be-184">Dynamic Management Views</span></span>  
  
|<span data-ttu-id="034be-185">Exibir</span><span class="sxs-lookup"><span data-stu-id="034be-185">View</span></span>|<span data-ttu-id="034be-186">Descrição</span><span class="sxs-lookup"><span data-stu-id="034be-186">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="034be-187">sys.dm_exec_requests</span><span class="sxs-lookup"><span data-stu-id="034be-187">sys.dm_exec_requests</span></span>|<span data-ttu-id="034be-188">As alterações de coluna de comando de `nvarchar(16)` para `nvarchar(32)`.</span><span class="sxs-lookup"><span data-stu-id="034be-188">The command column changes from `nvarchar(16)` to `nvarchar(32)`.</span></span>|  
|<span data-ttu-id="034be-189">sys.dm_os_memory_cache_counters</span><span class="sxs-lookup"><span data-stu-id="034be-189">sys.dm_os_memory_cache_counters</span></span>|<span data-ttu-id="034be-190">As seguintes colunas foram renomeadas:</span><span class="sxs-lookup"><span data-stu-id="034be-190">The following columns have been renamed:</span></span><br /><br /> <span data-ttu-id="034be-191">single_pages_kb agora é:</span><span class="sxs-lookup"><span data-stu-id="034be-191">single_pages_kb is now:</span></span> <br />                          <span data-ttu-id="034be-192">pages_kb</span><span class="sxs-lookup"><span data-stu-id="034be-192">pages_kb</span></span><br /><br /> <span data-ttu-id="034be-193">multi_pages_kb</span><span class="sxs-lookup"><span data-stu-id="034be-193">multi_pages_kb</span></span><br />                           <span data-ttu-id="034be-194">Agora é: pages_in_use_kb</span><span class="sxs-lookup"><span data-stu-id="034be-194">is now: pages_in_use_kb</span></span>|  
|<span data-ttu-id="034be-195">sys.dm_os_memory_cache_entries</span><span class="sxs-lookup"><span data-stu-id="034be-195">sys.dm_os_memory_cache_entries</span></span>|<span data-ttu-id="034be-196">A coluna de pages_allocated_count de coluna foi renomeada pages_kb.</span><span class="sxs-lookup"><span data-stu-id="034be-196">The column pages_allocated_count column has been renamed pages_kb.</span></span>|  
|<span data-ttu-id="034be-197">sys.dm_os_memory_clerks</span><span class="sxs-lookup"><span data-stu-id="034be-197">sys.dm_os_memory_clerks</span></span>|<span data-ttu-id="034be-198">A multi_pages_kb de coluna foi removida.</span><span class="sxs-lookup"><span data-stu-id="034be-198">The column multi_pages_kb has been removed.</span></span><br /><br /> <span data-ttu-id="034be-199">A coluna de single_pages_kb de coluna foi renomeada pages_kb.</span><span class="sxs-lookup"><span data-stu-id="034be-199">The column single_pages_kb column has been renamed pages_kb.</span></span>|  
|<span data-ttu-id="034be-200">sys.dm_os_memory_nodes</span><span class="sxs-lookup"><span data-stu-id="034be-200">sys.dm_os_memory_nodes</span></span>|<span data-ttu-id="034be-201">As seguintes colunas foram renomeadas:</span><span class="sxs-lookup"><span data-stu-id="034be-201">The following columns have been renamed:</span></span><br /><br /> <span data-ttu-id="034be-202">single_pages_kb agora é:</span><span class="sxs-lookup"><span data-stu-id="034be-202">single_pages_kb is now:</span></span> <br />                            <span data-ttu-id="034be-203">pages_kb</span><span class="sxs-lookup"><span data-stu-id="034be-203">pages_kb</span></span><br /><br /> <span data-ttu-id="034be-204">multi_pages_kb agora é:</span><span class="sxs-lookup"><span data-stu-id="034be-204">multi_pages_kb is now:</span></span> <br />                            <span data-ttu-id="034be-205">foreign_committed_kb</span><span class="sxs-lookup"><span data-stu-id="034be-205">foreign_committed_kb</span></span>|  
|<span data-ttu-id="034be-206">sys.dm_os_memory_objects</span><span class="sxs-lookup"><span data-stu-id="034be-206">sys.dm_os_memory_objects</span></span>|<span data-ttu-id="034be-207">As colunas a seguir foram renomeadas.</span><span class="sxs-lookup"><span data-stu-id="034be-207">The following columns have been renamed.</span></span><br /><br /> <span data-ttu-id="034be-208">pages_allocated_count agora é:</span><span class="sxs-lookup"><span data-stu-id="034be-208">pages_allocated_count is now:</span></span><br />                            <span data-ttu-id="034be-209">pages_in_bytes</span><span class="sxs-lookup"><span data-stu-id="034be-209">pages_in_bytes</span></span><br /><br /> <span data-ttu-id="034be-210">max_pages_allocated_count agora é: max_pages_in_bytes</span><span class="sxs-lookup"><span data-stu-id="034be-210">max_pages_allocated_count is now: max_pages_in_bytes</span></span>|  
|<span data-ttu-id="034be-211">sys.dm_os_sys_info</span><span class="sxs-lookup"><span data-stu-id="034be-211">sys.dm_os_sys_info</span></span>|<span data-ttu-id="034be-212">As seguintes colunas foram renomeadas:</span><span class="sxs-lookup"><span data-stu-id="034be-212">The following columns have been renamed:</span></span><br /><br /> <span data-ttu-id="034be-213">physical_memory_in_bytes agora é:</span><span class="sxs-lookup"><span data-stu-id="034be-213">physical_memory_in_bytes is now:</span></span> <br />                            <span data-ttu-id="034be-214">physical_memory_kb</span><span class="sxs-lookup"><span data-stu-id="034be-214">physical_memory_kb</span></span><br /><br /> <span data-ttu-id="034be-215">bpool_commit_target agora é:</span><span class="sxs-lookup"><span data-stu-id="034be-215">bpool_commit_target is now:</span></span> <br />                            <span data-ttu-id="034be-216">committed_target_kb</span><span class="sxs-lookup"><span data-stu-id="034be-216">committed_target_kb</span></span><br /><br /> <span data-ttu-id="034be-217">bpool_visible agora é:</span><span class="sxs-lookup"><span data-stu-id="034be-217">bpool_visible is now:</span></span> <br />                            <span data-ttu-id="034be-218">visible_target_kb</span><span class="sxs-lookup"><span data-stu-id="034be-218">visible_target_kb</span></span><br /><br /> <span data-ttu-id="034be-219">virtual_memory_in_bytes agora é:</span><span class="sxs-lookup"><span data-stu-id="034be-219">virtual_memory_in_bytes is now:</span></span> <br />                            <span data-ttu-id="034be-220">virtual_memory_kb</span><span class="sxs-lookup"><span data-stu-id="034be-220">virtual_memory_kb</span></span><br /><br /> <span data-ttu-id="034be-221">bpool_commited agora é:</span><span class="sxs-lookup"><span data-stu-id="034be-221">bpool_commited is now:</span></span><br />                            <span data-ttu-id="034be-222">committed_kb</span><span class="sxs-lookup"><span data-stu-id="034be-222">committed_kb</span></span>|  
|<span data-ttu-id="034be-223">sys.dm_os_workers</span><span class="sxs-lookup"><span data-stu-id="034be-223">sys.dm_os_workers</span></span>|<span data-ttu-id="034be-224">A coluna de localidade foi removida.</span><span class="sxs-lookup"><span data-stu-id="034be-224">The locale column has been removed.</span></span>|  
  
### <a name="catalog-views"></a><span data-ttu-id="034be-225">Exibições do catálogo</span><span class="sxs-lookup"><span data-stu-id="034be-225">Catalog Views</span></span>  
  
|<span data-ttu-id="034be-226">Exibir</span><span class="sxs-lookup"><span data-stu-id="034be-226">View</span></span>|<span data-ttu-id="034be-227">Descrição</span><span class="sxs-lookup"><span data-stu-id="034be-227">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="034be-228">sys.data_spaces</span><span class="sxs-lookup"><span data-stu-id="034be-228">sys.data_spaces</span></span><br /><br /> <span data-ttu-id="034be-229">sys.partition_schemes</span><span class="sxs-lookup"><span data-stu-id="034be-229">sys.partition_schemes</span></span><br /><br /> <span data-ttu-id="034be-230">sys.filegroups</span><span class="sxs-lookup"><span data-stu-id="034be-230">sys.filegroups</span></span><br /><br /> <span data-ttu-id="034be-231">sys.partition_functions</span><span class="sxs-lookup"><span data-stu-id="034be-231">sys.partition_functions</span></span>|<span data-ttu-id="034be-232">Uma nova coluna, is_system, foi adicionada a sys.data_spaces e sys.partition_functions.</span><span class="sxs-lookup"><span data-stu-id="034be-232">A new column, is_system, has been added to sys.data_spaces and sys.partition_functions.</span></span> <span data-ttu-id="034be-233">(sys.partition_schemes e sys.filegroups herdam as colunas de sys.data_spaces.)</span><span class="sxs-lookup"><span data-stu-id="034be-233">(sys.partition_schemes and sys.filegroups inherit the columns of sys.data_spaces.)</span></span><br /><br /> <span data-ttu-id="034be-234">Um valor de 1 nessa coluna indica que o objeto foi usado para fragmentos de índice de texto completo.</span><span class="sxs-lookup"><span data-stu-id="034be-234">A value of 1 in this column indicates that the object is used for full-text index fragments.</span></span><br /><br /> <span data-ttu-id="034be-235">Em sys.partition_functions, sys.partition_schemes e sys.filegroups, a nova coluna não é a última coluna.</span><span class="sxs-lookup"><span data-stu-id="034be-235">In sys.partition_functions, sys.partition_schemes, and sys.filegroups, the new column is not the last column.</span></span> <span data-ttu-id="034be-236">Revise as consultas existentes que confiam na ordem das colunas retornadas dessas exibições de catálogo.</span><span class="sxs-lookup"><span data-stu-id="034be-236">Revise existing queries that rely on the order of columns returned from these catalog views.</span></span>|  
  
### <a name="sql-clr-data-types-geometry-geography-and-hierarchyid"></a><span data-ttu-id="034be-237">Tipos de dados de SQL CLR (geometria, geografia e hierarchyid)</span><span class="sxs-lookup"><span data-stu-id="034be-237">SQL CLR Data Types (geometry, geography, and hierarchyid)</span></span>  
 <span data-ttu-id="034be-238">O assembly **Microsoft.SqlServer.Types.dll**, que contém os tipos de dados espaciais e o tipo hierarchyid, foi atualizado da versão 10,0 para a versão 11,0.</span><span class="sxs-lookup"><span data-stu-id="034be-238">The assembly **Microsoft.SqlServer.Types.dll**, which contains the spatial data types and the hierarchyid type, has been upgraded from version 10.0 to version 11.0.</span></span> <span data-ttu-id="034be-239">Aplicativos personalizados que referenciam esse assembly poderão falhar quando as condições a seguir forem verdadeiras.</span><span class="sxs-lookup"><span data-stu-id="034be-239">Custom applications that reference this assembly may fail when the following conditions are true.</span></span>  
  
-   <span data-ttu-id="034be-240">Quando você move um aplicativo personalizado de um computador no qual [!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)] o foi instalado em um computador no qual [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] o só está instalado, o aplicativo falhará porque a versão referenciada 10,0 do assembly **SqlTypes** não está presente.</span><span class="sxs-lookup"><span data-stu-id="034be-240">When you move a custom application from a computer on which [!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)] was installed to a computer on which only [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] is installed, the application will fail because the referenced version 10.0 of the **SqlTypes** assembly is not present.</span></span> <span data-ttu-id="034be-241">Talvez você receba esta mensagem de erro: `"Could not load file or assembly 'Microsoft.SqlServer.Types, Version=10.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91' or one of its dependencies. The system cannot find the file specified."`</span><span class="sxs-lookup"><span data-stu-id="034be-241">You may see this error message: `"Could not load file or assembly 'Microsoft.SqlServer.Types, Version=10.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91' or one of its dependencies. The system cannot find the file specified."`</span></span>  
  
-   <span data-ttu-id="034be-242">Quando você faz referência à versão 11,0 do assembly **SqlTypes** e a versão 10,0 também está instalada, essa mensagem de erro pode ser exibida:`"System.InvalidCastException: Unable to cast object of type 'Microsoft.SqlServer.Types.SqlGeometry' to type 'Microsoft.SqlServer.Types.SqlGeometry'."`</span><span class="sxs-lookup"><span data-stu-id="034be-242">When you reference the **SqlTypes** assembly version 11.0, and version 10.0 is also installed, you may see this error message: `"System.InvalidCastException: Unable to cast object of type 'Microsoft.SqlServer.Types.SqlGeometry' to type 'Microsoft.SqlServer.Types.SqlGeometry'."`</span></span>  
  
-   <span data-ttu-id="034be-243">Quando você faz referência à versão 11,0 do assembly **SqlTypes** de um aplicativo personalizado que tem como alvo o .net 3,5, 4 ou 4,5, o aplicativo falhará, pois o SqlClient por Design carrega a versão 10,0 do assembly.</span><span class="sxs-lookup"><span data-stu-id="034be-243">When you reference the **SqlTypes** assembly version 11.0 from a custom application that targets .NET 3.5, 4, or 4.5, the application will fail because SqlClient by design loads version 10.0 of the assembly.</span></span> <span data-ttu-id="034be-244">Essa falha ocorre quando o aplicativo chama um dos seguintes métodos:</span><span class="sxs-lookup"><span data-stu-id="034be-244">This failure occurs when the application calls one of the following methods:</span></span>  
  
    -   <span data-ttu-id="034be-245">O método `GetValue` da classe `SqlDataReader`</span><span class="sxs-lookup"><span data-stu-id="034be-245">`GetValue` method of the `SqlDataReader` class</span></span>  
  
    -   <span data-ttu-id="034be-246">O método `GetValues` da classe `SqlDataReader`</span><span class="sxs-lookup"><span data-stu-id="034be-246">`GetValues` method of the `SqlDataReader` class</span></span>  
  
    -   <span data-ttu-id="034be-247">operador de índice de colchete [] da classe `SqlDataReader`</span><span class="sxs-lookup"><span data-stu-id="034be-247">bracket index operator [] of the `SqlDataReader` class</span></span>  
  
    -   <span data-ttu-id="034be-248">O método `ExecuteScalar` da classe `SqlCommand`</span><span class="sxs-lookup"><span data-stu-id="034be-248">`ExecuteScalar` method of the `SqlCommand` class</span></span>  
  
 <span data-ttu-id="034be-249">Você pode contornar esse problema usando um dos seguintes métodos:</span><span class="sxs-lookup"><span data-stu-id="034be-249">You can work around this issue by using one of the following methods:</span></span>  
  
-   <span data-ttu-id="034be-250">Você pode contornar esse problema no seu código chamando o método `GetSqlBytes`, em vez dos métodos Get listados acima, para recuperar tipos de sistema CLR do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], conforme mostrado no exemplo a seguir:</span><span class="sxs-lookup"><span data-stu-id="034be-250">You can work around this issue in your code by calling the `GetSqlBytes` method, instead of the Get methods listed above, to retrieve CLR [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] system types, as shown in the following example:</span></span>  
  
    ```csharp  
    string query = "SELECT [SpatialColumn] FROM [SpatialTable]";  
          using (SqlConnection conn = new SqlConnection("..."))  
          {  
                SqlCommand cmd = new SqlCommand(query, conn);  
  
                conn.Open();  
                SqlDataReader reader = cmd.ExecuteReader();  
  
                while (reader.Read())  
                {  
                      // In version 11.0 only  
                      SqlGeometry g =   
    SqlGeometry.Deserialize(reader.GetSqlBytes(0));  
  
                      // In version 10.0 or 11.0  
                      SqlGeometry g2 = new SqlGeometry();  
                      g.Read(new BinaryReader(reader.GetSqlBytes(0).Stream));  
                }  
          }  
    ```  
  
-   <span data-ttu-id="034be-251">Você pode contornar esse problema usando redirecionamento de assembly no arquivo de configuração de aplicativo, conforme mostrado no seguinte exemplo:</span><span class="sxs-lookup"><span data-stu-id="034be-251">You can work around this issue by using assembly redirection in the application configuration file, as shown in the following example:</span></span>  
  
    ```xml  
    <runtime>  
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">  
        ...  
        <dependentAssembly>  
            <assemblyIdentity name="Microsoft.SqlServer.Types" publicKeyToken="89845dcd8080cc91" culture="neutral" />  
            <bindingRedirect oldVersion="10.0.0.0" newVersion="11.0.0.0" />  
        </dependentAssembly>  
        ...  
    </assemblyBinding>  
    <runtime>  
    ```  
  
-   <span data-ttu-id="034be-252">Você pode contornar esse problema na sua cadeia de conexão especificando um valor "SQL Server 2012" para o atributo "Type System Version" para forçar o SqlClient a carregar a versão 11.0 do assembly.</span><span class="sxs-lookup"><span data-stu-id="034be-252">You can work around this issue in your connection string by specifying a value of "SQL Server 2012" for the "Type System Version" attribute to force SqlClient to load version 11.0 of the assembly.</span></span> <span data-ttu-id="034be-253">Esse atributo de cadeia de conexão está disponível apenas no .NET 4.5 e versões superiores.</span><span class="sxs-lookup"><span data-stu-id="034be-253">This connection string attribute is available only in .NET 4.5 and above.</span></span>  
  
-   <span data-ttu-id="034be-254">A marca `assemblyBinding` deve ser encapsulada na marca `runtime`.</span><span class="sxs-lookup"><span data-stu-id="034be-254">The `assemblyBinding` tag should be wrapped under the `runtime` tag.</span></span>  
  
### <a name="support-for-awe"></a><span data-ttu-id="034be-255">Suporte para AWE</span><span class="sxs-lookup"><span data-stu-id="034be-255">Support for AWE</span></span>  
 <span data-ttu-id="034be-256">O suporte ao recurso AWE (Address Windowing Extensions) de 32 bits foi descontinuado.</span><span class="sxs-lookup"><span data-stu-id="034be-256">32-bit Address Windowing Extensions (AWE) support is discontinued.</span></span> <span data-ttu-id="034be-257">Isso poderá resultar em desempenho mais lento em sistemas operacionais de 32 bits.</span><span class="sxs-lookup"><span data-stu-id="034be-257">This might result in slower performance on 32-bit operating systems.</span></span> <span data-ttu-id="034be-258">Para instalações que usam quantidades de memória grandes, migre para um sistema operacional de 64 bits.</span><span class="sxs-lookup"><span data-stu-id="034be-258">For installations using large amounts of memory, migrate to a 64-bit operating system.</span></span>  
  
### <a name="xquery-functions-are-surrogate-aware"></a><span data-ttu-id="034be-259">As funções XQuery reconhecem substituições</span><span class="sxs-lookup"><span data-stu-id="034be-259">XQuery Functions Are Surrogate-Aware</span></span>  
 <span data-ttu-id="034be-260">A recomendação W3C para funções e operadores XQuery requer que eles considerem um par substituto que representa um caractere Unicode no intervalo alto como um glifo único na codificação UTF-16.</span><span class="sxs-lookup"><span data-stu-id="034be-260">The W3C recommendation for XQuery functions and operators requires them to count a surrogate pair that represents a high-range Unicode character as a single glyph in UTF-16 encoding.</span></span> <span data-ttu-id="034be-261">No entanto, nas versões do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] anteriores ao [!INCLUDE[ssSQL11](../includes/sssql11-md.md)], as funções de cadeia de caracteres não reconheciam pares substitutos como um caracteres único.</span><span class="sxs-lookup"><span data-stu-id="034be-261">However, in versions of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] prior to [!INCLUDE[ssSQL11](../includes/sssql11-md.md)], string functions did not recognize surrogate pairs as a single character.</span></span> <span data-ttu-id="034be-262">Algumas operações de cadeia de caracteres, como cálculos de comprimento de cadeia de caracteres e extrações de subcadeias, retornaram resultados incorretos.</span><span class="sxs-lookup"><span data-stu-id="034be-262">Some string operations - such as string length calculations and substring extractions - returned incorrect results.</span></span> <span data-ttu-id="034be-263">Agora, o [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] oferece suporte para UTF-16 e para a manipulação correta de pares substitutos.</span><span class="sxs-lookup"><span data-stu-id="034be-263">[!INCLUDE[ssSQL11](../includes/sssql11-md.md)] now fully supports UTF-16 and the correct handling of surrogate pairs.</span></span>  
  
 <span data-ttu-id="034be-264">O tipo de dados XML no [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] permite apenas pares substitutos bem formados.</span><span class="sxs-lookup"><span data-stu-id="034be-264">The XML data type in [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] only allows well-formed surrogate pairs.</span></span> <span data-ttu-id="034be-265">No entanto, algumas funções ainda podem retornar resultados indefinidos ou inesperados em certas circunstâncias, pois é possível passar pares substitutos inválidos ou parciais para funções XQuery como valores de cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="034be-265">However, some functions can still return undefined or unexpected results in certain circumstances, since it is possible to pass invalid or partial surrogate pairs to XQuery functions as string values.</span></span> <span data-ttu-id="034be-266">Considere os seguintes métodos para gerar valores da cadeia de caracteres ao usar XQuery no [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]:</span><span class="sxs-lookup"><span data-stu-id="034be-266">Consider the following methods for generating string values when using XQuery in [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]:</span></span>  
  
-   <span data-ttu-id="034be-267">Forneça um valor da cadeia de caracteres constante como um valor binário.</span><span class="sxs-lookup"><span data-stu-id="034be-267">Provide a constant string value as a binary value.</span></span> <span data-ttu-id="034be-268">Durante o uso desse método, continua sendo possível passar pares substitutos inválidos ou parciais.</span><span class="sxs-lookup"><span data-stu-id="034be-268">When using this method, it remains possible to pass invalid or partial surrogate pairs.</span></span>  
  
-   <span data-ttu-id="034be-269">Forneça um valor da cadeia de caracteres constante fornecendo entidades de caractere.</span><span class="sxs-lookup"><span data-stu-id="034be-269">Provide a constant string value by providing character entities.</span></span> <span data-ttu-id="034be-270">Durante o uso desse método, não é possível passar pares substitutos inválidos ou parciais.</span><span class="sxs-lookup"><span data-stu-id="034be-270">When using this method, it is not possible to pass invalid surrogate pairs.</span></span> <span data-ttu-id="034be-271">As funções XQuery requerem uma entidade de caractere único para o caracteres de alto nível.</span><span class="sxs-lookup"><span data-stu-id="034be-271">The XQuery functions require a single character entity for the high-level character.</span></span> <span data-ttu-id="034be-272">Essas funções gerarão um erro se as entidades de caracteres para os caracteres de pares substitutos forem fornecidas.</span><span class="sxs-lookup"><span data-stu-id="034be-272">These functions raise an error if the character entities for the surrogate pair characters are provided.</span></span>  
  
-   <span data-ttu-id="034be-273">Importe valores externos usando **SQL: column** ou **SQL: variable**.</span><span class="sxs-lookup"><span data-stu-id="034be-273">Import external values by using **sql:column** or **sql:variable**.</span></span> <span data-ttu-id="034be-274">Durante o uso desses métodos, continua sendo possível introduzir pares substitutos inválidos ou parciais.</span><span class="sxs-lookup"><span data-stu-id="034be-274">When using these methods, it remains possible to introduce invalid or partial surrogate pairs.</span></span>  
  
#### <a name="affected-xquery-functions-and-operators"></a><span data-ttu-id="034be-275">Funções e operadores XQuery afetados</span><span class="sxs-lookup"><span data-stu-id="034be-275">Affected XQuery Functions and Operators</span></span>  
 <span data-ttu-id="034be-276">Agora, as seguintes funções e operadores XQuery manipulam pares substitutos UTF-16 corretamente no [!INCLUDE[ssSQL11](../includes/sssql11-md.md)]:</span><span class="sxs-lookup"><span data-stu-id="034be-276">The following XQuery functions and operators now handle UTF-16 surrogate pairs correctly in [!INCLUDE[ssSQL11](../includes/sssql11-md.md)]:</span></span>  
  
-   <span data-ttu-id="034be-277">**fn: cadeia de caracteres-comprimento**.</span><span class="sxs-lookup"><span data-stu-id="034be-277">**fn:string-length**.</span></span> <span data-ttu-id="034be-278">No entanto, se um par substituto inválido ou parcial for passado como um argumento, o comportamento do **comprimento da cadeia de caracteres** será indefinido.</span><span class="sxs-lookup"><span data-stu-id="034be-278">However, if an invalid or partial surrogate pair is passed as an argument, the behavior of **string-length** is undefined.</span></span>  
  
-   <span data-ttu-id="034be-279">**fn: substring**.</span><span class="sxs-lookup"><span data-stu-id="034be-279">**fn:substring**.</span></span>  
  
-   <span data-ttu-id="034be-280">**fn: contém**.</span><span class="sxs-lookup"><span data-stu-id="034be-280">**fn:contains**.</span></span> <span data-ttu-id="034be-281">No entanto, se um par de substituto parcial for passado como um valor, **Contains** poderá retornar resultados inesperados, já que ele poderá encontrar o par substituto parcial contido no par substituto bem formado.</span><span class="sxs-lookup"><span data-stu-id="034be-281">However, if a partial surrogate pair is passed as a value, **contains** may return unexpected results, since it may find the partial surrogate pair contained in well-formed surrogate pair.</span></span>  
  
-   <span data-ttu-id="034be-282">**fn: Concat**.</span><span class="sxs-lookup"><span data-stu-id="034be-282">**fn:concat**.</span></span> <span data-ttu-id="034be-283">No entanto, se um par de substituto parcial for passado como um valor, **concat** poderá produzir pares substitutos incorretos ou pares de substitutos parciais.</span><span class="sxs-lookup"><span data-stu-id="034be-283">However, if a partial surrogate pair is passed as a value, **concat** can produce incorrect surrogate pairs or partial surrogate pairs.</span></span>  
  
-   <span data-ttu-id="034be-284">Operadores de comparação e a cláusula **order by** .</span><span class="sxs-lookup"><span data-stu-id="034be-284">Comparison operators and the **order by** clause.</span></span> <span data-ttu-id="034be-285">Os operadores de comparação incluem +, \<, > , \<=, > =,,,, `eq` `lt` `gt` `le` e `ge` .</span><span class="sxs-lookup"><span data-stu-id="034be-285">Comparison operators include +, \<, >, \<=, >=, `eq`, `lt`, `gt`, `le`, and `ge`.</span></span>  
  
#### <a name="distributed-query-calls-to-a-system-procedure"></a><span data-ttu-id="034be-286">Chamadas de consulta distribuída a um procedimento de sistema</span><span class="sxs-lookup"><span data-stu-id="034be-286">Distributed Query Calls to a System Procedure</span></span>  
 <span data-ttu-id="034be-287">Chamadas de consulta distribuída por `OPENQUERY` para alguns procedimentos de sistema que falharão quando chamadas de um servidor [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] para outro.</span><span class="sxs-lookup"><span data-stu-id="034be-287">Distributed query calls through `OPENQUERY` to some system procedures will fail when called from one [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] server to another.</span></span> <span data-ttu-id="034be-288">Isto ocorre quando o [!INCLUDE[ssDE](../includes/ssde-md.md)] não pode descobrir metadados para um procedimento.</span><span class="sxs-lookup"><span data-stu-id="034be-288">This occurs when the [!INCLUDE[ssDE](../includes/ssde-md.md)] cannot discovery metadata for a procedure.</span></span> <span data-ttu-id="034be-289">Por exemplo, `SELECT * FROM OPENQUERY(..., 'EXEC xp_loginfo')`.</span><span class="sxs-lookup"><span data-stu-id="034be-289">For example, `SELECT * FROM OPENQUERY(..., 'EXEC xp_loginfo')`.</span></span>  
  
#### <a name="isolation-level-and-sp_reset_connection"></a><span data-ttu-id="034be-290">nível de isolamento e sp_reset_connection</span><span class="sxs-lookup"><span data-stu-id="034be-290">Isolation Level and sp_reset_connection</span></span>  
 <span data-ttu-id="034be-291">O nível de isolamento para conexões é tratado da seguinte maneira pelos drivers de cliente:</span><span class="sxs-lookup"><span data-stu-id="034be-291">The isolation level for connections is handled in the following way by client drivers:</span></span>  
  
-   <span data-ttu-id="034be-292">Todos os drivers nativos (SNAC, MDAC, ODBC) definem o nível de isolamento (com base na configuração de aplicativo) ao sp_reset_connection.</span><span class="sxs-lookup"><span data-stu-id="034be-292">All of the native drivers (SNAC, MDAC, ODBC) set the isolation level (based on app setting) upon sp_reset_connection.</span></span>  
  
-   <span data-ttu-id="034be-293">Para ADO.NET, você basicamente terá um nível de isolamento aleatório, dependendo da conexão que você obtém do pool (e se o aplicativo usa o nível de isolamento diferente).</span><span class="sxs-lookup"><span data-stu-id="034be-293">For ADO.NET you will essentially get a random isolation level depending on which connection you get from the pool (and if the application uses different isolation level).</span></span> <span data-ttu-id="034be-294">Como o pool ADO.NET pode reciclar conexões internamente e de forma transparente, você não poderá prever o que ocorrerá fora do pool.</span><span class="sxs-lookup"><span data-stu-id="034be-294">Since ADO.NET pool can recycle connections internally and transparently, you cannot predict what will come out of the pool.</span></span>  
  
-   <span data-ttu-id="034be-295">Para o driver JDBC, você obtém o mesmo comportamento que o ADO.NET</span><span class="sxs-lookup"><span data-stu-id="034be-295">For the JDBC driver you get same behavior as ADO.NET</span></span>  
  
     <span data-ttu-id="034be-296">O aplicativo deve sempre definir o nível de isolamento explicitamente depois de abrir a conexão para obter o que ele deseja.</span><span class="sxs-lookup"><span data-stu-id="034be-296">The application must always explicitly set isolation level after opening the connection to get what it wants.</span></span>  
  
     <span data-ttu-id="034be-297">A conexão JDBC pode ser agrupada para que o aplicativo possa obter um nível de isolamento aleatório e não souber sobre ele.</span><span class="sxs-lookup"><span data-stu-id="034be-297">The JDBC connection can be pooled, so the application may get a random isolation level and not know about it.</span></span>  
  
 <span data-ttu-id="034be-298">Para preservar a compatibilidade com versões anteriores, esse novo comportamento se aplica somente a clientes recentes começando com TDS 7.4.</span><span class="sxs-lookup"><span data-stu-id="034be-298">To preserve backward compatibility this new behavior only applies for recent clients beginning with TDS 7.4.</span></span>  
  
#### <a name="backward-compatibility"></a><span data-ttu-id="034be-299">Backward Compatibility</span><span class="sxs-lookup"><span data-stu-id="034be-299">Backward Compatibility</span></span>  
 <span data-ttu-id="034be-300">**O novo comportamento depende do nível de compatibilidade**</span><span class="sxs-lookup"><span data-stu-id="034be-300">**New behavior depends on compatibility level**</span></span>  
  
 <span data-ttu-id="034be-301">As seguintes funções e operadores demonstram o novo comportamento descrito acima somente quando o nível de compatibilidade é 110 ou superior:</span><span class="sxs-lookup"><span data-stu-id="034be-301">The following functions and operators demonstrate the new behavior described above only when the compatibility level is 110 or higher:</span></span>  
  
-   <span data-ttu-id="034be-302">**fn: contém**.</span><span class="sxs-lookup"><span data-stu-id="034be-302">**fn:contains**.</span></span>  
  
-   <span data-ttu-id="034be-303">**fn: Concat**.</span><span class="sxs-lookup"><span data-stu-id="034be-303">**fn:concat**.</span></span>  
  
-   <span data-ttu-id="034be-304">operadores de comparação e cláusula **order by**</span><span class="sxs-lookup"><span data-stu-id="034be-304">comparison operators and **order by** clause</span></span>  
  
 <span data-ttu-id="034be-305">**O novo comportamento depende do URI de namespace padrão para funções**</span><span class="sxs-lookup"><span data-stu-id="034be-305">**New behavior depends on default namespace URI for functions**</span></span>  
  
 <span data-ttu-id="034be-306">As funções a seguir demonstram o novo comportamento descrito acima somente quando o URI do namespace padrão corresponde ao namespace na recomendação final, ou seja, [http://www.w3.org/2005/xpath-functions](http://www.w3.org/2005/xpath-functions) .</span><span class="sxs-lookup"><span data-stu-id="034be-306">The following functions demonstrate the new behavior described above only when the default namespace URI corresponds to the namespace in the final recommendation, that is, [http://www.w3.org/2005/xpath-functions](http://www.w3.org/2005/xpath-functions).</span></span> <span data-ttu-id="034be-307">Quando o nível de compatibilidade é 110 ou superior, por padrão, o [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] associa o namespace da função padrão a esse namespace.</span><span class="sxs-lookup"><span data-stu-id="034be-307">When the compatibility level is 110 or higher, then by default [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] binds the default function namespace to this namespace.</span></span> <span data-ttu-id="034be-308">No entanto, essas funções demonstram o novo comportamento quando esse namespace é usado, independentemente do nível de compatibilidade.</span><span class="sxs-lookup"><span data-stu-id="034be-308">However these functions demonstrate the new behavior when this namespace is used regardless of the compatibility level.</span></span>  
  
-   <span data-ttu-id="034be-309">**fn:string-length**</span><span class="sxs-lookup"><span data-stu-id="034be-309">**fn:string-length**</span></span>  
  
-   <span data-ttu-id="034be-310">**fn:substring**</span><span class="sxs-lookup"><span data-stu-id="034be-310">**fn:substring**</span></span>  
  
##  <a name="breaking-changes-in-sql-server-2008sql-server-2008r2"></a><a name="KJKatmai"></a><span data-ttu-id="034be-311">Alterações recentes no SQL Server 2008/SQL Server 2008R2</span><span class="sxs-lookup"><span data-stu-id="034be-311">Breaking Changes in SQL Server 2008/SQL Server 2008R2</span></span>  
 <span data-ttu-id="034be-312">Esta seção contém as últimas alterações introduzidas no [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)].</span><span class="sxs-lookup"><span data-stu-id="034be-312">This section contains the breaking changes introduced in [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)].</span></span> <span data-ttu-id="034be-313">Nenhuma alteração foi introduzida no [!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)].</span><span class="sxs-lookup"><span data-stu-id="034be-313">No changes were introduced in [!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)].</span></span>  
  
### <a name="collations"></a><span data-ttu-id="034be-314">Ordenações</span><span class="sxs-lookup"><span data-stu-id="034be-314">Collations</span></span>  
  
|<span data-ttu-id="034be-315">Recurso</span><span class="sxs-lookup"><span data-stu-id="034be-315">Feature</span></span>|<span data-ttu-id="034be-316">Descrição</span><span class="sxs-lookup"><span data-stu-id="034be-316">Description</span></span>|  
|-------------|-----------------|  
|<span data-ttu-id="034be-317">Novas ordenações</span><span class="sxs-lookup"><span data-stu-id="034be-317">New collations</span></span>|<span data-ttu-id="034be-318">O [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)] introduz novas ordenações totalmente alinhadas às ordenações fornecidas pelo Windows Server 2008.</span><span class="sxs-lookup"><span data-stu-id="034be-318">[!INCLUDE[ssKatmai](../includes/sskatmai-md.md)] introduces new collations that are in full alignment with the collations provided by Windows Server 2008.</span></span> <span data-ttu-id="034be-319">Essas 80 novas ordenações melhoraram a exatidão linguística e foram indicadas por referências à versão \*_100.</span><span class="sxs-lookup"><span data-stu-id="034be-319">These 80 new collations have improved linguistic accuracy and are denoted by \*_100 version references.</span></span> <span data-ttu-id="034be-320">Se você escolher uma ordenação nova para o servidor ou para o banco de dados, lembre-se de que a ordenação pode não ser reconhecida pelos clientes com drivers de clientes mais antigos.</span><span class="sxs-lookup"><span data-stu-id="034be-320">If you choose a new collation for your server or database, be aware that the collation may not be recognized by clients with older client drivers.</span></span> <span data-ttu-id="034be-321">Ordenações não reconhecidas podem fazer com que o aplicativo retorne erros e apresente falhas.</span><span class="sxs-lookup"><span data-stu-id="034be-321">Unrecognized collations can cause the application to return errors and fail.</span></span> <span data-ttu-id="034be-322">Considere as seguintes soluções:</span><span class="sxs-lookup"><span data-stu-id="034be-322">Consider the following solutions:</span></span><br /><br /> <span data-ttu-id="034be-323">Atualize o sistema operacional do cliente para que as ordenações de sistemas subjacentes sejam atualizadas.</span><span class="sxs-lookup"><span data-stu-id="034be-323">Upgrade the client operating system so that the underlying system collations are updated.</span></span><br /><br /> <span data-ttu-id="034be-324">Se houver um software cliente do banco de dados instalado no cliente, considere a possibilidade de aplicar uma atualização de serviço ao software cliente do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="034be-324">If your client has database client software installed, consider applying a service update to the database client software.</span></span><br /><br /> <span data-ttu-id="034be-325">Escolha uma ordenação existente, mapeada para uma página de código no cliente.</span><span class="sxs-lookup"><span data-stu-id="034be-325">Choose an existing collation that maps to a code page on the client.</span></span>|  
  
### <a name="common-language-runtime-clr"></a><span data-ttu-id="034be-326">CLR (Common Language Runtime)</span><span class="sxs-lookup"><span data-stu-id="034be-326">Common Language Runtime (CLR)</span></span>  
  
|<span data-ttu-id="034be-327">Recurso</span><span class="sxs-lookup"><span data-stu-id="034be-327">Feature</span></span>|<span data-ttu-id="034be-328">Descrição</span><span class="sxs-lookup"><span data-stu-id="034be-328">Description</span></span>|  
|-------------|-----------------|  
|<span data-ttu-id="034be-329">Assemblies CLR</span><span class="sxs-lookup"><span data-stu-id="034be-329">CLR Assemblies</span></span>|<span data-ttu-id="034be-330">Quando um banco de dados é atualizado para [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)], o assembly do `Microsoft.SqlServer.Types` para dar suporte a novos tipos de dados é instalado automaticamente.</span><span class="sxs-lookup"><span data-stu-id="034be-330">When a database is upgraded to [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)], the `Microsoft.SqlServer.Types` assembly to support new data types is automatically installed.</span></span> <span data-ttu-id="034be-331">As regras do Supervisor de Atualização detectam qualquer tipo de usuário ou assemblies de usuário com nomes conflitantes.</span><span class="sxs-lookup"><span data-stu-id="034be-331">Upgrade Advisor rules detect any user type or assemblies with conflicting names.</span></span> <span data-ttu-id="034be-332">O Supervisor de Atualização aconselhará renomear qualquer assembly em conflito, bem como qualquer tipo em conflito, ou usar nomes de duas partes no código para fazer referência a esse tipo de usuário preexistente.</span><span class="sxs-lookup"><span data-stu-id="034be-332">The Upgrade Advisor will advise renaming of any conflicting assembly, and either renaming any conflicting type, or using two-part names in the code to refer to that preexisting user type.</span></span><br /><br /> <span data-ttu-id="034be-333">Se uma atualização de banco de dados detectar um assembly de usuário com um nome conflitante, ele o renomeará automaticamente e o colocará no banco de dados em modo de suspeição.</span><span class="sxs-lookup"><span data-stu-id="034be-333">If a database upgrade detects a user assembly with a conflicting name, it will automatically rename that assembly and put the database into suspect mode.</span></span><br /><br /> <span data-ttu-id="034be-334">Se um tipo de usuário com nome conflitante existir durante a atualização, nenhuma etapa especial será efetuada.</span><span class="sxs-lookup"><span data-stu-id="034be-334">If a user type with conflicting name exists during the upgrade, no special steps are taken.</span></span> <span data-ttu-id="034be-335">Depois da atualização, existirão ambos os tipos de usuário, antigo e novo.</span><span class="sxs-lookup"><span data-stu-id="034be-335">After the upgrade, both the old user type, and the new system type, will exist.</span></span> <span data-ttu-id="034be-336">O tipo de usuário só estará disponível através de nomes de duas partes.</span><span class="sxs-lookup"><span data-stu-id="034be-336">The user type will be available only through two-part names.</span></span>|  
|<span data-ttu-id="034be-337">Assemblies CLR</span><span class="sxs-lookup"><span data-stu-id="034be-337">CLR Assemblies</span></span>|<span data-ttu-id="034be-338">O [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)] instala o .NET Framework 3.5 SP1, que atualiza bibliotecas no GAC (cache de assembly global).</span><span class="sxs-lookup"><span data-stu-id="034be-338">[!INCLUDE[ssKatmai](../includes/sskatmai-md.md)] installs .NET Framework 3.5 SP1, which updates libraries in the Global Assembly Cache (GAC).</span></span> <span data-ttu-id="034be-339">Se você tiver bibliotecas sem-suporte registradas em um banco de dados do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], o aplicativo do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] poderá parar de funcionar após a atualização para o [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)].</span><span class="sxs-lookup"><span data-stu-id="034be-339">If you have unsupported libraries registered in a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] database, your [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] application may stop working after upgrading to [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)].</span></span> <span data-ttu-id="034be-340">Isso ocorre porque o serviço de reparo ou a atualização de bibliotecas no GAC não atualiza os assemblies dentro do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="034be-340">This is because servicing or upgrading libraries in the GAC does not update assemblies inside [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="034be-341">Se um assembly existir tanto em um banco de dados do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] como no GAC, as duas cópias do assembly deverão ser exatamente iguais.</span><span class="sxs-lookup"><span data-stu-id="034be-341">If an assembly exists both in a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] database and in the GAC, the two copies of the assembly must exactly match.</span></span> <span data-ttu-id="034be-342">Caso isso não aconteça, ocorrerá um erro quando o assembly for usado pela integração CLR do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="034be-342">If they do not match, an error will occur when the assembly is used by [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] CLR integration.</span></span> <span data-ttu-id="034be-343">Para obter mais informações, consulte [bibliotecas de .NET Framework com suporte](../relational-databases/clr-integration/database-objects/supported-net-framework-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="034be-343">For more information, see [Supported .NET Framework Libraries](../relational-databases/clr-integration/database-objects/supported-net-framework-libraries.md).</span></span><br /><br /> <span data-ttu-id="034be-344">Depois de atualizar o banco de dados, mantenha ou atualize a cópia do assembly dentro dos bancos de dados do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] com a instrução ALTER ASSEMBLY.</span><span class="sxs-lookup"><span data-stu-id="034be-344">After upgrading your database, service or upgrade the copy of the assembly inside your [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] databases with the ALTER ASSEMBLY statement.</span></span> <span data-ttu-id="034be-345">Para obter mais informações, consulte o [artigo 949080 da base de dados de conhecimento](https://go.microsoft.com/fwlink/?LinkId=154563).</span><span class="sxs-lookup"><span data-stu-id="034be-345">For more information, see [Knowledge Base article 949080](https://go.microsoft.com/fwlink/?LinkId=154563).</span></span><br /><br /> <span data-ttu-id="034be-346">Para detectar se você está usando uma biblioteca do .NET Framework sem-suporte no aplicativo, execute a seguinte consulta no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="034be-346">To detect whether you are using any unsupported .NET framework library in your application, run the following query in your database.</span></span><br /><br /> `SELECT name FROM sys.assemblies WHERE clr_name LIKE '%publickeytoken=b03f5f7f11d50a3a,%';`|  
|<span data-ttu-id="034be-347">Rotinas CLR</span><span class="sxs-lookup"><span data-stu-id="034be-347">CLR Routines</span></span>|<span data-ttu-id="034be-348">O uso da representação dentro de funções CLR definidas pelo usuário, de agregações definidas pelo usuário ou de UDTs (tipos definidos pelo usuário) pode causar o erro 6522 no aplicativo após a atualização para o [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)].</span><span class="sxs-lookup"><span data-stu-id="034be-348">Using impersonation inside CLR user-defined functions, user-defined aggregates, or user-defined types (UDTs) may cause your application to fail with error 6522 after upgrading to [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)].</span></span> <span data-ttu-id="034be-349">Os cenários a seguir são executados com êxito no [!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)], mas falham no [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)].</span><span class="sxs-lookup"><span data-stu-id="034be-349">The following scenarios succeed in [!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)] but fail in [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)].</span></span> <span data-ttu-id="034be-350">São apresentadas resoluções para cada cenário.</span><span class="sxs-lookup"><span data-stu-id="034be-350">Resolutions are provided for each scenario.</span></span><br /><br /> <span data-ttu-id="034be-351">Uma função CLR definida pelo usuário, uma agregação definida pelo usuário ou um método UDT que usa representação tem um parâmetro do tipo,,,,, `nvarchar(max)` `varchar(max)` `varbinary(max)` `ntext` `text` `image` ou um UDT grande, e não tem o atributo **DataAccessKind. Read** no método.</span><span class="sxs-lookup"><span data-stu-id="034be-351">A CLR user-defined function, user-defined aggregate, or UDT method that uses impersonation has a parameter of type `nvarchar(max)`, `varchar(max)`, `varbinary(max)`, `ntext`, `text`, `image`, or a large UDT, and does not have the **DataAccessKind.Read** attribute on the method.</span></span> <span data-ttu-id="034be-352">Para resolver esse problema, adicione o atributo **DataAccessKind. Read** no método, recompile o assembly e implante novamente a rotina e o assembly.</span><span class="sxs-lookup"><span data-stu-id="034be-352">To resolve this issue, add the **DataAccessKind.Read** attribute on the method, recompile the assembly, and re-deploy the routine and the assembly.</span></span><br /><br /> <span data-ttu-id="034be-353">Uma função de valor de tabela do CLR que tem um método **init** que executa a representação.</span><span class="sxs-lookup"><span data-stu-id="034be-353">A CLR table-valued function that has an **Init** method that performs impersonation.</span></span> <span data-ttu-id="034be-354">Para resolver esse problema, adicione o atributo **DataAccessKind. Read** no método, recompile o assembly e implante novamente a rotina e o assembly.</span><span class="sxs-lookup"><span data-stu-id="034be-354">To resolve this issue add the **DataAccessKind.Read** attribute on the method, recompile the assembly, and re-deploy the routine and the assembly.</span></span><br /><br /> <span data-ttu-id="034be-355">Uma função de valor de tabela do CLR que tem um método **FillRow** que executa a representação.</span><span class="sxs-lookup"><span data-stu-id="034be-355">A CLR table-valued function that has a **FillRow** method that performs impersonation.</span></span> <span data-ttu-id="034be-356">Para resolver esse problema, remova a representação do método **FillRow** .</span><span class="sxs-lookup"><span data-stu-id="034be-356">To resolve this issue, remove impersonation from the **FillRow** method.</span></span> <span data-ttu-id="034be-357">Não acesse recursos externos usando o método **FillRow** .</span><span class="sxs-lookup"><span data-stu-id="034be-357">Do not access external resources by using the **FillRow** method.</span></span> <span data-ttu-id="034be-358">Em vez disso, acesse recursos externos do método **init** .</span><span class="sxs-lookup"><span data-stu-id="034be-358">Instead, access external resources from the **Init** method.</span></span>|  
  
### <a name="dynamic-management-views"></a><span data-ttu-id="034be-359">Exibições de Gerenciamento Dinâmico</span><span class="sxs-lookup"><span data-stu-id="034be-359">Dynamic Management Views</span></span>  
  
|<span data-ttu-id="034be-360">Exibir</span><span class="sxs-lookup"><span data-stu-id="034be-360">View</span></span>|<span data-ttu-id="034be-361">Descrição</span><span class="sxs-lookup"><span data-stu-id="034be-361">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="034be-362">sys.dm_os_sys_info</span><span class="sxs-lookup"><span data-stu-id="034be-362">sys.dm_os_sys_info</span></span>|<span data-ttu-id="034be-363">Foram removidas as colunas cpu_ticks_in_ms e sqlserver_start_time_cpu_ticks.</span><span class="sxs-lookup"><span data-stu-id="034be-363">Removed the cpu_ticks_in_ms and sqlserver_start_time_cpu_ticks columns.</span></span>|  
|<span data-ttu-id="034be-364">sys. dm_exec_query_resource_semaphoressys. dm_exec_query_memory_grants</span><span class="sxs-lookup"><span data-stu-id="034be-364">sys.dm_exec_query_resource_semaphoressys.dm_exec_query_memory_grants</span></span>|<span data-ttu-id="034be-365">A coluna resource_semaphore_id não é uma ID exclusiva no [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)].</span><span class="sxs-lookup"><span data-stu-id="034be-365">The resource_semaphore_id column is not a unique ID in [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)].</span></span> <span data-ttu-id="034be-366">Essa alteração pode afetar a execução de consulta de solução de problemas.</span><span class="sxs-lookup"><span data-stu-id="034be-366">This change can affect troubleshooting query execution.</span></span> <span data-ttu-id="034be-367">Para obter mais informações, consulte [Sys. dm_exec_query_resource_semaphores &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-exec-query-resource-semaphores-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="034be-367">For more information, see [sys.dm_exec_query_resource_semaphores &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-exec-query-resource-semaphores-transact-sql).</span></span>|  
  
### <a name="errors-and-events"></a><span data-ttu-id="034be-368">Erros e eventos</span><span class="sxs-lookup"><span data-stu-id="034be-368">Errors and Events</span></span>  
  
|<span data-ttu-id="034be-369">Recurso</span><span class="sxs-lookup"><span data-stu-id="034be-369">Feature</span></span>|<span data-ttu-id="034be-370">Descrição</span><span class="sxs-lookup"><span data-stu-id="034be-370">Description</span></span>|  
|-------------|-----------------|  
|<span data-ttu-id="034be-371">Erros de logon</span><span class="sxs-lookup"><span data-stu-id="034be-371">Login errors</span></span>|<span data-ttu-id="034be-372">No [!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)], o erro 18452 é retornado quando um logon do SQL é usado para conexão a um servidor configurado para usar somente a Autenticação do Windows.</span><span class="sxs-lookup"><span data-stu-id="034be-372">In [!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)], error 18452 is returned when a SQL login is used to connect to a server configured to use only Windows Authentication.</span></span> <span data-ttu-id="034be-373">No [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)], o erro 18456 é retornado.</span><span class="sxs-lookup"><span data-stu-id="034be-373">In [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)], error 18456 is returned instead.</span></span>|  
  
### <a name="showplan"></a><span data-ttu-id="034be-374">Showplan</span><span class="sxs-lookup"><span data-stu-id="034be-374">Showplan</span></span>  
  
|<span data-ttu-id="034be-375">Recurso</span><span class="sxs-lookup"><span data-stu-id="034be-375">Feature</span></span>|<span data-ttu-id="034be-376">Descrição</span><span class="sxs-lookup"><span data-stu-id="034be-376">Description</span></span>|  
|-------------|-----------------|  
|<span data-ttu-id="034be-377">Esquema XML do plano de execução</span><span class="sxs-lookup"><span data-stu-id="034be-377">Showplan XML schema</span></span>|<span data-ttu-id="034be-378">Um novo elemento **SeekPredicateNew** é adicionado ao esquema XML Showplan e a sequência XSD de circunscrição (**SqlPredicatesType**) é convertida em um **\<xsd:choice>** Item.</span><span class="sxs-lookup"><span data-stu-id="034be-378">A new **SeekPredicateNew** element is added to the Showplan XML schema, and the enclosing xsd sequence (**SqlPredicatesType**) is converted into an **\<xsd:choice>** item.</span></span> <span data-ttu-id="034be-379">Em vez de um ou mais elementos **SeekPredicate** , um ou mais elementos **SeekPredicateNew** agora podem aparecer no XML Showplan.</span><span class="sxs-lookup"><span data-stu-id="034be-379">Instead of one or more **SeekPredicate** elements, one or more **SeekPredicateNew** elements may now appear in the Showplan XML.</span></span> <span data-ttu-id="034be-380">Os dois elementos são mutuamente exclusivos.</span><span class="sxs-lookup"><span data-stu-id="034be-380">The two elements are mutually exclusive.</span></span> <span data-ttu-id="034be-381">O **SeekPredicate** é mantido no esquema XML Showplan para compatibilidade com versões anteriores; no entanto, os planos de consulta criados no [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)] podem conter o elemento **SeekPredicateNew** .</span><span class="sxs-lookup"><span data-stu-id="034be-381">**SeekPredicate** is maintained in the Showplan XML schema for backwards compatibility; however, query plans created in [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)] may contain the **SeekPredicateNew** element.</span></span> <span data-ttu-id="034be-382">Os aplicativos que esperam recuperar somente o filho **SeekPredicate** do nó ShowplanXml/BatchSequence/batch/Statements/StmtSimple/QueryPlan/RelOp/IndexScan/SeekPredicates poderão falhar se o elemento **SeekPredicate** não existir.</span><span class="sxs-lookup"><span data-stu-id="034be-382">Applications that expect to retrieve only the **SeekPredicate** child from the node ShowPlanXML/BatchSequence/Batch/Statements/StmtSimple/QueryPlan/RelOp/IndexScan/SeekPredicates may fail if the **SeekPredicate** element does not exist.</span></span> <span data-ttu-id="034be-383">Reescreva o aplicativo para esperar o elemento **SeekPredicate** ou **SeekPredicateNew** neste nó.</span><span class="sxs-lookup"><span data-stu-id="034be-383">Rewrite the application to expect either the **SeekPredicate** or **SeekPredicateNew** element in this node.</span></span> <span data-ttu-id="034be-384">Para obter mais informações, consulte .</span><span class="sxs-lookup"><span data-stu-id="034be-384">For more information, see .</span></span>|  
|<span data-ttu-id="034be-385">Esquema XML do plano de execução</span><span class="sxs-lookup"><span data-stu-id="034be-385">Showplan XML schema</span></span>|<span data-ttu-id="034be-386">Um novo atributo **IndexKind** é adicionado ao tipo complexo **OBJECTTYPE** no esquema XML Showplan.</span><span class="sxs-lookup"><span data-stu-id="034be-386">A new **IndexKind** attribute is added to the **ObjectType** complex type in the Showplan XML schema.</span></span> <span data-ttu-id="034be-387">Haverá falha nos aplicativos que validam estritamente os planos do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] em relação ao esquema do [!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)].</span><span class="sxs-lookup"><span data-stu-id="034be-387">Applications that strictly validate [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] plans against the [!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)] schema will fail.</span></span>|  
  
### <a name="transact-sql"></a><span data-ttu-id="034be-388">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="034be-388">Transact-SQL</span></span>  
  
|<span data-ttu-id="034be-389">Recurso</span><span class="sxs-lookup"><span data-stu-id="034be-389">Feature</span></span>|<span data-ttu-id="034be-390">Descrição</span><span class="sxs-lookup"><span data-stu-id="034be-390">Description</span></span>|  
|-------------|-----------------|  
|<span data-ttu-id="034be-391">Evento DDL ALTER_AUTHORIZATION_DATABASE</span><span class="sxs-lookup"><span data-stu-id="034be-391">ALTER_AUTHORIZATION_DATABASE DDL event</span></span>|<span data-ttu-id="034be-392">No [!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)] , quando o evento DDL ALTER_AUTHORIZATION_DATABASE é acionado, o valor ' Object ' é retornado no elemento **objecttype** do XML EventData para esse evento quando o tipo de entidade do PROTEGÍVEL na operação DDL (linguagem de definição de dados) é um objeto.</span><span class="sxs-lookup"><span data-stu-id="034be-392">In [!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)], when the DDL event ALTER_AUTHORIZATION_DATABASE fires, the value 'object' is returned in the **ObjectType** element of the EVENTDATA xml for this event when the entity type of the securable in the data definition language (DDL) operation is an object.</span></span> <span data-ttu-id="034be-393">No [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)], o tipo real (por exemplo, 'table' ou 'function') é retornado.</span><span class="sxs-lookup"><span data-stu-id="034be-393">In [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)], the actual type (for example, 'table', or 'function') is returned.</span></span>|  
|<span data-ttu-id="034be-394">CONVERT</span><span class="sxs-lookup"><span data-stu-id="034be-394">CONVERT</span></span>|<span data-ttu-id="034be-395">Se um estilo inválido for passado para a função CONVERT, será retornado um erro quando o tipo de conversão for de binário em caractere ou de caractere em binário.</span><span class="sxs-lookup"><span data-stu-id="034be-395">If an invalid style is passed to the CONVERT function, an error is returned when the type of conversion is binary to character or character to binary.</span></span> <span data-ttu-id="034be-396">Em versões anteriores do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], o estilo inválido era definido como o estilo padrão para conversões de binário em caractere e de caractere em binário.</span><span class="sxs-lookup"><span data-stu-id="034be-396">In earlier versions of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], the invalid style is set to the default style for binary-to-character and character-to-binary conversions.</span></span>|  
|<span data-ttu-id="034be-397">GRANT/DENY/REVOKE EXECUTE em assemblies</span><span class="sxs-lookup"><span data-stu-id="034be-397">GRANT/DENY/REVOKE EXECUTE on assemblies</span></span>|<span data-ttu-id="034be-398">A permissão EXECUTE não pode ser concedida, negada ou revogada para assemblies.</span><span class="sxs-lookup"><span data-stu-id="034be-398">EXECUTE permission cannot be granted, denied, or revoked to assemblies.</span></span> <span data-ttu-id="034be-399">Essa permissão não tem nenhum efeito e agora provoca um erro.</span><span class="sxs-lookup"><span data-stu-id="034be-399">This permission has no affect and now causes an error.</span></span> <span data-ttu-id="034be-400">Em vez disso, conceda, negue ou revogue a permissão EXECUTE nos procedimentos armazenados ou nas funções que fazem referência ao método de assembly.</span><span class="sxs-lookup"><span data-stu-id="034be-400">Grant, deny, or revoke EXECUTE permission on the stored procedures or functions that reference the assembly method instead.</span></span>|  
|<span data-ttu-id="034be-401">Permissões GRANT/DENY/REVOKE em tipos de sistema</span><span class="sxs-lookup"><span data-stu-id="034be-401">GRANT/DENY/REVOKE permissions on system types</span></span>|<span data-ttu-id="034be-402">As permissões não podem ser concedidas, negadas ou revogadas para tipos de sistema.</span><span class="sxs-lookup"><span data-stu-id="034be-402">Permissions cannot be granted, denied, or revoked to system types.</span></span> <span data-ttu-id="034be-403">Em versões anteriores do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], essas instruções tinham êxito, mas não tinham nenhum efeito.</span><span class="sxs-lookup"><span data-stu-id="034be-403">In earlier versions of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], these statements succeed but have no effect.</span></span> <span data-ttu-id="034be-404">No [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)], um erro é retornado.</span><span class="sxs-lookup"><span data-stu-id="034be-404">In [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)], an error is returned.</span></span>|  
|<span data-ttu-id="034be-405">GROUP BY</span><span class="sxs-lookup"><span data-stu-id="034be-405">GROUP BY</span></span>|<span data-ttu-id="034be-406">A cláusula GROUP BY não pode conter uma subconsulta em uma expressão que é usada pela lista group by.</span><span class="sxs-lookup"><span data-stu-id="034be-406">The GROUP BY clause cannot contain a subquery in an expression that is used for the group by list.</span></span> <span data-ttu-id="034be-407">Em versões anteriores do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], isso era permitido.</span><span class="sxs-lookup"><span data-stu-id="034be-407">In earlier versions of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], this was allowed.</span></span> <span data-ttu-id="034be-408">No [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)], o erro 144 é retornado.</span><span class="sxs-lookup"><span data-stu-id="034be-408">In [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)], error 144 is returned.</span></span><br /><br /> <span data-ttu-id="034be-409">Por exemplo, o código a seguir terá êxito no SQL Server 2005 e falhará no SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="034be-409">For example, the following code will succeed in SQL Server 2005 and fail in SQL Server 2008.</span></span><br /><br /> `DECLARE @Test TABLE(a int NOT NULL);` <br /> `INSERT INTO @Test SELECT 1 union ALL SELECT 2;` <br /> `SELECT COUNT(*)` <br /> `FROM @Test` <br /> `GROUP BY CASE WHEN a IN (SELECT t.a FROM @Test AS t)` <br /> `THEN 1 ELSE 0` <br /> `END;`|  
|<span data-ttu-id="034be-410">cláusula OUTPUT</span><span class="sxs-lookup"><span data-stu-id="034be-410">OUTPUT clause</span></span>|<span data-ttu-id="034be-411">Para evitar comportamento não determinístico, a cláusula OUTPUT não pode fazer referência a uma coluna de uma exibição ou função com valor de tabela embutida quando essa coluna é definida por um dos seguintes métodos:</span><span class="sxs-lookup"><span data-stu-id="034be-411">To prevent nondeterministic behavior, the OUTPUT clause cannot reference a column from a view or inline table-valued function when that column is defined by one of the following methods:</span></span><br /><br /> <span data-ttu-id="034be-412">Uma subconsulta.</span><span class="sxs-lookup"><span data-stu-id="034be-412">A subquery.</span></span><br /><br /> <span data-ttu-id="034be-413">Uma função definida pelo usuário que executa acesso a dados de usuário ou de sistema ou que supostamente executa tal acesso.</span><span class="sxs-lookup"><span data-stu-id="034be-413">A user-defined function that performs user- or system-data access, or is assumed to perform such access.</span></span><br /><br /> <span data-ttu-id="034be-414">Uma coluna computada que contém em sua definição uma função definida pelo usuário que executa acesso a dados de usuário ou de sistema.</span><span class="sxs-lookup"><span data-stu-id="034be-414">A computed column that contains in its definition a user-defined function that performs user- or system-data access.</span></span><br /><br /> <br /><br /> <span data-ttu-id="034be-415">Quando [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] detectar tal coluna na cláusula OUTPUT, ocorrerá o erro 4186.</span><span class="sxs-lookup"><span data-stu-id="034be-415">When [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] detects such a column in the OUTPUT clause, error 4186 is raised.</span></span> <span data-ttu-id="034be-416">Para obter mais informações, consulte [MSSQLSERVER_4186](../relational-databases/errors-events/mssqlserver-4186-database-engine-error.md).</span><span class="sxs-lookup"><span data-stu-id="034be-416">For more information, see [MSSQLSERVER_4186](../relational-databases/errors-events/mssqlserver-4186-database-engine-error.md).</span></span>|  
|<span data-ttu-id="034be-417">Cláusula OUTPUT INTO</span><span class="sxs-lookup"><span data-stu-id="034be-417">OUTPUT INTO clause</span></span>|<span data-ttu-id="034be-418">A tabela de destino da cláusula OUTPUT INTO não pode ter gatilhos habilitados.</span><span class="sxs-lookup"><span data-stu-id="034be-418">The target table of the OUTPUT INTO clause cannot have any enabled triggers.</span></span>|  
|<span data-ttu-id="034be-419">Opção no nível de servidor classificação pré-computada</span><span class="sxs-lookup"><span data-stu-id="034be-419">precompute rank server-level option</span></span>|<span data-ttu-id="034be-420">Esta opção não tem suporte no [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)].</span><span class="sxs-lookup"><span data-stu-id="034be-420">This option is not supported in [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)].</span></span> <span data-ttu-id="034be-421">Modifique os aplicativos que usam esse recurso o mais rápido possível.</span><span class="sxs-lookup"><span data-stu-id="034be-421">Modify applications that currently use this feature as soon as possible.</span></span>|  
|<span data-ttu-id="034be-422">dica de tabela READPAST</span><span class="sxs-lookup"><span data-stu-id="034be-422">READPAST table hint</span></span>|<span data-ttu-id="034be-423">Você não pode especificar a dica READPAST em Isolamento de Instantâneo.</span><span class="sxs-lookup"><span data-stu-id="034be-423">You cannot specify the READPAST hint under Snapshot Isolation.</span></span><br /><br /> <span data-ttu-id="034be-424">A dica READPAST é ignorada quando a opção de banco de dados READ_COMMITED_SNAPSHOT ou ALLOW_SNAPSHOT_ISOLATION é configurada como ON.</span><span class="sxs-lookup"><span data-stu-id="034be-424">The READPAST hint is ignored when either the READ_COMMITED_SNAPSHOT or ALLOW_SNAPSHOT_ISOLATION database option is set to ON.</span></span> <span data-ttu-id="034be-425">No entanto, se você combinar a dica READPAST com READCOMMITTEDLOCK, o comportamento de READPAST é igual ao do bloqueio da dica READCOMMITTED.</span><span class="sxs-lookup"><span data-stu-id="034be-425">However, if you combine the READPAST hint with READCOMMITTEDLOCK, the READPAST behavior is same as with the blocking READCOMMITTED hint.</span></span>|  
|<span data-ttu-id="034be-426">sp_helpuser</span><span class="sxs-lookup"><span data-stu-id="034be-426">sp_helpuser</span></span>|<span data-ttu-id="034be-427">Os nomes de coluna a seguir retornados no conjunto de resultados do procedimento armazenado sp_helpuser foram alterados:</span><span class="sxs-lookup"><span data-stu-id="034be-427">The following column names that are returned in the result set of the sp_helpuser stored procedure have changed:</span></span><br /><br /> <span data-ttu-id="034be-428">GroupName agora é:</span><span class="sxs-lookup"><span data-stu-id="034be-428">GroupName is now:</span></span><br />                            <span data-ttu-id="034be-429">RoleName</span><span class="sxs-lookup"><span data-stu-id="034be-429">RoleName</span></span><br /><br /> <span data-ttu-id="034be-430">Group_name agora é:</span><span class="sxs-lookup"><span data-stu-id="034be-430">Group_name is now:</span></span><br />                            <span data-ttu-id="034be-431">Role_name</span><span class="sxs-lookup"><span data-stu-id="034be-431">Role_name</span></span><br /><br /> <span data-ttu-id="034be-432">Group_id agora é:</span><span class="sxs-lookup"><span data-stu-id="034be-432">Group_id is now:</span></span><br />                            <span data-ttu-id="034be-433">Role_id</span><span class="sxs-lookup"><span data-stu-id="034be-433">Role_id</span></span><br /><br /> <span data-ttu-id="034be-434">Users_in_group agora é:</span><span class="sxs-lookup"><span data-stu-id="034be-434">Users_in_group is now:</span></span><br />                            <span data-ttu-id="034be-435">Users_in_role</span><span class="sxs-lookup"><span data-stu-id="034be-435">Users_in_role</span></span>|  
|<span data-ttu-id="034be-436">Criptografia de Dados Transparente</span><span class="sxs-lookup"><span data-stu-id="034be-436">Transparent Data Encryption</span></span>|<span data-ttu-id="034be-437">A criptografia transparente de dados (TDE) é executada no nível de E/S: a estrutura da página é descriptografada na memória e criptografada somente quando a página é gravada no disco.</span><span class="sxs-lookup"><span data-stu-id="034be-437">Transparent data encryption (TDE) is performed at the I/O level: the page structure is unencrypted in memory and is encrypted only when the page is written to disk.</span></span> <span data-ttu-id="034be-438">Os arquivos de banco de dados e os arquivos de log são criptografados.</span><span class="sxs-lookup"><span data-stu-id="034be-438">Both the database files and log files are encrypted.</span></span> <span data-ttu-id="034be-439">Os aplicativos de terceiros que ignoram o mecanismo regular do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] para acessar páginas (por exemplo, verificando os dados ou os arquivos de log diretamente), falharão quando um banco de dados usar TDE porque os dados estão criptografados nos arquivos.</span><span class="sxs-lookup"><span data-stu-id="034be-439">Third-party applications that bypass the regular [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] mechanism for accessing pages (for example, by scanning the data or log files directly), will fail when a database uses TDE because the data is encrypted in the files.</span></span> <span data-ttu-id="034be-440">Esses aplicativos podem aproveitar a API Criptográfica do Windows para desenvolver uma solução para descriptografar os dados fora do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="034be-440">Such applications can leverage the Window Cryptographic API to develop a solution for decrypting the data outside of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span></span>|  
  
### <a name="xquery"></a><span data-ttu-id="034be-441">XQuery</span><span class="sxs-lookup"><span data-stu-id="034be-441">XQuery</span></span>  
  
|<span data-ttu-id="034be-442">Recurso</span><span class="sxs-lookup"><span data-stu-id="034be-442">Feature</span></span>|<span data-ttu-id="034be-443">Descrição</span><span class="sxs-lookup"><span data-stu-id="034be-443">Description</span></span>|  
|-------------|-----------------|  
|<span data-ttu-id="034be-444">Suporte à data/hora</span><span class="sxs-lookup"><span data-stu-id="034be-444">Datetime support</span></span>|<span data-ttu-id="034be-445">No [!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)] , os tipos de dados `xs:time` , `xs:date` e `xs:dateTime` não têm suporte a fuso horário.</span><span class="sxs-lookup"><span data-stu-id="034be-445">In [!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)], the data types `xs:time`, `xs:date`, and `xs:dateTime` do not have timezone support.</span></span> <span data-ttu-id="034be-446">Os dados de fuso horário são mapeados para o fuso horário de UTC.</span><span class="sxs-lookup"><span data-stu-id="034be-446">Timezone data is mapped to the UTC timezone.</span></span> <span data-ttu-id="034be-447">O [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)] fornece comportamento de conformidade padrão, o que resulta nas seguintes alterações:</span><span class="sxs-lookup"><span data-stu-id="034be-447">[!INCLUDE[ssKatmai](../includes/sskatmai-md.md)], provides standard conformant behavior, resulting in the following changes:</span></span><br /><br /> <span data-ttu-id="034be-448">Os valores sem fuso horário são validados.</span><span class="sxs-lookup"><span data-stu-id="034be-448">Values without timezone are validated.</span></span><br /><br /> <span data-ttu-id="034be-449">O fuso horário fornecido ou a ausência de um fuso horário é preservada.</span><span class="sxs-lookup"><span data-stu-id="034be-449">The provided timezone or the absence of a timezone is preserved.</span></span><br /><br /> <span data-ttu-id="034be-450">A representação de armazenamento interna é modificada.</span><span class="sxs-lookup"><span data-stu-id="034be-450">The internal storage representation is modified.</span></span><br /><br /> <span data-ttu-id="034be-451">A resolução de valores armazenados é aumentada.</span><span class="sxs-lookup"><span data-stu-id="034be-451">Resolution of stored values is increased.</span></span><br /><br /> <span data-ttu-id="034be-452">Anos negativos não são permitidos.</span><span class="sxs-lookup"><span data-stu-id="034be-452">Negative years are disallowed.</span></span><br /><br /> <br /><br /> <span data-ttu-id="034be-453">Observação: modifique aplicativos e expressões XQuery para considerar os novos valores de tipo.</span><span class="sxs-lookup"><span data-stu-id="034be-453">Note: Modify applications and XQuery expressions to account for the new type values.</span></span>|  
|<span data-ttu-id="034be-454">Expressões XQuery e Xpath</span><span class="sxs-lookup"><span data-stu-id="034be-454">XQuery and Xpath expressions</span></span>|<span data-ttu-id="034be-455">No [!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)] , as etapas em uma expressão XQuery ou XPath que começam com dois-pontos (': ') são permitidas.</span><span class="sxs-lookup"><span data-stu-id="034be-455">In [!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)], steps in an XQuery or XPath expression that begin with a colon (':') are allowed.</span></span> <span data-ttu-id="034be-456">Por exemplo, a instrução a seguir contém um teste de nome (`CTR02)` dentro da expressão de caminho que começa com um dois pontos.</span><span class="sxs-lookup"><span data-stu-id="034be-456">For example, the following statement contains a name test (`CTR02)` within the path expression that begins with a colon.</span></span><br /><br /> `SELECT FileContext.query('for n$ in //CTR return <C>{data )(n$/:CTR02)} </C>) AS Files FROM dbo.MyTable;`<br /><br /> <span data-ttu-id="034be-457">No [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)] esse uso não é permitido porque não está de acordo com os padrões XML.</span><span class="sxs-lookup"><span data-stu-id="034be-457">In [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)], this usage is disallowed because it does not conform to XML standards.</span></span> <span data-ttu-id="034be-458">O erro 9341 é retornado.</span><span class="sxs-lookup"><span data-stu-id="034be-458">Error 9341 is returned.</span></span> <span data-ttu-id="034be-459">Remova o dois-pontos à esquerda ou especifique um prefixo para o teste de nome, por exemplo, (n$/CTR02) ou (n$/p1:CTR02).</span><span class="sxs-lookup"><span data-stu-id="034be-459">Remove the leading colon or specify a prefix for the name test--for example, (n$/CTR02) or (n$/p1:CTR02).</span></span>|  
  
### <a name="connecting"></a><span data-ttu-id="034be-460">Connecting</span><span class="sxs-lookup"><span data-stu-id="034be-460">Connecting</span></span>  
  
|<span data-ttu-id="034be-461">Recurso</span><span class="sxs-lookup"><span data-stu-id="034be-461">Feature</span></span>|<span data-ttu-id="034be-462">Descrição</span><span class="sxs-lookup"><span data-stu-id="034be-462">Description</span></span>|  
|-------------|-----------------|  
|<span data-ttu-id="034be-463">Estabelecendo conexão a partir do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Native Client usando SSL</span><span class="sxs-lookup"><span data-stu-id="034be-463">Connecting from [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Native Client using SSL</span></span>|<span data-ttu-id="034be-464">Na conexão com o [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Native Client, os aplicativos que usam "SERVER=shortname; FORCE ENCRYPTION=true" com certificado cujos Assuntos especificam FQDNs (nomes de domínios totalmente qualificados) antes se conectavam devido à validação reduzida.</span><span class="sxs-lookup"><span data-stu-id="034be-464">When connecting with [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Native Client, applications that use "SERVER=shortname; FORCE ENCRYPTION=true" with certificate whose Subjects specify Fully Qualified Domain Names (FQDN's) have connected in the past due to relaxed validation.</span></span> <span data-ttu-id="034be-465">O SQL Server 2008 R2 aprimora a segurança impondo assuntos de FQDN para certificados.</span><span class="sxs-lookup"><span data-stu-id="034be-465">SQL Server 2008 R2 enhances security by enforcing FQDN subjects for certificates.</span></span> <span data-ttu-id="034be-466">Os aplicativos que dependem de validação reduzida devem executar uma das seguintes ações:</span><span class="sxs-lookup"><span data-stu-id="034be-466">Applications that rely upon relaxed validation must take one of the following actions:</span></span><br /><br /> <span data-ttu-id="034be-467">Use o FQDN na cadeia de caracteres de conexão.</span><span class="sxs-lookup"><span data-stu-id="034be-467">Use the FQDN in the connection string.</span></span><br /><br /> <span data-ttu-id="034be-468">-Essa opção não requer a recompilação do aplicativo se a palavra-chave SERVER da cadeia de conexão estiver configurada fora do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="034be-468">-This option does not require recompiling the application if the SERVER keyword of the connection string is configured outside the application.</span></span><br /><br /> <span data-ttu-id="034be-469">-Essa opção não funciona para aplicativos que têm suas cadeias de conexão codificadas.</span><span class="sxs-lookup"><span data-stu-id="034be-469">-This option does not work for applications that have their connection strings hardcoded.</span></span><br /><br /> <span data-ttu-id="034be-470">-Essa opção não funciona para aplicativos que usam o espelhamento de banco de dados, pois o servidor espelhado responde com um nome simples.</span><span class="sxs-lookup"><span data-stu-id="034be-470">-This option does not work for applications that use Database Mirroring since the mirrored server replies with a simple name.</span></span>|  
||<span data-ttu-id="034be-471">Adicione um alias para o nome curto mapear para o FQDN.</span><span class="sxs-lookup"><span data-stu-id="034be-471">Add an alias for the shortname to map to the FQDN.</span></span><br /><br /> <span data-ttu-id="034be-472">-Essa opção funciona até mesmo para aplicativos que têm suas cadeias de conexão codificadas.</span><span class="sxs-lookup"><span data-stu-id="034be-472">-This option works even for applications that have their connection strings hardcoded.</span></span><br /><br /> <span data-ttu-id="034be-473">-Essa opção não funciona para aplicativos que usam o espelhamento de banco de dados, pois os provedores não pesquisam aliases para nomes de parceiros de failover recebidos.</span><span class="sxs-lookup"><span data-stu-id="034be-473">-This option does not work for applications that use Database Mirroring since the providers don't look up aliases for received failover partner names.</span></span>|  
||<span data-ttu-id="034be-474">Tenha um certificado emitido para nome curto.</span><span class="sxs-lookup"><span data-stu-id="034be-474">Have a certificate issued for shortname.</span></span><br /><br /> <span data-ttu-id="034be-475">-Essa opção funciona para todos os aplicativos.</span><span class="sxs-lookup"><span data-stu-id="034be-475">-This option works for all applications.</span></span>|  

## <a name="breaking-changes-in-sql-server-2005"></a><a name="Yukon"></a><span data-ttu-id="034be-476">Alterações recentes no SQL Server 2005</span><span class="sxs-lookup"><span data-stu-id="034be-476">Breaking Changes in SQL Server 2005</span></span>  

[!INCLUDE[Archived documentation for very old versions of SQL Server](../includes/paragraph-content/previous-versions-archive-documentation-sql-server.md)]

## <a name="see-also"></a><span data-ttu-id="034be-477">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="034be-477">See Also</span></span>  
 <span data-ttu-id="034be-478">[Recursos preteridos Mecanismo de Banco de Dados no SQL Server 2014](deprecated-database-engine-features-in-sql-server-2016.md?view=sql-server-2014) </span><span class="sxs-lookup"><span data-stu-id="034be-478">[Deprecated Database Engine Features in SQL Server 2014](deprecated-database-engine-features-in-sql-server-2016.md?view=sql-server-2014) </span></span>  
 <span data-ttu-id="034be-479">[Alterações de comportamento para Mecanismo de Banco de Dados recursos no SQL Server 2014](../../2014/database-engine/behavior-changes-to-database-engine-features-in-sql-server-2014.md?view=sql-server-2014) </span><span class="sxs-lookup"><span data-stu-id="034be-479">[Behavior Changes to Database Engine Features in SQL Server 2014](../../2014/database-engine/behavior-changes-to-database-engine-features-in-sql-server-2014.md?view=sql-server-2014) </span></span>  
 <span data-ttu-id="034be-480">[Funcionalidade de Mecanismo de Banco de Dados descontinuada no SQL Server 2014](discontinued-database-engine-functionality-in-sql-server-2016.md?view=sql-server-2014) </span><span class="sxs-lookup"><span data-stu-id="034be-480">[Discontinued Database Engine Functionality in SQL Server 2014](discontinued-database-engine-functionality-in-sql-server-2016.md?view=sql-server-2014) </span></span>  
 <span data-ttu-id="034be-481">[Compatibilidade com versões anteriores do Mecanismo de Banco de Dados do SQL Server](sql-server-database-engine-backward-compatibility.md) </span><span class="sxs-lookup"><span data-stu-id="034be-481">[SQL Server Database Engine Backward Compatibility](sql-server-database-engine-backward-compatibility.md) </span></span>  
 [<span data-ttu-id="034be-482">Nível de compatibilidade de ALTER DATABASE &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="034be-482">ALTER DATABASE Compatibility Level &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/alter-database-transact-sql-compatibility-level)  
 [<span data-ttu-id="034be-483">Alterações de quebra feitas em recursos das Ferramentas de Gerenciamento do SQL Server 2014</span><span class="sxs-lookup"><span data-stu-id="034be-483">Breaking Changes to Management Tools Features in SQL Server 2014</span></span>](breaking-changes-to-management-tools-features-in-sql-server-2014.md?view=sql-server-2014)  
  
