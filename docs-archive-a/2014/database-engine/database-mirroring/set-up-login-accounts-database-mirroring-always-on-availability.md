---
title: Configurar contas de logon para espelhamento de banco de dados ou Grupos de Disponibilidade AlwaysOn (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- database mirroring [SQL Server], deployment
- logins [SQL Server], database mirroring
ms.assetid: e9f5287b-1325-4cda-88a6-19eaaa52a652
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: d149016dabd0239bd76eadc8655b6752afd916d9
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87681142"
---
# <a name="set-up-login-accounts-for-database-mirroring-or-alwayson-availability-groups-sql-server"></a><span data-ttu-id="d4bce-102">Configurar contas de logon para espelhamento de banco de dados ou para grupos de disponibilidade AlwaysOn (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="d4bce-102">Set Up Login Accounts for Database Mirroring or AlwaysOn Availability Groups (SQL Server)</span></span>
  <span data-ttu-id="d4bce-103">Para que duas instâncias de servidor se conectem ao [ponto de extremidade de espelhamento de banco de dados](the-database-mirroring-endpoint-sql-server.md) entre si, é necessário acesso mútuo entre as conta de logon de cada instância.</span><span class="sxs-lookup"><span data-stu-id="d4bce-103">For two server instances to connect to each other's [database mirroring endpoint](the-database-mirroring-endpoint-sql-server.md) point, the login account of each instance requires access to the other instance.</span></span> <span data-ttu-id="d4bce-104">Além disso, cada conta de logon exige a permissão de conexão com o ponto de extremidade do Espelhamento de Banco de Dados da outra instância.</span><span class="sxs-lookup"><span data-stu-id="d4bce-104">Also, each login account requires connect permission to the Database Mirroring endpoint of the other instance.</span></span>  
  
 <span data-ttu-id="d4bce-105">O impacto desse requisito depende das instâncias de servidor executadas como a mesma conta de usuário do domínio:</span><span class="sxs-lookup"><span data-stu-id="d4bce-105">The impact of this requirement depends on whether the server instances run as the same domain user account:</span></span>  
  
-   <span data-ttu-id="d4bce-106">Se as instâncias de servidor forem executadas como a mesma conta de usuário do domínio, os logons de usuário corretos existirão automaticamente em ambos os bancos de dados **mestres** .</span><span class="sxs-lookup"><span data-stu-id="d4bce-106">If the server instances run as the same domain user account, the correct user logins exist automatically in both **master** databases.</span></span> <span data-ttu-id="d4bce-107">Isso simplifica a configuração de segurança do Espelhamento de Banco de Dados e de Grupos de Disponibilidade AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="d4bce-107">This simplifies the security configuration for Database Mirroring and AlwaysOn Availability Groups.</span></span>  
  
-   <span data-ttu-id="d4bce-108">Se as instâncias de servidor forem executadas como contas de usuário diferentes, os logons de usuário na instância de servidor que hospeda o servidor principal ou a réplica principal deverão ser reproduzidos manualmente na instância de servidor que hospeda o servidor espelho ou em todas as instâncias de servidor que hospedem uma réplica secundária.</span><span class="sxs-lookup"><span data-stu-id="d4bce-108">If the server instances run as different user accounts, user logins on the server instance that hosts the principal server or primary replica must be manually reproduced on the server instance that hosts the mirror server or on every server instance that hosts a secondary replica.</span></span> <span data-ttu-id="d4bce-109">Para obter mais informações, consulte [Criar um logon para uma conta diferente](#CreateLogin) e [Conceder permissão de conexão](#GrantConnect), posteriormente neste tópico.</span><span class="sxs-lookup"><span data-stu-id="d4bce-109">For more information, see [Create a Login for a Different Account](#CreateLogin) and [Grant Connect Permission](#GrantConnect), later in this topic.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="d4bce-110">Para criar um ambiente mais seguro, procure usar contas de domínio separadas para cada instância do servidor.</span><span class="sxs-lookup"><span data-stu-id="d4bce-110">To create a more secure environment, consider using separate domain accounts for each server instance.</span></span>  
  
##  <a name="create-a-login-for-a-different-account"></a><a name="CreateLogin"></a><span data-ttu-id="d4bce-111">Criar um logon para uma conta diferente</span><span class="sxs-lookup"><span data-stu-id="d4bce-111">Create a Login for a Different Account</span></span>  
 <span data-ttu-id="d4bce-112">Se duas instâncias de servidor forem executadas como contas diferentes, o administrador do sistema deve usar a instrução CREATE LOGIN [!INCLUDE[tsql](../../includes/tsql-md.md)] para criar um logon para a conta de serviço de inicialização da instância remota para cada instância do servidor.</span><span class="sxs-lookup"><span data-stu-id="d4bce-112">If two server instances run as different accounts, the system administrator must use the CREATE LOGIN [!INCLUDE[tsql](../../includes/tsql-md.md)] statement to create a login for the startup service account of the remote instance for each server instance.</span></span> <span data-ttu-id="d4bce-113">Para obter mais informações, veja [CREATE LOGIN &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-login-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="d4bce-113">For more information, see [CREATE LOGIN &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-login-transact-sql).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="d4bce-114">Se você executar o [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] em uma conta fora do domínio, deverá usar certificados.</span><span class="sxs-lookup"><span data-stu-id="d4bce-114">If you run [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] under a non-domain account, you must use certificates.</span></span> <span data-ttu-id="d4bce-115">Para obter mais informações, consulte [Usar certificados para um ponto de extremidade de espelhamento de banco de dados &#40;Transact-SQL&#41;](use-certificates-for-a-database-mirroring-endpoint-transact-sql.md).</span><span class="sxs-lookup"><span data-stu-id="d4bce-115">For more information, see [Use Certificates for a Database Mirroring Endpoint &#40;Transact-SQL&#41;](use-certificates-for-a-database-mirroring-endpoint-transact-sql.md).</span></span>  
  
 <span data-ttu-id="d4bce-116">Por exemplo, para a instância de servidor sqlA, executada em loginA, conectar-se à instância de servidor sqlB, executada no loginB, o loginA deve existir no sqlB e loginB, loginA deve existir no sqlA.</span><span class="sxs-lookup"><span data-stu-id="d4bce-116">For example, for the server instance sqlA, which runs under loginA, to connect to the server instance sqlB, which runs under loginB, loginA must exist on sqlB, and loginB must exist on sqlA.</span></span> <span data-ttu-id="d4bce-117">Além disso, para uma sessão de espelhamento de banco de dados que inclui uma instância de servidor testemunha (sqlC) e na qual as três instâncias de servidor são executadas em contas de domínio diferentes, devem ser criados os seguintes logons:</span><span class="sxs-lookup"><span data-stu-id="d4bce-117">In addition, for a database mirroring session that includes a witness server instance (sqlC) and in which the three server instances run under different domain accounts, the following logins must be created:</span></span>  
  
|<span data-ttu-id="d4bce-118">Na instância...</span><span class="sxs-lookup"><span data-stu-id="d4bce-118">On instance...</span></span>|<span data-ttu-id="d4bce-119">Crie logons para e conceda permissão de conexão para ...</span><span class="sxs-lookup"><span data-stu-id="d4bce-119">Create logins for and grant connection permission to ...</span></span>|  
|--------------------|--------------------------------------------------------------|  
|<span data-ttu-id="d4bce-120">sqlA</span><span class="sxs-lookup"><span data-stu-id="d4bce-120">sqlA</span></span>|<span data-ttu-id="d4bce-121">sqlB e sqlC</span><span class="sxs-lookup"><span data-stu-id="d4bce-121">sqlB and sqlC</span></span>|  
|<span data-ttu-id="d4bce-122">sqlB</span><span class="sxs-lookup"><span data-stu-id="d4bce-122">sqlB</span></span>|<span data-ttu-id="d4bce-123">sqlA e sqlC</span><span class="sxs-lookup"><span data-stu-id="d4bce-123">sqlA and sqlC</span></span>|  
|<span data-ttu-id="d4bce-124">sqlC</span><span class="sxs-lookup"><span data-stu-id="d4bce-124">sqlC</span></span>|<span data-ttu-id="d4bce-125">sqlA e sqlB</span><span class="sxs-lookup"><span data-stu-id="d4bce-125">sqlA and sqlB</span></span>|  
  
> [!NOTE]  
>  <span data-ttu-id="d4bce-126">É possível conectar-se com a conta de serviço de rede usando a conta da máquina em vez de um usuário de domínio.</span><span class="sxs-lookup"><span data-stu-id="d4bce-126">It is possible to connect with the network service account by using the machine account instead of a domain user.</span></span> <span data-ttu-id="d4bce-127">Se a conta da máquina for usada, ela deve ser adicionada como um usuário na outra instância de servidor.</span><span class="sxs-lookup"><span data-stu-id="d4bce-127">If the machine account is used, it must be added as a user on the other server instance.</span></span>  
  
##  <a name="grant-connect-permission"></a><a name="GrantConnect"></a><span data-ttu-id="d4bce-128">Conceder permissão de conexão</span><span class="sxs-lookup"><span data-stu-id="d4bce-128">Grant Connect Permission</span></span>  
 <span data-ttu-id="d4bce-129">Quando um logon tiver sido criado em uma instância de servidor, deve ser concedida permissão para que ele se conecte com o ponto de extremidade de espelhamento de banco de dados da instância de servidor.</span><span class="sxs-lookup"><span data-stu-id="d4bce-129">Once a login has been created on a server instance, the login must be granted permission to connect to the database mirroring endpoint of the server instance.</span></span> <span data-ttu-id="d4bce-130">O administrador do sistema concede a permissão de conexão usando uma instrução GRANT [!INCLUDE[tsql](../../includes/tsql-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d4bce-130">The system administrator grants the connect permission using a GRANT [!INCLUDE[tsql](../../includes/tsql-md.md)] statement.</span></span> <span data-ttu-id="d4bce-131">Para obter mais informações, veja [GRANT &#40;Transact-SQL&#41;](/sql/t-sql/statements/grant-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="d4bce-131">For more information, see [GRANT &#40;Transact-SQL&#41;](/sql/t-sql/statements/grant-transact-sql).</span></span>  
  
##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="d4bce-132">Tarefas relacionadas</span><span class="sxs-lookup"><span data-stu-id="d4bce-132">Related Tasks</span></span>  
  
-   [<span data-ttu-id="d4bce-133">Criar um logon</span><span class="sxs-lookup"><span data-stu-id="d4bce-133">Create a Login</span></span>](../../relational-databases/security/authentication-access/create-a-login.md)  
  
-   <span data-ttu-id="d4bce-134">[Permitir o acesso à rede para um ponto de extremidade de espelhamento de banco de dados usando a autenticação do Windows &#40;SQL Server&#41;](../database-mirroring-allow-network-access-windows-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="d4bce-134">[Allow Network Access to a Database Mirroring Endpoint Using Windows Authentication &#40;SQL Server&#41;](../database-mirroring-allow-network-access-windows-authentication.md).</span></span>  
  
-   [<span data-ttu-id="d4bce-135">Usar certificados para um ponto de extremidade de espelhamento de banco de dados &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="d4bce-135">Use Certificates for a Database Mirroring Endpoint &#40;Transact-SQL&#41;</span></span>](use-certificates-for-a-database-mirroring-endpoint-transact-sql.md)  
  
## <a name="see-also"></a><span data-ttu-id="d4bce-136">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="d4bce-136">See Also</span></span>  
 <span data-ttu-id="d4bce-137">[O ponto de extremidade de espelhamento de banco de dados &#40;SQL Server&#41;](the-database-mirroring-endpoint-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="d4bce-137">[The Database Mirroring Endpoint &#40;SQL Server&#41;](the-database-mirroring-endpoint-sql-server.md) </span></span>  
 <span data-ttu-id="d4bce-138">[Solução de problemas de configuração de espelhamento de banco de dados &#40;SQL Server&#41;](troubleshoot-database-mirroring-configuration-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="d4bce-138">[Troubleshoot Database Mirroring Configuration &#40;SQL Server&#41;](troubleshoot-database-mirroring-configuration-sql-server.md) </span></span>  
 [<span data-ttu-id="d4bce-139">Solucionar problemas de Grupos de Disponibilidade AlwaysOn &#40;de configuração SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="d4bce-139">Troubleshoot AlwaysOn Availability Groups Configuration &#40;SQL Server&#41;</span></span>](../availability-groups/windows/troubleshoot-always-on-availability-groups-configuration-sql-server.md)  
  
  
