---
title: Minimizar o tempo de inatividade para bancos de dados espelhados ao atualizar instâncias de servidor | Microsoft Docs
ms.custom: ''
ms.date: 03/08/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- upgrading SQL Server, rolling upgrade of mirrored databases
- database mirroring [SQL Server], upgrading system
- rolling upgrades [SQL Server]
ms.assetid: 0e73bd23-497d-42f1-9e81-8d5314bcd597
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 0a343e6b9e93aa1910c82f436f3a50daf00d57bc
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87572690"
---
# <a name="minimize-downtime-for-mirrored-databases-when-upgrading-server-instances"></a><span data-ttu-id="c75db-102">Minimizar o tempo de inatividade de bancos de dados espelhados ao atualizar instâncias do servidor</span><span class="sxs-lookup"><span data-stu-id="c75db-102">Minimize Downtime for Mirrored Databases When Upgrading Server Instances</span></span>
  <span data-ttu-id="c75db-103">Ao atualizar instâncias de servidor para [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] o, você pode reduzir o tempo de inatividade de cada banco de dados espelhado para apenas um único failover manual executando uma atualização sequencial, conhecida como *atualização sem interrupção*.</span><span class="sxs-lookup"><span data-stu-id="c75db-103">When upgrading server instances to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], you can reduce downtime for each mirrored database to only a single manual failover by performing a sequential upgrade, known as a *rolling upgrade*.</span></span> <span data-ttu-id="c75db-104">Uma atualização sem-interrupção consiste em um processo de várias etapas que, em sua forma mais simples, envolve atualizar a instância do servidor que funciona como o servidor espelho de uma sessão de espelhamento, executar o failover manual no banco de dados espelho, atualizar o antigo servidor principal e continuar o espelhamento.</span><span class="sxs-lookup"><span data-stu-id="c75db-104">A rolling upgrade is a multi-stage process that in its simplest form involves upgrading the server instance that is currently acting as the mirror server in a mirroring session, then manually failing over the mirrored database, upgrading the former principal server, and resuming mirroring.</span></span> <span data-ttu-id="c75db-105">Na prática, o processo exato dependerá do modo de operação e do número e do layout de sessões de espelhamento em execução nas instâncias do servidor que você está atualizando.</span><span class="sxs-lookup"><span data-stu-id="c75db-105">In practice, the exact process will depend on the operating mode and the number and layout of mirroring session running on the server instances that you are upgrading.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="c75db-106">Para obter informações sobre como executar uma atualização sem interrupção para instalar um service pack ou hotfix, consulte [instalar um Service Pack em um sistema com tempo de inatividade mínimo para bancos de dados espelhados](../install-a-service-pack-on-a-system-with-minimal-downtime-for-mirrored-databases.md).</span><span class="sxs-lookup"><span data-stu-id="c75db-106">For information about performing a rolling upgrade to install a service pack or hotfix, see [Install a Service Pack on a System with Minimal Downtime for Mirrored Databases](../install-a-service-pack-on-a-system-with-minimal-downtime-for-mirrored-databases.md).</span></span>  
  
 <span data-ttu-id="c75db-107">**Preparação recomendada (práticas recomendadas)**</span><span class="sxs-lookup"><span data-stu-id="c75db-107">**Recommended Preparation (Best Practices)**</span></span>  
  
 <span data-ttu-id="c75db-108">Antes de iniciar uma atualização sem-interrupção, é recomendável:</span><span class="sxs-lookup"><span data-stu-id="c75db-108">Before starting a rolling upgrade, we recommend that you:</span></span>  
  
1.  <span data-ttu-id="c75db-109">Executar um failover manual em pelo menos uma das sessões de espelhamento:</span><span class="sxs-lookup"><span data-stu-id="c75db-109">Perform a practice manual failover on at least one of your mirroring sessions:</span></span>  
  
    -   [<span data-ttu-id="c75db-110">Executar failover manualmente de uma sessão de espelhamento de banco de dados &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="c75db-110">Manually Fail Over a Database Mirroring Session &#40;SQL Server Management Studio&#41;</span></span>](manually-fail-over-a-database-mirroring-session-sql-server-management-studio.md)  
  
    -   <span data-ttu-id="c75db-111">[Executar failover manualmente em uma sessão de espelhamento de banco de dados &#40;Transact-SQL&#41;](manually-fail-over-a-database-mirroring-session-transact-sql.md).</span><span class="sxs-lookup"><span data-stu-id="c75db-111">[Manually Fail Over a Database Mirroring Session &#40;Transact-SQL&#41;](manually-fail-over-a-database-mirroring-session-transact-sql.md).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="c75db-112">Para obter informações sobre como funciona o failover manual, veja [Troca de função durante uma sessão de espelhamento de banco de dados &#40;SQL Server&#41;](role-switching-during-a-database-mirroring-session-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="c75db-112">For information about how manual failover works, see [Role Switching During a Database Mirroring Session &#40;SQL Server&#41;](role-switching-during-a-database-mirroring-session-sql-server.md).</span></span>  
  
2.  <span data-ttu-id="c75db-113">Proteger seus dados:</span><span class="sxs-lookup"><span data-stu-id="c75db-113">Protect your data:</span></span>  
  
    1.  <span data-ttu-id="c75db-114">Executar um backup de banco de dados completo em todos os bancos de dados principais:</span><span class="sxs-lookup"><span data-stu-id="c75db-114">Perform a full database backup on every principal database:</span></span>  
  
         <span data-ttu-id="c75db-115">[Criar um backup completo de banco de dados &#40;SQL Server&#41;](../../relational-databases/backup-restore/create-a-full-database-backup-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="c75db-115">[Create a Full Database Backup &#40;SQL Server&#41;](../../relational-databases/backup-restore/create-a-full-database-backup-sql-server.md).</span></span>  
  
    2.  <span data-ttu-id="c75db-116">Execute o comando [DBCC CHECKDB](/sql/t-sql/database-console-commands/dbcc-checkdb-transact-sql) em todos os bancos de dados principais.</span><span class="sxs-lookup"><span data-stu-id="c75db-116">Run the [DBCC CHECKDB](/sql/t-sql/database-console-commands/dbcc-checkdb-transact-sql) command on every principal database.</span></span>  
  
 <span data-ttu-id="c75db-117">**Etapas da atualização sem-interrupção**</span><span class="sxs-lookup"><span data-stu-id="c75db-117">**Stages of a Rolling Upgrade**</span></span>  
  
 <span data-ttu-id="c75db-118">As etapas específicas de uma atualização sem-interrupção dependem do modo de operação da configuração de espelhamento.</span><span class="sxs-lookup"><span data-stu-id="c75db-118">The specific steps of a rolling upgrade depend on the operating mode of the mirroring configuration.</span></span> <span data-ttu-id="c75db-119">No entanto, as etapas básicas são as mesmas.</span><span class="sxs-lookup"><span data-stu-id="c75db-119">However, the basic stages are the same.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="c75db-120">Para obter informações sobre os modos de operação, consulte [Modos de operação do Espelhamento de Banco de Dados](database-mirroring-operating-modes.md).</span><span class="sxs-lookup"><span data-stu-id="c75db-120">For information about the operating modes, see [Database Mirroring Operating Modes](database-mirroring-operating-modes.md).</span></span>  
  
 <span data-ttu-id="c75db-121">A ilustração a seguir é um fluxograma que mostra as etapas básicas de uma atualização sem-interrupção para cada modo de operação.</span><span class="sxs-lookup"><span data-stu-id="c75db-121">The following illustration is a flowchart that shows the basic stages of a rolling upgrade for each operating mode.</span></span> <span data-ttu-id="c75db-122">Os procedimentos correspondentes estão descritos após a ilustração.</span><span class="sxs-lookup"><span data-stu-id="c75db-122">The corresponding procedures are described after the illustration.</span></span>  
  
 <span data-ttu-id="c75db-123">![Fluxograma mostrando as etapas de uma atualização sem interrupção](../media/dbm-rolling-upgrade.gif "Fluxograma mostrando as etapas de uma atualização sem interrupção")</span><span class="sxs-lookup"><span data-stu-id="c75db-123">![Flowchart showing steps of a rolling upgrade](../media/dbm-rolling-upgrade.gif "Flowchart showing steps of a rolling upgrade")</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="c75db-124">Uma instância do servidor pode estar executando diferentes funções de espelhamento (servidor principal, servidor espelho ou testemunha) nas sessões de espelhamento simultâneas.</span><span class="sxs-lookup"><span data-stu-id="c75db-124">A server instance might be performing different mirroring roles (principal server, mirror server, or witness) in concurrent mirroring sessions.</span></span> <span data-ttu-id="c75db-125">Nesse caso, é preciso adaptar o processo básico de atualização sem-interrupção na mesma proporção.</span><span class="sxs-lookup"><span data-stu-id="c75db-125">In this case, you will have to adapt the basic rolling upgrade process accordingly.</span></span> <span data-ttu-id="c75db-126">Para obter mais informações, consulte [Troca de função durante uma sessão de espelhamento de banco de dados &#40;SQL Server&#41;](role-switching-during-a-database-mirroring-session-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="c75db-126">For more information, see [Role Switching During a Database Mirroring Session &#40;SQL Server&#41;](role-switching-during-a-database-mirroring-session-sql-server.md).</span></span>  
  
### <a name="to-change-a-session-from-high-performance-mode-to-high-safety-mode"></a><span data-ttu-id="c75db-127">Para alterar uma sessão em modo de alto desempenho para modo de segurança alta</span><span class="sxs-lookup"><span data-stu-id="c75db-127">To change a session from high-performance mode to high-safety mode</span></span>  
  
1.  <span data-ttu-id="c75db-128">Se a sessão de espelhamento estiver sendo executada em modo de alto desempenho, antes de executar a atualização sem-interrupção, altere o modo operacional para segurança alta sem failover automático.</span><span class="sxs-lookup"><span data-stu-id="c75db-128">If a mirroring session is running in high-performance mode, before you perform a rolling upgrade, change the operating mode to high safety without automatic failover.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="c75db-129">Se o servidor espelho está geograficamente distante do servidor principal, uma atualização sem-interrupção pode ser inadequada.</span><span class="sxs-lookup"><span data-stu-id="c75db-129">If the mirror server is geographically distant from the principal server, a rolling upgrade might be inappropriate.</span></span>  
  
    -   <span data-ttu-id="c75db-130">Em [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]: altere a opção **Modo de operação** para **Segurança alta sem failover automático (síncrono)** usando a [página Espelhamento](../../relational-databases/databases/database-properties-mirroring-page.md) da caixa de diálogo **Propriedades do Banco de Dados**.</span><span class="sxs-lookup"><span data-stu-id="c75db-130">In [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]: Change the **Operating mode** option to **High safety without automatic failover (synchronous)** by using the [Mirroring Page](../../relational-databases/databases/database-properties-mirroring-page.md) of the **Database Properties** dialog box.</span></span> <span data-ttu-id="c75db-131">Para obter informações sobre como acessar essa página, consulte [Iniciar o Assistente para Configurar Segurança de Espelhamento de Banco de Dados &#40;SQL Server Management Studio&#41;](start-the-configuring-database-mirroring-security-wizard.md).</span><span class="sxs-lookup"><span data-stu-id="c75db-131">For information about how to access this page, see [Start the Configuring Database Mirroring Security Wizard &#40;SQL Server Management Studio&#41;](start-the-configuring-database-mirroring-security-wizard.md).</span></span>  
  
    -   <span data-ttu-id="c75db-132">Em [!INCLUDE[tsql](../../includes/tsql-md.md)]: defina a segurança de transações para FULL.</span><span class="sxs-lookup"><span data-stu-id="c75db-132">In [!INCLUDE[tsql](../../includes/tsql-md.md)]: Set transaction safety to FULL.</span></span> <span data-ttu-id="c75db-133">Para obter mais informações, consulte [Alterar a segurança da transação em uma sessão de espelhamento de banco de dados &#40;Transact-SQL&#41;](change-transaction-safety-in-a-database-mirroring-session-transact-sql.md)</span><span class="sxs-lookup"><span data-stu-id="c75db-133">For more information, see [Change Transaction Safety in a Database Mirroring Session &#40;Transact-SQL&#41;](change-transaction-safety-in-a-database-mirroring-session-transact-sql.md)</span></span>  
  
### <a name="to-remove-a-witness-from-a-session"></a><span data-ttu-id="c75db-134">Para remover uma testemunha de uma sessão</span><span class="sxs-lookup"><span data-stu-id="c75db-134">To remove a witness from a session</span></span>  
  
1.  <span data-ttu-id="c75db-135">Se a sessão de espelhamento envolver uma testemunha, recomendamos a remoção da testemunha antes de executar a atualização sem-interrupção.</span><span class="sxs-lookup"><span data-stu-id="c75db-135">If a mirroring session involves a witness, we recommend that you remove the witness before you perform a rolling upgrade.</span></span> <span data-ttu-id="c75db-136">Caso contrário, quando a instância do servidor espelho estiver sendo atualizada, a disponibilidade do banco de dados dependerá da testemunha que permanece conectada à instância do servidor principal.</span><span class="sxs-lookup"><span data-stu-id="c75db-136">Otherwise, when the mirror server instance is being upgraded, database availability depends on the witness that remains connected to the principal server instance.</span></span> <span data-ttu-id="c75db-137">Depois que remover uma testemunha, é possível atualizá-la a qualquer momento durante o processo de atualização sem-interrupção sem arriscar o tempo de inatividade do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="c75db-137">After you remove a witness, you can upgrade it at any time during the rolling upgrade process without risking database downtime.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="c75db-138">Para obter mais informações, confira [Quorum: Como uma testemunha afeta a disponibilidade do banco de dados &#40;Espelhamento de Banco de Dados&#41;](quorum-how-a-witness-affects-database-availability-database-mirroring.md).</span><span class="sxs-lookup"><span data-stu-id="c75db-138">For more information, see [Quorum: How a Witness Affects Database Availability &#40;Database Mirroring&#41;](quorum-how-a-witness-affects-database-availability-database-mirroring.md).</span></span>  
  
    -   [<span data-ttu-id="c75db-139">Remover a testemunha de uma sessão de espelhamento de banco de dados &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="c75db-139">Remove the Witness from a Database Mirroring Session &#40;SQL Server&#41;</span></span>](remove-the-witness-from-a-database-mirroring-session-sql-server.md)  
  
### <a name="to-perform-the-rolling-upgrade"></a><span data-ttu-id="c75db-140">Para executar a atualização sem-interrupção</span><span class="sxs-lookup"><span data-stu-id="c75db-140">To perform the rolling upgrade</span></span>  
  
1.  <span data-ttu-id="c75db-141">Para minimizar o tempo de inatividade, recomendamos o seguinte: inicie a atualização sem-interrupção atualizando qualquer parceiro de espelhamento que no momento seja o servidor espelho em todas as suas sessões de espelhamento.</span><span class="sxs-lookup"><span data-stu-id="c75db-141">To minimize downtime, we recommend the following: Start the rolling upgrade by updating any mirroring partner that is currently the mirror server in all its mirroring sessions.</span></span> <span data-ttu-id="c75db-142">Pode ser necessário atualizar várias instâncias do servidor neste momento.</span><span class="sxs-lookup"><span data-stu-id="c75db-142">You might have to update multiple server instances at this point.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="c75db-143">Uma testemunha pode ser atualizada em qualquer ponto do processo de atualização sem-interrupção.</span><span class="sxs-lookup"><span data-stu-id="c75db-143">A witness can be upgraded at any point in the rolling upgrade process.</span></span> <span data-ttu-id="c75db-144">Por exemplo, se uma instância do servidor for um servidor espelho na Sessão 1 e for uma testemunha na Sessão 2, será possível atualizar a instância do servidor agora.</span><span class="sxs-lookup"><span data-stu-id="c75db-144">For example, if a server instance is a mirror server in Session 1 and is a witness in Session 2, you can upgrade the server instance now.</span></span>  
  
     <span data-ttu-id="c75db-145">A instância do servidor a ser atualizada primeiro depende da configuração atual de suas sessões de espelhamento, como a seguir:</span><span class="sxs-lookup"><span data-stu-id="c75db-145">The server instance to upgrade first depends on the current configuration of your mirroring sessions, as follows:</span></span>  
  
    -   <span data-ttu-id="c75db-146">Se qualquer instância de servidor já for o servidor espelho em todas as suas sessões de espelhamento, atualize a instância de servidor para a nova versão.</span><span class="sxs-lookup"><span data-stu-id="c75db-146">If any server instance is already the mirror server in all its mirroring sessions, upgrade the server instance to the new version.</span></span>  
  
    -   <span data-ttu-id="c75db-147">Se todas as instâncias de servidor forem atualmente o servidor principal em quaisquer sessões de espelhamento, selecione uma instância de servidor para atualizar primeiro.</span><span class="sxs-lookup"><span data-stu-id="c75db-147">If all your server instances are currently the principal server in any mirroring sessions, select one server instance to upgrade first.</span></span> <span data-ttu-id="c75db-148">Em seguida, execute manualmente um failover em cada um de seus bancos de dados principais e atualize essa instância de servidor.</span><span class="sxs-lookup"><span data-stu-id="c75db-148">Then, manually fail over each of its principal databases and upgrade that server instance.</span></span>  
  
     <span data-ttu-id="c75db-149">Depois de ser atualizada, a instância do servidor retoma automaticamente cada uma das sessões de espelhamento.</span><span class="sxs-lookup"><span data-stu-id="c75db-149">After being upgraded, a server instance automatically rejoins each of its mirroring sessions.</span></span>  
  
2.  <span data-ttu-id="c75db-150">Em cada sessão de espelhamento cuja instância do servidor de espelho acabou de ser atualizada, aguarde a sessão ser sincronizada.</span><span class="sxs-lookup"><span data-stu-id="c75db-150">For each mirroring session whose mirror server instance has just been upgraded, wait for the session to synchronize.</span></span> <span data-ttu-id="c75db-151">Depois, conecte-se à instância do servidor principal e execute o failover manual na sessão.</span><span class="sxs-lookup"><span data-stu-id="c75db-151">Then, connect to the principal server instance, and manually fail over the session.</span></span> <span data-ttu-id="c75db-152">Em failover, a instância do servidor atualizada torna-se o servidor principal para aquela sessão e o servidor principal anterior torna-se o servidor espelho.</span><span class="sxs-lookup"><span data-stu-id="c75db-152">On failover, the upgraded server instance becomes the principal server for that session, and the former principal server becomes the mirror server.</span></span>  
  
     <span data-ttu-id="c75db-153">O objetivo dessa etapa é que outra instância do servidor torne-se o servidor espelho em cada sessão de espelhamento na qual é um parceiro.</span><span class="sxs-lookup"><span data-stu-id="c75db-153">The goal of this step is for another server instance to become the mirror server in every mirroring session in which it is a partner.</span></span>  
  
     <span data-ttu-id="c75db-154">**Restrições depois da execução de failover para uma instância de servidor atualizada.**</span><span class="sxs-lookup"><span data-stu-id="c75db-154">**Restrictions after you failover to an upgraded server instance.**</span></span>  
  
     <span data-ttu-id="c75db-155">Depois de executar failover de uma instância de servidor anterior para uma instância do servidor do [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] , a sessão de banco de dados é suspensa.</span><span class="sxs-lookup"><span data-stu-id="c75db-155">After failing over from an earlier server instance to a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] server instance, the database session is suspended.</span></span> <span data-ttu-id="c75db-156">Ela não pode ser retomada até que o outro parceiro seja atualizado.</span><span class="sxs-lookup"><span data-stu-id="c75db-156">It cannot be resumed until the other partner has been upgraded.</span></span> <span data-ttu-id="c75db-157">Porém, o servidor principal ainda aceita conexões e permite acesso a dados e modificações no banco de dados principal.</span><span class="sxs-lookup"><span data-stu-id="c75db-157">However, the principal server is still accepting connections and allowing data access and modifications on the principal database.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="c75db-158">O estabelecimento de uma nova sessão de espelhamento exige que todas as instâncias de servidor estejam executando a mesma versão do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c75db-158">Establishing a new mirroring session requires that the server instances all be running the same version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
3.  <span data-ttu-id="c75db-159">Após o failover, recomendamos que você execute o comando [DBCC CHECKDB](/sql/t-sql/database-console-commands/dbcc-checkdb-transact-sql) no banco de dados principal.</span><span class="sxs-lookup"><span data-stu-id="c75db-159">After you fail over, we recommend that you run the [DBCC CHECKDB](/sql/t-sql/database-console-commands/dbcc-checkdb-transact-sql) command on theprincipal database.</span></span>  
  
4.  <span data-ttu-id="c75db-160">Atualize cada instância de servidor que seja agora o servidor espelho em todas as sessões de espelhamento nas quais é um parceiro.</span><span class="sxs-lookup"><span data-stu-id="c75db-160">Upgrade each server instance that is now the mirror server in all mirroring sessions in which it is a partner.</span></span> <span data-ttu-id="c75db-161">Pode necessário atualizar vários servidores nesse momento.</span><span class="sxs-lookup"><span data-stu-id="c75db-161">You might have to update multiple servers at this point.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="c75db-162">Em uma configuração de espelhamento complexa, algumas instâncias do servidor podem ainda ser o servidor principal original em uma ou mais sessões de espelhamento.</span><span class="sxs-lookup"><span data-stu-id="c75db-162">In a complex mirroring configuration, some server instance might still be the original principal server in one or more mirroring sessions.</span></span> <span data-ttu-id="c75db-163">Repita as etapas 2 a 4 para essas instâncias do servidor até que todas as instâncias envolvidas sejam atualizadas.</span><span class="sxs-lookup"><span data-stu-id="c75db-163">Repeat steps 2-4 for those server instances until all instances involved are upgraded.</span></span>  
  
5.  <span data-ttu-id="c75db-164">Continue a sessão de espelhamento.</span><span class="sxs-lookup"><span data-stu-id="c75db-164">Resume the mirroring session.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="c75db-165">O failover automático não funcionará até que a testemunha tenha sido atualizada e novamente adicionada à sessão de espelhamento.</span><span class="sxs-lookup"><span data-stu-id="c75db-165">Automatic failover will not work until the witness has been upgraded and added back into the mirroring session.</span></span>  
  
6.  <span data-ttu-id="c75db-166">Atualize qualquer instância de servidor restante que seja a testemunha em todas as suas sessões de espelhamento.</span><span class="sxs-lookup"><span data-stu-id="c75db-166">Upgrade any remaining server instance that is the witness in all its mirroring sessions.</span></span> <span data-ttu-id="c75db-167">Depois que uma testemunha atualizada voltar a uma sessão de espelhamento, o failover automático torna-se possível novamente.</span><span class="sxs-lookup"><span data-stu-id="c75db-167">After an upgraded witness rejoins a mirroring session, automatic failover becomes possible again.</span></span> <span data-ttu-id="c75db-168">Pode necessário atualizar vários servidores nesse momento.</span><span class="sxs-lookup"><span data-stu-id="c75db-168">You might have to update multiple servers at this point.</span></span>  
  
### <a name="to-return-a-session-to-high-performance-mode"></a><span data-ttu-id="c75db-169">Para retornar a uma sessão em modo de alto desempenho</span><span class="sxs-lookup"><span data-stu-id="c75db-169">To return a session to high-performance mode</span></span>  
  
1.  <span data-ttu-id="c75db-170">Opcionalmente, retorne ao modo de alto desempenho usando um dos seguintes métodos:</span><span class="sxs-lookup"><span data-stu-id="c75db-170">Optionally, return to high-performance mode by using one of the following methods:</span></span>  
  
    -   <span data-ttu-id="c75db-171">Em [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]: altere a opção **Modo de operação** para **Alto desempenho (assíncrono)** usando a [página Espelhamento](../../relational-databases/databases/database-properties-mirroring-page.md) da caixa de diálogo **Propriedades do Banco de Dados** .</span><span class="sxs-lookup"><span data-stu-id="c75db-171">In [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]: Change the **Operating mode** option to **High performance (asynchronous)** by using the [Mirroring Page](../../relational-databases/databases/database-properties-mirroring-page.md) of the **Database Properties** dialog box.</span></span>  
  
    -   <span data-ttu-id="c75db-172">Em [!INCLUDE[tsql](../../includes/tsql-md.md)]: use [ALTER DATABASE](/sql/t-sql/statements/alter-database-transact-sql-database-mirroring)para definir a segurança de transações como OFF.</span><span class="sxs-lookup"><span data-stu-id="c75db-172">In [!INCLUDE[tsql](../../includes/tsql-md.md)]: Use [ALTER DATABASE](/sql/t-sql/statements/alter-database-transact-sql-database-mirroring)to set transaction safety to OFF.</span></span>  
  
### <a name="to-add-a-witness-back-into-a-mirroring-session"></a><span data-ttu-id="c75db-173">Para adicionar uma testemunha de volta a uma sessão de espelhamento</span><span class="sxs-lookup"><span data-stu-id="c75db-173">To add a witness back into a mirroring session</span></span>  
  
1.  <span data-ttu-id="c75db-174">Opcionalmente, em modo de segurança alta, restabeleça a testemunha para cada sessão de espelhamento.</span><span class="sxs-lookup"><span data-stu-id="c75db-174">Optionally, in high-safety mode, reestablish the witness to each mirroring session.</span></span>  
  
     <span data-ttu-id="c75db-175">**Para retornar uma testemunha**</span><span class="sxs-lookup"><span data-stu-id="c75db-175">**To return a witness**</span></span>  
  
    -   [<span data-ttu-id="c75db-176">Adicionar ou substituir uma testemunha de espelhamento de banco de dados &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="c75db-176">Add or Replace a Database Mirroring Witness &#40;SQL Server Management Studio&#41;</span></span>](add-or-replace-a-database-mirroring-witness-sql-server-management-studio.md)  
  
    -   [<span data-ttu-id="c75db-177">Adicionar uma testemunha de espelhamento de banco de dados usando a Autenticação do Windows &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="c75db-177">Add a Database Mirroring Witness Using Windows Authentication &#40;Transact-SQL&#41;</span></span>](add-a-database-mirroring-witness-using-windows-authentication-transact-sql.md)  
  
## <a name="see-also"></a><span data-ttu-id="c75db-178">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="c75db-178">See Also</span></span>  
 <span data-ttu-id="c75db-179">[Espelhamento de banco de dados ALTER DATABASE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql-database-mirroring) </span><span class="sxs-lookup"><span data-stu-id="c75db-179">[ALTER DATABASE Database Mirroring &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql-database-mirroring) </span></span>  
 <span data-ttu-id="c75db-180">[BACKUP &#40;Transact-SQL&#41;](/sql/t-sql/statements/backup-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="c75db-180">[BACKUP &#40;Transact-SQL&#41;](/sql/t-sql/statements/backup-transact-sql) </span></span>  
 <span data-ttu-id="c75db-181">[Exibir o estado de um banco de dados espelhado &#40;SQL Server Management Studio&#41;](view-the-state-of-a-mirrored-database-sql-server-management-studio.md) </span><span class="sxs-lookup"><span data-stu-id="c75db-181">[View the State of a Mirrored Database &#40;SQL Server Management Studio&#41;](view-the-state-of-a-mirrored-database-sql-server-management-studio.md) </span></span>  
 <span data-ttu-id="c75db-182">[Espelhamento de banco de dados &#40;SQL Server&#41;](database-mirroring-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="c75db-182">[Database Mirroring &#40;SQL Server&#41;](database-mirroring-sql-server.md) </span></span>  
 <span data-ttu-id="c75db-183">[Instalar um Service Pack em um sistema com tempo de inatividade mínimo para bancos de dados espelhados](../install-a-service-pack-on-a-system-with-minimal-downtime-for-mirrored-databases.md) </span><span class="sxs-lookup"><span data-stu-id="c75db-183">[Install a Service Pack on a System with Minimal Downtime for Mirrored Databases](../install-a-service-pack-on-a-system-with-minimal-downtime-for-mirrored-databases.md) </span></span>  
 <span data-ttu-id="c75db-184">[Troca de função durante uma sessão de espelhamento de banco de dados &#40;SQL Server&#41;](role-switching-during-a-database-mirroring-session-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="c75db-184">[Role Switching During a Database Mirroring Session &#40;SQL Server&#41;](role-switching-during-a-database-mirroring-session-sql-server.md) </span></span>  
 <span data-ttu-id="c75db-185">[Forçar o serviço em uma sessão de espelhamento de banco de dados &#40;Transact-SQL&#41;](force-service-in-a-database-mirroring-session-transact-sql.md) </span><span class="sxs-lookup"><span data-stu-id="c75db-185">[Force Service in a Database Mirroring Session &#40;Transact-SQL&#41;](force-service-in-a-database-mirroring-session-transact-sql.md) </span></span>  
 <span data-ttu-id="c75db-186">[Iniciar o Monitor de Espelhamento de Banco de Dados &#40;SQL Server Management Studio&#41;](start-database-mirroring-monitor-sql-server-management-studio.md) </span><span class="sxs-lookup"><span data-stu-id="c75db-186">[Start Database Mirroring Monitor &#40;SQL Server Management Studio&#41;](start-database-mirroring-monitor-sql-server-management-studio.md) </span></span>  
 [<span data-ttu-id="c75db-187">Modos de operação de espelhamento de banco de dados</span><span class="sxs-lookup"><span data-stu-id="c75db-187">Database Mirroring Operating Modes</span></span>](database-mirroring-operating-modes.md)  
  
  
