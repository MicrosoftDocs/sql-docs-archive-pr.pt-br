---
title: Adaptador de Nuvem para SQL Server | Microsoft Docs
ms.custom: ''
ms.date: 03/09/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: database-engine
ms.topic: conceptual
helpviewer_keywords:
- Cloud adapter
- Deploy to Azure
ms.assetid: 82ed0d0f-952d-4d49-aa36-3855a3ca9877
author: mashamsft
ms.author: mathoma
ms.openlocfilehash: d5716435bb1db494bdabeb45ed366c1783926989
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87575367"
---
# <a name="cloud-adapter-for-sql-server"></a><span data-ttu-id="b8e42-102">Adaptador de nuvem para SQL Server</span><span class="sxs-lookup"><span data-stu-id="b8e42-102">Cloud Adapter for SQL Server</span></span>
  <span data-ttu-id="b8e42-103">O serviço de Adaptador de Nuvem é criado como parte do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] provisionamento em uma VM do Azure.</span><span class="sxs-lookup"><span data-stu-id="b8e42-103">The Cloud Adapter service is created as part of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] provisioning on an Azure VM.</span></span> <span data-ttu-id="b8e42-104">O serviço de Adaptador de Nuvem gera um certificado SSL autoassinado como parte da sua primeira execução e é executado como uma conta **Sistema Local** .</span><span class="sxs-lookup"><span data-stu-id="b8e42-104">The Cloud Adapter service generates a self-signed SSL certificate as part of its first run, and then runs as a **Local System** account.</span></span> <span data-ttu-id="b8e42-105">Ele gera um arquivo de configuração que é usado para autoconfiguração.</span><span class="sxs-lookup"><span data-stu-id="b8e42-105">It generates a configuration file that is used to configure itself.</span></span> <span data-ttu-id="b8e42-106">O adaptador de nuvem também cria uma regra do Firewall do Windows para permitir suas conexões TCP de entrada na porta padrão 11435.</span><span class="sxs-lookup"><span data-stu-id="b8e42-106">The Cloud Adapter also creates a Windows Firewall rule to allow its incoming TCP connections at default port 11435.</span></span>  
  
 <span data-ttu-id="b8e42-107">O Adaptador de Nuvem é um serviço síncrono sem monitoração de estado que recebe mensagens da instância local do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b8e42-107">The Cloud Adapter is a stateless, synchronous service that receives messages from the on-premise instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="b8e42-108">Quando o serviço de Adaptador de Nuvem é interrompido, ele interrompe o Adaptador de Nuvem de acesso remoto, desassocia o certificado SSL e desabilita a regra de Firewall do Windows.</span><span class="sxs-lookup"><span data-stu-id="b8e42-108">When the Cloud Adapter service is stopped, it stops the remote access Cloud Adapter, unbinds the SSL certificate, and disables the Windows Firewall rule.</span></span>  
  
## <a name="cloud-adapter-requirements"></a><span data-ttu-id="b8e42-109">Requisitos do Adaptador de Nuvem</span><span class="sxs-lookup"><span data-stu-id="b8e42-109">Cloud Adapter Requirements</span></span>  
 <span data-ttu-id="b8e42-110">Observe os requisitos a seguir para instalação, habilitação e execução do Adaptador de Nuvem para o [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]:</span><span class="sxs-lookup"><span data-stu-id="b8e42-110">Note the following requirements to install, enable, and run the Cloud Adapter for [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]:</span></span>  
  
-   <span data-ttu-id="b8e42-111">O Adaptador de Nuvem tem suporte com o [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 2012 e superior.</span><span class="sxs-lookup"><span data-stu-id="b8e42-111">Cloud Adapter is supported with [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 2012 and higher.</span></span> <span data-ttu-id="b8e42-112">No [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 2012, o Adaptador de Nuvem para [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] exige SQL Management Objects para [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 2012.</span><span class="sxs-lookup"><span data-stu-id="b8e42-112">On [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 2012, the Cloud Adapter for [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] requires SQL Management Objects for [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 2012.</span></span>  
  
-   <span data-ttu-id="b8e42-113">O serviço Web do Adaptador de Nuvem é executado como uma conta **Sistema Local** e verifica as credenciais do cliente antes de executar qualquer tarefa.</span><span class="sxs-lookup"><span data-stu-id="b8e42-113">Cloud Adapter web service runs as a **Local System** account and verifies client credentials before executing any task.</span></span> <span data-ttu-id="b8e42-114">As credenciais fornecidas pelo cliente devem pertencer à conta de uso que seja membro do grupo local de **Administradores** no computador remoto.</span><span class="sxs-lookup"><span data-stu-id="b8e42-114">Credentials supplied by the client must belong to the use account that is a member of the local **Administrators** group on the remote machine.</span></span>  
  
-   <span data-ttu-id="b8e42-115">O Adaptador de Nuvem oferece suporte somente à Autenticação do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="b8e42-115">Cloud Adapter supports only [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Authentication.</span></span>  
  
-   <span data-ttu-id="b8e42-116">O Adaptador de Nuvem usa a conta do administrador local da VM para executar comandos no computador local, e não uma conta sa.</span><span class="sxs-lookup"><span data-stu-id="b8e42-116">Cloud Adapter uses VM local administrator account to execute commands on the local machine, not an sa account.</span></span>  
  
-   <span data-ttu-id="b8e42-117">O Adaptador de Nuvem escuta em TCP/IP.</span><span class="sxs-lookup"><span data-stu-id="b8e42-117">Cloud Adapter listens on TCP/IP.</span></span> <span data-ttu-id="b8e42-118">A porta padrão é 11435.</span><span class="sxs-lookup"><span data-stu-id="b8e42-118">The default port is 11435.</span></span>  
  
-   <span data-ttu-id="b8e42-119">O Adaptador de Nuvem deve ter permissões para criar e modificar regras de Firewall do Windows.</span><span class="sxs-lookup"><span data-stu-id="b8e42-119">Cloud Adapter must have permissions to create and modify Windows Firewall rules.</span></span>  
  
## <a name="cloud-adapter-configuration-settings"></a><span data-ttu-id="b8e42-120">Definições de configuração do Adaptador de Nuvem</span><span class="sxs-lookup"><span data-stu-id="b8e42-120">Cloud Adapter Configuration Settings</span></span>  
 <span data-ttu-id="b8e42-121">Use os detalhes de configuração a seguir para modificar as configurações de um Adaptador de Nuvem.</span><span class="sxs-lookup"><span data-stu-id="b8e42-121">Use the following Cloud Adapter configuration details to modify settings for a Cloud Adapter.</span></span>  
  
-   <span data-ttu-id="b8e42-122">**Caminho padrão para o arquivo de configuração** -C:\Arquivos de Programas\microsoft SQL Server\120\Tools\CloudAdapter</span><span class="sxs-lookup"><span data-stu-id="b8e42-122">**Default path for the configuration file** - C:\Program Files\Microsoft SQL Server\120\Tools\CloudAdapter</span></span>\  
  
-   <span data-ttu-id="b8e42-123">**Parâmetros do arquivo de configuração** -</span><span class="sxs-lookup"><span data-stu-id="b8e42-123">**Configuration file parameters** -</span></span>  
  
    -   \<configuration>  
  
        -   \<appSettings>  
  
            -   \<add key="WebServicePort" value="" />  
  
            -   \<add key="WebServiceCertificate" value="GUID" />  
  
            -   \<add key="ExposeExceptionDetails" value="true" />  
  
        -   \</appSettings>  
  
    -   \</configuration>  
  
-   <span data-ttu-id="b8e42-124">**Detalhes do certificado** -o certificado tem os seguintes valores:</span><span class="sxs-lookup"><span data-stu-id="b8e42-124">**Certificate details** - The certificate has the following values:</span></span>  
  
    -   <span data-ttu-id="b8e42-125">Subject-"CN = CloudAdapter \<VMName> , DC = SQL Server, DC = Microsoft"</span><span class="sxs-lookup"><span data-stu-id="b8e42-125">Subject - "CN=CloudAdapter\<VMName>, DC=SQL Server, DC=Microsoft"</span></span>  
  
    -   <span data-ttu-id="b8e42-126">O certificado deve ter somente o EKU da Autenticação do Servidor habilitado.</span><span class="sxs-lookup"><span data-stu-id="b8e42-126">The certificate should have only Server Authentication EKU enabled.</span></span>  
  
    -   <span data-ttu-id="b8e42-127">O comprimento da chave do certificado é de 2048.</span><span class="sxs-lookup"><span data-stu-id="b8e42-127">The certificate key length is 2048.</span></span>  
  
 <span data-ttu-id="b8e42-128">**Valores do arquivo de configuração**:</span><span class="sxs-lookup"><span data-stu-id="b8e42-128">**Configuration file values**:</span></span>  
  
|<span data-ttu-id="b8e42-129">Setting</span><span class="sxs-lookup"><span data-stu-id="b8e42-129">Setting</span></span>|<span data-ttu-id="b8e42-130">Valores</span><span class="sxs-lookup"><span data-stu-id="b8e42-130">Values</span></span>|<span data-ttu-id="b8e42-131">Padrão</span><span class="sxs-lookup"><span data-stu-id="b8e42-131">Default</span></span>|<span data-ttu-id="b8e42-132">Comentários</span><span class="sxs-lookup"><span data-stu-id="b8e42-132">Comments</span></span>|  
|-------------|------------|-------------|--------------|  
|<span data-ttu-id="b8e42-133">WebServicePort</span><span class="sxs-lookup"><span data-stu-id="b8e42-133">WebServicePort</span></span>|<span data-ttu-id="b8e42-134">1-65535</span><span class="sxs-lookup"><span data-stu-id="b8e42-134">1-65535</span></span>|<span data-ttu-id="b8e42-135">11435</span><span class="sxs-lookup"><span data-stu-id="b8e42-135">11435</span></span>|<span data-ttu-id="b8e42-136">Se não for especificada, use 11435.</span><span class="sxs-lookup"><span data-stu-id="b8e42-136">If not specified, use 11435.</span></span>|  
|<span data-ttu-id="b8e42-137">WebServiceCertificate</span><span class="sxs-lookup"><span data-stu-id="b8e42-137">WebServiceCertificate</span></span>|<span data-ttu-id="b8e42-138">Impressão digital</span><span class="sxs-lookup"><span data-stu-id="b8e42-138">Thumbprint</span></span>|<span data-ttu-id="b8e42-139">Vazio</span><span class="sxs-lookup"><span data-stu-id="b8e42-139">Empty</span></span>|<span data-ttu-id="b8e42-140">Se estiver vazio, um novo certificado autoassinado será gerado.</span><span class="sxs-lookup"><span data-stu-id="b8e42-140">If empty, a new self-signed certificate is generated.</span></span>|  
|<span data-ttu-id="b8e42-141">ExposeExceptionDetails</span><span class="sxs-lookup"><span data-stu-id="b8e42-141">ExposeExceptionDetails</span></span>|<span data-ttu-id="b8e42-142">Verdadeiro/Falso</span><span class="sxs-lookup"><span data-stu-id="b8e42-142">True/False</span></span>|<span data-ttu-id="b8e42-143">Falso</span><span class="sxs-lookup"><span data-stu-id="b8e42-143">False</span></span>||  
  
## <a name="cloud-adapter-troubleshooting"></a><span data-ttu-id="b8e42-144">Solução de problemas do Adaptador de Nuvem</span><span class="sxs-lookup"><span data-stu-id="b8e42-144">Cloud Adapter Troubleshooting</span></span>  
 <span data-ttu-id="b8e42-145">Use as informações a seguir para solucionar problemas do Adaptador de Nuvem para o [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]:</span><span class="sxs-lookup"><span data-stu-id="b8e42-145">Use the following information to troubleshoot the Cloud Adapter for [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]:</span></span>  
  
-   <span data-ttu-id="b8e42-146">**Tratamento de erros e registro em log** – erros e mensagens de status são gravados no log de eventos do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="b8e42-146">**Error handling and logging** - Errors and status messages are written to the Application Event Log.</span></span>  
  
-   <span data-ttu-id="b8e42-147">**Rastreamento, eventos** – todos os eventos são gravados no log de eventos do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="b8e42-147">**Tracing, Events** - All events are written to the Application Event Log.</span></span>  
  
-   <span data-ttu-id="b8e42-148">**Controle, configuração** -use o arquivo de configuração localizado em: C:\Arquivos de Programas\microsoft SQL Server\120\Tools\CloudAdapter \\ .</span><span class="sxs-lookup"><span data-stu-id="b8e42-148">**Control, configuration** - Use the configuration file located in:  C:\Program Files\Microsoft SQL Server\120\Tools\CloudAdapter\\.</span></span>  
  
|<span data-ttu-id="b8e42-149">Erro</span><span class="sxs-lookup"><span data-stu-id="b8e42-149">Error</span></span>|<span data-ttu-id="b8e42-150">ID do erro</span><span class="sxs-lookup"><span data-stu-id="b8e42-150">Error ID</span></span>|<span data-ttu-id="b8e42-151">Causa</span><span class="sxs-lookup"><span data-stu-id="b8e42-151">Cause</span></span>|<span data-ttu-id="b8e42-152">Resolução</span><span class="sxs-lookup"><span data-stu-id="b8e42-152">Resolution</span></span>|  
|-----------|--------------|-----------|----------------|  
|<span data-ttu-id="b8e42-153">Houve uma exceção ao adicionar o certificado ao repositório de certificados.</span><span class="sxs-lookup"><span data-stu-id="b8e42-153">There was an exception while adding the certificate to the certificate store.</span></span> <span data-ttu-id="b8e42-154">{Texto da exceção}.</span><span class="sxs-lookup"><span data-stu-id="b8e42-154">{Exception text}.</span></span>|<span data-ttu-id="b8e42-155">45560</span><span class="sxs-lookup"><span data-stu-id="b8e42-155">45560</span></span>|<span data-ttu-id="b8e42-156">Permissões do repositório de certificados do computador</span><span class="sxs-lookup"><span data-stu-id="b8e42-156">Machine certificate store permissions</span></span>|<span data-ttu-id="b8e42-157">Verifique se o serviço de Adaptador de Nuvem tem permissões para adicionar certificados ao repositório de certificados do computador.</span><span class="sxs-lookup"><span data-stu-id="b8e42-157">Ensure that the Cloud Adapter service has permissions to add certificates to the machine certificate store.</span></span>|  
|<span data-ttu-id="b8e42-158">Houve uma exceção ao tentar configurar a associação SSL para a porta {número da porta} e o certificado {impressão digital}.</span><span class="sxs-lookup"><span data-stu-id="b8e42-158">There was an exception while trying to configure the SSL binding for port {Port number} and certificate {Thumbprint}.</span></span> <span data-ttu-id="b8e42-159">{Exceção}.</span><span class="sxs-lookup"><span data-stu-id="b8e42-159">{Exception}.</span></span>|<span data-ttu-id="b8e42-160">45561</span><span class="sxs-lookup"><span data-stu-id="b8e42-160">45561</span></span>|<span data-ttu-id="b8e42-161">Outro aplicativo já usou a porta ou associou um certificado a ela.</span><span class="sxs-lookup"><span data-stu-id="b8e42-161">Another application has already used the port or bound a certificate to it.</span></span>|<span data-ttu-id="b8e42-162">Remova as associações existentes ou altere a porta do Adaptador de Nuvem no arquivo de configuração.</span><span class="sxs-lookup"><span data-stu-id="b8e42-162">Remove existing bindings or change Cloud Adapter port in the configuration file.</span></span>|  
|<span data-ttu-id="b8e42-163">Falha ao localizar o certificado SSL [{Impressão digital}] no repositório de certificados.</span><span class="sxs-lookup"><span data-stu-id="b8e42-163">Failed to find SSL certificate [{Thumbprint}] in the certificate store.</span></span>|<span data-ttu-id="b8e42-164">45564</span><span class="sxs-lookup"><span data-stu-id="b8e42-164">45564</span></span>|<span data-ttu-id="b8e42-165">A impressão digital do certificado está no arquivo de configuração, mas o repositório de certificados pessoal para o serviço não contém certificados.</span><span class="sxs-lookup"><span data-stu-id="b8e42-165">Certificate thumbprint is in the configuration file, but personal certificate store for the service does not contain certificate.</span></span><br /><br /> <span data-ttu-id="b8e42-166">Permissões insuficientes</span><span class="sxs-lookup"><span data-stu-id="b8e42-166">Insufficient permissions.</span></span>|<span data-ttu-id="b8e42-167">Verifique se o certificado está no repositório de certificados pessoal do serviço.</span><span class="sxs-lookup"><span data-stu-id="b8e42-167">Make sure the certificate is in the personal certificate store for the service.</span></span><br /><br /> <span data-ttu-id="b8e42-168">Verifique se o serviço tem as permissões corretas para o repositório.</span><span class="sxs-lookup"><span data-stu-id="b8e42-168">Make sure the service has correct permissions for the store.</span></span>|  
|<span data-ttu-id="b8e42-169">Falha ao iniciar o serviço Web.</span><span class="sxs-lookup"><span data-stu-id="b8e42-169">Failed to start the web service.</span></span> <span data-ttu-id="b8e42-170">{Texto da exceção}.</span><span class="sxs-lookup"><span data-stu-id="b8e42-170">{Exception text}.</span></span>|<span data-ttu-id="b8e42-171">45570</span><span class="sxs-lookup"><span data-stu-id="b8e42-171">45570</span></span>|<span data-ttu-id="b8e42-172">Descrito na exceção.</span><span class="sxs-lookup"><span data-stu-id="b8e42-172">Described in the exception.</span></span>|<span data-ttu-id="b8e42-173">Habilite ExposeExceptionDetails e use as informações estendidas da exceção.</span><span class="sxs-lookup"><span data-stu-id="b8e42-173">Enable ExposeExceptionDetails and use extended information from the exception.</span></span>|  
|<span data-ttu-id="b8e42-174">O certificado [{Impressão digital}] expirou.</span><span class="sxs-lookup"><span data-stu-id="b8e42-174">Certificate [{Thumbprint}] has expired.</span></span>|<span data-ttu-id="b8e42-175">45565</span><span class="sxs-lookup"><span data-stu-id="b8e42-175">45565</span></span>|<span data-ttu-id="b8e42-176">Certificado expirado fazia referência do arquivo de configuração.</span><span class="sxs-lookup"><span data-stu-id="b8e42-176">Expired certificate referenced from the configuration file.</span></span>|<span data-ttu-id="b8e42-177">Adicione um certificado válido e atualize o arquivo de configuração com a respectiva impressão digital.</span><span class="sxs-lookup"><span data-stu-id="b8e42-177">Add a valid certificate and update the configuration file with its thumbprint.</span></span>|  
|<span data-ttu-id="b8e42-178">Erro do serviço Web: {0} .</span><span class="sxs-lookup"><span data-stu-id="b8e42-178">Web service error: {0}.</span></span>|<span data-ttu-id="b8e42-179">45571</span><span class="sxs-lookup"><span data-stu-id="b8e42-179">45571</span></span>|<span data-ttu-id="b8e42-180">Descrito na exceção.</span><span class="sxs-lookup"><span data-stu-id="b8e42-180">Described in the exception.</span></span>|<span data-ttu-id="b8e42-181">Habilite ExposeExceptionDetails e use as informações estendidas da exceção.</span><span class="sxs-lookup"><span data-stu-id="b8e42-181">Enable ExposeExceptionDetails and use extended information from the exception.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="b8e42-182">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="b8e42-182">See Also</span></span>  
 [<span data-ttu-id="b8e42-183">Implantar um banco de dados do SQL Server em uma máquina virtual do Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="b8e42-183">Deploy a SQL Server Database to a Microsoft Azure Virtual Machine</span></span>](../relational-databases/databases/deploy-a-sql-server-database-to-a-microsoft-azure-virtual-machine.md)  
  
  
