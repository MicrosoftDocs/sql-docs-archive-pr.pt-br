---
title: Trabalhar programaticamente com gerenciadores de conexões | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: reference
helpviewer_keywords:
- connection managers [Integration Services], programming
ms.assetid: 2686fe84-1ecc-48b8-9160-e7122274bd84
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 01fc61a4a5c85366c7af8c5c68a73777049d3cba
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87575899"
---
# <a name="working-with-connection-managers-programmatically"></a><span data-ttu-id="b0235-102">Trabalhando programaticamente com gerenciadores de conexões</span><span class="sxs-lookup"><span data-stu-id="b0235-102">Working with Connection Managers Programmatically</span></span>
  <span data-ttu-id="b0235-103">No [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)], o método AcquireConnection da classe do gerenciador de conexões associado é o método chamado com maior frequência quando você trabalha com gerenciadores de conexões em código gerenciado.</span><span class="sxs-lookup"><span data-stu-id="b0235-103">In [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)], the AcquireConnection method of the associated connection manager class is the method that you call most often when you are working with connection managers in managed code.</span></span> <span data-ttu-id="b0235-104">Ao escrever código gerenciado, chame o método AcquireConnection para usar a funcionalidade de um gerenciador de conexões.</span><span class="sxs-lookup"><span data-stu-id="b0235-104">When you write managed code, you have to call the AcquireConnection method to use the functionality of a connection manager.</span></span> <span data-ttu-id="b0235-105">Chame esse método independentemente de estar escrevendo o código gerenciado em uma tarefa Script, em um componente Script, em um objeto personalizado ou em uma aplicação personalizada.</span><span class="sxs-lookup"><span data-stu-id="b0235-105">You have to call this method regardless of whether you are writing managed code in a Script task, Script component, custom object, or custom application.</span></span>  
  
 <span data-ttu-id="b0235-106">Para chamar o método AcquireConnection com êxito, você precisa saber as respostas para as seguintes perguntas:</span><span class="sxs-lookup"><span data-stu-id="b0235-106">To call the AcquireConnection method successfully, you have to know the answers to the following questions:</span></span>  
  
-   <span data-ttu-id="b0235-107">**Quais gerenciadores de conexões retornam um objeto gerenciado do método AcquireConnection?**</span><span class="sxs-lookup"><span data-stu-id="b0235-107">**Which connection managers return a managed object from the AcquireConnection method?**</span></span>  
  
     <span data-ttu-id="b0235-108">Muitos gerenciadores de conexões retornam objetos COM não gerenciados (System.__ComObject) e esses objetos não podem ser usados com facilidade por meio do código gerenciado.</span><span class="sxs-lookup"><span data-stu-id="b0235-108">Many connection managers return unmanaged COM objects (System.__ComObject) and these objects cannot easily be used from managed code.</span></span> <span data-ttu-id="b0235-109">A lista desses gerenciadores de conexões inclui o OLE DB, que é usado com frequência.</span><span class="sxs-lookup"><span data-stu-id="b0235-109">The list of these connection managers includes the frequently used OLE DB connection manager.</span></span>  
  
-   <span data-ttu-id="b0235-110">**Que objetos são retornados pelos métodos AcquireConnection dos gerenciadores de conexões que retornam um objeto gerenciado?**</span><span class="sxs-lookup"><span data-stu-id="b0235-110">**For those connection managers that return a managed object, what objects do their AcquireConnection methods return?**</span></span>  
  
     <span data-ttu-id="b0235-111">Para converter o valor retornado no tipo apropriado, você precisa saber que tipo de objeto é retornado pelo método AcquireConnection.</span><span class="sxs-lookup"><span data-stu-id="b0235-111">To cast the return value to the appropriate type, you have to know what type of object the AcquireConnection method returns.</span></span> <span data-ttu-id="b0235-112">Por exemplo, o método AcquireConnection do gerenciador de conexões [!INCLUDE[vstecado](../includes/vstecado-md.md)] retorna um objeto aberto do SqlConnection quando você usa o provedor SqlClient.</span><span class="sxs-lookup"><span data-stu-id="b0235-112">For example, the AcquireConnection method for the [!INCLUDE[vstecado](../includes/vstecado-md.md)] connection manager returns an open SqlConnection object when you use the SqlClient provider.</span></span> <span data-ttu-id="b0235-113">Porém, o método AcquireConnection do gerenciador de conexões do arquivo só retorna uma cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="b0235-113">However, the AcquireConnection method for the File connection manager just returns a string.</span></span>  
  
 <span data-ttu-id="b0235-114">Este tópico responde a essas perguntas para os gerenciadores de conexões incluídos no [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b0235-114">This topic answers these questions for the connection managers that are included with [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)].</span></span>  
  
## <a name="connection-managers-that-do-not-return-a-managed-object"></a><span data-ttu-id="b0235-115">Gerenciadores de conexões que não retornam um objeto gerenciado</span><span class="sxs-lookup"><span data-stu-id="b0235-115">Connection Managers That Do Not Return a Managed Object</span></span>  
 <span data-ttu-id="b0235-116">A tabela a seguir lista os gerenciadores de conexões que retornam um objeto COM nativo (System.__ComObject) do método AcquireConnection.</span><span class="sxs-lookup"><span data-stu-id="b0235-116">The following table lists the connection managers that return a native COM object (System.__ComObject) from the AcquireConnection method.</span></span> <span data-ttu-id="b0235-117">Esses objetos não gerenciados não podem ser usados facilmente pelo código gerenciado.</span><span class="sxs-lookup"><span data-stu-id="b0235-117">These unmanaged objects cannot easily be used from managed code.</span></span>  
  
|<span data-ttu-id="b0235-118">Tipo do gerenciador de conexões</span><span class="sxs-lookup"><span data-stu-id="b0235-118">Connection Manager Type</span></span>|<span data-ttu-id="b0235-119">Nome do gerenciador de conexões</span><span class="sxs-lookup"><span data-stu-id="b0235-119">Connection Manager Name</span></span>|  
|-----------------------------|-----------------------------|  
|<span data-ttu-id="b0235-120">ADO</span><span class="sxs-lookup"><span data-stu-id="b0235-120">ADO</span></span>|<span data-ttu-id="b0235-121">Gerenciador de conexões ADO</span><span class="sxs-lookup"><span data-stu-id="b0235-121">ADO Connection Manager</span></span>|  
|<span data-ttu-id="b0235-122">MSOLAP90</span><span class="sxs-lookup"><span data-stu-id="b0235-122">MSOLAP90</span></span>|<span data-ttu-id="b0235-123">Gerenciador de conexões [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)]</span><span class="sxs-lookup"><span data-stu-id="b0235-123">[!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] Connection Manager</span></span>|  
|<span data-ttu-id="b0235-124">EXCEL</span><span class="sxs-lookup"><span data-stu-id="b0235-124">EXCEL</span></span>|<span data-ttu-id="b0235-125">Gerenciador de conexões do Excel</span><span class="sxs-lookup"><span data-stu-id="b0235-125">Excel Connection Manager</span></span>|  
|<span data-ttu-id="b0235-126">FTP</span><span class="sxs-lookup"><span data-stu-id="b0235-126">FTP</span></span>|<span data-ttu-id="b0235-127">Gerenciador de conexões FTP</span><span class="sxs-lookup"><span data-stu-id="b0235-127">FTP Connection Manager</span></span>|  
|<span data-ttu-id="b0235-128">HTTP</span><span class="sxs-lookup"><span data-stu-id="b0235-128">HTTP</span></span>|<span data-ttu-id="b0235-129">Gerenciador de conexões HTTP</span><span class="sxs-lookup"><span data-stu-id="b0235-129">HTTP Connection Manager</span></span>|  
|<span data-ttu-id="b0235-130">ODBCODBC</span><span class="sxs-lookup"><span data-stu-id="b0235-130">ODBC</span></span>|<span data-ttu-id="b0235-131">gerenciador de conexões ODBC</span><span class="sxs-lookup"><span data-stu-id="b0235-131">ODBC Connection Manager</span></span>|  
|<span data-ttu-id="b0235-132">OLEDB</span><span class="sxs-lookup"><span data-stu-id="b0235-132">OLEDB</span></span>|<span data-ttu-id="b0235-133">gerenciador de conexões OLE DB</span><span class="sxs-lookup"><span data-stu-id="b0235-133">OLE DB Connection Manager</span></span>|  
  
 <span data-ttu-id="b0235-134">Em geral, você pode usar um gerenciador de conexões [!INCLUDE[vstecado](../includes/vstecado-md.md)] de código gerenciado para se conectar a um ADO, Excel, ODBC ou fonte de dados OLE DB.</span><span class="sxs-lookup"><span data-stu-id="b0235-134">Typically, you can use an [!INCLUDE[vstecado](../includes/vstecado-md.md)] connection manager from managed code to connect to an ADO, Excel, ODBC, or OLE DB data source.</span></span>  
  
## <a name="return-values-from-the-acquireconnection-method"></a><span data-ttu-id="b0235-135">Valores de retorno do método AcquireConnection</span><span class="sxs-lookup"><span data-stu-id="b0235-135">Return Values from the AcquireConnection Method</span></span>  
 <span data-ttu-id="b0235-136">A tabela a seguir lista os gerenciadores de conexões que retornam um objeto gerenciado do método AcquireConnection.</span><span class="sxs-lookup"><span data-stu-id="b0235-136">The following table lists the connection managers that return a managed object from the AcquireConnection method.</span></span> <span data-ttu-id="b0235-137">Esses objetos gerenciados podem ser usados facilmente pelo código gerenciado.</span><span class="sxs-lookup"><span data-stu-id="b0235-137">These managed objects can easily be used from managed code.</span></span>  
  
|<span data-ttu-id="b0235-138">Tipo do gerenciador de conexões</span><span class="sxs-lookup"><span data-stu-id="b0235-138">Connection Manager Type</span></span>|<span data-ttu-id="b0235-139">Nome do gerenciador de conexões</span><span class="sxs-lookup"><span data-stu-id="b0235-139">Connection Manager Name</span></span>|<span data-ttu-id="b0235-140">Tipo de valor de retorno</span><span class="sxs-lookup"><span data-stu-id="b0235-140">Type of Return Value</span></span>|<span data-ttu-id="b0235-141">Informações adicionais</span><span class="sxs-lookup"><span data-stu-id="b0235-141">Additional Information</span></span>|  
|-----------------------------|-----------------------------|--------------------------|----------------------------|  
|[!INCLUDE[vstecado](../includes/vstecado-md.md)]|<span data-ttu-id="b0235-142">Gerenciador de conexões [!INCLUDE[vstecado](../includes/vstecado-md.md)]</span><span class="sxs-lookup"><span data-stu-id="b0235-142">[!INCLUDE[vstecado](../includes/vstecado-md.md)] Connection Manager</span></span>|`System.Data.SqlClient.SqlConnection`||  
|<span data-ttu-id="b0235-143">FILE</span><span class="sxs-lookup"><span data-stu-id="b0235-143">FILE</span></span>|<span data-ttu-id="b0235-144">Gerenciador de conexões de arquivos</span><span class="sxs-lookup"><span data-stu-id="b0235-144">File Connection Manager</span></span>|`System.String`|<span data-ttu-id="b0235-145">Caminho para o arquivo.</span><span class="sxs-lookup"><span data-stu-id="b0235-145">Path to the file.</span></span>|  
|<span data-ttu-id="b0235-146">FLATFILE</span><span class="sxs-lookup"><span data-stu-id="b0235-146">FLATFILE</span></span>|<span data-ttu-id="b0235-147">Gerenciador de conexões de arquivos simples</span><span class="sxs-lookup"><span data-stu-id="b0235-147">Flat File Connection Manager</span></span>|`System.String`|<span data-ttu-id="b0235-148">Caminho para o arquivo.</span><span class="sxs-lookup"><span data-stu-id="b0235-148">Path to the file.</span></span>|  
|<span data-ttu-id="b0235-149">MSMQ</span><span class="sxs-lookup"><span data-stu-id="b0235-149">MSMQ</span></span>|<span data-ttu-id="b0235-150">Gerenciador de conexões MSMQ</span><span class="sxs-lookup"><span data-stu-id="b0235-150">MSMQ Connection Manager</span></span>|`System.Messaging.MessageQueue`||  
|<span data-ttu-id="b0235-151">MULTIFILE</span><span class="sxs-lookup"><span data-stu-id="b0235-151">MULTIFILE</span></span>|<span data-ttu-id="b0235-152">Gerenciador de conexões de vários arquivos</span><span class="sxs-lookup"><span data-stu-id="b0235-152">Multiple Files Connection Manager</span></span>|`System.String`|<span data-ttu-id="b0235-153">Caminho para um dos arquivos.</span><span class="sxs-lookup"><span data-stu-id="b0235-153">Path to one of the files.</span></span>|  
|<span data-ttu-id="b0235-154">MULTIFLATFILE</span><span class="sxs-lookup"><span data-stu-id="b0235-154">MULTIFLATFILE</span></span>|<span data-ttu-id="b0235-155">Gerenciador de conexões de vários arquivos simples</span><span class="sxs-lookup"><span data-stu-id="b0235-155">Multiple Flat Files Connection Manager</span></span>|`System.String`|<span data-ttu-id="b0235-156">Caminho para um dos arquivos.</span><span class="sxs-lookup"><span data-stu-id="b0235-156">Path to one of the files.</span></span>|  
|<span data-ttu-id="b0235-157">SMOServer</span><span class="sxs-lookup"><span data-stu-id="b0235-157">SMOServer</span></span>|<span data-ttu-id="b0235-158">gerenciador de conexões SMO</span><span class="sxs-lookup"><span data-stu-id="b0235-158">SMO Connection Manager</span></span>|`Microsoft.SqlServer.Management.Smo.Server`||  
|<span data-ttu-id="b0235-159">SMTP</span><span class="sxs-lookup"><span data-stu-id="b0235-159">SMTP</span></span>|<span data-ttu-id="b0235-160">Gerenciador de conexões SMTP</span><span class="sxs-lookup"><span data-stu-id="b0235-160">SMTP Connection Manager</span></span>|`System.String`|<span data-ttu-id="b0235-161">Por exemplo: `SmtpServer=<server name>;UseWindowsAuthentication=True;EnableSsl=False;`</span><span class="sxs-lookup"><span data-stu-id="b0235-161">For example: `SmtpServer=<server name>;UseWindowsAuthentication=True;EnableSsl=False;`</span></span>|  
|<span data-ttu-id="b0235-162">WMI</span><span class="sxs-lookup"><span data-stu-id="b0235-162">WMI</span></span>|<span data-ttu-id="b0235-163">Gerenciador de conexões WMI</span><span class="sxs-lookup"><span data-stu-id="b0235-163">WMI Connection Manager</span></span>|`System.Management.ManagementScope`||  
|<span data-ttu-id="b0235-164">SQLMOBILE</span><span class="sxs-lookup"><span data-stu-id="b0235-164">SQLMOBILE</span></span>|<span data-ttu-id="b0235-165">Gerenciador de conexões do SQL Server Compact</span><span class="sxs-lookup"><span data-stu-id="b0235-165">SQL Server Compact Connection Manager</span></span>|`System.Data.SqlServerCe.SqlCeConnection`||  
  
<span data-ttu-id="b0235-166">![Ícone de Integration Services (pequeno)](media/dts-16.gif "Ícone do Integration Services (pequeno)")  **Mantenha-se atualizado com Integration Services**</span><span class="sxs-lookup"><span data-stu-id="b0235-166">![Integration Services icon (small)](media/dts-16.gif "Integration Services icon (small)")  **Stay Up to Date with Integration Services**</span></span><br /> <span data-ttu-id="b0235-167">Para obter os downloads, artigos, exemplos e vídeos mais recentes da Microsoft, assim como soluções selecionadas pela comunidade, visite a página do [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] no MSDN:</span><span class="sxs-lookup"><span data-stu-id="b0235-167">For the latest downloads, articles, samples, and videos from Microsoft, as well as selected solutions from the community, visit the [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] page on MSDN:</span></span><br /><br /> [<span data-ttu-id="b0235-168">Visite a página do Integration Services no MSDN</span><span class="sxs-lookup"><span data-stu-id="b0235-168">Visit the Integration Services page on MSDN</span></span>](https://go.microsoft.com/fwlink/?LinkId=136655)<br /><br /> <span data-ttu-id="b0235-169">Para receber uma notificação automática dessas atualizações, assine os RSS feeds disponíveis na página.</span><span class="sxs-lookup"><span data-stu-id="b0235-169">For automatic notification of these updates, subscribe to the RSS feeds available on the page.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b0235-170">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="b0235-170">See Also</span></span>  
 <span data-ttu-id="b0235-171">[Conectando-se a fontes de dados na tarefa Script](extending-packages-scripting/task/connecting-to-data-sources-in-the-script-task.md) </span><span class="sxs-lookup"><span data-stu-id="b0235-171">[Connecting to Data Sources in the Script Task](extending-packages-scripting/task/connecting-to-data-sources-in-the-script-task.md) </span></span>  
 <span data-ttu-id="b0235-172">[Conectando-se a fontes de dados no componente Script](extending-packages-scripting/data-flow-script-component/connecting-to-data-sources-in-the-script-component.md) </span><span class="sxs-lookup"><span data-stu-id="b0235-172">[Connecting to Data Sources in the Script Component](extending-packages-scripting/data-flow-script-component/connecting-to-data-sources-in-the-script-component.md) </span></span>  
 [<span data-ttu-id="b0235-173">Conectar-se a fontes de dados em uma tarefa personalizada</span><span class="sxs-lookup"><span data-stu-id="b0235-173">Connecting to Data Sources in a Custom Task</span></span>](extending-packages-custom-objects/task/connecting-to-data-sources-in-a-custom-task.md)  
  
  
