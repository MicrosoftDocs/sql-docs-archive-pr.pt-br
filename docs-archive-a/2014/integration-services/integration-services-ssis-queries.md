---
title: Consultas do SSIS (Integration Services) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- Query Builder [Integration Services]
- queries [Integration Services]
- statements [Integration Services]
- queries [Integration Services], about queries in packages
ms.assetid: 8822bd29-4575-46c8-92a0-1a39bc2604c1
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 5119ff27606ce4e43f65cc129f3caac764e78e0b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87574164"
---
# <a name="integration-services-ssis-queries"></a><span data-ttu-id="d979b-102">Consultas do SSIS (Integration Services)</span><span class="sxs-lookup"><span data-stu-id="d979b-102">Integration Services (SSIS) Queries</span></span>
  <span data-ttu-id="d979b-103">A tarefa Executar SQL, a origem OLE DB, o destino OLE DB e a transformação Pesquisa podem usar consultas de SQL.</span><span class="sxs-lookup"><span data-stu-id="d979b-103">The Execute SQL task, the OLE DB source, the OLE DB destination, and the Lookup transformation can use SQL queries.</span></span> <span data-ttu-id="d979b-104">Na tarefa Executar SQL, as instruções SQL podem criar, atualizar e excluir objetos de banco de dados e dados; executar procedimentos armazenados e executar instruções SELECT.</span><span class="sxs-lookup"><span data-stu-id="d979b-104">In the Execute SQL task, the SQL statements can create, update, and delete database objects and data; run stored procedures; and perform SELECT statements.</span></span> <span data-ttu-id="d979b-105">Na origem OLE DB e na transformação Pesquisa, as instruções SQL são normalmente instruções SELECT ou EXEC.</span><span class="sxs-lookup"><span data-stu-id="d979b-105">In the OLE DB source and the Lookup transformation, the SQL statements are typically SELECT statements or EXEC statements.</span></span> <span data-ttu-id="d979b-106">Esta última normalmente executa procedimentos que retornam conjuntos de resultados.</span><span class="sxs-lookup"><span data-stu-id="d979b-106">The latter most frequently run stored procedures that return result sets.</span></span>  
  
 <span data-ttu-id="d979b-107">Uma consulta pode ser analisada para estabelecer se é válida.</span><span class="sxs-lookup"><span data-stu-id="d979b-107">A query can be parsed to establish whether it is valid.</span></span> <span data-ttu-id="d979b-108">Ao analisar uma consulta que usa uma conexão com o [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], a consulta é analisada, executada e o resultado de execução (sucesso ou falha) é atribuído ao resultado da análise.</span><span class="sxs-lookup"><span data-stu-id="d979b-108">When parsing a query that uses a connection to [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], the query is parsed, executed, and the execution outcome (success or failure) is assigned to the parsing outcome.</span></span> <span data-ttu-id="d979b-109">Se a consulta usar uma conexão com dados que seja diferente do [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], a instrução só será analisada.</span><span class="sxs-lookup"><span data-stu-id="d979b-109">If the query uses a connection to a data other than [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], the statement is parsed only.</span></span>  
  
 <span data-ttu-id="d979b-110">A instrução SQL pode ser definida sendo digitada diretamente no designer ou especificando uma conexão de arquivo ou uma variável que contenha a instrução.</span><span class="sxs-lookup"><span data-stu-id="d979b-110">The SQL statement can be defined either by entering it directly in the designer, or by specifying a file connection or a variable that contains the statement.</span></span>  
  
## <a name="direct-input-sql"></a><span data-ttu-id="d979b-111">SQL de entrada direta</span><span class="sxs-lookup"><span data-stu-id="d979b-111">Direct Input SQL</span></span>  
 <span data-ttu-id="d979b-112">O Construtor de Consultas está disponível na interface do usuário para a tarefa Executar SQL, a origem OLE DB, o destino OLE DB e a transformação Pesquisa.</span><span class="sxs-lookup"><span data-stu-id="d979b-112">Query Builder is available in the user interface for the Execute SQL task, the OLE DB source, the OLE DB destination, and the Lookup transformation.</span></span> <span data-ttu-id="d979b-113">O Construtor de Consultas oferece as seguintes vantagens:</span><span class="sxs-lookup"><span data-stu-id="d979b-113">Query Builder offers the following advantages:</span></span>  
  
-   <span data-ttu-id="d979b-114">Possibilidade de trabalhar visualmente com comandos SQL.</span><span class="sxs-lookup"><span data-stu-id="d979b-114">Work visually or with SQL commands.</span></span>  
  
     <span data-ttu-id="d979b-115">O Construtor de Consultas inclui painéis gráficos que compõem a consulta visualmente e um painel de texto que exibe o texto SQL de sua consulta.</span><span class="sxs-lookup"><span data-stu-id="d979b-115">Query Builder includes graphical panes that compose your query visually and a text pane that displays the SQL text of your query.</span></span> <span data-ttu-id="d979b-116">Você pode trabalhar nos painéis gráfico ou de texto.</span><span class="sxs-lookup"><span data-stu-id="d979b-116">You can work in either the graphical or text panes.</span></span> <span data-ttu-id="d979b-117">O Construtor de Consultas sempre sincroniza as exibições de forma que o texto da consulta e a representação gráfica sempre sejam correspondentes.</span><span class="sxs-lookup"><span data-stu-id="d979b-117">Query Builder synchronizes the views so that the query text and graphical representation always match.</span></span>  
  
-   <span data-ttu-id="d979b-118">Possibilidade de unir tabelas relacionadas.</span><span class="sxs-lookup"><span data-stu-id="d979b-118">Join related tables.</span></span>  
  
     <span data-ttu-id="d979b-119">Se você adicionar mais de uma tabela a sua consulta, o Construtor de Consultas determinará automaticamente como as tabelas estão relacionadas e construirá o comando de junção apropriado.</span><span class="sxs-lookup"><span data-stu-id="d979b-119">If you add more than one table to your query, Query Builder automatically determines how the tables are related and constructs the appropriate join command.</span></span>  
  
-   <span data-ttu-id="d979b-120">Consulta ou atualização de bancos de dados.</span><span class="sxs-lookup"><span data-stu-id="d979b-120">Query or update databases.</span></span>  
  
     <span data-ttu-id="d979b-121">Você pode usar o Construtor de Consultas para retornar dados usando instruções Transact-SQL SELECT ou para criar consultas que atualizem, adicionem ou excluam registros de um banco de dados.</span><span class="sxs-lookup"><span data-stu-id="d979b-121">You can use Query Builder to return data using Transact-SQL SELECT statements, or to create queries that update, add, or delete records in a database.</span></span>  
  
-   <span data-ttu-id="d979b-122">Exibição e edição imediatas de resultados.</span><span class="sxs-lookup"><span data-stu-id="d979b-122">View and edit results immediately.</span></span>  
  
     <span data-ttu-id="d979b-123">Você pode executar sua consulta e trabalhar com um conjunto de registros em uma grade que permite rolagem e edição de registros no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="d979b-123">You can execute your query and work with a recordset in a grid that lets you scroll through and edit records in the database.</span></span>  
  
 <span data-ttu-id="d979b-124">Embora o Construtor de Consultas seja visualmente limitado para criação de consultas SELECT, você pode digitar o SQL para outros tipos de instruções como DELETE e UPDATE no painel de texto.</span><span class="sxs-lookup"><span data-stu-id="d979b-124">Although Query Builder is visually limited to creating SELECT queries, you can type the SQL for other types of statements such as DELETE and UPDATE statements in the text pane.</span></span> <span data-ttu-id="d979b-125">O painel gráfico é atualizado automaticamente para refletir a instrução SQL digitada.</span><span class="sxs-lookup"><span data-stu-id="d979b-125">The graphical pane is automatically updated to reflect the SQL statement that you typed.</span></span>  
  
 <span data-ttu-id="d979b-126">Você também pode fornecer entrada direta digitando a consulta na caixa de diálogo de componente de tarefa ou fluxo de dados ou na janela Propriedades.</span><span class="sxs-lookup"><span data-stu-id="d979b-126">You can also provide direct input by typing the query in the task or data flow component dialog box or the Properties window.</span></span>  
  
 <span data-ttu-id="d979b-127">Para obter mais informações, consulte [Query Builder](../../2014/integration-services/query-builder.md).</span><span class="sxs-lookup"><span data-stu-id="d979b-127">For more information, see [Query Builder](../../2014/integration-services/query-builder.md).</span></span>  
  
## <a name="sql-in-files"></a><span data-ttu-id="d979b-128">SQL em arquivos</span><span class="sxs-lookup"><span data-stu-id="d979b-128">SQL in Files</span></span>  
 <span data-ttu-id="d979b-129">A instrução SQL da tarefa Executar SQL também pode residir em um arquivo separado.</span><span class="sxs-lookup"><span data-stu-id="d979b-129">The SQL statement for the Execute SQL task can also reside in a separate file.</span></span> <span data-ttu-id="d979b-130">Por exemplo, você pode escrever consultas usando ferramentas como o Editor de Consultas no [!INCLUDE[ssManStudioFull](../includes/ssmanstudiofull-md.md)], salvar a consulta em um arquivo e depois ler a consulta no arquivo ao executar um pacote.</span><span class="sxs-lookup"><span data-stu-id="d979b-130">For example, you can write queries using tools such as the Query Editor in [!INCLUDE[ssManStudioFull](../includes/ssmanstudiofull-md.md)], save the query to a file, and then read the query from the file when running a package.</span></span> <span data-ttu-id="d979b-131">O arquivo pode conter apenas as instruções SQL para execução e comentários.</span><span class="sxs-lookup"><span data-stu-id="d979b-131">The file can contain only the SQL statements to run and comments.</span></span> <span data-ttu-id="d979b-132">Para usar uma instrução SQL armazenada em um arquivo, forneça uma conexão de arquivo que especifique o nome do arquivo e o local.</span><span class="sxs-lookup"><span data-stu-id="d979b-132">To use a SQL statement stored in a file, you must provide a file connection that specifies the file name and location.</span></span> <span data-ttu-id="d979b-133">Para obter mais informações, consulte [File Connection Manager](connection-manager/file-connection-manager.md).</span><span class="sxs-lookup"><span data-stu-id="d979b-133">For more information, see [File Connection Manager](connection-manager/file-connection-manager.md).</span></span>  
  
## <a name="sql-in-variables"></a><span data-ttu-id="d979b-134">SQL em variáveis</span><span class="sxs-lookup"><span data-stu-id="d979b-134">SQL in Variables</span></span>  
 <span data-ttu-id="d979b-135">Se a origem da instrução SQL na tarefa Executar SQL for uma variável, forneça o nome da variável que contém a consulta.</span><span class="sxs-lookup"><span data-stu-id="d979b-135">If the source of the SQL statement in the Execute SQL task is a variable, you provide the name of the variable that contains the query.</span></span> <span data-ttu-id="d979b-136">A propriedade Value da variável contém o texto de consulta.</span><span class="sxs-lookup"><span data-stu-id="d979b-136">The Value property of the variable contains the query text.</span></span> <span data-ttu-id="d979b-137">Você define a propriedade ValueType da variável como um tipo de dados String e digita ou copia a instrução SQL na propriedade Value.</span><span class="sxs-lookup"><span data-stu-id="d979b-137">You set the ValueType property of the variable to a string data type and then type or copy the SQL statement into the Value property.</span></span> <span data-ttu-id="d979b-138">Para obter mais informações, consulte [Variáveis do Integration Services &#40;SSIS&#41;](integration-services-ssis-variables.md) e [Usar variáveis em pacotes](../../2014/integration-services/use-variables-in-packages.md).</span><span class="sxs-lookup"><span data-stu-id="d979b-138">For more information, see [Integration Services &#40;SSIS&#41; Variables](integration-services-ssis-variables.md) and [Use Variables in Packages](../../2014/integration-services/use-variables-in-packages.md).</span></span>  
  
  
