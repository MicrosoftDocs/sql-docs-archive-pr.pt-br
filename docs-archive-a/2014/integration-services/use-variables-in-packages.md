---
title: Usar variáveis em pacotes | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- user-defined variables [Integration Services]
- variables [Integration Services], use scenarios
- system variables [Integration Services]
ms.assetid: 7742e92d-46c5-4cc4-b9a3-45b688ddb787
author: chugugrace
ms.author: chugu
ms.openlocfilehash: acfb6813406bd3a143712e40ec510a4658d4e5da
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87570742"
---
# <a name="use-variables-in-packages"></a><span data-ttu-id="1b7da-102">Usar variáveis em pacotes</span><span class="sxs-lookup"><span data-stu-id="1b7da-102">Use Variables in Packages</span></span>
  <span data-ttu-id="1b7da-103">Variáveis são adições úteis e flexíveis aos pacotes do [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] ; elas podem fornecer comunicação entre objetos no pacote e entre pacotes pai e filho.</span><span class="sxs-lookup"><span data-stu-id="1b7da-103">Variables are a useful and flexible addition to [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] packages; they can provide communication among objects in the package, and between parent and child packages.</span></span> <span data-ttu-id="1b7da-104">As variáveis também podem ser usadas em expressões e scripts.</span><span class="sxs-lookup"><span data-stu-id="1b7da-104">Variables can also be used in expressions and scripts.</span></span>  
  
## <a name="user-defined-variables-and-system-variables"></a><span data-ttu-id="1b7da-105">Variáveis definidas pelo usuário e pelo sistema</span><span class="sxs-lookup"><span data-stu-id="1b7da-105">User-Defined Variables and System Variables</span></span>  
 <span data-ttu-id="1b7da-106">O [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] oferece variáveis de sistema e suporta variáveis definidas pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="1b7da-106">[!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] provides system variables and supports user-defined variables.</span></span> <span data-ttu-id="1b7da-107">Ao criar um novo pacote, adicione um contêiner ou uma tarefa a um pacote ou crie um manipulador de eventos, o [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] inclui um conjunto de variáveis do sistema para o contêiner.</span><span class="sxs-lookup"><span data-stu-id="1b7da-107">When you create a new package, add a container or a task to a package, or create an event handler, [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] includes a set of system variables for the container.</span></span> <span data-ttu-id="1b7da-108">Variáveis do sistema contêm informações úteis sobre um pacote, contêiner, tarefa ou manipulador de eventos.</span><span class="sxs-lookup"><span data-stu-id="1b7da-108">System variables contain useful information about a package, container, task, or event handler.</span></span> <span data-ttu-id="1b7da-109">Por exemplo, no tempo de execução a variável do sistema **Nome do computador** contém o nome do computador no qual o pacote está sendo executado e **Hora Inicial** a hora que a execução do pacote começou.</span><span class="sxs-lookup"><span data-stu-id="1b7da-109">For example, at run time the **MachineName** system variable contains the name of the computer on which the package is running and **StartTime** the time the package started to run.</span></span> <span data-ttu-id="1b7da-110">As variáveis de sistema são somente leitura.</span><span class="sxs-lookup"><span data-stu-id="1b7da-110">System variables are read-only.</span></span> <span data-ttu-id="1b7da-111">Para obter mais informações, consulte [Variáveis de sistema](system-variables.md).</span><span class="sxs-lookup"><span data-stu-id="1b7da-111">For more information, see [System Variables](system-variables.md).</span></span>  
  
 <span data-ttu-id="1b7da-112">É possível criar variáveis definidas pelo usuário e usá-las em pacotes.</span><span class="sxs-lookup"><span data-stu-id="1b7da-112">You can create user-defined variables and then use them in packages.</span></span> <span data-ttu-id="1b7da-113">Variáveis definidas pelo usuário podem ser usadas de diversas formas no [!INCLUDE[ssIS](../includes/ssis-md.md)]: em scripts; nas expressões usadas pelas restrições de precedência, no contêiner Loop For, na transformação Coluna Derivada e na transformação Divisão Condicional; e nas expressões de propriedade que atualizam os valores da propriedade.</span><span class="sxs-lookup"><span data-stu-id="1b7da-113">User-defined variables can be used in many ways in [!INCLUDE[ssIS](../includes/ssis-md.md)]: in scripts; in the expressions used by precedence constraints, the For Loop container, the Derived Column transformation, and the Conditional Split transformation; and in the property expressions that update property values.</span></span>  
  
 <span data-ttu-id="1b7da-114">Por exemplo, é possível usar uma variável definida pelo usuário na condição de avaliação para o contêiner Loop For.</span><span class="sxs-lookup"><span data-stu-id="1b7da-114">For example, you can use a user-defined variable in the evaluation condition for the For Loop container.</span></span> <span data-ttu-id="1b7da-115">Também é possível mapear o valor de coleção do enumerador em um contêiner Loop Foreach para uma variável, e se uma tarefa Executar SQL usar uma instrução SQL com parâmetro, você poderá mapear os parâmetros para a instrução para variáveis.</span><span class="sxs-lookup"><span data-stu-id="1b7da-115">You can also map the enumerator collection value in a Foreach Loop container to a variable, and if an Execute SQL task uses a parameterized SQL statement, you can map the parameters for the statement to variables.</span></span> <span data-ttu-id="1b7da-116">Para obter mais informações, consulte [Variáveis do SSIS &#40;Integration Services&#41;](integration-services-ssis-variables.md).</span><span class="sxs-lookup"><span data-stu-id="1b7da-116">For more information, see [Integration Services &#40;SSIS&#41; Variables](integration-services-ssis-variables.md).</span></span>  
  
## <a name="variables-usage-scenarios"></a><span data-ttu-id="1b7da-117">Cenários de uso de variáveis</span><span class="sxs-lookup"><span data-stu-id="1b7da-117">Variables Usage Scenarios</span></span>  
 <span data-ttu-id="1b7da-118">As variáveis são usadas de muitos modos diferentes em pacotes [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="1b7da-118">Variables are used in many different ways in [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] packages.</span></span> <span data-ttu-id="1b7da-119">Você provavelmente perceberá que o desenvolvimento do pacote não progride muito antes de você adicionar uma variável definida pelo usuário ao seu pacote para implementar a flexibilidade e a capacidade gerenciamento exigida por sua solução.</span><span class="sxs-lookup"><span data-stu-id="1b7da-119">You will probably find that package development does not progress far before you have to add a user-defined variable to your package to implement the flexibility and manageability your solution requires.</span></span> <span data-ttu-id="1b7da-120">Dependendo da situação, as variáveis do sistema também são usadas normalmente.</span><span class="sxs-lookup"><span data-stu-id="1b7da-120">Depending on the scenario, system variables are also commonly used.</span></span>  
  
 <span data-ttu-id="1b7da-121">**Expressões de Propriedade** Use variáveis para fornecer valores nas expressões de propriedade que definem as propriedades de pacotes e objetos de pacote.</span><span class="sxs-lookup"><span data-stu-id="1b7da-121">**Property Expressions** Use variables to provide values in the property expressions that set the properties of packages and package objects.</span></span> <span data-ttu-id="1b7da-122">Por exemplo, a expressão, `SELECT * FROM @varTableName` inclui a variável `varTableName` que atualiza a instrução SQL executada por uma tarefa Executar SQL.</span><span class="sxs-lookup"><span data-stu-id="1b7da-122">For example, the expression, `SELECT * FROM @varTableName` includes the variable `varTableName` that updates the SQL statement that an Execute SQL task runs.</span></span> <span data-ttu-id="1b7da-123">A expressão, `DATEPART("d", GETDATE()) == 1? @[User::varPackageFirst]:@[User::varPackageOther]`", atualiza o pacote executado pela tarefa Executar Pacote, executando o pacote especificado na variável `varPackageFirst` no primeiro dia do mês e executando o pacote especificado na variável `varPackageOther` nos outros dias.</span><span class="sxs-lookup"><span data-stu-id="1b7da-123">The expression, `DATEPART("d", GETDATE()) == 1? @[User::varPackageFirst]:@[User::varPackageOther]`", updates the package that the Execute Package task runs, by running the package specified in the `varPackageFirst` variable on the first day of the month and running the package specified in the `varPackageOther` variable on other days.</span></span> <span data-ttu-id="1b7da-124">Para obter mais informações, consulte [Usar expressões de propriedade em pacotes](expressions/use-property-expressions-in-packages.md).</span><span class="sxs-lookup"><span data-stu-id="1b7da-124">For more information, see [Use Property Expressions in Packages](expressions/use-property-expressions-in-packages.md).</span></span>  
  
 <span data-ttu-id="1b7da-125">**Expressões de Fluxo de Dados** Use variáveis para fornecer valores nas expressões que as transformações Coluna Derivada e Divisão Condicional usam para preencher colunas ou direcionar as linhas de dados para diferentes saídas de transformação.</span><span class="sxs-lookup"><span data-stu-id="1b7da-125">**Data Flow Expressions** Use variables to provide values in the expressions that the Derived Column and Conditional Split transformations use to populate columns, or to direct data rows to different transformation outputs.</span></span> <span data-ttu-id="1b7da-126">Por exemplo, a expressão, `@varSalutation + LastName`, junta o valor na variável `VarSalutation` e a coluna `LastName` .</span><span class="sxs-lookup"><span data-stu-id="1b7da-126">For example, the expression, `@varSalutation + LastName`, concatenates the value in the `VarSalutation` variable and the `LastName` column.</span></span> <span data-ttu-id="1b7da-127">A expressão, `Income < @HighIncome`, direciona as linhas de dados nas quais o valor da coluna `Income` é menor que o valor na variável `HighIncome` para uma saída.</span><span class="sxs-lookup"><span data-stu-id="1b7da-127">The expression, `Income < @HighIncome`, directs data rows in which the value of the `Income` column is less than the value in the `HighIncome` variable to an output.</span></span> <span data-ttu-id="1b7da-128">Para obter mais informações, consulte [Transformação Coluna Derivada](data-flow/transformations/derived-column-transformation.md), [Transformação Divisão Condicional](data-flow/transformations/conditional-split-transformation.md) e [Expressões do Integration Services &#40;SSIS&#41;](expressions/integration-services-ssis-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="1b7da-128">For more information, see [Derived Column Transformation](data-flow/transformations/derived-column-transformation.md), [Conditional Split Transformation](data-flow/transformations/conditional-split-transformation.md), and [Integration Services &#40;SSIS&#41; Expressions](expressions/integration-services-ssis-expressions.md).</span></span>  
  
 <span data-ttu-id="1b7da-129">**Expressões de Restrição de Precedência** Fornece valores para usar em restrições de precedência para determinar se o executável de uma restrição executa.</span><span class="sxs-lookup"><span data-stu-id="1b7da-129">**Precedence Constraint Expressions** Provide values to use in precedence constraints to determine whether a constrained executable runs.</span></span> <span data-ttu-id="1b7da-130">As expressões pode ser usadas junto com uma saída de execução (êxito, falha, conclusão) ou no lugar de uma saída de execução.</span><span class="sxs-lookup"><span data-stu-id="1b7da-130">The expressions can be used either together with an execution outcome (success, failure, completion), or instead of an execution outcome.</span></span> <span data-ttu-id="1b7da-131">Por exemplo, se a expressão, `@varMax > @varMin`, avaliar para `true`, o executável será executado.</span><span class="sxs-lookup"><span data-stu-id="1b7da-131">For example, if the expression, `@varMax > @varMin`, evaluates to `true`, the executable runs.</span></span> <span data-ttu-id="1b7da-132">Para obter mais informações, consulte [Adicionar expressões a restrições de precedência](control-flow/precedence-constraints.md).</span><span class="sxs-lookup"><span data-stu-id="1b7da-132">For more information, see [Add Expressions to Precedence Constraints](control-flow/precedence-constraints.md).</span></span>  
  
 <span data-ttu-id="1b7da-133">**Parâmetros e Códigos de Retorno** Fornecem valores para parâmetros de entrada ou armazenam os valores de parâmetros de saída e códigos de retorno.</span><span class="sxs-lookup"><span data-stu-id="1b7da-133">**Parameters and Return Codes** Provide values to input parameters, or store the values of output parameters and return codes.</span></span> <span data-ttu-id="1b7da-134">Isso é feito mapeando as variáveis para parâmetros e valores de retorno.</span><span class="sxs-lookup"><span data-stu-id="1b7da-134">You do this by mapping the variables to parameters and return values.</span></span> <span data-ttu-id="1b7da-135">Por exemplo, se você definir a variável `varProductId` como 23 e executar a instrução SQL, `SELECT * from Production.Product WHERE ProductID = ?`, a consulta recuperará o produto com um `ProductID` de 23.</span><span class="sxs-lookup"><span data-stu-id="1b7da-135">For example, if you set the variable `varProductId` to 23 and run the SQL statement, `SELECT * from Production.Product WHERE ProductID = ?`, the query retrieves the product with a `ProductID` of 23.</span></span> <span data-ttu-id="1b7da-136">Para obter mais informações, consulte [Tarefa Executar SQL](control-flow/execute-sql-task.md) e [Parâmetros e códigos de retorno na Tarefa Executar SQL](../../2014/integration-services/parameters-and-return-codes-in-the-execute-sql-task.md).</span><span class="sxs-lookup"><span data-stu-id="1b7da-136">For more information, see [Execute SQL Task](control-flow/execute-sql-task.md) and [Parameters and Return Codes in the Execute SQL Task](../../2014/integration-services/parameters-and-return-codes-in-the-execute-sql-task.md).</span></span>  
  
 <span data-ttu-id="1b7da-137">**Expressões Loop For** Fornece valores a serem usados na inicialização, avaliação e expressões de atribuição do Loop For.</span><span class="sxs-lookup"><span data-stu-id="1b7da-137">**For Loop Expressions** Provide values to use in the initialization, evaluation, and assignment expressions of the For Loop.</span></span> <span data-ttu-id="1b7da-138">Por exemplo, se a variável `varCount` for 2 e a `varMaxCount` for 10, a expressão de inicialização será `@varCount`, a expressão de avaliação será  `@varCount < @varMaxCount`e a expressão de atribuição será `@varCount =@varCount +1`e o loop será repetido 8 vezes.</span><span class="sxs-lookup"><span data-stu-id="1b7da-138">For example, if the variable `varCount` is 2 and `varMaxCount` is 10, the initialization expression is `@varCount`, the evaluation expression is  `@varCount < @varMaxCount`, and the assignment expression is `@varCount =@varCount +1`, then the loop repeats 8 times.</span></span> <span data-ttu-id="1b7da-139">Para obter mais informações, consulte [Contêiner Loop For](control-flow/for-loop-container.md).</span><span class="sxs-lookup"><span data-stu-id="1b7da-139">For more information, see [For Loop Container](control-flow/for-loop-container.md).</span></span>  
  
 <span data-ttu-id="1b7da-140">**Configurações de Variável do Pacote Pai** Passa valores de pacotes pai para pacotes filho.</span><span class="sxs-lookup"><span data-stu-id="1b7da-140">**Parent Package Variable Configurations** Pass values from parent packages to child packages.</span></span> <span data-ttu-id="1b7da-141">Os pacotes filho podem acessar variáveis no pacote pai usando configurações de variáveis do pacote pai.</span><span class="sxs-lookup"><span data-stu-id="1b7da-141">Child packages can access variables in the parent package by using parent package variable configurations.</span></span> <span data-ttu-id="1b7da-142">Por exemplo, se o pacote filho precisar usar a mesma data que o pacote pai, o pacote filho poderá definir uma configuração de variável de pacote pai que especifica uma variável definida pela função GETDATE no pacote pai.</span><span class="sxs-lookup"><span data-stu-id="1b7da-142">For example, if the child package must use the same date as the parent package, the child package can define a parent package variable configuration that specifies a variable set by the GETDATE function in the parent package.</span></span> <span data-ttu-id="1b7da-143">Para obter mais informações, consulte [Tarefa Executar Pacote](control-flow/execute-package-task.md) e [Configurações de pacote](../../2014/integration-services/package-configurations.md).</span><span class="sxs-lookup"><span data-stu-id="1b7da-143">For more information, see [Execute Package Task](control-flow/execute-package-task.md) and [Package Configurations](../../2014/integration-services/package-configurations.md).</span></span>  
  
 <span data-ttu-id="1b7da-144">**Tarefa Script e Componente Script** Fornece uma lista de variáveis somente leitura e de leitura/gravação à tarefa Script ou ao componente Script, atualiza as variáveis de leitura/gravação dentro do script e usa os valores atualizados dentro ou fora do script.</span><span class="sxs-lookup"><span data-stu-id="1b7da-144">**Script Task and Script Component** Provide a list of read-only and read/write variable to the Script task or Script component, update the read/write variables within the script, and then use the updated values in or outside the script.</span></span> <span data-ttu-id="1b7da-145">Por exemplo, no código, `numberOfCars = CType(Dts.Variables("NumberOfCars").Value, Integer)`, a variável do script `numberOfCars` é atualizada pelo valor na variável, `NumberOfCars`.</span><span class="sxs-lookup"><span data-stu-id="1b7da-145">For example, in the code, `numberOfCars = CType(Dts.Variables("NumberOfCars").Value, Integer)`, the script variable `numberOfCars` is updated by the value in the variable, `NumberOfCars`.</span></span> <span data-ttu-id="1b7da-146">Para obter mais informações, consulte [Usando variáveis na tarefa Script](control-flow/script-task.md).</span><span class="sxs-lookup"><span data-stu-id="1b7da-146">For more information, see [Using Variables in the Script Task](control-flow/script-task.md).</span></span>  
  
## <a name="configurations-and-variables"></a><span data-ttu-id="1b7da-147">Configurações e Variáveis</span><span class="sxs-lookup"><span data-stu-id="1b7da-147">Configurations and Variables</span></span>  
 <span data-ttu-id="1b7da-148">Para atualizar dinamicamente as variáveis, é possível criar configurações para as variáveis, implantar as configurações com o pacote e atualizar os valores da variável no arquivo de configuração ao implantar os pacotes.</span><span class="sxs-lookup"><span data-stu-id="1b7da-148">To dynamically update variables, you can create configurations for the variables, deploy the configurations with the package, and then update the variable values in the configuration file when you deploy the packages.</span></span> <span data-ttu-id="1b7da-149">Em tempo de execução, o pacote usa os valores de variável atualizados.</span><span class="sxs-lookup"><span data-stu-id="1b7da-149">At run time, the package uses the updated variable values.</span></span> <span data-ttu-id="1b7da-150">Para obter mais informações, consulte [Criar configurações de pacote](../../2014/integration-services/create-package-configurations.md).</span><span class="sxs-lookup"><span data-stu-id="1b7da-150">For more information, see [Create Package Configurations](../../2014/integration-services/create-package-configurations.md).</span></span>  
  
### <a name="to-add-modify-and-delete-user-defined-variables"></a><span data-ttu-id="1b7da-151">Para adicionar, modificar e excluir variáveis definidas pelo usuário</span><span class="sxs-lookup"><span data-stu-id="1b7da-151">To add, modify, and delete user-defined variables</span></span>  
  
-   [<span data-ttu-id="1b7da-152">Adicionar, excluir, alterar o escopo de uma variável definida pelo usuário em um pacote</span><span class="sxs-lookup"><span data-stu-id="1b7da-152">Add, Delete, Change Scope of User-Defined Variable in a Package</span></span>](../../2014/integration-services/add-delete-change-scope-of-user-defined-variable-in-a-package.md)  
  
-   [<span data-ttu-id="1b7da-153">Definir as propriedades de uma variável definida pelo usuário</span><span class="sxs-lookup"><span data-stu-id="1b7da-153">Set the Properties of a User-Defined Variable</span></span>](../../2014/integration-services/set-the-properties-of-a-user-defined-variable.md)  
  
  
