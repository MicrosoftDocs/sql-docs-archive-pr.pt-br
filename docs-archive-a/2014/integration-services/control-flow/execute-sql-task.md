---
title: Tarefa Executar SQL | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.dts.designer.executesqltask.f1
helpviewer_keywords:
- Transact-SQL statements, SSIS
- statements [Integration Services]
- batches [Integration Services]
- Execute SQL task [Integration Services]
ms.assetid: bebb2e8c-0410-43b2-ac2f-6fc80c8f2e9e
author: chugugrace
ms.author: chugu
ms.openlocfilehash: e77b9f442ae8478c57d5b0e68955b541eda38aff
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87679470"
---
# <a name="execute-sql-task"></a><span data-ttu-id="eba7b-102">Tarefa Executar SQL</span><span class="sxs-lookup"><span data-stu-id="eba7b-102">Execute SQL Task</span></span>
  <span data-ttu-id="eba7b-103">A tarefa Executar SQL executa instruções SQL ou procedimentos armazenados a partir de um pacote.</span><span class="sxs-lookup"><span data-stu-id="eba7b-103">The Execute SQL task runs SQL statements or stored procedures from a package.</span></span> <span data-ttu-id="eba7b-104">A tarefa pode conter uma única instrução SQL ou várias instruções SQL que são executadas em sequência.</span><span class="sxs-lookup"><span data-stu-id="eba7b-104">The task can contain either a single SQL statement or multiple SQL statements that run sequentially.</span></span> <span data-ttu-id="eba7b-105">Você pode usar a tarefa Executar SQL para os seguintes propósitos:</span><span class="sxs-lookup"><span data-stu-id="eba7b-105">You can use the Execute SQL task for the following purposes:</span></span>  
  
-   <span data-ttu-id="eba7b-106">Truncar uma tabela ou exibição em preparação para inserção de dados.</span><span class="sxs-lookup"><span data-stu-id="eba7b-106">Truncate a table or view in preparation for inserting data.</span></span>  
  
-   <span data-ttu-id="eba7b-107">Criar, alterar e descartar objetos de banco de dados como tabelas e exibições.</span><span class="sxs-lookup"><span data-stu-id="eba7b-107">Create, alter, and drop database objects such as tables and views.</span></span>  
  
-   <span data-ttu-id="eba7b-108">Recriar tabelas de fatos e de dimensões antes de carregar dados nelas.</span><span class="sxs-lookup"><span data-stu-id="eba7b-108">Re-create fact and dimension tables before loading data into them.</span></span>  
  
-   <span data-ttu-id="eba7b-109">Executar procedimentos armazenados.</span><span class="sxs-lookup"><span data-stu-id="eba7b-109">Run stored procedures.</span></span> <span data-ttu-id="eba7b-110">Se a instrução SQL invocar um procedimento armazenado que retorne resultados de uma tabela temporária, use a opção de WITH RESULT SETS para definir metadados para o conjunto de resultados.</span><span class="sxs-lookup"><span data-stu-id="eba7b-110">If the SQL statement invokes a stored procedure that returns results from a temporary table, use the WITH RESULT SETS option to define metadata for the result set.</span></span>  
  
-   <span data-ttu-id="eba7b-111">Salvar o conjunto de linhas retornado de uma consulta em uma variável.</span><span class="sxs-lookup"><span data-stu-id="eba7b-111">Save the rowset returned from a query into a variable.</span></span>  
  
 <span data-ttu-id="eba7b-112">A tarefa Executar SQL pode ser usada em combinação com os contêineres Loop Foreach e Loop For para executar várias instruções SQL.</span><span class="sxs-lookup"><span data-stu-id="eba7b-112">The Execute SQL task can be used in combination with the Foreach Loop and For Loop containers to run multiple SQL statements.</span></span> <span data-ttu-id="eba7b-113">Esses contêineres implementam fluxos de controle repetitivos em um pacote e eles podem executar a tarefa Executar SQL várias vezes.</span><span class="sxs-lookup"><span data-stu-id="eba7b-113">These containers implement repeating control flows in a package and they can run the Execute SQL task repeatedly.</span></span> <span data-ttu-id="eba7b-114">Por exemplo, usando o contêiner Loop Foreach, um pacote pode enumerar arquivos em uma pasta e executar uma tarefa Executar SQL várias vezes para executar a instrução SQL armazenada em cada arquivo.</span><span class="sxs-lookup"><span data-stu-id="eba7b-114">For example, using the Foreach Loop container, a package can enumerate files in a folder and run an Execute SQL task repeatedly to execute the SQL statement stored in each file.</span></span>  
  
## <a name="connecting-to-a-data-source"></a><span data-ttu-id="eba7b-115">Conectando a uma fonte de dados</span><span class="sxs-lookup"><span data-stu-id="eba7b-115">Connecting to a Data Source</span></span>  
 <span data-ttu-id="eba7b-116">A tarefa Executar SQL pode usar tipos diferentes de gerenciadores de conexões para se conectar à fonte de dados onde a instrução SQL ou o procedimento armazenado é executado.</span><span class="sxs-lookup"><span data-stu-id="eba7b-116">The Execute SQL task can use different types of connection managers to connect to the data source where it runs the SQL statement or stored procedure.</span></span> <span data-ttu-id="eba7b-117">A tarefa pode usar os tipos de conexão listados na tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="eba7b-117">The task can use the connection types listed in the following table.</span></span>  
  
|<span data-ttu-id="eba7b-118">Tipo de conexão</span><span class="sxs-lookup"><span data-stu-id="eba7b-118">Connection type</span></span>|<span data-ttu-id="eba7b-119">Gerenciador de conexões</span><span class="sxs-lookup"><span data-stu-id="eba7b-119">Connection manager</span></span>|  
|---------------------|------------------------|  
|<span data-ttu-id="eba7b-120">EXCEL</span><span class="sxs-lookup"><span data-stu-id="eba7b-120">EXCEL</span></span>|[<span data-ttu-id="eba7b-121">Gerenciador de Conexões do Excel</span><span class="sxs-lookup"><span data-stu-id="eba7b-121">Excel Connection Manager</span></span>](../connection-manager/excel-connection-manager.md)|  
|<span data-ttu-id="eba7b-122">OLE DB</span><span class="sxs-lookup"><span data-stu-id="eba7b-122">OLE DB</span></span>|[<span data-ttu-id="eba7b-123">Gerenciador de Conexões OLE DB</span><span class="sxs-lookup"><span data-stu-id="eba7b-123">OLE DB Connection Manager</span></span>](../connection-manager/ole-db-connection-manager.md)|  
|<span data-ttu-id="eba7b-124">ODBCODBC</span><span class="sxs-lookup"><span data-stu-id="eba7b-124">ODBC</span></span>|[<span data-ttu-id="eba7b-125">Gerenciador de Conexões ODBC</span><span class="sxs-lookup"><span data-stu-id="eba7b-125">ODBC Connection Manager</span></span>](../connection-manager/odbc-connection-manager.md)|  
|<span data-ttu-id="eba7b-126">ADO</span><span class="sxs-lookup"><span data-stu-id="eba7b-126">ADO</span></span>|[<span data-ttu-id="eba7b-127">Gerenciador de conexões ADO</span><span class="sxs-lookup"><span data-stu-id="eba7b-127">ADO Connection Manager</span></span>](../connection-manager/ado-connection-manager.md)|  
|<span data-ttu-id="eba7b-128">ADO.NET</span><span class="sxs-lookup"><span data-stu-id="eba7b-128">ADO.NET</span></span>|[<span data-ttu-id="eba7b-129">Gerenciador de conexões ADO.NET</span><span class="sxs-lookup"><span data-stu-id="eba7b-129">ADO.NET Connection Manager</span></span>](../connection-manager/ado-net-connection-manager.md)|  
|<span data-ttu-id="eba7b-130">SQLMOBILE</span><span class="sxs-lookup"><span data-stu-id="eba7b-130">SQLMOBILE</span></span>|[<span data-ttu-id="eba7b-131">Gerenciador de Conexões do SQL Server Compact Edition</span><span class="sxs-lookup"><span data-stu-id="eba7b-131">SQL Server Compact Edition Connection Manager</span></span>](../connection-manager/sql-server-compact-edition-connection-manager.md)|  
  
## <a name="creating-sql-statements"></a><span data-ttu-id="eba7b-132">Criando instruções SQL</span><span class="sxs-lookup"><span data-stu-id="eba7b-132">Creating SQL Statements</span></span>  
 <span data-ttu-id="eba7b-133">A origem das instruções SQL usada por essa tarefa pode ser uma propriedade de tarefa que contém uma instrução, uma conexão com um arquivo que contém uma ou várias instruções ou o nome de uma variável que contém uma instrução.</span><span class="sxs-lookup"><span data-stu-id="eba7b-133">The source of the SQL statements used by this task can be a task property that contains a statement, a connection to a file that contains one or multiple statements, or the name of a variable that contains a statement.</span></span> <span data-ttu-id="eba7b-134">As instruções SQL devem ser gravadas na linguagem do sistema de gerenciamento de banco de dados de origem (DBMS).</span><span class="sxs-lookup"><span data-stu-id="eba7b-134">The SQL statements must be written in the dialect of the source database management system (DBMS).</span></span> <span data-ttu-id="eba7b-135">Para obter mais informações, consulte [Consultas do Integration Services &#40;SSIS&#41;](../integration-services-ssis-queries.md).</span><span class="sxs-lookup"><span data-stu-id="eba7b-135">For more information, see [Integration Services &#40;SSIS&#41; Queries](../integration-services-ssis-queries.md).</span></span>  
  
 <span data-ttu-id="eba7b-136">Se as instruções SQL estiverem armazenadas em um arquivo, a tarefa usará um gerenciador de conexões de arquivo para se conectar ao arquivo.</span><span class="sxs-lookup"><span data-stu-id="eba7b-136">If the SQL statements are stored in a file, the task uses a File connection manager to connect to the file.</span></span> <span data-ttu-id="eba7b-137">Para obter mais informações, consulte [File Connection Manager](../connection-manager/file-connection-manager.md).</span><span class="sxs-lookup"><span data-stu-id="eba7b-137">For more information, see [File Connection Manager](../connection-manager/file-connection-manager.md).</span></span>  
  
 <span data-ttu-id="eba7b-138">No Designer [!INCLUDE[ssIS](../../includes/ssis-md.md)] , você pode usar a caixa de diálogo **Editor da Tarefa Executar SQL** para digitar instruções SQL ou usar o **Construtor de Consultas**, uma interface do usuário gráfica para criar consultas SQL.</span><span class="sxs-lookup"><span data-stu-id="eba7b-138">In [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, you can use the **Execute SQL Task Editor** dialog box to type SQL statements, or use **Query Builder**, a graphical user interface for creating SQL queries.</span></span> <span data-ttu-id="eba7b-139">Para obter mais informações, consulte [Execute SQL Task Editor &#40;General Page&#41;](../execute-sql-task-editor-general-page.md) e [Construtor de Consultas](../query-builder.md).</span><span class="sxs-lookup"><span data-stu-id="eba7b-139">For more information, see [Execute SQL Task Editor &#40;General Page&#41;](../execute-sql-task-editor-general-page.md) and [Query Builder](../query-builder.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="eba7b-140">Instruções SQL válidas gravadas fora da tarefa Executar SQL talvez não sejam analisadas com êxito pela tarefa Executar SQL.</span><span class="sxs-lookup"><span data-stu-id="eba7b-140">Valid SQL statements written outside the Execute SQL task may not be parsed successfully by the Execute SQL task.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="eba7b-141">A Tarefa Executar SQL usa o valor de enumeração `RecognizeAll` ParseMode.</span><span class="sxs-lookup"><span data-stu-id="eba7b-141">The Execute SQL Task uses the `RecognizeAll` ParseMode enumeration value.</span></span> <span data-ttu-id="eba7b-142">Para obter mais informações, consulte [Namespace ManagedBatchParser](https://go.microsoft.com/fwlink/?LinkId=223617).</span><span class="sxs-lookup"><span data-stu-id="eba7b-142">For more information, see [ManagedBatchParser Namespace](https://go.microsoft.com/fwlink/?LinkId=223617).</span></span>  
  
## <a name="sending-multiple-statements-in-a-batch"></a><span data-ttu-id="eba7b-143">Enviando várias instruções em um lote</span><span class="sxs-lookup"><span data-stu-id="eba7b-143">Sending Multiple Statements in a Batch</span></span>  
 <span data-ttu-id="eba7b-144">Se várias instruções forem incluídas em uma tarefa Executar SQL, é possível agrupá-las e executá-las como um lote.</span><span class="sxs-lookup"><span data-stu-id="eba7b-144">If you include multiple statements in an Execute SQL task, you can group them and run them as a batch.</span></span> <span data-ttu-id="eba7b-145">Para sinalizar o final de um lote, use o comando GO.</span><span class="sxs-lookup"><span data-stu-id="eba7b-145">To signal the end of a batch, use the GO command.</span></span> <span data-ttu-id="eba7b-146">Todas as instruções SQL entre dois comandos GO são enviadas em um lote para o provedor OLE DB a fim de serem executadas.</span><span class="sxs-lookup"><span data-stu-id="eba7b-146">All the SQL statements between two GO commands are sent in a batch to the OLE DB provider to be run.</span></span> <span data-ttu-id="eba7b-147">O comando SQL pode incluir vários lotes separados por comandos GO.</span><span class="sxs-lookup"><span data-stu-id="eba7b-147">The SQL command can include multiple batches separated by GO commands.</span></span>  
  
 <span data-ttu-id="eba7b-148">Há restrições sobre os tipos de instruções SQL que podem ser agrupados em um lote.</span><span class="sxs-lookup"><span data-stu-id="eba7b-148">There are restrictions on the kinds of SQL statements that you can group in a batch.</span></span> <span data-ttu-id="eba7b-149">Para obter mais informações, consulte as instruções [Lotes de instruções](../../relational-databases/native-client-odbc-queries/executing-statements/batches-of-statements.md).</span><span class="sxs-lookup"><span data-stu-id="eba7b-149">For more information, see [Batches of Statements](../../relational-databases/native-client-odbc-queries/executing-statements/batches-of-statements.md).</span></span>  
  
 <span data-ttu-id="eba7b-150">Se a tarefa Executar SQL executar um lote de instruções SQL, as seguintes regras se aplicam ao lote:</span><span class="sxs-lookup"><span data-stu-id="eba7b-150">If the Execute SQL task runs a batch of SQL statements, the following rules apply to the batch:</span></span>  
  
-   <span data-ttu-id="eba7b-151">Só uma instrução pode retornar um conjunto de resultados e deve ser a primeira instrução no lote.</span><span class="sxs-lookup"><span data-stu-id="eba7b-151">Only one statement can return a result set and it must be the first statement in the batch.</span></span>  
  
-   <span data-ttu-id="eba7b-152">Se o conjunto de resultados usar associações de resultado, as consultas devem retornar o mesmo número de colunas.</span><span class="sxs-lookup"><span data-stu-id="eba7b-152">If the result set uses result bindings, the queries must return the same number of columns.</span></span> <span data-ttu-id="eba7b-153">Se as consultas retornarem um número diferente de colunas, a tarefa falhará.</span><span class="sxs-lookup"><span data-stu-id="eba7b-153">If the queries return a different number of columns, the task fails.</span></span> <span data-ttu-id="eba7b-154">Porém, mesmo que a tarefa falhe, as consultas executadas, como DELETE ou INSERT, podem ser executadas com êxito.</span><span class="sxs-lookup"><span data-stu-id="eba7b-154">However, even if the task fails, the queries that it runs, such as DELETE or INSERT queries, may succeed.</span></span>  
  
-   <span data-ttu-id="eba7b-155">Se as associações de resultado usarem nomes de coluna, a consulta deve retornar colunas que tenham os mesmos nomes do conjunto de resultados usado na tarefa.</span><span class="sxs-lookup"><span data-stu-id="eba7b-155">If the result bindings use column names, the query must return columns that have the same names as the result set names that are used in the task.</span></span> <span data-ttu-id="eba7b-156">Se as colunas estiverem ausentes, a tarefa falhará.</span><span class="sxs-lookup"><span data-stu-id="eba7b-156">If the columns are missing, the task fails.</span></span>  
  
-   <span data-ttu-id="eba7b-157">Se a tarefa usar associações de parâmetro, todas as consultas do lote devem ter o mesmo número e os mesmos tipos de parâmetros.</span><span class="sxs-lookup"><span data-stu-id="eba7b-157">If the task uses parameter binding, all the queries in the batch must have the same number and types of parameters.</span></span>  
  
## <a name="running-parameterized-sql-commands"></a><span data-ttu-id="eba7b-158">Executando comandos SQL parametrizados</span><span class="sxs-lookup"><span data-stu-id="eba7b-158">Running Parameterized SQL Commands</span></span>  
 <span data-ttu-id="eba7b-159">As instruções SQL e os procedimentos armazenados frequentemente usam parâmetros de entrada, parâmetros de saída e códigos de retorno.</span><span class="sxs-lookup"><span data-stu-id="eba7b-159">SQL statements and stored procedures frequently use input parameters, output parameters, and return codes.</span></span> <span data-ttu-id="eba7b-160">A tarefa Executar SQL suporta os tipos de parâmetro `Input`, `Output` e `ReturnValue`.</span><span class="sxs-lookup"><span data-stu-id="eba7b-160">The Execute SQL task supports the `Input`, `Output`, and `ReturnValue` parameter types.</span></span> <span data-ttu-id="eba7b-161">Use o tipo `Input` para parâmetros de entrada, `Output` para parâmetros de saída e `ReturnValue` para códigos de retorno.</span><span class="sxs-lookup"><span data-stu-id="eba7b-161">You use the `Input` type for input parameters, `Output` for output parameters, and `ReturnValue` for return codes.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="eba7b-162">Você só poderá usar parâmetros em uma tarefa Executar SQL se o provedor de dados der suporte a eles.</span><span class="sxs-lookup"><span data-stu-id="eba7b-162">You can use parameters in an Execute SQL task only if the data provider supports them.</span></span>  
  
 <span data-ttu-id="eba7b-163">Para obter informações sobre como usar parâmetros e códigos de retorno na tarefa Executar SQL, consulte [Parâmetros e códigos de retorno na Tarefa Executar SQL](execute-sql-task.md).</span><span class="sxs-lookup"><span data-stu-id="eba7b-163">For information on using parameters and return codes in the Execute SQL task, see [Parameters and Return Codes in the Execute SQL Task](execute-sql-task.md).</span></span>  
  
## <a name="specifying-a-result-set-type"></a><span data-ttu-id="eba7b-164">Especificando um tipo de conjunto de resultados</span><span class="sxs-lookup"><span data-stu-id="eba7b-164">Specifying a Result Set Type</span></span>  
 <span data-ttu-id="eba7b-165">Dependendo do tipo de comando SQL, um conjunto de resultados pode ou não ser retornado para a tarefa Executar SQL.</span><span class="sxs-lookup"><span data-stu-id="eba7b-165">Depending on the type of SQL command, a result set may or may not be returned to the Execute SQL task.</span></span> <span data-ttu-id="eba7b-166">Por exemplo, uma instrução SELECT normalmente retorna um conjunto de resultados, mas uma instrução INSERT não.</span><span class="sxs-lookup"><span data-stu-id="eba7b-166">For example, a SELECT statement typically returns a result set, but an INSERT statement does not.</span></span> <span data-ttu-id="eba7b-167">O conjunto de resultados de uma instrução SELECT pode conter nenhuma linha, uma linha ou muitas linhas.</span><span class="sxs-lookup"><span data-stu-id="eba7b-167">The result set from a SELECT statement can contain zero rows, one row, or many rows.</span></span> <span data-ttu-id="eba7b-168">Os procedimentos armazenados também podem retornar um valor inteiro, chamado de código de retorno, para indicar o status de execução do procedimento.</span><span class="sxs-lookup"><span data-stu-id="eba7b-168">Stored procedures can also return an integer value, called a return code, that indicates the execution status of the procedure.</span></span> <span data-ttu-id="eba7b-169">Nesse caso, o conjunto de resultados consiste em uma única linha.</span><span class="sxs-lookup"><span data-stu-id="eba7b-169">In that case, the result set consists of a single row.</span></span>  
  
 <span data-ttu-id="eba7b-170">Para obter informações sobre como recuperar conjuntos de resultados de comandos SQL na tarefa Executar SQL, consulte [Conjuntos de resultados na tarefa Executar SQL](../result-sets-in-the-execute-sql-task.md).</span><span class="sxs-lookup"><span data-stu-id="eba7b-170">For information on retrieving result sets from SQL commands in the Execute SQL task, see [Result Sets in the Execute SQL Task](../result-sets-in-the-execute-sql-task.md).</span></span>  
  
## <a name="troubleshooting-the-execute-sql-task"></a><span data-ttu-id="eba7b-171">Solucionando problemas da tarefa Executar SQL</span><span class="sxs-lookup"><span data-stu-id="eba7b-171">Troubleshooting the Execute SQL Task</span></span>  
 <span data-ttu-id="eba7b-172">Você pode registrar as chamadas que a tarefa Executar SQL faz para provedores de dados externos.</span><span class="sxs-lookup"><span data-stu-id="eba7b-172">You can log the calls that the Execute SQL task makes to external data providers.</span></span> <span data-ttu-id="eba7b-173">É possível usar esse recurso de registro para solucionar problemas dos comandos SQL executados pela tarefa Executar SQL.</span><span class="sxs-lookup"><span data-stu-id="eba7b-173">You can use this logging capability to troubleshoot the SQL commands that the Execute SQL task runs.</span></span> <span data-ttu-id="eba7b-174">Para registrar as chamadas que a tarefa Executar SQL faz aos provedores de dados externos, habilite o registro de pacotes e selecione o evento **Diagnóstico** no nível de pacotes.</span><span class="sxs-lookup"><span data-stu-id="eba7b-174">To log the calls that the Execute SQL task makes to external data providers, enable package logging and select the **Diagnostic** event at the package level.</span></span> <span data-ttu-id="eba7b-175">Para obter mais informações, consulte [Solucionando problemas de ferramentas para execução de pacotes](../troubleshooting/troubleshooting-tools-for-package-execution.md).</span><span class="sxs-lookup"><span data-stu-id="eba7b-175">For more information, see [Troubleshooting Tools for Package Execution](../troubleshooting/troubleshooting-tools-for-package-execution.md).</span></span>  
  
 <span data-ttu-id="eba7b-176">Às vezes um comando SQL ou procedimento armazenado retorna vários conjuntos de resultados.</span><span class="sxs-lookup"><span data-stu-id="eba7b-176">Sometimes a SQL command or stored procedure returns multiple result sets.</span></span> <span data-ttu-id="eba7b-177">Esses conjuntos de resultados incluem não só conjuntos de linhas que resultam de consultas `SELECT`, mas também valores únicos que resultam de erros das instruções `RAISERROR` ou `PRINT`.</span><span class="sxs-lookup"><span data-stu-id="eba7b-177">These result sets include not only rowsets that are the result of `SELECT` queries, but single values that are the result of errors of `RAISERROR` or `PRINT` statements.</span></span> <span data-ttu-id="eba7b-178">A tarefa poderá ignorar ou não os erros nos conjuntos de resultados que ocorrem após o primeiro conjunto de resultados dependendo do tipo de gerenciador de conexões usado:</span><span class="sxs-lookup"><span data-stu-id="eba7b-178">Whether the task ignores errors in result sets that occur after the first result set depends on the type of connection manager that is used:</span></span>  
  
-   <span data-ttu-id="eba7b-179">Quando você usa gerenciadores de conexões OLE DB e ADO, a tarefa ignora os conjuntos de resultados que ocorrem após o primeiro conjunto de resultados.</span><span class="sxs-lookup"><span data-stu-id="eba7b-179">When you use OLE DB and ADO connection managers, the task ignores the result sets that occur after the first result set.</span></span> <span data-ttu-id="eba7b-180">Portanto, com esses gerenciadores de conexões, a tarefa ignora um erro retornado por um comando SQL ou um procedimento armazenado quando o erro não faz parte do primeiro conjunto de resultados.</span><span class="sxs-lookup"><span data-stu-id="eba7b-180">Therefore, with these connection managers, the task ignores an error returned by an SQL command or a stored procedure when the error is not part of the first result set.</span></span>  
  
-   <span data-ttu-id="eba7b-181">Quando você usa gerenciadores de conexões ODBC e ADO.NET, a tarefa não ignora os conjuntos de resultados que ocorrem após o primeiro conjunto de resultados.</span><span class="sxs-lookup"><span data-stu-id="eba7b-181">When you use ODBC and ADO.NET connection managers, the task does not ignore result sets that occur after the first result set.</span></span> <span data-ttu-id="eba7b-182">Com esses gerenciadores de conexões, a tarefa falhará quando ocorrer um erro que não seja do primeiro conjunto de resultados.</span><span class="sxs-lookup"><span data-stu-id="eba7b-182">With these connection managers, the task will fail with an error when a result set other than the first result set contains an error.</span></span>  
  
### <a name="custom-log-entries"></a><span data-ttu-id="eba7b-183">Entradas personalizadas do log</span><span class="sxs-lookup"><span data-stu-id="eba7b-183">Custom Log Entries</span></span>  
 <span data-ttu-id="eba7b-184">A tabela a seguir descreve a entrada de log personalizada da tarefa Executar SQL.</span><span class="sxs-lookup"><span data-stu-id="eba7b-184">The following table describes the custom log entry for the Execute SQL task.</span></span> <span data-ttu-id="eba7b-185">Para obter mais informações, consulte [Log do SSIS &#40;Integration Services&#41;](../performance/integration-services-ssis-logging.md) e [Mensagens personalizadas para log](../custom-messages-for-logging.md).</span><span class="sxs-lookup"><span data-stu-id="eba7b-185">For more information, see [Integration Services &#40;SSIS&#41; Logging](../performance/integration-services-ssis-logging.md) and [Custom Messages for Logging](../custom-messages-for-logging.md).</span></span>  
  
|<span data-ttu-id="eba7b-186">Entrada de log</span><span class="sxs-lookup"><span data-stu-id="eba7b-186">Log entry</span></span>|<span data-ttu-id="eba7b-187">Descrição</span><span class="sxs-lookup"><span data-stu-id="eba7b-187">Description</span></span>|  
|---------------|-----------------|  
|`ExecuteSQLExecutingQuery`|<span data-ttu-id="eba7b-188">Fornece informações sobre as fases de execução da instrução SQL.</span><span class="sxs-lookup"><span data-stu-id="eba7b-188">Provides information about the execution phases of the SQL statement.</span></span> <span data-ttu-id="eba7b-189">As entradas de log são gravadas quando a tarefa adquire conexão com o banco de dados, quando a tarefa começa a preparar a instrução SQL e depois que a execução da instrução SQL é concluída.</span><span class="sxs-lookup"><span data-stu-id="eba7b-189">Log entries are written when the task acquires connection to the database, when the task starts to prepare the SQL statement, and after the execution of the SQL statement is completed.</span></span> <span data-ttu-id="eba7b-190">A entrada de log da fase de preparação inclui a instrução SQL usada pela tarefa.</span><span class="sxs-lookup"><span data-stu-id="eba7b-190">The log entry for the prepare phase includes the SQL statement that the task uses.</span></span>|  
  
## <a name="configuring-the-execute-sql-task"></a><span data-ttu-id="eba7b-191">Configurando a tarefa Executar SQL</span><span class="sxs-lookup"><span data-stu-id="eba7b-191">Configuring the Execute SQL Task</span></span>  
 <span data-ttu-id="eba7b-192">Você pode configurar a tarefa Executar SQL das seguintes formas:</span><span class="sxs-lookup"><span data-stu-id="eba7b-192">You can configure the Execute SQL task in the following ways:</span></span>  
  
-   <span data-ttu-id="eba7b-193">Especifique o tipo de gerenciador de conexões a ser usado para conectar-se a um banco de dados.</span><span class="sxs-lookup"><span data-stu-id="eba7b-193">Specify the type of connection manager to use to connect to a database.</span></span>  
  
-   <span data-ttu-id="eba7b-194">Especifique o tipo de conjunto de resultados retornado pela instrução SQL.</span><span class="sxs-lookup"><span data-stu-id="eba7b-194">Specify the type of result set that the SQL statement returns.</span></span>  
  
-   <span data-ttu-id="eba7b-195">Especifique um tempo limite para as instruções SQL.</span><span class="sxs-lookup"><span data-stu-id="eba7b-195">Specify a time-out for the SQL statements.</span></span>  
  
-   <span data-ttu-id="eba7b-196">Especifique a origem da instrução SQL.</span><span class="sxs-lookup"><span data-stu-id="eba7b-196">Specify the source of the SQL statement.</span></span>  
  
-   <span data-ttu-id="eba7b-197">Indique se a tarefa ignora a fase de preparação para a instrução SQL.</span><span class="sxs-lookup"><span data-stu-id="eba7b-197">Indicate whether the task skips the prepare phase for the SQL statement.</span></span>  
  
-   <span data-ttu-id="eba7b-198">Se você usar o tipo de conexão ADO, indique se a instrução SQL é um procedimento armazenado.</span><span class="sxs-lookup"><span data-stu-id="eba7b-198">If you use the ADO connection type, you must indicate whether the SQL statement is a stored procedure.</span></span> <span data-ttu-id="eba7b-199">Para outros tipos de conexão, essa propriedade é somente leitura e seu valor é sempre `false`.</span><span class="sxs-lookup"><span data-stu-id="eba7b-199">For other connection types, this property is read-only and its value is always `false`.</span></span>  
  
 <span data-ttu-id="eba7b-200">Você pode definir propriedades programaticamente ou por meio do Designer [!INCLUDE[ssIS](../../includes/ssis-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="eba7b-200">You can set properties programmatically or through [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer.</span></span>  
  
 <span data-ttu-id="eba7b-201">Para obter mais informações sobre as propriedades que podem ser definidas no [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, clique em um dos seguintes tópicos:</span><span class="sxs-lookup"><span data-stu-id="eba7b-201">For more information about the properties that you can set in [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, click one of the following topics:</span></span>  
  
-   [<span data-ttu-id="eba7b-202">Editor da tarefa Executar SQL &#40;página Geral&#41;</span><span class="sxs-lookup"><span data-stu-id="eba7b-202">Execute SQL Task Editor &#40;General Page&#41;</span></span>](../execute-sql-task-editor-general-page.md)  
  
-   [<span data-ttu-id="eba7b-203">Editor da tarefa Executar SQL &#40;página mapeamento de parâmetro&#41;</span><span class="sxs-lookup"><span data-stu-id="eba7b-203">Execute SQL Task Editor &#40;Parameter Mapping Page&#41;</span></span>](../execute-sql-task-editor-parameter-mapping-page.md)  
  
-   [<span data-ttu-id="eba7b-204">Editor da tarefa Executar SQL &#40;página conjunto de resultados&#41;</span><span class="sxs-lookup"><span data-stu-id="eba7b-204">Execute SQL Task Editor &#40;Result Set Page&#41;</span></span>](../execute-sql-task-editor-result-set-page.md)  
  
-   [<span data-ttu-id="eba7b-205">Página Expressões</span><span class="sxs-lookup"><span data-stu-id="eba7b-205">Expressions Page</span></span>](../expressions/expressions-page.md)  
  
 <span data-ttu-id="eba7b-206">Para obter mais informações sobre como definir essas propriedades no [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, clique no tópico a seguir:</span><span class="sxs-lookup"><span data-stu-id="eba7b-206">For more information about how to set these properties in [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, click the following topic:</span></span>  
  
-   [<span data-ttu-id="eba7b-207">Definir as propriedades de uma tarefa ou contêiner</span><span class="sxs-lookup"><span data-stu-id="eba7b-207">Set the Properties of a Task or Container</span></span>](../set-the-properties-of-a-task-or-container.md)  
  
## <a name="configuring-the-execute-sql-task-programmatically"></a><span data-ttu-id="eba7b-208">Configurando a tarefa Executar SQL programaticamente</span><span class="sxs-lookup"><span data-stu-id="eba7b-208">Configuring the Execute SQL Task Programmatically</span></span>  
 <span data-ttu-id="eba7b-209">Para obter mais informações sobre como definir essas propriedades programaticamente, clique no tópico a seguir:</span><span class="sxs-lookup"><span data-stu-id="eba7b-209">For more information about programmatically setting these properties, click the following topic:</span></span>  
  
-   <xref:Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask>  
  
## <a name="related-tasks"></a><span data-ttu-id="eba7b-210">Related Tasks</span><span class="sxs-lookup"><span data-stu-id="eba7b-210">Related Tasks</span></span>  
  
-   [<span data-ttu-id="eba7b-211">Mapear parâmetros de consulta para variáveis em uma tarefa Executar SQL</span><span class="sxs-lookup"><span data-stu-id="eba7b-211">Map Query Parameters to Variables in an Execute SQL Task</span></span>](../map-query-parameters-to-variables-in-an-execute-sql-task.md)  
  
-   [<span data-ttu-id="eba7b-212">Mapear conjuntos de resultados para variáveis em uma tarefa Executar SQL</span><span class="sxs-lookup"><span data-stu-id="eba7b-212">Map Result Sets to Variables in an Execute SQL Task</span></span>](../map-result-sets-to-variables-in-an-execute-sql-task.md)  
  
## <a name="related-content"></a><span data-ttu-id="eba7b-213">Conteúdo relacionado</span><span class="sxs-lookup"><span data-stu-id="eba7b-213">Related Content</span></span>  
  
-   [<span data-ttu-id="eba7b-214">Parâmetros e códigos de retorno na Tarefa Executar SQL</span><span class="sxs-lookup"><span data-stu-id="eba7b-214">Parameters and Return Codes in the Execute SQL Task</span></span>](execute-sql-task.md)  
  
-   [<span data-ttu-id="eba7b-215">Conjuntos de resultados na tarefa Executar SQL</span><span class="sxs-lookup"><span data-stu-id="eba7b-215">Result Sets in the Execute SQL Task</span></span>](../result-sets-in-the-execute-sql-task.md)  
  
-   [<span data-ttu-id="eba7b-216">Referência do Transact-SQL &#40;Mecanismo de Banco de Dados&#41;</span><span class="sxs-lookup"><span data-stu-id="eba7b-216">Transact-SQL Reference &#40;Database Engine&#41;</span></span>](/sql/t-sql/language-reference)  
  
-   <span data-ttu-id="eba7b-217">Entrada de blog, [Novas funções de data e hora no SQL Server 2012](https://go.microsoft.com/fwlink/?LinkId=239783)em mssqltips.com</span><span class="sxs-lookup"><span data-stu-id="eba7b-217">Blog entry, [New Date and Time Functions in SQL Server 2012](https://go.microsoft.com/fwlink/?LinkId=239783), on mssqltips.com</span></span>  
  
  
