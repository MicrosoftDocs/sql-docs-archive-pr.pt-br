---
title: Tarefa Script | Microsoft Docs
ms.custom: ''
ms.date: 03/08/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.dts.designer.scripttask.f1
helpviewer_keywords:
- scripts [Integration Services], tasks
- Script task [Integration Services], about Script task
- Script task [Integration Services]
ms.assetid: f6cce7df-4bd6-4b75-9f89-6c37b4bb5558
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 69c051994eb06cbab041db3db2683a487a6e1994
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87568735"
---
# <a name="script-task"></a><span data-ttu-id="e28e2-102">Tarefa Script</span><span class="sxs-lookup"><span data-stu-id="e28e2-102">Script Task</span></span>
  <span data-ttu-id="e28e2-103">A tarefa Script fornece código para execução de funções que não estão disponíveis nas tarefas internas e transformações fornecidas pelo [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e28e2-103">The Script task provides code to perform functions that are not available in the built-in tasks and transformations that [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] provides.</span></span> <span data-ttu-id="e28e2-104">A tarefa Script também pode combinar funções em um script em vez de usar tarefas e transformações múltiplas.</span><span class="sxs-lookup"><span data-stu-id="e28e2-104">The Script task can also combine functions in one script instead of using multiple tasks and transformations.</span></span> <span data-ttu-id="e28e2-105">A tarefa Script é usada para trabalho que deve ser feito uma vez em um pacote (ou uma vez por objeto enumerado), e não para trabalho a ser feito uma vez por linha de dados.</span><span class="sxs-lookup"><span data-stu-id="e28e2-105">You use the Script task for work that must be done once in a package (or once per enumerated object), instead than once per data row.</span></span>  
  
 <span data-ttu-id="e28e2-106">A tarefa Script pode ser usada para os seguintes propósitos:</span><span class="sxs-lookup"><span data-stu-id="e28e2-106">You can use the Script task for the following purposes:</span></span>  
  
-   <span data-ttu-id="e28e2-107">Acessar dados usando outras tecnologias para as quais os tipos de conexão interna não dão suporte.</span><span class="sxs-lookup"><span data-stu-id="e28e2-107">Access data by using other technologies that are not supported by built-in connection types.</span></span> <span data-ttu-id="e28e2-108">Por exemplo, um script pode usar o ADSI (Active Directory Service Interfaces) para acessar e extrair os nomes de usuário do Active Directory.</span><span class="sxs-lookup"><span data-stu-id="e28e2-108">For example, a script can use Active Directory Service Interfaces (ADSI) to access and extract user names from Active Directory.</span></span>  
  
-   <span data-ttu-id="e28e2-109">Criar um contador de desempenho específico de pacote.</span><span class="sxs-lookup"><span data-stu-id="e28e2-109">Create a package-specific performance counter.</span></span> <span data-ttu-id="e28e2-110">Por exemplo, um script pode criar um contador de desempenho que é atualizado enquanto uma tarefa de desempenho complexo ou insatisfatório é executada.</span><span class="sxs-lookup"><span data-stu-id="e28e2-110">For example, a script can create a performance counter that is updated while a complex or poorly performing task runs.</span></span>  
  
-   <span data-ttu-id="e28e2-111">Identificar se os arquivos especificados estão vazios ou quantas filas eles contêm e com base nessa informação afetar o fluxo de controle em um pacote.</span><span class="sxs-lookup"><span data-stu-id="e28e2-111">Identify whether specified files are empty or how many rows they contain, and then based on that information affect the control flow in a package.</span></span> <span data-ttu-id="e28e2-112">Por exemplo, se um arquivo não contiver nenhuma linha, o valor de uma variável definido como 0, e uma restrição de precedência que avalia o valor impedir que uma tarefa Sistema de Arquivos copie o arquivo.</span><span class="sxs-lookup"><span data-stu-id="e28e2-112">For example, if a file contains zero rows, the value of a variable set to 0, and a precedence constraint that evaluates the value prevents a File System task from copying the file.</span></span>  
  
 <span data-ttu-id="e28e2-113">Se você tiver que usar o script para fazer o mesmo trabalho para cada linha de dados em um conjunto, use o componente Script no lugar da tarefa Script.</span><span class="sxs-lookup"><span data-stu-id="e28e2-113">If you have to use the script to do the same work for each row of data in a set, you should use the Script component instead of the Script task.</span></span> <span data-ttu-id="e28e2-114">Por exemplo, para avaliar a racionalidade de um valor de postagem e ignorar linhas de dados com valores muito altos ou baixos, use um componente Script.</span><span class="sxs-lookup"><span data-stu-id="e28e2-114">For example, if you want to assess the reasonableness of a postage amount and skip data rows that have very high or low amounts, you would use a Script component.</span></span> <span data-ttu-id="e28e2-115">Para obter mais informações, consulte [Script Component](../data-flow/transformations/script-component.md).</span><span class="sxs-lookup"><span data-stu-id="e28e2-115">For more information, see [Script Component](../data-flow/transformations/script-component.md).</span></span>  
  
 <span data-ttu-id="e28e2-116">Se mais de um pacote usar um script, considere gravar uma tarefa personalizada em vez de usar a tarefa Script.</span><span class="sxs-lookup"><span data-stu-id="e28e2-116">If more than one package uses a script, consider writing a custom task instead of using the Script task.</span></span> <span data-ttu-id="e28e2-117">Para obter mais informações, consulte [Desenvolvendo uma tarefa personalizada](../extending-packages-custom-objects/task/developing-a-custom-task.md).</span><span class="sxs-lookup"><span data-stu-id="e28e2-117">For more information, see [Developing a Custom Task](../extending-packages-custom-objects/task/developing-a-custom-task.md).</span></span>  
  
 <span data-ttu-id="e28e2-118">Depois de decidir que a tarefa Script é a escolha apropriada para seu pacote, você precisa desenvolver o script usado pela tarefa e configurar a própria tarefa.</span><span class="sxs-lookup"><span data-stu-id="e28e2-118">After you decide that the Script task is the appropriate choice for your package, you have to both develop the script that the task uses and configure the task itself.</span></span>  
  
## <a name="writing-and-running-the-script-that-the-task-uses"></a><span data-ttu-id="e28e2-119">Gravando e executando o Script usado pela tarefa</span><span class="sxs-lookup"><span data-stu-id="e28e2-119">Writing and Running the Script that the Task Uses</span></span>  
 <span data-ttu-id="e28e2-120">A tarefa Script usa o [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] Tools for Applications (VSTA) como o ambiente no qual você grava os scripts e o mecanismo que executa esses scripts.</span><span class="sxs-lookup"><span data-stu-id="e28e2-120">The Script task uses [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] Tools for Applications (VSTA) as the environment in which you write the scripts and the engine that runs those scripts.</span></span>  
  
 <span data-ttu-id="e28e2-121">O VSTA fornece todos os recursos padrão do ambiente [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] , como o editor [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] codificado por cor, o IntelliSense e o **Pesquisador de Objetos**.</span><span class="sxs-lookup"><span data-stu-id="e28e2-121">VSTA provides all the standard features of the [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] environment, such as the color-coded [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] editor, IntelliSense, and **Object Explorer**.</span></span> <span data-ttu-id="e28e2-122">O VSTA também usa o mesmo depurador usado por outras ferramentas de desenvolvimento [!INCLUDE[msCoName](../../includes/msconame-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="e28e2-122">VSTA also uses the same debugger that other [!INCLUDE[msCoName](../../includes/msconame-md.md)] development tools use.</span></span> <span data-ttu-id="e28e2-123">Os pontos de interrupção no script funcionam de forma consistente com os pontos de interrupção em tarefas e contêineres do [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="e28e2-123">Breakpoints in the script work seamlessly with breakpoints on [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] tasks and containers.</span></span> <span data-ttu-id="e28e2-124">O VSTA dá suporte às linguagens de programação [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Basic e [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual C#.</span><span class="sxs-lookup"><span data-stu-id="e28e2-124">VSTA supports both the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Basic and [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual C# programming languages.</span></span>  
  
 <span data-ttu-id="e28e2-125">Para executar um script é necessário ter VSTA instalado no computador onde o pacote é executado.</span><span class="sxs-lookup"><span data-stu-id="e28e2-125">To run a script, you must have VSTA installed on the computer where the package runs.</span></span> <span data-ttu-id="e28e2-126">Quando o pacote é executado, a tarefa carrega o mecanismo de script e executa o script.</span><span class="sxs-lookup"><span data-stu-id="e28e2-126">When the package runs, the task loads the script engine and runs the script.</span></span> <span data-ttu-id="e28e2-127">Você pode acessar assemblies .NET externos em scripts adicionando referências aos assemblies no projeto.</span><span class="sxs-lookup"><span data-stu-id="e28e2-127">You can access external .NET assemblies in scripts by adding references to the assemblies in the project.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e28e2-128">Ao contrário das versões anteriores em que você podia indicar se os scripts eram pré-compilados, todos os scripts são pré-compilados no [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)] e em versões posteriores.</span><span class="sxs-lookup"><span data-stu-id="e28e2-128">Unlike earlier versions where you could indicate whether the scripts were precompiled, all scripts are precompiled in [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)] and later versions.</span></span> <span data-ttu-id="e28e2-129">Quando um script é pré-compilado, o mecanismo de linguagem não é carregado no tempo de execução e o pacote é executado mais rapidamente.</span><span class="sxs-lookup"><span data-stu-id="e28e2-129">When a script is precompiled, the language engine is not loaded at run time and the package runs more quickly.</span></span> <span data-ttu-id="e28e2-130">No entanto, arquivos binários pré-compilados consomem espaço significativo em disco.</span><span class="sxs-lookup"><span data-stu-id="e28e2-130">However, precompiled binary files consume significant disk space.</span></span>  
  
## <a name="configuring-the-script-task"></a><span data-ttu-id="e28e2-131">Configurando a tarefa Script</span><span class="sxs-lookup"><span data-stu-id="e28e2-131">Configuring the Script Task</span></span>  
 <span data-ttu-id="e28e2-132">Você pode configurar a tarefa Script das seguintes formas:</span><span class="sxs-lookup"><span data-stu-id="e28e2-132">You can configure the Script task in the following ways:</span></span>  
  
-   <span data-ttu-id="e28e2-133">Forneça o script personalizado executado pela tarefa.</span><span class="sxs-lookup"><span data-stu-id="e28e2-133">Provide the custom script that the task runs.</span></span>  
  
-   <span data-ttu-id="e28e2-134">Especifique o método no projeto VSTA que o runtime [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] chama como o ponto de entrada no código da tarefa Script.</span><span class="sxs-lookup"><span data-stu-id="e28e2-134">Specify the method in the VSTA project that the [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] runtime calls as the entry point into the Script task code.</span></span>  
  
-   <span data-ttu-id="e28e2-135">Especifique a linguagem do script.</span><span class="sxs-lookup"><span data-stu-id="e28e2-135">Specify the script language.</span></span>  
  
-   <span data-ttu-id="e28e2-136">Opcionalmente, forneça listas somente leitura e variáveis de leitura/gravação para uso no script.</span><span class="sxs-lookup"><span data-stu-id="e28e2-136">Optionally, provide lists of read-only and read/write variables for use in the script.</span></span>  
  
 <span data-ttu-id="e28e2-137">Você pode definir essas propriedades com o Designer [!INCLUDE[ssIS](../../includes/ssis-md.md)] ou programaticamente.</span><span class="sxs-lookup"><span data-stu-id="e28e2-137">You can set these properties through [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer or programmatically.</span></span>  
  
### <a name="configuring-the-script-task-in-the-designer"></a><span data-ttu-id="e28e2-138">Configurando a tarefa Script no Designer</span><span class="sxs-lookup"><span data-stu-id="e28e2-138">Configuring the Script Task in the Designer</span></span>  
 <span data-ttu-id="e28e2-139">A tabela a seguir descreve o evento `ScriptTaskLogEntry` que pode ser registrado para a tarefa Script.</span><span class="sxs-lookup"><span data-stu-id="e28e2-139">The following table describes the `ScriptTaskLogEntry` event that can be logged for Script task.</span></span> <span data-ttu-id="e28e2-140">O `ScriptTaskLogEntry` evento é selecionado para registro na guia **detalhes** da caixa de diálogo **Configurar Logs do SSIS** .</span><span class="sxs-lookup"><span data-stu-id="e28e2-140">The `ScriptTaskLogEntry` event is selected for logging on the **Details** tab of the **Configure SSIS Logs** dialog box.</span></span> <span data-ttu-id="e28e2-141">Para obter mais informações, consulte [Log do SSIS &#40;Integration Services&#41;](../performance/integration-services-ssis-logging.md) e [Mensagens personalizadas para log](../custom-messages-for-logging.md).</span><span class="sxs-lookup"><span data-stu-id="e28e2-141">For more information, see [Integration Services &#40;SSIS&#41; Logging](../performance/integration-services-ssis-logging.md) and [Custom Messages for Logging](../custom-messages-for-logging.md).</span></span>  
  
|<span data-ttu-id="e28e2-142">Entrada de log</span><span class="sxs-lookup"><span data-stu-id="e28e2-142">Log entry</span></span>|<span data-ttu-id="e28e2-143">Descrição</span><span class="sxs-lookup"><span data-stu-id="e28e2-143">Description</span></span>|  
|---------------|-----------------|  
|`ScriptTaskLogEntry`|<span data-ttu-id="e28e2-144">Informa os resultados da implementação do registro em log no script.</span><span class="sxs-lookup"><span data-stu-id="e28e2-144">Reports the results of implementing logging in the script.</span></span> <span data-ttu-id="e28e2-145">A tarefa grava uma entrada de log para cada chamada ao método `Log` do objeto `Dts`.</span><span class="sxs-lookup"><span data-stu-id="e28e2-145">The task writes a log entry for each call to the `Log` method of the `Dts` object.</span></span> <span data-ttu-id="e28e2-146">A tarefa grava essas entradas quando o código é executado.</span><span class="sxs-lookup"><span data-stu-id="e28e2-146">The task writes these entries when the code is run.</span></span> <span data-ttu-id="e28e2-147">Para obter mais informações, consulte [Registro em log na Tarefa Script](../extending-packages-scripting/task/logging-in-the-script-task.md).</span><span class="sxs-lookup"><span data-stu-id="e28e2-147">For more information, see [Logging in the Script Task](../extending-packages-scripting/task/logging-in-the-script-task.md).</span></span>|  
  
 <span data-ttu-id="e28e2-148">Para obter mais informações sobre as propriedades que podem ser definidas no [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, consulte os tópicos a seguir:</span><span class="sxs-lookup"><span data-stu-id="e28e2-148">For more information about the properties that you can set in [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, see the following topics:</span></span>  
  
-   [<span data-ttu-id="e28e2-149">Editor da Tarefa Script &#40;Página Geral&#41;</span><span class="sxs-lookup"><span data-stu-id="e28e2-149">Script Task Editor &#40;General Page&#41;</span></span>](../general-page-of-integration-services-designers-options.md)  
  
-   [<span data-ttu-id="e28e2-150">Editor da Tarefa Script &#40;Página Script&#41;</span><span class="sxs-lookup"><span data-stu-id="e28e2-150">Script Task Editor &#40;Script Page&#41;</span></span>](../script-task-editor-script-page.md)  
  
-   [<span data-ttu-id="e28e2-151">Página Expressões</span><span class="sxs-lookup"><span data-stu-id="e28e2-151">Expressions Page</span></span>](../expressions/expressions-page.md)  
  
 <span data-ttu-id="e28e2-152">Para obter mais informações sobre como definir essas propriedades no [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, consulte o tópico a seguir:</span><span class="sxs-lookup"><span data-stu-id="e28e2-152">For more information about how to set these properties in [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, see the following topic:</span></span>  
  
-   [<span data-ttu-id="e28e2-153">Definir as propriedades de uma tarefa ou contêiner</span><span class="sxs-lookup"><span data-stu-id="e28e2-153">Set the Properties of a Task or Container</span></span>](../set-the-properties-of-a-task-or-container.md)  
  
### <a name="configuring-the-script-task-programmatically"></a><span data-ttu-id="e28e2-154">Configurando a tarefa Script programaticamente</span><span class="sxs-lookup"><span data-stu-id="e28e2-154">Configuring the Script Task Programmatically</span></span>  
 <span data-ttu-id="e28e2-155">Para obter mais informações sobre como definir essas propriedades programaticamente, veja o tópico a seguir:</span><span class="sxs-lookup"><span data-stu-id="e28e2-155">For more information about programmatically setting these properties, see the following topic:</span></span>  
  
-   <xref:Microsoft.SqlServer.Dts.Tasks.ScriptTask.ScriptTask>  
  
## <a name="related-content"></a><span data-ttu-id="e28e2-156">Conteúdo relacionado</span><span class="sxs-lookup"><span data-stu-id="e28e2-156">Related Content</span></span>  
  
-   <span data-ttu-id="e28e2-157">Artigo técnico sobre [Como enviar email com notificação de entrega em C#](https://go.microsoft.com/fwlink/?LinkId=237625)no site shareourideas.com</span><span class="sxs-lookup"><span data-stu-id="e28e2-157">Technical article, [How to send email with delivery notification in C#](https://go.microsoft.com/fwlink/?LinkId=237625), on shareourideas.com</span></span>  
  
  
