---
title: Reiniciar pacotes por meio de pontos de verificação | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- checkpoints [Integration Services]
- restarting packages
- starting packages
ms.assetid: 48f2fbb7-8964-484a-8311-5126cf594bfb
author: chugugrace
ms.author: chugu
ms.openlocfilehash: aa0e0e9ad1da67bfc70dec61396ab026df62d3ee
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87575194"
---
# <a name="restart-packages-by-using-checkpoints"></a><span data-ttu-id="6df92-102">Reiniciar pacotes por meio de pontos de verificação</span><span class="sxs-lookup"><span data-stu-id="6df92-102">Restart Packages by Using Checkpoints</span></span>
  [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] <span data-ttu-id="6df92-103">pode reinicializar pacotes que falharam a partir do ponto de falha, em vez de executar novamente todo o pacote.</span><span class="sxs-lookup"><span data-stu-id="6df92-103">can restart failed packages from the point of failure, instead of rerunning the whole package.</span></span> <span data-ttu-id="6df92-104">Se um pacote estiver configurado para usar pontos de verificação, serão gravadas informações sobre a execução do pacote em um arquivo de ponto de verificação.</span><span class="sxs-lookup"><span data-stu-id="6df92-104">If a package is configured to use checkpoints, information about package execution is written to a checkpoint file.</span></span> <span data-ttu-id="6df92-105">Quando o pacote com falha é executado novamente, o arquivo do ponto de verificação é usado para reiniciar o pacote a partir do ponto de falha.</span><span class="sxs-lookup"><span data-stu-id="6df92-105">When the failed package is rerun, the checkpoint file is used to restart the package from the point of failure.</span></span> <span data-ttu-id="6df92-106">Se o pacote for executado com êxito, o arquivo de ponto de verificação é excluído e recriado na próxima vez que o pacote for executado.</span><span class="sxs-lookup"><span data-stu-id="6df92-106">If the package runs successfully, the checkpoint file is deleted, and then re-created the next time the package is run.</span></span>  
  
 <span data-ttu-id="6df92-107">Usar pontos de verificação em um pacote fornece os seguintes benefícios:</span><span class="sxs-lookup"><span data-stu-id="6df92-107">Using checkpoints in a package can provide the following benefits.</span></span>  
  
-   <span data-ttu-id="6df92-108">Evite repetir o download e o upload de arquivos grandes.</span><span class="sxs-lookup"><span data-stu-id="6df92-108">Avoid repeating the downloading and uploading of large files.</span></span> <span data-ttu-id="6df92-109">Por exemplo, um pacote que baixa diversos arquivos grandes usando uma tarefa FTP para cada download pode ser reiniciado após o download de um único arquivo falhar e baixar apenas aquele arquivo.</span><span class="sxs-lookup"><span data-stu-id="6df92-109">For example, a package that downloads multiple large files by using an FTP task for each download can be restarted after the downloading of a single file fails and then download only that file.</span></span>  
  
-   <span data-ttu-id="6df92-110">Evite repetir o carregamento de grandes quantidades de dados.</span><span class="sxs-lookup"><span data-stu-id="6df92-110">Avoid repeating the loading of large amounts of data.</span></span> <span data-ttu-id="6df92-111">Por exemplo, um pacote que realiza inserções em massa em tabelas de dimensão em um data warehouse usando uma tarefa Inserção em Massa diferente para cada dimensão pode ser reiniciado se a inserção falhar em uma tabela de dimensão e apenas essa dimensão será recarregada.</span><span class="sxs-lookup"><span data-stu-id="6df92-111">For example, a package that performs bulk inserts into dimension tables in a data warehouse using a different Bulk Insert task for each dimension can be restarted if the insertion fails for one dimension table, and only that dimension will be reloaded.</span></span>  
  
-   <span data-ttu-id="6df92-112">Evite repetir a agregação de valores.</span><span class="sxs-lookup"><span data-stu-id="6df92-112">Avoid repeating the aggregation of values.</span></span> <span data-ttu-id="6df92-113">Por exemplo, um pacote que computa muitas agregações, como médias e somas, usando uma tarefa de Fluxo de Dados separada para realizar cada agregação, pode ser reiniciado após computar uma falha de agregação e somente essa agregação será computada novamente.</span><span class="sxs-lookup"><span data-stu-id="6df92-113">For example, a package that computes many aggregates, such as averages and sums, using a separate Data Flow task to perform each aggregation, can be restarted after computing an aggregation fails and only that aggregation will be recomputed.</span></span>  
  
 <span data-ttu-id="6df92-114">Se um pacote for configurado para usar pontos de verificação, o [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] capturará o ponto de reinicialização no arquivo de ponto de verificação.</span><span class="sxs-lookup"><span data-stu-id="6df92-114">If a package is configured to use checkpoints, [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] captures the restart point in the checkpoint file.</span></span> <span data-ttu-id="6df92-115">O tipo de contêiner que falha e a implementação de recursos como transações afetam o ponto de reinicialização registrado no arquivo de ponto de verificação.</span><span class="sxs-lookup"><span data-stu-id="6df92-115">The type of container that fails and the implementation of features such as transactions affect the restart point that is recorded in the checkpoint file.</span></span> <span data-ttu-id="6df92-116">Os valores atuais das variáveis também são capturados no arquivo de ponto de verificação.</span><span class="sxs-lookup"><span data-stu-id="6df92-116">The current values of variables are also captured in the checkpoint file.</span></span> <span data-ttu-id="6df92-117">No entanto, os valores de variáveis que têm o tipo de dados `Object` não são salvos em arquivos de ponto de verificação.</span><span class="sxs-lookup"><span data-stu-id="6df92-117">However, the values of variables that have the `Object` data type are not saved in checkpoint files.</span></span>  
  
## <a name="defining-restart-points"></a><span data-ttu-id="6df92-118">Definindo os pontos de reinicialização</span><span class="sxs-lookup"><span data-stu-id="6df92-118">Defining Restart Points</span></span>  
 <span data-ttu-id="6df92-119">O contêiner host da tarefa que encapsula uma única tarefa é a menor unidade atômica de trabalho que pode ser reiniciada.</span><span class="sxs-lookup"><span data-stu-id="6df92-119">The task host container, which encapsulates a single task, is the smallest atomic unit of work that can be restarted.</span></span> <span data-ttu-id="6df92-120">O contêiner Loop Foreach e um contêiner transacionado também são tratados como unidades atômicas de trabalho.</span><span class="sxs-lookup"><span data-stu-id="6df92-120">The Foreach Loop container and a transacted container are also treated as atomic units of work.</span></span>  
  
 <span data-ttu-id="6df92-121">Se um pacote for interrompido enquanto um contêiner transacionado estiver executando, a transação será encerrada e qualquer trabalho realizado pelo contêiner será revertido.</span><span class="sxs-lookup"><span data-stu-id="6df92-121">If a package is stopped while a transacted container is running, the transaction ends and any work performed by the container is rolled back.</span></span> <span data-ttu-id="6df92-122">Quando o pacote for reinicializado, o contêiner que falhou será executado novamente.</span><span class="sxs-lookup"><span data-stu-id="6df92-122">When the package is restarted, the container that failed is rerun.</span></span> <span data-ttu-id="6df92-123">A conclusão de qualquer contêiner filho de contêiner transacionado não é registrada no arquivo de ponto de verificação.</span><span class="sxs-lookup"><span data-stu-id="6df92-123">The completion of any child containers of transacted container is not recorded in the checkpoint file.</span></span> <span data-ttu-id="6df92-124">Portanto, quando o pacote for reinicializado, o contêiner transacionado e seus contêineres filho serão executados novamente.</span><span class="sxs-lookup"><span data-stu-id="6df92-124">Therefore, when the package is restarted, the transacted container and its child containers run again.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="6df92-125">O uso de pontos de verificação e transações no mesmo pacote pode gerar resultados inesperados.</span><span class="sxs-lookup"><span data-stu-id="6df92-125">Using checkpoints and transactions in the same package could cause unexpected results.</span></span> <span data-ttu-id="6df92-126">Por exemplo, quando um pacote falha e é reiniciado em um ponto de verificação, o pacote pode repetir uma transação que já tenha sido confirmada com êxito.</span><span class="sxs-lookup"><span data-stu-id="6df92-126">For example, when a package fails and restarts from a checkpoint, the package might repeat a transaction that has already been successfully committed.</span></span>  
  
 <span data-ttu-id="6df92-127">Os dados do ponto de verificação não são salvos para os contêineres Loop For e Loop Foreach.</span><span class="sxs-lookup"><span data-stu-id="6df92-127">Checkpoint data is not saved for For Loop and Foreach Loop containers.</span></span> <span data-ttu-id="6df92-128">Quando um pacote é reinicializado, os contêineres Loop For e Loop Foreach e seus contêineres filho são executados novamente.</span><span class="sxs-lookup"><span data-stu-id="6df92-128">When a package is restarted, the For Loop and Foreach Loop containers and the child containers are run again.</span></span> <span data-ttu-id="6df92-129">Se um contêiner filho no loop executar com êxito, ele não será registrado no arquivo de ponto de verificação, ao invés disso ele será executado novamente.</span><span class="sxs-lookup"><span data-stu-id="6df92-129">If a child container in the loop runs successfully, it is not recorded in the checkpoint file, instead it is rerun.</span></span> <span data-ttu-id="6df92-130">Para obter mais informações e uma solução alternativa, consulte [Pontos de verificação do SSIS não são honrados para itens de contêiner Loop For ou Loop Foreach](https://go.microsoft.com/fwlink/?LinkId=241633).</span><span class="sxs-lookup"><span data-stu-id="6df92-130">For more information and a workaround, see [SSIS Checkpoints are not honored for For Loop or Foreach Loop container items](https://go.microsoft.com/fwlink/?LinkId=241633).</span></span>  
  
 <span data-ttu-id="6df92-131">Se o pacote for reiniciado as configurações do pacote não serão recarregadas, ao invés disso o pacote usará as informações de configuração gravadas no arquivo de ponto de verificação.</span><span class="sxs-lookup"><span data-stu-id="6df92-131">If the package is restarted the package configurations are not reloaded, instead the package uses the configuration information written to the checkpoint file.</span></span> <span data-ttu-id="6df92-132">Isto assegura que o pacote usará as mesmas configurações existentes no momento que falhou quando for executado novamente.</span><span class="sxs-lookup"><span data-stu-id="6df92-132">This ensures that the package uses the same configurations when it is rerun as the time it failed.</span></span>  
  
 <span data-ttu-id="6df92-133">Um pacote só pode ser reinicializado no nível de fluxo de controle.</span><span class="sxs-lookup"><span data-stu-id="6df92-133">A package can be restarted only at the control flow level.</span></span> <span data-ttu-id="6df92-134">Não é possível reinicializar um pacote no meio de um fluxo de dados.</span><span class="sxs-lookup"><span data-stu-id="6df92-134">You cannot restart a package in the middle of a data flow.</span></span> <span data-ttu-id="6df92-135">Para evitar executar novamente todo o fluxo de dados, o pacote deve ser projetado para incluir diversos fluxos de dados, cada um usando uma tarefa de Fluxo de Dados diferente.</span><span class="sxs-lookup"><span data-stu-id="6df92-135">To avoid rerunning the whole data flow, the package might be designed to include multiple data flows, each one using a different Data Flow task.</span></span> <span data-ttu-id="6df92-136">Deste modo o pacote pode ser reinicializado, executando apenas uma tarefa de Fluxo de Dados novamente.</span><span class="sxs-lookup"><span data-stu-id="6df92-136">This way the package can be restarted, rerunning only one Data Flow task.</span></span>  
  
## <a name="configuring-a-package-to-restart"></a><span data-ttu-id="6df92-137">Configurando um pacote para reiniciar</span><span class="sxs-lookup"><span data-stu-id="6df92-137">Configuring a Package to Restart</span></span>  
 <span data-ttu-id="6df92-138">O arquivo de ponto de verificação inclui os resultados da execução de todos os contêineres concluídos, os valores atuais do sistema e variáveis definidas pelo usuário e informações de configuração do pacote.</span><span class="sxs-lookup"><span data-stu-id="6df92-138">The checkpoint file includes the execution results of all completed containers, the current values of system and user-defined variables, and package configuration information.</span></span> <span data-ttu-id="6df92-139">O arquivo também inclui o identificador exclusivo do pacote.</span><span class="sxs-lookup"><span data-stu-id="6df92-139">The file also includes the unique identifier of the package.</span></span> <span data-ttu-id="6df92-140">Para reiniciar um pacote com êxito, o identificador do pacote no arquivo de ponto de verificação e o pacote devem corresponder; caso contrário a reinicialização falhará.</span><span class="sxs-lookup"><span data-stu-id="6df92-140">To successfully restart a package, the package identifier in the checkpoint file and the package must match; otherwise the restart fails.</span></span> <span data-ttu-id="6df92-141">Isto impede um pacote de usar um arquivo de ponto de verificação escrito por uma versão de pacote diferente.</span><span class="sxs-lookup"><span data-stu-id="6df92-141">This prevents a package from using a checkpoint file written by a different package version.</span></span> <span data-ttu-id="6df92-142">Se o pacote executar com êxito, após sua reinicialização o arquivo do ponto de verificação é excluído.</span><span class="sxs-lookup"><span data-stu-id="6df92-142">If the package runs successfully, after it is restarted the checkpoint file is deleted.</span></span>  
  
 <span data-ttu-id="6df92-143">A seguinte tabela lista as propriedades de pacote definidas para implementar pontos de verificação.</span><span class="sxs-lookup"><span data-stu-id="6df92-143">The following table lists the package properties that you set to implement checkpoints.</span></span>  
  
|<span data-ttu-id="6df92-144">Propriedade</span><span class="sxs-lookup"><span data-stu-id="6df92-144">Property</span></span>|<span data-ttu-id="6df92-145">DESCRIÇÃO</span><span class="sxs-lookup"><span data-stu-id="6df92-145">Description</span></span>|  
|--------------|-----------------|  
|<span data-ttu-id="6df92-146">CheckpointFileName</span><span class="sxs-lookup"><span data-stu-id="6df92-146">CheckpointFileName</span></span>|<span data-ttu-id="6df92-147">Especifica o nome do arquivo de ponto de verificação.</span><span class="sxs-lookup"><span data-stu-id="6df92-147">Specifies the name of the checkpoint file.</span></span>|  
|<span data-ttu-id="6df92-148">CheckpointUsage</span><span class="sxs-lookup"><span data-stu-id="6df92-148">CheckpointUsage</span></span>|<span data-ttu-id="6df92-149">Especifica se pontos de verificação são usados.</span><span class="sxs-lookup"><span data-stu-id="6df92-149">Specifies whether checkpoints are used.</span></span>|  
|<span data-ttu-id="6df92-150">SaveCheckpoints</span><span class="sxs-lookup"><span data-stu-id="6df92-150">SaveCheckpoints</span></span>|<span data-ttu-id="6df92-151">Indica se o pacote salva os pontos de verificação.</span><span class="sxs-lookup"><span data-stu-id="6df92-151">Indicates whether the package saves checkpoints.</span></span> <span data-ttu-id="6df92-152">Esta propriedade deve ser definida como Verdadeiro para reinicializar um pacote a partir de um ponto de falha.</span><span class="sxs-lookup"><span data-stu-id="6df92-152">This property must be set to True to restart a package from a point of failure.</span></span>|  
  
 <span data-ttu-id="6df92-153">Além disso, você deve definir a Propriedade FailPackageOnFailure como `true` para todos os contêineres no pacote que você deseja identificar como pontos de reinicialização.</span><span class="sxs-lookup"><span data-stu-id="6df92-153">Additionally, you must set the FailPackageOnFailure property to `true` for all the containers in the package that you want to identify as restart points.</span></span>  
  
 <span data-ttu-id="6df92-154">É possível usar a propriedade ForceExecutionResult para testar o uso de pontos de verificação em um pacote.</span><span class="sxs-lookup"><span data-stu-id="6df92-154">You can use the ForceExecutionResult property to test the use of checkpoints in a package.</span></span> <span data-ttu-id="6df92-155">Ao definir ForceExecutionResult de uma tarefa ou contêiner como Falha, você pode imitar uma falha em tempo real.</span><span class="sxs-lookup"><span data-stu-id="6df92-155">By setting ForceExecutionResult of a task or container to Failure, you can imitate real-time failure.</span></span> <span data-ttu-id="6df92-156">Ao executar novamente o pacote, a tarefa e os contêineres que falharam serão executados de novo.</span><span class="sxs-lookup"><span data-stu-id="6df92-156">When you rerun the package, the failed task and containers will be rerun.</span></span>  
  
### <a name="checkpoint-usage"></a><span data-ttu-id="6df92-157">Uso do ponto de verificação</span><span class="sxs-lookup"><span data-stu-id="6df92-157">Checkpoint Usage</span></span>  
 <span data-ttu-id="6df92-158">A propriedade CheckpointUsage pode ser definida com os seguintes valores:</span><span class="sxs-lookup"><span data-stu-id="6df92-158">The CheckpointUsage property can be set to the following values:</span></span>  
  
|<span data-ttu-id="6df92-159">Valor</span><span class="sxs-lookup"><span data-stu-id="6df92-159">Value</span></span>|<span data-ttu-id="6df92-160">DESCRIÇÃO</span><span class="sxs-lookup"><span data-stu-id="6df92-160">Description</span></span>|  
|-----------|-----------------|  
|`Never`|<span data-ttu-id="6df92-161">Especifica que o arquivo de ponto de verificação não é usado e o pacote executa a partir do início do fluxo de trabalho do pacote.</span><span class="sxs-lookup"><span data-stu-id="6df92-161">Specifies that the checkpoint file is not used and that the package runs from the start of the package workflow.</span></span>|  
|`Always`|<span data-ttu-id="6df92-162">Especifica que o arquivo de ponto de verificação sempre é usado e que o pacote reinicia a partir do ponto da falha de execução anterior.</span><span class="sxs-lookup"><span data-stu-id="6df92-162">Specifies that the checkpoint file is always used and that the package restarts from the point of the previous execution failure.</span></span> <span data-ttu-id="6df92-163">Se o arquivo de ponto de verificação não for localizado, o pacote falhará.</span><span class="sxs-lookup"><span data-stu-id="6df92-163">If the checkpoint file is not found, the package fails.</span></span>|  
|`IfExists`|<span data-ttu-id="6df92-164">Especifica que o arquivo de ponto de verificação é usado, se existir.</span><span class="sxs-lookup"><span data-stu-id="6df92-164">Specifies that the checkpoint file is used if it exists.</span></span> <span data-ttu-id="6df92-165">Se o arquivo de ponto de verificação existir, o pacote reiniciará a partir do ponto da falha de execução anterior; caso contrário, será executado desde o início do fluxo de trabalho do pacote.</span><span class="sxs-lookup"><span data-stu-id="6df92-165">If the checkpoint file exists, the package restarts from the point of the previous execution failure; otherwise, it runs from the start of the package workflow.</span></span>|  
  
> [!NOTE]  
>  <span data-ttu-id="6df92-166">A opção **/CheckPointing on on** de dtexec é equivalente a definir a `SaveCheckpoints` Propriedade do pacote como `True` e a `CheckpointUsage` propriedade como Always.</span><span class="sxs-lookup"><span data-stu-id="6df92-166">The **/CheckPointing on** option of dtexec is equivalent to setting the `SaveCheckpoints` property of the package to `True`, and the `CheckpointUsage` property to Always.</span></span> <span data-ttu-id="6df92-167">Para saber mais, veja [dtexec Utility](dtexec-utility.md).</span><span class="sxs-lookup"><span data-stu-id="6df92-167">For more information, see [dtexec Utility](dtexec-utility.md).</span></span>  
  
## <a name="securing-checkpoint-files"></a><span data-ttu-id="6df92-168">Protegendo arquivos de ponto de verificação</span><span class="sxs-lookup"><span data-stu-id="6df92-168">Securing Checkpoint Files</span></span>  
 <span data-ttu-id="6df92-169">A proteção em nível de pacote não inclui proteção a arquivos de ponto de verificação; você deve proteger esses arquivos separadamente.</span><span class="sxs-lookup"><span data-stu-id="6df92-169">Package level protection does not include protection of checkpoint files and you must secure these files separately.</span></span> <span data-ttu-id="6df92-170">Dados de ponto de verificação podem ser armazenados somente no sistema arquivos e você deve usar uma ACL (lista de controle de acesso) do sistema operacional para proteger o local ou a pasta onde armazena o arquivo.</span><span class="sxs-lookup"><span data-stu-id="6df92-170">Checkpoint data can be stored only in the file system and you should use an operating system access control list (ACL) to secure the location or folder where you store the file.</span></span> <span data-ttu-id="6df92-171">É importante proteger os arquivos de ponto de verificação, pois eles contém informações sobre o estado do pacote, incluindo os valores atuais de variáveis.</span><span class="sxs-lookup"><span data-stu-id="6df92-171">It is important to secure checkpoint files because they contain information about the package state, including the current values of variables.</span></span> <span data-ttu-id="6df92-172">Por exemplo, uma variável pode conter um conjunto de registros com muitas linhas de dados particulares como números de telefone.</span><span class="sxs-lookup"><span data-stu-id="6df92-172">For example, a variable may contain a recordset with many rows of private data such as telephone numbers.</span></span> <span data-ttu-id="6df92-173">Para obter mais informações, consulte [Acesso aos arquivos usados por pacotes](../access-to-files-used-by-packages.md).</span><span class="sxs-lookup"><span data-stu-id="6df92-173">For more information, see [Access to Files Used by Packages](../access-to-files-used-by-packages.md).</span></span>  
  
### <a name="to-configure-the-checkpoint-properties"></a><span data-ttu-id="6df92-174">Para configurar as propriedades de ponto de verificação</span><span class="sxs-lookup"><span data-stu-id="6df92-174">To configure the checkpoint properties</span></span>  
  
-   [<span data-ttu-id="6df92-175">Configurar pontos de verificação para reinicializar um pacote com falha</span><span class="sxs-lookup"><span data-stu-id="6df92-175">Configure Checkpoints for Restarting a Failed Package</span></span>](../configure-checkpoints-for-restarting-a-failed-package.md)  
  
## <a name="external-resources"></a><span data-ttu-id="6df92-176">Recursos externos</span><span class="sxs-lookup"><span data-stu-id="6df92-176">External Resources</span></span>  
  
-   <span data-ttu-id="6df92-177">Artigo técnico, [Reinicialização automática de pacotes de SSIS depois de Failover ou Falha](https://go.microsoft.com/fwlink/?LinkId=200407), em social.technet.microsoft.com (a página pode estar em inglês)</span><span class="sxs-lookup"><span data-stu-id="6df92-177">Technical article, [Automatic Restart of SSIS packages after Failover or Failure](https://go.microsoft.com/fwlink/?LinkId=200407), on social.technet.microsoft.com</span></span>  
  
-   <span data-ttu-id="6df92-178">ARtigo de suporte, [Pontos de verificação do SSIS não são honrados para itens de contêiner Loop For ou Loop Foreach](https://go.microsoft.com/fwlink/?LinkId=241633), em support.microsoft.com.</span><span class="sxs-lookup"><span data-stu-id="6df92-178">Support article, [SSIS Checkpoints are not honored for For Loop or Foreach Loop container items](https://go.microsoft.com/fwlink/?LinkId=241633), on support.microsoft.com.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6df92-179">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="6df92-179">See Also</span></span>  
 [<span data-ttu-id="6df92-180">SQL Server Integration Services</span><span class="sxs-lookup"><span data-stu-id="6df92-180">SQL Server Integration Services</span></span>](../sql-server-integration-services.md)  
  
  
