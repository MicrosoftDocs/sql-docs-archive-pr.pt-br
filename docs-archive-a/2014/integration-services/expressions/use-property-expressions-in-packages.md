---
title: Usar expressões de propriedade em pacotes | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- packages [Integration Services], expressions
- Integration Services packages, expressions
- SQL Server Integration Services packages, expressions
- dynamic properties
- updating package properties
- SSIS packages, expressions
- expressions [Integration Services], property expressions
- property expressions [Integration Services]
ms.assetid: a4bfc925-3ef6-431e-b1dd-7e0023d3a92d
author: chugugrace
ms.author: chugu
ms.openlocfilehash: bb373428e91cfc8cb4b26a986da6d795ab2fea98
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87581449"
---
# <a name="use-property-expressions-in-packages"></a><span data-ttu-id="ea95c-102">Usar expressões de propriedade em pacotes</span><span class="sxs-lookup"><span data-stu-id="ea95c-102">Use Property Expressions in Packages</span></span>
  <span data-ttu-id="ea95c-103">Uma expressão de propriedade é uma expressão atribuída a uma propriedade para ativar uma atualização dinâmica da propriedade no tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="ea95c-103">A property expression is an expression that is assigned to a property to enable dynamic update of the property at run time.</span></span> <span data-ttu-id="ea95c-104">Por exemplo, uma expressão de propriedade pode atualizar a linha Para se uma tarefa Enviar Email usar a inserção de emails que já estão armazenados em uma variável.</span><span class="sxs-lookup"><span data-stu-id="ea95c-104">For example, a property expression can update the To line that a Send Mail task uses by inserting an e-mail address that is stored in a variable.</span></span>

 <span data-ttu-id="ea95c-105">Uma expressão pode ser adicionada a um pacote, tarefa, Loop Foreach, Loop For, Sequência, enumerador Foreach, manipulador de eventos, gerenciador de conexões de um pacote ou nível de projeto ou provedor de logs.</span><span class="sxs-lookup"><span data-stu-id="ea95c-105">An expression can be added to a package, task, Foreach Loop, For Loop, Sequence, Foreach enumerator, event handler, a package or project level connection manager, or log provider.</span></span> <span data-ttu-id="ea95c-106">Qualquer propriedade desses objetos que são de leitura/gravação pode implementar uma expressão de propriedade.</span><span class="sxs-lookup"><span data-stu-id="ea95c-106">Any property of these objects that is read/write can implement a property expression.</span></span> [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] <span data-ttu-id="ea95c-107">também dá suporte ao uso de expressões de propriedade em algumas propriedades personalizadas de componentes de fluxo de dados.</span><span class="sxs-lookup"><span data-stu-id="ea95c-107">also supports the use of property expressions in some custom properties of data flow components.</span></span> <span data-ttu-id="ea95c-108">As variáveis e as restrições de precedência não oferecem suporte às expressões de propriedade, mas elas incluem propriedades especiais que permitem o uso de expressões.</span><span class="sxs-lookup"><span data-stu-id="ea95c-108">Variables and precedence constraints do not support property expressions, but they include special properties in which you can use expressions.</span></span>

 <span data-ttu-id="ea95c-109">As expressões de propriedade podem ser atualizadas de diferentes maneiras:</span><span class="sxs-lookup"><span data-stu-id="ea95c-109">Property expressions can be updated in different ways:</span></span>

-   <span data-ttu-id="ea95c-110">As variáveis definidas pelo usuário podem ser incluídas nas configurações do pacote e podem ser atualizadas quando o pacote for implantado.</span><span class="sxs-lookup"><span data-stu-id="ea95c-110">User-defined variables can be included in package configurations and then updated when the package is deployed.</span></span> <span data-ttu-id="ea95c-111">No momento da execução, a expressão de propriedade é avaliada usando o valor atualizado da variável.</span><span class="sxs-lookup"><span data-stu-id="ea95c-111">At run time, the property expression is evaluated using the updated variable value.</span></span>

-   <span data-ttu-id="ea95c-112">As variáveis de sistema que estão incluídas em expressões são atualizadas no tempo de execução, que altera os resultados da avaliação de propriedade.</span><span class="sxs-lookup"><span data-stu-id="ea95c-112">System variables that are included in expressions are updated at run time, which changes the results of the property evaluation.</span></span>

-   <span data-ttu-id="ea95c-113">As funções de data e hora são avaliadas no momento da execução e fornecem valores atualizados às expressões de propriedade.</span><span class="sxs-lookup"><span data-stu-id="ea95c-113">Date and time functions are evaluated at run time and provide the updated values to property expressions.</span></span>

-   <span data-ttu-id="ea95c-114">As variáveis nas expressões podem ser atualizadas pelos scripts da tarefa Script e da execução do componente Script.</span><span class="sxs-lookup"><span data-stu-id="ea95c-114">Variables in expressions can be updated by the scripts that the Script task and the Script component run.</span></span>

 <span data-ttu-id="ea95c-115">As expressões são criadas com a linguagem da expressão do [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ea95c-115">The expressions are built using the [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] expression language.</span></span> <span data-ttu-id="ea95c-116">As expressões podem usar variáveis de sistema ou definidas pelo usuário, junto com operadores, funções e conversões de tipo fornecidos pela linguagem da expressão.</span><span class="sxs-lookup"><span data-stu-id="ea95c-116">The expressions can use system or user-defined variables, together with the operators, functions, and type casts that the expression language provides.</span></span>

> [!NOTE]
>  <span data-ttu-id="ea95c-117">Os nomes das variáveis do sistema e das variáveis definidas pelo usuário diferenciam maiúsculas de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="ea95c-117">The names of user-defined and system variables are case-sensitive.</span></span>

 <span data-ttu-id="ea95c-118">Para obter mais informações, consulte [Expressões do Integration Services &#40;SSIS&#41;](integration-services-ssis-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="ea95c-118">For more information, see [Integration Services &#40;SSIS&#41; Expressions](integration-services-ssis-expressions.md).</span></span>

 <span data-ttu-id="ea95c-119">Um importante uso das expressões de propriedade é personalizar configurações para cada instância implantada de um pacote.</span><span class="sxs-lookup"><span data-stu-id="ea95c-119">An important use of property expressions is to customize configurations for each deployed instance of a package.</span></span> <span data-ttu-id="ea95c-120">Isso permite atualizar dinamicamente as propriedades de pacote para diferentes ambientes.</span><span class="sxs-lookup"><span data-stu-id="ea95c-120">This makes it possible to dynamically update package properties for different environments.</span></span> <span data-ttu-id="ea95c-121">Por exemplo, é possível criar uma expressão de propriedade que atribua uma variável à cadeia de caracteres de conexão de um gerenciador de conexões, além de atualizar a variável quando o pacote for implantado, verificando se a cadeia de caracteres de conexão está correta no tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="ea95c-121">For example, you can create a property expression that assigns a variable to the connection string of a connection manager, and then update the variable when the package is deployed, ensuring that the connection string is correct at run time.</span></span> <span data-ttu-id="ea95c-122">As configurações de pacote são carregadas antes de as expressões de propriedade serem avaliadas.</span><span class="sxs-lookup"><span data-stu-id="ea95c-122">Package configurations are loaded before the property expressions are evaluated.</span></span>

 <span data-ttu-id="ea95c-123">Uma propriedade pode usar só uma expressão de propriedade e uma expressão de propriedade só pode ser aplicada a uma propriedade.</span><span class="sxs-lookup"><span data-stu-id="ea95c-123">A property can use only one property expression and a property expression can apply only to one property.</span></span> <span data-ttu-id="ea95c-124">Entretanto, você pode construir várias expressões de propriedade idênticas e atribuí-las a diferentes propriedades.</span><span class="sxs-lookup"><span data-stu-id="ea95c-124">However, you can build multiple identical property expressions and assign them to different properties.</span></span>

 <span data-ttu-id="ea95c-125">Algumas propriedades são definidas usando valores de enumeradores.</span><span class="sxs-lookup"><span data-stu-id="ea95c-125">Some properties are set by using values from enumerators.</span></span> <span data-ttu-id="ea95c-126">Ao fazer referência ao membro do enumerador em uma expressão de propriedade, é preciso usar valores numéricos equivalentes ao nome amigável do membro do enumerador.</span><span class="sxs-lookup"><span data-stu-id="ea95c-126">When you reference the enumerator member in a property expression, you must use the numeric value that is equivalent to the friendly name of the enumerator member.</span></span> <span data-ttu-id="ea95c-127">Por exemplo, se uma expressão de propriedade define a propriedade `LoggingMode`, que usa um valor da enumeração `DTSLoggingMode`, a expressão de propriedade deve usar 0, 1 ou 2 em vez dos nomes amigáveis `Enabled`, `Disabled` ou `UseParentSetting`.</span><span class="sxs-lookup"><span data-stu-id="ea95c-127">For example, if a property expression sets the `LoggingMode` property, which uses a value from the `DTSLoggingMode` enumeration, the property expression must use 0, 1, or 2 instead of the friendly names `Enabled`, `Disabled`, or `UseParentSetting`.</span></span> <span data-ttu-id="ea95c-128">Para obter mais informações, consulte [Constantes enumeradas em expressões de propriedade](enumerated-constants-in-property-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="ea95c-128">For more information, see [Enumerated Constants in Property Expressions](enumerated-constants-in-property-expressions.md).</span></span>

## <a name="property-expression-user-interface"></a><span data-ttu-id="ea95c-129">Interface de Usuário da Expressão de Propriedade</span><span class="sxs-lookup"><span data-stu-id="ea95c-129">Property Expression User Interface</span></span>
 [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] <span data-ttu-id="ea95c-130">fornece um conjunto de ferramentas para construir e gerenciar as expressões de propriedade.</span><span class="sxs-lookup"><span data-stu-id="ea95c-130">provides a set of tools for building and managing property expressions.</span></span>

-   <span data-ttu-id="ea95c-131">A página **Expressões** , localizada nos editores personalizados para tarefas, o contêiner do Loop For e os contêineres Foreach.</span><span class="sxs-lookup"><span data-stu-id="ea95c-131">The **Expressions** page, found in the custom editors for tasks, the For Loop container, and the Foreach containers.</span></span> <span data-ttu-id="ea95c-132">A página **Expressões** permite editar as expressões e exibir uma lista de expressões de propriedade que usados por uma tarefa, por um Loop Foreach ou por um Loop For.</span><span class="sxs-lookup"><span data-stu-id="ea95c-132">The **Expressions** page lets you edit expressions and view a list of the property expressions that a task, Foreach Loop, or For Loop uses.</span></span>

-   <span data-ttu-id="ea95c-133">A janela **Propriedades** , para editar expressões e visualizar uma lista de expressões de propriedade usada por um pacote ou por objetos do pacote.</span><span class="sxs-lookup"><span data-stu-id="ea95c-133">The **Properties** window, for editing expressions and viewing a list of the property expressions that a package or package objects use.</span></span>

-   <span data-ttu-id="ea95c-134">A caixa de diálogo **Editor de Expressões de Propriedade** , para criar, atualizar e excluir expressões de propriedade.</span><span class="sxs-lookup"><span data-stu-id="ea95c-134">The **Property Expressions Editor** dialog box, for creating, updating, and deleting property expressions.</span></span>

-   <span data-ttu-id="ea95c-135">A caixa de diálogo **Construtor de Expressões** , para construir uma expressão usando as ferramentas gráficas.</span><span class="sxs-lookup"><span data-stu-id="ea95c-135">The **Expression Builder** dialog box, for building an expression using graphical tools.</span></span> <span data-ttu-id="ea95c-136">A caixa de diálogo **Construtor de Expressões** pode avaliar as expressões para sua análise sem atribuir o resultado da avaliação à propriedade.</span><span class="sxs-lookup"><span data-stu-id="ea95c-136">The **Expression Builder** dialog box can evaluate expressions for your review without assigning the evaluation result to the property.</span></span>

 <span data-ttu-id="ea95c-137">O diagrama a seguir mostra as interfaces de usuário usadas para adicionar, alterar e remover as expressões de propriedade.</span><span class="sxs-lookup"><span data-stu-id="ea95c-137">The following diagram shows the user interfaces that you use to add, change, and remove property expressions.</span></span>

 <span data-ttu-id="ea95c-138">![A interface do usuário para expressões de propriedade](../media/ssis-propertyexpressionui.gif "A interface do usuário para expressões de propriedade")</span><span class="sxs-lookup"><span data-stu-id="ea95c-138">![The user interface for property expressions](../media/ssis-propertyexpressionui.gif "The user interface for property expressions")</span></span>

 <span data-ttu-id="ea95c-139">Na janela **Propriedades** e na página **Expressões**, clique no botão Procurar **(…)** no nível de coleção **Expressões** para abrir a caixa de diálogo **Editor de Expressões de Propriedade**.</span><span class="sxs-lookup"><span data-stu-id="ea95c-139">In the **Properties** window and the **Expressions** page, click the browse button **(...)** at the **Expressions** collection level to open the **Property Expressions Editor** dialog box.</span></span> <span data-ttu-id="ea95c-140">O Editor de Expressões de Propriedade permite mapear uma propriedade para uma expressão e digitar uma expressão de propriedade.</span><span class="sxs-lookup"><span data-stu-id="ea95c-140">The Property Expressions Editor allows you to map a property to an expression and to type a property expression.</span></span> <span data-ttu-id="ea95c-141">Se desejar usar ferramentas gráficas de expressão para criar e validar uma expressão, clique no botão Procurar **(…)** no nível de expressão para abrir a caixa de diálogo **Construtor de Expressões** e crie ou modifique (e, se desejar, avalie) a expressão.</span><span class="sxs-lookup"><span data-stu-id="ea95c-141">If you want to use the graphical expression tools to create and then validate the expression, click the browse button **(...)** at the expression level to open the **Expression Builder** dialog box, and then create or modify and optionally validate the expression.</span></span>

 <span data-ttu-id="ea95c-142">Você também pode abrir a caixa de diálogo **Construtor de Expressões** na caixa de diálogo **Editor de Expressões de Propriedade** .</span><span class="sxs-lookup"><span data-stu-id="ea95c-142">You can also open the **Expression Builder** dialog box from the **Property Expressions Editor** dialog box.</span></span>

#### <a name="to-work-with-property-expressions"></a><span data-ttu-id="ea95c-143">Trabalhar com expressões de propriedade</span><span class="sxs-lookup"><span data-stu-id="ea95c-143">To work with property expressions</span></span>

-   [<span data-ttu-id="ea95c-144">Adicionar ou alterar uma expressão de propriedade</span><span class="sxs-lookup"><span data-stu-id="ea95c-144">Add or Change a Property Expression</span></span>](add-or-change-a-property-expression.md)

### <a name="setting-property-expressions-of-data-flow-components"></a><span data-ttu-id="ea95c-145">Definindo as Expressões de Propriedade dos Componentes de Fluxo de Dados</span><span class="sxs-lookup"><span data-stu-id="ea95c-145">Setting Property Expressions of Data Flow Components</span></span>
 <span data-ttu-id="ea95c-146">Se você construir um pacote no [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)], as propriedades dos componentes de fluxo de dados que dão suporte às expressões de propriedade estarão expostas na tarefa de Fluxo de Dados à qual pertencem.</span><span class="sxs-lookup"><span data-stu-id="ea95c-146">If you construct a package in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)], the properties of data flow components that support property expressions are exposed on the Data Flow task to which they belong.</span></span> <span data-ttu-id="ea95c-147">Para adicionar, alterar e remover as expressões de propriedade dos componentes de fluxo de dados, clique com o botão direito do mouse na tarefa Fluxo de Dados do fluxo de dados ao qual os componentes de fluxo pertencem e clique em **Propriedades**.</span><span class="sxs-lookup"><span data-stu-id="ea95c-147">To add, change, and remove the property expressions of data flow components, you right-click the Data Flow task for the data flow to which the data flow components belong and click **Properties**.</span></span> <span data-ttu-id="ea95c-148">A janela Propriedades lista as propriedades de componentes de fluxo de dados com as quais você pode usar as expressões de propriedade.</span><span class="sxs-lookup"><span data-stu-id="ea95c-148">The Properties window lists the properties of data flow components with which you can use property expressions.</span></span> <span data-ttu-id="ea95c-149">Por exemplo, para criar ou modificar uma expressão de propriedade SamplingValue de uma transformação Amostragem de Linha em um fluxo de dados chamado SampleCustomer, clique com o botão direito do mouse na tarefa Fluxo de Dados de cada fluxo ao qual a transformação Amostragem de Linha pertence e clique em **Propriedades**.</span><span class="sxs-lookup"><span data-stu-id="ea95c-149">For example, to create or modify a property expression for the SamplingValue property of a Row Sampling transformation in a data flow named SampleCustomer, right-click the Data Flow task for the data flow to which the Row Sampling transformation belongs and click **Properties**.</span></span> <span data-ttu-id="ea95c-150">A propriedade SamplingValue é listada na janela Propriedades e tem o formato [SampleCustomer]. [SamplingValue].</span><span class="sxs-lookup"><span data-stu-id="ea95c-150">The SamplingValue property is listed in the Properties window, and has the format [SampleCustomer].[SamplingValue].</span></span>

 <span data-ttu-id="ea95c-151">Na janela Propriedades, você adiciona, altera e remove as expressões de propriedade dos componentes de fluxo de dados da mesma maneira como as expressões de propriedade de outros tipos de objetos do [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="ea95c-151">In the Properties window, you add, change, and remove property expressions for data flow components in the same way as property expressions for other [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] object types.</span></span> <span data-ttu-id="ea95c-152">A janela Propriedades também fornece acesso a várias caixas de diálogo e construtores usados para adicionar, alterar ou remover as expressões de propriedade para os componentes de fluxo de dados.</span><span class="sxs-lookup"><span data-stu-id="ea95c-152">The Properties window also provides access to the various dialog boxes and builders that you use to add, change, or remove property expressions for data flow components.</span></span> <span data-ttu-id="ea95c-153">Para obter mais informações sobre as propriedades de componentes de fluxo de dados que podem ser usadas pelas expressões de propriedade, consulte [Propriedades personalizadas de transformação](../data-flow/transformations/transformation-custom-properties.md).</span><span class="sxs-lookup"><span data-stu-id="ea95c-153">For more information about the properties of data flow components that can be updated by property expressions, see [Transformation Custom Properties](../data-flow/transformations/transformation-custom-properties.md).</span></span>

## <a name="loading-property-expressions"></a><span data-ttu-id="ea95c-154">Carregando Expressões de Propriedade</span><span class="sxs-lookup"><span data-stu-id="ea95c-154">Loading Property Expressions</span></span>
 <span data-ttu-id="ea95c-155">Você não pode especificar ou controlar quando as expressões de propriedade estarão carregadas.</span><span class="sxs-lookup"><span data-stu-id="ea95c-155">You cannot specify or control when property expressions are loaded.</span></span> <span data-ttu-id="ea95c-156">As expressões de propriedade são avaliadas e carregadas quando o pacote e os objetos do pacote são validados.</span><span class="sxs-lookup"><span data-stu-id="ea95c-156">The property expressions are evaluated and loaded when the package and the package objects are validated.</span></span> <span data-ttu-id="ea95c-157">A validação ocorre quando você salva o pacote, abre o pacote no Designer [!INCLUDE[ssIS](../../../includes/ssis-md.md)] e executa o pacote.</span><span class="sxs-lookup"><span data-stu-id="ea95c-157">Validation occurs when you save the package, open the package in [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer, and run the package.</span></span>

 <span data-ttu-id="ea95c-158">No entanto, os valores atualizados das propriedades dos objetos do pacote que usam a expressão de propriedade no Designer [!INCLUDE[ssIS](../../../includes/ssis-md.md)] não poderão ser visualizados enquanto você não salvar o pacote, executá-lo ou reabri-lo após adicionar as expressões de propriedade.</span><span class="sxs-lookup"><span data-stu-id="ea95c-158">You will therefore not see the updated values of the properties of the package objects that use property expressions in [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer until you save the package, run the package, or reopen the package after adding the property expressions.</span></span>

 <span data-ttu-id="ea95c-159">As expressões de propriedade associadas a diferentes tipos de objetos – gerenciadores de conexões, provedores de logs e enumeradores – também são carregados quando os métodos específicos a esse tipo de objeto são chamados.</span><span class="sxs-lookup"><span data-stu-id="ea95c-159">The property expressions associated with different types of objects-connection managers, log providers, and enumerators-are also loaded when methods specific to that object type are called.</span></span> <span data-ttu-id="ea95c-160">Por exemplo, as propriedades de gerenciadores de conexões são carregadas antes que [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] criasse uma instância da conexão.</span><span class="sxs-lookup"><span data-stu-id="ea95c-160">For example, the properties of connection managers are loaded before [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] creates an instance of the connection.</span></span>

 <span data-ttu-id="ea95c-161">As expressões de propriedade são carregadas depois que as configurações de pacote são carregadas.</span><span class="sxs-lookup"><span data-stu-id="ea95c-161">Property expressions are loaded after package configurations have loaded.</span></span> <span data-ttu-id="ea95c-162">Por exemplo, as variáveis são atualizadas primeiro pelas suas configurações e depois as expressões de propriedade que usam as variáveis são avaliadas e carregadas.</span><span class="sxs-lookup"><span data-stu-id="ea95c-162">For example, variables are updated first by their configurations, and then the property expressions that use the variables are evaluated and loaded.</span></span> <span data-ttu-id="ea95c-163">Isso significa que as expressões de propriedade sempre usam os valores de variáveis que são definidos pelas configurações.</span><span class="sxs-lookup"><span data-stu-id="ea95c-163">This means that the property expressions always use the values of variables that are set by configurations.</span></span>

> [!NOTE]
>  <span data-ttu-id="ea95c-164">Você não pode usar a `Set` opção do utilitário **dtexec** para popular uma expressão de propriedade.</span><span class="sxs-lookup"><span data-stu-id="ea95c-164">You cannot use the `Set` option of the **dtexec** utility to populate a property expression.</span></span>

 <span data-ttu-id="ea95c-165">A tabela a seguir resume quando expressões de propriedade de [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] são avaliadas e carregadas.</span><span class="sxs-lookup"><span data-stu-id="ea95c-165">The following table summarizes when property expressions of [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] are evaluated and loaded.</span></span>

|<span data-ttu-id="ea95c-166">Tipo de objeto</span><span class="sxs-lookup"><span data-stu-id="ea95c-166">Object type</span></span>|<span data-ttu-id="ea95c-167">Carregar e avaliar</span><span class="sxs-lookup"><span data-stu-id="ea95c-167">Load and evaluate</span></span>|
|-----------------|-----------------------|
|<span data-ttu-id="ea95c-168">Pacote, Loop Foreach, Loop For, Sequência, tarefas e componentes de fluxo de dados</span><span class="sxs-lookup"><span data-stu-id="ea95c-168">Package, Foreach loop, For Loop, Sequence, tasks, and data flow components</span></span>|<span data-ttu-id="ea95c-169">Após carregar as configurações</span><span class="sxs-lookup"><span data-stu-id="ea95c-169">After loading configurations</span></span><br /><br /> <span data-ttu-id="ea95c-170">Antes da validação</span><span class="sxs-lookup"><span data-stu-id="ea95c-170">Before validation</span></span><br /><br /> <span data-ttu-id="ea95c-171">Antes da execução</span><span class="sxs-lookup"><span data-stu-id="ea95c-171">Before execution</span></span>|
|<span data-ttu-id="ea95c-172">Gerenciadores de conexões</span><span class="sxs-lookup"><span data-stu-id="ea95c-172">Connection managers</span></span>|<span data-ttu-id="ea95c-173">Após carregar as configurações</span><span class="sxs-lookup"><span data-stu-id="ea95c-173">After loading configurations</span></span><br /><br /> <span data-ttu-id="ea95c-174">Antes da validação</span><span class="sxs-lookup"><span data-stu-id="ea95c-174">Before validation</span></span><br /><br /> <span data-ttu-id="ea95c-175">Antes da execução</span><span class="sxs-lookup"><span data-stu-id="ea95c-175">Before execution</span></span><br /><br /> <span data-ttu-id="ea95c-176">Antes de criar uma instância de conexão</span><span class="sxs-lookup"><span data-stu-id="ea95c-176">Before creating a connection instance</span></span>|
|<span data-ttu-id="ea95c-177">Provedores de logs</span><span class="sxs-lookup"><span data-stu-id="ea95c-177">Log providers</span></span>|<span data-ttu-id="ea95c-178">Após carregar as configurações</span><span class="sxs-lookup"><span data-stu-id="ea95c-178">After loading configurations</span></span><br /><br /> <span data-ttu-id="ea95c-179">Antes da validação</span><span class="sxs-lookup"><span data-stu-id="ea95c-179">Before validation</span></span><br /><br /> <span data-ttu-id="ea95c-180">Antes da execução</span><span class="sxs-lookup"><span data-stu-id="ea95c-180">Before execution</span></span><br /><br /> <span data-ttu-id="ea95c-181">Antes de abrir os logs</span><span class="sxs-lookup"><span data-stu-id="ea95c-181">Before opening logs</span></span>|
|<span data-ttu-id="ea95c-182">Enumeradores Foreach</span><span class="sxs-lookup"><span data-stu-id="ea95c-182">Foreach enumerators</span></span>|<span data-ttu-id="ea95c-183">Após carregar as configurações</span><span class="sxs-lookup"><span data-stu-id="ea95c-183">After loading configurations</span></span><br /><br /> <span data-ttu-id="ea95c-184">Antes da validação</span><span class="sxs-lookup"><span data-stu-id="ea95c-184">Before validation</span></span><br /><br /> <span data-ttu-id="ea95c-185">Antes da execução</span><span class="sxs-lookup"><span data-stu-id="ea95c-185">Before execution</span></span><br /><br /> <span data-ttu-id="ea95c-186">Antes de cada enumeração do loop</span><span class="sxs-lookup"><span data-stu-id="ea95c-186">Before each enumeration of the loop</span></span>|

## <a name="using-property-expressions-in-the-foreach-loop"></a><span data-ttu-id="ea95c-187">Usando as expressões de propriedade no Loop Foreach</span><span class="sxs-lookup"><span data-stu-id="ea95c-187">Using Property Expressions in the Foreach Loop</span></span>
 <span data-ttu-id="ea95c-188">Geralmente é útil implementar uma expressão de propriedade para definir o valor da propriedade `ConnectionString` dos gerenciadores de conexões que são usados dentro do contêiner Loop Foreach.</span><span class="sxs-lookup"><span data-stu-id="ea95c-188">It is frequently useful to implement a property expression to set the value of the `ConnectionString` property of connection managers that are used inside the Foreach Loop container.</span></span> <span data-ttu-id="ea95c-189">Depois que o enumerador mapeia seu valor atual para uma variável em cada iteração do loop, a expressão de propriedade pode usar o valor dessa variável para atualizar o valor da propriedade `ConnectionString` dinamicamente.</span><span class="sxs-lookup"><span data-stu-id="ea95c-189">After the enumerator maps its current value to a variable on each iteration of the loop, the property expression can use the value of this variable to update the value of the `ConnectionString` property dynamically .</span></span>

 <span data-ttu-id="ea95c-190">Se você quiser usar as expressões de propriedade com a propriedade `ConnectionString` dos gerenciadores de conexões Arquivo, Vários Arquivos, Arquivos Simples e Vários Arquivos Simples usados pelo Loop Foreach, é preciso considerar algumas informações.</span><span class="sxs-lookup"><span data-stu-id="ea95c-190">If you want to use property expressions with the `ConnectionString` property of File, Multiple Files, Flat Files, and Multiple Flat Files connection managers that a Foreach Loop uses, there are some things that you should consider.</span></span> <span data-ttu-id="ea95c-191">Um pacote pode ser configurado para executar vários arquivos executáveis simultaneamente definindo a propriedade `MaxConcurrentExecutables` como um valor maior que 1 ou com o valor -1.</span><span class="sxs-lookup"><span data-stu-id="ea95c-191">A package can be configured to run multiple executables concurrently by setting the `MaxConcurrentExecutables` property either to a value greater than 1 or to the value -1.</span></span> <span data-ttu-id="ea95c-192">Um valor definido como -1 permite o número máximo de arquivos executáveis sendo executados simultaneamente para igualar o número de processadores mais dois.</span><span class="sxs-lookup"><span data-stu-id="ea95c-192">A value of -1 allows the maximum number of concurrently running executables to equal the number of processors plus two.</span></span> <span data-ttu-id="ea95c-193">Para evitar consequências negativas da execução paralela de executáveis, o valor de `MaxConcurrentExecutables` deveria ser definido como 1.</span><span class="sxs-lookup"><span data-stu-id="ea95c-193">To avoid negative consequences from the parallel execution of executables, the value `MaxConcurrentExecutables` should be set to 1.</span></span> <span data-ttu-id="ea95c-194">Se `MaxConcurrentExecutables` não for definido como 1, o valor da propriedade `ConnectionString` não poderá ser garantido e os resultados serão imprevisíveis.</span><span class="sxs-lookup"><span data-stu-id="ea95c-194">If `MaxConcurrentExecutables` is not set to 1, then the value of the `ConnectionString` property cannot be guaranteed and results are unpredictable.</span></span>

 <span data-ttu-id="ea95c-195">Por exemplo, considere um Loop Foreach que enumera arquivos em uma pasta, recupera os nomes de arquivo e usa uma tarefa Executar SQL para inserir cada nome de arquivos em uma tabela.</span><span class="sxs-lookup"><span data-stu-id="ea95c-195">For example, consider a Foreach Loop that enumerates files in a folder, retrieves the file names, and then uses an Execute SQL task to insert each file name into a table.</span></span> <span data-ttu-id="ea95c-196">Se `MaxConcurrentExecutables` não for definido como 1, poderão ocorrer conflitos de gravação se duas instâncias da tarefa Executar SQL tentarem gravar dados na tabela ao mesmo tempo.</span><span class="sxs-lookup"><span data-stu-id="ea95c-196">If `MaxConcurrentExecutables` is not set to 1, then write conflicts could occur if two instances of the Execute SQL task attempted to write to the table at the same time.</span></span>

## <a name="sample-property-expressions"></a><span data-ttu-id="ea95c-197">Expressões de Propriedades de Exemplo</span><span class="sxs-lookup"><span data-stu-id="ea95c-197">Sample Property Expressions</span></span>
 <span data-ttu-id="ea95c-198">As expressões de exemplo a seguir mostram como usar as variáveis de sistema, operadores, funções e literais de cadeia de caracteres em expressões de propriedade.</span><span class="sxs-lookup"><span data-stu-id="ea95c-198">The following sample expressions show how to use system variables, operators, functions, and string literals in property expressions.</span></span>

### <a name="property-expression-for-the-loggingmode-property-of-a-package"></a><span data-ttu-id="ea95c-199">Expressão de Propriedade para a Propriedade LoggingMode de um Pacote</span><span class="sxs-lookup"><span data-stu-id="ea95c-199">Property Expression for the LoggingMode Property of a Package</span></span>
 <span data-ttu-id="ea95c-200">A expressão de propriedade a seguir pode ser usada para definir a propriedade LoggingMode de um pacote.</span><span class="sxs-lookup"><span data-stu-id="ea95c-200">The following property expression can be used to set the LoggingMode property of a package.</span></span> <span data-ttu-id="ea95c-201">A expressão usa as funções DAY e GETDATE para obter um valor inteiro que represente o dia em uma data.</span><span class="sxs-lookup"><span data-stu-id="ea95c-201">The expression uses the DAY and GETDATE functions to get an integer that represents the day datepart of a date.</span></span> <span data-ttu-id="ea95c-202">Se o dia for o 1º ou 15º, o log será ativado; caso contrário, será desativado.</span><span class="sxs-lookup"><span data-stu-id="ea95c-202">If the day is the 1st or 15th, logging is enabled; otherwise, logging is disabled.</span></span> <span data-ttu-id="ea95c-203">O valor 1 é o equivalente inteiro do membro do enumerador LoggingMode `Enabled` e o valor 2 é o equivalente inteiro do membro `Disabled` .</span><span class="sxs-lookup"><span data-stu-id="ea95c-203">The value 1 is the integer equivalent of the LoggingMode enumerator member `Enabled`, and the value 2 is the integer equivalent of the member `Disabled`.</span></span> <span data-ttu-id="ea95c-204">Na expressão, use o valor numérico em vez do nome de membro de enumerador.</span><span class="sxs-lookup"><span data-stu-id="ea95c-204">You must use the numeric value instead of the enumerator member name in the expression.</span></span>

 `DAY((DT_DBTIMESTAMP)GETDATE())==1||DAY((DT_DBTIMESTAMP)GETDATE())==15?1:2`

### <a name="property-expression-for-the-subject-of-an-e-mail-message"></a><span data-ttu-id="ea95c-205">Expressão de Propriedade para o Assunto de uma Mensagem de Email</span><span class="sxs-lookup"><span data-stu-id="ea95c-205">Property Expression for the Subject of an E-mail Message</span></span>
 <span data-ttu-id="ea95c-206">A expressão de propriedade a seguir pode ser usada para definir a propriedade Subject de uma tarefa Enviar Email e indicar um assunto de email útil.</span><span class="sxs-lookup"><span data-stu-id="ea95c-206">The following property expression can be used to set the Subject property of a Send Mail task and provide a useful e-mail subject.</span></span> <span data-ttu-id="ea95c-207">As expressões usam uma combinação de literais de cadeia de caracteres, variáveis de sistema, concatenação (+) e operadores de conversão, além das funções DATEDIFF e GETDATE.</span><span class="sxs-lookup"><span data-stu-id="ea95c-207">The expression uses a combination of string literals, system variables, the concatenation (+) and cast operators, and the DATEDIFF and GETDATE functions.</span></span> <span data-ttu-id="ea95c-208">As variáveis de sistema são as variáveis `PackageName` e `StartTime` .</span><span class="sxs-lookup"><span data-stu-id="ea95c-208">The system variables are the `PackageName` and `StartTime` variables.</span></span>

 `"PExpression-->Package: (" + @[System::PackageName] + ") Started:"+  (DT_WSTR, 30) @[System::StartTime] + " Duration:"  +  (DT_WSTR,10) (DATEDIFF( "ss", @[System::StartTime] , GETDATE()  )) + " seconds"`

 <span data-ttu-id="ea95c-209">Se o nome do pacote for EmailRowCountPP, se tiver sido executado em 04/03/2005, com duração de 9 segundos, a expressão avaliará a seguinte cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="ea95c-209">If the package name is EmailRowCountPP, was run on 3/4/2005, and the duration of the run was 9 seconds, the expression evaluates to the following string.</span></span>

 <span data-ttu-id="ea95c-210">PExpression-->Pacote: (EmailRowCountPP) Iniciado em:3/4/2005 11:06:18 AM Duração:9 segundos.</span><span class="sxs-lookup"><span data-stu-id="ea95c-210">PExpression-->Package: (EmailRowCountPP) Started:3/4/2005 11:06:18 AM Duration:9 seconds.</span></span>

### <a name="property-expression-for-the-message-of-an-e-mail-message"></a><span data-ttu-id="ea95c-211">Expressão de Propriedade para a Mensagem de uma Mensagem de Email</span><span class="sxs-lookup"><span data-stu-id="ea95c-211">Property Expression for the Message of an E-mail Message</span></span>
 <span data-ttu-id="ea95c-212">A expressão de propriedade a seguir pode ser usada para definir a propriedade MessageSource de uma tarefa Enviar Email.</span><span class="sxs-lookup"><span data-stu-id="ea95c-212">The following property expression can be used to set the MessageSource property of a Send Mail task.</span></span> <span data-ttu-id="ea95c-213">A expressão usa uma combinação de literais de cadeia de caracteres, variáveis definidas pelo usuário e o operador de concatenação (+).</span><span class="sxs-lookup"><span data-stu-id="ea95c-213">The expression uses a combination of string literals, user-defined variables, and the concatenation (+) operator.</span></span> <span data-ttu-id="ea95c-214">As variáveis definidas pelo usuário são chamadas de `nasdaqrawrows`, `nyserawrows`e `amexrawrows`.</span><span class="sxs-lookup"><span data-stu-id="ea95c-214">The user-defined variables are named `nasdaqrawrows`, `nyserawrows`, and `amexrawrows`.</span></span> <span data-ttu-id="ea95c-215">O "\n" da cadeia de caracteres indica um retorno de carro.</span><span class="sxs-lookup"><span data-stu-id="ea95c-215">The string "\n" indicates a carriage return.</span></span>

 `"Rows Processed: "  +   "\n" +"   NASDAQ: "  +   (dt_wstr,9)@[nasdaqrawrows]   + "\n" + "   NYSE: "  +  (dt_wstr,9)@[nyserawrows]  + "\n" + "   Amex: "  +  (dt_wstr,9)@[amexrawrows]`

 <span data-ttu-id="ea95c-216">Se `nasdaqrawrows` for 7058, `nyserawrows` for 3528 e `amexrawrows` for 1102, expressão avaliará a cadeia de caracteres a seguir.</span><span class="sxs-lookup"><span data-stu-id="ea95c-216">If `nasdaqrawrows` is 7058, `nyserawrows` is 3528, and `amexrawrows` is 1102, the expression evaluates to the following string.</span></span>

 <span data-ttu-id="ea95c-217">Linhas Processadas:</span><span class="sxs-lookup"><span data-stu-id="ea95c-217">Rows Processed:</span></span>

 <span data-ttu-id="ea95c-218">NASDAQ: 7058</span><span class="sxs-lookup"><span data-stu-id="ea95c-218">NASDAQ: 7058</span></span>

 <span data-ttu-id="ea95c-219">NYSE: 3528</span><span class="sxs-lookup"><span data-stu-id="ea95c-219">NYSE: 3528</span></span>

 <span data-ttu-id="ea95c-220">AMEX: 1102</span><span class="sxs-lookup"><span data-stu-id="ea95c-220">AMEX: 1102</span></span>

### <a name="property-expression-for-the-executable-property-of-an-execute-process-task"></a><span data-ttu-id="ea95c-221">Expressão de Propriedade para a Propriedade Executável de uma Tarefa Executar Processo</span><span class="sxs-lookup"><span data-stu-id="ea95c-221">Property Expression for the Executable Property of an Execute Process Task</span></span>
 <span data-ttu-id="ea95c-222">A expressão de propriedade a seguir pode ser usada para definir a propriedade Executable de uma tarefa Executar Processo.</span><span class="sxs-lookup"><span data-stu-id="ea95c-222">The following property expression can be used to set the Executable property of an Execute Process task.</span></span> <span data-ttu-id="ea95c-223">A expressão usa uma combinação de literais de cadeia de caracteres, operadores e funções.</span><span class="sxs-lookup"><span data-stu-id="ea95c-223">The expression uses a combination of string literals, operators, and functions.</span></span> <span data-ttu-id="ea95c-224">Ela também usa as funções DATEPART e GETDATE, além do operador condicional.</span><span class="sxs-lookup"><span data-stu-id="ea95c-224">The expression uses the DATEPART and GETDATE functions and the conditional operator.</span></span>

 `DATEPART("weekday", GETDATE()) ==2?"notepad.exe":"mspaint.exe"`

 <span data-ttu-id="ea95c-225">Se for o segundo dia da semana, a tarefa Executar Processo executará o notepad.exe; caso contrário, a tarefa executará o arquivo mspaint.exe.</span><span class="sxs-lookup"><span data-stu-id="ea95c-225">If it is the second day in the week, the Execute Process task runs notepad.exe, otherwise the task runs mspaint.exe.</span></span>

### <a name="property-expression-for-the-connectionstring-property-of-a-flat-file-connection-manager"></a><span data-ttu-id="ea95c-226">Expressão de Propriedade para a Propriedade ConnectionString de um Gerenciador de Conexões de Arquivos Simples</span><span class="sxs-lookup"><span data-stu-id="ea95c-226">Property Expression for the ConnectionString Property of a Flat File Connection Manager</span></span>
 <span data-ttu-id="ea95c-227">A expressão de propriedade a seguir pode ser usada para definir a propriedade ConnectionString de um gerenciador de conexões de Arquivos Simples.</span><span class="sxs-lookup"><span data-stu-id="ea95c-227">The following property expression can be used to set the ConnectionString property of a Flat File connection manager.</span></span> <span data-ttu-id="ea95c-228">A expressão usa apenas uma variável definida pelo usuário, `myfilenamefull`, que contém o caminho para um arquivo de texto.</span><span class="sxs-lookup"><span data-stu-id="ea95c-228">The expression uses a single user-defined variable, `myfilenamefull`, which contains the path to a text file.</span></span>

 `@[User::myfilenamefull]`

> [!NOTE]
>  <span data-ttu-id="ea95c-229">As expressões de propriedade para os gerenciadores de conexões só podem ser acessadas usando a janela Propriedades.</span><span class="sxs-lookup"><span data-stu-id="ea95c-229">Property expressions for connection managers can be accessed only by using the Properties window.</span></span> <span data-ttu-id="ea95c-230">Para exibir as propriedades para um gerenciador de conexões, você deve selecionar o gerenciador de conexões na área **Gerenciadores de Conexões** do Designer do [!INCLUDE[ssIS](../../../includes/ssis-md.md)] quando abrir a janela Propriedades ou clicar com o botão direito do mouse no gerenciador de conexões e selecionar **Propriedades**.</span><span class="sxs-lookup"><span data-stu-id="ea95c-230">To view the properties for a connection manager, you must select the connection manager in the **Connection Managers** area of [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer when the Properties window is open, or right-click the connection manager and select **Properties**.</span></span>

### <a name="property-expression-for-the-configstring-property-of-a-text-file-log-provider"></a><span data-ttu-id="ea95c-231">Expressão de Propriedade para a Propriedade ConfigString de um Provedor de Logs do Arquivo de Texto</span><span class="sxs-lookup"><span data-stu-id="ea95c-231">Property Expression for the ConfigString Property of a Text File Log Provider</span></span>
 <span data-ttu-id="ea95c-232">A expressão de propriedade a seguir pode ser usada para definir a propriedade ConfigString de um provedor de logs do Arquivo de Texto.</span><span class="sxs-lookup"><span data-stu-id="ea95c-232">The following property expression can be used to set the ConfigString property of a Text File log provider.</span></span> <span data-ttu-id="ea95c-233">A expressão usa apenas uma variável definida pelo usuário, `varConfigString`, que contém o nome do gerenciador de conexões do Arquivo a ser usado.</span><span class="sxs-lookup"><span data-stu-id="ea95c-233">The expression uses a single user-defined variable, `varConfigString`, which contains the name of the File connection manager to use.</span></span> <span data-ttu-id="ea95c-234">O gerenciador de conexões do Arquivo especifica o caminho do arquivo de texto para o qual as entradas de log serão gravadas.</span><span class="sxs-lookup"><span data-stu-id="ea95c-234">The File connection manager specifies the path of the text file to which log entries are written.</span></span>

 `@[User::varConfigString]`

> [!NOTE]
>  <span data-ttu-id="ea95c-235">As expressões de propriedade para os provedores de logs só podem ser acessadas usando a janela Propriedades.</span><span class="sxs-lookup"><span data-stu-id="ea95c-235">Property expressions for log providers can be accessed only by using the Properties window.</span></span> <span data-ttu-id="ea95c-236">Para exibir as propriedades de um provedor de logs, selecione o provedor de logs na guia **Explorador de Pacotes** do Designer do [!INCLUDE[ssIS](../../../includes/ssis-md.md)] ao abrir a janela Propriedades ou clique com o botão direito do mouse no provedor de logs no Explorador de Pacotes e clique em **Propriedades**.</span><span class="sxs-lookup"><span data-stu-id="ea95c-236">To view the properties of a log provider, you must select the log provider on the **Package Explorer** tab of [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer when the Properties window is open, or right-click the log provider in Package Explorer and click **Properties**.</span></span>

## <a name="external-resources"></a><span data-ttu-id="ea95c-237">Recursos externos</span><span class="sxs-lookup"><span data-stu-id="ea95c-237">External Resources</span></span>

-   [<span data-ttu-id="ea95c-238">Marca-texto de Expressão e Configuração (Projeto CodePlex)</span><span class="sxs-lookup"><span data-stu-id="ea95c-238">Expression and Configuration Highlighter (CodePlex Project)</span></span>](https://go.microsoft.com/fwlink/?LinkId=146625)

-   <span data-ttu-id="ea95c-239">Artigo técnico, [Exemplos de expressões SSIS](https://go.microsoft.com/fwlink/?LinkId=220761), em social.technet.microsoft.com</span><span class="sxs-lookup"><span data-stu-id="ea95c-239">Technical article, [SSIS Expression Examples](https://go.microsoft.com/fwlink/?LinkId=220761), on social.technet.microsoft.com</span></span>

## <a name="see-also"></a><span data-ttu-id="ea95c-240">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="ea95c-240">See Also</span></span>
 [<span data-ttu-id="ea95c-241">Usar variáveis em pacotes</span><span class="sxs-lookup"><span data-stu-id="ea95c-241">Use Variables in Packages</span></span>](../use-variables-in-packages.md)


