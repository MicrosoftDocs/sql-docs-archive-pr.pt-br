---
title: Criando uma transformação assíncrona com o componente Script | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: reference
dev_langs:
- VB
helpviewer_keywords:
- asynchronous outputs [Integration Services]
- transformation components [Integration Services]
- Script component [Integration Services], transformation components
ms.assetid: 0d814404-21e4-4a68-894c-96fa47ab25ae
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 465c4a597b4a18d7bd956116cd5d7640a5393958
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87574777"
---
# <a name="creating-an-asynchronous-transformation-with-the-script-component"></a><span data-ttu-id="a8adb-102">Criando uma transformação assíncrona com o componente Script</span><span class="sxs-lookup"><span data-stu-id="a8adb-102">Creating an Asynchronous Transformation with the Script Component</span></span>
  <span data-ttu-id="a8adb-103">Você usa um componente de transformação no fluxo de dados de um pacote do [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] para modificar e analisar dados à medida que eles passam da origem ao destino.</span><span class="sxs-lookup"><span data-stu-id="a8adb-103">You use a transformation component in the data flow of an [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] package to modify and analyze data as it passes from source to destination.</span></span> <span data-ttu-id="a8adb-104">Uma transformação com saídas síncronas processa cada linha de entrada que passa pelo componente.</span><span class="sxs-lookup"><span data-stu-id="a8adb-104">A transformation with synchronous outputs processes each input row as it passes through the component.</span></span> <span data-ttu-id="a8adb-105">Uma transformação com saídas assíncronas pode aguardar para concluir seu processamento depois de receber todas as linhas de entrada ou ela pode gerar algumas linhas antes de receber todas as linhas de entrada.</span><span class="sxs-lookup"><span data-stu-id="a8adb-105">A transformation with asynchronous outputs may wait to complete its processing until the transformation has received all input rows, or the transformation may output certain rows before it has received all input rows.</span></span> <span data-ttu-id="a8adb-106">Esse tópico discute uma transformação assíncrona.</span><span class="sxs-lookup"><span data-stu-id="a8adb-106">This topic discusses an asynchronous transformation.</span></span> <span data-ttu-id="a8adb-107">Se o processamento exigir uma transformação síncrona, consulte [Criando uma transformação síncrona com o componente Script](../data-flow/transformations/script-component.md).</span><span class="sxs-lookup"><span data-stu-id="a8adb-107">If your processing requires a synchronous transformation, see [Creating a Synchronous Transformation with the Script Component](../data-flow/transformations/script-component.md).</span></span> <span data-ttu-id="a8adb-108">Para obter mais informações sobre as diferenças entre componentes síncronos e assíncronos, consulte [Compreendendo as transformações síncronas e assíncronas](../understanding-synchronous-and-asynchronous-transformations.md).</span><span class="sxs-lookup"><span data-stu-id="a8adb-108">For more information about the differences between synchronous and asynchronous components, see [Understanding Synchronous and Asynchronous Transformations](../understanding-synchronous-and-asynchronous-transformations.md).</span></span>

 <span data-ttu-id="a8adb-109">Para obter uma visão geral do componente Script, consulte [Estendendo o fluxo de dados com o componente Script](../extending-packages-scripting/data-flow-script-component/extending-the-data-flow-with-the-script-component.md).</span><span class="sxs-lookup"><span data-stu-id="a8adb-109">For an overview of the Script component, see [Extending the Data Flow with the Script Component](../extending-packages-scripting/data-flow-script-component/extending-the-data-flow-with-the-script-component.md).</span></span>

 <span data-ttu-id="a8adb-110">O componente Script e o código de infraestrutura gerado para você simplificam o processo de desenvolvimento de um componente de fluxo de dados personalizado.</span><span class="sxs-lookup"><span data-stu-id="a8adb-110">The Script component and the infrastructure code that it generates for you simplify the process of developing a custom data flow component.</span></span> <span data-ttu-id="a8adb-111">No entanto, para entender como funciona o componente Script, talvez seja útil ler as etapas que devem ser seguidas no desenvolvimento de um componente de fluxo de dados personalizado na seção de [Desenvolvendo um componente de fluxo de dados personalizado](../extending-packages-custom-objects/data-flow/developing-a-custom-data-flow-component.md) e, especialmente, [Desenvolvendo um componente de transformação personalizado com saídas síncronas](../extending-packages-custom-objects-data-flow-types/developing-a-custom-transformation-component-with-synchronous-outputs.md).</span><span class="sxs-lookup"><span data-stu-id="a8adb-111">However, to understand how the Script component works, you may find it useful to read through the steps that you must follow in developing a custom data flow component in the [Developing a Custom Data Flow Component](../extending-packages-custom-objects/data-flow/developing-a-custom-data-flow-component.md) section, and especially [Developing a Custom Transformation Component with Synchronous Outputs](../extending-packages-custom-objects-data-flow-types/developing-a-custom-transformation-component-with-synchronous-outputs.md).</span></span>

## <a name="getting-started-with-an-asynchronous-transformation-component"></a><span data-ttu-id="a8adb-112">Guia de Introdução com um componente de transformação assíncrono</span><span class="sxs-lookup"><span data-stu-id="a8adb-112">Getting Started with an Asynchronous Transformation Component</span></span>
 <span data-ttu-id="a8adb-113">Quando você adiciona um componente Script à guia Fluxo de Dados do Designer do [!INCLUDE[ssIS](../../includes/ssis-md.md)], a caixa de diálogo **Selecionar Tipo de Componente Script** é exibida, solicitando a pré-configuração do componente como uma origem, uma transformação ou um destino.</span><span class="sxs-lookup"><span data-stu-id="a8adb-113">When you add a Script component to the Data Flow tab of [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, the **Select Script Component Type** dialog box appears, prompting you to preconfigure the component as a source, transformation, or destination.</span></span> <span data-ttu-id="a8adb-114">Nessa caixa de diálogo, selecione **Transformação**.</span><span class="sxs-lookup"><span data-stu-id="a8adb-114">In this dialog box, select **Transformation**.</span></span>

## <a name="configuring-an-asynchronous-transformation-component-in-metadata-design-mode"></a><span data-ttu-id="a8adb-115">Configurando um componente de transformação assíncrono em modo do design de metadados</span><span class="sxs-lookup"><span data-stu-id="a8adb-115">Configuring an Asynchronous Transformation Component in Metadata-Design Mode</span></span>
 <span data-ttu-id="a8adb-116">Depois de selecionar a opção para criar um componente de transformação, configure o componente usando o **Editor de Transformação Scripts**.</span><span class="sxs-lookup"><span data-stu-id="a8adb-116">After you select the option to create a transformation component, you configure the component by using the **Script Transformation Editor**.</span></span> <span data-ttu-id="a8adb-117">Para obter mais informações, consulte [Configurando o componente Script no Editor de Componente Script](../extending-packages-scripting/data-flow-script-component/configuring-the-script-component-in-the-script-component-editor.md).</span><span class="sxs-lookup"><span data-stu-id="a8adb-117">For more information, see [Configuring the Script Component in the Script Component Editor](../extending-packages-scripting/data-flow-script-component/configuring-the-script-component-in-the-script-component-editor.md).</span></span>

 <span data-ttu-id="a8adb-118">Para selecionar a linguagem de script que será usada pelo componente Script, defina a propriedade **ScriptLanguage** na página **Script** da caixa de diálogo **Editor de Transformação Scripts**.</span><span class="sxs-lookup"><span data-stu-id="a8adb-118">To select the script language that the Script component will use, you set the **ScriptLanguage** property on the **Script** page of the **Script Transformation Editor** dialog box.</span></span>

> [!NOTE]
>  <span data-ttu-id="a8adb-119">Para definir a linguagem de scripts padrão para o componente Script, use a opção **Linguagem de scripts** na página **Geral** da caixa de diálogo **Opções**.</span><span class="sxs-lookup"><span data-stu-id="a8adb-119">To set the default scripting language for the Script component, use the **Scripting language** option on the **General** page of the **Options** dialog box.</span></span> <span data-ttu-id="a8adb-120">Para obter mais informações, consulte [General Page](../general-page-of-integration-services-designers-options.md).</span><span class="sxs-lookup"><span data-stu-id="a8adb-120">For more information, see [General Page](../general-page-of-integration-services-designers-options.md).</span></span>

 <span data-ttu-id="a8adb-121">Um componente de transformação de fluxo de dados tem uma entrada e dá suporte a uma ou mais saídas.</span><span class="sxs-lookup"><span data-stu-id="a8adb-121">A data flow transformation component has one input and supports one or more outputs.</span></span> <span data-ttu-id="a8adb-122">A configuração da entrada e das saídas do componente é uma das etapas que devem ser concluídas no modo de design de metadados, usando o **Editor de Transformação Scripts**, antes de escrever o script personalizado.</span><span class="sxs-lookup"><span data-stu-id="a8adb-122">Configuring the input and outputs of your component is one of the steps that you must complete in metadata design mode, by using the **Script Transformation Editor**, before you write your custom script.</span></span>

### <a name="configuring-input-columns"></a><span data-ttu-id="a8adb-123">Configurando colunas de entrada</span><span class="sxs-lookup"><span data-stu-id="a8adb-123">Configuring Input Columns</span></span>
 <span data-ttu-id="a8adb-124">Um componente de transformação criado através do componente Script tem uma única entrada.</span><span class="sxs-lookup"><span data-stu-id="a8adb-124">A transformation component created by using the Script component has a single input.</span></span>

 <span data-ttu-id="a8adb-125">Na página **Colunas de Entrada** do **Editor de Transformação Scripts**, a lista de colunas mostra as colunas disponíveis da saída do componente upstream no fluxo de dados.</span><span class="sxs-lookup"><span data-stu-id="a8adb-125">On the **Input Columns** page of the **Script Transformation Editor**, the columns list shows the available columns from the output of the upstream component in the data flow.</span></span> <span data-ttu-id="a8adb-126">Selecione as colunas que você deseja transformar ou percorrer.</span><span class="sxs-lookup"><span data-stu-id="a8adb-126">Select the columns that you want to transform or pass through.</span></span> <span data-ttu-id="a8adb-127">Marque qualquer coluna que você queira transformar no local como De leitura/gravação.</span><span class="sxs-lookup"><span data-stu-id="a8adb-127">Mark any columns that you want to transform in place as Read/Write.</span></span>

 <span data-ttu-id="a8adb-128">Para obter mais informações sobre a página **Colunas de Entrada** do **Editor de Transformação Scripts**, consulte [Editor de Transformação Scripts &#40;página Colunas de Entrada&#41;](../script-transformation-editor-input-columns-page.md).</span><span class="sxs-lookup"><span data-stu-id="a8adb-128">For more information about the **Input Columns** page of the **Script Transformation Editor**, see [Script Transformation Editor &#40;Input Columns Page&#41;](../script-transformation-editor-input-columns-page.md).</span></span>

### <a name="configuring-inputs-outputs-and-output-columns"></a><span data-ttu-id="a8adb-129">Configurando entradas, saídas e colunas de saída</span><span class="sxs-lookup"><span data-stu-id="a8adb-129">Configuring Inputs, Outputs, and Output Columns</span></span>
 <span data-ttu-id="a8adb-130">Um componente de transformação dá suporte a uma ou mais saídas.</span><span class="sxs-lookup"><span data-stu-id="a8adb-130">A transformation component supports one or more outputs.</span></span>

 <span data-ttu-id="a8adb-131">Frequentemente, uma transformação com saídas assíncronas possui duas saídas.</span><span class="sxs-lookup"><span data-stu-id="a8adb-131">Frequently a transformation with asynchronous outputs has two outputs.</span></span> <span data-ttu-id="a8adb-132">Por exemplo, ao contar o número de endereços localizados em uma cidade específica, talvez você queira transmitir os dados do endereço para uma saída, enquanto envia o resultado da agregação para outra saída.</span><span class="sxs-lookup"><span data-stu-id="a8adb-132">For example, when you count the number of addresses located in a specific city, you may want to pass the address data through to one output, while sending the result of the aggregation to another output.</span></span> <span data-ttu-id="a8adb-133">A saída de agregação também exige uma coluna de saída nova.</span><span class="sxs-lookup"><span data-stu-id="a8adb-133">The aggregation output also requires a new output column.</span></span>

 <span data-ttu-id="a8adb-134">Na página **Entradas e Saídas** de **Editor de Transformação Scripts**, você verá que uma única saída foi criada por padrão, mas que nenhuma coluna de saída foi criada.</span><span class="sxs-lookup"><span data-stu-id="a8adb-134">On the **Inputs and Outputs** page of the **Script Transformation Editor**, you see that a single output has been created by default, but no output columns have been created.</span></span> <span data-ttu-id="a8adb-135">Nessa página do editor, você pode configurar os seguintes itens:</span><span class="sxs-lookup"><span data-stu-id="a8adb-135">On this page of the editor, you can configure the following items:</span></span>

-   <span data-ttu-id="a8adb-136">Talvez você queira criar uma ou mais saídas adicionais, como uma saída para o resultado de uma agregação.</span><span class="sxs-lookup"><span data-stu-id="a8adb-136">You may want to create one or more additional outputs, such as an output for the result of an aggregation.</span></span> <span data-ttu-id="a8adb-137">Use os botões **Adicionar Saída** e **Remover Saída** para gerenciar as saídas do componente de transformação assíncrona.</span><span class="sxs-lookup"><span data-stu-id="a8adb-137">Use the **Add Output** and **Remove Output** buttons to manage the outputs of your asynchronous transformation component.</span></span> <span data-ttu-id="a8adb-138">Defina a propriedade `SynchronousInputID` de cada saída como zero para indicar que a saída não está simplesmente passando dados de um componente upstream, nem transformando-os no local nas linhas e colunas existentes.</span><span class="sxs-lookup"><span data-stu-id="a8adb-138">Set the `SynchronousInputID` property of each output to zero to indicate that the output does not simply pass through data from an upstream component or transform it in place in the existing rows and columns.</span></span> <span data-ttu-id="a8adb-139">É essa configuração que torna as saídas assíncronas para a entrada.</span><span class="sxs-lookup"><span data-stu-id="a8adb-139">It is this setting that makes the outputs asynchronous to the input.</span></span>

-   <span data-ttu-id="a8adb-140">Talvez você queira atribuir um nome amigável à entrada e saídas.</span><span class="sxs-lookup"><span data-stu-id="a8adb-140">You may want to assign a friendly name to the input and outputs.</span></span> <span data-ttu-id="a8adb-141">O componente Script utiliza esses nomes para gerar as propriedades de acessador digitadas que você utilizará para referenciar a entrada e as saídas no seu script.</span><span class="sxs-lookup"><span data-stu-id="a8adb-141">The Script component uses these names to generate the typed accessor properties that you will use to refer to the input and outputs in your script.</span></span>

-   <span data-ttu-id="a8adb-142">Frequentemente, uma transformação assíncrona adiciona colunas ao fluxo de dados.</span><span class="sxs-lookup"><span data-stu-id="a8adb-142">Frequently an asynchronous transformation adds columns to the data flow.</span></span> <span data-ttu-id="a8adb-143">Quando a propriedade `SynchronousInputID` de uma saída for zero, indicando que a saída não está simplesmente passando dados de um componente upstream, nem transformando-os no local nas linhas e colunas existentes, adicione e configure colunas de saída de maneira explícita na saída.</span><span class="sxs-lookup"><span data-stu-id="a8adb-143">When the `SynchronousInputID` property of an output is zero, indicating that the output does not simply pass through data from an upstream component or transform it in place in the existing rows and columns, you must add and configure output columns explicitly on the output.</span></span> <span data-ttu-id="a8adb-144">Colunas de saída não precisam ter os mesmos nomes que as colunas de entrada para as quais elas são mapeadas.</span><span class="sxs-lookup"><span data-stu-id="a8adb-144">Output columns do not have to have the same names as the input columns to which they are mapped.</span></span>

-   <span data-ttu-id="a8adb-145">Talvez você queira adicionar mais colunas para incluir informações adicionais.</span><span class="sxs-lookup"><span data-stu-id="a8adb-145">You may want to add more columns to contain additional information.</span></span> <span data-ttu-id="a8adb-146">Escreva seu próprio código para preencher as colunas adicionais com dados.</span><span class="sxs-lookup"><span data-stu-id="a8adb-146">You must write your own code to fill the additional columns with data.</span></span> <span data-ttu-id="a8adb-147">Para obter informações sobre como reproduzir o comportamento de uma saída de erro padrão, consulte [Simulando uma saída de erro para o componente Script](../extending-packages-scripting-data-flow-script-component-examples/simulating-an-error-output-for-the-script-component.md).</span><span class="sxs-lookup"><span data-stu-id="a8adb-147">For information about reproducing the behavior of a standard error output, see [Simulating an Error Output for the Script Component](../extending-packages-scripting-data-flow-script-component-examples/simulating-an-error-output-for-the-script-component.md).</span></span>

 <span data-ttu-id="a8adb-148">Para obter mais informações sobre a página **Entradas e Saídas** do **Editor de Transformação Scripts**, consulte [Editor de Transformação Scripts &#40;página Entradas e Saídas&#41;](../script-transformation-editor-inputs-and-outputs-page.md).</span><span class="sxs-lookup"><span data-stu-id="a8adb-148">For more information about the **Inputs and Outputs** page of the **Script Transformation Editor**, see [Script Transformation Editor &#40;Inputs and Outputs Page&#41;](../script-transformation-editor-inputs-and-outputs-page.md).</span></span>

### <a name="adding-variables"></a><span data-ttu-id="a8adb-149">Adicionando variáveis</span><span class="sxs-lookup"><span data-stu-id="a8adb-149">Adding Variables</span></span>
 <span data-ttu-id="a8adb-150">Caso existam variáveis cujos valores você deseja usar no script, adicione-as aos campos de propriedade ReadOnlyVariables e ReadWriteVariables da página **Script** do **Editor de Transformação Scripts**.</span><span class="sxs-lookup"><span data-stu-id="a8adb-150">If there are any existing variables whose values you want to use in your script, you can add them in the ReadOnlyVariables and ReadWriteVariables property fields on the **Script** page of the **Script Transformation Editor**.</span></span>

 <span data-ttu-id="a8adb-151">Ao adicionar diversas variáveis aos campos de propriedade, separe os nomes das variáveis com vírgulas.</span><span class="sxs-lookup"><span data-stu-id="a8adb-151">When you add multiple variables in the property fields, separate the variable names by commas.</span></span> <span data-ttu-id="a8adb-152">Você também pode selecionar várias variáveis clicando no botão de reticências (**...**) ao lado dos `ReadOnlyVariables` campos de propriedade e e `ReadWriteVariables` selecionando as variáveis na caixa de diálogo **Selecionar variáveis** .</span><span class="sxs-lookup"><span data-stu-id="a8adb-152">You can also select multiple variables by clicking the ellipsis (**...**) button next to the `ReadOnlyVariables` and `ReadWriteVariables` property fields, and then selecting the variables in the **Select variables** dialog box.</span></span>

 <span data-ttu-id="a8adb-153">Para obter informações gerais sobre como usar variáveis com o componente Script, consulte [Usando variáveis no componente Script](../extending-packages-scripting/data-flow-script-component/using-variables-in-the-script-component.md).</span><span class="sxs-lookup"><span data-stu-id="a8adb-153">For general information about how to use variables with the Script component, see [Using Variables in the Script Component](../extending-packages-scripting/data-flow-script-component/using-variables-in-the-script-component.md).</span></span>

 <span data-ttu-id="a8adb-154">Para obter mais informações sobre a página **Script** do **Editor de Transformação Scripts**, consulte [Editor de Transformação Scripts &#40;Página Script&#41;](../script-transformation-editor-script-page.md).</span><span class="sxs-lookup"><span data-stu-id="a8adb-154">For more information about the **Script** page of the **Script Transformation Editor**, see [Script Transformation Editor &#40;Script Page&#41;](../script-transformation-editor-script-page.md).</span></span>

## <a name="scripting-an-asynchronous-transformation-component-in-code-design-mode"></a><span data-ttu-id="a8adb-155">Gerando scripts de um componente de transformação assíncrono em modo do design de código</span><span class="sxs-lookup"><span data-stu-id="a8adb-155">Scripting an Asynchronous Transformation Component in Code-Design Mode</span></span>
 <span data-ttu-id="a8adb-156">Depois de configurar todos os metadados do seu componente, você poderá escrever seu script personalizado.</span><span class="sxs-lookup"><span data-stu-id="a8adb-156">After you have configured all the metadata for your component, you can write your custom script.</span></span> <span data-ttu-id="a8adb-157">No **Editor de Transformação Scripts**, na página **Script**, clique em **Editar Script** para abrir o IDE do VSTA ([!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] Tools for Applications), no qual você pode adicionar o script personalizado.</span><span class="sxs-lookup"><span data-stu-id="a8adb-157">In the **Script Transformation Editor**, on the **Script** page, click **Edit Script** to open the [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] Tools for Applications (VSTA) IDE where you can add your custom script.</span></span> <span data-ttu-id="a8adb-158">A linguagem de scripts usada depende se você selecionou o [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Basic ou o [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual C# como a linguagem de scripts para a propriedade **ScriptLanguage** na página **Script**.</span><span class="sxs-lookup"><span data-stu-id="a8adb-158">The scripting language that you use depends on whether you selected [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Basic or [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual C# as the script language for the **ScriptLanguage** property on the **Script** page.</span></span>

 <span data-ttu-id="a8adb-159">Para obter informações importantes que se aplicam a todos os tipos de componentes criados por meio do componente Script, consulte [Codificando e depurando o componente Script](../extending-packages-scripting/data-flow-script-component/coding-and-debugging-the-script-component.md).</span><span class="sxs-lookup"><span data-stu-id="a8adb-159">For important information that applies to all kinds of components created by using the Script component, see [Coding and Debugging the Script Component](../extending-packages-scripting/data-flow-script-component/coding-and-debugging-the-script-component.md).</span></span>

### <a name="understanding-the-auto-generated-code"></a><span data-ttu-id="a8adb-160">Compreendendo o código gerado automaticamente</span><span class="sxs-lookup"><span data-stu-id="a8adb-160">Understanding the Auto-generated Code</span></span>
 <span data-ttu-id="a8adb-161">Quando você abre o IDE do VSTA depois de criar e configurar um componente de transformação, a `ScriptMain` classe editável é exibida no editor de código com stubs para os métodos ProcessInputRow e CreateNewOutputRows.</span><span class="sxs-lookup"><span data-stu-id="a8adb-161">When you open the VSTA IDE after creating and configuring a transformation component, the editable `ScriptMain` class appears in the code editor with stubs for the ProcessInputRow and the CreateNewOutputRows methods.</span></span> <span data-ttu-id="a8adb-162">A classe ScriptMain é o local em que você escreverá seu código personalizado e ProcessInputRow é o método mais importante em um componente de transformação.</span><span class="sxs-lookup"><span data-stu-id="a8adb-162">The ScriptMain class is where you will write your custom code, and ProcessInputRow is the most important method in a transformation component.</span></span> <span data-ttu-id="a8adb-163">O método `CreateNewOutputRows` costuma ser mais usado em um componente de origem, que é como uma transformação assíncrona pois ambos os componentes devem criar suas próprias linhas de saída.</span><span class="sxs-lookup"><span data-stu-id="a8adb-163">The `CreateNewOutputRows` method is more typically used in a source component, which is like an asynchronous transformation in that both components must create their own output rows.</span></span>

 <span data-ttu-id="a8adb-164">Se você abrir a janela **Gerenciador de projetos** do VSTA, poderá ver que o componente script também gerou `BufferWrapper` itens de projeto e somente leitura `ComponentWrapper` .</span><span class="sxs-lookup"><span data-stu-id="a8adb-164">If you open the VSTA **Project Explorer** window, you can see that the Script component has also generated read-only `BufferWrapper` and `ComponentWrapper` project items.</span></span> <span data-ttu-id="a8adb-165">A classe ScriptMain herda da classe UserComponent no item de `ComponentWrapper` projeto.</span><span class="sxs-lookup"><span data-stu-id="a8adb-165">The ScriptMain class inherits from the UserComponent class in the `ComponentWrapper` project item.</span></span>

 <span data-ttu-id="a8adb-166">Em tempo de execução, o mecanismo de fluxo de dados chama o método PrimeOutput na `UserComponent` classe, que substitui o <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponentHost.PrimeOutput%2A> método da <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent> classe pai.</span><span class="sxs-lookup"><span data-stu-id="a8adb-166">At run time, the data flow engine calls the PrimeOutput method in the `UserComponent` class, which overrides the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponentHost.PrimeOutput%2A> method of the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent> parent class.</span></span> <span data-ttu-id="a8adb-167">O método PrimeOutput, por sua vez, chama o método CreateNewOutputRows.</span><span class="sxs-lookup"><span data-stu-id="a8adb-167">The PrimeOutput method in turn calls the CreateNewOutputRows method.</span></span>

 <span data-ttu-id="a8adb-168">Depois, o mecanismo de fluxo de dados invoca o método ProcessInput na classe UserComponent, que substitui o método <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.ProcessInput%2A> da classe pai <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent>.</span><span class="sxs-lookup"><span data-stu-id="a8adb-168">Next, the data flow engine invokes the ProcessInput method in the UserComponent class, which overrides the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.ProcessInput%2A> method of the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent> parent class.</span></span> <span data-ttu-id="a8adb-169">O método ProcessInput, por sua vez, executa um loop nas linhas do buffer de entrada e chama o método ProcessInputRow uma vez para cada linha.</span><span class="sxs-lookup"><span data-stu-id="a8adb-169">The ProcessInput method in turn loops through the rows in the input buffer and calls the ProcessInputRow method one time for each row.</span></span>

### <a name="writing-your-custom-code"></a><span data-ttu-id="a8adb-170">Escrevendo seu código personalizado</span><span class="sxs-lookup"><span data-stu-id="a8adb-170">Writing Your Custom Code</span></span>
 <span data-ttu-id="a8adb-171">Para concluir a criação de um componente de transformação assíncrona personalizado, use o método ProcessInputRow substituído para processar os dados em cada linha do buffer de entrada.</span><span class="sxs-lookup"><span data-stu-id="a8adb-171">To finish creating a custom asynchronous transformation component, you must use the overridden ProcessInputRow method to process the data in each row of the input buffer.</span></span> <span data-ttu-id="a8adb-172">Como as saídas não são síncronas para a entrada, escreva explicitamente linhas de dados para as saídas.</span><span class="sxs-lookup"><span data-stu-id="a8adb-172">Because the outputs are not synchronous to the input, you must explicitly write rows of data to the outputs.</span></span>

 <span data-ttu-id="a8adb-173">Em uma transformação assíncrona, você pode usar o método AddRow para adicionar linhas à saída, conforme apropriado, dentro do método ProcessInputRow ou ProcessInput.</span><span class="sxs-lookup"><span data-stu-id="a8adb-173">In an asynchronous transformation, you can use the AddRow method to add rows to the output as appropriate from within the ProcessInputRow or ProcessInput methods.</span></span> <span data-ttu-id="a8adb-174">Você não precisa usar o método CreateNewOutputRows.</span><span class="sxs-lookup"><span data-stu-id="a8adb-174">You do not have to use the CreateNewOutputRows method.</span></span> <span data-ttu-id="a8adb-175">Se estiver escrevendo uma única linha de resultados, como resultados de agregação, para determinada saída, crie a linha de saída antecipadamente usando o método CreateNewOutputRows e preencha seus valores posteriormente, depois de processar todas as linhas de entrada.</span><span class="sxs-lookup"><span data-stu-id="a8adb-175">If you are writing a single row of results, such as aggregation results, to a particular output, you can create the output row beforehand by using the CreateNewOutputRows method, and fill in its values later after processing all input rows.</span></span> <span data-ttu-id="a8adb-176">Contudo, não é útil criar múltiplas linhas no método CreateNewOutputRows, pois o componente Script só permite o uso da linha atual em uma entrada ou saída.</span><span class="sxs-lookup"><span data-stu-id="a8adb-176">However it is not useful to create multiple rows in the CreateNewOutputRows method, because the Script component only lets you use the current row in an input or output.</span></span> <span data-ttu-id="a8adb-177">O método CreateNewOutputRows é mais importante em um componente de origem em que não há linhas de entrada a serem processadas.</span><span class="sxs-lookup"><span data-stu-id="a8adb-177">The CreateNewOutputRows method is more important in a source component where there are no input rows to process.</span></span>

 <span data-ttu-id="a8adb-178">É recomendável substituir o próprio método ProcessInput. Isso permite executar um processamento preliminar ou final adicional antes ou depois de executar um loop no buffer de entrada e chamar ProcessInputRow para cada linha.</span><span class="sxs-lookup"><span data-stu-id="a8adb-178">You may also want to override the ProcessInput method itself, so that you can do additional preliminary or final processing before or after you loop through the input buffer and call ProcessInputRow for each row.</span></span> <span data-ttu-id="a8adb-179">Por exemplo, um dos exemplos de código neste tópico substitui ProcessInput para contar o número de endereços em uma cidade específica como ProcessInputRow loops por meio `.` de linhas o exemplo grava o valor de resumo na segunda saída depois que todas as linhas tiverem sido processadas.</span><span class="sxs-lookup"><span data-stu-id="a8adb-179">For example, one of the code examples in this topic overrides ProcessInput to count the number of addresses in a specific city as ProcessInputRow loops through rows`.` The example writes the summary value to the second output after all rows have been processed.</span></span> <span data-ttu-id="a8adb-180">O exemplo completa a saída em ProcessInput porque os buffers de saída não estão mais disponíveis quando PostExecute é chamado.</span><span class="sxs-lookup"><span data-stu-id="a8adb-180">The example completes the output in ProcessInput because the output buffers are no longer available when PostExecute is called.</span></span>

 <span data-ttu-id="a8adb-181">Dependendo dos requisitos, é recomendável escrever o script nos métodos PreExecute e PostExecute disponíveis na classe ScriptMain para executar qualquer processamento preliminar ou final.</span><span class="sxs-lookup"><span data-stu-id="a8adb-181">Depending on your requirements, you may also want to write script in the PreExecute and PostExecute methods available in the ScriptMain class to perform any preliminary or final processing.</span></span>

> [!NOTE]
>  <span data-ttu-id="a8adb-182">Se estiver desenvolvendo um componente de fluxo de dados personalizado a partir do zero, será importante substituir o método PrimeOutput para referências de cache aos buffers de saída, de modo que você possa adicionar linhas de dados aos buffers posteriormente.</span><span class="sxs-lookup"><span data-stu-id="a8adb-182">If you were developing a custom data flow component from scratch, it would be important to override the PrimeOutput method to cache references to the output buffers so that you could add rows of data to the buffers later.</span></span> <span data-ttu-id="a8adb-183">No componente Script, isto não é necessário porque você tem uma classe gerada automaticamente que representa cada buffer de saída no item de projeto `BufferWrapper`.</span><span class="sxs-lookup"><span data-stu-id="a8adb-183">In the Script component, this is not necessary because you have an automatically generated class representing each output buffer in the `BufferWrapper` project item.</span></span>

## <a name="example"></a><span data-ttu-id="a8adb-184">Exemplo</span><span class="sxs-lookup"><span data-stu-id="a8adb-184">Example</span></span>
 <span data-ttu-id="a8adb-185">Esse exemplo demonstra o código personalizado que é necessário na classe ScriptMain para criar um componente de transformação assíncrona.</span><span class="sxs-lookup"><span data-stu-id="a8adb-185">This example demonstrates the custom code that is required in the ScriptMain class to create an asynchronous transformation component.</span></span>

> [!NOTE]
>  <span data-ttu-id="a8adb-186">Esses exemplos usam a tabela **Person.Address** no banco de dados de exemplo **AdventureWorks** e passam sua primeira e quarta colunas, as colunas **intAddressID** e **nvarchar(30)City**, pelo fluxo de dados.</span><span class="sxs-lookup"><span data-stu-id="a8adb-186">These examples use the **Person.Address** table in the **AdventureWorks** sample database and pass its first and fourth columns, the **intAddressID** and **nvarchar(30)City** columns, through the data flow.</span></span> <span data-ttu-id="a8adb-187">Os mesmos dados são usados nos exemplos de origem, transformação e destino nessa seção.</span><span class="sxs-lookup"><span data-stu-id="a8adb-187">The same data is used in the source, transformation, and destination samples in this section.</span></span> <span data-ttu-id="a8adb-188">Pré-requisitos e suposições adicionais são documentados para cada exemplo.</span><span class="sxs-lookup"><span data-stu-id="a8adb-188">Additional prerequisites and assumptions are documented for each example.</span></span>

 <span data-ttu-id="a8adb-189">Esse exemplo demonstra um componente de transformação assíncrono com duas saídas.</span><span class="sxs-lookup"><span data-stu-id="a8adb-189">This example demonstrates an asynchronous transformation component with two outputs.</span></span> <span data-ttu-id="a8adb-190">Essa transformação passa pelas colunas **AddressID** e **City** para uma saída, enquanto conta o número de endereços localizados em uma cidade específica (Redmond, Washington, EUA) e, depois, gera o valor resultante para uma segunda saída.</span><span class="sxs-lookup"><span data-stu-id="a8adb-190">This transformation passes through the **AddressID** and **City** columns to one output, while it counts the number of addresses located in a specific city (Redmond, Washington, U.S.A.), and then outputs the resulting value to a second output.</span></span>

 <span data-ttu-id="a8adb-191">Se você quiser executar esse código de exemplo, configure o pacote e o componente desta forma:</span><span class="sxs-lookup"><span data-stu-id="a8adb-191">If you want to run this sample code, you must configure the package and the component as follows:</span></span>

1.  <span data-ttu-id="a8adb-192">Adicione um novo componente Script à superfície de designer Fluxo de Dados e configure-o como uma transformação.</span><span class="sxs-lookup"><span data-stu-id="a8adb-192">Add a new Script component to the Data Flow designer surface and configure it as a transformation.</span></span>

2.  <span data-ttu-id="a8adb-193">Conecte a saída de uma origem ou de outra transformação para o novo componente de transformação no designer.</span><span class="sxs-lookup"><span data-stu-id="a8adb-193">Connect the output of a source or of another transformation to the new transformation component in the designer.</span></span> <span data-ttu-id="a8adb-194">Essa saída deve fornecer dados da tabela **Person.Address** do banco de dados de exemplo **AdventureWorks** que contêm, pelo menos, as colunas **AddressID** e **City**.</span><span class="sxs-lookup"><span data-stu-id="a8adb-194">This output should provide data from the **Person.Address** table of the **AdventureWorks** sample database that contains at least the **AddressID** and **City** columns.</span></span>

3.  <span data-ttu-id="a8adb-195">Abra o **Editor de Transformação Scripts**.</span><span class="sxs-lookup"><span data-stu-id="a8adb-195">Open the **Script Transformation Editor**.</span></span> <span data-ttu-id="a8adb-196">Na página **Colunas de Entrada**, selecione as colunas **AddressID** e **City**.</span><span class="sxs-lookup"><span data-stu-id="a8adb-196">On the **Input Columns** page, select the **AddressID** and **City** columns.</span></span>

4.  <span data-ttu-id="a8adb-197">Na página **Entradas e Saídas**, adicione e configure as colunas de saída **AddressID** e **City** na primeira saída.</span><span class="sxs-lookup"><span data-stu-id="a8adb-197">On the **Inputs and Outputs** page, add and configure the **AddressID** and **City** output columns on the first output.</span></span> <span data-ttu-id="a8adb-198">Adicione uma segunda saída e uma coluna de saída para obter o valor resumido na segunda saída.</span><span class="sxs-lookup"><span data-stu-id="a8adb-198">Add a second output, and add an output column for the summary value on the second output.</span></span> <span data-ttu-id="a8adb-199">Defina a propriedade SynchronousInputID da primeira saída como 0, pois esse exemplo copia cada linha de entrada explicitamente na primeira saída.</span><span class="sxs-lookup"><span data-stu-id="a8adb-199">Set the SynchronousInputID property of the first output to 0, because this example copies each input row explicitly to the first output.</span></span> <span data-ttu-id="a8adb-200">A propriedade SynchronousInputID da saída recém-criada já está definida como 0.</span><span class="sxs-lookup"><span data-stu-id="a8adb-200">The SynchronousInputID property of the newly-created output is already set to 0.</span></span>

5.  <span data-ttu-id="a8adb-201">Renomeie a entrada, as saídas e a nova coluna de saída para atribuir a elas nomes mais descritivos.</span><span class="sxs-lookup"><span data-stu-id="a8adb-201">Rename the input, the outputs, and the new output column to give them more descriptive names.</span></span> <span data-ttu-id="a8adb-202">O exemplo usa **MyAddressInput** como o nome da entrada, **MyAddressOutput** e **MySummaryOutput** para as saídas e **MyRedmondCount** para a coluna de saída na segunda saída.</span><span class="sxs-lookup"><span data-stu-id="a8adb-202">The example uses **MyAddressInput** as the name of the input, **MyAddressOutput** and **MySummaryOutput** for the outputs, and **MyRedmondCount** for the output column on the second output.</span></span>

6.  <span data-ttu-id="a8adb-203">Na página **Script**, clique em **Editar Script** e insira o script a seguir.</span><span class="sxs-lookup"><span data-stu-id="a8adb-203">On the **Script** page, click **Edit Script** and enter the script that follows.</span></span> <span data-ttu-id="a8adb-204">Em seguida, feche o ambiente de desenvolvimento de script e o **Editor de Transformação Scripts**.</span><span class="sxs-lookup"><span data-stu-id="a8adb-204">Then close the script development environment and the **Script Transformation Editor**.</span></span>

7.  <span data-ttu-id="a8adb-205">Crie e configure um componente de destino para a primeira saída que espera as colunas **AddressID** e **City**, como um destino do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ou o componente de destino de exemplo demonstrado em [Criando um destino com o componente Script](../extending-packages-scripting-data-flow-script-component-types/creating-a-destination-with-the-script-component.md).</span><span class="sxs-lookup"><span data-stu-id="a8adb-205">Create and configure a destination component for the first output that expects the **AddressID** and **City** columns, such as a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] destination, or the sample destination component demonstrated in [Creating a Destination with the Script Component](../extending-packages-scripting-data-flow-script-component-types/creating-a-destination-with-the-script-component.md), .</span></span> <span data-ttu-id="a8adb-206">Depois, conecte a primeira saída da transformação, **MyAddressOutput**, ao componente de destino.</span><span class="sxs-lookup"><span data-stu-id="a8adb-206">Then connect the first output of the transformation, **MyAddressOutput**, to the destination component.</span></span> <span data-ttu-id="a8adb-207">Crie uma tabela de destino executando o seguinte comando [!INCLUDE[tsql](../../includes/tsql-md.md)] no banco de dados **AdventureWorks**:</span><span class="sxs-lookup"><span data-stu-id="a8adb-207">You can create a destination table by running the following [!INCLUDE[tsql](../../includes/tsql-md.md)] command in the **AdventureWorks** database:</span></span>

    ```
    CREATE TABLE [Person].[Address2]([AddressID] [int] NOT NULL,
        [City] [nvarchar](30) NOT NULL)
    ```

8.  <span data-ttu-id="a8adb-208">Crie e configure outro componente de destino para a segunda saída.</span><span class="sxs-lookup"><span data-stu-id="a8adb-208">Create and configure another destination component for the second output.</span></span> <span data-ttu-id="a8adb-209">Depois, conecte a segunda saída da transformação, **MySummaryOutput**, ao componente de destino.</span><span class="sxs-lookup"><span data-stu-id="a8adb-209">Then connect the second output of the transformation, **MySummaryOutput**, to the destination component.</span></span> <span data-ttu-id="a8adb-210">Como a segunda saída grava uma única linha com um único valor, você pode facilmente configurar um destino com um gerenciador de conexões de arquivo simples que se conecta a um novo arquivo que possui uma única coluna.</span><span class="sxs-lookup"><span data-stu-id="a8adb-210">Because the second output writes a single row with a single value, you can easily configure a destination with a Flat File connection manager that connects to a new file that has a single column.</span></span> <span data-ttu-id="a8adb-211">No exemplo, essa coluna de destino é chamada **MyRedmondCount**.</span><span class="sxs-lookup"><span data-stu-id="a8adb-211">In the example, this destination column is named **MyRedmondCount**.</span></span>

9. <span data-ttu-id="a8adb-212">Execute o exemplo.</span><span class="sxs-lookup"><span data-stu-id="a8adb-212">Run the sample.</span></span>

```vb
Public Class ScriptMain
    Inherits UserComponent

    Private myRedmondAddressCount As Integer

    Public Overrides Sub CreateNewOutputRows()

        MySummaryOutputBuffer.AddRow()

    End Sub

    Public Overrides Sub MyAddressInput_ProcessInput(ByVal Buffer As MyAddressInputBuffer)

        While Buffer.NextRow()
            MyAddressInput_ProcessInputRow(Buffer)
        End While

        If Buffer.EndOfRowset Then
            MyAddressOutputBuffer.SetEndOfRowset()
            MySummaryOutputBuffer.MyRedmondCount = myRedmondAddressCount
            MySummaryOutputBuffer.SetEndOfRowset()
        End If

    End Sub

    Public Overrides Sub MyAddressInput_ProcessInputRow(ByVal Row As MyAddressInputBuffer)

        With MyAddressOutputBuffer
            .AddRow()
            .AddressID = Row.AddressID
            .City = Row.City
        End With

        If Row.City.ToUpper = "REDMOND" Then
            myRedmondAddressCount += 1
        End If

    End Sub

End Class
```

```csharp
public class ScriptMain:
    UserComponent

{
    private int myRedmondAddressCount;

    public override void CreateNewOutputRows()
    {

        MySummaryOutputBuffer.AddRow();

    }

    public override void MyAddressInput_ProcessInput(MyAddressInputBuffer Buffer)
    {

        while (Buffer.NextRow())
        {
            MyAddressInput_ProcessInputRow(Buffer);
        }

        if (Buffer.EndOfRowset())
        {
            MyAddressOutputBuffer.SetEndOfRowset();
            MySummaryOutputBuffer.MyRedmondCount = myRedmondAddressCount;
            MySummaryOutputBuffer.SetEndOfRowset();
        }

    }

    public override void MyAddressInput_ProcessInputRow(MyAddressInputBuffer Row)
    {

        {
            MyAddressOutputBuffer.AddRow();
            MyAddressOutputBuffer.AddressID = Row.AddressID;
            MyAddressOutputBuffer.City = Row.City;
        }

        if (Row.City.ToUpper() == "REDMOND")
        {
            myRedmondAddressCount += 1;
        }

    }

}

```

<span data-ttu-id="a8adb-213">![Ícone de Integration Services (pequeno)](../media/dts-16.gif "Ícone do Integration Services (pequeno)")  **Mantenha-se atualizado com Integration Services**</span><span class="sxs-lookup"><span data-stu-id="a8adb-213">![Integration Services icon (small)](../media/dts-16.gif "Integration Services icon (small)")  **Stay Up to Date with Integration Services**</span></span><br /> <span data-ttu-id="a8adb-214">Para obter os downloads, artigos, exemplos e vídeos mais recentes da Microsoft, assim como soluções selecionadas pela comunidade, visite a página do [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] no MSDN:</span><span class="sxs-lookup"><span data-stu-id="a8adb-214">For the latest downloads, articles, samples, and videos from Microsoft, as well as selected solutions from the community, visit the [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] page on MSDN:</span></span><br /><br /> [<span data-ttu-id="a8adb-215">Visite a página do Integration Services no MSDN</span><span class="sxs-lookup"><span data-stu-id="a8adb-215">Visit the Integration Services page on MSDN</span></span>](https://go.microsoft.com/fwlink/?LinkId=136655)<br /><br /> <span data-ttu-id="a8adb-216">Para receber uma notificação automática dessas atualizações, assine os RSS feeds disponíveis na página.</span><span class="sxs-lookup"><span data-stu-id="a8adb-216">For automatic notification of these updates, subscribe to the RSS feeds available on the page.</span></span>

## <a name="see-also"></a><span data-ttu-id="a8adb-217">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="a8adb-217">See Also</span></span>
 <span data-ttu-id="a8adb-218">[Noções básicas sobre transformações síncronas e assíncronas](../understanding-synchronous-and-asynchronous-transformations.md) [criando uma transformação síncrona com o componente Script](../extending-packages-scripting-data-flow-script-component-types/creating-a-synchronous-transformation-with-the-script-component.md) [desenvolvendo um componente de transformação personalizado com saídas assíncronas](../extending-packages-custom-objects-data-flow-types/developing-a-custom-transformation-component-with-asynchronous-outputs.md)</span><span class="sxs-lookup"><span data-stu-id="a8adb-218">[Understanding Synchronous and Asynchronous Transformations](../understanding-synchronous-and-asynchronous-transformations.md) [Creating a Synchronous Transformation with the Script Component](../extending-packages-scripting-data-flow-script-component-types/creating-a-synchronous-transformation-with-the-script-component.md) [Developing a Custom Transformation Component with Asynchronous Outputs](../extending-packages-custom-objects-data-flow-types/developing-a-custom-transformation-component-with-asynchronous-outputs.md)</span></span>


