---
title: Componente Script | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.dts.designer.scriptcomponentdetails.f1
helpviewer_keywords:
- Script transformation
- scripts [Integration Services], transformations
- Script component [Integration Services], about Script component
- Script component [Integration Services]
ms.assetid: 131c2d0c-2e33-4785-94af-ada5c049821e
author: chugugrace
ms.author: chugu
ms.openlocfilehash: af8e500e399b0f69a7e34c9e2e01c74d83256107
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87686353"
---
# <a name="script-component"></a><span data-ttu-id="e2b4d-102">Componente Script</span><span class="sxs-lookup"><span data-stu-id="e2b4d-102">Script Component</span></span>
  <span data-ttu-id="e2b4d-103">O componente Script hospeda o script e permite que um pacote inclua e execute um código de script personalizado.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-103">The Script component hosts script and enables a package to include and run custom script code.</span></span> <span data-ttu-id="e2b4d-104">Você pode usar o componente Script em pacotes para as seguintes finalidades:</span><span class="sxs-lookup"><span data-stu-id="e2b4d-104">You can use the Script component in packages for the following purposes:</span></span>  
  
-   <span data-ttu-id="e2b4d-105">Aplicar várias transformações a dados em vez de usar transformações múltiplas no fluxo de dados.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-105">Apply multiple transformations to data instead of using multiple transformations in the data flow.</span></span> <span data-ttu-id="e2b4d-106">Por exemplo, um script pode adicionar os valores em duas colunas e depois calcular a média da soma.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-106">For example, a script can add the values in two columns and then calculate the average of the sum.</span></span>  
  
-   <span data-ttu-id="e2b4d-107">Acessar regras de negócio em um assembly .NET existente.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-107">Access business rules in an existing .NET assembly.</span></span> <span data-ttu-id="e2b4d-108">Por exemplo, um script pode aplicar uma regra de negócio que especifica um intervalo de valores válidos em uma coluna `Income`.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-108">For example, a script can apply a business rule that specifies the range of values that are valid in an `Income` column.</span></span>  
  
-   <span data-ttu-id="e2b4d-109">Usar fórmulas e funções personalizadas além das funções e dos operadores fornecidas pela gramática de expressão do [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="e2b4d-109">Use custom formulas and functions in addition to the functions and operators that the [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] expression grammar provides.</span></span> <span data-ttu-id="e2b4d-110">Por exemplo, validar números de cartão de crédito que usam a fórmula de LUHN.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-110">For example, validate credit card numbers that use the LUHN formula.</span></span>  
  
-   <span data-ttu-id="e2b4d-111">Validar dados de coluna e ignorar registros que contêm dados inválidos.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-111">Validate column data and skip records that contain invalid data.</span></span> <span data-ttu-id="e2b4d-112">Por exemplo, um script pode avaliar a racionalidade de um valor de postagem e ignorar registros com quantias extremamente altas ou baixas.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-112">For example, a script can assess the reasonableness of a postage amount and skip records with extremely high or low amounts.</span></span>  
  
 <span data-ttu-id="e2b4d-113">O componente Script fornece um modo fácil e rápido para incluir funções personalizadas em um fluxo de dados.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-113">The Script component provides an easy and quick way to include custom functions in a data flow.</span></span> <span data-ttu-id="e2b4d-114">Porém, se você planeja reutilizar o código de script em vários pacotes, deveria considerar programação de componente personalizado em vez de usar o componente Script.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-114">However, if you plan to reuse the script code in multiple packages, you should consider programming a custom component instead of using the Script component.</span></span> <span data-ttu-id="e2b4d-115">Para obter mais informações, consulte [Desenvolvendo um componente de fluxo de dados personalizado](../../extending-packages-custom-objects/data-flow/developing-a-custom-data-flow-component.md).</span><span class="sxs-lookup"><span data-stu-id="e2b4d-115">For more information, see [Developing a Custom Data Flow Component](../../extending-packages-custom-objects/data-flow/developing-a-custom-data-flow-component.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e2b4d-116">Se o componente Script contiver um script que tenta ler o valor de uma coluna que é NULL, esse componente falhará quando você executar o pacote.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-116">If the Script component contains a script that tries to read the value of a column that is NULL, the Script component fails when you run the package.</span></span> <span data-ttu-id="e2b4d-117">Recomendamos que o script use o método <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer.IsNull%2A> para determinar se a coluna é NULL antes de tentar ler o valor da coluna.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-117">We recommend that your script use the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer.IsNull%2A> method to determine whether the column is NULL before trying to read the column value.</span></span>  
  
 <span data-ttu-id="e2b4d-118">O componente Script pode ser usado como uma origem, uma transformação ou um destino.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-118">The Script component can be used as a source, a transformation, or a destination.</span></span> <span data-ttu-id="e2b4d-119">Esse componente oferece suporte a uma entrada e várias saídas.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-119">This component supports one input and multiple outputs.</span></span> <span data-ttu-id="e2b4d-120">Dependendo de como o componente é usado, ele oferece suporte a uma entrada ou saídas, ou ambas.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-120">Depending on how the component is used, it supports either an input or outputs or both.</span></span> <span data-ttu-id="e2b4d-121">O script é invocado por toda linha na entrada ou saída.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-121">The script is invoked by every row in the input or output.</span></span>  
  
-   <span data-ttu-id="e2b4d-122">Se usado como origem, o componente Script oferece suporte a várias saídas.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-122">If used as a source, the Script component supports multiple outputs.</span></span>  
  
-   <span data-ttu-id="e2b4d-123">Se usado como transformação, o componente Script oferece suporte a uma entrada e a várias saídas.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-123">If used as a transformation, the Script component supports one input and multiple outputs.</span></span>  
  
-   <span data-ttu-id="e2b4d-124">Se usado como destino, o componente Script oferece suporte a uma entrada.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-124">If used as a destination, the Script component supports one input.</span></span>  
  
 <span data-ttu-id="e2b4d-125">O componente Script não oferece suporte a saídas de erro.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-125">The Script component does not support error outputs.</span></span>  
  
 <span data-ttu-id="e2b4d-126">Depois de decidir que o componente Script é a escolha adequada para seu pacote, você precisa configurar as entradas e saídas, desenvolver o script usado pelo componente e configurar o próprio componente.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-126">After you decide that the Script component is the appropriate choice for your package, you have to configure the inputs and outputs, develop the script that the component uses, and configure the component itself.</span></span>  
  
## <a name="understanding-the-script-component-modes"></a><span data-ttu-id="e2b4d-127">Compreendendo os modos do componente Script</span><span class="sxs-lookup"><span data-stu-id="e2b4d-127">Understanding the Script Component Modes</span></span>  
 <span data-ttu-id="e2b4d-128">No Designer [!INCLUDE[ssIS](../../../includes/ssis-md.md)] , o componente Script tem dois modos: modo do design de metadados e modo do design de código.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-128">In the [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer, the Script component has two modes: metadata-design mode and code-design mode.</span></span> <span data-ttu-id="e2b4d-129">No modo design de metadados, você pode adicionar e modificar as entradas e saídas do componente Script, mas não pode escrever código.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-129">In metadata-design mode, you can add and modify the Script component inputs and outputs, but you cannot write code.</span></span> <span data-ttu-id="e2b4d-130">Depois que todas as entradas e saídas são configuradas, você troca para o modo do design de código para escrever o script.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-130">After all the inputs and outputs are configured, you switch to code-design mode to write the script.</span></span> <span data-ttu-id="e2b4d-131">O componente Script gera automaticamente o código base a partir dos metadados das entradas e saídas.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-131">The Script component automatically generates base code from the metadata of the inputs and outputs.</span></span> <span data-ttu-id="e2b4d-132">Se você alterar os metadados depois que o componente Script gerar o código base, talvez seu código não seja compilado porque o código base atualizado pode ser incompatível com seu código.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-132">If you change the metadata after the Script component generates the base code, your code may no longer compile because the updated base code may be incompatible with your code.</span></span>  
  
## <a name="writing-the-script-that-the-component-uses"></a><span data-ttu-id="e2b4d-133">Escrevendo o Script que o componente usa</span><span class="sxs-lookup"><span data-stu-id="e2b4d-133">Writing the Script that the Component Uses</span></span>  
 <span data-ttu-id="e2b4d-134">O componente Script usa o [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] VSTA (Tools for Applications) como o ambiente em que os scripts são escritos.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-134">The Script component uses [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] Tools for Applications (VSTA) as the environment in which you write the scripts.</span></span> <span data-ttu-id="e2b4d-135">Você acessa o VSTA no **Editor de Transformação Scripts**.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-135">You access VSTA from the **Script Transformation Editor**.</span></span> <span data-ttu-id="e2b4d-136">Para obter mais informações, consulte [Editor de Transformação Scripts &#40;Página Script&#41;](../../script-transformation-editor-script-page.md).</span><span class="sxs-lookup"><span data-stu-id="e2b4d-136">For more information, see [Script Transformation Editor &#40;Script Page&#41;](../../script-transformation-editor-script-page.md).</span></span>  
  
 <span data-ttu-id="e2b4d-137">O componente Script fornece um projeto VSTA que inclui uma classe gerada automaticamente, nomeada ScriptMain, que representa os metadados do componente.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-137">The Script component provides a VSTA project that includes an auto-generated class, named ScriptMain, that represents the component metadata.</span></span> <span data-ttu-id="e2b4d-138">Por exemplo, se o componente Script for usado como uma transformação que tem três saídas, o ScriptMain incluirá um método para cada saída.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-138">For example, if the Script component is used as a transformation that has three outputs, ScriptMain includes a method for each output.</span></span> <span data-ttu-id="e2b4d-139">O ScriptMain é o ponto de entrada para o script.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-139">ScriptMain is the entry point to the script.</span></span>  
  
 <span data-ttu-id="e2b4d-140">O VSTA inclui todos os recursos padrão do ambiente [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] , como o editor [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] codificado por cor, o IntelliSense e o Object Browser.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-140">VSTA includes all the standard features of the [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] environment, such as the color-coded [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] editor, IntelliSense, and Object Browser.</span></span> <span data-ttu-id="e2b4d-141">O script usado pelo componente Script é armazenado na definição de pacote.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-141">The script that the Script component uses is stored in the package definition.</span></span> <span data-ttu-id="e2b4d-142">Quando você está projetando o pacote, o código de script é gravado temporariamente em um arquivo de projeto.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-142">When you are designing the package, the script code is temporarily written to a project file.</span></span>  
  
 <span data-ttu-id="e2b4d-143">O VSTA dá suporte às linguagens de programação [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C# e [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-143">VSTA supports the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C# and [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Basic programming languages.</span></span>  
  
 <span data-ttu-id="e2b4d-144">Para obter informações sobre como programar o componente Script, consulte [Estender o fluxo de dados com o componente de Script](script-component.md).</span><span class="sxs-lookup"><span data-stu-id="e2b4d-144">For information about how to program the Script component, see [Extending the Data Flow with the Script Component](script-component.md).</span></span> <span data-ttu-id="e2b4d-145">Para obter mais informações específicas sobre como configurar o componente Script como origem, transformação ou destino, consulte [Developing Specific Types of Script Components](../../extending-packages-scripting-data-flow-script-component-types/developing-specific-types-of-script-components.md).</span><span class="sxs-lookup"><span data-stu-id="e2b4d-145">For more specific information about how to configure the Script component as a source, transformation, or destination, see [Developing Specific Types of Script Components](../../extending-packages-scripting-data-flow-script-component-types/developing-specific-types-of-script-components.md).</span></span> <span data-ttu-id="e2b4d-146">Para obter exemplos adicionais como um destino de ODBC que demonstra o uso do componente Script, consulte [Additional Script Component Examples](../../extending-packages-scripting-data-flow-script-component-examples/additional-script-component-examples.md).</span><span class="sxs-lookup"><span data-stu-id="e2b4d-146">For additional examples such as an ODBC destination that demonstrate the use of the Script component, see [Additional Script Component Examples](../../extending-packages-scripting-data-flow-script-component-examples/additional-script-component-examples.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e2b4d-147">Ao contrário das versões anteriores em que você podia indicar se os scripts eram pré-compilados, todos os scripts são pré-compilados no [!INCLUDE[ssISversion10](../../../includes/ssisversion10-md.md)] e em versões posteriores.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-147">Unlike earlier versions where you could indicate whether the scripts were precompiled, all scripts are precompiled in [!INCLUDE[ssISversion10](../../../includes/ssisversion10-md.md)] and later versions.</span></span> <span data-ttu-id="e2b4d-148">Quando um script é pré-compilado, o mecanismo de linguagem não é carregado no tempo de execução e o pacote é executado mais rapidamente.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-148">When a script is precompiled, the language engine is not loaded at run time and the package runs more quickly.</span></span> <span data-ttu-id="e2b4d-149">No entanto, arquivos binários pré-compilados consomem espaço significativo em disco.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-149">However, precompiled binary files consume significant disk space.</span></span>  
  
## <a name="configuring-the-script-component"></a><span data-ttu-id="e2b4d-150">Configurando o componente Script</span><span class="sxs-lookup"><span data-stu-id="e2b4d-150">Configuring the Script Component</span></span>  
 <span data-ttu-id="e2b4d-151">Você pode configurar o componente Script das seguintes maneiras:</span><span class="sxs-lookup"><span data-stu-id="e2b4d-151">You can configure the Script component in the following ways:</span></span>  
  
-   <span data-ttu-id="e2b4d-152">Selecione as colunas de entrada para referência.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-152">Select the input columns to reference.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="e2b4d-153">Você pode configurar só uma entrada quando usar o Designer do [!INCLUDE[ssIS](../../../includes/ssis-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="e2b4d-153">You can configure only one input when you use the [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer.</span></span>  
  
-   <span data-ttu-id="e2b4d-154">Forneça o script que o componente é executado.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-154">Provide the script that the component runs.</span></span>  
  
-   <span data-ttu-id="e2b4d-155">Especifique a linguagem do script.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-155">Specify the script language.</span></span>  
  
-   <span data-ttu-id="e2b4d-156">Forneça listas separadas por vírgula das variáveis de somente leitura e gravação/leitura.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-156">Provide comma-separated lists of read-only and read/write variables.</span></span>  
  
-   <span data-ttu-id="e2b4d-157">Adicione mais saídas e adicione colunas de saída atribuídas ao script.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-157">Add more outputs, and add output columns to which the script assigns.</span></span>  
  
 <span data-ttu-id="e2b4d-158">Você pode definir propriedades pelo Designer do [!INCLUDE[ssIS](../../../includes/ssis-md.md)] ou programaticamente.</span><span class="sxs-lookup"><span data-stu-id="e2b4d-158">You can set properties through [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer or programmatically.</span></span>  
  
### <a name="configuring-the-script-component-in-the-designer"></a><span data-ttu-id="e2b4d-159">Configurando o componente Script no Designer</span><span class="sxs-lookup"><span data-stu-id="e2b4d-159">Configuring the Script Component in the Designer</span></span>  
 <span data-ttu-id="e2b4d-160">Para obter mais informações sobre as propriedades que podem ser definidas na caixa de diálogo **Editor de Transformação Scripts** , clique em um dos seguintes tópicos:</span><span class="sxs-lookup"><span data-stu-id="e2b4d-160">For more information about the properties that you can set in the **Script Transformation Editor** dialog box, click one of the following topics:</span></span>  
  
-   [<span data-ttu-id="e2b4d-161">Editor de Transformação Scripts &#40;página Colunas de Entrada&#41;</span><span class="sxs-lookup"><span data-stu-id="e2b4d-161">Script Transformation Editor &#40;Input Columns Page&#41;</span></span>](../../script-transformation-editor-input-columns-page.md)  
  
-   [<span data-ttu-id="e2b4d-162">Editor de Transformação Scripts &#40;Página Entradas e Saídas&#41;</span><span class="sxs-lookup"><span data-stu-id="e2b4d-162">Script Transformation Editor &#40;Inputs and Outputs Page&#41;</span></span>](../../script-transformation-editor-inputs-and-outputs-page.md)  
  
-   [<span data-ttu-id="e2b4d-163">Editor de Transformação Scripts &#40;Página Script&#41;</span><span class="sxs-lookup"><span data-stu-id="e2b4d-163">Script Transformation Editor &#40;Script Page&#41;</span></span>](../../script-transformation-editor-script-page.md)  
  
-   [<span data-ttu-id="e2b4d-164">Editor de Transformação Scripts &#40;Página Gerenciadores de Conexões&#41;</span><span class="sxs-lookup"><span data-stu-id="e2b4d-164">Script Transformation Editor &#40;Connection Managers Page&#41;</span></span>](../../script-transformation-editor-connection-managers-page.md)  
  
 <span data-ttu-id="e2b4d-165">Para obter mais informações sobre como definir essas propriedades no [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer, clique no tópico a seguir:</span><span class="sxs-lookup"><span data-stu-id="e2b4d-165">For more information about how to set these properties in [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer, click the following topic:</span></span>  
  
-   [<span data-ttu-id="e2b4d-166">Definir as propriedades de um componente de fluxo de dados</span><span class="sxs-lookup"><span data-stu-id="e2b4d-166">Set the Properties of a Data Flow Component</span></span>](../set-the-properties-of-a-data-flow-component.md)  
  
### <a name="configuring-the-script-component-programmatically"></a><span data-ttu-id="e2b4d-167">Configurando o componente Script programaticamente</span><span class="sxs-lookup"><span data-stu-id="e2b4d-167">Configuring the Script Component Programmatically</span></span>  
 <span data-ttu-id="e2b4d-168">Para obter mais informações sobre as propriedades que podem ser definidas na janela **Propriedades** ou programaticamente, clique em um dos seguintes tópicos:</span><span class="sxs-lookup"><span data-stu-id="e2b4d-168">For more information about the properties that you can set in the **Properties** window or programmatically, click one of the following topics:</span></span>  
  
-   [<span data-ttu-id="e2b4d-169">Propriedades comuns</span><span class="sxs-lookup"><span data-stu-id="e2b4d-169">Common Properties</span></span>](../../common-properties.md)  
  
-   [<span data-ttu-id="e2b4d-170">Propriedades personalizadas de Transformação</span><span class="sxs-lookup"><span data-stu-id="e2b4d-170">Transformation Custom Properties</span></span>](transformation-custom-properties.md)  
  
 <span data-ttu-id="e2b4d-171">Para obter mais informações sobre como definir propriedades, clique em um dos seguintes tópicos:</span><span class="sxs-lookup"><span data-stu-id="e2b4d-171">For more information about how to set properties, click one of the following topics:</span></span>  
  
-   [<span data-ttu-id="e2b4d-172">Definir as propriedades de um componente de fluxo de dados</span><span class="sxs-lookup"><span data-stu-id="e2b4d-172">Set the Properties of a Data Flow Component</span></span>](../set-the-properties-of-a-data-flow-component.md)  
  
## <a name="related-content"></a><span data-ttu-id="e2b4d-173">Conteúdo relacionado</span><span class="sxs-lookup"><span data-stu-id="e2b4d-173">Related Content</span></span>  
 [<span data-ttu-id="e2b4d-174">Transformações do Integration Services</span><span class="sxs-lookup"><span data-stu-id="e2b4d-174">Integration Services Transformations</span></span>](integration-services-transformations.md)  
  
 [<span data-ttu-id="e2b4d-175">Estender o fluxo de dados com o componente de Script</span><span class="sxs-lookup"><span data-stu-id="e2b4d-175">Extending the Data Flow with the Script Component</span></span>](script-component.md)  
  
  
