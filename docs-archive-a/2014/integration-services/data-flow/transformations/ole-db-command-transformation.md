---
title: Transformação Comando OLE DB | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.dts.designer.oledbcommandtrans.f1
helpviewer_keywords:
- statements [Integration Services]
- OLE DB Command transformation
ms.assetid: baa6735c-5acf-4759-b077-1216aca16c6c
author: chugugrace
ms.author: chugu
ms.openlocfilehash: a6b0498d0ae5fa61a00cc7f6fc89e4dc506cd25a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87686360"
---
# <a name="ole-db-command-transformation"></a><span data-ttu-id="38e2a-102">transformação Comando OLE DB</span><span class="sxs-lookup"><span data-stu-id="38e2a-102">OLE DB Command Transformation</span></span>
  <span data-ttu-id="38e2a-103">A transformação Comando OLE DB executa uma instrução SQL para cada linha do fluxo de dados.</span><span class="sxs-lookup"><span data-stu-id="38e2a-103">The OLE DB Command transformation runs an SQL statement for each row in a data flow.</span></span> <span data-ttu-id="38e2a-104">Por exemplo, você pode executar uma instrução SQL que insira, atualize ou exclua linhas em uma tabela de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="38e2a-104">For example, you can run an SQL statement that inserts, updates, or deletes rows in a database table.</span></span>  
  
 <span data-ttu-id="38e2a-105">É possível configurar a transformação Comando OLE DB com os seguintes procedimentos:</span><span class="sxs-lookup"><span data-stu-id="38e2a-105">You can configure the OLE DB Command Transformation in the following ways:</span></span>  
  
-   <span data-ttu-id="38e2a-106">Forneça a instrução SQL que a transformação executa para cada linha.</span><span class="sxs-lookup"><span data-stu-id="38e2a-106">Provide the SQL statement that the transformation runs for each row.</span></span>  
  
-   <span data-ttu-id="38e2a-107">Especifique o número de segundos antes que a instrução SQL expire.</span><span class="sxs-lookup"><span data-stu-id="38e2a-107">Specify the number of seconds before the SQL statement times out.</span></span>  
  
-   <span data-ttu-id="38e2a-108">Especifique a página de código padrão.</span><span class="sxs-lookup"><span data-stu-id="38e2a-108">Specify the default code page.</span></span>  
  
 <span data-ttu-id="38e2a-109">Normalmente, a instrução SQL inclui parâmetros.</span><span class="sxs-lookup"><span data-stu-id="38e2a-109">Typically, the SQL statement includes parameters.</span></span> <span data-ttu-id="38e2a-110">Os valores de parâmetro são armazenados em colunas externas na entrada da transformação e o mapeamento de uma coluna de entrada para uma coluna externa mapeia uma coluna de entrada para um parâmetro.</span><span class="sxs-lookup"><span data-stu-id="38e2a-110">The parameter values are stored in external columns in the transformation input, and mapping an input column to an external column maps an input column to a parameter.</span></span> <span data-ttu-id="38e2a-111">Por exemplo, para localizar linhas na tabela **DimProduct** pelo valor da coluna **ProductKey** e, em seguida, excluí-las, você pode mapear a coluna externa nomeada como **Param_0** para a coluna de entrada nomeada como **ProductKey** e, em seguida, executar a instrução SQL `DELETE FROM DimProduct WHERE ProductKey = ?`.</span><span class="sxs-lookup"><span data-stu-id="38e2a-111">For example, to locate rows in the **DimProduct** table by the value in their **ProductKey** column and then delete them, you can map the external column named **Param_0** to the input column named **ProductKey,** and then run the SQL statement `DELETE FROM DimProduct WHERE ProductKey = ?`..</span></span> <span data-ttu-id="38e2a-112">A transformação Comando OLE DB fornece os nomes de parâmetro e você não pode modificá-los.</span><span class="sxs-lookup"><span data-stu-id="38e2a-112">The OLE DB Command transformation provides the parameter names and you cannot modify them.</span></span> <span data-ttu-id="38e2a-113">Os nomes de parâmetro são **Param_0**, **Param_1**e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="38e2a-113">The parameter names are **Param_0**, **Param_1**, and so on.</span></span>  
  
 <span data-ttu-id="38e2a-114">Se você configurar a transformação Comando OLE DB usando a caixa de diálogo **Editor Avançado** , os parâmetros na instrução SQL poderão ser mapeados automaticamente para colunas externas na entrada da transformação e as características de cada parâmetro poderão ser definidas, clicando no botão **Atualizar** .</span><span class="sxs-lookup"><span data-stu-id="38e2a-114">If you configure the OLE DB Command transformation by using the **Advanced Editor** dialog box, the parameters in the SQL statement may be mapped automatically to external columns in the transformation input, and the characteristics of each parameter defined, by clicking the **Refresh** button.</span></span> <span data-ttu-id="38e2a-115">Entretanto, se o provedor OLE DB que a transformação Comando OLE DB usa não oferecer suporte para derivação de informações do parâmetro, você deverá configurar as colunas externas manualmente.</span><span class="sxs-lookup"><span data-stu-id="38e2a-115">However, if the OLE DB provider that the OLE DB Command transformation uses does not support deriving parameter information from the parameter, you must configure the external columns manually.</span></span> <span data-ttu-id="38e2a-116">Isto significa que você deve adicionar uma coluna para cada parâmetro na entrada externa para a transformação, atualizar os nomes de coluna para usar nomes como **Param_0**, especificar o valor da propriedade DBParamInfoFlags e mapear as colunas de entrada que contêm valores de parâmetro para as colunas externas.</span><span class="sxs-lookup"><span data-stu-id="38e2a-116">This means that you must add a column for each parameter to the external input to the transformation, update the column names to use names like **Param_0**, specify the value of the DBParamInfoFlags property, and map the input columns that contain parameter values to the external columns.</span></span>  
  
 <span data-ttu-id="38e2a-117">O valor da propriedade DBParamInfoFlags representa as características do parâmetro.</span><span class="sxs-lookup"><span data-stu-id="38e2a-117">The value of DBParamInfoFlags represents the characteristics of the parameter.</span></span> <span data-ttu-id="38e2a-118">Por exemplo, o valor **1** especifica que o parâmetro é de entrada e o valor **65** especifica que o parâmetro é de entrada e pode conter um valor nulo.</span><span class="sxs-lookup"><span data-stu-id="38e2a-118">For example, the value **1** specifies that the parameter is an input parameter, and the value **65** specifies that the parameter is an input parameter and may contain a null value.</span></span> <span data-ttu-id="38e2a-119">Os valores devem corresponder aos da enumeração OLE DB DBPARAMFLAGSENUM.</span><span class="sxs-lookup"><span data-stu-id="38e2a-119">The values must match the values in the OLE DB DBPARAMFLAGSENUM enumeration.</span></span> <span data-ttu-id="38e2a-120">Para obter mais informações, consulte a documentação de referência do OLE DB.</span><span class="sxs-lookup"><span data-stu-id="38e2a-120">For more information, see the OLE DB reference documentation.</span></span>  
  
 <span data-ttu-id="38e2a-121">A transformação Comando OLE DB inclui a propriedade personalizada `SQLCommand`.</span><span class="sxs-lookup"><span data-stu-id="38e2a-121">The OLE DB Command transformation includes the `SQLCommand` custom property.</span></span> <span data-ttu-id="38e2a-122">Essa propriedade pode ser atualizada por uma expressão de propriedade quando o pacote é carregado.</span><span class="sxs-lookup"><span data-stu-id="38e2a-122">This property can be updated by a property expression when the package is loaded.</span></span> <span data-ttu-id="38e2a-123">Para obter mais informações, consulte [Expressões do Integration Services &#40;SSIS&#41;](../../expressions/integration-services-ssis-expressions.md), [Usar expressões de propriedade em pacotes](../../expressions/use-property-expressions-in-packages.md) e [Propriedades personalizadas da transformação](transformation-custom-properties.md).</span><span class="sxs-lookup"><span data-stu-id="38e2a-123">For more information, see [Integration Services &#40;SSIS&#41; Expressions](../../expressions/integration-services-ssis-expressions.md), [Use Property Expressions in Packages](../../expressions/use-property-expressions-in-packages.md), and [Transformation Custom Properties](transformation-custom-properties.md).</span></span>  
  
 <span data-ttu-id="38e2a-124">Essa transformação tem uma entrada, uma saída comum e uma saída de erro.</span><span class="sxs-lookup"><span data-stu-id="38e2a-124">This transformation has one input, one regular output, and one error output.</span></span>  
  
## <a name="logging"></a><span data-ttu-id="38e2a-125">Registro em log</span><span class="sxs-lookup"><span data-stu-id="38e2a-125">Logging</span></span>  
 <span data-ttu-id="38e2a-126">Você poderá fazer log das chamadas que a transformação Comando OLE DB fizer a provedores de dados externos.</span><span class="sxs-lookup"><span data-stu-id="38e2a-126">You can log the calls that the OLE DB Command transformation makes to external data providers.</span></span> <span data-ttu-id="38e2a-127">Você pode usar esse recurso de log para solucionar problemas de conexões e comandos das fontes de dados externos executados pela transformação Comando OLE DB.</span><span class="sxs-lookup"><span data-stu-id="38e2a-127">You can use this logging capability to troubleshoot the connections and commands to external data sources that the OLE DB Command transformation performs.</span></span> <span data-ttu-id="38e2a-128">Para fazer log das chamadas que a transformação Comando OLE DB fizer aos provedores de dados externos, habilite o log do pacote e selecione o evento **Diagnóstico** no nível de pacote.</span><span class="sxs-lookup"><span data-stu-id="38e2a-128">To log the calls that the OLE DB Command transformation makes to external data providers, enable package logging and select the **Diagnostic** event at the package level.</span></span> <span data-ttu-id="38e2a-129">Para obter mais informações, consulte [Solucionando problemas de ferramentas para execução de pacotes](../../troubleshooting/troubleshooting-tools-for-package-execution.md).</span><span class="sxs-lookup"><span data-stu-id="38e2a-129">For more information, see [Troubleshooting Tools for Package Execution](../../troubleshooting/troubleshooting-tools-for-package-execution.md).</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="38e2a-130">Related Tasks</span><span class="sxs-lookup"><span data-stu-id="38e2a-130">Related Tasks</span></span>  
 <span data-ttu-id="38e2a-131">Você pode configurar a transformação por meio do [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer ou do modelo de objeto.</span><span class="sxs-lookup"><span data-stu-id="38e2a-131">You can configure the transformation by either using the [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer or the object model.</span></span> <span data-ttu-id="38e2a-132">Para obter detalhes sobre como configurar a transformação por meio do [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer, consulte  [Configurar a transformação do Comando OLE DB](../../configure-the-ole-db-command-transformation.md).</span><span class="sxs-lookup"><span data-stu-id="38e2a-132">For details about configuring the transformation using the [!INCLUDE[ssIS](../../../includes/ssis-md.md)] designer, see  [Configure the OLE DB Command Transformation](../../configure-the-ole-db-command-transformation.md).</span></span> <span data-ttu-id="38e2a-133">Consulte o Guia do Desenvolvedor para obter detalhes sobre como configurar essa transformação programaticamente.</span><span class="sxs-lookup"><span data-stu-id="38e2a-133">See the Developer Guide for details about programmatically configuring this transformation.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="38e2a-134">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="38e2a-134">See Also</span></span>  
 <span data-ttu-id="38e2a-135">[Fluxo de Dados](../data-flow.md) </span><span class="sxs-lookup"><span data-stu-id="38e2a-135">[Data Flow](../data-flow.md) </span></span>  
 [<span data-ttu-id="38e2a-136">Transformações do Integration Services</span><span class="sxs-lookup"><span data-stu-id="38e2a-136">Integration Services Transformations</span></span>](integration-services-transformations.md)  
  
  
