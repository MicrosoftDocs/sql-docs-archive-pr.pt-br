---
title: Definir uma variável de estado | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
ms.assetid: 45d66152-883a-49a7-a877-2e8ab45f8f79
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 5214b3512ea0113d1abace61a76033e5531ac99f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87685876"
---
# <a name="define-a-state-variable"></a><span data-ttu-id="9e4af-102">Definir uma variável de estado</span><span class="sxs-lookup"><span data-stu-id="9e4af-102">Define a State Variable</span></span>
  <span data-ttu-id="9e4af-103">Este procedimento descreve como definir uma variável de pacote onde o estado CDC é armazenado.</span><span class="sxs-lookup"><span data-stu-id="9e4af-103">This procedure describes how to define a package variable where the CDC state is stored.</span></span>  
  
 <span data-ttu-id="9e4af-104">A variável de estado CDC é carregada, inicializada e atualizada pela tarefa Controle de CDC e é usada pelo componente de fluxo de dados de Origem CDC para determinar o intervalo de processamento atual para alterar registros.</span><span class="sxs-lookup"><span data-stu-id="9e4af-104">The CDC state variable is loaded, initialized, and updated by the CDC Control task and is used by the CDC Source data flow component to determine the current processing range for change records.</span></span> <span data-ttu-id="9e4af-105">A variável de estado CDC pode ser definida em qualquer contêiner comum à tarefa de Controle de CDC e à origem CDC.</span><span class="sxs-lookup"><span data-stu-id="9e4af-105">The CDC state variable can be defined on any container common to the CDC Control task and the CDC source.</span></span> <span data-ttu-id="9e4af-106">Isso pode estar no nível do pacote, mas pode estar também em outros contêineres, como um contêiner de loop.</span><span class="sxs-lookup"><span data-stu-id="9e4af-106">This may be at the package level but may also be on other containers such as a loop container.</span></span>  
  
 <span data-ttu-id="9e4af-107">A modificação manual do valor da variável de estado CDC não é recomendável, no entanto, isso pode ser útil para entender seu conteúdo.</span><span class="sxs-lookup"><span data-stu-id="9e4af-107">Manually modifying the CDC state variable value is not recommended, however it can be useful to understand its contents.</span></span>  
  
 <span data-ttu-id="9e4af-108">A tabela a seguir fornece uma descrição de alto nível dos componentes do valor da variável de estado CDC.</span><span class="sxs-lookup"><span data-stu-id="9e4af-108">The following table provides a high-level description of the components of the CDC state variable value.</span></span>  
  
|<span data-ttu-id="9e4af-109">Componente</span><span class="sxs-lookup"><span data-stu-id="9e4af-109">Component</span></span>|<span data-ttu-id="9e4af-110">DESCRIÇÃO</span><span class="sxs-lookup"><span data-stu-id="9e4af-110">Description</span></span>|  
|---------------|-----------------|  
|`<state-name>`|<span data-ttu-id="9e4af-111">Este é o nome do estado CDC atual.</span><span class="sxs-lookup"><span data-stu-id="9e4af-111">This is the name of the current CDC state.</span></span>|  
|`CS`|<span data-ttu-id="9e4af-112">Isso marca o ponto inicial do intervalo de processamento atual (Início atual).</span><span class="sxs-lookup"><span data-stu-id="9e4af-112">This marks the current processing range start point (Current Start).</span></span>|  
|`<cs-lsn>`|<span data-ttu-id="9e4af-113">Este é último LSN (número de sequência de log) processado na execução CDC anterior.</span><span class="sxs-lookup"><span data-stu-id="9e4af-113">This is the last (Log Sequence Number) LSN processed in the previous CDC run.</span></span>|  
|`CE`|<span data-ttu-id="9e4af-114">Isso marca o ponto final do intervalo de processamento atual (Término atual).</span><span class="sxs-lookup"><span data-stu-id="9e4af-114">This marks the current processing range end point (Current End).</span></span> <span data-ttu-id="9e4af-115">A presença do componente de término atual no estado CDC é uma indicação de que ou um pacote CDC está atualmente em processamento ou um pacote de CDC falhou antes de processar completamente seu intervalo de processamento CDC.</span><span class="sxs-lookup"><span data-stu-id="9e4af-115">The presence of the CE component in the CDC state is an indication that either a CDC package is currently processing or that a CDC package failed before fully processing its CDC processing range.</span></span>|  
|`<ce-lsn>`|<span data-ttu-id="9e4af-116">Este é o último LSN a ser processado na execução CDC atual.</span><span class="sxs-lookup"><span data-stu-id="9e4af-116">This is the last LSN to be processed in the current CDC Run.</span></span> <span data-ttu-id="9e4af-117">Sempre presumimos que o último número de sequência a ser processado é o máximo (0xFFF…).</span><span class="sxs-lookup"><span data-stu-id="9e4af-117">It is always assumed that the last sequence number to be processed is the maximum (0xFFF...).</span></span>|  
|`IR`|<span data-ttu-id="9e4af-118">Isso marca o intervalo de processamento inicial.</span><span class="sxs-lookup"><span data-stu-id="9e4af-118">This marks the initial processing range.</span></span>|  
|`<ir-start>`|<span data-ttu-id="9e4af-119">Este é o LSN de uma alteração imediatamente antes de a carga inicial ter sido iniciada.</span><span class="sxs-lookup"><span data-stu-id="9e4af-119">This is an LSN of a change just before the initial load began.</span></span>|  
|`<ir-end>`|<span data-ttu-id="9e4af-120">Este é o LSN de uma alteração imediatamente depois de a carga inicial ter sido terminada.</span><span class="sxs-lookup"><span data-stu-id="9e4af-120">This is an LSN of a change just after the initial load ended.</span></span>|  
|`TS`|<span data-ttu-id="9e4af-121">Isso marca o carimbo de data/hora para a última atualização do estado CDC.</span><span class="sxs-lookup"><span data-stu-id="9e4af-121">This marks the timestamp for the last CDC state update.</span></span>|  
|**\<timestamp>**|<span data-ttu-id="9e4af-122">Essa é uma representação decimal da propriedade System.DateTime.UtcNow de 64 bits.</span><span class="sxs-lookup"><span data-stu-id="9e4af-122">This is a decimal representation of the 64-bit, System.DateTime.UtcNow property.</span></span>|  
|`ER`|<span data-ttu-id="9e4af-123">Isso aparece quando a última operação falhou e inclui uma descrição breve da causa do erro.</span><span class="sxs-lookup"><span data-stu-id="9e4af-123">This appears when the last operation failed and includes a short description of the cause of the error.</span></span> <span data-ttu-id="9e4af-124">Se esse componente estiver presente, ela será sempre o último.</span><span class="sxs-lookup"><span data-stu-id="9e4af-124">If this component is present, it will always appear last.</span></span>|  
|`<short-error-text>`|<span data-ttu-id="9e4af-125">Essa é a descrição curta do erro.</span><span class="sxs-lookup"><span data-stu-id="9e4af-125">This is the short error description.</span></span>|  
  
 <span data-ttu-id="9e4af-126">Os LSNs e os números de sequência são codificados como uma cadeia de caracteres hexadecimal de até 20 dígitos que representam o valor LSN do binário (10).</span><span class="sxs-lookup"><span data-stu-id="9e4af-126">The LSNs and sequence numbers are each encoded as a hexadecimal string of up to 20 digits representing the LSN value of Binary(10).</span></span>  
  
 <span data-ttu-id="9e4af-127">A tabela a seguir descreve os valores de estado CDC possíveis.</span><span class="sxs-lookup"><span data-stu-id="9e4af-127">The following table describes the possible CDC state values.</span></span>  
  
|<span data-ttu-id="9e4af-128">Estado</span><span class="sxs-lookup"><span data-stu-id="9e4af-128">State</span></span>|<span data-ttu-id="9e4af-129">Descrição</span><span class="sxs-lookup"><span data-stu-id="9e4af-129">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="9e4af-130">(INITIAL)</span><span class="sxs-lookup"><span data-stu-id="9e4af-130">(INITIAL)</span></span>|<span data-ttu-id="9e4af-131">Esse é o estado inicial antes de qualquer pacote ter sido executado no grupo de CDC atual.</span><span class="sxs-lookup"><span data-stu-id="9e4af-131">This is the initial state before the any package was run on the current CDC group.</span></span> <span data-ttu-id="9e4af-132">Este também é o estado quando o estado de CDC está vazio.</span><span class="sxs-lookup"><span data-stu-id="9e4af-132">This is also the state when the CDC state is empty.</span></span>|  
|<span data-ttu-id="9e4af-133">ILSTART (Initial Load Started)</span><span class="sxs-lookup"><span data-stu-id="9e4af-133">ILSTART (Initial Load Started)</span></span>|<span data-ttu-id="9e4af-134">Esse é o estado do início do pacote de carga inicial, depois da chamada da operação de `MarkInitialLoadStart` para a tarefa Controle CDC.</span><span class="sxs-lookup"><span data-stu-id="9e4af-134">This is the state when the initial load package starts, after the `MarkInitialLoadStart` operation call to the CDC Control task.</span></span>|  
|<span data-ttu-id="9e4af-135">ILEND (Initial Load Ended)</span><span class="sxs-lookup"><span data-stu-id="9e4af-135">ILEND (Initial Load Ended)</span></span>|<span data-ttu-id="9e4af-136">Esse é o estado do término bem-sucedido do pacote de carga inicial, depois da chamada da operação de `MarkInitialLoadEnd` para a tarefa Controle CDC.</span><span class="sxs-lookup"><span data-stu-id="9e4af-136">This is the state when the initial load package ends successfully, after the `MarkInitialLoadEnd` operation call to the CDC Control task.</span></span>|  
|<span data-ttu-id="9e4af-137">ILUPDATE (Initial Load Update)</span><span class="sxs-lookup"><span data-stu-id="9e4af-137">ILUPDATE (Initial Load Update)</span></span>|<span data-ttu-id="9e4af-138">Este é o estado nas execuções do pacote de atualização trickle feed depois da carga inicial, enquanto ainda processa o intervalo de processamento inicial.</span><span class="sxs-lookup"><span data-stu-id="9e4af-138">This is the state on the runs of the trickle feed update package following the initial load, while still processing the initial processing range.</span></span> <span data-ttu-id="9e4af-139">Isto ocorre depois da chamada da operação `GetProcessingRange` para a tarefa Controle CDC.</span><span class="sxs-lookup"><span data-stu-id="9e4af-139">This is after the `GetProcessingRange` operation call to the CDC Control task.</span></span><br /><br /> <span data-ttu-id="9e4af-140">Se estiver usando a coluna __$reprocessing, ela será definida como 1 para indicar que o pacote pode estar reprocessando linhas já no destino.</span><span class="sxs-lookup"><span data-stu-id="9e4af-140">If using the __$reprocessing column, it is set to 1 to indicate that the package may be re-processing rows already at the target.</span></span>|  
|<span data-ttu-id="9e4af-141">TFEND (Trickle-Feed Update Ended)</span><span class="sxs-lookup"><span data-stu-id="9e4af-141">TFEND (Trickle-Feed Update Ended)</span></span>|<span data-ttu-id="9e4af-142">Este é o estado esperado para execuções regulares de CDC.</span><span class="sxs-lookup"><span data-stu-id="9e4af-142">This is the state expected for regular CDC runs.</span></span> <span data-ttu-id="9e4af-143">Ele indica que a execução anterior foi concluída com êxito e que uma nova execução com um novo intervalo de processamento pode ser iniciada.</span><span class="sxs-lookup"><span data-stu-id="9e4af-143">It indicates that the previous run completed successfully and that a new run with a new processing range can be started.</span></span>|  
|<span data-ttu-id="9e4af-144">TFSTART</span><span class="sxs-lookup"><span data-stu-id="9e4af-144">TFSTART</span></span>|<span data-ttu-id="9e4af-145">Este é o estado em uma execução não inicial do pacote de atualização trickle feed depois que a operação `GetProcessingRange` chama a tarefa Controle CDC.</span><span class="sxs-lookup"><span data-stu-id="9e4af-145">This is the state on a non-initial run of the trickle feed update package, after the `GetProcessingRange` operation call to the CDC Control task.</span></span><br /><br /> <span data-ttu-id="9e4af-146">Isto indica que uma execução CDC regular foi iniciada, mas não foi concluída ou ainda não foi concluída completamente (`MarkProcessedRange`).</span><span class="sxs-lookup"><span data-stu-id="9e4af-146">This indicates that a regular CDC run is started but has not finished or has not yet finished, cleanly (`MarkProcessedRange`).</span></span>|  
|<span data-ttu-id="9e4af-147">TFREDO (Reprocessing Trickle-Feed Updates)</span><span class="sxs-lookup"><span data-stu-id="9e4af-147">TFREDO (Reprocessing Trickle-Feed Updates)</span></span>|<span data-ttu-id="9e4af-148">Este é o estado em um `GetProcessingRange` que ocorre depois de TFSTART.</span><span class="sxs-lookup"><span data-stu-id="9e4af-148">This is the state on a `GetProcessingRange` that occurs after TFSTART.</span></span> <span data-ttu-id="9e4af-149">Isto indica que a execução anterior não foi concluída com êxito.</span><span class="sxs-lookup"><span data-stu-id="9e4af-149">This indicates that the previous run did not complete successfully.</span></span><br /><br /> <span data-ttu-id="9e4af-150">Se estiver usando a coluna __$reprocessing, ela será definida como 1 para indicar que o pacote pode estar reprocessando linhas já no destino.</span><span class="sxs-lookup"><span data-stu-id="9e4af-150">If using the __$reprocessing column, it is set to 1 to indicate that the package may be re-processing rows already at the target.</span></span>|  
|<span data-ttu-id="9e4af-151">ERROR</span><span class="sxs-lookup"><span data-stu-id="9e4af-151">ERROR</span></span>|<span data-ttu-id="9e4af-152">O grupo de CDC está em um estado de ERROR.</span><span class="sxs-lookup"><span data-stu-id="9e4af-152">The CDC group is in an ERROR state.</span></span>|  
  
 <span data-ttu-id="9e4af-153">Os seguintes são exemplos de valores de variável de estado CDC.</span><span class="sxs-lookup"><span data-stu-id="9e4af-153">The following are examples of CDC state variable values.</span></span>  
  
-   <span data-ttu-id="9e4af-154">ILSTART/IR/0x0000162B158700000000//TS/2011-08-07T17:10:43.0031645/</span><span class="sxs-lookup"><span data-stu-id="9e4af-154">ILSTART/IR/0x0000162B158700000000//TS/2011-08-07T17:10:43.0031645/</span></span>  
  
-   <span data-ttu-id="9e4af-155">ILSTART/IR/0x0000162B158700000000//TS/2011-08-07T17:10:43.0031645/</span><span class="sxs-lookup"><span data-stu-id="9e4af-155">ILSTART/IR/0x0000162B158700000000//TS/2011-08-07T17:10:43.0031645/</span></span>  
  
-   <span data-ttu-id="9e4af-156">TFEND/CS/0x0000025B000001BC0003/TS/2011-07-17T12:05:58.1001145/</span><span class="sxs-lookup"><span data-stu-id="9e4af-156">TFEND/CS/0x0000025B000001BC0003/TS/2011-07-17T12:05:58.1001145/</span></span>  
  
-   <span data-ttu-id="9e4af-157">TFSTART/CS/0x0000030D000000AE0003/CE/0x0000159D1E0F01000000/TS/2011-08-09T05:30:43.9344900/</span><span class="sxs-lookup"><span data-stu-id="9e4af-157">TFSTART/CS/0x0000030D000000AE0003/CE/0x0000159D1E0F01000000/TS/2011-08-09T05:30:43.9344900/</span></span>  
  
-   <span data-ttu-id="9e4af-158">TFREDO/CS/0x0000030D000000AE0003/CE/0x0000159D1E0F01000000/TS/2011-08-09T05:30:59.5544900/</span><span class="sxs-lookup"><span data-stu-id="9e4af-158">TFREDO/CS/0x0000030D000000AE0003/CE/0x0000159D1E0F01000000/TS/2011-08-09T05:30:59.5544900/</span></span>  
  
### <a name="to-define-a-cdc-state-variable"></a><span data-ttu-id="9e4af-159">Para definir uma variável de estado CDC</span><span class="sxs-lookup"><span data-stu-id="9e4af-159">To define a CDC state variable</span></span>  
  
1.  <span data-ttu-id="9e4af-160">No [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)], abra o pacote [!INCLUDE[ssISCurrent](../../includes/ssiscurrent-md.md)] que tem o fluxo de CDC onde você precisa definir a variável.</span><span class="sxs-lookup"><span data-stu-id="9e4af-160">In [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)], open the [!INCLUDE[ssISCurrent](../../includes/ssiscurrent-md.md)] package that has the CDC flow where you need to define the variable.</span></span>  
  
2.  <span data-ttu-id="9e4af-161">Clique na guia **Explorador de Pacotes** e adicione uma nova variável.</span><span class="sxs-lookup"><span data-stu-id="9e4af-161">Click the **Package Explorer** tab, and add a new variable.</span></span>  
  
3.  <span data-ttu-id="9e4af-162">Dê a variável um nome que você possa reconhecer como sua variável de estado.</span><span class="sxs-lookup"><span data-stu-id="9e4af-162">Give the variable a name that you can recognize as your state variable.</span></span>  
  
4.  <span data-ttu-id="9e4af-163">Atribua à variável um tipo de dados **String** .</span><span class="sxs-lookup"><span data-stu-id="9e4af-163">Give the variable a **String** data type.</span></span>  
  
 <span data-ttu-id="9e4af-164">Não dê à variável um valor como parte de sua definição.</span><span class="sxs-lookup"><span data-stu-id="9e4af-164">Do not give the variable a value as part of its definition.</span></span> <span data-ttu-id="9e4af-165">O valor deve ser definido pela tarefa Controle de CDC.</span><span class="sxs-lookup"><span data-stu-id="9e4af-165">The value must be set by the CDC Control task.</span></span>  
  
 <span data-ttu-id="9e4af-166">Se você estiver planejando usar a tarefa Controle de CDC com **Persistência de Estado Automática**, a variável de Estado CDC será lida a partir da tabela de estado de banco de dados especificada e será atualizada para a mesma tabela quando seu valor for alterado.</span><span class="sxs-lookup"><span data-stu-id="9e4af-166">If you plan to use the CDC Control task with **Automatic State Persistence**, the CDC State variable will be read from the database state table you specify and will be updated back to that same table when its value changes.</span></span> <span data-ttu-id="9e4af-167">Para obter mais informações sobre a tabela de Estado, consulte [CDC Control Task](../control-flow/cdc-control-task.md)e [CDC Control Task Editor](../cdc-control-task-editor.md).</span><span class="sxs-lookup"><span data-stu-id="9e4af-167">For more information about the State table, see [CDC Control Task](../control-flow/cdc-control-task.md)and [CDC Control Task Editor](../cdc-control-task-editor.md).</span></span>  
  
 <span data-ttu-id="9e4af-168">Se você não estiver usando a tarefa de Controle CDC com a Persistência de Estado Automática, deverá carregar o valor da variável a partir do repositório persistente em que seu valor foi salvo da última vez que o pacote foi executado e gravá-la no repositório persistente quando o processamento do intervalo atual for concluído.</span><span class="sxs-lookup"><span data-stu-id="9e4af-168">If you are not using the CDC Control task with Automatic State Persistence then you must load the variable value from persistent storage where its value was saved the last time the package ran and to write it back to the persistent storage when the processing of the current processing range was completed.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9e4af-169">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="9e4af-169">See Also</span></span>  
 <span data-ttu-id="9e4af-170">[Tarefa Controle de CDC](../control-flow/cdc-control-task.md) </span><span class="sxs-lookup"><span data-stu-id="9e4af-170">[CDC Control Task](../control-flow/cdc-control-task.md) </span></span>  
 [<span data-ttu-id="9e4af-171">Editor da Tarefa Controle de CDC</span><span class="sxs-lookup"><span data-stu-id="9e4af-171">CDC Control Task Editor</span></span>](../cdc-control-task-editor.md)  
  
  
