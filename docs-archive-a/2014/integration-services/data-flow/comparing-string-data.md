---
title: Comparar dados de cadeia de caracteres | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- comparing string data
- comparison options [Integration Services]
- locales [Integration Services]
- converting string data
- string comparisons
ms.assetid: 93aeb5bd-e208-46b7-8979-dea2dcd37d4c
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 5670f434470d8fad0a8b593ccde0c01ae307e417
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87582561"
---
# <a name="comparing-string-data"></a><span data-ttu-id="6eb6e-102">comparando dados de cadeia de caracteres</span><span class="sxs-lookup"><span data-stu-id="6eb6e-102">Comparing String Data</span></span>
  <span data-ttu-id="6eb6e-103">Comparações de cadeia de caracteres são uma parte importante de muitas das transformações realizadas pelo [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)]e as comparações de cadeia de caracteres também são usadas na avaliação de expressões em variáveis e expressões de propriedade.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-103">String comparisons are an important part of many of the transformations performed by [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)], and string comparisons are also used in the evaluation of expressions in variables and property expressions.</span></span> <span data-ttu-id="6eb6e-104">Por exemplo, a transformação de Classificação compara valores em um conjunto de dados para classificar dados em ordem crescente ou decrescente.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-104">For example, the Sort transformation compares values in a dataset to sort data in ascending or descending order.</span></span>  
  
## <a name="configuring-transformations-for-string-comparisons"></a><span data-ttu-id="6eb6e-105">Configurando transformações para comparações de cadeias de caracteres</span><span class="sxs-lookup"><span data-stu-id="6eb6e-105">Configuring Transformations for String Comparisons</span></span>  
 <span data-ttu-id="6eb6e-106">As transformações Classificação, Agregação, Agrupamento Difuso e Pesquisa Difusa podem ser personalizadas para alterar a maneira que as cadeias de caracteres são comparadas no nível da coluna.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-106">The Sort, Aggregate, Fuzzy Grouping, and Fuzzy Lookup transformations can be customized to change the way strings are compared at the column level.</span></span> <span data-ttu-id="6eb6e-107">Por exemplo, é possível especificar que uma comparação ignore caixas altas e baixas, o que significa que os caracteres maiúsculos e minúsculos são tratados da mesma forma.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-107">For example, you can specify that a comparison ignores case, which means that uppercase and lowercase characters are treated as the same character.</span></span>  
  
 <span data-ttu-id="6eb6e-108">As seguintes transformações usam expressões que podem incluir comparações de cadeias de caracteres.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-108">The following transformations use expressions that can include string comparisons.</span></span>  
  
-   <span data-ttu-id="6eb6e-109">A transformação Divisão Condicional pode usar comparações de cadeia de caracteres em expressões para determinar para qual saída enviar a linha de dados.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-109">The Conditional Split transformation can use string comparisons in expressions to determine which output to send the data row to.</span></span> <span data-ttu-id="6eb6e-110">Para obter mais informações, consulte [Conditional Split Transformation](transformations/conditional-split-transformation.md).</span><span class="sxs-lookup"><span data-stu-id="6eb6e-110">For more information, see [Conditional Split Transformation](transformations/conditional-split-transformation.md).</span></span>  
  
-   <span data-ttu-id="6eb6e-111">A transformação de Coluna Derivada pode usar comparações de cadeias de caracteres em expressões para gerar novos valores de coluna.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-111">The Derived Column transformation can use string comparisons in expressions to generate new column values.</span></span> <span data-ttu-id="6eb6e-112">Para obter mais informações, consulte [Derived Column Transformation](transformations/derived-column-transformation.md).</span><span class="sxs-lookup"><span data-stu-id="6eb6e-112">For more information, see [Derived Column Transformation](transformations/derived-column-transformation.md).</span></span>  
  
 <span data-ttu-id="6eb6e-113">Variáveis, mapeamentos de variáveis e restrições de precedência também usam expressões que podem incluir comparações de cadeias de caracteres.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-113">Variables, variable mappings, and precedence constraints also use expressions, which can include string comparisons.</span></span> <span data-ttu-id="6eb6e-114">Para obter mais informações sobre expressões, consulte [Integration Services &#40;SSIS&#41; Expressões](../expressions/integration-services-ssis-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="6eb6e-114">For more information about expressions, see [Integration Services &#40;SSIS&#41; Expressions](../expressions/integration-services-ssis-expressions.md).</span></span>  
  
## <a name="processing-during-string-comparison"></a><span data-ttu-id="6eb6e-115">Processando durante a comparação de cadeias de caracteres</span><span class="sxs-lookup"><span data-stu-id="6eb6e-115">Processing during String Comparison</span></span>  
 <span data-ttu-id="6eb6e-116">Dependendo dos dados e da configuração da transformação, o seguinte processamento pode ocorrer durante a comparação dos dados da cadeia de caracteres:</span><span class="sxs-lookup"><span data-stu-id="6eb6e-116">Depending on the data and the configuration of the transformation, the following processing may occur during the comparison of string data:</span></span>  
  
-   <span data-ttu-id="6eb6e-117">Convertendo dados em Unicode.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-117">Converting data to Unicode.</span></span> <span data-ttu-id="6eb6e-118">Se os dados de origem ainda não forem Unicode, eles serão convertidos automaticamente para Unicode antes da comparação ocorrer.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-118">If the source data is not already Unicode, the data is automatically converted to Unicode before the comparison occurs.</span></span>  
  
-   <span data-ttu-id="6eb6e-119">Usando a localidade para aplicar regras específicas de localidades para interpretar data, hora, dados decimais e ordem de classificação.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-119">Using locale to apply locale-specific rules for interpreting date, time, decimal data, and sort order.</span></span>  
  
-   <span data-ttu-id="6eb6e-120">Aplicando opções de comparação no nível de coluna para alterar a sensibilidade das comparações.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-120">Applying comparison options at the column level to change the sensitivity of comparisons.</span></span>  
  
## <a name="converting-string-data-to-unicode"></a><span data-ttu-id="6eb6e-121">Convertendo os dados da cadeia de caracteres para Unicode</span><span class="sxs-lookup"><span data-stu-id="6eb6e-121">Converting String Data to Unicode</span></span>  
 <span data-ttu-id="6eb6e-122">Dependendo das operações que a transformação realiza e a configuração da transformação, os dados da cadeia de caracteres podem ser convertidos no tipo de dados DT_WSTR, que é uma representação Unicode dos caracteres da cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-122">Depending on the operations that the transformation performs and the configuration of the transformation, string data may be converted to the DT_WSTR data type, which is a Unicode representation of string characters.</span></span>  
  
 <span data-ttu-id="6eb6e-123">Os dados de cadeias de caracteres que têm o tipo DT_STR são convertidos em Unicode por meio do uso da página de código da coluna.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-123">String data that has the DT_STR data type is converted to Unicode using the code page of the column.</span></span> [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] <span data-ttu-id="6eb6e-124">dá suporte a páginas de código no nível de coluna, e cada coluna pode ser convertida por meio de uma página de código diferente.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-124">supports code pages at the column level, and each column can be converted by using a different code page.</span></span>  
  
 <span data-ttu-id="6eb6e-125">Na maioria dos casos, o [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] pode identificar a página de código correta da origem de dados.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-125">In most cases, [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] can identify the correct code page from the data source.</span></span> <span data-ttu-id="6eb6e-126">Por exemplo, no [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] é possível definir uma ordenação nos níveis do banco de dados e da coluna.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-126">For example, in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] you can set a collation at the database and column levels.</span></span> <span data-ttu-id="6eb6e-127">A página de código é derivada de uma ordenação do [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], que pode ser uma ordenação do Windows ou do SQL.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-127">The code page is derived from a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] collation, which can be either a Windows or an SQL collation.</span></span>  
  
 <span data-ttu-id="6eb6e-128">Se o [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] fornecer uma página de código inesperada ou se o pacote acessar uma origem de dados usando um provedor que não fornece informações suficientes para determinar a página de código correta, você poderá especificar uma página de código padrão na origem OLE DB e no destino OLE DB.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-128">If [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] provides an unexpected code page, or if the package accesses a data source by using a provider that does not supply sufficient information to determine the correct code page, you can specify a default code page in the OLE DB source and the OLE DB destination.</span></span> <span data-ttu-id="6eb6e-129">As páginas de código padrão são usadas em vez das páginas de código fornecidas pelo [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="6eb6e-129">The default code pages are used instead of the code pages that [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] provides.</span></span>  
  
 <span data-ttu-id="6eb6e-130">Os arquivos não têm páginas de código.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-130">Files do not have code pages.</span></span> <span data-ttu-id="6eb6e-131">Ao invés disso, os gerenciadores de conexões de Arquivo Simples e de Vários Arquivos Simples usados por um pacote para conectar aos dados de arquivo incluem uma propriedade para especificar a página de código do arquivo.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-131">Instead, the Flat File and the Multiple Flat Files connection managers that a package uses to connect to file data include a property for specifying the code page of the file.</span></span> <span data-ttu-id="6eb6e-132">A página de código pode ser definida apenas no nível de arquivo, não no nível da coluna.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-132">The code page can be set at the file level only, not at the column level.</span></span>  
  
## <a name="setting-locale"></a><span data-ttu-id="6eb6e-133">Configuração de localidade</span><span class="sxs-lookup"><span data-stu-id="6eb6e-133">Setting Locale</span></span>  
 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] <span data-ttu-id="6eb6e-134">não usa a página de código para inscrever regras específicas de localidades para classificar dados ou interpretar data, hora e dados decimais.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-134">does not use the code page to infer locale-specific rules for sorting data or interpreting date, time, and decimal data.</span></span> <span data-ttu-id="6eb6e-135">Em vez disso, a transformação lê a localidade definida pela propriedade LocaleId no componente de fluxo de dados, tarefa de Fluxo de Dados, contêiner ou pacote.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-135">Instead, the transformation reads the locale that is set by the LocaleId property on the data flow component, Data Flow task, container, or package.</span></span> <span data-ttu-id="6eb6e-136">Por padrão, a localidade de uma transformação é herdada de sua tarefa de Fluxo de Dados, que, por sua vez, herda do pacote.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-136">By default, the locale of a transformation is inherited from its Data Flow task, which in turn inherits from the package.</span></span> <span data-ttu-id="6eb6e-137">Se a tarefa de Fluxo de Dados estiver em um contêiner como o Loop For, ela herdará sua localidade do contêiner.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-137">If the Data Flow task is in a container such as the For Loop container, it inherits its locale from the container.</span></span>  
  
 <span data-ttu-id="6eb6e-138">Também é possível especificar uma localidade para o gerenciamento de conexões de Arquivo Simples e um gerenciador de conexões de Vários Arquivos Simples.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-138">You can also specify a locale for a Flat File connection manager and a Multiple Flat Files connection manager.</span></span>  
  
## <a name="setting-comparison-options"></a><span data-ttu-id="6eb6e-139">Definindo opções de comparação</span><span class="sxs-lookup"><span data-stu-id="6eb6e-139">Setting Comparison Options</span></span>  
 <span data-ttu-id="6eb6e-140">A localidade fornece as regras básicas para comparar dados de cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-140">The locale provides the basic rules for comparing string data.</span></span> <span data-ttu-id="6eb6e-141">Por exemplo, a localidade especifica a posição de classificação de cada letra no alfabeto.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-141">For example, the locale specifies the sort position of each letter in the alphabet.</span></span> <span data-ttu-id="6eb6e-142">No entanto, essas regras podem não ser suficientes para as comparações que algumas transformações realizam e o [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] oferece suporte a um conjunto de opções de comparação avançadas que vão além das regras de comparação de uma localidade.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-142">However, these rules may not be sufficient for the comparisons that some transformations perform, and [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] supports a set of advanced comparison options that go beyond the comparison rules of a locale.</span></span> <span data-ttu-id="6eb6e-143">Estas opções de comparação são definidas no nível da coluna.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-143">These comparison options are set at the column level.</span></span> <span data-ttu-id="6eb6e-144">Por exemplo, um das opções de comparação permite que você ignore caracteres de não espaçamento.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-144">For example, one of the comparison options lets you ignore nonspacing characters.</span></span> <span data-ttu-id="6eb6e-145">O efeito dessa opção é ignorar sinais diacríticos, como o acento, que torna "a" e "å" idênticos para fins de comparação.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-145">The effect of this option is to ignore diacritics such as the accent, which makes "a" and "å" identical for comparison purposes.</span></span>  
  
 <span data-ttu-id="6eb6e-146">A seguinte tabela descreve as opções de comparação e um estilo de classificação.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-146">The following table describes the comparison options and a sort style.</span></span>  
  
|<span data-ttu-id="6eb6e-147">Opção de comparação</span><span class="sxs-lookup"><span data-stu-id="6eb6e-147">Comparison option</span></span>|<span data-ttu-id="6eb6e-148">DESCRIÇÃO</span><span class="sxs-lookup"><span data-stu-id="6eb6e-148">Description</span></span>|  
|-----------------------|-----------------|  
|<span data-ttu-id="6eb6e-149">Ignora maiúsculas e minúsculas</span><span class="sxs-lookup"><span data-stu-id="6eb6e-149">Ignore case</span></span>|<span data-ttu-id="6eb6e-150">Especifica se a comparação faz distinção entre letras maiúsculas e minúsculas.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-150">Specifies whether the comparison distinguishes between uppercase and lowercase letters.</span></span> <span data-ttu-id="6eb6e-151">Se esta opção for definida, a comparação de cadeia de caracteres ignorará a distinção entre letras maiúsculas e minúsculas.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-151">If this option is set, the string comparison ignores case.</span></span> <span data-ttu-id="6eb6e-152">Por exemplo, "ABC" torna-se igual a "abc".</span><span class="sxs-lookup"><span data-stu-id="6eb6e-152">For example, "ABC" becomes the same as "abc".</span></span>|  
|<span data-ttu-id="6eb6e-153">Ignora o tipo kana</span><span class="sxs-lookup"><span data-stu-id="6eb6e-153">Ignore kana type</span></span>|<span data-ttu-id="6eb6e-154">Especifica se a comparação distingue os dois tipos de caracteres de kana japoneses: hiragana e katakana.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-154">Specifies whether the comparison distinguishes between the two types of Japanese kana characters: hiragana and katakana.</span></span> <span data-ttu-id="6eb6e-155">Se esta opção for definida, a comparação de cadeia de caracteres ignorará o tipo de kana usado.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-155">If this option is set, the string comparison ignores kana type.</span></span>|  
|<span data-ttu-id="6eb6e-156">Ignora largura do caractere</span><span class="sxs-lookup"><span data-stu-id="6eb6e-156">Ignore character width</span></span>|<span data-ttu-id="6eb6e-157">Especifica se a comparação faz distinção entre um caractere de byte único e o mesmo caractere representado como um caractere de byte duplo.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-157">Specifies whether the comparison distinguishes between a single-byte character and the same character when it is represented as a double-byte character.</span></span> <span data-ttu-id="6eb6e-158">Se esta opção for definida, a comparação de cadeia de caracteres tratará representações de byte único e representações de byte duplo do mesmo caractere como idênticas.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-158">If this option is set, the string comparison treats single-byte and double-byte representations of the same character as identical.</span></span>|  
|<span data-ttu-id="6eb6e-159">Ignora caracteres de não espaçamento</span><span class="sxs-lookup"><span data-stu-id="6eb6e-159">Ignore nonspacing characters</span></span>|<span data-ttu-id="6eb6e-160">Especifica se a comparação distingue entre caracteres de espaço e sinais diacríticos.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-160">Specifies whether the comparison distinguishes between spacing characters and diacritics.</span></span> <span data-ttu-id="6eb6e-161">Se esta opção for definida, a comparação ignorará os sinais diacríticos.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-161">If this option is set, the comparison ignores diacritics.</span></span> <span data-ttu-id="6eb6e-162">Por exemplo, "å" é igual a "a".</span><span class="sxs-lookup"><span data-stu-id="6eb6e-162">For example, "å" is equal to "a".</span></span>|  
|<span data-ttu-id="6eb6e-163">Ignora símbolos</span><span class="sxs-lookup"><span data-stu-id="6eb6e-163">Ignore symbols</span></span>|<span data-ttu-id="6eb6e-164">Especifica se a comparação faz distinção entre caracteres de letra e símbolos como caracteres de espaço em branco, pontuação, símbolos monetários e matemáticos.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-164">Specifies whether the comparison distinguishes between letter characters and symbols such as white-space characters, punctuation, currency symbols, and mathematical symbols.</span></span> <span data-ttu-id="6eb6e-165">Se esta opção estiver definida, a comparação de cadeia de caracteres ignorará símbolos.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-165">If this option is set, the string comparison ignores symbols.</span></span> <span data-ttu-id="6eb6e-166">Por exemplo, " Nova Iorque" se torna igual a "Nova Iorque" e "\* ABC" é o mesmo que "ABC" '.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-166">For example, " New York" becomes the same as "New York" and "\*ABC" is the same as "ABC"'.</span></span>|  
|<span data-ttu-id="6eb6e-167">Classificar pontuação como símbolos</span><span class="sxs-lookup"><span data-stu-id="6eb6e-167">Sort punctuation as symbols</span></span>|<span data-ttu-id="6eb6e-168">Especifica se a comparação classifica todos os símbolos de pontuação, menos o hífen e o apóstrofo, antes dos caracteres alfanuméricos.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-168">Specifies whether the comparison sorts all punctuation symbols, except the hyphen and apostrophe, before the alphanumeric characters.</span></span> <span data-ttu-id="6eb6e-169">Por exemplo, se esta opção for definida, ".ABC" será classificada antes de "ABC."</span><span class="sxs-lookup"><span data-stu-id="6eb6e-169">For example, if this option is set, ".ABC" sorts before "ABC".</span></span>|  
  
 <span data-ttu-id="6eb6e-170">As transformações Classificação, Agregar, Agrupamento Difuso e Pesquisa Difusa incluem estas opções para comparar dados.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-170">The Sort, Aggregate, Fuzzy Grouping and Fuzzy Lookup transformations include these options for comparing data.</span></span>  
  
 <span data-ttu-id="6eb6e-171">O sinalizador de comparação **FullySensitive** é exibido na caixa de diálogo **Editor Avançado** para as transformações Agrupamento Difuso e Pesquisa Difusa.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-171">The **FullySensitive** comparison flag displays in the **Advanced Editor** dialog box for the Fuzzy Grouping and Fuzzy Lookup transformations.</span></span> <span data-ttu-id="6eb6e-172">Selecionar o sinalizador de comparação **FullySensitive** significa que todas as opções de comparação se aplicam.</span><span class="sxs-lookup"><span data-stu-id="6eb6e-172">Selecting the **FullySensitive** comparison flag means that all the comparison options apply.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6eb6e-173">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="6eb6e-173">See Also</span></span>  
 <span data-ttu-id="6eb6e-174">[Tipos de dados do Integration Services](integration-services-data-types.md) </span><span class="sxs-lookup"><span data-stu-id="6eb6e-174">[Integration Services Data Types](integration-services-data-types.md) </span></span>  
 <span data-ttu-id="6eb6e-175">[Análise rápida](../fast-parse.md) </span><span class="sxs-lookup"><span data-stu-id="6eb6e-175">[Fast Parse](../fast-parse.md) </span></span>  
 [<span data-ttu-id="6eb6e-176">Análise padrão</span><span class="sxs-lookup"><span data-stu-id="6eb6e-176">Standard Parse</span></span>](../standard-parse.md)  
  
  
