---
title: Construtor de Consultas | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.dts.designer.querybuilder.f1
helpviewer_keywords:
- Query Builder dialog box
ms.assetid: 780752c9-6e3c-4f44-aaff-4f4d5e5a45c5
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 81be066d92ef1e19a141414dad4359b60efca2f9
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87679417"
---
# <a name="query-builder"></a><span data-ttu-id="0fdbd-102">Construtor de Consultas</span><span class="sxs-lookup"><span data-stu-id="0fdbd-102">Query Builder</span></span>
  <span data-ttu-id="0fdbd-103">Use a caixa de diálogo **Construtor de Consultas** para criar uma consulta a ser usada na tarefa Executar SQL, na origem e no destino OLE DB e na transformação Pesquisa.</span><span class="sxs-lookup"><span data-stu-id="0fdbd-103">Use the **Query Builder** dialog box to create a query for use in the Execute SQL task, the OLE DB source and the OLE DB destination, and the Lookup transformation.</span></span>  
  
 <span data-ttu-id="0fdbd-104">Você pode utilizar o Construtor de Consultas para executar as seguintes tarefas:</span><span class="sxs-lookup"><span data-stu-id="0fdbd-104">You can use Query Builder to perform the following tasks:</span></span>  
  
-   <span data-ttu-id="0fdbd-105">**Trabalhar com a representação gráfica de uma consulta ou com comandos SQL** O Construtor de Consultas inclui um painel que exibe sua consulta graficamente e um painel que exibe o texto SQL de sua consulta.</span><span class="sxs-lookup"><span data-stu-id="0fdbd-105">**Working with a graphical representation of a query or with SQL commands** Query Builder includes a pane that displays your query graphically and a pane that displays the SQL text of your query.</span></span> <span data-ttu-id="0fdbd-106">Você pode trabalhar no painel gráfico ou no painel de texto.</span><span class="sxs-lookup"><span data-stu-id="0fdbd-106">You can work in either the graphical pane or the text pane.</span></span> <span data-ttu-id="0fdbd-107">O Construtor de Consultas sincroniza as exibições de forma que elas fiquem sempre atuais.</span><span class="sxs-lookup"><span data-stu-id="0fdbd-107">Query Builder synchronizes the views so that they are always current.</span></span>  
  
-   <span data-ttu-id="0fdbd-108">**Unir tabelas relacionadas** Se você adicionar mais de uma tabela a sua consulta, o Construtor de Consultas determinará automaticamente como as tabelas serão relacionadas e construirá o comando conjunto apropriado.</span><span class="sxs-lookup"><span data-stu-id="0fdbd-108">**Joining related tables** If you add more than one table to your query, Query Builder automatically determines how the tables are related and constructs the appropriate join command.</span></span>  
  
-   <span data-ttu-id="0fdbd-109">**Consultar ou atualizar bancos de dados** Você pode usar o Construtor de Consultas para retornar dados usando instruções Transact-SQL SELECT e para criar consultas que atualizam, adicionam ou excluem registros de um banco de dados.</span><span class="sxs-lookup"><span data-stu-id="0fdbd-109">**Querying or updating databases** You can use Query Builder to return data by using Transact-SQL SELECT statements and to create queries that update, add, or delete records in a database.</span></span>  
  
-   <span data-ttu-id="0fdbd-110">**Exibir e editar resultados imediatamente** Você pode executar sua consulta e trabalhar com um conjunto de registros em uma grade que permite percorrer e editar registros no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="0fdbd-110">**Viewing and editing results immediately** You can run your query and work with a recordset in a grid that allows you to scroll through and edit records in the database.</span></span>  
  
 <span data-ttu-id="0fdbd-111">As ferramentas gráficas na caixa de diálogo **Construtor de Consultas** permitem que você crie consultas usando usam operações de arrastar e soltar.</span><span class="sxs-lookup"><span data-stu-id="0fdbd-111">The graphical tools in the **Query Builder** dialog box let you construct queries using drag-and-drop operations.</span></span> <span data-ttu-id="0fdbd-112">Por padrão, a caixa de diálogo Construtor de Consultas cria consultas SELECT, mas você também pode criar consultas INSERT, UPDATE ou DELETE.</span><span class="sxs-lookup"><span data-stu-id="0fdbd-112">By default, the Query Builder dialog box constructs SELECT queries, but you can also build INSERT, UPDATE, or DELETE queries.</span></span> <span data-ttu-id="0fdbd-113">Todos os tipos de instruções SQL podem ser analisados e executados na caixa de diálogo **Construtor de Consultas** .</span><span class="sxs-lookup"><span data-stu-id="0fdbd-113">All types of SQL statements can be parsed and run in the **Query Builder** dialog box.</span></span> <span data-ttu-id="0fdbd-114">Para obter mais informações sobre instruções SQL em pacotes, consulte [Integration Services &#40;SSIS&#41; Consultas](integration-services-ssis-queries.md).</span><span class="sxs-lookup"><span data-stu-id="0fdbd-114">For more information about SQL statements in packages, see [Integration Services &#40;SSIS&#41; Queries](integration-services-ssis-queries.md).</span></span>  
  
 <span data-ttu-id="0fdbd-115">Para saber mais sobre a linguagem Transact-SQL e sua consulta, consulte [Referência de Transact-SQL &#40;Mecanismo de Banco de Dados&#41;](/sql/t-sql/language-reference).</span><span class="sxs-lookup"><span data-stu-id="0fdbd-115">To learn more about the Transact-SQL language and its syntax, see [Transact-SQL Reference &#40;Database Engine&#41;](/sql/t-sql/language-reference).</span></span>  
  
 <span data-ttu-id="0fdbd-116">Você também pode usar variáveis em uma consulta para fornecer valores a um parâmetro de entrada, para capturar valores de parâmetros de saída e para armazenar códigos de retorno.</span><span class="sxs-lookup"><span data-stu-id="0fdbd-116">You can also use variables in a query to provide values to an input parameter, to capture values of output parameters, and to store return codes.</span></span> <span data-ttu-id="0fdbd-117">Para saber mais sobre como usar variáveis nas consultas usadas por pacotes, consulte [Tarefa Executar SQL](control-flow/execute-sql-task.md), [Fonte OLE DB](data-flow/ole-db-source.md), e [Integration Services &#40;SSIS&#41; Queries](integration-services-ssis-queries.md).</span><span class="sxs-lookup"><span data-stu-id="0fdbd-117">To learn more about using variables in the queries that packages use, see [Execute SQL Task](control-flow/execute-sql-task.md), [OLE DB Source](data-flow/ole-db-source.md), and [Integration Services &#40;SSIS&#41; Queries](integration-services-ssis-queries.md).</span></span> <span data-ttu-id="0fdbd-118">Para saber mais sobre o uso de variáveis na Tarefa Executar DQL, consulte [Parâmetros e códigos de retorno na Tarefa Executar SQL](../../2014/integration-services/parameters-and-return-codes-in-the-execute-sql-task.md) e [Conjuntos de resultados na tarefa Executar SQL](../../2014/integration-services/result-sets-in-the-execute-sql-task.md).</span><span class="sxs-lookup"><span data-stu-id="0fdbd-118">To learn more about using variables in the Execute SQL Task, see [Parameters and Return Codes in the Execute SQL Task](../../2014/integration-services/parameters-and-return-codes-in-the-execute-sql-task.md) and [Result Sets in the Execute SQL Task](../../2014/integration-services/result-sets-in-the-execute-sql-task.md).</span></span>  
  
 <span data-ttu-id="0fdbd-119">As transformações Pesquisa e Pesquisa Difusa também podem usar variáveis com parâmetros e códigos de retorno.</span><span class="sxs-lookup"><span data-stu-id="0fdbd-119">The Lookup and Fuzzy lookup transformations can also use variables with parameters and return codes.</span></span> <span data-ttu-id="0fdbd-120">As informações sobre a origem OLE DB também se aplicam a estas duas transformações.</span><span class="sxs-lookup"><span data-stu-id="0fdbd-120">The information about the OLE DB source applies to these two transformations also.</span></span>  
  
## <a name="options"></a><span data-ttu-id="0fdbd-121">Opções</span><span class="sxs-lookup"><span data-stu-id="0fdbd-121">Options</span></span>  
 <span data-ttu-id="0fdbd-122">**Barra de ferramentas**</span><span class="sxs-lookup"><span data-stu-id="0fdbd-122">**Toolbar**</span></span>  
 <span data-ttu-id="0fdbd-123">Use a barra de ferramentas para gerenciar conjuntos de dados, selecionar painéis para exibição e controlar funções de consulta.</span><span class="sxs-lookup"><span data-stu-id="0fdbd-123">Use the toolbar to manage datasets, select panes to display, and control query functions.</span></span>  
  
|<span data-ttu-id="0fdbd-124">Valor</span><span class="sxs-lookup"><span data-stu-id="0fdbd-124">Value</span></span>|<span data-ttu-id="0fdbd-125">Descrição</span><span class="sxs-lookup"><span data-stu-id="0fdbd-125">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="0fdbd-126">**Painel Mostrar/Ocultar Diagrama**</span><span class="sxs-lookup"><span data-stu-id="0fdbd-126">**Show/Hide Diagram Pane**</span></span>|<span data-ttu-id="0fdbd-127">Exibe ou oculta o painel **Diagrama** .</span><span class="sxs-lookup"><span data-stu-id="0fdbd-127">Shows or hides the **Diagram** pane.</span></span>|  
|<span data-ttu-id="0fdbd-128">**Mostrar/Ocultar Painel Grade**</span><span class="sxs-lookup"><span data-stu-id="0fdbd-128">**Show/Hide Grid Pane**</span></span>|<span data-ttu-id="0fdbd-129">Exibe ou oculta o painel **Grade** .</span><span class="sxs-lookup"><span data-stu-id="0fdbd-129">Shows or hides the **Grid** pane.</span></span>|  
|<span data-ttu-id="0fdbd-130">**Painel Mostrar/Ocultar SQL**</span><span class="sxs-lookup"><span data-stu-id="0fdbd-130">**Show/Hide SQL Pane**</span></span>|<span data-ttu-id="0fdbd-131">Mostra ou oculta o painel **SQL** .</span><span class="sxs-lookup"><span data-stu-id="0fdbd-131">Shows or hides the **SQL** pane.</span></span>|  
|<span data-ttu-id="0fdbd-132">**Painel Mostrar/Ocultar Resultados**</span><span class="sxs-lookup"><span data-stu-id="0fdbd-132">**Show/Hide Results Pane**</span></span>|<span data-ttu-id="0fdbd-133">Exibe ou oculta o painel de **Resultados** .</span><span class="sxs-lookup"><span data-stu-id="0fdbd-133">Shows or hides the **Results** pane.</span></span>|  
|<span data-ttu-id="0fdbd-134">**Executar**</span><span class="sxs-lookup"><span data-stu-id="0fdbd-134">**Run**</span></span>|<span data-ttu-id="0fdbd-135">Executa a consulta.</span><span class="sxs-lookup"><span data-stu-id="0fdbd-135">Runs the query.</span></span> <span data-ttu-id="0fdbd-136">Os resultados são exibidos no painel de Resultados.</span><span class="sxs-lookup"><span data-stu-id="0fdbd-136">Results are displayed in the result pane.</span></span>|  
|<span data-ttu-id="0fdbd-137">**Verificar SQL**</span><span class="sxs-lookup"><span data-stu-id="0fdbd-137">**Verify SQL**</span></span>|<span data-ttu-id="0fdbd-138">Verifica se a instrução SQL é válida.</span><span class="sxs-lookup"><span data-stu-id="0fdbd-138">Verifies that the SQL statement is valid.</span></span>|  
|<span data-ttu-id="0fdbd-139">**Classificação crescente**</span><span class="sxs-lookup"><span data-stu-id="0fdbd-139">**Sort Ascending**</span></span>|<span data-ttu-id="0fdbd-140">Classifica as linhas de saída na coluna selecionada no painel Grade em ordem crescente.</span><span class="sxs-lookup"><span data-stu-id="0fdbd-140">Sorts output rows on the selected column in the grid pane, in ascending order.</span></span>|  
|<span data-ttu-id="0fdbd-141">**Classificação decrescente**</span><span class="sxs-lookup"><span data-stu-id="0fdbd-141">**Sort Descending**</span></span>|<span data-ttu-id="0fdbd-142">Classifica as linhas de saída na coluna selecionada no painel Grade em ordem decrescente.</span><span class="sxs-lookup"><span data-stu-id="0fdbd-142">Sorts output rows on the selected column in the grid pane, in descending order.</span></span>|  
|<span data-ttu-id="0fdbd-143">**Remover filtro**</span><span class="sxs-lookup"><span data-stu-id="0fdbd-143">**Remove Filter**</span></span>|<span data-ttu-id="0fdbd-144">Selecione um nome de coluna no painel de grade e clique em **Remover Filtro** para remover os critérios de classificação da coluna.</span><span class="sxs-lookup"><span data-stu-id="0fdbd-144">Select a column name in the grid pane, and then click **Remove Filter** to remove sort criteria for the column.</span></span>|  
|<span data-ttu-id="0fdbd-145">**Usar Agrupar Por**</span><span class="sxs-lookup"><span data-stu-id="0fdbd-145">**Use Group By**</span></span>|<span data-ttu-id="0fdbd-146">Adiciona a funcionalidade GROUP BY à consulta.</span><span class="sxs-lookup"><span data-stu-id="0fdbd-146">Adds GROUP BY functionality to the query.</span></span>|  
|<span data-ttu-id="0fdbd-147">**Adicionar Tabela**</span><span class="sxs-lookup"><span data-stu-id="0fdbd-147">**Add Table**</span></span>|<span data-ttu-id="0fdbd-148">Adiciona uma nova tabela à consulta.</span><span class="sxs-lookup"><span data-stu-id="0fdbd-148">Adds a new table to the query.</span></span>|  
  
 <span data-ttu-id="0fdbd-149">**Definição de consulta**</span><span class="sxs-lookup"><span data-stu-id="0fdbd-149">**Query Definition**</span></span>  
 <span data-ttu-id="0fdbd-150">A definição de consulta fornece uma barra de ferramentas e painéis nos quais definir e testar a consulta.</span><span class="sxs-lookup"><span data-stu-id="0fdbd-150">The query definition provides a toolbar and panes in which to define and test the query.</span></span>  
  
|<span data-ttu-id="0fdbd-151">Painel</span><span class="sxs-lookup"><span data-stu-id="0fdbd-151">Pane</span></span>|<span data-ttu-id="0fdbd-152">Descrição</span><span class="sxs-lookup"><span data-stu-id="0fdbd-152">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="0fdbd-153">Painel de **diagrama**</span><span class="sxs-lookup"><span data-stu-id="0fdbd-153">**Diagram** pane</span></span>|<span data-ttu-id="0fdbd-154">Exibe a consulta em um diagrama.</span><span class="sxs-lookup"><span data-stu-id="0fdbd-154">Displays the query in a diagram.</span></span> <span data-ttu-id="0fdbd-155">O diagrama mostra as tabelas incluídas na consulta e como elas estão unidas.</span><span class="sxs-lookup"><span data-stu-id="0fdbd-155">The diagram shows the tables included in the query, and how they are joined.</span></span> <span data-ttu-id="0fdbd-156">Marque ou desmarque a caixa de seleção próxima a uma coluna em uma tabela para adicioná-la ou removê-la da saída da consulta.</span><span class="sxs-lookup"><span data-stu-id="0fdbd-156">Select or clear the check box next to a column in a table to add or remove it from the query output.</span></span><br /><br /> <span data-ttu-id="0fdbd-157">Quando você adiciona tabelas à consulta, o Construtor de Consultas cria junções entre tabelas com base em tabelas, dependendo das chaves na tabela.</span><span class="sxs-lookup"><span data-stu-id="0fdbd-157">When you add tables to the query, Query Builder creates joins between tables based on tables, depending on the keys in the table.</span></span> <span data-ttu-id="0fdbd-158">Para adicionar uma junção, arraste um campo de uma tabela sobre um campo em outra tabela.</span><span class="sxs-lookup"><span data-stu-id="0fdbd-158">To add a join, drag a field from one table onto a field in another table.</span></span> <span data-ttu-id="0fdbd-159">Para gerenciar uma junção, clique com o botão direito do mouse na junção e selecione uma opção de menu.</span><span class="sxs-lookup"><span data-stu-id="0fdbd-159">To manage a join, right-click the join, and then select a menu option.</span></span><br /><br /> <span data-ttu-id="0fdbd-160">Clique com o botão direito do mouse no painel **diagrama** para adicionar ou remover tabelas, selecionar todas as tabelas e mostrar ou ocultar painéis.</span><span class="sxs-lookup"><span data-stu-id="0fdbd-160">Right-click the **Diagram** pane to add or remove tables, select all the tables, and show or hide panes.</span></span>|  
|<span data-ttu-id="0fdbd-161">Painel de **grade**</span><span class="sxs-lookup"><span data-stu-id="0fdbd-161">**Grid** pane</span></span>|<span data-ttu-id="0fdbd-162">Exibe a consulta em uma grade.</span><span class="sxs-lookup"><span data-stu-id="0fdbd-162">Displays the query in a grid.</span></span> <span data-ttu-id="0fdbd-163">Você pode usar esse painel para adicionar e remover colunas da consulta e alterar as configurações de cada coluna.</span><span class="sxs-lookup"><span data-stu-id="0fdbd-163">You can use this pane to add to and remove columns from the query and change the settings for each column.</span></span>|  
|<span data-ttu-id="0fdbd-164">Painel **SQL**</span><span class="sxs-lookup"><span data-stu-id="0fdbd-164">**SQL** pane</span></span>|<span data-ttu-id="0fdbd-165">Exibe a consulta como texto SQL.</span><span class="sxs-lookup"><span data-stu-id="0fdbd-165">Displays the query as SQL text.</span></span> <span data-ttu-id="0fdbd-166">As alterações feitas no painel **Diagrama** e no painel **Grade** aparecerão aqui e as alterações feitas aqui aparecerão no painel **Diagrama** e no painel **Grade** .</span><span class="sxs-lookup"><span data-stu-id="0fdbd-166">Changes made in the **Diagram** pane and the **Grid** pane will appear here, and changes made here will appear in the **Diagram** pane and the **Grid** pane.</span></span>|  
|<span data-ttu-id="0fdbd-167">Painel**Resultados**</span><span class="sxs-lookup"><span data-stu-id="0fdbd-167">**Results** pane</span></span>|<span data-ttu-id="0fdbd-168">Exibe os resultados da consulta quando você clica em **Executar** na barra de ferramentas.</span><span class="sxs-lookup"><span data-stu-id="0fdbd-168">Displays the results of the query when you click **Run** on the toolbar.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="0fdbd-169">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="0fdbd-169">See Also</span></span>  
 <span data-ttu-id="0fdbd-170">[Tarefa Executar SQL](control-flow/execute-sql-task.md) </span><span class="sxs-lookup"><span data-stu-id="0fdbd-170">[Execute SQL Task](control-flow/execute-sql-task.md) </span></span>  
 <span data-ttu-id="0fdbd-171">[Origem de OLE DB](data-flow/ole-db-source.md) </span><span class="sxs-lookup"><span data-stu-id="0fdbd-171">[OLE DB Source](data-flow/ole-db-source.md) </span></span>  
 <span data-ttu-id="0fdbd-172">[Destino OLE DB](data-flow/ole-db-destination.md) </span><span class="sxs-lookup"><span data-stu-id="0fdbd-172">[OLE DB Destination](data-flow/ole-db-destination.md) </span></span>  
 <span data-ttu-id="0fdbd-173">[Transformação pesquisa](data-flow/transformations/lookup-transformation.md) </span><span class="sxs-lookup"><span data-stu-id="0fdbd-173">[Lookup Transformation](data-flow/transformations/lookup-transformation.md) </span></span>  
 <span data-ttu-id="0fdbd-174">[Integration Services &#40;consultas&#41; SSIS](integration-services-ssis-queries.md) </span><span class="sxs-lookup"><span data-stu-id="0fdbd-174">[Integration Services &#40;SSIS&#41; Queries](integration-services-ssis-queries.md) </span></span>  
 [<span data-ttu-id="0fdbd-175">MERGE em pacotes do Integration Services</span><span class="sxs-lookup"><span data-stu-id="0fdbd-175">MERGE in Integration Services Packages</span></span>](control-flow/merge-in-integration-services-packages.md)  
  
  
