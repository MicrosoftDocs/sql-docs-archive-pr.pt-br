---
title: Manipuladores de eventos do SSIS (Integration Services) | Microsoft Docs
ms.custom: ''
ms.date: 03/09/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- Integration Services packages, events
- run-time [Integration Services]
- SQL Server Integration Services packages, events
- event handlers [Integration Services], about event handlers
- events [Integration Services]
- packages [Integration Services], events
- event handlers [Integration Services]
- SSIS packages, events
- containers [Integration Services], events
- events [Integration Services], about events
ms.assetid: 6f60cf93-35dc-431c-908d-2049c4ab66ba
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 78bcd6579aa8306c89fd9530fad3557ac57f102a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87574171"
---
# <a name="integration-services-ssis-event-handlers"></a><span data-ttu-id="bb378-102">Manipuladores de eventos do SSIS (Integration Services)</span><span class="sxs-lookup"><span data-stu-id="bb378-102">Integration Services (SSIS) Event Handlers</span></span>
  <span data-ttu-id="bb378-103">Em tempo de execução, os executáveis (pacotes e contêineres Loop Foreach, Loop For, de Sequência e de host da tarefa) geram eventos.</span><span class="sxs-lookup"><span data-stu-id="bb378-103">At run time, executables (packages and Foreach Loop, For Loop, Sequence, and task host containers) raise events.</span></span> <span data-ttu-id="bb378-104">Por exemplo, um evento OnError será gerado quando acontecer um erro.</span><span class="sxs-lookup"><span data-stu-id="bb378-104">For example, an OnError event is raised when an error occurs.</span></span> <span data-ttu-id="bb378-105">Você pode criar manipuladores de eventos personalizados para esses eventos a fim de estender a funcionalidade do pacote e fazer com que os pacotes sejam mais fáceis de administrar em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="bb378-105">You can create custom event handlers for these events to extend package functionality and make packages easier to manage at run time.</span></span> <span data-ttu-id="bb378-106">Os manipuladores de eventos podem executar tarefas como:</span><span class="sxs-lookup"><span data-stu-id="bb378-106">Event handlers can perform tasks such as the following:</span></span>

-   <span data-ttu-id="bb378-107">Limpar o armazenamento de dados temporários quando um pacote ou tarefa termina de ser executado.</span><span class="sxs-lookup"><span data-stu-id="bb378-107">Clean up temporary data storage when a package or task finishes running.</span></span>

-   <span data-ttu-id="bb378-108">Recuperar informações de sistema para avaliar a disponibilidade de recursos antes da execução de um pacote.</span><span class="sxs-lookup"><span data-stu-id="bb378-108">Retrieve system information to assess resource availability before a package runs.</span></span>

-   <span data-ttu-id="bb378-109">Atualizar dados de uma tabela quando ocorrer falha na pesquisa em uma tabela de referências.</span><span class="sxs-lookup"><span data-stu-id="bb378-109">Refresh data in a table when a lookup in a reference table fails.</span></span>

-   <span data-ttu-id="bb378-110">Enviar uma mensagem de email quando ocorrer erro, aviso ou falha em uma tarefa.</span><span class="sxs-lookup"><span data-stu-id="bb378-110">Send an e-mail message when an error or a warning occurs or when a task fails.</span></span>

 <span data-ttu-id="bb378-111">Quando um evento não tem um manipulador de eventos, o evento é gerado para o próximo contêiner superior na hierarquia de contêineres de um pacote.</span><span class="sxs-lookup"><span data-stu-id="bb378-111">If an event has no event handler, the event is raised to the next container up the container hierarchy in a package.</span></span> <span data-ttu-id="bb378-112">Se esse contêiner tiver um manipulador de eventos, este entrará em execução em resposta ao evento.</span><span class="sxs-lookup"><span data-stu-id="bb378-112">If this container has an event handler, the event handler runs in response to the event.</span></span> <span data-ttu-id="bb378-113">Se não, o evento será gerado para o próximo contêiner superior na hierarquia de contêineres.</span><span class="sxs-lookup"><span data-stu-id="bb378-113">If not, the event is raised to the next container up the container hierarchy.</span></span>

 <span data-ttu-id="bb378-114">O diagrama a seguir mostra um pacote simples que tem um contêiner Loop For que contém uma tarefa Executar SQL.</span><span class="sxs-lookup"><span data-stu-id="bb378-114">The following diagram shows a simple package that has a For Loop container that contains one Execute SQL task.</span></span>

 <span data-ttu-id="bb378-115">![Pacote, Loop For, host de tarefas e tarefa Executar SQL](media/mw-dts-eventhandlerpkg.gif "Pacote, Loop For, host de tarefas e tarefa Executar SQL")</span><span class="sxs-lookup"><span data-stu-id="bb378-115">![Package, For Loop, task host, and Execute SQL task](media/mw-dts-eventhandlerpkg.gif "Package, For Loop, task host, and Execute SQL task")</span></span>

 <span data-ttu-id="bb378-116">Só o pacote tem um manipulador de eventos, para seu evento `OnError`.</span><span class="sxs-lookup"><span data-stu-id="bb378-116">Only the package has an event handler, for its `OnError` event.</span></span> <span data-ttu-id="bb378-117">Se ocorrer um erro quando a tarefa Executar SQL for executada, o manipulador de eventos `OnError` do pacote entrará em execução.</span><span class="sxs-lookup"><span data-stu-id="bb378-117">If an error occurs when the Execute SQL task runs, the `OnError` event handler for the package runs.</span></span> <span data-ttu-id="bb378-118">O diagrama a seguir mostra a sequência de chamadas que faz o manipulador de eventos `OnError` do pacote executar.</span><span class="sxs-lookup"><span data-stu-id="bb378-118">The following diagram shows the sequence of calls that causes the `OnError` event handler for the package to execute.</span></span>

 <span data-ttu-id="bb378-119">![Fluxo do manipulador de eventos](media/mw-dts-eventhandlers.gif "Fluxo do manipulador de eventos")</span><span class="sxs-lookup"><span data-stu-id="bb378-119">![Event handler flow](media/mw-dts-eventhandlers.gif "Event handler flow")</span></span>

 <span data-ttu-id="bb378-120">Manipuladores de eventos são membros de uma coleção de manipuladores de eventos e todos os contêineres incluem esta coleção.</span><span class="sxs-lookup"><span data-stu-id="bb378-120">Event handlers are members of an event handler collection, and all containers include this collection.</span></span> <span data-ttu-id="bb378-121">Se você criar o pacote usando o Designer [!INCLUDE[ssIS](../includes/ssis-md.md)] , poderá ver os membros das coleções de manipuladores de eventos nas pastas **Manipuladores de Eventos** , na guia **Explorador de Pacotes** , do Designer [!INCLUDE[ssIS](../includes/ssis-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="bb378-121">If you create the package using [!INCLUDE[ssIS](../includes/ssis-md.md)] Designer, you can see the members of the event handler collections in the **Event Handlers** folders on the **Package Explorer** tab of [!INCLUDE[ssIS](../includes/ssis-md.md)] Designer.</span></span>

 <span data-ttu-id="bb378-122">Você pode configurar o contêiner de manipulador de eventos dos seguintes modos:</span><span class="sxs-lookup"><span data-stu-id="bb378-122">You can configure the event handler container in the following ways:</span></span>

-   <span data-ttu-id="bb378-123">Especifique um nome e uma descrição para o manipulador de eventos.</span><span class="sxs-lookup"><span data-stu-id="bb378-123">Specify a name and description for the event handler.</span></span>

-   <span data-ttu-id="bb378-124">Indique se o manipulador de eventos está em execução, se o pacote falha quando o manipulador de eventos falha e o número de erros que podem ocorrer antes de o manipulador de eventos falhar.</span><span class="sxs-lookup"><span data-stu-id="bb378-124">Indicate whether the event handler runs, whether the package fails if the event handler fails, and the number of errors that can occur before the event handler fails.</span></span>

-   <span data-ttu-id="bb378-125">Especifique um resultado de execução a retornar no lugar do resultado da execução real que o manipulador de eventos retorna durante a execução.</span><span class="sxs-lookup"><span data-stu-id="bb378-125">Specify an execution result to return instead of the actual execution result that the event handler returns at run time.</span></span>

-   <span data-ttu-id="bb378-126">Especifique a opção de transação do manipulador de eventos.</span><span class="sxs-lookup"><span data-stu-id="bb378-126">Specify the transaction option for the event handler.</span></span>

-   <span data-ttu-id="bb378-127">Especifique o modo de registro usado pelo manipulador de eventos.</span><span class="sxs-lookup"><span data-stu-id="bb378-127">Specify the logging mode that the event handler uses.</span></span>

## <a name="event-handler-content"></a><span data-ttu-id="bb378-128">Conteúdo do manipulador de eventos</span><span class="sxs-lookup"><span data-stu-id="bb378-128">Event Handler Content</span></span>
 <span data-ttu-id="bb378-129">Criar um manipulador de eventos é como criar um pacote; um manipulador de eventos possui tarefas e contêineres, que são colocados em sequência em um fluxo de controle, e um manipulador de eventos também pode incluir fluxos de dados.</span><span class="sxs-lookup"><span data-stu-id="bb378-129">Creating an event handler is similar to building a package; an event handler has tasks and containers, which are sequenced into a control flow, and an event handler can also include data flows.</span></span> <span data-ttu-id="bb378-130">O Designer [!INCLUDE[ssIS](../includes/ssis-md.md)] inclui a guia **Manipuladores de Eventos** para a criação de manipuladores de eventos personalizados.</span><span class="sxs-lookup"><span data-stu-id="bb378-130">The [!INCLUDE[ssIS](../includes/ssis-md.md)] Designer includes the **Event Handlers** tab for creating custom event handlers.</span></span> <span data-ttu-id="bb378-131">Para obter mais informações, consulte [manipuladores de eventos de pacote SSIS](integration-services-ssis-event-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="bb378-131">For more information, see [SSIS Package Event Handlers](integration-services-ssis-event-handlers.md).</span></span>

 <span data-ttu-id="bb378-132">Você também pode criar manipuladores de eventos programaticamente.</span><span class="sxs-lookup"><span data-stu-id="bb378-132">You can also create event handlers programmatically.</span></span> <span data-ttu-id="bb378-133">Para obter mais informações, consulte [Manipulação de erros programaticamente](building-packages-programmatically/handling-events-programmatically.md).</span><span class="sxs-lookup"><span data-stu-id="bb378-133">For more information, see [Handling Events Programmatically](building-packages-programmatically/handling-events-programmatically.md).</span></span>

## <a name="run-time-events"></a><span data-ttu-id="bb378-134">Eventos de tempo de execução</span><span class="sxs-lookup"><span data-stu-id="bb378-134">Run-Time Events</span></span>
 <span data-ttu-id="bb378-135">A tabela a seguir lista os manipuladores de eventos que o [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] fornece e descreve os eventos de tempo de execução que acionam a execução do manipulador de eventos.</span><span class="sxs-lookup"><span data-stu-id="bb378-135">The following table lists the event handlers that [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] provides, and describes the run-time events that cause the event handler to run.</span></span>

|<span data-ttu-id="bb378-136">Manipulador de eventos</span><span class="sxs-lookup"><span data-stu-id="bb378-136">Event handler</span></span>|<span data-ttu-id="bb378-137">Evento</span><span class="sxs-lookup"><span data-stu-id="bb378-137">Event</span></span>|
|-------------------|-----------|
|`OnError`|<span data-ttu-id="bb378-138">O manipulador de eventos para o evento `OnError`.</span><span class="sxs-lookup"><span data-stu-id="bb378-138">The event handler for the `OnError` event.</span></span> <span data-ttu-id="bb378-139">Esse evento é gerado por um executável quando ocorre um erro.</span><span class="sxs-lookup"><span data-stu-id="bb378-139">This event is raised by an executable when an error occurs.</span></span>|
|<span data-ttu-id="bb378-140">**OnExecStatusChanged**</span><span class="sxs-lookup"><span data-stu-id="bb378-140">**OnExecStatusChanged**</span></span>|<span data-ttu-id="bb378-141">Manipulador de eventos do evento **OnExecStatusChanged** .</span><span class="sxs-lookup"><span data-stu-id="bb378-141">The event handler for the **OnExecStatusChanged** event.</span></span> <span data-ttu-id="bb378-142">Esse evento é gerado por um executável quando seu status de execução é alterado.</span><span class="sxs-lookup"><span data-stu-id="bb378-142">This event is raised by an executable when its execution status changes.</span></span>|
|<span data-ttu-id="bb378-143">**OnInformation**</span><span class="sxs-lookup"><span data-stu-id="bb378-143">**OnInformation**</span></span>|<span data-ttu-id="bb378-144">Manipulador de eventos do evento **OnInformation** .</span><span class="sxs-lookup"><span data-stu-id="bb378-144">The event handler for the **OnInformation** event.</span></span> <span data-ttu-id="bb378-145">Esse evento é gerado durante a validação e execução de um executável para fornecer informações.</span><span class="sxs-lookup"><span data-stu-id="bb378-145">This event is raised during the validation and execution of an executable to report information.</span></span> <span data-ttu-id="bb378-146">Esse evento transmite apenas informações, nenhum erro ou avisos.</span><span class="sxs-lookup"><span data-stu-id="bb378-146">This event conveys information only, no errors or warnings.</span></span>|
|<span data-ttu-id="bb378-147">**OnPostExecute**</span><span class="sxs-lookup"><span data-stu-id="bb378-147">**OnPostExecute**</span></span>|<span data-ttu-id="bb378-148">Manipulador de eventos do evento **OnPostExecute** .</span><span class="sxs-lookup"><span data-stu-id="bb378-148">The event handler for the **OnPostExecute** event.</span></span> <span data-ttu-id="bb378-149">Esse evento é gerado por um executável logo depois que este termina de ser executado.</span><span class="sxs-lookup"><span data-stu-id="bb378-149">This event is raised by an executable immediately after it has finished running.</span></span>|
|<span data-ttu-id="bb378-150">**OnPostValidate**</span><span class="sxs-lookup"><span data-stu-id="bb378-150">**OnPostValidate**</span></span>|<span data-ttu-id="bb378-151">Manipulador de eventos do evento **OnPostValidate** .</span><span class="sxs-lookup"><span data-stu-id="bb378-151">The event handler for the **OnPostValidate** event.</span></span> <span data-ttu-id="bb378-152">Esse evento é gerado por um executável quando sua validação é finalizada.</span><span class="sxs-lookup"><span data-stu-id="bb378-152">This event is raised by an executable when its validation is finished.</span></span>|
|<span data-ttu-id="bb378-153">**OnPreExecute**</span><span class="sxs-lookup"><span data-stu-id="bb378-153">**OnPreExecute**</span></span>|<span data-ttu-id="bb378-154">Manipulador de eventos do evento **OnPreExecute** .</span><span class="sxs-lookup"><span data-stu-id="bb378-154">The event handler for the **OnPreExecute** event.</span></span> <span data-ttu-id="bb378-155">Esse evento é gerado por um executável imediatamente antes da sua execução.</span><span class="sxs-lookup"><span data-stu-id="bb378-155">This event is raised by an executable immediately before it runs.</span></span>|
|<span data-ttu-id="bb378-156">**OnPreValidate**</span><span class="sxs-lookup"><span data-stu-id="bb378-156">**OnPreValidate**</span></span>|<span data-ttu-id="bb378-157">Manipulador de eventos do evento **OnPreValidate** .</span><span class="sxs-lookup"><span data-stu-id="bb378-157">The event handler for the **OnPreValidate** event.</span></span> <span data-ttu-id="bb378-158">Esse evento é gerado por um executável quando sua validação é iniciada.</span><span class="sxs-lookup"><span data-stu-id="bb378-158">This event is raised by an executable when its validation starts.</span></span>|
|<span data-ttu-id="bb378-159">**OnProgress**</span><span class="sxs-lookup"><span data-stu-id="bb378-159">**OnProgress**</span></span>|<span data-ttu-id="bb378-160">Manipulador de eventos do evento **OnProgress** .</span><span class="sxs-lookup"><span data-stu-id="bb378-160">The event handler for the **OnProgress** event.</span></span> <span data-ttu-id="bb378-161">Esse evento é gerado por um executável quando um progresso mensurável é feito pelo executável.</span><span class="sxs-lookup"><span data-stu-id="bb378-161">This event is raised by an executable when measurable progress is made by the executable.</span></span>|
|<span data-ttu-id="bb378-162">**OnQueryCancel**</span><span class="sxs-lookup"><span data-stu-id="bb378-162">**OnQueryCancel**</span></span>|<span data-ttu-id="bb378-163">Manipulador de eventos do evento **OnQueryCancel** .</span><span class="sxs-lookup"><span data-stu-id="bb378-163">The event handler for the **OnQueryCancel** event.</span></span> <span data-ttu-id="bb378-164">Esse evento é gerado por um executável para determinar se deve parar de ser executado.</span><span class="sxs-lookup"><span data-stu-id="bb378-164">This event is raised by an executable to determine whether it should stop running.</span></span>|
|<span data-ttu-id="bb378-165">**OnTaskFailed**</span><span class="sxs-lookup"><span data-stu-id="bb378-165">**OnTaskFailed**</span></span>|<span data-ttu-id="bb378-166">Manipulador de eventos do evento **OnTaskFailed** .</span><span class="sxs-lookup"><span data-stu-id="bb378-166">The event handler for the **OnTaskFailed** event.</span></span> <span data-ttu-id="bb378-167">Esse evento é gerado por uma tarefa quando ela falha.</span><span class="sxs-lookup"><span data-stu-id="bb378-167">This event is raised by a task when it fails.</span></span>|
|<span data-ttu-id="bb378-168">**OnVariableValueChanged**</span><span class="sxs-lookup"><span data-stu-id="bb378-168">**OnVariableValueChanged**</span></span>|<span data-ttu-id="bb378-169">Manipulador de eventos do evento **OnVariableValueChanged** .</span><span class="sxs-lookup"><span data-stu-id="bb378-169">The event handler for the **OnVariableValueChanged** event.</span></span> <span data-ttu-id="bb378-170">Esse evento é gerado por um executável quando o valor de uma variável é alterado.</span><span class="sxs-lookup"><span data-stu-id="bb378-170">This event is raised by an executable when the value of a variable changes.</span></span> <span data-ttu-id="bb378-171">O evento é gerado pelo executável no qual a variável está definida.</span><span class="sxs-lookup"><span data-stu-id="bb378-171">The event is raised by the executable on which the variable is defined.</span></span> <span data-ttu-id="bb378-172">Esse evento não será gerado se você definir a propriedade **RaiseChangeEvent** para a variável como `False` .</span><span class="sxs-lookup"><span data-stu-id="bb378-172">This event is not raised if you set the **RaiseChangeEvent** property for the variable to `False`.</span></span> <span data-ttu-id="bb378-173">Para obter mais informações, consulte [Variáveis do SSIS &#40;Integration Services&#41;](integration-services-ssis-variables.md).</span><span class="sxs-lookup"><span data-stu-id="bb378-173">For more information, see [Integration Services &#40;SSIS&#41; Variables](integration-services-ssis-variables.md).</span></span>|
|<span data-ttu-id="bb378-174">**OnWarning**</span><span class="sxs-lookup"><span data-stu-id="bb378-174">**OnWarning**</span></span>|<span data-ttu-id="bb378-175">Manipulador de eventos do evento **OnWarning** .</span><span class="sxs-lookup"><span data-stu-id="bb378-175">The event handler for the **OnWarning** event.</span></span> <span data-ttu-id="bb378-176">Esse evento é gerado por um executável quando ocorre um aviso.</span><span class="sxs-lookup"><span data-stu-id="bb378-176">This event is raised by an executable when a warning occurs.</span></span>|

## <a name="configuration-of-an-event-handler"></a><span data-ttu-id="bb378-177">Configuração de um manipulador de eventos</span><span class="sxs-lookup"><span data-stu-id="bb378-177">Configuration of an Event Handler</span></span>
 <span data-ttu-id="bb378-178">Você pode definir as propriedades na janela **Propriedades** do [!INCLUDE[ssBIDevStudioFull](../includes/ssbidevstudiofull-md.md)] ou programaticamente.</span><span class="sxs-lookup"><span data-stu-id="bb378-178">You can set properties in the **Properties** window of [!INCLUDE[ssBIDevStudioFull](../includes/ssbidevstudiofull-md.md)] or programmatically.</span></span>

 <span data-ttu-id="bb378-179">Para obter informações sobre como definir essas propriedades no [!INCLUDE[ssBIDevStudioFull](../includes/ssbidevstudiofull-md.md)], consulte [Definir as propriedades de uma tarefa ou de um contêiner](../../2014/integration-services/set-the-properties-of-a-task-or-container.md).</span><span class="sxs-lookup"><span data-stu-id="bb378-179">For information about how to set these properties in [!INCLUDE[ssBIDevStudioFull](../includes/ssbidevstudiofull-md.md)], see [Set the Properties of a Task or Container](../../2014/integration-services/set-the-properties-of-a-task-or-container.md).</span></span>

 <span data-ttu-id="bb378-180">Para obter informações sobre como definir essas propriedades programaticamente, consulte <xref:Microsoft.SqlServer.Dts.Runtime.DtsEventHandler>.</span><span class="sxs-lookup"><span data-stu-id="bb378-180">For information about programmatically setting these properties, see <xref:Microsoft.SqlServer.Dts.Runtime.DtsEventHandler>.</span></span>

## <a name="related-tasks"></a><span data-ttu-id="bb378-181">Related Tasks</span><span class="sxs-lookup"><span data-stu-id="bb378-181">Related Tasks</span></span>
 <span data-ttu-id="bb378-182">Para obter informações sobre como adicionar um manipulador de eventos a um pacote, consulte [Adicionar um manipulador de eventos a um pacote](../../2014/integration-services/add-an-event-handler-to-a-package.md).</span><span class="sxs-lookup"><span data-stu-id="bb378-182">For information about how to add an event handler to a package, see [Add an Event Handler to a Package](../../2014/integration-services/add-an-event-handler-to-a-package.md).</span></span>


